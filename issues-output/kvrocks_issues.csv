type,issue_url,comment_url,repo_name,id,issue_num,title,user_login,user_id,user_name,user_email,issue_state,created_at,updated_at,body,reactions
issue,https://api.github.com/repos/apache/kvrocks/issues/2,https://api.github.com/repos/apache/kvrocks/issues/2,kvrocks,482973230,2,rename flushall to flushdb,borg286,8532481,,,CLOSED,2019-08-20T16:52:25Z,2019-08-21T02:14:01Z,For compatability with the redis protocol you should implement the flushdb command. Currently you do this functionality with a command called flushall.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI1OTg2MA==,kvrocks,523259860,2,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2019-08-21T01:40:20Z,2019-08-21T01:40:20Z,"@borg286 yeah, you're right, i would fix it soon, thanks~","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI1OTg2MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI2NjI5NA==,kvrocks,523266294,2,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2019-08-21T02:14:01Z,2019-08-21T02:14:01Z,"fixed, https://github.com/meitu/kvrocks/commit/99fccfe5fef540568cb49667b415a652ca7de300","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI2NjI5NA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/3,https://api.github.com/repos/apache/kvrocks/issues/3,kvrocks,482977371,3,Incompatability with hscan and some other incompatibilities.,borg286,8532481,,,CLOSED,2019-08-20T17:02:17Z,2021-11-22T13:42:16Z,"There is a python ORM library for redis called walrus. It has a very rich set of tests. I found this helpful in identifying problems with compatability with stock redis. https://github.com/coleifer/walrus
I was able to run these tests against your redis and it found some issues

Here is the output of the test run.
https://pastebin.com/mFfEjWPT

I have verified that stock redis passes all the tests.

The tweaks I had to do to the tests was to pass in the password='foobared' to 2 places: runtests.py does a call to Redis().Info() which needs the password set, and
walrus/tests/base.py which also needs the password passed into the Redis() call.

I'd cut a bug for each issue, but I think odds are that once you get the tests running locally you'll be able to find other incompatibilities and fix them. 

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/3,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI2MjQzOQ==,kvrocks,523262439,3,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2019-08-21T01:53:59Z,2019-08-21T01:53:59Z,"hi @borg286,

this's kvrocks supports commands https://github.com/meitu/kvrocks/blob/master/docs/support-commands.md, and some commands like `hscan`,`scan`,`info` weren't totally compatible with Redis, we just try our best to compatible with Redis. and some structures like GEO, HYPERLOGLOG would come soon","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI2MjQzOQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/3,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI3NDU1MA==,kvrocks,523274550,3,NA,borg286,8532481,,,NA,2019-08-21T02:56:48Z,2019-08-21T02:56:48Z,"Your docs say it supports hscan, and I did a one-off test to see it worked with 1 element. Perhaps this test may reveal a corner case your code fails at.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI3NDU1MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/3,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI4MDA5OQ==,kvrocks,523280099,3,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2019-08-21T03:27:38Z,2019-08-21T03:27:38Z,"You're right, kvrocks hscan return `not found error` when the hash key was not found which not consistence with Redis. we should fix it, very very thanks for your feedback.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyMzI4MDA5OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/4,https://api.github.com/repos/apache/kvrocks/issues/4,kvrocks,483180394,4,FIX: inconsistence `hscan` command behavior with Redis,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2019-08-21T03:30:02Z,2019-08-21T06:00:14Z,"Redis ` hscan` return the cursor ""0"" and empty list, but kvrocks return the not found error","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/10,https://api.github.com/repos/apache/kvrocks/issues/10,kvrocks,484779013,10,Is kvrocks production ready?,spsneo,394304,Siddharth Prakash Singh,spsneo@gmail.com,CLOSED,2019-08-24T04:57:41Z,2019-08-24T16:19:14Z,"Is kvrocks production ready? Is it being used in production by others as well?
Is there any benchmark?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/10/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/10,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyNDUyMTI1Mw==,kvrocks,524521253,10,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2019-08-24T05:14:53Z,2019-08-24T05:14:53Z,"yeah, we're running more than fifty kvrocks instances in production，but just open-source soon so I am not sure any others use it in production. the README show some benchmark metrics.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyNDUyMTI1Mw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/10,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyNDU2MzAyMQ==,kvrocks,524563021,10,NA,spsneo,394304,Siddharth Prakash Singh,spsneo@gmail.com,NA,2019-08-24T16:19:12Z,2019-08-24T16:19:12Z,Thanks for answering. Closing this issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDUyNDU2MzAyMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/29,https://api.github.com/repos/apache/kvrocks/issues/29,kvrocks,506652853,29,Supports `slave-serve-stale-data` configuration and fix role,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2019-10-14T13:26:39Z,2019-10-22T02:22:10Z,"- [ ] FIX role was incorrect when the slave loses connection with the master
- [ ] supports `slave-serve-stale-data` configuration","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/29/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/30,https://api.github.com/repos/apache/kvrocks/issues/30,kvrocks,506654975,30,Supprts new configuration,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2019-10-14T13:30:28Z,2022-07-30T05:04:23Z,"- [ ] `min-slaves-to-write` deny the write when too few slaves can keep up with the master
- [ ] `min-slaves-max-lag`  to define max lag when the slave would be regarded as can't keep up with the master ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/30/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/30,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-6s,kvrocks,1200090796,30,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-30T05:04:23Z,2022-07-30T05:04:23Z,Close this stale issue and can reopen a new one if needed.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-6s/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/31,https://api.github.com/repos/apache/kvrocks/issues/31,kvrocks,507068270,31,kvrocks2redis supports migrate data into the specify redis db num,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2019-10-15T07:47:54Z,2019-11-09T15:10:59Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/31/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/33,https://api.github.com/repos/apache/kvrocks/issues/33,kvrocks,519618576,33,scan the entire db when the token is requirepass,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2019-11-08T02:15:08Z,2019-11-20T10:57:02Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/33/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/34,https://api.github.com/repos/apache/kvrocks/issues/34,kvrocks,519618705,34,allow user token to compact the namespace,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2019-11-08T02:15:38Z,2019-11-21T02:56:19Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/34/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/35,https://api.github.com/repos/apache/kvrocks/issues/35,kvrocks,519618830,35,show db size by namespace,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2019-11-08T02:16:05Z,2019-11-19T07:21:49Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/35/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/48,https://api.github.com/repos/apache/kvrocks/issues/48,kvrocks,534665033,48,Add disk capacity to INFO command,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2019-12-09T03:15:06Z,2019-12-09T13:23:02Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/48/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/53,https://api.github.com/repos/apache/kvrocks/issues/53,kvrocks,550646986,53,编译不成功,smartlee,1262498,BradLee,entropylee@gmail.com,CLOSED,2020-01-16T08:19:48Z,2020-01-16T08:52:14Z,"cd src && make all
You need to run this command from the toplevel of the working tree.
make[1]: 进入目录“/root/kvrocks/src”

Hint: Fetching submodules from the remote
git submodule init
You need to run this command from the toplevel of the working tree.
make[1]: *** [SUBMODULES] 错误 1
make[1]: 离开目录“/root/kvrocks/src”
make: *** [all] 错误 2
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/53/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/53,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU3NTAzODE2Ng==,kvrocks,575038166,53,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-01-16T08:22:54Z,2020-01-16T08:22:54Z,@smartlee 在 kvrocks 这层目录编译，不要进入 src,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU3NTAzODE2Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/53,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU3NTA0MDAxOQ==,kvrocks,575040019,53,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-01-16T08:27:38Z,2020-01-16T08:27:38Z,"这个cd src && make all 是log 输出 我看了下Makefile 应该是git update那步出错 因为我编译机器上是不能连外网的
但又有另外一个问题
/root/kvrocks/external/jemalloc/src/background_thread.c:843：对‘dlsym’未定义的引用
/root/kvrocks/external/jemalloc/src/background_thread.c:843：对‘dlsym’未定义的引用
另外 问下有交流的微信群吗","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU3NTA0MDAxOQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/53,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU3NTA0MzA0OA==,kvrocks,575043048,53,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-01-16T08:36:19Z,2020-01-16T08:36:19Z,@smartlee gmail 邮件私你，没有联网的没法编译，依赖没法下载，建议找一台联网机器编译,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU3NTA0MzA0OA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/54,https://api.github.com/repos/apache/kvrocks/issues/54,kvrocks,563350172,54,在docker中启动就hang住了,smartlee,1262498,BradLee,entropylee@gmail.com,CLOSED,2020-02-11T17:07:38Z,2020-02-13T00:51:11Z,"在main处开始打印 也没有任何输出
gdb 堆栈如下
```
[Switching to thread 1 (Thread 0x7fd29b678300 (LWP 148))]
#0  0x00007fd29ae4d50d in __lll_lock_wait () from /lib64/libpthread.so.0
(gdb) bt
#0  0x00007fd29ae4d50d in __lll_lock_wait () from /lib64/libpthread.so.0
#1  0x00007fd29ae48e5b in _L_lock_883 () from /lib64/libpthread.so.0
#2  0x00007fd29ae48d28 in pthread_mutex_lock () from /lib64/libpthread.so.0
#3  0x00000000005874a9 in malloc_mutex_lock_final (mutex=0xb224e0 <init_lock>) at include/jemalloc/internal/mutex.h:155
#4  je_malloc_mutex_lock_slow (mutex=mutex@entry=0xb224e0 <init_lock>) at src/mutex.c:85
#5  0x00000000005524f0 in malloc_mutex_lock (tsdn=0x0, mutex=0xb224e0 <init_lock>) at include/jemalloc/internal/mutex.h:221
#6  0x000000000040d821 in malloc_init_hard () at src/jemalloc.c:1739
#7  0x0000000000556961 in malloc_init () at src/jemalloc.c:223
#8  imalloc_init_check (sopts=<optimized out>, dopts=<optimized out>) at src/jemalloc.c:2229
#9  imalloc (dopts=<synthetic pointer>, sopts=<synthetic pointer>) at src/jemalloc.c:2260
#10 calloc (num=1, size=32) at src/jemalloc.c:2494
#11 0x00007fd29b05c550 in _dlerror_run () from /lib64/libdl.so.2
#12 0x00007fd29b05c058 in dlsym () from /lib64/libdl.so.2
#13 0x00007fd29b25fbbc in sysconf (name=name@entry=30) at libsysconfcpus.c:108
#14 0x00000000005881a6 in os_page_detect () at src/pages.c:429
#15 je_pages_boot () at src/pages.c:600
#16 0x000000000040d756 in malloc_init_hard_a0_locked () at src/jemalloc.c:1518
#17 0x000000000040d882 in malloc_init_hard () at src/jemalloc.c:1750
#18 0x000000000055575d in malloc_init () at src/jemalloc.c:223
#19 imalloc_init_check (sopts=<optimized out>, dopts=<optimized out>) at src/jemalloc.c:2229
#20 imalloc (dopts=<synthetic pointer>, sopts=<synthetic pointer>) at src/jemalloc.c:2260
#21 je_malloc_default (size=16) at src/jemalloc.c:2289
#22 0x00007fd29a350ecd in operator new(unsigned long) () from /lib64/libstdc++.so.6
#23 0x00007fd29a820c27 in google::FlagRegisterer::FlagRegisterer<std::string>(char const*, char const*, char const*, std::string*, std::string*) () from /lib64/libgflags.so.2.2
#24 0x00007fd29a8143b3 in _GLOBAL__sub_I_gflags.cc () from /lib64/libgflags.so.2.2
#25 0x00007fd29b471973 in _dl_init_internal () from /lib64/ld-linux-x86-64.so.2
#26 0x00007fd29b46315a in _dl_start_user () from /lib64/ld-linux-x86-64.so.2
#27 0x0000000000000001 in ?? ()
#28 0x00007ffdce76a93c in ?? ()
#29 0x0000000000000000 in ?? ()
```

strace 如下
```
arch_prctl(ARCH_SET_FS, 0x7f0ef453d300) = 0
mprotect(0x7f0ef2c94000, 16384, PROT_READ) = 0
mprotect(0x7f0ef2eb3000, 4096, PROT_READ) = 0
mprotect(0x7f0ef31b5000, 4096, PROT_READ) = 0
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f0ef453a000
mmap(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f0ef4539000
mprotect(0x7f0ef349f000, 32768, PROT_READ) = 0
mprotect(0x7f0ef36d2000, 4096, PROT_READ) = 0
mprotect(0x7f0ef3f1a000, 4096, PROT_READ) = 0
mprotect(0x7f0ef38f4000, 4096, PROT_READ) = 0
mprotect(0x7f0ef3afa000, 4096, PROT_READ) = 0
mprotect(0x7f0ef3d02000, 4096, PROT_READ) = 0
mprotect(0x7f0ef4122000, 4096, PROT_READ) = 0
mprotect(0x7f0ef4325000, 4096, PROT_READ) = 0
mprotect(0xb0d000, 8192, PROT_READ)     = 0
mprotect(0x7f0ef4548000, 4096, PROT_READ) = 0
munmap(0x7f0ef4543000, 15371)           = 0
set_tid_address(0x7f0ef453d5d0)         = 223
set_robust_list(0x7f0ef453d5e0, 24)     = 0
rt_sigaction(SIGRTMIN, {0x7f0ef3d0a820, [], SA_RESTORER|SA_SIGINFO, 0x7f0ef3d135f0}, NULL, 8) = 0
rt_sigaction(SIGRT_1, {0x7f0ef3d0a8b0, [], SA_RESTORER|SA_RESTART|SA_SIGINFO, 0x7f0ef3d135f0}, NULL, 8) = 0
rt_sigprocmask(SIG_UNBLOCK, [RTMIN RT_1], NULL, 8) = 0
getrlimit(RLIMIT_STACK, {rlim_cur=8192*1024, rlim_max=RLIM64_INFINITY}) = 0
futex(0x7f0ef34bb8ac, FUTEX_WAKE_PRIVATE, 2147483647) = 0
futex(0x7f0ef34bb8b8, FUTEX_WAKE_PRIVATE, 2147483647) = 0
readlink(""/etc/malloc.conf"", 0x7ffe7608c6e0, 4096) = -1 ENOENT (No such file or directory)
futex(0x7f0ef41230b0, FUTEX_WAKE_PRIVATE, 2147483647) = 0
futex(0xb22580, FUTEX_WAIT_PRIVATE, 2, NULL^Cstrace: Process 223 detached
 <detached ...>
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/54/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/54,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NDk2MDMyMg==,kvrocks,584960322,54,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-12T01:05:18Z,2020-02-12T01:05:18Z,"这个看起来是 gflags 在分配内存的时候 jemalloc 死锁了，麻烦帮忙执行：
```
thread apply all bt
```
提供一下完整的堆栈，然后可以尝试把 docker 基础镜像中的 gflags 依赖库去掉","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NDk2MDMyMg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/54,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NDk3NzY4NQ==,kvrocks,584977685,54,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-12T01:52:03Z,2020-02-12T01:52:03Z,"只有一个线程 想不通死锁是哪里来的  gflags 依赖库 怎么去除？
在宿主机上执行却没问题，容器里面就不行
而且在容器里面可以编译通过的可执行程序 也启动不了
```
(gdb) thread apply all bt

Thread 1 (Thread 0x7fd29b678300 (LWP 148)):
#0  0x00007fd29ae4d50d in __lll_lock_wait () from /lib64/libpthread.so.0
#1  0x00007fd29ae48e5b in _L_lock_883 () from /lib64/libpthread.so.0
#2  0x00007fd29ae48d28 in pthread_mutex_lock () from /lib64/libpthread.so.0
#3  0x00000000005874a9 in malloc_mutex_lock_final (mutex=0xb224e0 <init_lock>) at include/jemalloc/internal/mutex.h:155
#4  je_malloc_mutex_lock_slow (mutex=mutex@entry=0xb224e0 <init_lock>) at src/mutex.c:85
#5  0x00000000005524f0 in malloc_mutex_lock (tsdn=0x0, mutex=0xb224e0 <init_lock>) at include/jemalloc/internal/mutex.h:221
#6  0x000000000040d821 in malloc_init_hard () at src/jemalloc.c:1739
#7  0x0000000000556961 in malloc_init () at src/jemalloc.c:223
#8  imalloc_init_check (sopts=<optimized out>, dopts=<optimized out>) at src/jemalloc.c:2229
#9  imalloc (dopts=<synthetic pointer>, sopts=<synthetic pointer>) at src/jemalloc.c:2260
#10 calloc (num=1, size=32) at src/jemalloc.c:2494
#11 0x00007fd29b05c550 in _dlerror_run () from /lib64/libdl.so.2
#12 0x00007fd29b05c058 in dlsym () from /lib64/libdl.so.2
#13 0x00007fd29b25fbbc in sysconf (name=name@entry=30) at libsysconfcpus.c:108
#14 0x00000000005881a6 in os_page_detect () at src/pages.c:429
#15 je_pages_boot () at src/pages.c:600
#16 0x000000000040d756 in malloc_init_hard_a0_locked () at src/jemalloc.c:1518
#17 0x000000000040d882 in malloc_init_hard () at src/jemalloc.c:1750
#18 0x000000000055575d in malloc_init () at src/jemalloc.c:223
#19 imalloc_init_check (sopts=<optimized out>, dopts=<optimized out>) at src/jemalloc.c:2229
#20 imalloc (dopts=<synthetic pointer>, sopts=<synthetic pointer>) at src/jemalloc.c:2260
#21 je_malloc_default (size=16) at src/jemalloc.c:2289
#22 0x00007fd29a350ecd in operator new(unsigned long) () from /lib64/libstdc++.so.6
#23 0x00007fd29a820c27 in google::FlagRegisterer::FlagRegisterer<std::string>(char const*, char const*, char const*, std::string*, std::string*) () from /lib64/libgflags.so.2.2
#24 0x00007fd29a8143b3 in _GLOBAL__sub_I_gflags.cc () from /lib64/libgflags.so.2.2
#25 0x00007fd29b471973 in _dl_init_internal () from /lib64/ld-linux-x86-64.so.2
#26 0x00007fd29b46315a in _dl_start_user () from /lib64/ld-linux-x86-64.so.2
#27 0x0000000000000001 in ?? ()
#28 0x00007ffdce76a93c in ?? ()
#29 0x0000000000000000 in ?? ()
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NDk3NzY4NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/54,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NDk4Mjk1NA==,kvrocks,584982954,54,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-12T02:10:54Z,2020-02-12T02:10:54Z,这个类似: https://github.com/jemalloc/jemalloc/issues/1318 ，不过最终认为是标准库的问题。如果是 centos 那么可以通过 yum erase， ubuntu 就通过 apt 来 uninstall,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NDk4Mjk1NA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/54,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NTAxMjk2OQ==,kvrocks,585012969,54,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-12T03:44:32Z,2020-02-12T03:44:32Z,"去掉了对gflags的依赖 还是卡住了 
```
(gdb) thread 1
[Switching to thread 1 (Thread 0x7f0780441300 (LWP 82))]
#0  0x00007f077fe1a50d in __lll_lock_wait () from /lib64/libpthread.so.0
(gdb) bt
#0  0x00007f077fe1a50d in __lll_lock_wait () from /lib64/libpthread.so.0
#1  0x00007f077fe15e5b in _L_lock_883 () from /lib64/libpthread.so.0
#2  0x00007f077fe15d28 in pthread_mutex_lock () from /lib64/libpthread.so.0
#3  0x0000000000586699 in malloc_mutex_lock_final (mutex=0xb21380 <init_lock>) at include/jemalloc/internal/mutex.h:155
#4  je_malloc_mutex_lock_slow (mutex=mutex@entry=0xb21380 <init_lock>) at src/mutex.c:85
#5  0x00000000005516e0 in malloc_mutex_lock (tsdn=0x0, mutex=0xb21380 <init_lock>) at include/jemalloc/internal/mutex.h:221
#6  0x000000000040d271 in malloc_init_hard () at src/jemalloc.c:1739
#7  0x0000000000555b51 in malloc_init () at src/jemalloc.c:223
#8  imalloc_init_check (sopts=<optimized out>, dopts=<optimized out>) at src/jemalloc.c:2229
#9  imalloc (dopts=<synthetic pointer>, sopts=<synthetic pointer>) at src/jemalloc.c:2260
#10 calloc (num=1, size=32) at src/jemalloc.c:2494
#11 0x00007f077e9f8550 in _dlerror_run () from /lib64/libdl.so.2
#12 0x00007f077e9f8058 in dlsym () from /lib64/libdl.so.2
#13 0x00007f0780028bbc in sysconf (name=name@entry=30) at libsysconfcpus.c:108
#14 0x0000000000587396 in os_page_detect () at src/pages.c:429
#15 je_pages_boot () at src/pages.c:600
#16 0x000000000040d1a6 in malloc_init_hard_a0_locked () at src/jemalloc.c:1518
#17 0x000000000040d2d2 in malloc_init_hard () at src/jemalloc.c:1750
#18 0x000000000055494d in malloc_init () at src/jemalloc.c:223
#19 imalloc_init_check (sopts=<optimized out>, dopts=<optimized out>) at src/jemalloc.c:2229
#20 imalloc (dopts=<synthetic pointer>, sopts=<synthetic pointer>) at src/jemalloc.c:2260
#21 je_malloc_default (size=29) at src/jemalloc.c:2289
#22 0x00007f077f53fecd in operator new(unsigned long) () from /lib64/libstdc++.so.6
#23 0x00007f077f59ea19 in std::string::_Rep::_S_create(unsigned long, unsigned long, std::allocator<char> const&) () from /lib64/libstdc++.so.6
#24 0x00007f077f5a02a1 in char* std::string::_S_construct<char const*>(char const*, char const*, std::allocator<char> const&, std::forward_iterator_tag) () from /lib64/libstdc++.so.6
#25 0x00007f077f5a06d8 in std::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(char const*, std::allocator<char> const&) () from /lib64/libstdc++.so.6
#26 0x000000000042c8ed in __static_initialization_and_destruction_0 (__initialize_p=1, __priority=65535) at redis_metadata.h:33
#27 0x000000000042cb52 in _GLOBAL__sub_I__ZNK6Engine14MetadataFilter6FilterEiRKN7rocksdb5SliceES4_PSsPb () at compact_filter.cc:172
#28 0x00000000007e570d in __libc_csu_init ()
#29 0x00007f077ec1d495 in __libc_start_main () from /lib64/libc.so.6
#30 0x000000000042b45d in _start ()
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NTAxMjk2OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/54,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NTIwOTA5Nw==,kvrocks,585209097,54,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-12T13:38:51Z,2020-02-12T13:38:51Z,jemalloc 编译时修改 --with-jemalloc-prefix=je_ 解决问题,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NTIwOTA5Nw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/54,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NTQ5MzQzNw==,kvrocks,585493437,54,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-13T00:51:11Z,2020-02-13T00:51:11Z,"依赖包会自动安装 jemalloc, 镜像不需要再编译安装","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NTQ5MzQzNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/56,kvrocks,565856109,56,同步基本不可用,smartlee,1262498,BradLee,entropylee@gmail.com,CLOSED,2020-02-16T05:47:03Z,2020-02-20T10:55:52Z,"1) masterA 有数据 slaveA slaveof过来，数据可以同步，flushall masterA的数据， slaveA 没有同步清空掉。都执行过dbsize scan
2)masterB 没数据 slaveB 同步过来up后 ，masterB上执行写数据,数据没有同步到slaveB
3)slaveof后 slave节点上经常会报以下错误, 但这个目录是清空后再启动slave的
```
E0216 13:35:53.319345 26935 storage.cc:703] [storage] Failed to delete dir: IO error: file rmdir: ./kvrocksdatamaster/backup/meta: Directory not empty
E0216 13:35:53.415446 26935 replication.cc:584] [replication] Failed to restore backup while IO error: No such file or directoryWhile opening a file for sequentially reading: ./kvrocksdatamaster/backup/meta/5: No such file or directory
Segmentation fault (core dumped)
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/56/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NjY5MTIxNw==,kvrocks,586691217,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-16T10:41:38Z,2020-02-16T10:41:38Z,"你这个是在同步的时候手动删除 backup 目录吗, 另外你是主库和从库配置到同一个数目么，这个从库的错误看起来的 dir 名字是 master","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NjY5MTIxNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NjcxMjc0MA==,kvrocks,586712740,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-16T14:20:16Z,2020-02-16T14:20:16Z,"> 除 backup 目录吗, 另外你是主库和从库配置到同一个数目么，这个从库的错误看起来的 dir 名字是 mast

没有在同步的时候手动删除backup 恰恰是为了避免影响 在启动master和slave的之前清空配置的dir目录的所有文件 从库和主库用的是2个目录 应该是不影响的","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NjcxMjc0MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NjcxNjg2NA==,kvrocks,586716864,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-16T15:03:49Z,2020-02-16T15:03:49Z,恩，我自己重现看看，我是看你的错误日志应该是来自从库，backup 目录 `./kvrocksdatamaster/backup/meta` 看起来是 master,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NjcxNjg2NA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NzI2NDcyNA==,kvrocks,587264724,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-18T03:46:31Z,2020-02-18T03:46:31Z,@smartlee 第一个问题我根据你提供的步骤没办法重现你说的从库没有删除场景。能否针对这两个提供一下更加具体一些的重现场景呢？以及 kvrocks 版本,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NzI2NDcyNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NzM2Njk1Mg==,kvrocks,587366952,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-18T09:37:52Z,2020-02-18T09:37:52Z,"我这边是必现的 环境是ubuntu 18.04 kvrocks 1.1.5
1)启动一个data干净的master 端口是7777
2) 启动一个data干净的slave 端口是6666
3)master上set一条数据，slave slaveof过去，没办法同步，执行slaveof后，看到master是up,再执行dbsize scan 就报下面第二条错误
下面是master日志
```
Version: 1.1.5 @5037eb36
E0218 17:28:11.686477 19327 replication.cc:61] Ping slave[10.211.55.4:33444] err: Broken pipe, would stop the thread
E0218 17:29:44.503787 18831 redis_connection.cc:74] [connection] Going to remove the client: 10.211.55.4:33486, while encounter error: Connection reset by peer
E0218 17:31:56.020584 18831 redis_connection.cc:74] [connection] Going to remove the client: 10.211.55.4:33514, while encounter error: Connection reset by peer
```
下面是slave日志
```
Version: 1.1.5 @5037eb36
E0218 17:31:45.794822 20603 storage.cc:703] [storage] Failed to delete dir: IO error: file rmdir: ../kvrocksdata/backup/meta: Directory not empty
E0218 17:31:45.888485 20603 replication.cc:584] [replication] Failed to restore backup while IO error: No such file or directoryWhile opening a file for sequentially reading: ../kvrocksdata/backup/meta/5: No such file or directory
Segmentation fault (core dumped)
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NzM2Njk1Mg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NzM2OTAwMw==,kvrocks,587369003,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-18T09:41:59Z,2020-02-18T09:41:59Z,方便贴一下 master-slave 配置文件不，我直接用同样的配置来复现,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NzM2OTAwMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NzM3NzczNw==,kvrocks,587377737,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-18T10:00:49Z,2020-02-18T10:00:49Z,"除了 修改master的port  和 各自的data目录  其他的配置都是默认的 没改过
我将编出来的二进制分享出来了 链接：https://share.weiyun.com/5jTlpdW 密码：mcjn43 看看你那边能不能复现？

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4NzM3NzczNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAwMTQwMA==,kvrocks,588001400,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-19T02:20:47Z,2020-02-19T02:20:47Z,@smartlee 你这个我跑一下没问题，应该是配置问题，你可以帮忙上传一下配置文件，我用你配置文件重现。,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAwMTQwMA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAxNjExMg==,kvrocks,588016112,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-19T03:23:37Z,2020-02-19T03:23:37Z,"
[kvrocksmaster.txt](https://github.com/meitu/kvrocks/files/4222947/kvrocksmaster.txt)
[kvrocks.txt](https://github.com/meitu/kvrocks/files/4222948/kvrocks.txt)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAxNjExMg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAyNjk5NA==,kvrocks,588026994,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-19T04:17:04Z,2020-02-19T04:17:04Z,Failed to delete dir 这个报错 就是有其他线程占用 backup/meta这个文件夹 导致不能删除,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAyNjk5NA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAzMjMyNg==,kvrocks,588032326,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-19T04:41:42Z,2020-02-19T04:41:42Z,"又发现一个新的问题，slave master同步成功后，slaveof no one 然后slaveof master,这时候 master的数据没过来，master上报以下错误
```
E0219 12:28:59.611963  3726 replication.cc:61] Ping slave[127.0.0.1:41758] err: Broken pipe, would stop the thread
E0219 12:29:13.664692  3020 redis_cmd.cc:3391] Failed to open latest meta, err: NotFound: File missing: ./kvrocksdatamaster/backup/shared/000012.sst
E0219 12:29:23.680874  3020 redis_cmd.cc:3391] Failed to open latest meta, err: NotFound: File missing: ./kvrocksdatamaster/backup/shared/000012.sst
E0219 12:29:33.696867  3020 redis_cmd.cc:3391] Failed to open latest meta, err: NotFound: File missing: ./kvrocksdatamaster/backup/shared/000012.sst
E0219 12:29:43.712636  3020 redis_cmd.cc:3391] Failed to open latest meta, err: NotFound: File missing: ./kvrocksdatamaster/backup/shared/000012.sst
E0219 12:29:53.727731  3020 redis_cmd.cc:3391] Failed to open latest meta, err: NotFound: File missing: ./kvrocksdatamaster/backup/shared/000012.sst
E0219 12:30:03.744242  3020 redis_cmd.cc:3391] Failed to open latest meta, err: NotFound: File missing: ./kvrocksdatamaster/backup/shared/000012.sst
E0219 12:30:13.761349  3020 redis_cmd.cc:3391] Failed to open latest meta, err: NotFound: File missing: ./kvrocksdatamaster/backup/shared/000012.sst
E0219 12:36:01.589612  4245 replication.cc:61] Ping slave[127.0.0.1:41780] err: Broken pipe, would stop the thread
Segmentation fault (core dumped)

```
这时候即使重启master,依然如此，并且master上执行flushall 也会core

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAzMjMyNg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAzMjg3NQ==,kvrocks,588032875,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-19T04:44:21Z,2020-02-19T04:44:21Z,@smartlee 我拿你的二进制文件重现，对于 slave 配置不做 slaveof 也会 core， 我确认一下是不是包的问题。,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAzMjg3NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAzNTYzOA==,kvrocks,588035638,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-19T04:56:37Z,2020-02-19T04:56:37Z,"你编译的包有问题，对于 kvrocks.txt 配置，你提供的二进制文件启动去执行任何命令都会 core。然后你上面说的 master 在没 backup 完成重新 slaveof 会导致 core, 这个是 rocksdb backup 函数是非线程安全，这个已经在最新版本修复， commits : https://github.com/meitu/kvrocks/commit/4e1633704eef7546d73216341d27c0213d87a26a

你提供的这个二进制文件 core 属于的堆栈是在 libc 的 malloc, 可能跟你机器上 jemalloc 有关系。","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODAzNTYzOA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODA4NjIzMg==,kvrocks,588086232,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-19T08:03:07Z,2020-02-19T08:03:07Z,那奇怪了 jemalloc是指定链接的 而且make文件我也没改,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODA4NjIzMg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODEwOTQyNw==,kvrocks,588109427,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-19T09:00:50Z,2020-02-19T09:00:50Z,kvrocks 所有依赖都会自动下载编译，只要安装 REAMDE 提到的编译工具即可。你可以找个干净的环境编译测试。,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODEwOTQyNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODExODk2Mg==,kvrocks,588118962,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-19T09:23:24Z,2020-02-19T09:23:24Z,"我改了下jemalloc的变异配置 目前看没有找libc的那个段错误  但master的数据不会同步到SLAVE上 两边看LOG 没有任何异常日志 ，某次尝试 出现了以下LOG，还无法找到规律复现
```
E0219 17:09:43.968885 16879 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 17:09:44.970500 16879 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 17:09:45.971331 16879 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 17:09:46.972478 16879 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 17:09:47.974287 16879 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 17:09:48.975350 16879 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 17:09:49.976188 16879 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 17:09:50.977452 16879 replication.cc:127] [replication] connection error/eof, reconnect the master
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODExODk2Mg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODEzMjAwOQ==,kvrocks,588132009,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-19T09:53:49Z,2020-02-19T09:53:49Z,这是从库找不到主库，你检查一下 master ip:port,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODEzMjAwOQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODE1Mzc5Mw==,kvrocks,588153793,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-19T10:37:54Z,2020-02-19T10:37:54Z,"ip:Port肯定是没问题的  我调试了下 是libevent里面报错来的 看上去是异步connect timeout了，errno是115 ，也是偶发，你尝试将kvrocks slaveof到一个redis 上看看，应该能出现这种错误，前面的PING/PONG命令应该是通的 不该挂在这部有没有同步设计方面的文档，我也可以debug看看 目前看来调起来有点累 。
还是那个问题 
1)SLAVEOF过去 现在看上去UP了 这时候master上写数据 数据没同步过来，而且也看不到任何日志的错误
2)重启master ,老的master数据同步到slave上 同步完master的数据却到不了slave上，这时候SLAVE上看到的依然是UP
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODE1Mzc5Mw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODE1Njg5Ng==,kvrocks,588156896,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-19T10:45:26Z,2020-02-19T10:45:26Z,没明白你描述的问题，上面的错误信息来看就是 master 连不上。你可以在主库和从库都执行: `info replication` 贴一下信息,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODE1Njg5Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODE2NTEyOQ==,kvrocks,588165129,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-19T11:06:06Z,2020-02-19T11:06:06Z,"1）这种情况我在尝试将kvrocks slaveof到redis上会发生，我知道kvrocks同步redis肯定不行，但不应该卡在这个阶段，TCP的链接肯定是通的，所以我debug 看是libevent那边返回115了，目前看下来正常的kvrocks同步kvrocks也是有这种问题，但我不能稳定复现
2）最开始 清空master/slave data 启动 6666 slave 到master 7777
slave
```
127.0.0.1:6666> info replication
# Replication
role:slave
master_host:127.0.0.1
master_port:7777
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:2
slave_repl_offset:0
slave_priority:100
connected_slaves:0
127.0.0.1:6666> dbsize scan
OK
127.0.0.1:6666> dbsize
(integer) 0
```
master
```
127.0.0.1:7777> info replication
# Replication
role:master
connected_slaves:1
slave0:ip=127.0.0.1,port=6666,offset=0,lag=0
127.0.0.1:7777> dbsize scan
OK
127.0.0.1:7777> dbsize
(integer) 0
```
然后master上插入一条数据
```
127.0.0.1:7777> set hello world
OK
127.0.0.1:7777> dbsize
(integer) 0
127.0.0.1:7777> dbsize scan
OK
127.0.0.1:7777> dbsize
(integer) 1
127.0.0.1:7777> info replication
# Replication
role:master
connected_slaves:1
slave0:ip=127.0.0.1,port=6666,offset=0,lag=1

```
slave上看不到该数据 ,并且没有任何报错
```
127.0.0.1:6666> dbsize scan
OK
127.0.0.1:6666> dbsize
(integer) 0
127.0.0.1:6666> get hello
(nil)
127.0.0.1:6666> info replication
# Replication
role:slave
master_host:127.0.0.1
master_port:7777
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:1
slave_repl_offset:0
slave_priority:100
connected_slaves:0

```
重启slave 再slaveof到master,这时候
* 有时候会看到刚刚set 的那条hello数据，并且slave上看到master是up的，但 master上新set的数据依然看不到
* 有时候slave上有如下错误
```
Version: 1.1.5 @5037eb36
E0219 19:00:10.650616  7196 storage.cc:704] [storage] Failed to delete dir: IO error: file rmdir: /media/psf/Home/source/ssdredis/kvrocks/kvrocksdata/backup/meta: Directory not empty
E0219 19:00:10.751323  7196 replication.cc:584] [replication] Failed to restore backup while IO error: No such file or directoryWhile opening a file for sequentially reading: /media/psf/Home/source/ssdredis/kvrocks/kvrocksdata/backup/meta/2: No such file or directory
```
```
Version: 1.1.5 @5037eb36
E0219 18:36:51.331737  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:36:52.335036  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:36:53.335779  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:36:54.336560  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:36:55.337985  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:36:56.339429  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:36:57.339993  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:36:58.340760  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:36:59.341384  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:37:00.342509  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:37:01.343118  1818 replication.cc:127] [replication] connection error/eof, reconnect the master
E0219 18:37:02.343657  1818 replication.cc:127] [replication] connection error/eof, reconnect the master

```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODE2NTEyOQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODkzNzUxMA==,kvrocks,588937510,56,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-20T10:42:04Z,2020-02-20T10:42:04Z,"问题出现在文件系统上 我是mac上装的parallels desktop 里面跑的linux,共享了mac上的文件夹，这个mount出来的文件系统叫prl_fs 看上去是不支持一些linux文件操作的系统调用 我换到xfs目录上就好了 @git-hulk 多谢支持","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODkzNzUxMA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODk1NTI4Mg==,kvrocks,588955282,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-20T10:54:54Z,2020-02-20T10:54:54Z,@smartlee 收到~ 赞,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODk1NTI4Mg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/56,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODk1NjQ5OQ==,kvrocks,588956499,56,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-20T10:55:52Z,2020-02-20T10:55:52Z,我关闭这个 PR ，有问题再重新打开,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODk1NjQ5OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/57,https://api.github.com/repos/apache/kvrocks/issues/57,kvrocks,568211895,57,QPS测试对比PIKA,smartlee,1262498,BradLee,entropylee@gmail.com,CLOSED,2020-02-20T10:48:16Z,2020-04-20T05:59:19Z,"对比了下和pika的性能测试，以下面的SET命令为例，不挂slave
```
redis-benchmark -t set -n 100000 -r 100000 -d 102400 -h host -p port
```
pika大概QPS稳定在2000+,kvrocks的大概900多，想请教是否有性能编译方面的优化建议以达到和pika差不多的性能？","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/57/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/57,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODk1OTE1NA==,kvrocks,588959154,57,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-02-20T10:57:46Z,2020-02-20T10:57:46Z,这个不太应该，我之前测试数据来看性能是差不多。你看看配置的worker 线程数是否一直，kvrocks 默认只有 4,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODk1OTE1NA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/57,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODk2NDA3MQ==,kvrocks,588964071,57,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-02-20T11:03:38Z,2020-02-20T11:03:38Z,"> 这个不太应该，我之前测试数据来看性能是差不多。你看看配置的worker 线程数是否一直，kvrocks 默认只有 4

上面这个命令   你那边得到的QPS 是多少？我这边测试的机器也是E5的CPU kvrocks.conf里面配置worker的数量是8","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU4ODk2NDA3MQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/62,kvrocks,574777284,62,提个bug,smartlee,1262498,BradLee,entropylee@gmail.com,CLOSED,2020-03-03T16:11:24Z,2020-03-11T11:11:48Z,"https://github.com/meitu/kvrocks/blob/2ff46ef91d47f37945354d3a9e77ad49f33c4ce0/src/redis_request.cc#L49
这地方不能return ok,否则可能会导致命令断流，解析出错，我这边可以稳定复现，只能break。","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/62/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NDI4MDI4OQ==,kvrocks,594280289,62,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-04T02:14:01Z,2020-03-04T02:14:01Z,@smartlee 可以帮忙提供一下问题和复现步骤,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NDI4MDI4OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NDMwMjEyNA==,kvrocks,594302124,62,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-04T03:11:06Z,2020-03-04T03:11:06Z,"这个是在流量大的时候必定会出现，考虑一下发过来几百条这样的命令
*3$3set$1a$1a
*3$3set$1a中断第一次收结束，在Bulklen这地方返回OK，这个地方解析执行会返回错误
第二次开始$1a
*3$3set$1a$1a
*3$3set$1a$1a

我们测试的例子就是
*3
$7
PUBLISH
$18
__sentinel__:hello
$104 这个地方中断了 后面这104个字符这次没有收到，下次接受才能收到，但这个地方执行的话就会报错


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NDMwMjEyNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NDMxNTA5NQ==,kvrocks,594315095,62,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-04T04:05:33Z,2020-03-04T04:05:33Z,感谢反馈~,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NDMxNTA5NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAwMjQzMA==,kvrocks,595002430,62,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-05T02:56:24Z,2020-03-05T02:56:24Z,"补充下 后续测试发现的问题
这个地方处理起来得非常小心，否则就出错，先纠正下上面的错误这个地方，我的修改成break也是有问题的，这些问题在流量小的时候可能都不存在，但是一个定时炸弹，在大流量的时候就出问题了。
* 首先 BulkLen，BulkData这个地方如果收不到数据，必须等libevent回调过来继续收，所以我上面说break，让它继续循环，其实一直会收不到数据，因为libevent底层在处理缓冲区时加锁，一直死循环导致一直无法填充底层的buffer,所以一直在while true里面卡住了，而且usleep一段时间再break也不行，所以最好的方法就是等libevent底层回调，但这个地方直接返回ok也是有问题的，因为无法正确处理是否正确处理了一次循环，还是等待下次继续处理，还是出错，比较好的方式是，Status里面应该加retry语义的字段类似linux的EAGAIN，上层再通过判断是否该retry来继续处理。
* 其次 如果是retry的情况，必须保留上次处理的context信息，比如上次处理SET A A这条请求，执行到SET的时候发现收不到数据了，那么tokens里面得保留SET这个记录，也就说Tokenize 这个函数进入必须要判断是否接着上次没收完的命令继续收，还是执行一个新的命令开始？这样Redis::Request这个class里面的变量都初始化为0是不对的，得在Tokenize判断，而判断的准则则是是否一个干净的状态进入。
* 再次 if (multi_bulk_len_ == 0) 这个地方我觉得应该退出，进入干净状态，否则依赖底层是否能收到数据来退出，commands_里面的命令可能尾部是不完整的。
* 最后BulkData 这个地方evbuffer_pullup(input, bulk_len_ + 2) 返回值不可预期，可能会导致返回与预期不一致的数据，最终导致解析出错，我觉得调用evbuffer_readln来判断len和bulk_len_是否相等更合适，指定\r\n返回的话，在没遇到\r\n的时候，libevent是不会返回任何数据的。
``` c
        line = evbuffer_readln(input, &len, EVBUFFER_EOL_CRLF_STRICT);
        if (!line || len <= 0) {
          return Status(Status::Retry, ""BulkData Need more data... wait next loop...."");
        }
        if (len != bulk_len_){
          std::cout<< ""except len:"" << bulk_len_ << "" real len:""<< len<<std::endl;
          return Status(Status::NotOK, ""Protocol error: except len:""+std::to_string(bulk_len_)+ ""real len:""+ std::to_string(len));
        }
```
补充一点,下面这段代码是干什么用的？不是很明白，按正常的协议流程，永远也走不到这里。
```  c
          Util::Split(std::string(line, len), "" \t"", &tokens_);
          commands_.push_back(std::move(tokens_));
          state_ = ArrayLen;
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAwMjQzMA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAwNTcxMQ==,kvrocks,595005711,62,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-05T03:10:42Z,2020-03-05T03:10:42Z,"这个地方返回 Status::Again() 类似的状态就可以了，下次进来以及解析的 token 信息仍然不会消失

```c
          Util::Split(std::string(line, len), "" \t"", &tokens_);
          commands_.push_back(std::move(tokens_));
          state_ = ArrayLen;
```
这个是 Redis 支持 inline 协议","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAwNTcxMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAwNjE4OQ==,kvrocks,595006189,62,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-05T03:13:01Z,2020-03-05T03:13:01Z,"> 最后BulkData 这个地方evbuffer_pullup(input, bulk_len_ + 2) 返回值不可预期，可能会导致返回与预期不一致的数据，最终导致解析出错，我觉得调用evbuffer_readln来判断len和bulk_len_是否相等更合适，指定\r\n返回的话，在没遇到\r\n的时候，libevent是不会返回任何数据的。

Redis 是二进制安全的协议，也就是应该要能允许数据里面携带 `\r\n` 字符，所以直接获取 bulk_len + 2 才是对的，不能按照 \r\n 来判断","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAwNjE4OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAyOTc1Ng==,kvrocks,595029756,62,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-05T05:00:47Z,2020-03-05T05:00:47Z,"> > 最后BulkData 这个地方evbuffer_pullup(input, bulk_len_ + 2) 返回值不可预期，可能会导致返回与预期不一致的数据，最终导致解析出错，我觉得调用evbuffer_readln来判断len和bulk_len_是否相等更合适，指定\r\n返回的话，在没遇到\r\n的时候，libevent是不会返回任何数据的。
> 
> Redis 是二进制安全的协议，也就是应该要能允许数据里面携带 `\r\n` 字符，所以直接获取 bulk_len + 2 才是对的，不能按照 \r\n 来判断

我意思是 evbuffer_pullup可能返回任何值 不一定是预期的值 我调试的时候 bulk_len_是 7 返回字符串可能是9之内的任何值,因为buffer可能没那么多数据，那就要等待下次callback再取。redis 行为中 set a `\r\n` 再去get a 返回是`\\r\\n`,所以evbuffer_readln没问题","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAyOTc1Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAzODUyOA==,kvrocks,595038528,62,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-05T05:38:50Z,2020-03-05T05:38:50Z,"> > > 最后BulkData 这个地方evbuffer_pullup(input, bulk_len_ + 2) 返回值不可预期，可能会导致返回与预期不一致的数据，最终导致解析出错，我觉得调用evbuffer_readln来判断len和bulk_len_是否相等更合适，指定\r\n返回的话，在没遇到\r\n的时候，libevent是不会返回任何数据的。
> > 
> > 
> > Redis 是二进制安全的协议，也就是应该要能允许数据里面携带 `\r\n` 字符，所以直接获取 bulk_len + 2 才是对的，不能按照 \r\n 来判断
> 
> 我意思是 evbuffer_pullup可能返回任何值 不一定是预期的值 我调试的时候 bulk_len_是 7 返回字符串可能是9之内的任何值,因为buffer可能没那么多数据，那就要等待下次callback再取。redis 行为中 set a `\r\n` 再去get a 返回是`\\r\\n`,所以evbuffer_readln没问题

这个在 evbuffer_pullup 上一行代码对 buffer 的长度做了判断，所以应该没有问题","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTAzODUyOA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTA1MjEwMw==,kvrocks,595052103,62,NA,karelrooted,523980,karelrooted,,NA,2020-03-05T06:29:24Z,2020-03-05T06:29:24Z,"> 这个是在流量大的时候必定会出现，考虑一下发过来几百条这样的命令
> *3$3set$1a$1a
> *3$3set$1a中断第一次收结束，在Bulklen这地方返回OK，这个地方�解析执行会返回错误
> 第二次开始$1a
> *3$3set$1a$1a
> *3$3set$1a$1a
> 
> 我们测试的例子就是
> *3
> $7
> PUBLISH
> $18
> **sentinel**:hello
> $104 这个地方中断了 后面这104个字符这次没有收到，下次接受才能收到，但这个地方执行的话就会报错

这个地方的重现步骤有没有什么重现的代码程序方式之类的提供一下？我试了用redis-benchmark及在线上查了一批日志，重现不了这种错误，错误是INFO日志里面有这种信息“Failed to tokenize the request, encounter error:” ？

代码里判定了若  multi_bulk_len_ ==0 才会将 tokens_ 赋值给 commands_, 所以理论上 只收到一部分，返回OK是不会触发执行一部分的命令的，会在后续的OnRead event中等完整的命令信息接收完毕，才会执行那条完整的命令","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTA1MjEwMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/62,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTA1NTI5Mg==,kvrocks,595055292,62,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-05T06:41:25Z,2020-03-05T06:41:25Z,"> > 这个是在流量大的时候必定会出现，考虑一下发过来几百条这样的命令
> > *3$3set$1a$1a
> > *3$3set$1a中断第一次收结束，在Bulklen这地方返回OK，这个地方�解析执行会返回错误
> > 第二次开始$1a
> > *3$3set$1a$1a
> > *3$3set$1a$1a
> > 我们测试的例子就是
> > *3
> > $7
> > PUBLISH
> > $18
> > **sentinel**:hello
> > $104 这个地方中断了 后面这104个字符这次没有收到，下次接受才能收到，但这个地方执行的话就会报错
> 
> 这个地方的重现步骤有没有什么重现的代码程序方式之类的提供一下？我试了用redis-benchmark及在线上查了一批日志，重现不了这种错误，错误是INFO日志里面有这种信息“Failed to tokenize the request, encounter error:” ？
> 
> 代码里判定了若 multi_bulk_len_ ==0 才会将 tokens_ 赋值给 commands_, 所以理论上 只收到一部分，返回OK是不会触发执行一部分的命令的，会在后续的OnRead event中等完整的命令信息接收完毕，才会执行那条完整的命令

我这边是在实现同步redis作为master的实现的时候发现的，实现上跟代码里现有的有区别，仔细看了下原来的逻辑，的确是return ok不会导致报错，为了防止万一 我不复用这个函数，重复写个类似的 来接受master的命令，原来的逻辑保持原样 ，看看能不能复现，但愿是我不小心误用。
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NTA1NTI5Mg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/63,https://api.github.com/repos/apache/kvrocks/issues/63,kvrocks,574783722,63,slaveof redis的支持,smartlee,1262498,BradLee,entropylee@gmail.com,CLOSED,2020-03-03T16:21:03Z,2020-04-20T05:59:27Z,"因为我们实际业务需要，要支持kvrocks slaveof redis实例，目前这部分代码我已经实现了个最短路径：
* 支持redis的psync协议
* 解析redis的rdb文件
* 将rdb文件同步到kvrocks中
* 定期replconf ack offset
代码已经在测试环境跑通，当然距离真正上线还有断时间，此外redis slaveof kvrocks也在下步计划中想知道完善后是否可以将这部分代码提到到本仓库？因为可能有其他公司有类似的需求。","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/63/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/63,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NDI4MTAwNQ==,kvrocks,594281005,63,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-04T02:16:52Z,2020-03-04T02:16:52Z,欢迎，这两个东西建议拆分提,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5NDI4MTAwNQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/64,https://api.github.com/repos/apache/kvrocks/issues/64,kvrocks,579822964,64,段错误,smartlee,1262498,BradLee,entropylee@gmail.com,CLOSED,2020-03-12T10:02:18Z,2020-03-19T11:06:42Z,"运行一段时间经常会段错误，抓了core看了下，可能问题是在evbuffer_drain这里面，
chain这个地方为空指针取值了，网上搜了下，指出bufferevent_socket_new 的时候要加BEV_OPT_THREADSAFE，猜测可能是这个问题。
![image](https://user-images.githubusercontent.com/1262498/76509672-5bb45c80-648b-11ea-94f2-8ab361b75050.png)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/64/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/64,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODEwNTYwOA==,kvrocks,598105608,64,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-12T10:08:15Z,2020-03-12T10:08:15Z,这个看起来不是 kvrocks 的堆栈来着,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODEwNTYwOA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/64,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODE1MTAyMw==,kvrocks,598151023,64,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-12T12:07:11Z,2020-03-12T12:07:11Z,"的确是kvrocks的堆栈
![image](https://user-images.githubusercontent.com/1262498/76520003-fe290b80-649c-11ea-9027-93be85831c61.png)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODE1MTAyMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/64,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODE3NjE0MQ==,kvrocks,598176141,64,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-12T13:09:47Z,2020-03-12T13:09:47Z,"可以执行一下 bt, 贴一下","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODE3NjE0MQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/64,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODUyMDIxNQ==,kvrocks,598520215,64,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-13T02:39:34Z,2020-03-13T02:39:34Z,"![image](https://user-images.githubusercontent.com/1262498/76584381-bb0b7e80-6516-11ea-9d8f-25b1c74ac691.png)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODUyMDIxNQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/64,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODUyMTY5OA==,kvrocks,598521698,64,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-13T02:46:04Z,2020-03-13T02:46:04Z,这个是你修改过的代码吧？kvrocks 的连接是线程内独占的，不会有 data race，另外这个堆栈看起来是修改过的代码。,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODUyMTY5OA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/64,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODUyNzAxMA==,kvrocks,598527010,64,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-13T03:09:08Z,2020-03-13T03:09:08Z,worker这边我没有动过 我是改了master-repl  线程的代码 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDU5ODUyNzAxMA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/64,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMTAzNzkyNA==,kvrocks,601037924,64,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-19T07:55:16Z,2020-03-19T07:55:16Z,看了十几个core文件 发现了问题 的确是我们改的代码引起的  改的代码引出同步redis 的线程，但这个线程在命令传播阶段会偶尔跟处理客户端的线程访问同一个evbuffer  非常奇怪 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMTAzNzkyNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/64,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMTA0MTkzOQ==,kvrocks,601041939,64,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-19T08:05:54Z,2020-03-19T08:05:54Z,恩，kvrocks 里面的连接都是线程内的，不会有 data race，你那边设计上也需要调整一下,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMTA0MTkzOQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/66,https://api.github.com/repos/apache/kvrocks/issues/66,kvrocks,583504417,66,Avoid unnecessary `generation_version` in Metadata constructor,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2020-03-18T06:43:47Z,2020-03-19T11:06:09Z,"the metadata constructor would always generate a new version with `srandom`, and may cause performance degraded.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/66/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/68,kvrocks,585886578,68,deadlock,smartlee,1262498,BradLee,entropylee@gmail.com,CLOSED,2020-03-23T02:38:09Z,2020-03-29T17:27:26Z,"目前发现一个deadlock，原始代码没有复现，我改写的代码会出现，大概几天会出现一次，看原始代码觉得可能也有这个隐患，以下是deadlock时候的堆栈，如有不正确，请指正谢谢！
```
Thread 7 (Thread 0x7fe5e47f8700 (LWP 97)):
#0  0x00007fe5f8f4ef4d in __lll_lock_wait () from /lib64/libpthread.so.0
#1  0x00007fe5f8f4ad02 in _L_lock_791 () from /lib64/libpthread.so.0
#2  0x00007fe5f8f4ac08 in pthread_mutex_lock () from /lib64/libpthread.so.0
#3  0x00000000004437d8 in __gthread_mutex_lock(pthread_mutex_t*) ()
#4  0x0000000000443b10 in std::mutex::lock() ()
#5  0x00000000004db93a in std::lock_guard<std::mutex>::lock_guard(std::mutex&) ()
#6  0x00000000004f7731 in Server::UnSubscribeChannel(std::string const&, Redis::Connection*) ()
#7  0x00000000004a7eee in Redis::Connection::UnSubscribeAll() ()
#8  0x00000000004a723d in Redis::Connection::~Connection() ()
#9  0x00000000005223bd in Worker::FreeConnectionByID(int, unsigned long) ()
#10 0x00000000005235b2 in Worker::KickoutIdleClients(int) ()
#11 0x000000000052158e in Worker::TimerCB(int, short, void*) ()

Thread 2 (Thread 0x7fe5e7fff700 (LWP 129)):
#0  0x00007fe5f8f4ef4d in __lll_lock_wait () from /lib64/libpthread.so.0
#1  0x00007fe5f8f4ad02 in _L_lock_791 () from /lib64/libpthread.so.0
#2  0x00007fe5f8f4ac08 in pthread_mutex_lock () from /lib64/libpthread.so.0
#3  0x00000000004437d8 in __gthread_mutex_lock(pthread_mutex_t*) ()
#4  0x0000000000443b10 in std::mutex::lock() ()
#5  0x00000000004efc87 in std::unique_lock<std::mutex>::lock() ()
#6  0x00000000004ee65d in std::unique_lock<std::mutex>::unique_lock(std::mutex&) ()
#7  0x0000000000522665 in Worker::Reply(int, std::string const&) ()
#8  0x00000000004f7288 in Server::PublishMessage(std::string const&, std::string const&) ()
#9  0x000000000048d06f in Redis::CommandPublish::Execute(Server*, Redis::Connection*, std::string*) ()

```

1）一个worker获得了server的锁 pubsub_channels_mu_ 等待worker的锁conns_mu_ 线程2
另外一个定时器触发，到时间清理timeout的链接 线程7 获得了worker的锁conns_mu_在connection析构时会等待server的锁 pubsub_channels_mu_，就卡死在这里

2） KickoutIdleClients 这个函数的行为不是很理解，按理是清理conns_和monitor_conns_的连接数，但这里面并没有遍历monitor_conns_的map,却在FreeConnectionByID里面去找monitor_conns_，此外这个地方难道不是直接map erase掉conns_和monitor_conns_，并将符合条件的加入到to_be_killed_conns里面更好？这样FreeConnectionByID无需加锁。","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/68/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjM0NjQ3MA==,kvrocks,602346470,68,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-23T02:52:01Z,2020-03-23T02:52:01Z,这里确实是会有死锁的可能性,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjM0NjQ3MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQyNDcwMw==,kvrocks,602424703,68,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-23T07:15:18Z,2020-03-23T07:15:18Z,@karelrooted 帮忙看看我的第二个问题,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQyNDcwMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ0MzA1OQ==,kvrocks,602443059,68,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-23T08:04:43Z,2020-03-23T08:04:43Z,"@smartlee 不能直接去 erase 连接，因为在关闭连接(destroy connection)时需要 unscribe 所有的 topic, 也会造成锁嵌套","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ0MzA1OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ0NzUzNA==,kvrocks,602447534,68,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-23T08:15:57Z,2020-03-23T08:15:57Z,"我测试了下  将timeout的保存下来，erase 不会造成关闭连接 也不会导致connection*的析构 
此外还是这个问题 monitor_conns_ 这个并没有在KickoutIdleClients 中find出来 却在FreeConnectionByID中find? 不是很明白这部分逻辑","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ0NzUzNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ1MjcwOQ==,kvrocks,602452709,68,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-23T08:28:49Z,2020-03-23T08:28:49Z,"> 我测试了下 将timeout的保存下来，erase 不会造成关闭连接 也不会导致connection*的析构

connection 需要关闭，所以要释放掉

后面的 `monitor_conns_ ` 确实不需要，这块因为跟死锁没关系，所以单独 FIX","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ1MjcwOQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ1OTIzMQ==,kvrocks,602459231,68,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-23T08:44:01Z,2020-03-23T08:44:01Z,@git-hulk 我的意思是用中间map缓存符合timeout 的connection* ，缓存后conns_中的connection*是可以erase掉的，缓存map中的connection*在FreeConnectionByID释放，而这个释放是不用加锁的,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ1OTIzMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ4OTU1Ng==,kvrocks,602489556,68,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-03-23T09:48:43Z,2020-03-23T09:48:43Z,"@smartlee 这个是不可以的 `conns_` 本身会有线程之间的 data race, 遍历一定需要加锁","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjQ4OTU1Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjk3NjkzNw==,kvrocks,602976937,68,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-24T02:41:20Z,2020-03-24T02:41:20Z, erase conn_的时候加锁没问题，我意思是erase之前将conn_中timeout的connection* 放到中间map中，FreeConnectionByID中释放map中的connection*  ，FreeConnectionByID可以不用锁，也就避免了死锁。,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjk3NjkzNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjk4OTQ4NQ==,kvrocks,602989485,68,NA,karelrooted,523980,karelrooted,,NA,2020-03-24T03:19:44Z,2020-03-24T03:19:44Z,"> erase conn_的时候加锁没问题，我意思是erase之前将conn_中timeout的connection* 放到中间map中，FreeConnectionByID中释放map中的connection* ，FreeConnectionByID可以不用锁，也就避免了死锁。

代码里面其中有一个命令是client kill {conn_id},  可以在A worker thread里把 B worker thread的连接杀掉，所以只要是delete conntion都必须要加锁","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMjk4OTQ4NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/68,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMzYyMjIzNw==,kvrocks,603622237,68,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2020-03-25T03:37:34Z,2020-03-25T03:37:34Z,@karelrooted 看了下 的确是我疏忽了这点 谢谢解释,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYwMzYyMjIzNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/81,kvrocks,611938924,81,build error with master,tkram01,17167349,,,CLOSED,2020-05-04T14:55:09Z,2020-05-04T16:00:13Z,"Hi,

I'm getting the following build error when trying to build from git.

[ 87%] Building CXX object CMakeFiles/kvrocks2redis.dir/tools/kvrocks2redis/parser.cc.o
[ 88%] Linking CXX executable kvrocks2redis
/usr/bin/ld: cannot find -lstdc++
collect2: error: ld returned 1 exit status
make[2]: *** [kvrocks2redis] Error 1
make[1]: *** [CMakeFiles/kvrocks2redis.dir/all] Error 2
make: *** [all] Error 2

 - OS: Red Hat Enterprise Linux Server release 7.2 (Maipo)


**To Reproduce**
Steps to reproduce the behavior:
1. sh build.sh build","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/81/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUxODMxNg==,kvrocks,623518316,81,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-05-04T15:03:48Z,2020-05-04T15:03:48Z,"It seems that libstdc++ wasn't installed, you can try:

```shell
sudo yum install libstdc++
sudo yum install libstdc++-devel
sudo yum install libstdc++-static
```

or use `sudo yum search libstdc++` to to see the matching packages","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUxODMxNg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUyMDAzNw==,kvrocks,623520037,81,NA,tkram01,17167349,,,NA,2020-05-04T15:07:00Z,2020-05-04T15:07:00Z,"this is what is installed

rpm -q -a | grep libstd

libstdc++-devel-4.8.5-4.el7.x86_64
libstdc++-4.8.5-4.el7.x86_64","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUyMDAzNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUyMDE2Ng==,kvrocks,623520166,81,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-05-04T15:07:16Z,2020-05-04T15:07:16Z,"@tkram01 by the way, you should use the Makefile instead of build.sh

```
# install the snappy first
$ sudo yum install -y snappy snappy-devel  
$ make -j4
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUyMDE2Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUyMjY4OQ==,kvrocks,623522689,81,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-05-04T15:11:35Z,2020-05-04T15:11:35Z,"> this is what is installed
> 
> rpm -q -a | grep libstd
> 
> libstdc++-devel-4.8.5-4.el7.x86_64
> libstdc++-4.8.5-4.el7.x86_64

you can try to fix it by installing the libstdc++-static package as well","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUyMjY4OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUyOTIxNw==,kvrocks,623529217,81,NA,tkram01,17167349,,,NA,2020-05-04T15:22:18Z,2020-05-04T15:22:18Z,"When using the Makefile I get

[appsuser@xxx kvrocks]$ make
cd src && make all
You need to run this command from the toplevel of the working tree.
make[1]: Entering directory `/apps/appsuser/kvrocks/src'

Hint: Fetching submodules from the remote
git submodule init
You need to run this command from the toplevel of the working tree.
make[1]: *** [SUBMODULES] Error 1
make[1]: Leaving directory `/apps/appsuser/kvrocks/src'
make: *** [all] Error 2","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUyOTIxNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUzMTAwNA==,kvrocks,623531004,81,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-05-04T15:25:13Z,2020-05-04T15:25:13Z,"> You need to run this command from the toplevel of the working tree.

you should run the `make` command from toplevel of the working tree instead of src ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUzMTAwNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUzMzI4MQ==,kvrocks,623533281,81,NA,tkram01,17167349,,,NA,2020-05-04T15:29:04Z,2020-05-04T15:29:04Z,"I did...

[appsuser@xxx kvrocks]$ pwd
/cluster/home/appsuser/kvrocks
[appsuser@xxx kvrocks]$ make
cd src && make all
You need to run this command from the toplevel of the working tree.
make[1]: Entering directory `/apps/appsuser/kvrocks/src'

Hint: Fetching submodules from the remote
git submodule init
You need to run this command from the toplevel of the working tree.
make[1]: *** [SUBMODULES] Error 1
make[1]: Leaving directory `/apps/appsuser/kvrocks/src'
make: *** [all] Error 2
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzUzMzI4MQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzU0MTY1MA==,kvrocks,623541650,81,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-05-04T15:43:20Z,2020-05-04T15:43:20Z,"It seems that working dir didn't work in Redhat, you can replace the `src/Makefile` line 12:

```
clone_dependencies := $(shell sh -c 'git submodule init && git submodule update')
```
with
```
clone_dependencies := $(shell sh -c 'cd .. && git submodule init && git submodule update && cd src')
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzU0MTY1MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/81,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzU1MTU5NQ==,kvrocks,623551595,81,NA,tkram01,17167349,,,NA,2020-05-04T16:00:12Z,2020-05-04T16:00:12Z,working now - thanks!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDYyMzU1MTU5NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/86,https://api.github.com/repos/apache/kvrocks/issues/86,kvrocks,617149811,86,Bug: don't check the client idle timeout in replication thread,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2020-05-13T05:18:11Z,2020-05-13T09:24:30Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/86/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/95,https://api.github.com/repos/apache/kvrocks/issues/95,kvrocks,645126499,95,Support column families in KVRocks,aniruddhadas,7406432,Aniruddha Das,das.aniruddha@live.com,CLOSED,2020-06-25T03:53:16Z,2021-11-22T13:41:51Z,"Hi,

I couldn't find anyway of setting up new column families in KVRocks. Is there a way to setup a new namespace KVRocks and execute (redis-cli --pipe) commands against the new column family?

Thanks,
Aniruddha","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/95/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/95,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MDY4Mjk2Nw==,kvrocks,650682967,95,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-06-28T03:18:55Z,2020-06-28T03:18:55Z,"hi @aniruddhadas ,  you can use `namespace` command to create/delete/set/list namespaces: https://github.com/bitleak/kvrocks#namspace , but the new namespace wouldn't create new column family actually.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MDY4Mjk2Nw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/95,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MTIxOTg2OQ==,kvrocks,651219869,95,NA,aniruddhadas,7406432,Aniruddha Das,das.aniruddha@live.com,NA,2020-06-29T16:13:46Z,2020-06-29T16:13:46Z,i see thanks @git-hulk.. does using namespace guarantee compartmentalization? or does the data in 2 different namespaces share the same memtables and ssts?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MTIxOTg2OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/95,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MTQ0NDQ5Nw==,kvrocks,651444497,95,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-06-30T00:36:28Z,2020-06-30T00:36:28Z,"yeah, we use namespace as  the key prefix instead of different column families","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MTQ0NDQ5Nw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/96,https://api.github.com/repos/apache/kvrocks/issues/96,kvrocks,646527822,96,Plan to RocksDB.GetProperty(prop)?,aniruddhadas,7406432,Aniruddha Das,das.aniruddha@live.com,CLOSED,2020-06-26T21:46:08Z,2022-07-30T05:05:42Z,"Hi,

Is there are plan to expose the data in: rokuDB.getProperty(""rocksdb.stats"") in the near future?

Thanks
Aniruddha","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/96/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/96,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MDY3MDgzMg==,kvrocks,650670832,96,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-06-28T02:03:16Z,2020-06-28T02:03:16Z,@aniruddhadas the info command supported `info rocksdb` now,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MDY3MDgzMg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/96,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MTIxODkzNQ==,kvrocks,651218935,96,NA,aniruddhadas,7406432,Aniruddha Das,das.aniruddha@live.com,NA,2020-06-29T16:12:11Z,2020-06-29T16:12:11Z,"thanks @git-hulk. I wanted something more along the lines of:

`rocksDB.getProperty(""rocksdb.stats"");`

in Rocks DB the output is something like this:

** Compaction Stats [default] **
Level    Files   Size     Score Read(GB)  Rn(GB) Rnp1(GB) Write(GB) Wnew(GB) Moved(GB) W-Amp Rd(MB/s) Wr(MB/s) Comp(sec) CompMergeCPU(sec) Comp(cnt) Avg(sec) KeyIn KeyDrop
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  L0      1/0   27.67 MB   0.2      0.0     0.0      0.0       0.0      0.0       0.0   0.0      0.0      0.0      0.00              0.00         0    0.000       0      0
  L1      6/0   250.68 MB   1.0      0.0     0.0      0.0       0.0      0.0       0.0   0.0      0.0      0.0      0.00              0.00         0    0.000       0      0
  L2     59/0    2.47 GB   1.0      0.0     0.0      0.0       0.0      0.0       0.0   0.0      0.0      0.0      0.00              0.00         0    0.000       0      0
  L3    450/0   24.96 GB   1.0      0.0     0.0      0.0       0.0      0.0       0.0   0.0      0.0      0.0      0.00              0.00         0    0.000       0      0
  L4    983/0   61.31 GB   0.2      0.0     0.0      0.0       0.0      0.0       0.0   0.0      0.0      0.0      0.00              0.00         0    0.000       0      0
 Sum   1499/0   89.01 GB   0.0      0.0     0.0      0.0       0.0      0.0       0.0   0.0      0.0      0.0      0.00              0.00         0    0.000       0      0
 Int      0/0    0.00 KB   0.0      0.0     0.0      0.0       0.0      0.0       0.0   0.0      0.0      0.0      0.00              0.00         0    0.000       0      0

** Compaction Stats [default] **
Priority    Files   Size     Score Read(GB)  Rn(GB) Rnp1(GB) Write(GB) Wnew(GB) Moved(GB) W-Amp Rd(MB/s) Wr(MB/s) Comp(sec) CompMergeCPU(sec) Comp(cnt) Avg(sec) KeyIn KeyDrop
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Uptime(secs): 11824.1 total, 420.1 interval
Flush(GB): cumulative 0.000, interval 0.000
AddFile(GB): cumulative 0.000, interval 0.000
AddFile(Total Files): cumulative 0, interval 0
AddFile(L0 Files): cumulative 0, interval 0
AddFile(Keys): cumulative 0, interval 0
Cumulative compaction: 0.00 GB write, 0.00 MB/s write, 0.00 GB read, 0.00 MB/s read, 0.0 seconds
Interval compaction: 0.00 GB write, 0.00 MB/s write, 0.00 GB read, 0.00 MB/s read, 0.0 seconds
Stalls(count): 0 level0_slowdown, 0 level0_slowdown_with_compaction, 0 level0_numfiles, 0 level0_numfiles_with_compaction, 0 stop for pending_compaction_bytes, 0 slowdown for pending_compaction_bytes, 0 memtable_compaction, 0 memtable_slowdown, interval 0 total count

** File Read Latency Histogram By Level [default] **
** Level 0 read latency histogram (micros):
Count: 595411 Average: 4.8964  StdDev: 1.71
Min: 2  Median: 4.7328  Max: 82
Percentiles: P50: 4.73 P75: 5.40 P99: 8.78 P99.9: 31.12 P99.99: 46.36
------------------------------------------------------
(       1,       2 ]    29242   4.911%   4.911% #
(       2,       3 ]    35844   6.020%  10.931% #
(       3,       4 ]    68768  11.550%  22.481% ##
(       4,       6 ]   447222  75.111%  97.592% ###############
(       6,      10 ]    12077   2.028%  99.621% 
(      10,      15 ]      128   0.021%  99.642% 
(      15,      22 ]      170   0.029%  99.671% 
(      22,      34 ]     1795   0.301%  99.972% 
(      34,      51 ]      145   0.024%  99.997% 
(      51,      76 ]        9   0.002%  99.998% 
(      76,     110 ]        4   0.001%  99.999% 

** Level 1 read latency histogram (micros):
Count: 155861 Average: 4.5650  StdDev: 18.48
Min: 2  Median: 3.7945  Max: 7201
Percentiles: P50: 3.79 P75: 4.77 P99: 8.60 P99.9: 30.93 P99.99: 45.19
------------------------------------------------------
(       1,       2 ]     1102   0.707%   0.707% 
(       2,       3 ]    11512   7.386%   8.093% #
(       3,       4 ]    82212  52.747%  60.840% ###########
(       4,       6 ]    57697  37.018%  97.858% #######
(       6,      10 ]     2734   1.754%  99.612% 
(      10,      15 ]       32   0.021%  99.633% 
(      15,      22 ]       68   0.044%  99.677% 
(      22,      34 ]      468   0.300%  99.977% 
(      34,      51 ]       31   0.020%  99.997% 
(      51,      76 ]        1   0.001%  99.997% 
(      76,     110 ]        1   0.001%  99.998% 
(     170,     250 ]        1   0.001%  99.999% 
(     870,    1300 ]        1   0.001%  99.999% 
(    6600,    9900 ]        1   0.001% 100.000% 

** Level 2 read latency histogram (micros):
Count: 261055 Average: 6.1457  StdDev: 204.06
Min: 2  Median: 3.9624  Max: 48159
Percentiles: P50: 3.96 P75: 5.02 P99: 8.92 P99.9: 31.34 P99.99: 207.89
------------------------------------------------------
(       1,       2 ]     2065   0.791%   0.791% 
(       2,       3 ]    18478   7.078%   7.869% #
(       3,       4 ]   114276  43.775%  51.644% #########
(       4,       6 ]   119207  45.664%  97.307% #########
(       6,      10 ]     6046   2.316%  99.623% 
(      10,      15 ]       53   0.020%  99.644% 
(      15,      22 ]       90   0.034%  99.678% 
(      22,      34 ]      744   0.285%  99.963% 
(      34,      51 ]       46   0.018%  99.981% 
(      51,      76 ]       17   0.007%  99.987% 
(      76,     110 ]        4   0.002%  99.989% 
(     110,     170 ]        1   0.000%  99.989% 
(     170,     250 ]        4   0.002%  99.991% 
(     380,     580 ]        1   0.000%  99.991% 
(     580,     870 ]        1   0.000%  99.992% 
(     870,    1300 ]        1   0.000%  99.992% 
(    1300,    1900 ]        1   0.000%  99.992% 
(    1900,    2900 ]        1   0.000%  99.993% 
(    4400,    6600 ]        1   0.000%  99.993% 
(    6600,    9900 ]        2   0.001%  99.994% 
(    9900,   14000 ]        6   0.002%  99.996% 
(   14000,   22000 ]        2   0.001%  99.997% 
(   22000,   33000 ]        5   0.002%  99.999% 
(   33000,   50000 ]        3   0.001% 100.000% 

** Level 3 read latency histogram (micros):
Count: 342934 Average: 7.0989  StdDev: 247.84
Min: 2  Median: 4.1621  Max: 54037
Percentiles: P50: 4.16 P75: 5.15 P99: 9.28 P99.9: 61.18 P99.99: 6988.63
------------------------------------------------------
(       1,       2 ]     2368   0.691%   0.691% 
(       2,       3 ]    21750   6.342%   7.033% #
(       3,       4 ]   133214  38.845%  45.878% ########
(       4,       6 ]   174400  50.855%  96.733% ##########
(       6,      10 ]     9485   2.766%  99.499% #
(      10,      15 ]       61   0.018%  99.517% 
(      15,      22 ]      104   0.030%  99.547% 
(      22,      34 ]     1056   0.308%  99.855% 
(      34,      51 ]       94   0.027%  99.883% 
(      51,      76 ]      145   0.042%  99.925% 
(      76,     110 ]      154   0.045%  99.970% 
(     110,     170 ]       17   0.005%  99.975% 
(     170,     250 ]       33   0.010%  99.985% 
(     250,     380 ]        2   0.001%  99.985% 
(     380,     580 ]        2   0.001%  99.986% 
(     580,     870 ]        6   0.002%  99.987% 
(     870,    1300 ]        1   0.000%  99.988% 
(    1300,    1900 ]        2   0.001%  99.988% 
(    1900,    2900 ]        1   0.000%  99.989% 
(    2900,    4400 ]        3   0.001%  99.990% 
(    4400,    6600 ]        1   0.000%  99.990% 
(    6600,    9900 ]        6   0.002%  99.992% 
(    9900,   14000 ]        4   0.001%  99.993% 
(   14000,   22000 ]       10   0.003%  99.996% 
(   22000,   33000 ]        9   0.003%  99.998% 
(   33000,   50000 ]        5   0.001% 100.000% 
(   50000,   75000 ]        1   0.000% 100.000% 

** Level 4 read latency histogram (micros):
Count: 512264 Average: 5.6432  StdDev: 170.13
Min: 2  Median: 3.7920  Max: 76929
Percentiles: P50: 3.79 P75: 4.75 P99: 7.94 P99.9: 91.25 P99.99: 961.74
------------------------------------------------------
(       1,       2 ]     4421   0.863%   0.863% 
(       2,       3 ]    38240   7.465%   8.328% #
(       3,       4 ]   269526  52.615%  60.943% ###########
(       4,       6 ]   192558  37.590%  98.532% ########
(       6,      10 ]     4951   0.966%  99.499% 
(      10,      15 ]       60   0.012%  99.510% 
(      15,      22 ]       88   0.017%  99.528% 
(      22,      34 ]     1306   0.255%  99.783% 
(      34,      51 ]      102   0.020%  99.802% 
(      51,      76 ]      227   0.044%  99.847% 
(      76,     110 ]      608   0.119%  99.965% 
(     110,     170 ]       33   0.006%  99.972% 
(     170,     250 ]       68   0.013%  99.985% 
(     250,     380 ]        8   0.002%  99.987% 
(     380,     580 ]        9   0.002%  99.988% 
(     580,     870 ]        5   0.001%  99.989% 
(     870,    1300 ]       13   0.003%  99.992% 
(    1300,    1900 ]        4   0.001%  99.993% 
(    1900,    2900 ]        3   0.001%  99.993% 
(    2900,    4400 ]        8   0.002%  99.995% 
(    4400,    6600 ]        5   0.001%  99.996% 
(    6600,    9900 ]        6   0.001%  99.997% 
(    9900,   14000 ]        5   0.001%  99.998% 
(   14000,   22000 ]        3   0.001%  99.999% 
(   22000,   33000 ]        4   0.001%  99.999% 
(   33000,   50000 ]        2   0.000% 100.000% 
(   75000,  110000 ]        1   0.000% 100.000% 


** DB Stats **
Uptime(secs): 11824.1 total, 420.1 interval
Cumulative writes: 0 writes, 0 keys, 0 commit groups, 0.0 writes per commit group, ingest: 0.00 GB, 0.00 MB/s
Cumulative WAL: 0 writes, 0 syncs, 0.00 writes per sync, written: 0.00 GB, 0.00 MB/s
Cumulative stall: 00:00:0.000 H:M:S, 0.0 percent
Interval writes: 0 writes, 0 keys, 0 commit groups, 0.0 writes per commit group, ingest: 0.00 MB, 0.00 MB/s
Interval WAL: 0 writes, 0 syncs, 0.00 writes per sync, written: 0.00 MB, 0.00 MB/s
Interval stall: 00:00:0.000 H:M:S, 0.0 percent
...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1MTIxODkzNQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/96,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-80,kvrocks,1200090932,96,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-30T05:05:42Z,2022-07-30T05:05:42Z,"Won't do it now, feel free to reopen or create a new one.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-80/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/99,https://api.github.com/repos/apache/kvrocks/issues/99,kvrocks,652920532,99,"Any benchmark compare with ledis, ssdb or redix? simple test seems write performance much slower....",binwangcn,1488709,,binwang.cn@gmail.com,CLOSED,2020-07-08T04:03:49Z,2022-09-11T03:28:12Z,"**Describe the bug**
A clear and concise description of what the bug is.

 - OS: [e.g. Centos 7]
 - Version [e.g. 1.1.5]


**To Reproduce**
Steps to reproduce the behavior:
1. 
2.
3.

**Expected behavior**
A clear and concise description of what you expected to happen.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/99/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/99,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1NTI4NTA5MA==,kvrocks,655285090,99,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-07-08T05:00:59Z,2020-07-08T05:00:59Z,compare with Redis or others? can you paste the Redis benchmark log? ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY1NTI4NTA5MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/99,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM1v,kvrocks,1242877295,99,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:28:11Z,2022-09-11T03:28:11Z,"Closed as stale. I suppose you run [`redis-benchmark`](https://redis.io/docs/reference/optimization/benchmarks/) against these systems.

Looking forward to any feedback.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM1v/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/118,https://api.github.com/repos/apache/kvrocks/issues/118,kvrocks,683469690,118,find the suitable size for SST,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2020-08-21T10:40:52Z,2021-06-03T09:28:21Z,"the key-value size may so be quite different in many scenes, and use 256MiB as SST file size may cause data loading(large index/filter block) ineffective when the key-value was too small. kvrocks supports user-defined SST file in config(`rocksdb.target_file_size_base`), but it still too trivial and inconvenient to adjust the different sizes for different instances.  so we want to periodic auto-adjust the SST size in-flight with user avg key-value size. for example:

```
case 1: 0 ~ 128 bytes，Block Size = 2k, SST size = 16 M

case 2:  128 ~ 1024 bytes, Block Size = 8k, SST size = 64 M

case 3: 1k ~ 32k, Block Size = 32k,   SST size = 128 M

case 4: 32k ~ 256k, Block Size = 256k, SST size = 256 M

case 5: 256k ~ 512k, Block Size = 512k , SST size = 512 M

case 6: > 512 k, Block Size = 1M, SST size = 1 G
```

TODO:

- [x] develop the feature

- [x] code review

- [x] benchmark between fixed and dynamic SST size(32bytes/128bytes/512bytes/1k/16k/64k/256k/1M)

- [x] how about dynamic block size? which may affect the performance of the block cache hit rate

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/118/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/118,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY5MDkzOTY0OA==,kvrocks,690939648,118,NA,karelrooted,523980,karelrooted,,NA,2020-09-11T07:57:28Z,2020-09-11T07:57:28Z,"Benchmark(String):

#### Hardware

* Macbook Pro (15-inch, 2017) 

#### Software

* Centos 7 VM
  * Memory: 4 GiB
* Kvrocks
  * options->use_direct_reads = true (don't use os's page cache)  
  * rocksdb.metadata_block_cache_size 60M 



#### Result

````
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000000 -n 10000000 -a foobared -t set -d 32
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000000 -n 10000000 -a foobared -t get

Size        FIXED(256M)                                                         Dynamic(16M)
            
            Set QPS   99.99%                                                    Set QPS      99.99%      
32byte      42520.62  <= 68ms                                                   48253        <= 22ms    


            Get QPS   99.99%     Avg      Slowlog_Avg(last_128）                Get QPS     99.99%      Avg           Slowlog_Avg(last_128)
            7647.54   <= 137ms   0.954ms   23.5449ms                            24759.83    <= 25ms     0.270ms      18.265ms (total 80)   
            
 
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000000 -n 10000000 -a foobared -t set -d 256
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000000 -n 100000 -a foobared -t get

Size        FIXED(256M)                                                         Dynamic(64M)
 
            Set QPS   99.99%                                                    Set QPS      99.99%      
256byte     38705.54  <= 35ms                                                   37189.38     <= 36ms    


            Get QPS   99.99%     Avg       Slowlog_Avg(last_128）               Get QPS     99.99%      Avg           Slowlog_Avg(last_128)
            282.55    <= 488ms   28.131ms   34.8564ms                           1203.5    <= 154ms      6.576ms        13.3628ms
      
    
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000000 -n 10000000 -a foobared -t set -d 2048
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000000 -n 10000 -a foobared -t get

Size        FIXED(256M)                                                         Dynamic(128M)
 
            Set QPS   99.99%                                                    Set QPS      99.99%      
2K          14737.63  <= 1707ms                                                 13520.99     <= 242ms    


            Get QPS   99.99%      Avg       Slowlog_Avg(last_128）              Get QPS     99.99%         Avg           Slowlog_Avg(last_128)
            41.9      <= 3234ms   188.94ms   198.149ms                          211.33      <= 1296ms      37.602ms       87.2035ms     
            
            
* redis-benchmark -h 10.211.55.11 -p 6666  -r 200000 -n 200000 -a foobared -t set -d 49152
* redis-benchmark -h 10.211.55.11 -p 6666  -r 200000 -n 200000 -a foobared -t get

Size                                                                           Dynamic(256M)
 
                                                                               Set QPS      99.99%      
48K                                                                            1633.44      <= 7032ms    


                                                                               Get QPS     99.99%         Avg           Slowlog_Avg(last_128)
                                                                               3914.2      <= 76ms        1.856ms         11.443ms     
                                                                               
                                                                               
                                                                               
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000 -n 10000 -a foobared -t set -d 319488
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000 -n 10000 -a foobared -t get

Size        FIXED(256M)                                                         Dynamic(512M)
 
            Set QPS   99.99%                                                    Set QPS      99.99%      
312K        348.78    <= 4961ms                                                 433.88       <= 1595ms    


            Get QPS   99.97%      Avg       Slowlog_Avg(last_128）              Get QPS     99.87%         Avg           Slowlog_Avg(last_128)
            2260.4    <= 63ms    2.399ms     14.2772ms                          2481.39     <= 55ms        2.294ms        12.6723ms (total 75)
            
            
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000 -n 10000 -a foobared -t set -d 524288
* redis-benchmark -h 10.211.55.11 -p 6666  -r 10000 -n 10000 -a foobared -t get

Size        FIXED(256M)                                                         Dynamic(1G)
 
            Set QPS   99.99%                                                    Set QPS      99.99%      
512K        160.72    <= 6580ms                                                 200.73       <= 4407ms    


            Get QPS   99.89%      Avg       Slowlog_Avg(last_128）              Get QPS     99.99%         Avg           Slowlog_Avg(last_128)
            1594.39   <= 94ms    3.228ms     13.5389ms                          1700.10     <= 85ms       2.711ms         13.3244ms             
````","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY5MDkzOTY0OA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/118,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDcwOTg4OTAyOQ==,kvrocks,709889029,118,NA,karelrooted,523980,karelrooted,,NA,2020-10-16T07:54:57Z,2020-10-16T07:54:57Z,"related issue: https://github.com/facebook/rocksdb/issues/7385
related PR: https://github.com/facebook/rocksdb/pull/7936","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDcwOTg4OTAyOQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/121,https://api.github.com/repos/apache/kvrocks/issues/121,kvrocks,686026904,121,编译失败,mybee,8556916,,,CLOSED,2020-08-26T05:48:52Z,2020-08-26T13:56:55Z,"Centos7

[root@i-h60b6jz2 kvrocks]# make -j4
cd src && make all
make[1]: 进入目录“/root/kvrocks/src”
    CC main.o
    CC server.o
    LINK kvrocks
/root/kvrocks/external/glog/.libs/libglog.a(libglog_la-logging.o)：在函数‘__static_initialization_and_destruction_0(int, int)’中：
logging.cc:(.text+0x6299)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
logging.cc:(.text+0x634b)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
logging.cc:(.text+0x63f5)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
logging.cc:(.text+0x649f)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
logging.cc:(.text+0x64dc)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
/root/kvrocks/external/glog/.libs/libglog.a(libglog_la-logging.o):logging.cc:(.text+0x657e): more undefined references to `google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)' follow
collect2: 错误：ld 返回 1
make[1]: *** [kvrocks] 错误 1
make[1]: 离开目录“/root/kvrocks/src”
make: *** [all] 错误 2
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/121/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/121,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3MTcwMw==,kvrocks,680671703,121,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-08-26T05:51:52Z,2020-08-26T05:51:52Z,"@mybee 这个是因为你本地装了 gflags, 然后 glogs 自动识别加上了。可以先通过 make LDFLAGS+='-lgflags -pthread' 解决，我后面也在 makefile 里面去加一下 gflags","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3MTcwMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/121,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3MjYyNw==,kvrocks,680672627,121,NA,mybee,8556916,,,NA,2020-08-26T05:54:39Z,2020-08-26T05:54:39Z,"[root@i-h60b6jz2 kvrocks]# make LDFLAGS+='-lgflags -pthread'
cd src && make all
make[1]: 进入目录“/root/kvrocks/src”
    CC server.o
    CC main.o
    LINK kvrocks
/root/kvrocks/external/rocksdb/librocksdb.a(format.o)：在函数‘Snappy_GetUncompressedLength’中：
/root/kvrocks/external/rocksdb/./util/compression.h:563：对‘snappy::GetUncompressedLength(char const*, unsigned long, unsigned long*)’未定义的引用
/root/kvrocks/external/rocksdb/librocksdb.a(format.o)：在函数‘Snappy_Uncompress’中：
/root/kvrocks/external/rocksdb/./util/compression.h:574：对‘snappy::RawUncompress(char const*, unsigned long, char*)’未定义的引用
/root/kvrocks/external/rocksdb/librocksdb.a(block_based_table_builder.o)：在函数‘Snappy_Compress’中：
/root/kvrocks/external/rocksdb/./util/compression.h:547：对‘snappy::MaxCompressedLength(unsigned long)’未定义的引用
/root/kvrocks/external/rocksdb/./util/compression.h:549：对‘snappy::RawCompress(char const*, unsigned long, char*, unsigned long*)’未定义的引用
/root/kvrocks/external/glog/.libs/libglog.a(libglog_la-logging.o)：在函数‘__static_initialization_and_destruction_0(int, int)’中：
logging.cc:(.text+0x6299)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
logging.cc:(.text+0x634b)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
logging.cc:(.text+0x63f5)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
logging.cc:(.text+0x649f)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
logging.cc:(.text+0x64dc)：对‘google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)’未定义的引用
/root/kvrocks/external/glog/.libs/libglog.a(libglog_la-logging.o):logging.cc:(.text+0x657e): more undefined references to `google::FlagRegisterer::FlagRegisterer(char const*, char const*, char const*, char const*, void*, void*)' follow
collect2: 错误：ld 返回 1
make[1]: *** [kvrocks] 错误 1
make[1]: 离开目录“/root/kvrocks/src”
make: *** [all] 错误 2




使用之后还是报一样的错...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3MjYyNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/121,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3NDc5Mw==,kvrocks,680674793,121,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-08-26T05:59:37Z,2020-08-26T05:59:37Z,"咦，你是什么 os,  再试一下 make LDFLAGS+='-lsnappy -lgflags -pthread' ，另外确认一下本地是否安装了 snappy/gflags","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3NDc5Mw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/121,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3NjU3MQ==,kvrocks,680676571,121,NA,mybee,8556916,,,NA,2020-08-26T06:03:52Z,2020-08-26T06:03:52Z,"1. CentOS7  
2. 这个命令也是同样的错
3. 有安装, 之前编译rocksdb装的
![image](https://user-images.githubusercontent.com/8556916/91267004-f50acd00-e7a4-11ea-8130-9f7612d53210.png)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3NjU3MQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/121,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3ODIxOA==,kvrocks,680678218,121,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-08-26T06:08:15Z,2020-08-26T06:08:15Z,你微信加一下我，搜索 hulkdev ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4MDY3ODIxOA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/123,kvrocks,692736400,123,Cannot run on debian,haodiao,12348040,,,CLOSED,2020-09-04T05:25:39Z,2022-06-06T11:04:56Z,"Compilation is completed on debian, run error","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/123/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NjkyMzczNw==,kvrocks,686923737,123,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-09-04T05:47:01Z,2020-09-04T05:47:01Z,@haodiao what's your GCC version? can you paste the error log? ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NjkyMzczNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzAwNDAxNg==,kvrocks,687004016,123,NA,haodiao,12348040,,,NA,2020-09-04T08:23:48Z,2020-09-04T08:23:48Z,"Debian9 and debian10 have the same error

```
[root@debian ~/kvrocks]#  ./src/kvrocks -c kvrocks.conf
Version: 1.1.28 @8e8fa5ca
E0904 15:56:45.020162 26024 main.cc:305] Failed to open: IO error: No such file or directoryWhile opening a file for sequentially reading: /tmp/kvrocks/db/CURRENT: No such file or directory
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzAwNDAxNg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzAxODEzMA==,kvrocks,687018130,123,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-09-04T08:53:44Z,2020-09-04T08:53:44Z,@haodiao try `rm /tmp/kvrocks/` and restart the kvrocks,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzAxODEzMA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzU4Mzk2Mw==,kvrocks,687583963,123,NA,haodiao,12348040,,,NA,2020-09-05T10:09:11Z,2020-09-05T10:09:11Z,@git-hulk  the problem still exists ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzU4Mzk2Mw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzU4ODA1OQ==,kvrocks,687588059,123,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-09-05T10:41:20Z,2020-09-05T10:41:20Z,It seems that something was gone wrong when creating the DB files in `/tmp` dir in your OS.  Try another DB dir in config file: https://github.com/bitleak/kvrocks/blob/master/kvrocks.conf#L70,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzU4ODA1OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzYwOTA5OQ==,kvrocks,687609099,123,NA,haodiao,12348040,,,NA,2020-09-05T13:09:31Z,2020-09-05T13:09:31Z,I suggest you answer after testing,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzYwOTA5OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzYxNzcwOA==,kvrocks,687617708,123,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-09-05T14:19:50Z,2020-09-05T14:19:50Z,"@haodiao I can't reproduce the issue with clean Debian 9, Please check your db dir status.

```
root@40c67bdc33b6:~/kvrocks# ./src/kvrocks -c kvrocks.conf
Version: 1.1.28 @8e8fa5ca
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzYxNzcwOA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzY0OTg0Mw==,kvrocks,687649843,123,NA,haodiao,12348040,,,NA,2020-09-05T19:08:18Z,2020-09-05T19:08:18Z,"```
root@debian:~/kvrocks# make test
cd src && make test
make[1]: Entering directory '/root/kvrocks/src'
    CC server.o
    LINK unittest
./unittest
[==========] Running 82 tests from 20 test cases.
[----------] Global test environment set-up.
[----------] 1 test from InternalKey
[ RUN      ] InternalKey.EncodeAndDecode
[       OK ] InternalKey.EncodeAndDecode (1 ms)
[----------] 1 test from InternalKey (1 ms total)

[----------] 1 test from Metadata
[ RUN      ] Metadata.EncodeAndDeocde
[       OK ] Metadata.EncodeAndDeocde (0 ms)
[----------] 1 test from Metadata (0 ms total)

[----------] 2 tests from RedisTypeTest
[ RUN      ] RedisTypeTest.GetMetadata
Failed to open the storage, encounter error: IO error: No such file or directoryWhile opening a file for sequentially reading: testsdb/CURRENT: No such file or directory
Makefile:125: recipe for target 'test' failed
make[1]: [test] Segmentation fault (ignored)
make[1]: Leaving directory '/root/kvrocks/src'
root@debian:~/kvrocks#
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDY4NzY0OTg0Mw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDcwMDYwNjAwMw==,kvrocks,700606003,123,NA,guoanwu,33250245,Dennis Wu,,NA,2020-09-29T10:11:04Z,2020-09-29T10:11:04Z,"see the similar issue on the ""4.18.16-300.fc29.x86_64"", build is successfully but when run it will fail to open the CURRENT file. 
gcc version:  gcc version 8.3.1 20190223 (Red Hat 8.3.1-2) (GCC)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDcwMDYwNjAwMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDcwMDYyNzI4Ng==,kvrocks,700627286,123,NA,guoanwu,33250245,Dennis Wu,,NA,2020-09-29T10:57:19Z,2020-09-29T10:57:19Z,"you can first check the external rocksdb folder to see if you can run the benchmark like:
taskset -c 0-23,48-71 ./db_bench     --benchmarks=fillrandom,stats,levelstats     --enable_write_thread_adaptive_yield=false     --disable_auto_compactions=false     --max_background_compactions=8     --max_background_flushes=4     --value_size=64     --key_size=16     --db=/mnt/pmem0/sst     --wal_dir=/mnt/pmem0/wal     --enable_pipelined_write=true     --allow_concurrent_memtable_write=true     --batch_size=1     --histogram=true     --use_direct_io_for_flush_and_compaction=true     --use_direct_reads=true     --target_file_size_base=67108864     --disable_wal=false     --sync=true         --writes=3000000     --num=60000000     --threads=20         --report_interval_seconds=5

If you can run, then the issue can be solved. 

In my enviornment, i missed the snappy-devel folder and the rocksdb library is not build with the snappy, you run the rocksdb benchmark with the same command will see: 
**Initializing RocksDB Options from the specified file
Initializing RocksDB Options from command-line flags
open error: Invalid argument: Compression type Snappy is not linked with the binary.**

So just confirm you can run db_bench successful. 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDcwMDYyNzI4Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc4MDY1OTU5Nw==,kvrocks,780659597,123,NA,hsnamed,1898831,,,NA,2021-02-17T16:00:43Z,2021-02-17T16:00:43Z,"I've the same issue and didnt find a chance to solve it on Debian 10.
db_bench - unable to find it in external folder.
gcc version 8.3.0 (Debian 8.3.0-6)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc4MDY1OTU5Nw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc4MDk3ODg2MA==,kvrocks,780978860,123,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-02-18T01:46:22Z,2021-02-18T01:46:22Z,"@hsnamed db_bench was the tool in the RocksDB, NOT in kvrocks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc4MDk3ODg2MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjExNzcyMA==,kvrocks,852117720,123,NA,hellower,7464662,,,NA,2021-06-01T13:19:09Z,2021-06-01T13:19:09Z,">  cat /etc/os-release 
PRETTY_NAME=""Debian GNU/Linux 10 (buster)""
NAME=""Debian GNU/Linux""
VERSION_ID=""10""
VERSION=""10 (buster)""
VERSION_CODENAME=buster
ID=debian
HOME_URL=""https://www.debian.org/""
SUPPORT_URL=""https://www.debian.org/support""
BUG_REPORT_URL=""https://bugs.debian.org/

>  gcc --version
gcc (Debian 8.3.0-6) 8.3.0
Copyright (C) 2018 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.


>  apt-get install gcc g++ make libsnappy-dev autoconf automake libtool libgtest-dev
>  cd /usr/local/src
>  git clone --recursive https://github.com/bitleak/kvrocks.git
>  cd kvrocks
>  make -j4

>  cd /usr/local/src/kvrocks/kvrocks
>  src/kvrocks -c kvrocks.conf 
Version: 999.999.999 @368e561f
...

I am testing kvrocks on debian10 and there is no problem at all.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjExNzcyMA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/123,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EYtIk,kvrocks,1147327012,123,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-06T11:04:56Z,2022-06-06T11:04:56Z,Fixed by #620 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EYtIk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/143,https://api.github.com/repos/apache/kvrocks/issues/143,kvrocks,771331640,143,Support encryption at rest,rock59,1836483,,,CLOSED,2020-12-19T07:53:03Z,2022-10-04T03:00:05Z,It would be nice to support encryption at rest. CockroachDB's implementation for Rocksdb maybe a good starting point.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/143/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/143,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODQ0MDQ4MA==,kvrocks,748440480,143,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-12-19T08:20:22Z,2020-12-19T08:20:22Z,it’s really a good point to enhance the security by encrypting the data node. I would have a look at how can we achieve it on the kvrocks.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODQ0MDQ4MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/143,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Leq8M,kvrocks,1266331404,143,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-04T03:00:05Z,2022-10-04T03:00:05Z,"Closed as inactive. We don't hold a wishing list. A proposal with design is welcome. Also, IIRC crdb drops the dependency to RocksDB and develops their own storage engine Pebble :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Leq8M/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/144,https://api.github.com/repos/apache/kvrocks/issues/144,kvrocks,771613657,144,Maximum key length,rock59,1836483,,,CLOSED,2020-12-20T15:34:25Z,2022-06-28T10:24:00Z,What is the maximum key length for redis data types in KVRocks ?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/144/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/144,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODcxNDk2Ng==,kvrocks,748714966,144,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-12-21T01:57:50Z,2020-12-21T01:57:50Z,"the key length was not limited directly, it only limits the max bulk string to  512 MiB.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODcxNDk2Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/144,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODg4Njc3Mw==,kvrocks,748886773,144,NA,rock59,1836483,,,NA,2020-12-21T10:02:07Z,2020-12-21T10:02:07Z,@git-hulk  Great. thanks,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODg4Njc3Mw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/144,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0OTI5MDY1Mw==,kvrocks,749290653,144,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-12-22T01:44:51Z,2020-12-22T01:44:51Z,"Going to close the issue, feel free to reopen it if has any question","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0OTI5MDY1Mw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/145,https://api.github.com/repos/apache/kvrocks/issues/145,kvrocks,771993328,145,kvrocks2redis works weird,winterfall233,34575397,,wyb199x@gmail.com,CLOSED,2020-12-21T09:04:02Z,2020-12-21T10:17:47Z,"[What did I do?]
When I use kvrocks2redis to migrate data to a Redis server, the auth part does not work.
1.kvrocks server configured by:
    requirepass=mypwd_kvrocks
    # masterauth 
2.kvrocks2redis configured by:
    kvrocks xx.xx.xx.xx 6666 mypwd_kvrocks
    namespace.ns1 xx.xx.xx.xx 6379 mypwd_redis 1

Meanwhile, Redis server is ready with port 6379 & pwd 'mypwd_redis'.
And I did this on kvrocks server:
    ./redis-cli -h xx.xx.xx.xx -p 6666 -a mypwd_kvrocks namespace add ns1 mypwd_ns1
    ./redis-cli -h xx.xx.xx.xx -p 6666 -a mypwd_ns1 set key1 abcdefg
    ./redis-cli -h xx.xx.xx.xx -p 6666 -a mypwd_ns1 lpush key2 a b c

[ERROR LOG]
E1221 16:13:32.715910 99362 sync.cc:58] auth got invalid response
E1221 16:13:32.717257 99427 redis_writer.cc:90] [kvrocks2redis] redis select db failed: -NOAUTH Authentication required.
E1221 16:13:32.718616 99427 redis_writer.cc:90] [kvrocks2redis] redis select db failed: -NOAUTH Authentication required.
E1221 16:13:32.719998 99427 redis_writer.cc:90] [kvrocks2redis] redis select db failed: -NOAUTH Authentication required.
E1221 16:13:32.721364 99427 redis_writer.cc:90] [kvrocks2redis] redis select db failed: -NOAUTH Authentication required.
E1221 16:13:32.722718 99427 redis_writer.cc:90] [kvrocks2redis] redis select db failed: -NOAUTH Authentication required.
E1221 16:13:32.724040 99427 redis_writer.cc:90] [kvrocks2redis] redis select db failed: -NOAUTH Authentication required.
E1221 16:13:32.725356 99427 redis_writer.cc:90] [kvrocks2redis] redis select db failed: -NOAUTH Authentication required.

[Question~]
Am I doing the right config for kvrocks & kvrocks2redis? Why migration cannot work and log shows err in AUTH?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/145/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/145,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODg2MDE2Nw==,kvrocks,748860167,145,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-12-21T09:05:49Z,2020-12-21T09:05:49Z,can u help to check this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODg2MDE2Nw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/145,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODg2OTA5Mw==,kvrocks,748869093,145,NA,winterfall233,34575397,,wyb199x@gmail.com,NA,2020-12-21T09:24:06Z,2020-12-21T09:24:06Z,"some guess: 
kvrocks2redis must config    ""an existing kvrocks slave node""    as data source, right?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODg2OTA5Mw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/145,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODg5NDI0NQ==,kvrocks,748894245,145,NA,karelrooted,523980,karelrooted,,NA,2020-12-21T10:17:47Z,2020-12-21T10:17:47Z,"> some guess:
> kvrocks2redis must config ""an existing kvrocks slave node"" as data source, right?

is a bug, forgot to test password not empty situation after add selectDB support","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0ODg5NDI0NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/147,https://api.github.com/repos/apache/kvrocks/issues/147,kvrocks,772404923,147,Any plan to support SSL?,rock59,1836483,,,CLOSED,2020-12-21T19:20:41Z,2022-09-11T08:06:48Z,libevent provides ssl with bufferevent_ssl.h and openssl. I guess is not hard to support ssl.  Is there any plan to support ssl?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/147/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/147,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0OTI5MDM4NQ==,kvrocks,749290385,147,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-12-22T01:43:44Z,2020-12-22T01:43:44Z,"yup, it should be easy but we have no plan now","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc0OTI5MDM4NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/147,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JSP7n,kvrocks,1229520615,147,NA,PragmaTwice,20042607,Twice,,NA,2022-08-28T18:02:59Z,2022-08-28T18:02:59Z,"Hi @rock59, I am working on #797 and I think it will soon become available. 🚀 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JSP7n/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/148,https://api.github.com/repos/apache/kvrocks/issues/148,kvrocks,772929001,148,Please support unix domain socket,rock59,1836483,,,CLOSED,2020-12-22T13:01:03Z,2022-05-07T06:48:28Z,As the title,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/148/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/148,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM472jRQ,kvrocks,1004155984,148,NA,adulau,3309,Alexandre Dulaunoy,a@foo.be,NA,2022-01-03T15:08:53Z,2022-01-03T15:08:53Z,It's indeed a kind of important feature to reduce the TCP handshake overhead on kvrocks instances. ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM472jRQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/150,https://api.github.com/repos/apache/kvrocks/issues/150,kvrocks,776806166,150,Illegal instruction error when running on server (Ubuntu),yndc,16462328,yonder,,CLOSED,2020-12-31T06:01:00Z,2020-12-31T11:05:51Z,"**Describe the bug**
Hi, great project. We're trying to move from `redis` to `kvrocks` for temporary KV storage. We have `kvrocks` successfully running on our local machines but it couldn't run on our servers in DigitalOcean.

Running the binary directly throws error: `Illegal instruction` on start.
Running in container (`hulkdev/kvrocks`) on the server fails with no error or logs. Works in local.

 - OS: Ubuntu
 - Version 20.04
 - kvrocks v1.1.32

Thank you.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/150/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/150,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1Mjg2MjI2Ng==,kvrocks,752862266,150,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-12-31T06:30:55Z,2020-12-31T06:30:55Z,"Hi, what's your GCC version, is it installed from the ubuntu `apt install` or compiled?

the docker version seems ok on my side,  you mean that kvrocks fail after running, or can't connect?
```
➜  ~ docker run -p 6666:6666 -it hulkdev/kvrocks
Version: 1.1.40 @39b2f094
```

```
➜  ~ redis-cli -p 6666
127.0.0.1:6666> get a
(nil)
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1Mjg2MjI2Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/150,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1Mjg3ODYzMg==,kvrocks,752878632,150,NA,yndc,16462328,yonder,,NA,2020-12-31T07:45:29Z,2020-12-31T07:45:29Z,"Hi, this is my GCC version, installed by `apt install`:

```
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-linux-gnu/9/lto-wrapper
OFFLOAD_TARGET_NAMES=nvptx-none:hsa
OFFLOAD_TARGET_DEFAULT=1
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 9.3.0-17ubuntu1~20.04' --with-bugurl=file:///usr/share/doc/gcc-9/README.Bugs --enable-languages=c,ada,c++,go,brig,d,fortran,objc,obj-c++,gm2 --prefix=/usr --with-gcc-major-version-only --program-suffix=-9 --program-prefix=x86_64-linux-gnu- --enable-shared --enable-linker-build-id --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --libdir=/usr/lib --enable-nls --enable-clocale=gnu --enable-libstdcxx-debug --enable-libstdcxx-time=yes --with-default-libstdcxx-abi=new --enable-gnu-unique-object --disable-vtable-verify --enable-plugin --enable-default-pie --with-system-zlib --with-target-system-zlib=auto --enable-objc-gc=auto --enable-multiarch --disable-werror --with-arch-32=i686 --with-abi=m64 --with-multilib-list=m32,m64,mx32 --enable-multilib --with-tune=generic --enable-offload-targets=nvptx-none=/build/gcc-9-HskZEa/gcc-9-9.3.0/debian/tmp-nvptx/usr,hsa --without-cuda-driver --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 9.3.0 (Ubuntu 9.3.0-17ubuntu1~20.04)
```
When I try running the docker version in the server it doesn't log anything, it just stops.
```
yondercode@dev-mainnet:~$ docker run --name kvr -p 6666:6666 -it hulkdev/kvrocks
yondercode@dev-mainnet:~$
yondercode@dev-mainnet:~$ docker ps -a
CONTAINER ID        IMAGE             COMMAND                  CREATED             STATUS                       PORTS       NAMES
4310c57bef0b        hulkdev/kvrocks   ""./bin/kvrocks -c ./…""   7 seconds ago       Exited (132) 6 seconds ago               kvr
yondercode@dev-mainnet:~$ docker logs kvr
yondercode@dev-mainnet:~$
```

Tried running the binary directly (in server):
```
yondercode@dev-mainnet:~$ ./kvrocks
Illegal instruction
yondercode@dev-mainnet:~$
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1Mjg3ODYzMg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/150,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1Mjg4MTk2NQ==,kvrocks,752881965,150,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2020-12-31T08:03:47Z,2020-12-31T08:03:47Z,"Hi, thanks for your information

it seems the docker version has the same issue as the compiled version since it's exited after the running. the `Illegal instruction` means the instruction was generated by GCC which can't be recognized by the current CPU.

the similar issue in RocksDB: https://github.com/facebook/rocksdb/issues/5912

Can u help to try to add `PORTABLE=1` at https://github.com/bitleak/kvrocks/blob/master/src/Makefile#L106 and recompiled again","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1Mjg4MTk2NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/150,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1MjkxODg2NA==,kvrocks,752918864,150,NA,yndc,16462328,yonder,,NA,2020-12-31T10:34:15Z,2020-12-31T10:34:15Z,"Hi, thanks for your reply. Unfortunately I tried recompiling with your instructions (`PORTABLE=1`) but it still have the same error.

Here is the server's CPU info from `cat /proc/cpuinfo` I think it might help:
```
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 45
model name      : Intel(R) Xeon(R) CPU E5-2630L 0 @ 2.30GHz
stepping        : 7
microcode       : 0x1
cpu MHz         : 1999.999
cache size      : 4096 KB
physical id     : 0
siblings        : 1
core id         : 0
cpu cores       : 1
apicid          : 0
initial apicid  : 0
fpu             : yes
fpu_exception   : yes
cpuid level     : 13
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss syscall nx rdtscp lm constant_tsc arch_perfmon rep_good nopl cpuid tsc_known_freq pni pclmulqdq vmx ssse3 cx16 pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx hypervisor lahf_lm pti ssbd ibrs ibpb tpr_shadow vnmi flexpriority ept vpid tsc_adjust xsaveopt md_clear
bugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs
bogomips        : 3999.99
clflush size    : 64
cache_alignment : 64
address sizes   : 40 bits physical, 48 bits virtual
power management:
```

I'll try to compile the binary in the server instead, maybe the compiled binary will work on this older generation CPU.

I think `rocksdb` requires `bmi2` instruction but it doesn't exists in this CPU so it failed. Will post update later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1MjkxODg2NA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/150,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1MjkyNjA0NQ==,kvrocks,752926045,150,NA,yndc,16462328,yonder,,NA,2020-12-31T11:05:42Z,2020-12-31T11:05:42Z,"Oh my, I forgot to run `make clean` inside the `src` folder after adding `PORTABLE=1`! 😅

The binary from recompiling with that flag works on my server now. Thanks for the support!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1MjkyNjA0NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/151,https://api.github.com/repos/apache/kvrocks/issues/151,kvrocks,781923017,151,Can I upgrade from 1.1.38 to 1.2.0,clyang,2229479,,,CLOSED,2021-01-08T07:48:30Z,2021-01-08T07:53:04Z,"According to the Changelog, rocksdb has been revert to previous version in 1.2.0.
Will it break anything if I upgrade from 1.1.38?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/151/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/151,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1NjYwNjQ4OA==,kvrocks,756606488,151,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-01-08T07:50:15Z,2021-01-08T07:50:15Z,"yup, the minor version wouldn't have the breaking change, so it's ok to upgrade the 1.1.x to the latest.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1NjYwNjQ4OA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/151,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1NjYwNzY0Nw==,kvrocks,756607647,151,NA,clyang,2229479,,,NA,2021-01-08T07:53:03Z,2021-01-08T07:53:03Z,Got it. Many thanks!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDc1NjYwNzY0Nw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/166,https://api.github.com/repos/apache/kvrocks/issues/166,kvrocks,799304086,166,Improve the precision of the `incrbyfloat`/`hincrbyfloat`  command to double,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-02-02T13:56:12Z,2021-02-03T02:55:51Z,"**Describe the bug**
the precision of the `incrbyfloat`/`hincrbyfloat` command was float(32bit) which may cause loss of accuracy.
 

**To Reproduce**
Steps to reproduce the behavior:
1. set novar 17179869184
2. incrbyfloat novar 1.5

**Expected behavior**
the result should be 17179869185.5","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/166/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/190,https://api.github.com/repos/apache/kvrocks/issues/190,kvrocks,812534917,190,[NEW] Optimize TCP keepalive detection time,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2021-02-20T06:56:25Z,2021-03-10T03:29:13Z,"**The problem/use-case that the feature addresses**
On Linux, the tcp keeaplive detection time is too long, it is not useful to find some problem actually

**Description of the feature**
We need to set the tcp-keepalive interval and probes if the socket keepalive is disabled

**Alternatives you've considered**
Maybe we also can provide a configure to set keepalive, just list Redis

**Additional information**
NULL","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/190/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/198,https://api.github.com/repos/apache/kvrocks/issues/198,kvrocks,822744997,198,Deprecate and remove the python functional test caess,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-03-05T04:57:05Z,2021-03-08T03:10:20Z,We would remove the old version functional test cases and replace them with the TCL version. The biggest advantage was we can merge the test cases from the Redis.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/198/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/209,https://api.github.com/repos/apache/kvrocks/issues/209,kvrocks,838285797,209,RocksDB optimization,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2021-03-23T02:17:33Z,2021-11-21T02:32:57Z,"## Compression type
- Support multiple compression types

## Parameters
- enable enable_pipelined_write if having more CPUs
- use index_type: kTwoLevelIndexSearch to make index and filter blocks smaller
- enable pin_top_level_index_and_filter, pin_l0_filter_and_index_blocks_in_cache
- for cache_index_and_filter_blocks_with_high_priority, to avoid too high
- NewBloomFilterPolicy(bits_per_key, false) i.e. BloomFilterPolicy::kAutoBloom
- data_block_index_type: BlockBasedTableOptions::kDataBlockBinaryAndHash
- Set BlockBasedTableOptions::optimize_filters_for_memory to true, jemalloc_usable_size is safe if no bugs, redis adopts it
-  memtable_prefix_bloom_size_ratio and memtable_whole_key_filtering, to enable memtable filter.
- CompressionOptions::max_dict_bytes for lz4 and zstd

## Data partition  by ColumnFamily
- ~~One type one ColumnFamily~~","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/209/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/209,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4342ZZ,kvrocks,937649753,209,NA,dongdongwcpp,85050932,Axel,,NA,2021-10-07T10:11:11Z,2021-10-07T10:11:11Z,"`memtable_prefix_bloom_size_ratio` seems need a prefix_extractor, can it work for redis like system?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4342ZZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/209,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM456F39,kvrocks,971529725,209,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-11-17T12:22:50Z,2021-11-17T12:22:50Z,"@dongdongwcpp you mean we should set `prefix_extractor` if we want to enable `memtable_prefix_bloom_size_ratio`?
i think in redis system, there are many lookup reads, so i want to enable this feature, make sense? WDYT?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM456F39/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/219,https://api.github.com/repos/apache/kvrocks/issues/219,kvrocks,856902269,219,[NEW] Support redis cluster mode,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2021-04-13T12:15:33Z,2022-12-23T10:38:34Z,"# 1 Background

Currently, we discard the support for `codis` mode,  if we want to deploy kvrocks cluster, we need to pre-shard for cluster and deploy a proxy like `twemproxy` to route requests. This cluster solution also is adopted when redis doesn't support cluster mode, but it is not convenient for failover, linear scale, management, moreover, we must route requests by a proxy, that must cause performance loss because of extra network communication. So we hope there a way we can implement a feature that is similar with redis cluster mode.

But if we totally support redis cluster mode in kvrocks, it doesn't seem a good idea, because it is hard to implement redis cluster management and gossip protocol without bugs. We must upgrade server if we find bugs, after all, it costs many years to make redis cluster work well. In order to get benefits from redis cluster mode, we can only support partial redis cluster commands that make a chance to let `redis cluster sdk(such as jedis)`  or `redis cluster proxy(such as redis-cluster-proxy, predixy)` work well.

# 2 Implementation
## 2.1 Basic version
Firstly, every node needs to know the entire cluster topology, itself identifier. When clients(`redis-cli`, SDK or proxy) connect to  arbitrary one node of kvrocks cluster, they could know slot distribution of cluster by sending `CLUSTER NODES` command, then route requests.  And the kvrocks should reply `MOVED` when clients send requests to wrong server. To do that, we should implement `CLUSTER SETNODES` command to set the entire cluster topology for every nodes, and provide `CLUSTER NODES` command to make kvrocks node similar with redis.

- CLUSTER NODES
   The return of this command is the same format of redis cluster. 
    Example: 
    ```
    07c37dfeb235213a872192d90877d0cd55635b91 127.0.0.1:30004 slave e7d1eecce10fd6bb5eb35b9f99a514335d9ba9ca 0 1426238317239 4 connected
    67ed2db8d677e59ec4a4cefb06858cf2a1a89fa1 127.0.0.1:30002 master - 0 1426238316232 2 connected 5461-10922
   ```

- CLUSTER SETNODES `$ALL_NODES_INFO` `$VERSION` `FORCE`
   `$ALL_NODES_INFO` format: `$node_id` `$ip $port` `$role` `$master_node_id` `$slot_range`. `$role`: master or slave,  `$master_node_id`: master_node_id if it is slave, otherwise, this value is `-`. slave needn't set `$slot_range`.
    Example: 
    ```
    07c37dfeb235213a872192d90877d0cd55635b91 127.0.0.1 30004 slave e7d1eecce10fd6bb5eb35b9f99a514335d9ba9ca
    67ed2db8d677e59ec4a4cefb06858cf2a1a89fa1 127.0.0.1 30002 master - 5461-10922
    ```
    `$VERSION` means current cluster topology version that is stored or generated by management component such as config server or meta-server.
      Kvrocks can know itself node id by compared with itself ip and port in received `all nodes info`

From now, it works well, we just tell every node of kvrocks cluster by `CLUSTER SETNODES` when scale(slot data migration) or failover. Clients(redis-cli, sdk, proxy) will reacquire cluster topology when they finds requests are rejected or `MOVED` by using old topology to route requests. To avoid missing notify nodes new topology, we can set new cluster topology every longer interval.

  _*Please notice that: the cluster solution for kvrocks doesn't handle scale or failover._

## 2.1 Advanced version
We find we always tell every node entire cluster topology even just changing one node info. If the cluster is very large, the message will be big, so we also fall into the damage of network communication, and cluster management component may can't support that. So we may need to support incremental changing notification. When changing topology, we only send one light command to change the topology in kvrocks server. To implement incremental changing notification, we must use `version` to identify current topology version, otherwise, kvrocks may keep a wrong cluster topology if missing one changing topology message. Kvrocks only supports to apply one command content when its version is valid by compared with the `$version` in command, if not, kvrocks must return an error, and we will set new entire cluster topology by `CLUSTER SETNODES` command.

There are some commands we may need to support.
-  (optional) CLUSTER VERSION
    Get version of node, so that we can check its' version is right or not.
-  (optional) CLUSTER SETNODEID `$NODE_ID`
    Explicitly tell the node its node id.
-  (optional) CLUSTER SETNODE `$NODE_ID` `$NODE_INFO` `$VERSION`
    Only update one node info
-  (optional) CLUSTER DELNODE `$NODE_ID` `$VERSION`
    Delete one node of cluster
-  (optional) CLUSTER REPLICATE `$NODE_ID`
    Just like `slaveof`, similar with redis command.
-  (optional) CLUSTER MIGRATE `$SLOT_ID` `$NODE_ID`
    Migrate all keys belonging the slot to another node
-  (optional) CLUSTER SETSLOT `$SLOT_ID` `$NODE_ID` `$VERSION`
    Only update one slot distribution, that is useful to avoid too many big messages when we scale cluster.
-  (optional) CLUSTER SLOTS/INFO/KEYSLOT/GETKEYSINSLOT/COUNTKEYSINSLOT
    To make kvrocks cluster similar with redis cluster

# 3 Advantages and disadvantages
## 3.1 Advantages
- It is easy to implement and make less bugs.
- Cluster logic are removed from server, so that we needn't change kvrocks code when optimizing fault check or failover for kvrocks instances. 
## 3.2 Disadvantages
- Topology changing notifications are sent by other component, clients may feel latency when cluster topology change, even although that is low-frequency.
- It is not perfect, we still need a cluster management component to manage cluster such as failover and scale.

# 4 Extra works
- More redis cluster commands to manage kvrocks cluster conveniently just like redis cluster.
- Cluster management component. To make kvrocks cluster easy, we may provide a cluster management component to deal with linear scale, failover, or management.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/219/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/219,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2ODkxMjkwMw==,kvrocks,868912903,219,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-06-26T01:33:05Z,2021-06-26T01:33:05Z,Reopen for unfinished extra work,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2ODkxMjkwMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/219,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxiDp,kvrocks,1288052969,219,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-23T08:40:09Z,2022-10-23T08:40:09Z,@ShooterIT can you list out the pending works to complete this issue? Or superseding this one with a new issue describing the status quo.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxiDp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/219,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RSnVQ,kvrocks,1363834192,219,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-12-23T10:38:34Z,2022-12-23T10:38:34Z,"Hi @tisonkun i think we can close it, kvrocks has supported slot-based data migration, and kvrocks controller already can be used. Thanks for your attention.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RSnVQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/220,https://api.github.com/repos/apache/kvrocks/issues/220,kvrocks,858450386,220,[QUESTION] Should we use backup or checkpoint of rocksdb for kvrocks backup,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2021-04-15T03:38:38Z,2021-04-23T08:54:30Z,"Currently, we use checkpoint of rocksdb to implement kvrocks full synchronization, but kvrocks backup still uses backup of rocksdb. As we know, rocksdb backup costs much bandwidth and space of disk, but rocksdb backup can implement incremental backup and support to store into HDFS, these are good features. So i think we should make a decision to use  backup or checkpoint of rocksdb for kvrocks backup. WDYT? @git-hulk @karelrooted @Alfejik ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/220/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/220,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMDA2MTAzNQ==,kvrocks,820061035,220,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-04-15T03:55:29Z,2021-04-15T03:55:29Z,"It's really a good question, we expected users to use another disk to store the backup, but seems most users won't do that. So it would be fine only to support the checkpoint for kvrocks backup IMO.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMDA2MTAzNQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/220,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMDA5NzEyNA==,kvrocks,820097124,220,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-04-15T05:02:52Z,2021-04-15T05:02:52Z,"> we expected users to use another disk to store the backup

Yes, i think users don't buy this idea, it is not easy to deploy and maintain. For remote backup, that is a good idea because our server originally is a persistent key value server and the backup should not be local.  but actually HDFS is not common because some companies don't use it, they may just copy backup to other servers or remote storage.

Maybe it is good idea to support them together, although it is some bit trouble. Firstly, we can only support to use rocksdb checkpoint as kvrocks backup.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMDA5NzEyNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/220,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMDI3NDUzOQ==,kvrocks,820274539,220,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-04-15T09:24:00Z,2021-04-15T09:24:00Z,"yeah, it would be better to support both if it didn't import too much complexity.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMDI3NDUzOQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/220,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyNTUwOTY4Mg==,kvrocks,825509682,220,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-04-23T08:54:29Z,2021-04-23T08:54:29Z,"For incremental backup, maybe https://github.com/bitleak/kvrocks/wiki/How-to-backup can give you a idea :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyNTUwOTY4Mg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/223,https://api.github.com/repos/apache/kvrocks/issues/223,kvrocks,861870923,223,[BUG] Docker image is dead,jbenguira,1835561,Joseph Benguira,,CLOSED,2021-04-19T20:40:33Z,2021-04-20T05:19:17Z,"I tried the docker version indicated in the readme:
docker run -it -p 6666:6666 bitleak/kvrocks

But it's failing because the docker image is not available anymore on docker hub.

Is there any reason why?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/223/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/223,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMjkxNzk3Mw==,kvrocks,822917973,223,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-04-20T02:11:04Z,2021-04-20T02:11:04Z,@jbenguira sorry that the latest docker image was deleted by mistake and it's recovered now. You can have a try now.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMjkxNzk3Mw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/223,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMjk4MDYwMQ==,kvrocks,822980601,223,NA,jbenguira,1835561,Joseph Benguira,,NA,2021-04-20T05:19:17Z,2021-04-20T05:19:17Z,Thanks :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMjk4MDYwMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/225,https://api.github.com/repos/apache/kvrocks/issues/225,kvrocks,862980847,225,[BUG] Unable to build.,shanemarsh28,16979556,Shane Marsh,,CLOSED,2021-04-20T16:11:41Z,2021-04-21T06:05:57Z,"Attempting to compile as per instructions on Readme. Unable to build.

![image](https://user-images.githubusercontent.com/16979556/115429334-3865f000-a1fb-11eb-9fa8-619e4c5c8681.png)

`./db/version_edit.h:86:8: error: implicitly-declared ‘constexpr rocksdb::FileDescriptor::FileDescriptor(const rocksdb::FileDescriptor&)’ is deprecated [-Werror=deprecated-copy]`

 - OS: Ubuntu 20.04
 - GCC/G++ (Ubuntu 9.3.0-17ubuntu1~20.04) 9.3.0
 - GNU Make 4.2.1

**To Reproduce**
Steps to reproduce the behavior:
1. Build as per instructions on README
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/225/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/225,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMzQ1NjMwMQ==,kvrocks,823456301,225,NA,shanemarsh28,16979556,Shane Marsh,,NA,2021-04-20T17:12:50Z,2021-04-20T17:12:50Z,"Just an as update, it wouldn't compile under GCC 10.2.0 either but I did have success using GCC 8.4.0.

Perhaps add that as a requirement within your Readme.md?

![image](https://user-images.githubusercontent.com/16979556/115434306-74e81a80-a200-11eb-8a3d-7cac45fd5a57.png)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMzQ1NjMwMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/225,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMzcxOTA3NQ==,kvrocks,823719075,225,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-04-21T02:02:39Z,2021-04-21T02:02:39Z,"many thanks to @shanemarsh28 to find out about this issue, it seems rocksdb doesn't support higher version GCC(>=9) and fixed in newer, we would also fix that. any progress would update in this channel.

relate issue: https://github.com/facebook/rocksdb/issues/5303","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMzcxOTA3NQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/225,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMzc4NDAyMw==,kvrocks,823784023,225,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-04-21T05:20:06Z,2021-04-21T05:20:06Z,"We have confirmed that the newer version(after 6.15.1) of rocksdb has compatible with gcc9 in ubuntu20.04. @karelrooted would help to investigate whether the newer version has other issues within kvrocks, and we would upgrade the rocksdb dependence to the latest if all works well. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyMzc4NDAyMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/227,https://api.github.com/repos/apache/kvrocks/issues/227,kvrocks,863877095,227,[NEW] set a max size in mb and max connections to a namespace,jbenguira,1835561,Joseph Benguira,,CLOSED,2021-04-21T13:13:21Z,2021-04-21T14:49:53Z,"It would be really great to be able to set a max size (in mb ideally or number of keys) and a max number of connections to a namespace. The use case is to have a shared instance that can be used safely with quota by a lot of users.

Thanks for considering this :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/227/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/227,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyNDEyMTgxNg==,kvrocks,824121816,227,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-04-21T14:48:31Z,2021-04-21T14:48:31Z,"It's hard to isolate the connection or the DB size between namespaces with the current design, since the namespace was designed to isolate data between different dimension data like Redis DB indeed, with no intention to solve the multi-users in the same instance.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyNDEyMTgxNg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/227,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyNDEyMjk4MA==,kvrocks,824122980,227,NA,jbenguira,1835561,Joseph Benguira,,NA,2021-04-21T14:49:53Z,2021-04-21T14:49:53Z,OK thanks for the clarification,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgyNDEyMjk4MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/242,https://api.github.com/repos/apache/kvrocks/issues/242,kvrocks,874382041,242,[BUG] docker image crash,aberfeldy,1640534,Andreas Feldmann,,CLOSED,2021-05-03T09:03:42Z,2021-05-04T08:46:05Z,"**Describe the bug**
Hey!
Tried to run kvrocks with your docker image, but it doesn't start or produce any logs. Docker deamon on Mac and ubuntu (20.0.3 & 20.10.6) both report that the container exited with Code 132. 
So I cloned into the 2.0 branch and build from source and to build the docker image fresh. And then it worked like charm, it logs `Version: 2.0.0 @000b3627` and redis-cli is fine with it.
Did I miss anything while starting the docker container from the README instructions? 

**To Reproduce**
Steps to reproduce the behavior:
1. docker run -it -p 6666:6666 bitleak/kvrocks

docker inspect ...
```
""State"": {
            ""Status"": ""exited"",
            ""Running"": false,
            ""Paused"": false,
            ""Restarting"": false,
            ""OOMKilled"": false,
            ""Dead"": false,
            ""Pid"": 0,
            ""ExitCode"": 132,
            ""Error"": """",
            ""StartedAt"": ""2021-05-03T09:02:17.8104824Z"",
            ""FinishedAt"": ""2021-05-03T09:02:17.8757551Z""
        },
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/242/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/242,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzMTI2OTY0OQ==,kvrocks,831269649,242,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-05-03T13:45:43Z,2021-05-03T13:45:43Z,"Thanks for your feedback, I also tried that on my side and it's caused by Illegal instruction. I'll work on it and update if has any progress.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzMTI2OTY0OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/242,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzMTMwNDM0Ng==,kvrocks,831304346,242,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-05-03T14:40:29Z,2021-05-03T14:40:29Z,Fixed in https://github.com/bitleak/kvrocks/pull/244,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzMTMwNDM0Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/242,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzMTcyODM3Ng==,kvrocks,831728376,242,NA,aberfeldy,1640534,Andreas Feldmann,,NA,2021-05-04T07:08:12Z,2021-05-04T07:08:12Z,"Tried it out right now, got: `Version: 999.999.999 @e28d7ba8`
Love it, thanks a lot!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzMTcyODM3Ng==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/249,https://api.github.com/repos/apache/kvrocks/issues/249,kvrocks,877494577,249,[NEW] Impl the `command` command which compatible with Redis,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-05-06T13:24:14Z,2021-05-10T09:20:11Z,we want a `command` command like the Redis and leave attributes empty if missing,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/249/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/257,https://api.github.com/repos/apache/kvrocks/issues/257,kvrocks,880839014,257,Dead lock possible?,calvinxiao,929238,Calvin Xiao,calvin325@gmail.com,CLOSED,2021-05-08T13:41:45Z,2021-05-08T14:53:58Z,"The following code loop over `vector<StringPair>` and perform locking on each item.

- https://github.com/bitleak/kvrocks/blob/fbc41f03473c126a51c446a9216fef596dd47adc/src/redis_string.cc#L271-L285
- https://github.com/bitleak/kvrocks/blob/fbc41f03473c126a51c446a9216fef596dd47adc/src/redis_string.cc#L309-L323

If the keys are not sorted, is there going to be a potential dead lock problem?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/257/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/257,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzNTM4NzMxMQ==,kvrocks,835387311,257,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-05-08T14:38:23Z,2021-05-08T14:38:23Z,"Good question, there's not a possible deadlock since we lock and unlock one key every loop. if we lock all keys outside at once outside the loop that may cause deadlock without sorting. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzNTM4NzMxMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/257,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzNTM5MjI1Nw==,kvrocks,835392257,257,NA,calvinxiao,929238,Calvin Xiao,calvin325@gmail.com,NA,2021-05-08T14:53:57Z,2021-05-08T14:53:57Z,"Right, it will get unlocked after each loop.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDgzNTM5MjI1Nw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/273,https://api.github.com/repos/apache/kvrocks/issues/273,kvrocks,899370548,273,[QUESTION]hset mutiple arguments not supported?,hellower,7464662,,,CLOSED,2021-05-24T07:23:35Z,2021-05-25T05:08:45Z,"@@redis
127.0.0.1:6379> hset me lang english sex male
(integer) 2
127.0.0.1:6379> hgetall me
1) ""lang""
2) ""english""
3) ""sex""
4) ""male""
127.0.0.1:6379> 

===========================================================
@@kvrocks

127.0.0.1:6666>  hset me lang english sex male
(error) ERR wrong number of arguments        <====================
127.0.0.1:6666> 



127.0.0.1:9188> info
# Server
version:999.999.999
git_sha1:18d71d0d
os:Linux 4.19.0-16-cloud-amd64 x86_64
gcc_version:8.3.0
arch_bits:64
process_id:13
tcp_port:9188
uptime_in_seconds:313
uptime_in_days:0
# Clients
connected_clients:1
monitor_clients:0
...........
# RocksDB
estimate_keys[default]:1
block_cache_usage[default]:0
block_cache_pinned_usage[defa
......","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/273/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/273,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0NjgzNzAwMA==,kvrocks,846837000,273,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-05-24T07:36:34Z,2021-05-24T07:36:34Z,"Yes, currently HSET command doesn't support multiple arguments. Let's support it 😄 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0NjgzNzAwMA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/273,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0NzUzNDkwNA==,kvrocks,847534904,273,NA,hellower,7464662,,,NA,2021-05-25T05:08:44Z,2021-05-25T05:08:44Z,"wow !! 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0NzUzNDkwNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/275,https://api.github.com/repos/apache/kvrocks/issues/275,kvrocks,901544731,275,[BUG] dbsize return wrong value,hellower,7464662,,,CLOSED,2021-05-26T00:21:56Z,2021-05-26T04:15:49Z,"##################
# redis
##################
127.0.0.1:6379> keys *
1) ""a""
2) ""_tntchecker_""
3) ""b""
127.0.0.1:6379> dbsize    <========== keys count
(integer) 3
127.0.0.1:6379>  info keyspace
-# Keyspace
db0:keys=3,expires=0,avg_ttl=0    <======== keys=3

##################
# kvrocks
##################
127.0.0.1:6666> keys *
1) ""a""
2) ""_tntchecker_""
3) ""b""
127.0.0.1:6666> dbsize    <========== keys count
(integer) 0               <======= always return 0!!
127.0.0.1:6666>  info keyspace
-# Keyspace
-# Last scan db time: Thu Jan  1 00:00:00 1970
db0:keys=0,expires=0,avg_ttl=0,expired=0   <===== keys 0 
sequence:38283437
used_db_size:603247462
max_db_size:0
used_percent: 0%
disk_capacity:322110992384
used_disk_size:161157144576
used_disk_percent: 50%
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/275/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/275,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0ODM5OTA2OQ==,kvrocks,848399069,275,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-05-26T02:01:25Z,2021-05-26T02:01:25Z,"Thanks for your report, it's not a bug actually, the kvrocks key-values were stored in disk, and find out expired keys was impossible unless we can scan it. So we MUST execute the `dbsize scan` command to async scan the DB for finding out the key number.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0ODM5OTA2OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/275,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0ODQxMjkwOA==,kvrocks,848412908,275,NA,hellower,7464662,,,NA,2021-05-26T02:43:47Z,2021-05-26T02:43:47Z,"Thanks!
and Thank you for nice KVROCKS open source.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0ODQxMjkwOA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/275,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0ODQ0MDQwMg==,kvrocks,848440402,275,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-05-26T04:15:48Z,2021-05-26T04:15:48Z,Also welcome you to join in improving kvrocks 😄 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg0ODQ0MDQwMg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/283,https://api.github.com/repos/apache/kvrocks/issues/283,kvrocks,907163823,283,[NEW] TTL of member,hellower,7464662,,,OPEN,2021-05-31T07:16:52Z,2023-03-18T02:53:58Z,"```
redis> SADD mybasket goods-id
redis> expire mybasket goods-id 10
redis>	1
redis>	expire mybasket goods-id1 goods-id2 goods-id3 10
redis>	3
```

```
redis>	sadd myset mem10
redis>	1
redis>	expire myset mem10 5
redis>	1
redis>	ttl myset mem10
redis>	3
redis>	ttl myset mem10
redis>	-2
redis>	smembers myset
redis>	(empty list or set)
```

This is a feature of redis-enterprise only.   (supported data type: SET, ZSET, HASH)


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/283/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/283,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MTM2NDMzNg==,kvrocks,851364336,283,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-05-31T09:40:52Z,2021-05-31T09:40:52Z,"This feature seems really useful in many scenes and supports it shouldn't be hard except having the breaking change. Maybe we can support it in V3, how do you think? @bitleak/kvrocks-core-team 

BTW:  @hellower welcome to join [the slack channel](https://join.slack.com/t/kvrockscommunity/shared_invite/zt-p5928e3r-OUAK8SUgC8GOceGM6dAz6w) if wants to exchange any thoughts about the kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MTM2NDMzNg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/283,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MzA4MTQyOA==,kvrocks,853081428,283,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-06-02T14:34:48Z,2021-06-02T14:34:48Z,OK. Let's add this feature request into 3.0 project todo.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MzA4MTQyOA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/286,https://api.github.com/repos/apache/kvrocks/issues/286,kvrocks,909115257,286,[QUESTION]when will rocksdb.write_buffer_size be changed to 16,stutiredboy,345208,stutiredboy,,CLOSED,2021-06-02T05:18:38Z,2021-06-03T09:32:50Z,"![image](https://user-images.githubusercontent.com/345208/120427464-86e2de80-c3a4-11eb-89be-828ec993714f.png)

Version: 2.0.1 @5f41145a

I set target_file_size_base and rocksdb.write_buffer_size to 128 in kvrocks.conf then use config get to double check the value was set to 128.

But, some minutes later, the value was changed to 16, log in kvrocks.INFO

```
I0602 11:43:43.800396 11653 server.cc:1022] [server] Resize rocksdb.target_file_size_base from 128 to 16, average_kv_size: 15, total_size: 104606264039, total_keys: 6620970652, result: ok
I0602 11:43:45.627482 11653 server.cc:1038] [server] Resize rocksdb.write_buffer_size from 16 to 16, average_kv_size: 15, total_size: 104606264039, total_keys: 6620970652, result: ok
```

We can find that `rocksdb.target_file_size_base` was changed to 16, then `rocksdb.write_buffer_size` was changed to the same as `rocksdb.target_file_size_base`.
And the most interesting is `from 16 to 16` but not `from 128 to 16`, I'm quite sure the value for `rocksdb.write_buffer_size` in kvrocks.conf is 128 before kvrocks started.

Questions:

1. when will this happen or this is a bug?
2. what also can I do for your tracing","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/286/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/286,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjczMzk1MA==,kvrocks,852733950,286,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-02T05:25:21Z,2021-06-02T05:25:21Z,"hi @stutiredboy Thanks for your feedback, kvrocks would auto-adjust the `write_buffer_size` by calculating the `key-value` size, see the related issue: https://github.com/bitleak/kvrocks/issues/118

As the second issue(the write buffer size from 16 to 16), we'll investigate and feedback here.

cc @karelrooted ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjczMzk1MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/286,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjczODQxMw==,kvrocks,852738413,286,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-06-02T05:32:12Z,2021-06-02T05:32:12Z,"I think we maybe should provide one config to enable auto-adjust of the write_buffer_size  and memtable, instead of always enable, because, users maybe have their own method or optimization strategy such as munual config","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjczODQxMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/286,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjczOTI2Mg==,kvrocks,852739262,286,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-02T05:34:06Z,2021-06-02T05:34:06Z,"yeah, also the second issue was a bug that we didn't update the config. I'll submit a new issue for @karelrooted .","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjczOTI2Mg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/286,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjkxMDczMg==,kvrocks,852910732,286,NA,karelrooted,523980,karelrooted,,NA,2021-06-02T10:25:39Z,2021-06-02T10:25:39Z,"the old write_buffer_size in the log is a typo(use the newly setted value as old value), the auto-resize-block-and-sst config directive is added in PR: https://github.com/bitleak/kvrocks/pull/289","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MjkxMDczMg==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/287,https://api.github.com/repos/apache/kvrocks/issues/287,kvrocks,909126000,287,[BUG] Auto-adjust write buffer size didn't update the config item,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-06-02T05:38:20Z,2021-06-02T14:25:25Z,"As issue: https://github.com/bitleak/kvrocks/issues/286 mentioned that the write buffer size was resized but didn't update the config value as well.

BTW: as @ShooterIT mentioned, we should become this behavior with a config value that allows users to enable/disable this feture.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/287/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/292,https://api.github.com/repos/apache/kvrocks/issues/292,kvrocks,909977437,292,[QUESTION]slaveof field accept ip only?,hellower,7464662,,,CLOSED,2021-06-03T00:14:07Z,2021-06-03T03:08:41Z,"I have configured kvrocks master and slave on one server.
master kvrocks port : 9188
slave kvrocks port: 9288


In the slave's configuration file.
If I put  hostname instead of ip in ""slaveof field"", an error occurs.

but Redis works fine with both ip and hostname in slaveof field.



#####################################################
kvrocks.conf of slave
    ............... 
    slavof localhost 9188 
    ............... 

SLAVE$ ./kvrocks -c kvrocks.conf
Version: 999.999.999 @0daf3b5e
E0603 09:06:30.111851  5138 replication.cc:214] [replication] Failed to start state machine, err: Network is unreachable  <====== ERROR!

####################################################
kvrocks.conf of slave
    ............... 
    slavof 127.0.0.1 9188 
    ............... 
SLAVE$ ./kvrocks -c kvrocks.conf
Version: 999.999.999 @0daf3b5e    <====== works good!


cf.
**__STAGE__$ ping localhost
PING localhost (127.0.0.1) 56(84) bytes of data.
64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.031 ms
64 bytes from localhost (127.0.0.1): icmp_seq=2 ttl=64 time=0.041 ms
64 bytes from localhost (127.0.0.1): icmp_seq=3 ttl=64 time=0.052 ms**","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/292/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/292,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MzUwMDIyMQ==,kvrocks,853500221,292,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-03T01:55:01Z,2021-06-03T01:55:01Z,"cool, thanks for finding out about this issue, do you want to create a PR to fix it?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1MzUwMDIyMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/293,https://api.github.com/repos/apache/kvrocks/issues/293,kvrocks,910051043,293,[BUG] Allow to use host in the replication,hellower,7464662,,,CLOSED,2021-06-03T03:08:21Z,2021-06-08T13:39:15Z,"I have configured kvrocks master and slave on one server.
master kvrocks port : 9188
slave kvrocks port: 9288

In the slave's configuration file.
If I put hostname instead of ip in ""slaveof field"", an error occurs.

but Redis works fine with both ip and hostname in slaveof field.

#####################################################
kvrocks.conf of slave
...............
slavof localhost 9188
...............

SLAVE$ ./kvrocks -c kvrocks.conf
Version: 999.999.999 @0daf3b5e
E0603 09:06:30.111851 5138 replication.cc:214] [replication] Failed to start state machine, err: Network is unreachable <====== ERROR!

####################################################
kvrocks.conf of slave
...............
slavof 127.0.0.1 9188
...............
SLAVE$ ./kvrocks -c kvrocks.conf
Version: 999.999.999 @0daf3b5e <====== works good!

cf.
STAGE$ ping localhost
PING localhost (127.0.0.1) 56(84) bytes of data.
64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.031 ms
64 bytes from localhost (127.0.0.1): icmp_seq=2 ttl=64 time=0.041 ms
64 bytes from localhost (127.0.0.1): icmp_seq=3 ttl=64 time=0.052 ms","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/293/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/293,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1Njc3NTc4MQ==,kvrocks,856775781,293,NA,hellower,7464662,,,NA,2021-06-08T13:38:10Z,2021-06-08T13:38:10Z,"Now, It works good. Thank you all!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1Njc3NTc4MQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/293,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1Njc3NjYzNA==,kvrocks,856776634,293,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-08T13:39:15Z,2021-06-08T13:39:15Z,Really thanks for your feedback.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1Njc3NjYzNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/297,https://api.github.com/repos/apache/kvrocks/issues/297,kvrocks,910796341,297,How is this possible with column families? Question1: why store the version in the metadata,hiqsociety,51492452,HIQ Society,,CLOSED,2021-06-03T19:37:15Z,2021-06-04T17:23:43Z,"with reference to storing version in the metadata, how is it possible that i delete the key, 
    
         with version we can fast delete the metadata and then recycle the others keys-values in compaction background threads. 
         
what i mean is, how is it possible that deleting metadata will also delete the versioning? afterall u still need to cycle through key|version|field to delete them so the value will be deleted too.

can anyone give a better idea how this is done?

how is the key => metadata linked? multi cf or multi layer cf doesnt seem to be possible.

is this key version field below in its own cf by itself?

+---------------+
key|version|field => |     value     |
+---------------+

````
Question1: why store the version in the metadata
we store the hash keys/values into single key-value, if the store millions of sub keys-values in one hash key . if user delete this key, the kvrocks must iterator millions of sub keys-values and delete, and it would cause performance problem. with version we can fast delete the metadata and then recycle the others keys-values in compaction background threads. the cost is those tombstone key would take some disk stroage. you can regard the version as atomic increment number, but it’s combined with timestamp.
````","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/297/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/297,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1NDMxMzc1MA==,kvrocks,854313750,297,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-04T02:36:41Z,2021-06-04T02:36:41Z,"I try to summary your questions, correct me if misunderstood:

**1. Why delete metadata would delete the subkeys all well?**


this question explained by how we read and write the `hash` key-value:

From the write side:

If the user sends the `HSET hash_key field value`, then kvrocks would lookup the metadata with the key `hash_key`, it would generate a new one if no exists.  The metadata format was like `flags|expire|version|size`(see: [metadata design](https://github.com/bitleak/kvrocks/blob/unstable/docs/metadata-design.md)) and the version was unique(you can regard it as a monolithic increase sequence number). Only the metadata key was deleted when the user deletes the hash key which we call it fast delete, and it would generate new metadata with a new version

From the read side：

When the user sends the `HGET hash_key field` then lookup the metadata as well,  then use the version in the metadata to compose the subkey(`key|version|field`) and look up the field value. So subkeys were not found if the metadata was deleted since the metadata lookup subkey with version. It's the reason why fast delete works.

Finally, we recycle those old versions key-values in the background compaction thread


**2. How is the key => metadata linked? multi cf or multi-layer cf doesn't seem to be possible**

> I didn't get the meaning of this one
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1NDMxMzc1MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/297,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1NDQ2MDgyMQ==,kvrocks,854460821,297,NA,hiqsociety,51492452,HIQ Society,,NA,2021-06-04T07:59:26Z,2021-06-04T07:59:26Z," this is manual trigger by the auto background compaction thread? 
 ```` 
 Finally, we recycle those old versions key-values in the background compaction thread
 ````
basically u are saying u perform a ""fast delete"" BUT there's no overall cpu savings when it comes to complete deletion other than using the background deletion right?
 
i thought it's a CF deletion, no wonder i cant find anything much on it. this explanation is much ""better"".","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1NDQ2MDgyMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/297,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1NDg2NTI1OQ==,kvrocks,854865259,297,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-04T16:40:57Z,2021-06-04T16:40:57Z,"No, background compaction was automatic","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1NDg2NTI1OQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/297,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1NDg4ODc3MA==,kvrocks,854888770,297,NA,hiqsociety,51492452,HIQ Society,,NA,2021-06-04T17:23:43Z,2021-06-04T17:23:43Z,ok thx,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1NDg4ODc3MA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/305,https://api.github.com/repos/apache/kvrocks/issues/305,kvrocks,917667995,305,[NEW] Redis modules,ehsanonline,4243503,Ehsan,,CLOSED,2021-06-10T18:19:34Z,2024-03-11T11:21:50Z,"Supporting redis modules like RedisSearch and RedisGraph would be great. I tried to install them but there is no `MODULE LOAD` command or `loadmodule` in config file.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/305/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/305,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1OTIxMjEzMQ==,kvrocks,859212131,305,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-11T02:17:09Z,2021-06-11T02:17:09Z,"There's no possibility to use those Redis modules directly since the Kvrocks storage was on the disk, maybe we can implement mostly used modules ourselves.

@bitleak/kvrocks-core-team ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1OTIxMjEzMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/305,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1OTI0NDYyMQ==,kvrocks,859244621,305,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-06-11T03:56:56Z,2021-06-11T03:56:56Z,"Thanks for your attention @ehsanonline Exactly, kvrocks doesn't support, actually, in our project 3.0, we want to multiple data models.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg1OTI0NDYyMQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GBQqg,kvrocks,1174735520,305,NA,crypt0miester,77497858,Cryptomiester,,NA,2022-07-05T07:53:14Z,2022-07-05T07:53:14Z,"any updates on this? I am working on a project that would make this a deal breaker. 

basically RedisSearch is needed to index a high volume dataset. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GBQqg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GExg_,kvrocks,1175656511,305,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-07-06T01:06:52Z,2022-07-06T01:06:52Z,"I think, for the search scenario, it is probably a relatively large project.  What I do know is that kvrocks will probably implement JSON first.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GExg_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFCLN,kvrocks,1175724749,305,NA,crypt0miester,77497858,Cryptomiester,,NA,2022-07-06T03:00:19Z,2022-07-06T03:00:19Z,alrighty. thanks champ. keep it up.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFCLN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/312,https://api.github.com/repos/apache/kvrocks/issues/312,kvrocks,923318616,312,Difference between kvrocks and pika,dongdongwcpp,85050932,Axel,,CLOSED,2021-06-17T02:04:17Z,2021-06-27T05:15:42Z,"What is the difference between pika and kvrocks? Does kvrocks provide better performance than pika?
Any improvements on the blackwidow storage engine design？","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/312/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/312,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2MjkzODI2Nw==,kvrocks,862938267,312,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-17T05:30:10Z,2021-06-17T05:30:10Z,"It's a good question, many users should have the same confusion, I would try to explain differences, but it's only my objective thoughts and can't promise fairness.

**From the key design:**

* We prefer to keep consistent with Redis sematic which the Pika didn't. e.g.  Pika allows different types to have the same key which wasn't expected.
* We do much work on improving the performance and decreasing the latency. Like  auto adjust the block and SST with the key-value size,  as well as using the compaction checker to reduce the full compaction on the RocksDB.
* We also care about profiling which would help users to find the performance issue. Users can use the `perf` command to investigate the issue when suffering the latency spike.
* Finally,  the core competitiveness of the kvrocks was simple and maintainable enough for most users. The tendis should be too complex for most users/companies, also hard to deploy.

**From the organization:**

this project didn't own by any company, it's a totally open-source org. Also, core team members were from different companies with many years in the distributed key-value field.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2MjkzODI2Nw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/315,kvrocks,926262415,315,Support Watch/Unwatch,snowbldr,5445491,,,CLOSED,2021-06-21T14:12:50Z,2023-03-14T03:13:16Z,"I would like to use Watch and Unwatch for full transaction support. 

yinqiwen/ardb has a working watch/unwatch impl in case that is useful as a reference.

https://github.com/yinqiwen/ardb","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/315/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2NTA3OTYwMw==,kvrocks,865079603,315,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-21T14:29:29Z,2021-06-21T14:29:29Z,"Sure, let's add to the 2.0 plan: https://github.com/KvrocksLabs/kvrocks/projects/1#card-63523056","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2NTA3OTYwMw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GVpEb,kvrocks,1180078363,315,NA,201341,13047679,Wenjie,1186093704@qq.com,NA,2022-07-11T07:51:55Z,2022-07-11T07:51:55Z,@git-hulk any update about this feature?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GVpEb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GZ7AN,kvrocks,1181200397,315,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-07-12T01:05:27Z,2022-07-12T01:05:27Z,Does implementing these two commands have a performance impact? @ShooterIT ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GZ7AN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GaAYy,kvrocks,1181222450,315,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-12T01:50:56Z,2022-07-12T01:50:56Z,"


> Does implementing these two commands have a performance impact? @ShooterIT

Another concern was that we didn't implement multi-keys lock and it's ready now,
maybe we can have a try.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GaAYy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jh7BC,kvrocks,1233629250,315,NA,dirkpetersen,1427719,Dirk Petersen,,NA,2022-09-01T01:32:34Z,2022-09-01T01:32:34Z,"I'd also like to get watch/unwatch implemented  as it is required by https://juicefs.com/ 

2022/08/31 18:25:33.286338 juicefs[26231] <WARNING>: checking counter lastCleanupSessions: ERR unknown command watch [base.go:303]
2022/08/31 18:25:35.278170 juicefs[26231] <WARNING>: checking counter lastCleanupFiles: ERR unknown command watch [base.go:389]
2022/08/31 18:25:45.327653 juicefs[26231] <WARNING>: checking counter lastCleanupSessions: ERR unknown command watch [base.go:303]","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jh7BC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JiRCE,kvrocks,1233719428,315,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-01T04:16:48Z,2022-09-01T04:16:48Z,@dirkpetersen Thanks for your feedback,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JiRCE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5R9DvS,kvrocks,1374960594,315,NA,0xgeert,393259,Geert,,NA,2023-01-08T23:36:29Z,2023-01-08T23:36:29Z,Looking forward to this as well. Needed to implement a distributed counter / id generator,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5R9DvS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SFrEC,kvrocks,1377218818,315,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-10T12:57:30Z,2023-01-10T12:57:30Z,"@0xgeert Thanks for your feedback, will add it to 2023 planning.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SFrEC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SFtrJ,kvrocks,1377229513,315,NA,DenizPiri,519796,Deniz Piri,denizpiri@hotmail.com,NA,2023-01-10T13:06:11Z,2023-01-10T13:06:11Z,"We would very much like to see this feature too. It would essentially make it a fully transactional DB. Ideally, it would be nice if it wouldn't affect the performance that much.

Our most common use case would be this:
```
WATCH key
GET key
MULTI
SET key modifiedValue
EXEC
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SFtrJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SFwDO,kvrocks,1377239246,315,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-10T13:12:57Z,2023-01-10T13:12:57Z,"@DenizPiri Thanks, we are also very eager to have this feature but didn't take much time to dive deep. I think it's time to do it now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SFwDO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V9CKr,kvrocks,1442063019,315,NA,PragmaTwice,20042607,Twice,,NA,2023-02-23T16:21:30Z,2023-02-23T16:21:30Z,"Consider some implemenation methods from scratch:

**by snapshots:**
It seems to be more ""elegant"", but is more heavy: make snapshots by each watched key many affect many details in rocksdb,
e.g. the GC process and more.
And it has some different behavior than redis:
```
set a 1
watch a
set a 1
multi
get a
exec
```
Redis will return nil, while the snapshot method will continue to execute this redis txn (and return 1).

**by command & key tracing:**
It seems a little complicated but more clean and has more less influence on storage.

I will try the second way these days, but maybe slow since I have lots of other things to do.

@git-hulk @ShooterIT @caipengbo ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V9CKr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_baR,kvrocks,1442690705,315,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-24T02:03:32Z,2023-02-24T02:03:32Z,"Thanks for @PragmaTwice driving this design.

> Redis will return nil, while the snapshot method will continue to execute this redis txn (and return 1).

So we will check if the watched keys are modified by value, is it right?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_baR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_flr,kvrocks,1442707819,315,NA,PragmaTwice,20042607,Twice,,NA,2023-02-24T02:26:56Z,2023-02-24T02:26:56Z,"> So we will check if the watched keys are modified by value, is it right?

We will do this as what redis does: just trace commands by flags and key arguments instead of comparing by value, since the snapshot way is too heavy.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_flr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_gUO,kvrocks,1442710798,315,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-24T02:31:36Z,2023-02-24T02:31:36Z,"Got it, thanks for your explanation.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_gUO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WBG4S,kvrocks,1443130898,315,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-02-24T08:32:37Z,2023-02-24T08:32:37Z,"Personally, I thin using snapshot is too heavy, it may block record gc, and maintaining it is heavy, and logic of snapshot might be heavy.

Using `watchkeys` as hashmap, and maintaining them seems ok, though it may meets some concurrent and performance related issue. I think this is ok and better.

Another way is, like replication, find these keys and ops from WAL.

Comparing to check keys in commands and wal, the first one may not has best performance, but it's easy and real-time. The later may have better performance, but user may get the message a bit later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WBG4S/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5W7OEs,kvrocks,1458364716,315,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-07T15:26:16Z,2023-03-07T15:26:16Z,"Hi, folks. This watch/unwatch command has been merged into unstable, welcome to have a try if you are interested. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5W7OEs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XZ3lE,kvrocks,1466399044,315,NA,DenizPiri,519796,Deniz Piri,denizpiri@hotmail.com,NA,2023-03-13T15:45:59Z,2023-03-13T15:45:59Z,"@git-hulk We started utilizing this in one of our projects. We migrated from redis. It has been running for the last 2 days. It seems to be working very well so far. 🚀 Doing around 1500ops/sec, mostly single key WATCH -> GET -> MULTI -> SET -> EXEC commands.

If we were to use WATCH/UNWATCH support more widely in our other projects too, assuming that 99.9% of the time transactions will execute without any conflicts. Should we expect degraded performance, possibly because of a lock contention?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XZ3lE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Xc8k9,kvrocks,1467205949,315,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-14T01:27:52Z,2023-03-14T01:27:52Z,"@DenizPiri Thanks for your feedback and give the credit to @PragmaTwice great work.

> If we were to use WATCH/UNWATCH support more widely in our other projects too, assuming that 99.9% of the time transactions will execute without any conflicts. Should we expect degraded performance, possibly because of a lock contention?

Yes, it may have a performance issue since the MULTI-EXEC is an exclusive operation even though most of the commands are no conflicts. I'm also seeking a way to improve this situation, but you can have a simple benchmark before using it.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Xc8k9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XdQVr,kvrocks,1467286891,315,NA,PragmaTwice,20042607,Twice,,NA,2023-03-14T03:11:48Z,2023-03-14T03:11:48Z,"> If we were to use WATCH/UNWATCH support more widely in our other projects too, assuming that 99.9% of the time transactions will execute without any conflicts. Should we expect degraded performance, possibly because of a lock contention?

I think compared to the performance downgrade of WATCH, the downgrade of MULTI-EXEC may be more large. So if you already use some MULTI-EXEC pattern, the runtime cost to use WATCH may be less. 

You can try it in your case and share performance data with us if you like.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XdQVr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/317,https://api.github.com/repos/apache/kvrocks/issues/317,kvrocks,928227281,317,[NEW]  Allow forcing use the full sync when the lag was too large,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-06-23T12:55:52Z,2023-06-05T02:34:48Z,"### Background
Currently, we're using the WAL to do the partial sync like the Redis backlog, as well as the write buffer between worker threads and feed slave thread.  Users should tune the WAL size with the key-value size and it's hard in most cases, since the user key-value size may be varied over time. We prefer to give it a generic larger value to the WAL to fit into most cases, but every coin has two sides, it may slow down the partial sync when the key-value size was small and failed to trigger the full sync. 

### Proposal

The core problem was the generic WAL size may cause the partial sync too slowly when the key-value size was small, and it's hard to adjust the WAL size instance by instance since the size may be changed over time. So we need to find another way to work around this case, and the lag threshold should be a good choice since increment logs were synced by sequences. 

### TODO

- [ ] Add the `force-full-sync-lag-threshold` configuration to specify and enable the full sync lag threshold, default is 0 which means disabled
- [ ] Check the next seq, if it's a new slave and overrun the full sync lag threshold, let's use the full sync mechanism instead of the partial sync
- [ ] Add test cases

cool idea from @Alfejik 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/317/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/317,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2NzMxNTcwNw==,kvrocks,867315707,317,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2021-06-24T03:58:35Z,2021-06-24T03:58:35Z,"I don't think it's good idea to add this config ,in fact , what we need is repl-timeout,when timer exceed repl-timeout, close the conncetion and do nothing.fullsync may cause io issues 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2NzMxNTcwNw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/317,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2NzMzMDcwOQ==,kvrocks,867330709,317,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-06-24T04:46:42Z,2021-06-24T04:46:42Z,"@smartlee I have added more detailed information and high IO was expected in this scene. `repl-timeout` should be another issue, can u help to describe the context about when and why we need it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg2NzMzMDcwOQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/320,https://api.github.com/repos/apache/kvrocks/issues/320,kvrocks,932125686,320,[BUG] Support unwind for debian 4.9,xujianhai666,52450794,,,CLOSED,2021-06-29T01:40:01Z,2021-07-01T12:16:50Z,"**Describe the bug**
A clear and concise description of what the bug is.

 - OS: [e.g. Centos 7]
 - Version [e.g. 1.1.5]


**To Reproduce**
Steps to reproduce the behavior:
1. 
2.
3.

**Expected behavior**
A clear and concise description of what you expected to happen.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/320/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/322,kvrocks,936629064,322,any benchmark against redis?,hiqsociety,51492452,HIQ Society,,CLOSED,2021-07-05T02:52:04Z,2021-11-07T12:10:41Z,any benchmark against redis?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/322/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg3Mzc4NjE0OA==,kvrocks,873786148,322,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-07-05T05:00:08Z,2021-07-05T05:00:08Z,"It makes no sense to compare the Kvrocks with Redis directly since the storage and thread model was totally different. We have a simple performance benchmark on README: https://github.com/KvrocksLabs/kvrocks#performance, from the throughput side, the Kvrocks would be better than Redis in many commands.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg3Mzc4NjE0OA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg3NzA2MTQwNA==,kvrocks,877061404,322,NA,hiqsociety,51492452,HIQ Society,,NA,2021-07-09T09:48:04Z,2021-07-09T09:48:04Z,how much slower do u think kvrocks will be compared with redis?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg3NzA2MTQwNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg3NzA4NzMwNA==,kvrocks,877087304,322,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-07-09T10:33:02Z,2021-07-09T10:33:02Z,"It depends on the disk type, the latency of most commands on NVMe should be as good as Redis, SATA disks would much worse but we didn’t have any performance on it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg3NzA4NzMwNA==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40pIBx,kvrocks,883196017,322,NA,hengsok,3071383,weixing,,NA,2021-07-20T08:15:35Z,2021-07-20T08:15:35Z,"@hiqsociety I ran a simple test using redis-benchmark tool, I can say that kvrocks perform very well as below using DigitalOcean. Eventhough it persists data to disk, it can be almost as fast as Redis/KeyDB. I reckon if we give it more cpu cores and ram, it would perform even better. Very good job to kvrocks team @git-hulk @ShooterIT. We are awaiting their cluster mode feature and hope they can make their cluster mode to work like Redis whereby it can automatically handle failover and high availability!

Single Node - General Purpose / 16 GB / 4 vCPUs/ NVMe instance
kvrocks

PING_INLINE: 88339.23 requests per second
PING_BULK: 92678.41 requests per second
SET: 58513.75 requests per second
GET: 96525.09 requests per second
INCR: 50968.40 requests per second
LPUSH: 46728.97 requests per second
RPUSH: 46970.41 requests per second
LPOP: 43308.79 requests per second
RPOP: 42973.79 requests per second
SADD: 53390.28 requests per second
HSET: 39261.88 requests per second
SPOP: 63211.12 requests per second
LPUSH (needed to benchmark LRANGE): 45187.53 requests per second
LRANGE_100 (first 100 elements): 44742.73 requests per second
LRANGE_300 (first 300 elements): 21542.44 requests per second
LRANGE_500 (first 450 elements): 15434.48 requests per second
LRANGE_600 (first 600 elements): 12137.39 requests per second
MSET (10 keys): 16835.02 requests per second

I didn't get to save the results for above machine spec for KeyDB which is a forked of Redis but run on multithreads.


4C (Shared), 8GB, NVMe, 10 worker threads
kvrocks

PING_INLINE: 59630.29 requests per second
PING_BULK: 63131.31 requests per second
SET: 34352.46 requests per second
GET: 56785.91 requests per second
INCR: 30156.82 requests per second
LPUSH: 26652.45 requests per second
RPUSH: 24527.84 requests per second
LPOP: 24166.26 requests per second
RPOP: 23424.69 requests per second
SADD: 22644.93 requests per second
HSET: 21720.24 requests per second
SPOP: 55187.64 requests per second
LPUSH (needed to benchmark LRANGE): 24764.73 requests per second
LRANGE_100 (first 100 elements): 24218.94 requests per second
LRANGE_300 (first 300 elements): 11956.00 requests per second
LRANGE_500 (first 450 elements): 8792.75 requests per second
LRANGE_600 (first 600 elements): 6853.07 requests per second
MSET (10 keys): 10051.26 requests per second



4C (Shared), 8GB, NVMe, 10 worker threads
KeyDB (purely memory based)

PING_INLINE: 57971.02 requests per second
PING_BULK: 61236.99 requests per second
SET: 59066.75 requests per second
GET: 56689.34 requests per second
INCR: 50301.81 requests per second
LPUSH: 52631.58 requests per second
RPUSH: 60679.61 requests per second
LPOP: 49578.58 requests per second
RPOP: 54525.63 requests per second
SADD: 58616.65 requests per second
HSET: 54495.91 requests per second
SPOP: 54555.38 requests per second
LPUSH (needed to benchmark LRANGE): 51975.05 requests per second
LRANGE_100 (first 100 elements): 35587.19 requests per second
LRANGE_300 (first 300 elements): 17590.15 requests per second
LRANGE_500 (first 450 elements): 12269.94 requests per second
LRANGE_600 (first 600 elements): 9795.28 requests per second
MSET (10 keys): 54614.96 requests per second","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40pIBx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40pLO_,kvrocks,883209151,322,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-07-20T08:35:07Z,2021-07-20T08:35:07Z,"Many thanks for @hengsok benchmark data, those were benched without the `-r` option? which would use random keys instead of a single one. I think kvrocks would perform better with random keys since we have to lock the key when writing to prevent data race.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40pLO_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40puae,kvrocks,883353246,322,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-20T12:28:55Z,2021-07-20T12:28:55Z,"And you should enable multi threads in redis-benchmark, such as `--threads 8`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40puae/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40p6wg,kvrocks,883403808,322,NA,hengsok,3071383,weixing,,NA,2021-07-20T13:42:44Z,2021-07-20T13:42:44Z,"I have tried again following @git-hulk suggestions with the -r options using length of 8 and 16 for comparisons. I also experiment with changing the number of workers setting in the kvrocks.conf file.

I have noticed that during the SET test, below is the CPU and Memory stats from TOP. It seems kvrocks does not fully utilise the 32GB memory I provisioned. Strange. Is there any configuration to make sure kvrocks maximises memory usage?
CPU also only hover around 20-25% range.

I have tried your suggestions @ShooterIT but the current build of redis-benchmark no longer support --threads params.
 We got the error
Invalid option ""--threads"" or option argument missing

I believe by specifying the -c which is the number of clients, redis-benchmark is already parallelising the requests up to 500 clients as we have specified in the test.

General Purpose / 32 GB / 8 vCPUs / NVMe
%Cpu(s): 20.2 us, 21.1 sy,  0.0 ni, 54.5 id,  0.0 wa,  0.0 hi,  4.1 si,  0.0 st
MiB Mem :  32116.9 total,  26104.4 free,   1001.6 used,   5010.9 buff/cache
MiB Swap:      0.0 total,      0.0 free,      0.0 used.  30663.2 avail Mem

kvrocks (8 workers)
redis-benchmark -p 6666 -d 50 -c 500 -n 1000000  -r 16 -q
PING_INLINE: 75448.92 requests per second
PING_BULK: 78733.95 requests per second
SET: 62247.12 requests per second
GET: 81853.16 requests per second
INCR: 62664.49 requests per second
LPUSH: 48260.22 requests per second
RPUSH: 47114.25 requests per second
LPOP: 38842.49 requests per second
RPOP: 37030.18 requests per second
SADD: 49091.80 requests per second
HSET: 55285.27 requests per second
SPOP: 71525.64 requests per second
LPUSH (needed to benchmark LRANGE): 45203.87 requests per second
LRANGE_100 (first 100 elements): 41012.18 requests per second
LRANGE_300 (first 300 elements): 16218.23 requests per second
LRANGE_500 (first 450 elements): 12822.49 requests per second
LRANGE_600 (first 600 elements): 8941.90 requests per second
MSET (10 keys): 9546.72 requests per second


General Purpose / 32 GB / 8 vCPUs / NVMe
kvrocks (16 workers)
redis-benchmark -p 6666 -d 50 -c 500 -n 1000000  -r 16 -q
PING_INLINE: 77845.24 requests per second
PING_BULK: 80121.79 requests per second
SET: 59333.09 requests per second
GET: 74693.76 requests per second
INCR: 58661.34 requests per second
LPUSH: 45543.56 requests per second
RPUSH: 44507.74 requests per second
LPOP: 36072.43 requests per second
RPOP: 37378.98 requests per second
SADD: 48887.80 requests per second
HSET: 58654.47 requests per second
SPOP: 74521.20 requests per second
LPUSH (needed to benchmark LRANGE): 44004.40 requests per second
LRANGE_100 (first 100 elements): 39089.98 requests per second
LRANGE_300 (first 300 elements): 15401.44 requests per second
LRANGE_500 (first 450 elements): 12331.67 requests per second
LRANGE_600 (first 600 elements): 8924.75 requests per second
MSET (10 keys): 9741.18 requests per second


General Purpose / 32 GB / 8 vCPUs / NVMe
kvrocks (8 workers)
redis-benchmark -p 6666 -d 50 -c 500 -n 1000000  -r 8 -q
PING_INLINE: 79936.05 requests per second
PING_BULK: 79182.84 requests per second
SET: 62065.54 requests per second
GET: 73844.34 requests per second
INCR: 61087.35 requests per second
LPUSH: 43230.16 requests per second
RPUSH: 45491.77 requests per second
LPOP: 36296.32 requests per second
RPOP: 37767.20 requests per second
SADD: 48236.94 requests per second
HSET: 58775.12 requests per second
SPOP: 69189.79 requests per second
LPUSH (needed to benchmark LRANGE): 44255.62 requests per second
LRANGE_100 (first 100 elements): 38172.31 requests per second
LRANGE_300 (first 300 elements): 15107.57 requests per second
LRANGE_500 (first 450 elements): 12413.26 requests per second
LRANGE_600 (first 600 elements): 8837.20 requests per second
MSET (10 keys): 9850.18 requests per second


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40p6wg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40p-9S,kvrocks,883421010,322,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-20T14:04:31Z,2021-07-20T14:04:31Z,"hi @hengsok To use `--threads` in benchmark, you should use latest `redis-benchmark`, unstable branch of redis https://github.com/redis/redis. And `-r` is specified range, you should use a bigger number.
such as `redis-benchmark -p 6666 -d 50 -c 500 -n 1000000 -r 10000000 -q --threads 8`
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40p-9S/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40sOjB,kvrocks,884009153,322,NA,hengsok,3071383,weixing,,NA,2021-07-21T08:46:11Z,2021-07-21T08:46:11Z,"@ShooterIT Yes, I agree that the clients request did not max out. Just as a quick workaround, we tried to open 5 terminals and run redis-benchmark and we were getting more than 200K+ rps for GET and more than 101.5K+ rps for SET by adding the stats up. It's an impressive numbers for just 8 vCPUs. 

Do you know why RAM utilisation is so low? We noticed during the running of the benchmark, RAM usage only reach as much as 4GB. Shouldn't kvrocks cache more in Memory or it mainly relies on reading and writing directly with Rocksdb without further memory caching optimization?

Finally, we really love this project a lot but there is a lack of documentations for how to setup kvrocks as Cluster. 

I have read about PIKA + Codis, does kvrocks support Codis cluster? Thanks!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40sOjB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40sVMa,kvrocks,884036378,322,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-21T09:24:22Z,2021-07-21T09:24:22Z,"For memory usage, please see https://github.com/KvrocksLabs/kvrocks/blob/unstable/kvrocks.conf#L324

Currently, cluster solution is experimental, we are developing a meta server to manage cluster, coming soon, if you want to have a try, please https://github.com/KvrocksLabs/kvrocks/pull/302

Kvrocks support Codis cluster, but doesn't  support to scale i.e. can't migrate slot date.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40sVMa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40uoWT,kvrocks,884639123,322,NA,hengsok,3071383,weixing,,NA,2021-07-22T03:50:55Z,2021-07-22T03:50:55Z,"@ShooterIT thanks for the tips. 

Can't wait for your full cluster solution. I have tried the try_cluster. Does your implementation support dynamic addition of more nodes? If it supports, then how do we reassign slots? It seems your current implementation is still very manual based and I am not sure how the nodes are gonna handle moving of data from one node to the next to rebalance upon adding more nodes","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40uoWT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/322,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40xmoj,kvrocks,885418531,322,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-23T05:59:41Z,2021-07-23T05:59:41Z,Coming soon!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40xmoj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/325,https://api.github.com/repos/apache/kvrocks/issues/325,kvrocks,940605315,325,possible to implement redisearch?,hiqsociety,51492452,HIQ Society,,CLOSED,2021-07-09T09:49:15Z,2022-09-11T03:29:40Z,"do you have the implementation guideline on how to implement redisearch?
written like this?
https://kvrocks.medium.com/design-complex-structure-on-rocksdb-993a00fd4f6d?source=post_internal_links---------0----------------------------","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/325/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/325,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg3NzA3MTMxNQ==,kvrocks,877071315,325,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-09T10:05:26Z,2021-07-09T10:05:26Z,"currently, we are thinking how to support redis module, but now, we don't have conclusion, we would like to listen your ideas if you have","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg3NzA3MTMxNQ==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/325,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM3Z,kvrocks,1242877401,325,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:29:40Z,2022-09-11T03:29:40Z,Closed as inactive. We don't keep a wishing list. Any design is welcome.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM3Z/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/329,https://api.github.com/repos/apache/kvrocks/issues/329,kvrocks,945096591,329,[QUESTION] Migrating from 2.0 to 2.0.2,adulau,3309,Alexandre Dulaunoy,a@foo.be,CLOSED,2021-07-15T07:43:48Z,2021-07-16T05:22:48Z,"A small question, is migrating from 2.0 to 2.0.2 safe concerning the RocksDB storage? Can we safely assume that the binary format is compatible between the two version.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/329/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/329,https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg4MDUwMjE4Nw==,kvrocks,880502187,329,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-15T08:26:49Z,2021-07-15T08:26:49Z,"Thanks for your attention, we are going to release 2.0.2. Exactly, it is compatible, you can upgrade old version whatever by restarting using new binary or master-replicas replication.

But if you use cluster mode, that will make data incompatible.  Because in cluster mode, to be efficient to migrate keys based on slot when scale, we encode key with slot id, but to be compatible with the old version, we don't do that in standalone mode. So data is not compatible between standalone mode with cluster mode, you must migrate data if you want to change mode, otherwise, kvrocks will make data corrupt.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/MDEyOklzc3VlQ29tbWVudDg4MDUwMjE4Nw==/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/329,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40hSfx,kvrocks,881141745,329,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-16T03:03:58Z,2021-07-16T03:03:58Z,"I update my comments, please have a look, please tell me if you still have questions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40hSfx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/329,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40hdPe,kvrocks,881185758,329,NA,adulau,3309,Alexandre Dulaunoy,a@foo.be,NA,2021-07-16T05:22:48Z,2021-07-16T05:22:48Z,Thank you very much for the feedback. We don't use cluster-mode so it seems we are fine.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40hdPe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/332,https://api.github.com/repos/apache/kvrocks/issues/332,kvrocks,946853089,332,Why is kvrocks so slow?,hiqsociety,51492452,HIQ Society,,CLOSED,2021-07-17T16:14:19Z,2022-06-28T10:23:41Z,"I've run kvrocks benchmark against redis

R 160k, w 55k/s 

Redis
R 1.2mil, w 1mil/s","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/332/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/332,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40ktHJ,kvrocks,882037193,332,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-07-18T10:50:51Z,2021-07-18T10:50:51Z,"Can u offer more information about the CPU(how many cores), Memory/Disk Type(HDD/SSD/NVMe...), as well as the benchmark command. BTW, seems you benched with the pipeline mode? It makes no sense that Redis performance up to the millilion QPS in single request mode.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40ktHJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/332,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40yKJN,kvrocks,885563981,332,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-07-23T11:05:12Z,2021-07-23T11:05:12Z,dup with #322,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40yKJN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/339,https://api.github.com/repos/apache/kvrocks/issues/339,kvrocks,951419728,339,How I stop the server?,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,CLOSED,2021-07-23T09:42:21Z,2022-06-28T10:24:14Z,"**Describe the bug**
A clear and concise description of what the bug is.

 - OS: [e.g. Centos 7]
 - Version [e.g. 1.1.5]


**To Reproduce**
Steps to reproduce the behavior:
1. 
2.
3.

**Expected behavior**
A clear and concise description of what you expected to happen.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/339/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/339,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40yJQ_,kvrocks,885560383,339,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-07-23T10:57:38Z,2021-07-23T10:57:38Z,"Do you mean how to shut down the kvrocks? If yes, use redis-cli to send the shutdown command.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40yJQ_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/339,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40zvMM,kvrocks,885977868,339,NA,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,NA,2021-07-24T00:55:51Z,2021-07-24T00:55:51Z,thank you,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40zvMM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/341,https://api.github.com/repos/apache/kvrocks/issues/341,kvrocks,952019709,341,有时候从服务器无法进行同步,haodiao,12348040,,,CLOSED,2021-07-24T07:25:00Z,2021-07-25T14:18:54Z,"我的主服务器在国内，从服务器在国外，  
从服务器每隔几天就不再进行同步了，只能进行重起才能恢复正常，  
    
主从服务器之间的网络可能不是非常稳定，导致从服务器的同步功能卡住，希望可以解决这个问题    ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/341/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/341,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40z4GU,kvrocks,886014356,341,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-24T07:33:04Z,2021-07-24T07:33:04Z,"What version are you using? Maybe this PR #284 fixed this problem, the latest version 2.0.2 that has this patch is released.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40z4GU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/341,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40z899,kvrocks,886034301,341,NA,haodiao,12348040,,,NA,2021-07-24T10:39:55Z,2021-07-24T10:39:55Z,"@ShooterIT 就是最新的 2.0.2 出现同样的问题，这个版本发布的当天我就重新进行编译，     
到现在不到一周的时间，出现过3台从服务器同步中断的现象（必须重启才能恢复），    
我的环境是 1主8从（1主在国内，8台从在国外）","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM40z899/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/341,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM400DuY,kvrocks,886061976,341,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-24T14:35:00Z,2021-07-24T14:35:00Z,@haodiao 能提供一下相应时间点主从的日志吗？,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM400DuY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/341,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM400a2B,kvrocks,886156673,341,NA,haodiao,12348040,,,NA,2021-07-25T06:56:56Z,2021-07-25T06:56:56Z,"@ShooterIT 
从服务器的日志：  
`E0721 19:44:41.368650 16702 replication.cc:133] [replication] connection error/eof, reconnect the master
E0721 19:44:45.402782 16702 replication.cc:211] [replication] Failed to connect the master, err:Connection timed out`

主服务器的日志（IP部分""*""代替）：    
`E0721 19:56:14.416370 14828 replication.cc:60] Ping slave[103.129.*.*:55912] err: Connection timed out, would stop the thread 
W0721 19:56:14.416435 14828 replication.cc:48] Slave thread was terminated, would stop feeding the slave: 103.129.*.*:55912`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM400a2B/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/341,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM400ic6,kvrocks,886187834,341,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-07-25T11:29:52Z,2021-07-25T11:29:52Z,这个主要是因为从库在断掉之后，目前重连机制有问题导致没有重连,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM400ic6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/342,https://api.github.com/repos/apache/kvrocks/issues/342,kvrocks,952039648,342,Upgrade the version of cpplint from 1.5.0 to 1.5.5.,LykxSassinator,18441614,lucasliang,nkcs_lykx@hotmail.com,CLOSED,2021-07-24T09:33:40Z,2022-10-23T03:48:32Z,"Here, i've found a misleading cpplint errors generated by `cpplint.sh` in the progress of CI. And i've made sure that i've format the code by the Google code-style standard, with the necessary double-check by `cpplint` tool. However, the CI cpplint checking showed that there still exists some style errors in the code. So, i tried to check the difference of cpplint-1.5.0, defaultly used in the CI of kvrocks, between the version 1.5.5.
And the difference showed as bellow:
![image](https://user-images.githubusercontent.com/18441614/126864134-9e6c0bbb-8f34-4642-b735-70b7dd4ba846.png)

Finally, i've checked the `releasing logs` of `cpplint`, and found the following results:
![image](https://user-images.githubusercontent.com/18441614/126864169-782b0219-e104-4db2-8b06-7b6422cdd842.png)


***So, could we upgrade the version of `cpplint` in the CI of kvrocks to `1.5.5` ?***

 I‘ve verified the upgrade was valid in my local repository CI checking progress.
![image](https://user-images.githubusercontent.com/18441614/126864374-b349a959-96f9-4b41-a0da-bb9594026240.png)
![image](https://user-images.githubusercontent.com/18441614/126864393-3cc73ba3-92d3-4f65-8cfd-014055d2cf86.png)

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/342/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/342,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxUP7,kvrocks,1287996411,342,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-23T03:48:31Z,2022-10-23T03:48:31Z,"cpplint is replaced with clang-format and clang-tidy in #800.

Closed as invalid.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxUP7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/345,https://api.github.com/repos/apache/kvrocks/issues/345,kvrocks,953496221,345,how to use namespace via redis protocal?,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,CLOSED,2021-07-27T04:41:56Z,2021-07-27T04:55:37Z,"Please keep in mind that this issue tracker should be used for reporting bugs or proposing improvements to the kvrocks server.

Generally, questions about using kvrocks should be directed to the [community](https://groups.google.com/g/kvrocks).

It is also possible that your question was already asked here, so please do a quick issues search before submitting.

That said, please feel free to replace all this with your question :)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/345/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/346,https://api.github.com/repos/apache/kvrocks/issues/346,kvrocks,955659291,346,Data inconsistency in master-slave replication on certain situation,ChrisZMF,18628342,,,CLOSED,2021-07-29T09:45:41Z,2021-07-31T09:05:54Z,"**Describe the bug**
If we run kvrocks in master-slave structure, the data consistency may not be guaranteed on certain situation. Consider this situation, after all master data have been replicate to slave, we write a new key which will increase the sequence of rocksdb more than 20, then if we stop writing, this new key will not be copied to slave. The key will not be sent，util new data with sequence increment less than 20 or the length of master-slave replication queue exceeds 20. This situation will cause data inconsistency.


 - OS: Linux 3.10.0_3-0-0-36 x86_64
 - Version: all


**To Reproduce**
Steps to reproduce the behavior:
1. Start two kvrocks servers and establish master-slave replication relationship.
2. After replication, write a hash key with more than 20 f-v pairs, like `hmset hkey f1 v1 f2 v2 ....... f21 v21`, then stop writing.
3. Check replication info on master and slave, then the following result will be gotten:
![image](https://user-images.githubusercontent.com/18628342/127461982-e6418f33-baa4-4c3f-bd7f-8d20764c1f13.png)
In above picture, master info is on left side, slave is on right side. We can get that `offset=69,lag=0` on master and `slave_repl_offset:47` on slave. `offset` represents the slave's sequence recorded on master which is 69, and `lag=0` represents there is no lag between master and slave. In other words, from the perspective of master, slave and master are synchronized. But, on slave‘s perspective, `slave_repl_offset` is 47 which means slave lags behind master, it is not synchronized with master.
4. Check keys on both master and slave, we will get this:
![image](https://user-images.githubusercontent.com/18628342/127462307-d7457526-b605-49ba-a8e1-7f79cc25f150.png)
Also, left side is mater and right side is slave in above picture. We can see that the new key `hkey` is not copied to slave.


**Expected behavior**
On slave, `slave_repl_offset` should be 69 too, and key `hkey` should exist.


**Reason analysis**
In `FeedSlaveThread::loop()`, `if (... || latest_seq - batch.sequence <= 20 || batch_list.size() >= 20) ` is adopted to improve data transmission efficiency in incremental replication phase. But, after all data being synchronized, ` latest_seq - batch.sequence <= 20` will cause the bug described above



","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/346/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/346,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM41Bbmh,kvrocks,889567649,346,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-07-30T01:44:35Z,2021-07-30T01:44:35Z,"let me fix that, and i want to lightly refactor other somethings","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM41Bbmh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/353,https://api.github.com/repos/apache/kvrocks/issues/353,kvrocks,974232431,353,namespace 有没有分空间存储？为什么重启后namespace都丢失了？,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,CLOSED,2021-08-19T03:35:24Z,2021-08-26T02:36:00Z,"Please keep in mind that this issue tracker should be used for reporting bugs or proposing improvements to the kvrocks server.

Generally, questions about using kvrocks should be directed to the [community](https://groups.google.com/g/kvrocks).

It is also possible that your question was already asked here, so please do a quick issues search before submitting.

That said, please feel free to replace all this with your question :)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/353/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/353,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM41vRtE,kvrocks,901585732,353,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-08-19T03:44:15Z,2021-08-19T03:44:15Z,"这是设计文档 https://github.com/KvrocksLabs/kvrocks/blob/unstable/docs/multi-tenant.CN.md
namespace会作为key的前缀存储，应该不会丢失，有没有复现的步骤","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM41vRtE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/353,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM41vShf,kvrocks,901589087,353,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-08-19T03:55:41Z,2021-08-19T03:55:41Z,"@ShooterIT @ZonghaoWang 我在想是不是 config add $ns $token, 然后没有执行 config rewrite。如果记得 $ns 直接再增加就可以了，数据不会丢失。","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM41vShf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/353,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM419zBo,kvrocks,905392232,353,NA,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,NA,2021-08-25T10:52:26Z,2021-08-25T10:52:26Z,"> @ShooterIT @ZonghaoWang 我在想是不是 config add $ns $token, 然后没有执行 config rewrite。如果记得 $ns 直接再增加就可以了，数据不会丢失。

没有执行config rewrite, 我执行后再试试","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM419zBo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/353,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM42AOs2,kvrocks,906029878,353,NA,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,NA,2021-08-26T02:36:00Z,2021-08-26T02:36:00Z,问题解决了,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM42AOs2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/354,https://api.github.com/repos/apache/kvrocks/issues/354,kvrocks,976619102,354,[QUESTION] What's the recommended filesystem for kvrocks? ,adulau,3309,Alexandre Dulaunoy,a@foo.be,CLOSED,2021-08-23T04:37:39Z,2021-10-24T06:20:41Z,"We are using kvrocks in production using ext4 filesystem and having around 4000 SST files.  We were wondering if XFS would be better for performance. Did you do some specific tests with the different filesystems?  Thank you very much.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/354/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/354,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM412kV6,kvrocks,903497082,354,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-08-23T07:01:59Z,2021-08-23T07:01:59Z,"Thanks, I also thought this question, but i did not test😜, currently we also use ext4 filesystem, XFS has better performance in some scenes, it truly worths to test, @git-hulk did you ever test for different filesystem?
And kvrocks is based on rocksdb, maybe this is a generic questions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM412kV6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/354,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM412lGU,kvrocks,903500180,354,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-08-23T07:05:57Z,2021-08-23T07:05:57Z,"No actually, we also used ext4.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM412lGU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/354,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM42FMgK,kvrocks,907331594,354,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2021-08-27T16:39:37Z,2021-08-27T16:39:37Z,"Our file system is xfs in production,kvrocks run in docker, and os is centos7 ,kernel version is 4.19.118","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM42FMgK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/355,https://api.github.com/repos/apache/kvrocks/issues/355,kvrocks,977833932,355,[QUESTION] Clarification on Redis version support,stopforumspam,44541549,,,CLOSED,2021-08-24T08:15:58Z,2022-07-30T05:03:05Z,"I love kvrocks but it would be useful if there was a version vs Redis version support.  Whilst supported commands are listed, their Redis version isnt.

E.g. LPOP in Redis 6.2 supports a [count] parameter, allowing for multiple records to be returned whilst kvrocks returns just a single record.

I love would LPOP (etc) and all commands to be in line with Redis release but realise that this isn't going to be the case but it would be great if kvrocks published which Redis version each command is compatible with","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/355/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM416d4c,kvrocks,904519196,355,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-08-24T10:26:21Z,2021-08-24T10:26:21Z,"Thanks, we should describe that in documents, currently most commands are compatible with Redis 4.0. It is hard to support all command of Redis latest release, we will implement more commands gradually.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM416d4c/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/358,https://api.github.com/repos/apache/kvrocks/issues/358,kvrocks,989529073,358,kvrocks running on kubernetes,linydquantil,37830766,,,CLOSED,2021-09-07T02:10:34Z,2021-09-07T03:29:27Z,"Have you tried to run to K8s?
Is there any experience to share?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/358/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/358,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM42efn_,kvrocks,913963519,358,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-09-07T03:29:09Z,2021-09-07T03:29:09Z,"@smartlee Ctrip's kvrocks instances were running on the Kubernetes, maybe we can transfer this issue to the discussion.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM42efn_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/364,https://api.github.com/repos/apache/kvrocks/issues/364,kvrocks,997911129,364,[QUESTION] Where is the data in docker container,orctom,128631,ORCTOM,,CLOSED,2021-09-16T08:07:12Z,2021-09-16T09:38:22Z,"I see no VOLUME section in Dockerfile, no files in /data folder in container.
So where does the data been persisted?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/364/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/364,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM424Q5m,kvrocks,920718950,364,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-09-16T08:58:52Z,2021-09-16T08:58:52Z,"The data was stored in dir `/tmp/kvrocks`, the docker was only intended for tests so didn't export the volume and data-dir.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM424Q5m/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/364,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM424Xn0,kvrocks,920746484,364,NA,orctom,128631,ORCTOM,,NA,2021-09-16T09:38:22Z,2021-09-16T09:38:22Z,"Thanks dude.
Looking forward to a production ready docker image, easier to roll out to cloud.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM424Xn0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/366,https://api.github.com/repos/apache/kvrocks/issues/366,kvrocks,1015872755,366,"Does kvrocks support ROCKSDB's native KEY/VALUE separation, BLOB STORE?",hangzhouminghe88,85660816,杭州明和科技股份有限公司,,CLOSED,2021-10-05T04:28:27Z,2021-11-21T02:32:57Z,The KVROCKS I use has 100 billion records ， VALUE IS 4KB BYTES ， Reading speed ( GET )  is very slow,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/366/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/366,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43rrcc,kvrocks,934197020,366,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-10-05T08:43:35Z,2021-10-05T08:43:35Z,"Not use blob store now but would support it after the blob store was production-ready. 

> The KVROCKS I use has 100 billion records ， VALUE IS 4KB BYTES ， Reading speed ( GET ) is very slow

Can u show the configuration, the default metadata/subkey column family cache(2 GiB) should be too small for 100 billion records, you can have a try to increase the metadata column family: https://github.com/KvrocksLabs/kvrocks/blob/unstable/kvrocks.conf#L324 and enable the shared cache between metadata and subkey with `rocksdb.share_metadata_and_subkey_block_cache` = `yes`
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43rrcc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/366,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43yTFf,kvrocks,935932255,366,NA,hangzhouminghe88,85660816,杭州明和科技股份有限公司,,NA,2021-10-06T10:32:02Z,2021-10-06T10:32:02Z,"```
################################ GENERAL #####################################

# By default kvrocks listens for connections from all the network interfaces
# available on the server. It is possible to listen to just one or multiple
# interfaces using the ""bind"" configuration directive, followed by one or
# more IP addresses.
#
# Examples:
#
# bind 192.168.1.100 10.0.0.1
# bind 127.0.0.1
#bind 0.0.0.0
bind 10.10.i0.237

# Accept connections on the specified port, default is 6666.
port 6379

# Close the connection after a client is idle for N seconds (0 to disable)
timeout 0

# The number of worker's threads, increase or decrease it would effect the performance.
workers 16

# The number of replication worker's threads, increase or decrease it would effect the replication performance.
# Default: 1
repl-workers 1

# By default kvrocks does not run as a daemon. Use 'yes' if you need it.
# Note that kvrocks will write a pid file in /var/run/kvrocks.pid when daemonized.
daemonize no

# Set the max number of connected clients at the same time. By default
# this limit is set to 10000 clients, however if the server is not
# able to configure the process file limit to allow for the specified limit
# the max number of allowed clients is set to the current file limit
#
# Once the limit is reached the server will close all the new connections sending
# an error 'max number of clients reached'.
#
maxclients 10000

# Require clients to issue AUTH <PASSWORD> before processing any other
# commands.  This might be useful in environments in which you do not trust
# others with access to the host running kvrocks.
#
# This should stay commented out for backward compatibility and because most
# people do not need auth (e.g. they run their own servers).
#
# Warning: since kvrocks is pretty fast an outside user can try up to
# 150k passwords per second against a good box. This means that you should
# use a very strong password otherwise it will be very easy to break.
#
# requirepass foobared

# If the master is password protected (using the ""masterauth"" configuration
# directive below) it is possible to tell the slave to authenticate before
# starting the replication synchronization process, otherwise the master will
# refuse the slave request.
#
# masterauth foobared

# Master-Salve replication would check db name is matched. if not, the slave should
# refuse to sync the db from master. Don't use default value, set the db-name to identify
# the cluster.
db-name change.me.db

# The working directory
#
# The DB will be written inside this directory
# Note that you must specify a directory here, not a file name.
dir /kvrocks

# The logs of server will be stored in this directory. If you don't specify
# one directory, by default, we store logs in the working directory that set
# by 'dir' above.
log-dir /kvrocks

# When running daemonized, kvrocks writes a pid file in ${CONFIG_DIR}/kvrocks.pid by
# default. You can specify a custom pid file location here.
# pidfile /var/run/kvrocks.pid
pidfile /kvrocks/kvrocks.pid

# You can configure a slave instance to accept writes or not. Writing against
# a slave instance may be useful to store some ephemeral data (because data
# written on a slave will be easily deleted after resync with the master) but
# may also cause problems if clients are writing to it because of a
# misconfiguration.
slave-read-only yes

# The slave priority is an integer number published by Kvrocks in the INFO output.
# It is used by Redis Sentinel in order to select a slave to promote into a
# master if the master is no longer working correctly.
#
# A slave with a low priority number is considered better for promotion, so
# for instance if there are three slave with priority 10, 100, 25 Sentinel will
# pick the one with priority 10, that is the lowest.
#
# However a special priority of 0 marks the replica as not able to perform the
# role of master, so a slave with priority of 0 will never be selected by
# Redis Sentinel for promotion.
#
# By default the priority is 100.
slave-priority 100

# TCP listen() backlog.
#
# In high requests-per-second environments you need an high backlog in order
# to avoid slow clients connections issues. Note that the Linux kernel
# will silently truncate it to the value of /proc/sys/net/core/somaxconn so
# make sure to raise both the value of somaxconn and tcp_max_syn_backlog
# in order to Get the desired effect.
tcp-backlog 511

# If the master is an old version, it may have specified replication threads
# that use 'port + 1' as listening port, but in new versions, we don't use
# extra port to implement replication. In order to allow the new replicas to
# copy old masters, you should indicate that the master uses replication port
# or not.
# If yes, that indicates master uses replication port and replicas will connect
# to 'master's listening port + 1' when synchronization.
# If no, that indicates master doesn't use replication port and replicas will
# connect 'master's listening port' when synchronization.
master-use-repl-port no

# Master-Slave replication. Use slaveof to make a kvrocks instance a copy of
# another kvrocks server. A few things to understand ASAP about kvrocks replication.
#
# 1) Kvrocks replication is asynchronous, but you can configure a master to
#    stop accepting writes if it appears to be not connected with at least
#    a given number of slaves.
# 2) Kvrocks slaves are able to perform a partial resynchronization with the
#    master if the replication link is lost for a relatively small amount of
#    time. You may want to configure the replication backlog size (see the next
#    sections of this file) with a sensible value depending on your needs.
# 3) Replication is automatic and does not need user intervention. After a
#    network partition slaves automatically try to reconnect to masters
#    and resynchronize with them.
#
# slaveof <masterip> <masterport>
# slaveof 127.0.0.1 6379

# When a slave loses its connection with the master, or when the replication
# is still in progress, the slave can act in two different ways:
#
# 1) if slave-serve-stale-data is set to 'yes' (the default) the slave will
#    still reply to client requests, possibly with out of date data, or the
#    data set may just be empty if this is the first synchronization.
#
# 2) if slave-serve-stale-data is set to 'no' the slave will reply with
#    an error ""SYNC with master in progress"" to all the kind of commands
#    but to INFO and SLAVEOF.
#
slave-serve-stale-data yes

# To guarantee slave's data safe and serve when it is in full synchronization
# state, slave still keep itself data. But this way needs to occupy much disk
# space, so we provide a way to reduce disk occupation, slave will delete itself
# entire database before fetching files from master during full synchronization.
# If you want to enable this way, you can set 'slave-delete-db-before-fullsync'
# to yes, but you must know that database will be lost if master is down during
# full synchronization, unless you have a backup of database.
#
# This option is similar redis replicas RDB diskless load option:
#       repl-diskless-load on-empty-db
#
# Default: no
slave-empty-db-before-fullsync no

# If replicas need full synchronization with master, master need to create
# checkpoint for feeding replicas, and replicas also stage a checkpoint of
# the master. If we also keep the backup, it maybe occupy extra disk space.
# You can enable 'purge-backup-on-fullsync' if disk is not sufficient, but
# that may cause remote backup copy failing.
#
# Default: no
purge-backup-on-fullsync no

# The maximum allowed rate (in MB/s) that should be used by Replication.
# If the rate exceeds max-replication-mb, replication will slow down.
# Default: 0 (i.e. no limit)
max-replication-mb 0

# The maximum allowed aggregated write rate of flush and compaction (in MB/s).
# If the rate exceeds max-io-mb, io will slow down.
# 0 is no limit
# Default: 500
max-io-mb 500

# The maximum allowed space (in GB) that should be used by RocksDB.
# If the total size of the SST files exceeds max_allowed_space, writes to RocksDB will fail.
# Please see: https://github.com/facebook/rocksdb/wiki/Managing-Disk-Space-Utilization
# Default: 0 (i.e. no limit)
max-db-size 0

# The maximum backup to keep, server cron would run every minutes to check the num of current
# backup, and purge the old backup if exceed the max backup num to keep. If max-backup-to-keep
# is 0, no backup would be keep. But now, we only support 0 or 1.
max-backup-to-keep 1

# The maximum hours to keep the backup. If max-backup-keep-hours is 0, wouldn't purge any backup.
# default: 1 day
max-backup-keep-hours 24

# Ratio of the samples would be recorded when the profiling was enabled. 
# we simply use the rand to determine whether to record the sample or not.
# 
# Default: 0
profiling-sample-ratio 0

# There is no limit to this length. Just be aware that it will consume memory.
# You can reclaim memory used by the perf log with PERFLOG RESET.
#
# Default: 256
profiling-sample-record-max-len 256

# profiling-sample-record-threshold-ms use to tell the kvrocks when to record.
#
# Default: 100 millisecond
profiling-sample-record-threshold-ms 100

################################## SLOW LOG ###################################

# The Kvrocks Slow Log is a system to log queries that exceeded a specified
# execution time. The execution time does not include the I/O operations
# like talking with the client, sending the reply and so forth,
# but just the time needed to actually execute the command (this is the only
# stage of command execution where the thread is blocked and can not serve
# other requests in the meantime).
#
# You can configure the slow log with two parameters: one tells Kvrocks
# what is the execution time, in microseconds, to exceed in order for the
# command to get logged, and the other parameter is the length of the
# slow log. When a new command is logged the oldest one is removed from the
# queue of logged commands.

# The following time is expressed in microseconds, so 1000000 is equivalent
# to one second. Note that -1 value disables the slow log, while
# a value of zero forces the logging of every command.
slowlog-log-slower-than 100000

# There is no limit to this length. Just be aware that it will consume memory.
# You can reclaim memory used by the slow log with SLOWLOG RESET.
slowlog-max-len 128

# If you run kvrocks from upstart or systemd, kvrocks can interact with your
# supervision tree. Options:
#   supervised no      - no supervision interaction
#   supervised upstart - signal upstart by putting kvrocks into SIGSTOP mode
#   supervised systemd - signal systemd by writing READY=1 to $NOTIFY_SOCKET
#   supervised auto    - detect upstart or systemd method based on
#                        UPSTART_JOB or NOTIFY_SOCKET environment variables
# Note: these supervision methods only signal ""process is ready.""
#       They do not enable continuous liveness pings back to your supervisor.
supervised no

################################## CRON ###################################

# Compact Scheduler, auto compact at schedule time
# time expression format is the same as crontab(currently only support * and int)
# e.g. compact-cron 0 3 * * * 0 4 * * *
# would compact the db at 3am and 4am everyday
# compact-cron 0 3 * * *

# The hour range that compaction checker would be active
# e.g. compaction-checker-range 0-7 means compaction checker would be worker between
# 0-7am every day.
compaction-checker-range 0-7

# Bgsave scheduler, auto bgsave at schedule time
# time expression format is the same as crontab(currently only support * and int)
# e.g. bgsave-cron 0 3 * * * 0 4 * * *
# would bgsave the db at 3am and 4am everyday

################################ ROCKSDB #####################################

# Specify the capacity  of metadata column family block cache. Larger block cache
# may make request faster while more keys would be cached. Max Size is 200*1024.
# Default: 2048MB
rocksdb.metadata_block_cache_size 2048

# Specify the capacity  of subkey column family block cache. Larger block cache
# may make request faster while more keys would be cached. Max Size is 200*1024.
# Default: 2048MB
rocksdb.subkey_block_cache_size 2048

# Number of open files that can be used by the DB.  You may need to
# increase this if your database has a large working set. Value -1 means
# files opened are always kept open. You can estimate number of files based
# on target_file_size_base and target_file_size_multiplier for level-based
# compaction. For universal-style compaction, you can usually set it to -1.
# Default: 4096
rocksdb.max_open_files 8096

# Amount of data to build up in memory (backed by an unsorted log
# on disk) before converting to a sorted on-disk file.
#
# Larger values increase performance, especially during bulk loads.
# Up to max_write_buffer_number write buffers may be held in memory
# at the same time,
# so you may wish to adjust this parameter to control memory usage.
# Also, a larger write buffer will result in a longer recovery time
# the next time the database is opened.
#
# Note that write_buffer_size is enforced per column family.
# See db_write_buffer_size for sharing memory across column families.

# default is 64MB
rocksdb.write_buffer_size 128

# Target file size for compaction, target file size for Leve N can be caculated
# by target_file_size_base * (target_file_size_multiplier ^ (L-1))
#
# Default: 128MB
rocksdb.target_file_size_base 128

# The maximum number of write buffers that are built up in memory.
# The default and the minimum number is 2, so that when 1 write buffer
# is being flushed to storage, new writes can continue to the other
# write buffer.
# If max_write_buffer_number > 3, writing will be slowed down to
# options.delayed_write_rate if we are writing to the last write buffer
# allowed.
rocksdb.max_write_buffer_number 4

# Maximum number of concurrent background compaction jobs, submitted to
# the default LOW priority thread pool.
rocksdb.max_background_compactions 4

# Maximum number of concurrent background memtable flush jobs, submitted by
# default to the HIGH priority thread pool. If the HIGH priority thread pool
# is configured to have zero threads, flush jobs will share the LOW priority
# thread pool with compaction jobs.
rocksdb.max_background_flushes 4

# This value represents the maximum number of threads that will
# concurrently perform a compaction job by breaking it into multiple,
# smaller ones that are run simultaneously.
# Default: 2 (i.e. no subcompactions)
rocksdb.max_sub_compactions 2

# We impl the repliction with rocksdb WAL, it would trigger full sync when the seq was out of range.
# wal_ttl_seconds and wal_size_limit_mb would affect how archived logswill be deleted.
# If WAL_ttl_seconds is not 0, then WAL files will be checked every WAL_ttl_seconds / 2 and those that
# are older than WAL_ttl_seconds will be deleted#
#
# Default: 3 Hours
rocksdb.wal_ttl_seconds 10800

# In order to limit the size of WALs, RocksDB uses DBOptions::max_total_wal_size
# as the trigger of column family flush. Once WALs exceed this size, RocksDB
# will start forcing the flush of column families to allow deletion of some
# oldest WALs. This config can be useful when column families are updated at
# non-uniform frequencies. If there's no size limit, users may need to keep
# really old WALs when the infrequently-updated column families hasn't flushed
# for a while.
#
# In kvrocks, we use multiple column families to store metadata, subkeys, etc.
# If users always use string type, but use list, hash and other complex data types
# infrequently, there will be a lot of old WALs if we don't set size limit
# (0 by default in rocksdb), because rocksdb will dynamically choose the WAL size
# limit to be [sum of all write_buffer_size * max_write_buffer_number] * 4 if set to 0.
#
# Moreover, you should increase this value if you already set rocksdb.write_buffer_size
# to a big value, to avoid influencing the effect of rocksdb.write_buffer_size and
# rocksdb.max_write_buffer_number.
#
# default is 512MB
rocksdb.max_total_wal_size 512

# If WAL_ttl_seconds is 0 and WAL_size_limit_MB is not 0,
# WAL files will be checked every 10 min and if total size is greater
# then WAL_size_limit_MB, they will be deleted starting with the
#  earliest until size_limit is met. All empty files will be deleted
# Default: 16GB
rocksdb.wal_size_limit_mb 16384

# Approximate size of user data packed per block.  Note that the
# block size specified here corresponds to uncompressed data.  The
# actual size of the unit read from disk may be smaller if
# compression is enabled.
#
# Default: 4KB
#rocksdb.block_size 16384

# Indicating if we'd put index/filter blocks to the block cache
#
# Default: no
rocksdb.cache_index_and_filter_blocks yes

# Specify the compression to use.
# Accept value: ""no"", ""snappy""
# default snappy
rocksdb.compression snappy

# If non-zero, we perform bigger reads when doing compaction. If you're
# running RocksDB on spinning disks, you should set this to at least 2MB.
# That way RocksDB's compaction is doing sequential instead of random reads.
# When non-zero, we also force new_table_reader_for_compaction_inputs to
# true.
# 
# Default: 2 MB
rocksdb.compaction_readahead_size 2097152

# he limited write rate to DB if soft_pending_compaction_bytes_limit or
# level0_slowdown_writes_trigger is triggered.

# If the value is 0, we will infer a value from `rater_limiter` value
# if it is not empty, or 16MB if `rater_limiter` is empty. Note that
# if users change the rate in `rate_limiter` after DB is opened,
# `delayed_write_rate` won't be adjusted.
#
rocksdb.delayed_write_rate 0
# If enable_pipelined_write is true, separate write thread queue is
#  maintained for WAL write and memtable write.
#
#  Default: no 
rocksdb.enable_pipelined_write no

# Soft limit on number of level-0 files. We start slowing down writes at this
#  point. A value <0 means that no writing slow down will be triggered by
# number of files in level-0.
#
# Default: 20
rocksdb.level0_slowdown_writes_trigger 20

# Maximum number of level-0 files.  We stop writes at this point.
#
# Default: 40
rocksdb.level0_stop_writes_trigger 40

# if not zero, dump rocksdb.stats to LOG every stats_dump_period_sec
#
# Default: 0
rocksdb.stats_dump_period_sec 0

# if yes, the auto compaction would be disabled, but the manual compaction remain works
#
# Default: no
rocksdb.disable_auto_compactions no

################################ NAMESPACE #####################################
# namespace.test change.me

backup-dir /kvrocks/backup
log-dir /kvrocks

rocksdb.block_size 4096
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43yTFf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/366,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43zy4y,kvrocks,936324658,366,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-10-06T14:19:54Z,2021-10-06T14:19:54Z,"@hangzhouminghe88 Thanks for your information, as mentioned before, the default metadata/subkey cache was too small for your scene. You can try to increase the metadata cache to 1/20 of the DB size and enable the `rocksdb.share_metadata_and_subkey_block_cache` ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43zy4y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/366,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM435ZqH,kvrocks,937794183,366,NA,hangzhouminghe88,85660816,杭州明和科技股份有限公司,,NA,2021-10-07T13:29:19Z,2021-10-07T13:29:19Z,"```
# Specify the capacity  of metadata column family block cache. Larger block cache
# may make request faster while more keys would be cached. Max Size is 200*1024.
# Default: 2048MB
rocksdb.metadata_block_cache_size 204800

# Specify the capacity  of subkey column family block cache. Larger block cache
# may make request faster while more keys would be cached. Max Size is 200*1024.
# Default: 2048MB
```
rocksdb.subkey_block_cache_size 204800

rocksdb.share_metadata_and_subkey_block_cache = yes

???
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM435ZqH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/366,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43-2My,kvrocks,939221810,366,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-10-09T04:11:22Z,2021-10-09T04:11:22Z,"share_metadata_and_subkey_block_cache is a new feature, please see #365

As @git-hulk said, cache size should be more that 1/20 of the DB size to get high performance.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43-2My/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/366,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43-3um,kvrocks,939228070,366,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-10-09T05:03:45Z,2021-10-09T05:03:45Z,"we already tested BLOBDB, but we found it is not impeccable, may cause server freezing.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM43-3um/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/366,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45YDrx,kvrocks,962607857,366,NA,hangzhouminghe88,85660816,杭州明和科技股份有限公司,,NA,2021-11-07T13:09:00Z,2021-11-07T13:09:00Z,"Does kvrocks  2.0.3 support ROCKSDB's native KEY/VALUE separation, BLOB STORE? 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45YDrx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/366,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45Y2nj,kvrocks,962816483,366,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-11-08T05:07:01Z,2021-11-08T05:07:01Z,"No, the latest version was 2.0.4, but still not support the blobdb. I think we should NOT integrate before the blobdb was production-ready.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45Y2nj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/367,https://api.github.com/repos/apache/kvrocks/issues/367,kvrocks,1021571441,367,[BUG] Auto resize SST takes effect only in the default column family,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2021-10-09T02:12:34Z,2021-10-09T03:55:55Z,"### Background
In #120, kvrocks add the feature of dynamic resize block and sst. In #289, support `auto-resize-block-and-sst` config item to trigger this feature.

### Bug
This feature uses `Storage::SetOption` to set target_file_size_base: 

https://github.com/KvrocksLabs/kvrocks/blob/3bb4747f0a0878a72921b44e6ca4281b57ac5a6c/src/server.cc#L1057

This function only applies to the default CF(aka subkey CF). 

When only the basic string type is used and the average size of KV is small, because this feature does not affect metadata CF, the SST files are still large, resulting in filter block or index block too large, which affects performance.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/367/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/370,https://api.github.com/repos/apache/kvrocks/issues/370,kvrocks,1027006558,370,[BUG]使用redisson 封装的 poll(num) 获取内容错误,QQxiaoyuyu,34185590,,,CLOSED,2021-10-15T02:12:28Z,2021-10-19T03:29:40Z,"**Describe the bug**
A clear and concise description of what the bug is.

 - OS: [e.g. Centos 7]
 - Version [e.g. unstable]


**To Reproduce**
Steps to reproduce the behavior:
1. 
![图片](https://user-images.githubusercontent.com/34185590/137421277-d9635516-ce74-4113-b921-cd95c4fbb300.png)

2.正常 redisson 连 redis 是对的    不会出现类型错误
3.现在使用redisson 封装的 poll(num) 获取出的内容都是 String 类型了

**Expected behavior**
A clear and concise description of what you expected to happen.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/370/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/370,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44Q0i5,kvrocks,943933625,370,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-10-15T02:25:42Z,2021-10-15T02:25:42Z,需要补充一下，对应执行的时候， Redis monitor 返回结果是什么，kvrocks  返回结果是什么,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44Q0i5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/370,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44Q2zs,kvrocks,943942892,370,NA,QQxiaoyuyu,34185590,,,NA,2021-10-15T02:50:27Z,2021-10-15T02:50:27Z,"kvrocks 返回的命令
![图片](https://user-images.githubusercontent.com/34185590/137427351-a7983bc8-8d5e-4ba1-91e8-f12b73aa2a5b.png)



redis 执行的命令，返回的结果
![图片](https://user-images.githubusercontent.com/34185590/137424651-3e6bcdb9-350f-47a2-b844-9dfd51e4d983.png)
结果
![图片](https://user-images.githubusercontent.com/34185590/137424683-5aab4ff2-244a-47a6-9cae-bfa4bdda9fa3.png)

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44Q2zs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/370,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44Z_NX,kvrocks,946336599,370,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-10-19T03:29:39Z,2021-10-19T03:29:39Z,Fixed by https://github.com/KvrocksLabs/kvrocks/pull/369,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44Z_NX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/372,https://api.github.com/repos/apache/kvrocks/issues/372,kvrocks,1028340910,372,[NEW] Enable share block cache between  the metadata and subkey column family by default,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-10-17T14:28:07Z,2021-10-17T15:29:42Z,"Kvrocks supported the share block cache between the metadata and subkey column family, it's really a good point to speed up the lookup query. So it should be enabled by default? since it hurts nothing, also most users should NOT care about how to allocate the ratio of block cache between the metadata and subeky column family. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/372/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/372,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44VaO0,kvrocks,945136564,372,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2021-10-17T14:36:14Z,2021-10-17T14:36:14Z,"Yes, it is a good idea to turn `rocksdb.share_metadata_and_subkey_block_cache` to `yes` by default.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44VaO0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/376,https://api.github.com/repos/apache/kvrocks/issues/376,kvrocks,1030943151,376,what's the db action when run flushdb in some namespace?,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,CLOSED,2021-10-20T03:47:11Z,2021-11-08T04:02:58Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/376/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/376,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44dxpR,kvrocks,947329617,376,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-10-20T05:00:35Z,2021-10-20T05:00:35Z,"For the command `flushdb`, it would delete all keys in the current namespace(which was determined by the auth token) and NOT affect other namespaces.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM44dxpR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/376,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45YwVB,kvrocks,962790721,376,NA,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,NA,2021-11-08T04:02:58Z,2021-11-08T04:02:58Z,thanks,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45YwVB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/380,https://api.github.com/repos/apache/kvrocks/issues/380,kvrocks,1040218820,380,How to implement the script kill command in kvrocks,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-10-30T14:52:20Z,2021-11-07T12:03:37Z,"We have implemented the `eval`, `evalsha`, and script command, 
but script subcommand `kill` was still investigated since it doesn't have an easy way to implement for kvrocks. 

The first main obstacle was that kvrocks design internal has no way to process other clients' queries in the Lua hook function, so it can't process the `script kill` command since the Lua script was still running. The second was the kvrocks was a multi-threads model, and use a global lock to prevent the data race when running the Lua script, so we MUST yield the global lock to make other clients have a chance to execute the new query which was a bit tricky.

Changing the kvrocks client's design wasn't impracticable and unnecessary for implementing the `script kill`, but We think it's important to stop the long-running Lua script without restartting the server.  A possible workaround was to kill the  Lua script when reaches the time limit(like `lua-time-limit` in Redis but SHOULD be another name).
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/380/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/380,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM448Ekn,kvrocks,955271463,380,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-10-30T14:56:31Z,2021-10-30T14:56:31Z,How do you think @KvrocksLabs/committers ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM448Ekn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/384,https://api.github.com/repos/apache/kvrocks/issues/384,kvrocks,1043408177,384,[BUG] The configuration item rocksdb.compression cannot take effect,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2021-11-03T11:11:01Z,2021-11-21T02:32:57Z,"Kvrocks has a configuration item called `rocksdb.compression`, which is assigned to `rocksdb::Options`:
https://github.com/KvrocksLabs/kvrocks/blob/2e43741ddedc06f0376d71dc385e9d53a24b3204/src/storage.cc#L87

But Kvrocks calls rocksdb's built-in optimization function:
https://github.com/KvrocksLabs/kvrocks/blob/2e43741ddedc06f0376d71dc385e9d53a24b3204/src/storage.cc#L80

This function will set `compression_per_level`. Like the [Rocksdb Wiki](https://github.com/facebook/rocksdb/wiki/Compression#configuration) says, when `options.compression_per_level` is used, `options.compression` is ignored.

Rocksdb's built-in optimization function selects the best compression algorithm. **So do we need to remove `rocksdb.compression` configuration item in Kvrocks?**","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/384/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/384,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45KRdD,kvrocks,958994243,384,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-11-03T12:40:17Z,2021-11-03T12:40:17Z,"Good catch, as [OptimizeLevelStyleCompaction](https://github.com/facebook/rocksdb/blob/3e1bf771a3c7324306fc31317c9ea275e1a8dd61/options/options.cc#L600) would use the `lz4` first then the `snappy` if supported, but they're still some other compressions.  So seems that we can NOT enable the OptimizeLevelStyleCompaction when the compression was explicitly specified, HDYT.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45KRdD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/384,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45PfUL,kvrocks,960361739,384,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2021-11-04T01:31:49Z,2021-11-04T01:31:49Z,"`OptimizeLevelStyleCompaction ` function also optimizes other parameters, such as `write_buffer_size `, `max_bytes_for_level_base `, and so on. But we'll overwrite these parameters later. 

Maybe can we get rid of `OptimizeLevelStyleCompaction`, then set `compression_per_level`  in kvrocks?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45PfUL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/384,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45Pfyu,kvrocks,960363694,384,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-11-04T01:37:34Z,2021-11-04T01:37:34Z,Looks fine for me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM45Pfyu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/402,https://api.github.com/repos/apache/kvrocks/issues/402,kvrocks,1061991043,402,[NEW] Adjust open files limit according to maxclients and rocksdb.max_open_files,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2021-11-24T04:28:57Z,2021-12-07T01:01:04Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/402/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/403,https://api.github.com/repos/apache/kvrocks/issues/403,kvrocks,1062116778,403,[NEW] Use row cache of RocksDB to implement KV cache,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2021-11-24T08:06:28Z,2021-12-07T01:14:00Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/403/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/405,https://api.github.com/repos/apache/kvrocks/issues/405,kvrocks,1064075503,405,[NEW] Add sanitizer support,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2021-11-26T03:41:09Z,2022-06-12T03:24:27Z,"Use sanitizer to check accessing memory faults

- [ ] Don't use jemalloc, since gcc sanitizer don't support jemalloc
- [ ] Add sanitizer compile flags","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/405/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/405,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EuL4F,kvrocks,1152957957,405,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-11T16:12:57Z,2022-06-11T16:12:57Z,I think we can close this issue since we have already done them.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EuL4F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/405,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Eukum,kvrocks,1153059750,405,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-12T03:24:27Z,2022-06-12T03:24:27Z,Closed via #599.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Eukum/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/406,https://api.github.com/repos/apache/kvrocks/issues/406,kvrocks,1065753137,406,[NEW] RockDB  L0->L0 compactions ,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,OPEN,2021-11-29T08:37:33Z,2021-11-29T08:37:33Z,"> Introduce level-based L0->L0 compactions to reduce file count, so write delays are incurred less often.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/406/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/409,https://api.github.com/repos/apache/kvrocks/issues/409,kvrocks,1067927084,409,[NEW]Please support restore command,zhklcf,3126820,huikang zhu,huikangzhu@126.com,CLOSED,2021-12-01T03:57:43Z,2023-08-29T04:35:54Z,"Migration tools like redisshake usually use restore command to realize migration from redis to kvrocks。
Please support restore command。","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/409/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/409,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM46nXPT,kvrocks,983397331,409,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-12-01T08:17:54Z,2021-12-01T08:17:54Z,"Thanks, I MUST say that it is hard for us to implement redis RESOTRE command, since the restored value is the serialization of redis key value i.e. RDB format , so we need to support parsing all redis types, moreover, the encoding of key value serialization also would change in the future.

I think we shouldn't do this in kvrocks core code. Maybe there is a tool which can change RESTORE value to redis command, or we use other tools?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM46nXPT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/409,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM46npdw,kvrocks,983471984,409,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-12-01T09:53:47Z,2021-12-01T09:53:47Z,"Twemproxy and Codis also have the same issue, and RedisShake supports parsing the restore command to AOF: https://github.com/alibaba/RedisShake/wiki/FAQ#q-does-redisshake-supports-codis-and-twemproxy","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM46npdw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/409,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lIl_U,kvrocks,1696751572,409,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-08-29T04:35:54Z,2023-08-29T04:35:54Z,"restore was added in #1684, will be released in the next version (or try it in the unsable branch)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lIl_U/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/412,https://api.github.com/repos/apache/kvrocks/issues/412,kvrocks,1068394643,412,[NEW] Support slot-based data migration,ChrisZMF,18628342,,,CLOSED,2021-12-01T13:15:09Z,2022-01-27T12:24:48Z,"# 1 Background
Data online migration is an essential feature for database servers if they are deployed in the cluster. Since kvrocks already supports redis cluster mode #219, it is more necessary to support data online migration. Different from the key-based data migration method of the Redis community, we proposed a slot-based data migration method for kvrocks. 

# 2 Implementation
## 2.1 Data encoding format
To support slot-based migration, we need to encode slotid onto every key to improve the efficiency of iterating data.  The string key and hash key are adopted to explain the slotid encoding for simple key and complex key respectively as follows.

**String key**:
```
    +--------+----+---------+----------+
    | ns_len | ns | slot_id | user_key |
    +--------+----+---------+----------+
```
**Hash key**:
```
    hash metakey
    +--------+----+---------+----------+
    | ns_len | ns | slot_id | user_key |
    +--------+----+---------+----------+
    hash subkey
    +--------+----+---------+--------------+----------+---------+-------+
    | ns_len | ns | slot_id | user_key_len | user_key | Version | field |
    +--------+----+---------+--------------+----------+---------+-------+
```
As shown above, slotid is encoded onto the prefix of every key. Keys of the same slot will have the same prefix, they will be stored in an adjacent location in rocksdb which will improve data iterating efficiency.  Encoding slotid onto keys has been supported at #291 for kvrocks. 

## 2.2 Slot-based migration brief design
Slot-based migration process mainly includes the following stages.

1. Start migrating
2. Migrating existing data
3. Migrating incremental data
4. End migrating

The main process of slot-based migration can be described in the following diagram.
![kvrocks data migration](https://user-images.githubusercontent.com/18628342/146374545-e1d4847d-dca8-4f9d-bdb9-41472de23c96.png)
Figure 1. Slot-based migration process diagram

## 2.3 Detail implementation
### 2.3.1 Details of migrating process
As shown in the process diagram (Figure 1), the data migration will be triggered by sending a request to the source server. The source server will create a migration task after it got the data migration request. The main processes of slot-based migration are processed by this migration task. The details can be described as the following stages.
#### 1) Start migrating stage
At this stage, the source server will notify the destination server to prepare to import data. If the destination server is ready, the source server will go to the next stage to migrate data. Otherwise, the source server will stop the migration task.
#### 2) Migrating existing data stage
At this stage, the existing data will be migrated. Existing data of kvrocks is described by rocksdb snapshot at the migration beginning moment. Then, the source server will iterate all data of the snapshot, and construct data into Redis commands to send to the destination server. Constructed Redis commands will be sent by pipeline to improve efficiency.
#### 3) Migrating incremental data stage
While migrating existing data, the migrating slot can keep writing. In other words, new data will be written during migrating existing data. These new data must be migrated to the destination server too.  Before migrating incremental data, the migrating slot will be forbidden to write to maintain consistency. New data of the target slot cannot be written to the source server again. 
The amount of the incremental data may be very large, because it may take a long time to migrate the existing data. It will cause the slot to forbid writing for a long time.  To reduce the forbidden writing time duration, the incremental data migration will be processed in the two-step. 
- **First step**: Slot will not be forbidden writing while migrating incremental data. This step will be repeated until the amount of new data is less than a threshold, or the repetition times reach a threshold.
- **Second step**: Slot will be forbidden from writing before migrating the rest new data.
The incremental data will be gotten via iterating WAL of rocksdb.
#### 4) End migrating stage
The previous stages may succeed or fail. In this stage, the source server will notify the destination server that the migration task succeeded or failed. If the migration is successful, both source server and the destination server will change the cluster topology maintained by themslves, and source server will clear data belonging to migreted slot. If the migration fails, only destination server will clear imported data of the target slot.

### 2.3.2 Support commands
- CLUSTERX MIGRATE `$slot` `$dst_nodeid`
     `$dst_nodeid` is the node id of destination server in the cluster. See #219 for more details.
- CLUSTER IMPORT `$slot` `$state`
It is an internal command which will be sent by the source server to notify the destination server to prepare for data importing. **This command cannot be used directly by clients**.

# 3 Advantages and Disadvantages
## 3.1 Advantages
- Efficiency
  Compare with the key-based data migration method, the slot-based method supports data transmission with the pipeline, it is more efficient. 
- More convenient failure rollback
  Data in the source server can be deleted only when all data is migrated successfully. If any failure happens during data migrating, the migration task will be stopped, data won't be deleted.
- Consistency
  Writing to the migrating slot is forbidden while transmitting the last piece of incremental data. It can guarantee data consistency.
- asynchronous migration 
  Data migrating is processed in an independent thread, and does not affect the main threads to process requests.

## 3.2 Disadvantages
- Currently, it only supports to migrate slot one by one.

# 4 Extra work
- Support concurrent data migration.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/412/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/412,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM46ryOp,kvrocks,984556457,412,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-12-02T11:51:10Z,2021-12-02T11:51:10Z,"Since we encode slot id into key only when enabling cluster mode, so i think we should only support slot migration in cluster mode, and the migrate command should be consistent with cluster command.

i prefer to use CLUSTER subcommand to implement slot migration instead of separate commands , see also redis issue https://github.com/redis/redis/issues/2807 and in redis cluster v2 project https://github.com/redis/redis/issues/8948, they also want to support this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM46ryOp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/412,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Y6Fc,kvrocks,996385116,412,NA,ChrisZMF,18628342,,,NA,2021-12-17T02:29:12Z,2021-12-17T02:29:12Z,"Thanks for your suggestion, it really makes a lot of sense. The implementation of slot-based migration will be modified to adapt to the cluster mode.  @ShooterIT","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Y6Fc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/413,https://api.github.com/repos/apache/kvrocks/issues/413,kvrocks,1069316393,413,[NEW] Support CAS/CAD commands,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2021-12-02T09:24:48Z,2021-12-03T12:35:45Z,"CAS (Compare And Swap) and CAD (Compare And Delete) are frequently used in distributed systems, but are not currently supported by Kvrocks.

When we need to use this function, we usually need to use MULTI or Lua script implementation, which is quite troublesome.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/413/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/414,kvrocks,1070178827,414,Who is using Kvrocks?,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,OPEN,2021-12-03T03:20:45Z,2024-04-14T16:17:32Z,"## Who is using Kvrocks?

Sincerely thank everyone who constantly keeps on using and supporting Kvrocks. We will try our best to make Kvrocks better and make the community and ecology more prosperous.

## The original intention of this issue

- We’d like to listen to the community for making Kvrocks better
- We want to attract more partners to contribute to Kvrocks
- Learn more about the practical use scenarios of Kvrocks
- Learn about your new feature request to facilitate the next step of planning

## What we expect from you
Please submit a comment in this issue to include the following information:

- your company, school, or organization and its logo (which is allowed to be used for demonstration in our website)
- (optional) your city and country
- (optional) your contact info: email, Twitter or whatever
- (optional) what scenario do you use Kvrocks / what new feature do you expect for Kvrocks

Thanks again for your participation! Your support is the motivation for us to move forward. 

We will soon put your logo in our [User page](https://kvrocks.apache.org/users/) after you share your information!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/414/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM49Jgnk,kvrocks,1025903076,414,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-01-31T15:33:49Z,2022-01-31T15:33:49Z,"Organization: Coinindex Ltd
Location: London, UK, Kiev, Ukraine
Contact：raiden@coinindex.agency
Purpose: KV-storage and real-time PubSub bus for crypto/non-crypto fintech projects (market data aggregation, trading)
Feature: hash fields expiration, latest rocksdb version, re-implement new features from redis 7.0rc1","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM49Jgnk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM49ebNn,kvrocks,1031385959,414,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-02-07T11:56:11Z,2022-02-07T11:56:11Z,"Thanks for your attention @aleksraiden 
- **hash fields expiration** is on the road, see #408, we would finish it in next several months
- **latest rocksdb version**, we also have a plan
- **re-implement new features from redis 7.0rc1**: 7.0 has two many features, we may not support all things, but we always continue to make kvrocks more compatible with redis","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM49ebNn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BFUh5,kvrocks,1091913849,414,NA,adulau,3309,Alexandre Dulaunoy,a@foo.be,NA,2022-04-07T16:00:50Z,2022-04-07T16:00:50Z,"
-    CIRCL ([Computer Incident Response Center Luxembourg](https://www.circl.lu/)) - [MISP Project](https://www.misp-project.org/) 
-    Luxembourg - Europe
-    https://twitter.com/adulau - https://twitter.com/MISPProject/ - https://twitter.com/circl_lu
-    We use kvrocks for multiple projects to replace Redis especially on large data-set used for digital forensic, threat intelligence and data mining
-    hash field expiration but everything already implemented is working quite well on various production systems
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BFUh5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BMpzS,kvrocks,1093835986,414,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-04-09T09:19:58Z,2022-04-09T09:19:58Z,@adulau Does it ok to show your company logo in README section `Who uses kvrocks`? ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BMpzS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Bj8h2,kvrocks,1099942006,414,NA,adulau,3309,Alexandre Dulaunoy,a@foo.be,NA,2022-04-15T07:57:01Z,2022-04-15T07:57:01Z,Sure I can do a PR if you like.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Bj8h2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BkA5n,kvrocks,1099959911,414,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-04-15T08:26:19Z,2022-04-15T08:26:19Z,"@adulau Many thanks for your help. Yes, we want to add it to README.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BkA5n/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C8xxb,kvrocks,1123228763,414,NA,rex0654335,5621609,,,NA,2022-05-11T06:16:34Z,2022-05-11T06:16:34Z,"Organization：(personal)个人
Location：ShangHai
Contact：541563084@qq.com
How we(I) use Kvrocks: For Learning
Request features: namespace is good, it'd be better if can support getting command stats by namespace","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C8xxb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QwW4a,kvrocks,1354853914,414,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-12-16T13:59:29Z,2022-12-16T13:59:29Z,"We now have [the Users page](https://kvrocks.apache.org/users/) on the official website.

Users are encouraged to add themselves to the Users page. Send a pull request to add company or organization [information](https://github.com/apache/incubator-kvrocks-website/blob/main/src/components/UserLogos/index.tsx) and [logo](https://github.com/apache/incubator-kvrocks-website/tree/main/static/media/users).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QwW4a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UPukY,kvrocks,1413409048,414,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-02T09:27:16Z,2023-02-02T09:27:16Z,"Hi @tisonkun, I reopened this issue again to make users can paste the new logo here.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UPukY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UPxwg,kvrocks,1413422112,414,NA,willshS,41932662,,,NA,2023-02-02T09:36:39Z,2023-02-02T09:36:39Z,"<img width=""536"" alt=""货拉拉logo_rgb_预览"" src=""https://user-images.githubusercontent.com/41932662/216287119-1779c418-ff88-42a3-b0f0-83716c0ba35f.png"">
New Logo from Huolala.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UPxwg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UPyCp,kvrocks,1413423273,414,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-02T09:37:28Z,2023-02-02T09:37:28Z,"> <img alt=""货拉拉logo_rgb_预览"" width=""536"" src=""https://user-images.githubusercontent.com/41932662/216287119-1779c418-ff88-42a3-b0f0-83716c0ba35f.png"">
> 
> New Logo from Huolala.

Thanks @willshS, will update to the community website soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UPyCp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UWKuo,kvrocks,1415097256,414,NA,jizeyopera,70930512,,,NA,2023-02-03T06:18:36Z,2023-02-03T06:18:36Z,"组织：opera.com
地点：中国北京  
联系方式： adtech-dev-team@opera.com  
使用场景：做为 key-value 存储来存储CookieMapping数据  
期待功能：提供专门的UI来管理集群

Logo:
![opera_logo_flat-color_red_positive_horizontal_rgb](https://user-images.githubusercontent.com/70930512/216526289-fa8eef58-80f0-4600-a23d-db270476c118.png)

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UWKuo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UWMtU,kvrocks,1415105364,414,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-03T06:23:31Z,2023-02-03T06:23:31Z,"> 组织：opera.com 地点：中国北京 联系方式： [adtech-dev-team@opera.com](mailto:adtech-dev-team@opera.com) 使用场景：做为 key-value 存储来存储 CookieMapping 数据 期待功能：提供专门的 UI 来管理集群
> 
> Logo: ![opera_logo_flat-color_red_positive_horizontal_rgb](https://user-images.githubusercontent.com/70930512/216526289-fa8eef58-80f0-4600-a23d-db270476c118.png)

cool, great thanks to @jizeyopera information. Will update to the community website soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UWMtU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VVaVJ,kvrocks,1431676233,414,NA,DenizPiri,519796,Deniz Piri,denizpiri@hotmail.com,NA,2023-02-15T16:51:58Z,2023-02-15T16:51:58Z,"Organization: Ahoy Games
https://www.ahoygames.com/
Location: Warsaw, Poland
Contact: [denizpiri@ahoygames.com](mailto:denizpiri@ahoygames.com)
Purpose: Storing game logs and per-user game event data. We will use it for more very soon.

We are looking forward to the WATCH command support #315. Also test cases to ensure that kvrocks will always be backward compatible with how it uses rocksdb to store complicated types, such as lists, zset, etc.. would be nice.

Logo
![logo_black](https://user-images.githubusercontent.com/519796/219096154-27ba47f1-1675-4dc8-99de-22596e080c33.png)

Big thanks to all contributors of the project!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VVaVJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VYFoz,kvrocks,1432377907,414,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-16T02:19:56Z,2023-02-16T02:19:56Z,"@DenizPiri Thanks for your feedback. The WATCH has already in [our 2023 roadmap](https://github.com/orgs/apache/projects/199) and will start a discussion if someone has time to drive this feature. And for test cases, we have many test cases for the correctness and compatibility with Redis: https://github.com/apache/incubator-kvrocks/tree/unstable/tests","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VYFoz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VZe0p,kvrocks,1432743209,414,NA,HarmonYoung,23516980,Harmon,,NA,2023-02-16T09:02:29Z,2023-02-16T09:02:29Z,"组织：科大讯飞ADX 地点：中国安徽 联系方式：hanyang8@iflytek.com 使用场景：程序化广告投放中的uv级素材缓存 
![微信图片_20230216165849](https://user-images.githubusercontent.com/23516980/219317086-41720eb0-d2da-4759-aba5-2707012fcec8.png)
![logo-1](https://user-images.githubusercontent.com/23516980/219317311-b9941372-e560-44fd-8cc3-d854b555af26.png)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VZe0p/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VZ2x5,kvrocks,1432841337,414,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-16T10:12:11Z,2023-02-16T10:12:11Z,"> 组织：科大讯飞 ADX 地点：中国安徽 联系方式：[hanyang8@iflytek.com](mailto:hanyang8@iflytek.com) 使用场景：程序化广告投放中的 uv 级素材缓存 ![微信图片_20230216165849](https://user-images.githubusercontent.com/23516980/219317086-41720eb0-d2da-4759-aba5-2707012fcec8.png) ![logo-1](https://user-images.githubusercontent.com/23516980/219317311-b9941372-e560-44fd-8cc3-d854b555af26.png)

Thanks @HarmonYoung, will update to users soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VZ2x5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VaBCn,kvrocks,1432883367,414,NA,DenizPiri,519796,Deniz Piri,denizpiri@hotmail.com,NA,2023-02-16T10:44:09Z,2023-02-16T10:44:09Z,"@git-hulk Thanks a lot for the reply!

I was referring to tests that load DB files from older versions of KVrocks and make sure that it can read the structs out of that. I assume rocksdb should be very well tested for backward compatibility. But, for example, if KVrocks changes the way it stores a ZSET using rocksdb keys, I assume everything in the current tests folder would still pass, but older users wouldn't be able to upgrade to a newer version without data loss.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VaBCn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VaDmE,kvrocks,1432893828,414,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-16T10:52:34Z,2023-02-16T10:52:34Z,"> @git-hulk Thanks a lot for the reply!
> 
> I was referring to tests that load DB files from older versions of KVrocks and make sure that it can read the structs out of that. I assume rocksdb should be very well tested for backward compatibility. But, for example, if KVrocks changes the way it stores a ZSET using rocksdb keys, I assume everything in the current tests folder would still pass, but older users wouldn't be able to upgrade to a newer version without data loss.

Thanks for your suggestion, that's a good idea.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VaDmE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WB2kr,kvrocks,1443326251,414,NA,hnynes,397234,Mars,hnynes@gmail.com,NA,2023-02-24T09:27:49Z,2023-02-24T09:27:49Z,"组织: Shoplazza   https://www.shoplazza.com/
地点：中国广东深圳
使用场景：智能专辑，相关推荐，搜索
期待功能：提供专门的UI来管理集群，集群自动failover
logo:
![image](https://user-images.githubusercontent.com/397234/221141998-533e9374-ba7f-4471-b25d-65e08ac3e9bd.png)

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WB2kr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pHsjZ,kvrocks,1763625177,414,NA,bbqccx,133967682,,,NA,2023-10-16T02:21:47Z,2023-10-16T02:21:47Z,"组织：网易杭州研究院
地点：中国杭州
使用场景：用户标签数据
期待功能：提供专门的UI来管理集群，管控自身带密码安全","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pHsjZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tKhKy,kvrocks,1831473842,414,NA,mnizhq007,23118518,,,NA,2023-11-29T08:53:49Z,2023-11-29T08:53:49Z,"组织：中通快递
地点：中国上海
使用场景：用于MQ消费的幂等计算
期待功能：KVRocks集群向Redis集群的迁移支持、RDB持久化兼容、全量数据分析","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tKhKy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vwK6C,kvrocks,1874898562,414,NA,cnsky2016,19772922,sky,,NA,2024-01-03T06:20:53Z,2024-01-03T06:20:53Z,"- 组织：爱奇艺

- 地点：中国北京

- 使用场景：离线数据处理场景下海量数据点查询，相比hbase，支持redis协议的kvrocks更简单、功能更强大

- 期待功能：
  -   简单易用的可视化集群管理工具
  -   支持全文检索和向量检索

- logo:

![横-绿](https://github.com/apache/kvrocks/assets/19772922/2f0df3e7-55e5-4e0f-8990-a7148c324e3e)



","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vwK6C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wNiN2,kvrocks,1882596214,414,NA,gofort,11654185,Bogdan Kurnosov,kurnosov_bogdan@hotmail.com,NA,2024-01-09T08:19:27Z,2024-01-09T08:19:27Z,"Organization: Gcore
Location: Luxembourg, Poland
Contact: [bogdan.kurnosov@gcore.com](mailto:bogdan.kurnosov@gcore.com)
Purpose: Configuration storage and delivery to hundreds of geo distributed hosts which is further read by local agents on each host.
Logo: 
![Logo Design Core G](https://github.com/apache/kvrocks/assets/11654185/f90a2fae-6742-472b-bce6-967ddbdf9bc1)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wNiN2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56bz_2,kvrocks,2054111222,414,NA,alanhamlett,522344,Alan Hamlett,,NA,2024-04-14T16:17:32Z,2024-04-14T16:17:32Z,"Organization: WakaTime
Contact: support@wakatime.com
Purpose: Caching large dataset on S3 & R2 to reduce costs from S3 ops
Logo: ![Logo + Text Horizontal](https://github.com/apache/kvrocks/assets/522344/8557d825-5fe8-4b2f-82de-71a3bb939ade)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56bz_2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/421,https://api.github.com/repos/apache/kvrocks/issues/421,kvrocks,1075280237,421,Can I set     cluster-announce-*  at profiles ?,lt1946,369361,,lt1946@163.com,CLOSED,2021-12-09T08:15:37Z,2022-05-11T14:37:52Z," like these:
    cluster-announce-ip ${IP}
    cluster-announce-port ${PORT}
    cluster-announce-bus-port 1${PORT}
for redisson use.
Thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/421/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM46_-5I,kvrocks,989851208,421,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-12-09T13:26:08Z,2021-12-09T13:26:08Z,"Do you mean to use the kvrocks with the Redis cluster mode in Radisson? 

No, if I didn't misunderstand your meaning. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM46_-5I/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Cy3R,kvrocks,990588369,421,NA,lt1946,369361,,lt1946@163.com,NA,2021-12-10T03:53:00Z,2021-12-10T03:53:00Z,"yes, use at java like redisson!
I run cluster mode. find error; it's not set cluster-announce-ip at profile.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Cy3R/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47D6BN,kvrocks,990879821,421,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-12-10T11:12:03Z,2021-12-10T11:12:03Z,"Kvrocks cluster mode has a bit different from Redis, so we can't add the kvrocks as the Redis cluster mode in Redisson. There should need more extra work to use Kvrocks mode in Redisson, but the good news was that you can use the Kvrocks as the single server or sentinel mode.

Welcome to feedback if you have any thoughts, :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47D6BN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/422,https://api.github.com/repos/apache/kvrocks/issues/422,kvrocks,1075576385,422,[NEW] Auto persist namespaces after updating the namespace or token,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-12-09T13:30:36Z,2021-12-16T11:27:10Z,"Currently, we didn't auto rewrite namespaces and tokens after users updated them, which may cause configuration loss after restarting the Kvrocks without executing the config rewrite command. But the data is still in Kvrocks. All we need to do was re-add those namespaces again.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/422/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/424,https://api.github.com/repos/apache/kvrocks/issues/424,kvrocks,1077546188,424,Upgrade the rocksdb to the latest version,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-12-11T14:02:45Z,2022-06-11T16:10:13Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/424/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/424,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EuLxG,kvrocks,1152957510,424,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-11T16:10:12Z,2022-06-11T16:10:12Z,"Resolved by #555, sorry for forgetting to mention and close this issue in the PR.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EuLxG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/426,https://api.github.com/repos/apache/kvrocks/issues/426,kvrocks,1080959720,426,Add more tcl test cases for the sorted int,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2021-12-15T12:06:08Z,2021-12-27T09:32:33Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/426/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/428,kvrocks,1081813126,428,[BUG] It is wrong to rewrite config `rename-command` and lead kvrocks to fail to restart,iushas,7236171,tanic.xiao,,CLOSED,2021-12-16T06:16:55Z,2021-12-17T07:04:08Z,"### Describe
If your kvrocks config file has multiple `rename-command`, kvrocks would generate duplicate configuration items after executing `config rewrite`, whatever automatically or manually, and leads kvrocks to fail to restart.

It is introduced in #272

one example
```
rename-command debug                               290033_dont_run_debug_rudely
rename-command bgsave                              290033_dont_run_bgsave_rudely
rename-command shutdown                            290033_dont_run_shutdown_rudely
rename-command keys                                290033_dont_run_keys_rudely
rename-command debug                               290033_dont_run_debug_rudely
```
there are two debug rename-commands, so there will be the following error logs.
```
* Failed to load config, err: at line: #L19, err: No such command in rename-command
```
### How to fix
- you can find the duplicate configuration items, and remove duplicate items, only keep one remame-command for one command.
- of course, you can cherry-pick this commit https://github.com/KvrocksLabs/kvrocks/commit/6c8534a17f056f06faa09bfeada3f92df686975a (#429 ) 
- use 2.0.6 version (coming soon)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/428/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Ve_B,kvrocks,995487681,428,NA,iushas,7236171,tanic.xiao,,NA,2021-12-16T06:43:28Z,2021-12-16T06:43:28Z,"复现过程：主从切换后，新的master会发生上述问题

环境：version 2.0.4 ，一主一从 ， 接了sentinel监控

1、查看配置正常
root@redis-kvsenior02-290041:/home/redis/data/conf# cat kvrocks.conf
```
# server
bind                           7.33.107.212 10.91.38.110 127.0.0.1

# rename


# autofailover
slaveof 7.33.106.212 6379
slave-serve-stale-data         yes
slave-read-only                yes



# rename
rename-command flushall                            290041_dont_run_flushall_rudely
rename-command flushdb                             290041_dont_run_flushdb_rudely
rename-command bgsave                              290041_dont_run_bgsave_rudely
rename-command shutdown                            290041_dont_run_shutdown_rudely
rename-command keys                                290041_dont_run_keys_rudely
rename-command debug                               290041_dont_run_debug_rudely
rename-command compact                             290041_dont_run_compact_rudely

# server
port                                               6379
timeout                                            0
workers                                            1
...
```
2、手动执行slaveof no one 和切换 。 
  * 这里有两个问题， slaveof no one后发现角色还是slave。 
  * 再次执行slaveof no one ，变为了master
```
root@redis-kvsenior02-290041:/home/redis/data/conf# redis-cli
cann't open conf:/home/redis/etc/redis.conf
127.0.0.1:6379> slaveof no one
OK
127.0.0.1:6379> info replication
# Replication
role:slave
master_host:7.33.106.212
master_port:6379
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:2
slave_repl_offset:252419
slave_priority:100
connected_slaves:1
slave0:ip=7.33.106.212,port=6379,offset=252419,lag=0
master_repl_offset:252419
127.0.0.1:6379> info replication
# Replication
role:slave
master_host:7.33.106.212
master_port:6379
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:0
slave_repl_offset:252419
slave_priority:100
connected_slaves:1
slave0:ip=7.33.106.212,port=6379,offset=252419,lag=0
master_repl_offset:252419
127.0.0.1:6379> info replication
# Replication
role:slave
master_host:7.33.106.212
master_port:6379
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:1
slave_repl_offset:252421
slave_priority:100
connected_slaves:1
slave0:ip=7.33.106.212,port=6379,offset=252421,lag=0
master_repl_offset:252421
127.0.0.1:6379>
127.0.0.1:6379> info replication
# Replication
role:slave
master_host:7.33.106.212
master_port:6379
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:2
slave_repl_offset:252421
slave_priority:100
connected_slaves:1
slave0:ip=7.33.106.212,port=6379,offset=252421,lag=0
master_repl_offset:252421
127.0.0.1:6379> info replication
# Replication
role:slave
master_host:7.33.106.212
master_port:6379
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:2
slave_repl_offset:252421
slave_priority:100
connected_slaves:1
slave0:ip=7.33.106.212,port=6379,offset=252421,lag=0
master_repl_offset:252421
127.0.0.1:6379> slaveof no one
OK
127.0.0.1:6379>
127.0.0.1:6379>
127.0.0.1:6379>
127.0.0.1:6379> info replication
# Replication
role:master
connected_slaves:1
slave0:ip=7.33.106.212,port=6379,offset=252423,lag=0
master_repl_offset:252423
127.0.0.1:6379> info replication
# Replication
role:master
connected_slaves:1
slave0:ip=7.33.106.212,port=6379,offset=252425,lag=0
master_repl_offset:252425
127.0.0.1:6379> set xtk sd
OK
127.0.0.1:6379> get xtk
""sd""
127.0.0.1:6379>
```

3、再次看配置，发现rename-command flushall   290041_dont_run_flushall_rudely变了，原来的master的配置文件没有变
root@redis-kvsenior02-290041:/home/redis/data/conf# cat kvrocks.conf
```
# server
bind 7.33.107.212 10.91.38.110 127.0.0.1

# rename


# autofailover
slaveof no one
slave-serve-stale-data yes
slave-read-only yes



# rename
rename-command compact                             290041_dont_run_compact_rudely
rename-command flushdb                             290041_dont_run_flushdb_rudely
rename-command bgsave                              290041_dont_run_bgsave_rudely
rename-command shutdown                            290041_dont_run_shutdown_rudely
rename-command keys                                290041_dont_run_keys_rudely
rename-command debug                               290041_dont_run_debug_rudely
rename-command compact                             290041_dont_run_compact_rudely

# server
port 6379
timeout 0
w...
```
@git-hulk @ShooterIT ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Ve_B/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Vows,kvrocks,995527724,428,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-12-16T07:58:11Z,2021-12-16T07:58:11Z,"> two debug rename-commands
> 
> Failed to load config, err: at line: #L19, err: No such command in rename-command
> Version: 2.0.4 @8374af2

It is not a bug, redis have similar behavior, since the command is already renamed, you can rename `renamed command` again, i.e. `rename-command` `290033_dont_run_debug_rudely` `debug2`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Vows/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47VtUz,kvrocks,995546419,428,NA,iushas,7236171,tanic.xiao,,NA,2021-12-16T08:25:35Z,2021-12-16T08:25:35Z,"> rename-command

I use redis to test， the issue dsnt happens","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47VtUz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47VuZB,kvrocks,995550785,428,NA,iushas,7236171,tanic.xiao,,NA,2021-12-16T08:31:47Z,2021-12-16T08:31:47Z,"> > two debug rename-commands
> > Failed to load config, err: at line: #L19, err: No such command in rename-command
> > Version: 2.0.4 @8374af2
> 
> It is not a bug, redis have similar behavior, since the command is already renamed, you can rename `renamed command` again, i.e. `rename-command` `290033_dont_run_debug_rudely` `debug2`

which redis version you said!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47VuZB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Vwhe,kvrocks,995559518,428,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-12-16T08:44:25Z,2021-12-16T08:44:25Z,"```
rename-command debug                               290041_dont_run_debug_rudely
rename-command debug                               290041_dont_run_debug_rudely
```
use this config, redis could start?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Vwhe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Vw5g,kvrocks,995561056,428,NA,iushas,7236171,tanic.xiao,,NA,2021-12-16T08:46:45Z,2021-12-16T08:46:45Z,"> 
you have not understand the question， after switch master， the new master's config will auto change to that， isn‘t changed by manul.  

use that file, certainly cont start!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Vw5g/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47VxWP,kvrocks,995562895,428,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-12-16T08:49:24Z,2021-12-16T08:49:24Z,I just answer your first question instead of the second,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47VxWP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Vzk5,kvrocks,995572025,428,NA,iushas,7236171,tanic.xiao,,NA,2021-12-16T09:02:23Z,2021-12-16T09:02:23Z,"> 



> I just answer your first question instead of the second

这两个说的是一个问题，第二个是复现过程，切换后，配置文件会自动改变。 麻烦确认下吧","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47Vzk5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47V4EE,kvrocks,995590404,428,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2021-12-16T09:25:18Z,2021-12-16T09:25:18Z,"> 2、手动执行slaveof no one 和切换 。
> 
> 这里有两个问题， slaveof no one后发现角色还是slave。
> 再次执行slaveof no one ，变为了master

第一次执行slaveof no one后，日志中有没有出现 `[replication] Stopped`
以及第二次执行呢","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47V4EE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47V7d7,kvrocks,995604347,428,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-12-16T09:43:19Z,2021-12-16T09:43:19Z,"是两个问题:
1. config rewrite 之后不对导致 rename command 问题重启有问题，这个已经找到原因
2. slaveof no one 失败是另外一个问题
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47V7d7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/428,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47V87F,kvrocks,995610309,428,NA,iushas,7236171,tanic.xiao,,NA,2021-12-16T09:51:19Z,2021-12-16T09:51:19Z,"> 
每次执行slaveof no one，应该是有出现[replication] stopped

流程应该是这样的：
初始 A -> B

1、 在B执行slaveof no one 
2、在A执行slaveof B， 理想情况下应该是变成 B-> A.  但是可能由于sentinel 主动又把 B变成了A的slave。 所以在A执行slaveof B后， 通过info replcation 居然看到了 A <=> B的情况
3、然后再次在B执行 slaveof no one ，架构改成了B -> A


![image](https://user-images.githubusercontent.com/7236171/146348753-8a441e96-ef90-4f15-943f-c1cb94540fba.png)

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47V87F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/432,https://api.github.com/repos/apache/kvrocks/issues/432,kvrocks,1083008588,432,主从模式必须不能配置密码么?,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,CLOSED,2021-12-17T08:30:20Z,2021-12-17T09:14:35Z,"slaveof masterIP master Port
error-log: E1217 16:27:36.536201 145314 replication.cc:412] Failed to get the db name, -NOAUTH Authentication required.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/432/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/433,https://api.github.com/repos/apache/kvrocks/issues/433,kvrocks,1085391162,433,[NEW] Support some status to info command result,iushas,7236171,tanic.xiao,,CLOSED,2021-12-21T03:12:29Z,2021-12-27T02:18:09Z,"When execute bgsave command in redis, we can get some progess stats and result stats through  info command, such as 
 ""rdb_changes_since_last_save:253062290
rdb_bgsave_in_progress:0
rdb_last_save_time:1640050693
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:153
rdb_current_bgsave_time_sec:-1 "".etc,

we can known if the command excute rightly or not by analysor the info stats。

I think it will be cool if kvrocks can do the same things like redis !

@git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/433/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/433,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47hTzP,kvrocks,998587599,433,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-12-21T08:53:14Z,2021-12-21T08:53:14Z,"@iushas Thanks for your feedback, would add more informations for bgsave soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47hTzP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/437,kvrocks,1090333478,437,[BUG]  Failed to open DB with missing CURRENT file,jasonhe88,6936520,,alenhe@hotmail.com,CLOSED,2021-12-29T07:49:41Z,2022-06-06T11:03:05Z,"**Describe the bug**
A clear and concise description of what the bug is.

 - OS: MAC OS 10.15.7
 - Version  2.0.5 @6a4ed16a

get following error message when try to start up kvrocks ( first time run )

E1229 15:41:02.217978 276704704 main.cc:314] Failed to open: IO error: No such file or directory: While opening a file for sequentially reading: /tmp/kvrocks/db/CURRENT: No such file or directory

/tmp/kvrocks directory did exist but no sub-directory ./db under it.



","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/437/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wBI-,kvrocks,1002443326,437,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2021-12-29T07:54:06Z,2021-12-29T07:54:06Z,Have you tried to modify the `dir` item in the configuration file?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wBI-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wCAf,kvrocks,1002446879,437,NA,jasonhe88,6936520,,alenhe@hotmail.com,NA,2021-12-29T08:04:50Z,2021-12-29T08:04:50Z,"> Have you tried to modify the `dir` item in the configuration file?

yes, I modified dir to other directory, still got same msg","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wCAf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wCqu,kvrocks,1002449582,437,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2021-12-29T08:12:23Z,2021-12-29T08:12:23Z,You create the directory manually and see if it works.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wCqu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wC0J,kvrocks,1002450185,437,NA,jasonhe88,6936520,,alenhe@hotmail.com,NA,2021-12-29T08:14:17Z,2021-12-29T08:14:17Z,"> Have you tried to modify the `dir` item in the configuration file?

just tried, still the same

by the way, make test all ok
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wC0J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wDYh,kvrocks,1002452513,437,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-12-29T08:20:38Z,2021-12-29T08:20:38Z,"@jasonhe88 Can u help to check whether `/tmp/kvrocks/db/CURRENT` was existed or not, or have a look at your directory permission.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wDYh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wDon,kvrocks,1002453543,437,NA,jasonhe88,6936520,,alenhe@hotmail.com,NA,2021-12-29T08:23:28Z,2021-12-29T08:23:28Z,"> @jasonhe88 Can u help to check whether `/tmp/kvrocks/db/CURRENT` was existed or not, or have a look at your directory permission.

here are all the files under /tmp/kvrocks:

lrwxr-xr-x  1 jasonhe  wheel   63 12 29 16:07 kvrocks.ERROR -> kvrocks.JasoniMac.local.jasonhe.log.ERROR.20211229-160746.77969
lrwxr-xr-x  1 jasonhe  wheel   62 12 29 16:07 kvrocks.INFO -> kvrocks.JasoniMac.local.jasonhe.log.INFO.20211229-160746.77969
-rw-r--r--  1 jasonhe  wheel  341 12 29 15:29 kvrocks.JasoniMac.local.jasonhe.log.ERROR.20211229-152937.72372
-rw-r--r--  1 jasonhe  wheel  341 12 29 15:48 kvrocks.JasoniMac.local.jasonhe.log.ERROR.20211229-154820.76439
-rw-r--r--  1 jasonhe  wheel  341 12 29 16:07 kvrocks.JasoniMac.local.jasonhe.log.ERROR.20211229-160746.77969
-rw-r--r--  1 jasonhe  wheel  411 12 29 15:29 kvrocks.JasoniMac.local.jasonhe.log.INFO.20211229-152937.72372
-rw-r--r--  1 jasonhe  wheel  411 12 29 15:48 kvrocks.JasoniMac.local.jasonhe.log.INFO.20211229-154820.76439
-rw-r--r--  1 jasonhe  wheel  411 12 29 16:07 kvrocks.JasoniMac.local.jasonhe.log.INFO.20211229-160746.77969
-rw-r--r--  1 jasonhe  wheel  341 12 29 15:29 kvrocks.JasoniMac.local.jasonhe.log.WARNING.20211229-152937.72372
-rw-r--r--  1 jasonhe  wheel  341 12 29 15:48 kvrocks.JasoniMac.local.jasonhe.log.WARNING.20211229-154820.76439
-rw-r--r--  1 jasonhe  wheel  341 12 29 16:07 kvrocks.JasoniMac.local.jasonhe.log.WARNING.20211229-160746.77969
lrwxr-xr-x  1 jasonhe  wheel   65 12 29 16:07 kvrocks.WARNING -> kvrocks.JasoniMac.local.jasonhe.log.WARNING.20211229-160746.77969
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wDon/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wD6K,kvrocks,1002454666,437,NA,jasonhe88,6936520,,alenhe@hotmail.com,NA,2021-12-29T08:26:20Z,2021-12-29T08:26:20Z,"> @jasonhe88 Can u help to check whether `/tmp/kvrocks/db/CURRENT` was existed or not, or have a look at your directory permission.

the original permisson is 755, i changed to 777, still same

drwxrwxrwx  14 jasonhe  wheel  448 12 29 16:07 kvrocks
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wD6K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wLoH,kvrocks,1002486279,437,NA,jasonhe88,6936520,,alenhe@hotmail.com,NA,2021-12-29T09:40:15Z,2021-12-29T09:40:15Z,"tried on CentOS 8, same problem","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wLoH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wSqM,kvrocks,1002515084,437,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-12-29T10:04:55Z,2021-12-29T10:04:55Z,Do you use the release RPM? I have no idea about why this happen since can't reproduce on my side.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wSqM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wUC_,kvrocks,1002520767,437,NA,fishery86,63535239,,,NA,2021-12-29T10:18:51Z,2021-12-29T10:18:51Z,it seems there have some errors link with rocksdb,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wUC_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wXYu,kvrocks,1002534446,437,NA,jasonhe88,6936520,,alenhe@hotmail.com,NA,2021-12-29T10:52:46Z,2021-12-29T10:52:46Z,"> Do you use the release RPM? I have no idea about why this happen since can't reproduce on my side.

tried release RPM on CentOS8, it's running ok

 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wXYu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wjpY,kvrocks,1002584664,437,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-12-29T13:04:26Z,2021-12-29T13:04:26Z,"Many thanks for your feedback, do you follow the pre-install step before installing? 

https://github.com/KvrocksLabs/kvrocks#building-kvrocks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wjpY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wk_E,kvrocks,1002590148,437,NA,jasonhe88,6936520,,alenhe@hotmail.com,NA,2021-12-29T13:16:57Z,2021-12-29T13:16:57Z,"> Many thanks for your feedback, do you follow the pre-install step before installing?
> 
> https://github.com/KvrocksLabs/kvrocks#building-kvrocks

no problem, thanks to you guys for this great product :-)

I exactly followed the installation steps, except did a check out before make -4j

git checkout v2.0.5 


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wk_E/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wlRu,kvrocks,1002591342,437,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2021-12-29T13:20:00Z,2021-12-29T13:20:00Z,"Thanks, I would try to reproduce this issue on my side, very welcome to help us to fix this issue if you have any clues.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM47wlRu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/437,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EVxK-,kvrocks,1146557118,437,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-04T07:23:22Z,2022-06-04T07:23:22Z,"I finally reproduced this issue by wrongly linking the compression library,
Kvrocks will ignore the creating column families error and cause failed to
open DB since it didn't auto create the db dir. This will be fixed by #620.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EVxK-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/439,https://api.github.com/repos/apache/kvrocks/issues/439,kvrocks,1090906273,439,[NEW] Support min-slaves-to-write like redis,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,OPEN,2021-12-30T06:33:46Z,2021-12-30T06:33:46Z,"**The problem/use-case that the feature addresses**

Redis provide these configs to make it is possible for a master to stop accepting writes if there are less than N replicas connected, having a lag less or equal than M seconds. But kvrocks can't.

> min-replicas-to-write 3
> min-replicas-max-lag 10

**Description of the feature**

The N replicas need to be in ""online"" state.

The lag in seconds, that must be <= the specified value, is calculated from the last ping received from the replica, that is usually sent every second.

This option does not GUARANTEE that N replicas will accept the write, but will limit the window of exposure for lost writes in case not enough replicas are available, to the specified number of seconds.

**Alternatives you've considered**

We may want to support semi-sync like MySQL, so we should also think it is worth implementing this feature.

**Additional information**

_NULL_
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/439/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/448,https://api.github.com/repos/apache/kvrocks/issues/448,kvrocks,1097229887,448,[BUG] Maybe there's a bug in the publish/subscribe logic,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-01-09T15:46:53Z,2022-09-11T03:35:45Z,"**Describe the bug**
The github actions occasionally failed at Publish/Subscribe tcl test cases like below: 

https://github.com/KvrocksLabs/kvrocks/runs/4751562466?check_suite_focus=true#step:7:725

After reviewing the test case many times and it always happened on the ubuntu which was multi-threads, so i think it should be caused by the data race condition in the publish/subscribe logical, but still didn't find the right way to reproduce this issue.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/448/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/448,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48Gcgd,kvrocks,1008322589,448,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-09T15:48:37Z,2022-01-09T15:48:37Z,Maybe we can have a try at Ubuntu with enabling the thread sanitizer.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48Gcgd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/448,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFNBh,kvrocks,1242878049,448,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:35:45Z,2022-09-11T03:35:45Z,Closed as stale. This issue seems vanished.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFNBh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/449,https://api.github.com/repos/apache/kvrocks/issues/449,kvrocks,1097234454,449,[NEW] Add Code of Conduct,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-01-09T16:04:52Z,2022-01-15T13:18:25Z,"We need the `Code Of Conduct` to help contributors and maintainers to follow the unify guideline
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/449/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/451,https://api.github.com/repos/apache/kvrocks/issues/451,kvrocks,1098503826,451,Wrong per-cmd latencies in Grafana dashboard,bisho,1917,,,CLOSED,2022-01-10T23:50:27Z,2022-01-11T16:35:45Z,"**Describe the bug**
Not sure if you created this grafana dashboard, I hope it was you:
https://grafana.com/grafana/dashboards/15286

Latencies in the grafana dashboard are graphed as:

```
sum(rate(kvrocks_commands_duration_seconds_total{instance=""$instance""}[$interval])) by (cmd)
```

If you see, the per-cmd command duration is not divided by the number of requests, so it is showing a sum of latencies for all run cmds. I think it should be:

```
sum(rate(kvrocks_commands_duration_seconds_total{instance=""$instance""}[$interval])) by (cmd) / sum(rate(kvrocks_commands_total{instance=""$instance""}[$interval])) by (cmd)
```

We also preferred to exclude the `psync` command, since it takes a lot longer than other production cmds, and makes it eaier to find issues with performance:

```
sum(rate(kvrocks_commands_duration_seconds_total{instance=""$instance"", cmd!=""psync""}[$interval])) by (cmd) / sum(rate(kvrocks_commands_total{instance=""$instance"", cmd!=""psync""}[$interval])) by (cmd)
```

If the intention was to show the usage by cmd type, then the graph is right, but you probably want to adjust the title to make it clear. We were shocked to see latency graph growing with load to very unreasonable numbers.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/451/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48LDHY,kvrocks,1009529304,451,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-11T01:56:37Z,2022-01-11T01:56:37Z,"Yes, thanks for your feedback, you're right that we should divide the requests instead of total latency. Would fix it later~ : )","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48LDHY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48NIG9,kvrocks,1010074045,451,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-11T15:26:31Z,2022-01-11T15:26:31Z,"@bisho Fixed, can have a try again. For excluding `psync`, can modify it after importing since it would be strange to remove it from the basic template.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48NIG9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48NZ7z,kvrocks,1010147059,451,NA,bisho,1917,,,NA,2022-01-11T16:35:45Z,2022-01-11T16:35:45Z,"Looks great, thanks!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48NZ7z/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/453,https://api.github.com/repos/apache/kvrocks/issues/453,kvrocks,1100488145,453,[NEW] More compatible with redis-cli,shangxiaoxiong,52746580,XiongDa,,CLOSED,2022-01-12T15:39:56Z,2022-01-19T05:09:39Z,"""redis-cli --pipe"" can not work with kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/453/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/453,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48kENl,kvrocks,1016087397,453,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-01-19T05:09:39Z,2022-01-19T05:09:39Z,Resolved in #452,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48kENl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/454,https://api.github.com/repos/apache/kvrocks/issues/454,kvrocks,1101271693,454,[QUESTION]Setbit max offset limit,ColinChamber,95634254,ColinChamber,,CLOSED,2022-01-13T06:39:41Z,2022-01-19T15:35:47Z,"Kvrocks' limit on setbit offset seems narrow, less than the maximum value in Redis (512M*8-1). According to the design of `metadata size(4byte)`, the max offset can even be larger than Redis. Why is the limit `INT_MAX` #164? Should `std::stoi` not be used in `bitcount`? Is there some context I don't comprehend @ShooterIT ?

![screenshot_358](https://user-images.githubusercontent.com/95634254/149277858-71828178-c6ae-4026-94f6-51cf006a58d9.png)
![screenshot_359](https://user-images.githubusercontent.com/95634254/149277870-9da97cc3-0163-48b8-a8c9-8c93dc5b3c18.png)

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/454/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/454,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48Uzul,kvrocks,1012087717,454,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-13T12:21:56Z,2022-01-13T12:21:56Z,"@ColinChamber It's a bug to use std::stoi, we should regard it as unsigned int. Would you like to fix this issue?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48Uzul/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/454,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48XYPF,kvrocks,1012761541,454,NA,ColinChamber,95634254,ColinChamber,,NA,2022-01-14T04:43:08Z,2022-01-14T04:43:08Z,"Ok, I will fix it today.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48XYPF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/454,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48ZLw0,kvrocks,1013234740,454,NA,ColinChamber,95634254,ColinChamber,,NA,2022-01-14T15:41:43Z,2022-01-14T15:41:43Z,"There is more code to modify than expected, and I still need some time to test.

> Ok, I will fix it today.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48ZLw0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/454,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48ZNBQ,kvrocks,1013239888,454,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-14T15:48:10Z,2022-01-14T15:48:10Z,"cool, very appreciate your hard work to make the Kvrocks better.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48ZNBQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/456,kvrocks,1102843494,456,[NEW] SetCommand may be need more compatible with redis.,guoxiangCN,30590325,mzygdeaq@163.com,,CLOSED,2022-01-14T03:08:43Z,2023-03-18T01:34:56Z,"1. [ set key val nx px ] should be reply with ""syntax error"", but kvrocks can works
2. [ set key val px 1000 ex 1000 ] should be reply with ""syntax error"", but kvrocks can works.
3. redis supports  [ set key val keepttl ], but kvrocks not supports
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/456/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48XO-2,kvrocks,1012723638,456,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-01-14T03:44:44Z,2022-01-14T03:44:44Z,"Yes, kvrocks doesn't check the parameters carefully,

And currently `keepttl ` ,`PXAT`, `EXAT` and some other flags, kvrocks doesn't support.

Do you want to fix this and support these flags? @guoxiangCN ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48XO-2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48XPk4,kvrocks,1012726072,456,NA,guoxiangCN,30590325,mzygdeaq@163.com,,NA,2022-01-14T03:50:42Z,2022-01-14T03:50:42Z,"> 

i 'm trying my best~","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48XPk4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DcyTh,kvrocks,1131619553,456,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-19T12:23:31Z,2022-05-19T12:23:31Z,"@guoxiangCN has no spare time to do that, if someone wants to do that, go ahead","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DcyTh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dfusw,kvrocks,1132391216,456,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-20T02:27:59Z,2022-05-20T02:27:59Z,"comments from @PragmaTwice 
I feel that it might be a bit too cumbersome to operate a `vector<string>` for each command to parse, and there would be a lot of duplicated logic. It might be nice to design some unified abstraction, but I haven't figured out how to do that yet.

Here are some initial ideas.

To parse `SET key value [ NX | XX] [GET] [ EX seconds | PX milliseconds | EXAT unix-time-seconds | PXAT unix-time-milliseconds | KEEPTTL]` ([ref](https://redis.io/commands/set/)):

```
#define CHECK(x) if(!x.ok()) return parse failed
#define CHECK_ASSIGN(x, v, default) if(x == default || x == v) x = v else return parse failed

iter = parsing iterator(args...);

CHECK(iter.pick_str(&key)); // insure the arg exists, eat it and dump to `key` if exists
CHECK(iter.pick_str(&value));

while(!iter.reach_end()) {
  auto pos = iter.get_pos();

  if(iter.pick_eq(""NX"")) { // check the current arg is NX, eat it and return true if it is, otherwise return false
    CHECK_ASSIGN(set_flag, nx, none)
  } else if(iter.pick_eq(""XX"")) {
    CHECK_ASSIGN(set_flag, xx, none)
  }

  if(iter.pick_eq(""GET"")) {
     get_flag = true;
  }
  
  if(iter.pick_eq(""EX"")) {
    CHECK_ASSIGN(expire_flag, ex, none);
    CHECK(iter.pick_int(&expire_value));
  } else if(iter.pick_eq(""PX"")) {
    CHECK_ASSIGN(expire_flag, px, none);
    CHECK(iter.pick_int(&expire_value));
  } else if(iter.pick_eq(""EXAT"")) {
    CHECK_ASSIGN(expire_flag, exat, none);
    CHECK(iter.pick_int(&expire_value));
  } else if(iter.pick_eq(""PXAT"")) {
    CHECK_ASSIGN(expire_flag, pxat, none);
    CHECK(iter.pick_int(&expire_value));
  } else if(iter.pick_eq(""KEEPTTL"")) {
    CHECK_ASSIGN(expire_flag, keepttl, none);
  }

  if(iter.at(pos)) return parse failed;
}
```

or a shorter version with string literal as enums:

```
#define CHECK_ASSIGN(x, v) if(x == nullptr || x == v) x = v else return parse failed

const char *iter.pick_eq_literals(const char *strs[]) {
  for(str : strs) {
    if(iter.pick_eq(str)) return str;
  }
  return nullptr;
}

iter = parsing iterator(args...);

CHECK(iter.pick_str(&key));
CHECK(iter.pick_str(&value));

while(!iter.reach_end()) {
  auto pos = iter.get_pos();

  if(new_set_flag = iter.pick_eq_literals(""NX"", ""XX"")) {
    CHECK_ASSIGN(set_flag, new_set_flag)
  }

  if(iter.pick_eq(""GET"")) {
     get_flag = true
  }

  if(new_expire_flag = iter.pick_eq_literals(""EX"", ""PX"", ""EXAT"", ""PXAT"", ""KEEPTTL"")) {
    CHECK_ASSIGN(expire_flag, new_expire_flag);
  }
  
  if(new_expire_flag && new_expire_flag != ""KEEPTTL""s) {
    CHECK(iter.pick_int(&expire_value));
  }

  if(iter.at(pos)) return parse failed;
}
```

We can design it as an utility class, so command authors are free to use it or not.

Advantages:
- do not need to maintain the parsing state by ourselves (mostly)
- do not need to parse integer, float, or any input type by ourselves; report parse error for these types
- as efficient as previous

What do you think? I would appreciate any comments! @git-hulk  @ShooterIT 

@git-hulk said
It looks better than before, this idea is really nice to me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dfusw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DfvrU,kvrocks,1132395220,456,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-20T02:35:44Z,2022-05-20T02:35:44Z,"@PragmaTwice move your comments here, and discuss here to avoid far too many comments for #595","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DfvrU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dfxmu,kvrocks,1132403118,456,NA,PragmaTwice,20042607,Twice,,NA,2022-05-20T02:54:32Z,2022-05-20T02:54:32Z,"Thanks! BTW I think this idea is applicable to all commands, including `SET`, especially some complex ones.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dfxmu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dfx9Q,kvrocks,1132404560,456,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-20T02:57:51Z,2022-05-20T02:57:51Z,"@PragmaTwice oh, it will be a big change, i think we should open a new issue to discuss","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dfx9Q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DgIg4,kvrocks,1132496952,456,NA,PragmaTwice,20042607,Twice,,NA,2022-05-20T05:43:14Z,2022-05-20T05:43:14Z,Thanks. Moved to #598.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DgIg4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5X5BQU,kvrocks,1474565140,456,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-03-18T01:34:55Z,2023-03-18T01:34:55Z,"Closing as partially resolved...

`set key val nx px` and `set key val px 1000 ex 1000` have been aligned with Redis behavior now. ""set key val keepttl"" is a new feature that we can track in a new issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5X5BQU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/457,https://api.github.com/repos/apache/kvrocks/issues/457,kvrocks,1103105589,457,can it monitor expired key?,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,CLOSED,2022-01-14T06:33:09Z,2022-06-28T10:22:13Z,"Please keep in mind that this issue tracker should be used for reporting bugs or proposing improvements to the kvrocks server.

Generally, questions about using kvrocks should be directed to the [community](https://groups.google.com/g/kvrocks).

It is also possible that your question was already asked here, so please do a quick issues search before submitting.

That said, please feel free to replace all this with your question :)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/457/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/457,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48ZMMj,kvrocks,1013236515,457,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-14T15:43:57Z,2022-01-14T15:43:57Z,Do you mean can we monitor the number of expired key numbers?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48ZMMj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/457,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48bkLU,kvrocks,1013859028,457,NA,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,NA,2022-01-16T11:33:47Z,2022-01-16T11:33:47Z,"pubsub redis event,
in redis.conf, notify-keyspace-event","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48bkLU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/457,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48bkpU,kvrocks,1013860948,457,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-16T11:48:37Z,2022-01-16T11:48:37Z,"Got what you mean, it’s not easy for Kvrocks since expired behavior was delay to RocksDB compaction. Welcome to feedback if you have any thoughts l.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48bkpU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/457,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48cYO2,kvrocks,1014072246,457,NA,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,NA,2022-01-17T02:07:32Z,2022-01-17T02:07:32Z,thanks,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48cYO2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/462,kvrocks,1107217287,462,[BUG] Incorrect data after SLAVEOF,DenizPiri,519796,Deniz Piri,denizpiri@hotmail.com,CLOSED,2022-01-18T18:13:51Z,2022-05-24T02:53:47Z,"**Describe the bug**
After SLAVEOF, 2 instances can contain different values for a given key.

**To Reproduce**
Start 2 kvrocks instances and execute the following commands in the respective instances.

- **SERVER2**: SLAVEOF SERVER1
- **SERVER2**: SLAVEOF NO ONE
- **SERVER2**: SET test 222
- **SERVER1**: SET test 111
- **SERVER2**: SLAVEOF SERVER1
- **SERVER2**: GET test
  - Returns ""222"". However, it should return ""111"".

If a new SET command is used on SERVER1, SERVER2 immediately picks up the latest value.
This issue doesn't occur if, on the ""test"" key, SERVER1 executed multiple SET commands while SERVER2 was not a slave.

**Expected behavior**
After SLAVEOF command, SERVER2 should always contain identical data to SERVER1.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/462/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48jqvA,kvrocks,1015983040,462,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-01-19T01:13:24Z,2022-01-19T01:13:24Z,@shangxiaoxiong is it related with your findings?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48jqvA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48ju-1,kvrocks,1016000437,462,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-19T01:48:10Z,2022-01-19T01:48:10Z,"@ShooterIT Kvrocks didn't check the batch content of the same RocksDB sequence, so when SERVER1 and SERVER2 have the same sequence but the content was different cannot trigger the full sync.

The simple workaround can compare the latest batch content when the psync was ok, but it still has flaw.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48ju-1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48jwe7,kvrocks,1016006587,462,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-01-19T02:02:26Z,2022-01-19T02:02:26Z,"Oh, i remembered. Yes, current `dbname` check is not enough. I add this job into 3.0 project https://github.com/KvrocksLabs/kvrocks/projects/2#card-73962066 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48jwe7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48jx5_,kvrocks,1016012415,462,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-01-19T02:13:54Z,2022-01-19T02:13:54Z,"> Oh, i remembered. Yes, current dbname check is not enough. I add this job into 3.0 project

Is this the problem we have communicated before? @ShooterIT 

Are we considering adding a new DB to store unique run id or other unique information that doesn't need to be synchronized? @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48jx5_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48jzlz,kvrocks,1016019315,462,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-19T02:27:26Z,2022-01-19T02:27:26Z,"> > Oh, i remembered. Yes, current dbname check is not enough. I add this job into 3.0 project
> 
> Is this the problem we have communicated before? @ShooterIT
> 
> Are we considering adding a new DB to store unique run id or other unique information that doesn't need to be synchronized? @git-hulk

I think we can write it to the config file instead of a new DB, persist to propagate column was fine to me.

@ShooterIT unique id cannot fully resolve this issue, since the same sequence may have different batch content. 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48jzlz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j1R2,kvrocks,1016026230,462,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-01-19T02:44:26Z,2022-01-19T02:44:26Z,"> Use unique run id as replication identifier instead of db name

this means the unique id exists with one special replication, so unique id will be changed when changing replication relationship. The unique id identifies the **replication history** .

 > the same sequence may have different batch content

In this case, if using unique run id as replication identifier, it won't think partially resynchronization is possible.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j1R2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j2HM,kvrocks,1016029644,462,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-19T02:53:31Z,2022-01-19T02:53:31Z,"We can see reproduce steps:

```
SERVER2: SLAVEOF SERVER1
SERVER2: SLAVEOF NO ONE
SERVER2: SET test 222
SERVER1: SET test 111
SERVER2: SLAVEOF SERVER1
SERVER2: GET test
```
the first step would sync the unique id, then we set the SERVER1 and SERVER2 without replication, so the SERVER1 and SERVER2 would have the same sequence(said 1 here), finally we re-slaveof again, the SERVER1 unique id should be same with the SERVER2? and psync is ok. Collect me if I miss something.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j2HM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j2jX,kvrocks,1016031447,462,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-01-19T02:58:11Z,2022-01-19T02:58:11Z,"```
SERVER2: SLAVEOF SERVER1 --- use server1 replication id
SERVER2: SLAVEOF NO ONE --- generate new replication id
SERVER2: SET test 222
SERVER1: SET test 111
SERVER2: SLAVEOF SERVER1 --- different replication id, psync is not possible
SERVER2: GET test
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j2jX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j22P,kvrocks,1016032655,462,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-01-19T03:01:11Z,2022-01-19T03:01:11Z,"```
    /* Is the replication ID of this master the same advertised by the wannabe
     * slave via PSYNC? If the replication ID changed this master has a
     * different replication history, and there is no way to continue.
     *
     * Note that there are two potentially valid replication IDs: the ID1
     * and the ID2. The ID2 however is only valid up to a specific offset. */
    if (strcasecmp(master_replid, server.replid) &&
        (strcasecmp(master_replid, server.replid2) ||
         psync_offset > server.second_replid_offset))
```
Redis code, FYI","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j22P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j4_I,kvrocks,1016041416,462,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-01-19T03:19:47Z,2022-01-19T03:19:47Z,"cool, so `slaveof no one` would generate new unique id, right? it makes sense since it would NOT cause full replication too frequently.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM48j4_I/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5B7dnG,kvrocks,1106106822,462,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-04-22T07:30:26Z,2022-04-22T07:30:26Z,"Hi @DenizPiri I submit a commit to solve this problem, please have a look.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5B7dnG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/478,https://api.github.com/repos/apache/kvrocks/issues/478,kvrocks,1129323532,478,Is it possible to send log output to system out instead of file?,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-02-10T01:56:27Z,2022-05-29T11:07:17Z,"### Discussed in https://github.com/KvrocksLabs/kvrocks/discussions/477

<div type='discussions-op-text'>

<sup>Originally posted by **djotanov** February 10, 2022</sup>
Is it possible to send kvrocks logging output to system out instead of file?
This is needed in docker environment. </div>","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/478/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-YAzt,kvrocks,1046482157,478,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-21T05:13:54Z,2022-02-21T05:13:54Z,"https://github.com/google/glog/pull/790 has supported logging to stdout, but need to wait for release.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-YAzt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/484,https://api.github.com/repos/apache/kvrocks/issues/484,kvrocks,1137188746,484,Support for replica-announce-ip and replica-announce-port,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-02-14T11:50:18Z,2023-03-09T16:35:14Z,"### Discussed in https://github.com/KvrocksLabs/kvrocks/discussions/481

<div type='discussions-op-text'>

<sup>Originally posted by **djotanov** February 13, 2022</sup>
In docker/kubernetes, instances don't have a fixed up. When working with dynamic IPs, sentinel will not work, unless kvrocks can be configured to announce DNS address of the instance (and mapped port if needed).
Does kvrocks support `replica-announce-ip' and 'replica-announce-port` properties (couldn't see them in config file)?
Redis support these since 3.2 version.</div>","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/484/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/484,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XKXKL,kvrocks,1462334091,484,NA,paragor,31911894,Egor,,NA,2023-03-09T16:09:57Z,2023-03-09T16:09:57Z,done via https://github.com/apache/incubator-kvrocks/pull/1303,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XKXKL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/485,kvrocks,1139419850,485,[NEW] Support to call Lua script by name like stored procedures,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2022-02-16T01:36:46Z,2024-10-04T16:07:06Z,"**The problem/use-case that the feature addresses**

Redis issue: https://github.com/redis/redis/issues/8693
Redis PR: https://github.com/redis/redis/pull/9780

Provide a way to make scripts similar with stored procedures, it is not convenient to use SHA as a function name to call

**Description of the feature**

Current status:
-  Support to persist all lua scripts in Kvrocks, so scripts is not client cache
- Support to replicate lua scripts between master and replicas
- Also support to replicate the change of executing lua scripts

So the most important things is that we provide a way to **set lua script name and call it by its name**.

**Alternatives you've considered**

_NULL_

**Additional information**

Don't need to support multi engines, since currently for most users, lua script is enough, importantly, we should provide a mechanism like stored procedures

We need to make this mechanism compatible with lua script implementation, don't break old usages.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/485/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-Y44Y,kvrocks,1046711832,485,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-21T10:23:40Z,2022-02-21T10:23:40Z,"I have an idea for this issue that we can recognize SHA or literal name with the name length.

* For creating, when the name length was equal to 40 chars, use it directly as raw function name, or hash(name) to fixed 40 chars.
* For looking, when the name length was 40, use it as key directly, or use hash(name) as key.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-Y44Y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-kHSv,kvrocks,1049654447,485,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-02-24T09:26:59Z,2022-02-24T09:26:59Z,"###  How to set scripts name
We can set scripts name when calling SCRIPTS LOAD.
`SCRIPTS LOAD $scripts [NAME $name]`

Also we can support set  sha of scripts to new name
`SCRIPTS  SETNAME $name SHA $scripts_sha`

Also can support rename of scripts name
`SCRIPTS  SETNAME $name NAME $scripts_name`

### How to call scripts by name
New command to call scripts by name
`EVALCALL $scripts_name(can 40 char)`

We call can support call scripts by name by EVALSHA, but name MUST NOT be 40 char
`EVALSHA $name(must not 40 char)`
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-kHSv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-kI86,kvrocks,1049661242,485,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-02-24T09:34:44Z,2022-02-24T09:34:44Z,"also can set script name in EVAL command
change 
`EVAL script numkeys key [key …] arg [arg …]`
into
`EVAL script [NAME $name] numkeys key [key …] arg [arg …]`

in EVAL command, numkeys(a number) always is necessary, so we can distinguish `[NAME $name] ` with `numkeys`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-kI86/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-lbEu,kvrocks,1049997614,485,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-24T15:51:25Z,2022-02-24T15:51:25Z,"cool, I think we don't need to limit the length of name. We can still use the fixed 40 chars as script key name, and the name if not 40 chars or use it as key directly. So we can determine whether need to hash the script name or not before lookup script.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-lbEu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-nBS6,kvrocks,1050416314,485,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-02-25T01:06:48Z,2022-02-25T01:06:48Z,"> We call can support call scripts by name by EVALSHA, but name MUST NOT be 40 char
> EVALSHA $name(must not 40 char)

oh, yes, can be 40 char, but we should search sha firstly, and if not find, then call it as name","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-nBS6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EQzWT,kvrocks,1145255315,485,NA,taylorchu,422998,taylorchu,,NA,2022-06-02T19:29:07Z,2022-06-02T19:29:07Z,"> ERR NOSCRIPT No matching script. Please use EVAL

while I try to integrate kvrocks with existing redis integration tests, I see this error. does kvrocks currently store the lua scripts?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EQzWT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ERmAc,kvrocks,1145462812,485,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-03T00:13:02Z,2022-06-03T00:13:02Z,"@taylorchu Yes, Kvrocks does store and propagate scripts now, what errors you occurred, can you paste the error or reproduce steps?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ERmAc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ER-ky,kvrocks,1145563442,485,NA,taylorchu,422998,taylorchu,,NA,2022-06-03T04:03:26Z,2022-06-03T04:03:26Z,"it is a protocol-related issue from lua script from calling evalsha:

the application will first use evalsha to see if script is cached. if it is not cached, then retry with eval. however the library I used (go-redis) requires NOSCRIPT error string to be formatted in certain way.

redis: NOSCRIPT No matching script. Please use EVAL.
kvrocks: ERR NOSCRIPT No matching script. Please use EVAL","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ER-ky/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ER_pX,kvrocks,1145567831,485,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-03T04:13:15Z,2022-06-03T04:13:15Z,"Oooop, sorry to hear that. We should keep those messages consistent as possible as we can. You can help to submit a issue and PR is always welcomed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ER_pX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Pj9qU,kvrocks,1334827668,485,NA,FZambia,1196565,Alexander Emelin,frvzmb@gmail.com,NA,2022-12-02T06:47:31Z,2022-12-02T06:47:31Z,Also came across the problem mentioned in https://github.com/apache/incubator-kvrocks/issues/485#issuecomment-1145563442 with another library in Go ecosystem - it's not possible to use Lua in kvrocks. I looked through the code where NOSCRIPT is used in kvrocks but have not found obvious way to fix this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Pj9qU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PkE98,kvrocks,1334857596,485,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-02T07:31:21Z,2022-12-02T07:31:21Z,"Hi @FZambia `go-redis` has compatible with this error message for Kvrocks, can see [error.go#L23](https://github.com/go-redis/redis/blob/4bda6ec2fb4a836bbffc0032ad3a0f2f79528ccb/error.go#L23).

So you can upgrade your library to https://github.com/go-redis/redis/releases/tag/v9.0.0-rc.2, or copy out the `Run` and `HasErrorPrefix` functions to your codebase if you don't wanna do that.

I'm very surprised and grateful for the help from @vmihailenco.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PkE98/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PkF1t,kvrocks,1334861165,485,NA,FZambia,1196565,Alexander Emelin,frvzmb@gmail.com,NA,2022-12-02T07:36:48Z,2022-12-02T07:36:48Z,"@git-hulk thanks, I am using another library, of course I can do any kind of hack in my final app - but just emphasising that kvrocks will have this issue with many libraries until error message will be consistent with one in Redis. There are several more Redis libraries in Go ecosystem I know outside `go-redis` which won't work due to the `ERR ` prefix for noscript error.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PkF1t/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PkGym,kvrocks,1334865062,485,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-02T07:42:36Z,2022-12-02T07:42:36Z,"@FZambia Yes, we will also fix this issue on Kvrock's side soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PkGym/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OrS-R,kvrocks,2393714577,485,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2024-10-04T13:30:11Z,2024-10-04T13:30:11Z,@git-hulk @PragmaTwice do we support this feature now? I remember we have something related to this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OrS-R/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/485,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OsgCo,kvrocks,2394030248,485,NA,PragmaTwice,20042607,Twice,,NA,2024-10-04T16:07:06Z,2024-10-04T16:07:06Z,Yeah Kvrocks has supported Redis Functions now.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OsgCo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/486,https://api.github.com/repos/apache/kvrocks/issues/486,kvrocks,1139868277,486,[BUG] phpredis: Can't communicate with any node in the cluster,xuzhenjun130,4453516,Sherman Xu,xuzhenjun@gmail.com,CLOSED,2022-02-16T11:07:36Z,2022-02-17T06:07:41Z,"**Describe the bug**
php客户端无法使用 kvrocks 集群
> https://github.com/phpredis/phpredis
报错：Can't communicate with any node in the cluster

 - OS: [Centos 7]
 - kvrocks [2.0.6] 编译
 - phpredis[ 5.1.1]
 - php: [7.4]


**To Reproduce**
Steps to reproduce the behavior:
1. 运行集群配置脚本：tools/try_cluster/try_cluster.sh
2. php代码：
```php
<?php
$config = [
    '192.168.100.244:30001',
    '192.168.100.244:30002',
    '192.168.100.244:30003',
    '192.168.100.244:30004',
    '192.168.100.244:30005',
    '192.168.100.244:30006',
];
$redis = new \RedisCluster(null,$config);

for ($i=0; $i< 10; $i++){
    $rs = $redis->set('name:'.$i, $i);
    $data = $redis->get('name:'.$i);
    var_dump($data);
}
```
运行以上php代码报错：Can't communicate with any node in the cluster

**Expected behavior**
上面的php代码，在 `tendis`  cluster 集群测试通过，无异常

kvrocks 集群信息：
```bash
192.168.100.244:30001> cluster nodes
kvrockskvrockskvrockskvrockskvrocksnode6 127.0.0.1:30006@40006 slave kvrockskvrockskvrockskvrockskvrocksnode5 1645008141999 1645008142000 1 connected
kvrockskvrockskvrockskvrockskvrocksnode5 127.0.0.1:30005@40005 master - 1645008141999 1645008142000 1 connected 10993-16383
kvrockskvrockskvrockskvrockskvrocksnode3 127.0.0.1:30003@40003 master - 1645008141999 1645008142000 1 connected 5461-10992
kvrockskvrockskvrockskvrockskvrocksnode4 127.0.0.1:30004@40004 slave kvrockskvrockskvrockskvrockskvrocksnode3 1645008141999 1645008142000 1 connected
kvrockskvrockskvrockskvrockskvrocksnode2 127.0.0.1:30002@40002 slave kvrockskvrockskvrockskvrockskvrocksnode1 1645008141999 1645008142000 1 connected
kvrockskvrockskvrockskvrockskvrocksnode1 127.0.0.1:30001@40001 myself,master - 1645008141999 1645008142000 1 connected 0-5460
192.168.100.244:30001> keys *
(empty list or set)
192.168.100.244:30001> set name hello
(error) MOVED 5798 127.0.0.1:30003
192.168.100.244:30001> get name
(error) MOVED 5798 127.0.0.1:30003
192.168.100.244:30001> exit
root@DESKTOP-LJ4P7IV:/www/crm2.910app.com# redis-cli -h 192.168.100.244 -p 30003
192.168.100.244:30003> get name
(nil)
192.168.100.244:30003> set name hello
OK
192.168.100.244:30003> get name
""hello""
```



另外，kvrocks 是否支持双主配置，如何配置？
目前业务使用ssdb，数据量30G还不算太大，估计迁移到kvrocks还能再用几年，不需要使用集群架构


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/486/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/486,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-Emyi,kvrocks,1041394850,486,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-02-16T11:33:05Z,2022-02-16T11:33:05Z,"IP 地址改为 127.0.0.1 试试，try_cluster.sh 默认 bind 127.0.0.1了
```php
$config = [
    '127.0.0.1:30001',
    '127.0.0.1:30002',
    '127.0.0.1:30003',
    '127.0.0.1:30004',
    '127.0.0.1:30005',
    '127.0.0.1:30006',
];
```
不支持双主配置","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-Emyi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/486,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-Iz-R,kvrocks,1042497425,486,NA,xuzhenjun130,4453516,Sherman Xu,xuzhenjun@gmail.com,NA,2022-02-17T02:11:08Z,2022-02-17T02:11:08Z,"ok，改成 127.0.0.1 正常了。
之前我改了 `tools/try_cluster/default.conf`  中 把绑定ip 改成了 0.0.0.0， 没想到 try_cluster.sh 里面还有ip设置

另外吐槽一下，kvrocks 的文档太少了。

https://github.com/KvrocksLabs/kvrocks/wiki/Kvrocks-%E9%9B%86%E7%BE%A4%E6%96%B9%E6%A1%88%E7%AE%80%E4%BB%8B

集群介绍这里的示例格式并不能直接去执行，建议修改一下
```
CLUSTERX SETNODES
  ""67ed2db8d677e59ec4a4cefb06858cf2a1a89fa1 127.0.0.1 30002 master - 5461-10922 16380 16383
    07c37dfeb235213a872192d90877d0cd55635b91 127.0.0.1 30004 slave 67ed2db8d677e59ec4a4cefb06858cf2a1a89fa1""
  1
```
- `CLUSTERX SETNODES` 后面没有换行
- 不能进入redis-cli 里面再执行，必须在外面 `redis-cli -h 127.0.0.1 -p 30001 clusterx setnodes ""节点配置，一行一个""  1`

不看try_cluster.sh  根本不知道

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-Iz-R/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/486,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-I0NZ,kvrocks,1042498393,486,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-17T02:13:12Z,2022-02-17T02:13:12Z,"@xuzhenjun130 如果是不需要集群模式就可以不用 enable cluster，直接使用 Master-Slave 方式，跟 Redis  使用几乎是一模一样
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-I0NZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/486,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-I2mT,kvrocks,1042508179,486,NA,xuzhenjun130,4453516,Sherman Xu,xuzhenjun@gmail.com,NA,2022-02-17T02:33:47Z,2022-02-17T02:33:47Z,"@git-hulk   
主从这个明白。只是我们原来使用ssdb，部分业务把ssdb当成数据库在用了，两地机房，所以配置的是双主架构。
不改业务代码的情况下，不能使用主从","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-I2mT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/486,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-JOoD,kvrocks,1042606595,486,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-02-17T06:07:40Z,2022-02-17T06:07:40Z,"> 之前我改了 tools/try_cluster/default.conf 中 把绑定ip 改成了 0.0.0.0， 没想到 try_cluster.sh 里面还有ip设置z

这个脚本参考了 Redis create cluster，这里 Redis 实现是一样的

Kvrocks 当前是几个爱好者在工作之外维护的，人力有限，很多地方需要靠大家一起建设，也非常欢迎你为 Kvrocks 完善文档。

cluster setnodes 中 node_info 每一行设置一个node信息，我忘了写了，已修改，谢谢指出
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-JOoD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/487,kvrocks,1139972760,487,[BUG] Transaction can't guarantee atomicity,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2022-02-16T12:44:24Z,2023-03-04T14:19:18Z,"**Describe the bug**
The exclusive guard lock ensures you run the transaction in isolation, but it cannot guarantee the atomicity of the EXEC stage.
You would like to either have all commands applied to the db or none of them applied.
However, if some commands are executed and persisted to rocksdb and the process fails before the tx completes the db sees an intermediate state which is not desired.

**Expected behavior**
Guarantee the atomicity and consistency.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/487/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-FO3r,kvrocks,1041559019,487,NA,Eshcar,4384969,Eshcar Hillel,,NA,2022-02-16T14:38:31Z,2022-02-16T14:38:31Z,"Thanks for opening this issue @ShooterIT 
As of late 2021 [RocksDB supports transactions](https://github.com/facebook/rocksdb/wiki/Transactions) , such that no other threads can see the changes in a transaction until it has been committed.
I didnt check the code yet but I assume they already take care of consistency also in case of a failure during the commit phase.

I suggest to use the API they are providing.
This would also allow you to remove the global lock you are using to protect the EXEC stage.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-FO3r/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-I65b,kvrocks,1042525787,487,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-02-17T03:11:19Z,2022-02-17T03:11:19Z,"Thanks @Eshcar Yes, i know RocksDB supports, but i worry transaction db would break kvrocks db usage, I will rethink it.
BTW, initially we just want to implement transaction like Redis","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-I65b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-KZzr,kvrocks,1042914539,487,NA,Eshcar,4384969,Eshcar Hillel,,NA,2022-02-17T12:47:19Z,2022-02-17T12:47:19Z,"@ShooterIT - can you demonstrate a problematic scenario that will break other kvrocks commands when using rocksdb txs?
I would be happy to assist in understanding these cases.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-KZzr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-4N5c,kvrocks,1054924380,487,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-03-01T02:33:51Z,2022-03-01T02:33:51Z,"@Eshcar Sorry for the slow reply.

Currently, kvrocks directly access `db` when reading data from db, and write a `writebatch` when writing data. It doesn't care about rocksdb txs, if we want to use rocksdb txs, there are too many places that is needed to change. And in some places, we directly access DB for checkpoint, WAL..., So i am not sure we could use  transaction db easily. If you have ideas, welcome to discuss.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-4N5c/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_BbMA,kvrocks,1057338112,487,NA,Eshcar,4384969,Eshcar Hillel,,NA,2022-03-02T20:16:11Z,2022-03-02T20:16:11Z,"Indeed, supporting tx atomicity will create changes to many kvrocks files, if not all. But it has the potential of improving the quality of the code. 

Here is my suggestion. At the core of it is the principle of encapsulation: 
1. db_ and storage_ fields of Database class should be private, and not be visible/accessible to all inheriting classes.
2. Database should include an abstract DbHandler that is responsible for calling db_ and storage_ methods.
3. SimpleDBHandler and TxDBHandler inherit from DbHandler and implement its API. 
4. When a redis command object is created its dbHandler is set (after calling the c-tor), according to the context. 
5. When running simple commands – set simpleDBHandler; when running a tx, all queued commands in the multi phase are set w the **same** txDBhandler. 

This is the list of methods that reference db_ or storage_ and need to be covered by the handler: 
db_: 
1. LatestSnapShot ss(db_) 
2. db_->Get(...) 
3. db_->NewIterator(…) 

storage_: 
1. LockGuard guard(…) 
2. batch.Put(…) 
3. storage_->Write() 
4. storage_->GetLockManager() 
5. storage_->Delete() 
6. storage_->IsSlotIdEncoded() 
7. storage_->DeleteRange() 

Maybe there are some more methods that I missed. 

An example usage of the dbHandler would be: 
[Examples of how to replace the code in inheriting commands, and how to implement the methods:] 

- [ ] Replace db_->Get() with a dbHandler->get() 
* SimpleDbHandler implements this by db_->Get() 
* TxDbHandler implement this by txn_db->Get(), where txn_db is opened by TransactionDB::Open when the transaction begins.  

- [ ] Replace batch.put() with dbHandler->batchPut() 
* SimpleDbHandler implements this by batch.put(), where the batch is only used by this command 
* TxDbHandler implement this by txn_db->Put(), where the same batch is used by all queued command 

- [ ] Replace storage_->Write() with dbHandler->write() 
* SimpleDbHandler implements this by storage_->Write() 
* TxDbHandler implement this by txn->Commit(), where txn is created by txn_db->BeginTransaction(), when the tx begins. 

So the code and flow for commands is similar to the current code, the only difference is how specific calls are handled at the db_ level based on the context (tx or simple). 

Do you see any inherent limitation in this suggestion? (except for the fact that it requires major refactoring of the code). ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_BbMA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AF0IH,kvrocks,1075266055,487,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-03-22T14:39:15Z,2022-03-22T14:39:15Z,"Impressive idea, truly thanks @Eshcar 

Recently, I always thought that, it will be really cool to support ACID transaction for KV NoSql. Even I  also want to support interactive transaction, and we can support more features transaction, such as optional sync, isolation level.
```
MULTI sync yes/no  isolation  ReadCommitted/RepeatableRead
xxx
xxx
EXEC
```
sync: we call fsync after transactions, i.e. truly guarantee data persistent in disk
isolation: we can easily implement different isolation using rocksdb capacity, of course, we don't support this in the first version.

For code refactor of storage, i ever had a big idea, i think it is not good to directly access `db_(pointer of RocksDB)` in different data type implementation(redis_zset.cc, redis_hash.cc...), we should not expose it. I think we should provide some simple interfaces in storage layer. such as Put(support multi keys), Get(support multi keys),Del(support multi keys),  RangeRead, RangeDelete. Data type implementation layer just call these functions, and we could easily change these function implementation even we can change different storage engine. Of course, we need to change too many places.

Your suggested method is much accessible i think, though it also breaks many places.  Recently, i may don't have enough spare time to do this job, i think you can have a try if you want.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AF0IH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXiME,kvrocks,1079911172,487,NA,Eshcar,4384969,Eshcar Hillel,,NA,2022-03-27T11:33:54Z,2022-03-27T11:33:54Z,"Thanks @ShooterIT 
I do not have the capacity to implement/test/benchmark this solution.  
I would be happy to work with/guide anyone from the community that is willing to implement this change. 
Let me update soon if I can allocate alternative resources for this effort. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXiME/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WJu4s,kvrocks,1445391916,487,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-26T15:40:52Z,2023-02-26T15:40:52Z,"Hi, @Eshcar @ShooterIT I have an idea to workaround this bug. We can add a new function to create a shared WriteBatch for the Multi-Exec command like the below:

```C++
Status Storage::Begin() {
    is_txn_mode = true;
    txn_write_batch = make_shared<*rocksdb::WriteBatch>();
}

rocksdb::WriteBatch *Storage::GetWriteBatch() {
   if (is_txn_mode) {
      return txn_write_batch.get();
   }
   return make_shared<*rocksdb::WriteBatch>();
}

Status Storage::Commit() {
    is_txn_mode = false;
    // write txn WriteBatch to RocksDB
    txn_write_batch.reset();
}
```

For the Command Exec, we need to explicitly call the `Begin()` and  `Commit()` to enter and leave the transaction mode. So that Kvrocks will create a new WriteBatch for each writes operation if it's NOT in transaction mode, and use the shared WriteBatch to collect all write operations if it's in the transaction mode.


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WJu4s/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKPQm,kvrocks,1445524518,487,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2023-02-27T00:49:27Z,2023-02-27T00:49:27Z,"it is limited, in transaction, there also are some reading operations, we also hope we can read committed writing operations, maybe you can implement searching WAL(rocksdb supports it) to support this feature, but we can't resolve conflicts when we commit transaction. so i prefer to just use rocksdb transaction to implement real transaction.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKPQm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKXm6,kvrocks,1445558714,487,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-27T02:00:10Z,2023-02-27T02:00:10Z,"Yes, RocksDB also supports the `WriteBatchWithIndex` to implement the Read-Your-Own-Write feature, but it needs to involve all read operations, so I didn't plan to do it in the current stage. Does it make sense to make write operations atomic first, then involve read operations?

Refer: https://rocksdb.org/blog/2015/02/27/write-batch-with-index.html","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKXm6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKa3d,kvrocks,1445572061,487,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2023-02-27T02:17:20Z,2023-02-27T02:17:20Z,"but if you don't commit write(pending in `txn_write_batch`), you can't Read-Your-Own-Write in normal mode.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKa3d/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKdo7,kvrocks,1445583419,487,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-27T02:30:21Z,2023-02-27T02:30:21Z,"@ShooterIT Do you mean `WriteBatchWithIndex` can only be used in transaction mode? I see the [MongoDB](https://github.com/mongodb/mongo/blob/a31cc114a89a3645e97645805ba77db32c433dce/src/mongo/db/storage/rocks/rocks_recovery_unit.cpp#L245-L260) will search the `txn_write_batch` first if exists then from the DB, so it should work if it can be used in the normal model. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKdo7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKnOM,kvrocks,1445622668,487,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2023-02-27T03:07:59Z,2023-02-27T03:07:59Z,"> RocksDB also supports the WriteBatchWithIndex to implement the Read-Your-Own-Write feature, but it needs to involve all read operations, so I didn't plan to do it in the current stage

You said you don't want to use `WriteBatchWithIndex` currently, so you can't Read-Your-Own-Write. if you use it , of course, it can.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKnOM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKp_f,kvrocks,1445634015,487,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-27T03:22:10Z,2023-02-27T03:22:10Z,"oh...I got your point now. What I mean is to implement the atomic write operations first, then involves read operations at the next stage.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WKp_f/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WRnJh,kvrocks,1447457377,487,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2023-02-28T02:06:20Z,2023-02-28T02:06:20Z,"you shouldn't ask developers not have  Read-Your-Own-Write operations in transactions,
```
set a b
multi
set a c
get a  // if you don't commit write batch, you will get `b` instead of `c`.
set xxx yyy
...
exec
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WRnJh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WRtvf,kvrocks,1447484383,487,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-28T02:42:59Z,2023-02-28T02:42:59Z,"@ShooterIT Yes, we cannot require users to avoid this, what I mean is to separate them into two PRs to make the code review simple. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WRtvf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/488,https://api.github.com/repos/apache/kvrocks/issues/488,kvrocks,1144594404,488,[NEW] Supports to configure the rocksdb advance option max_bytes_for_level_base,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-02-19T07:50:36Z,2023-03-18T01:28:04Z,"As users may want to control the maximum data size for a level,
we can export the option `max_bytes_for_level_base`(the max total for level-1)
in our config file and allow to modify the value in-flight with `config set`.

For more detail can see: https://github.com/facebook/rocksdb/blob/main/include/rocksdb/options.h#L271","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/488/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/488,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5X5A0a,kvrocks,1474563354,488,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-03-18T01:28:04Z,2023-03-18T01:28:04Z,Closed by #497.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5X5A0a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/489,https://api.github.com/repos/apache/kvrocks/issues/489,kvrocks,1144675295,489,[BUG] kvrocks2redis was unable to sync to other Kvrocks's namespaces except default,xyxu,3735758,xyxu,,OPEN,2022-02-19T11:55:23Z,2022-02-24T06:58:01Z,"redis_writer.cc:115] [kvrocks2redis] CRITICAL - redis sync return error , administrator confirm needed : -administor permission required to perform the command","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/489/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/489,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-WMjr,kvrocks,1046005995,489,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-19T12:22:55Z,2022-02-19T12:22:55Z,"Yes, thanks for your feedback. We should use `flushdb` instead of `flushall` when flushing the target db.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-WMjr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/489,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-bwae,kvrocks,1047463582,489,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-02-22T06:20:37Z,2022-02-22T06:20:37Z,I'll fix it as soon as possible.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-bwae/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/489,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-jt6p,kvrocks,1049550505,489,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-02-24T06:58:01Z,2022-02-24T06:58:01Z,"What @git-hulk  mentioned is indeed a problem, but I don't think it is the cause of your problem. Can you provide more information (Your `kvrocks2redis` configuration; Your behavior at the `Kvrocks`) @xyxu ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-jt6p/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/490,https://api.github.com/repos/apache/kvrocks/issues/490,kvrocks,1145438783,490,[BUG] kvrocks2redis was unable to migrate data from standalone to cluster mode,xuzhenjun130,4453516,Sherman Xu,xuzhenjun@gmail.com,CLOSED,2022-02-21T07:52:18Z,2022-07-30T05:02:17Z,"**Describe the bug**

Encounter error when migrating from standalone to cluster：
E0221 15:33:49.522202 26474 sync.cc:66] [kvrocks2redis] CRITICAL - Failed to psync , please remove last_next_seq config file, and restart kvrocks2redis, redis reply: -ERR sequence out of range, please use fullsync

 - OS: [Centos 7]
 - Version [2.0.6]

**To Reproduce**

1. setup standalone instance: `./src/kvrocks -c kvrocks.conf`
2. setup cluster instances: `sh try_cluster.sh start`

```
kvrockskvrockskvrockskvrockskvrocksnode6 127.0.0.1:30006@40006 slave kvrockskvrockskvrockskvrockskvrocksnode5 1645429487999 1645429488000 1 connected
kvrockskvrockskvrockskvrockskvrocksnode5 127.0.0.1:30005@40005 master - 1645429487999 1645429488000 1 connected 10993-16383
kvrockskvrockskvrockskvrockskvrocksnode3 127.0.0.1:30003@40003 master - 1645429487999 1645429488000 1 connected 5461-10992
kvrockskvrockskvrockskvrockskvrocksnode4 127.0.0.1:30004@40004 slave kvrockskvrockskvrockskvrockskvrocksnode3 1645429487999 1645429488000 1 connected
kvrockskvrockskvrockskvrockskvrocksnode2 127.0.0.1:30002@40002 slave kvrockskvrockskvrockskvrockskvrocksnode1 1645429487999 1645429488000 1 connected
kvrockskvrockskvrockskvrockskvrocksnode1 127.0.0.1:30001@40001 myself,master - 1645429487999 1645429488000 1 connected 0-5460
```
3. Bulk load some test data sets
4.  tools/kvrocks2redis/kvrocks2redis.conf
```conf

################################ GENERAL #####################################

# The value should be INFO, WARNING, ERROR, FATAL
# default is INFO
loglevel INFO

# By default kvrocks2redis does not run as a daemon. Use 'yes' if you need it.
# Note that kvrocks2redis will write a pid file in /var/run/kvrocks2redis.pid when daemonized.
daemonize no

# The working directory
#
# The kvrocks node db directory
# Note that you must specify a directory here, not a file name.
data-dir ./data

# Intermediate files are output to this directory when the kvrocks2redis program runs
#
output-dir ./

# Sync kvrocks node. Use the node's Psync command to get the newest wal raw write_batch
#
# kvrocks <kvrocks_ip> <kvrocks_port> [<kvrocks_auth>]
kvrocks 127.0.0.1 6666

# Enable cluster mode.
#
# Default: yes
cluster-enable yes

################################ NAMESPACE AND Sync Target Redis #####################################
# namespace.{namespace} <redis_ip> <redis_port> [<auth> <db_number>]
#
# Default db_number is 0
namespace.__namespace 127.0.0.1 30001
namespace.__namespace 127.0.0.1 30002
namespace.__namespace 127.0.0.1 30003
namespace.__namespace 127.0.0.1 30004
namespace.__namespace 127.0.0.1 30005
namespace.__namespace 127.0.0.1 30006

```
5. Setup kvrocks2redis : ../../src/kvrocks2redis -c kvrocks2redis.conf

Error：[kvrocks2redis] CRITICAL - Failed to psync , please remove last_next_seq config file, and restart kvrocks2redis, redis reply: -ERR sequence out of range, please use fullsync



https://github.com/KvrocksLabs/kvrocks/wiki/Kvrocks-%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/490/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/490,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-YsrO,kvrocks,1046661838,490,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-21T09:37:32Z,2022-02-21T09:37:32Z,kvrocks2redis was NOT supported to migrate data kvrocks cluster directly,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-YsrO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/490,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-2K,kvrocks,1200090506,490,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-30T05:02:17Z,2022-07-30T05:02:17Z,I think we can close this issue since it's no active now. Free feel to reopen if you need.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-2K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/491,https://api.github.com/repos/apache/kvrocks/issues/491,kvrocks,1146309232,491,[BUG] It doesn't work with ipv6?,MrYawe,8686039,Yannis Weishaupt,yannis@hey.com,CLOSED,2022-02-21T23:34:10Z,2022-05-14T03:27:39Z,"I'm trying to make kvrocks works with an ipv6 address on https://fly.io

**To Reproduce**
Here is my Dockerfile :
```dockerfile
FROM kvrocks/kvrocks:v2.0.6

RUN sed -i ""s|bind 0.0.0.0|bind ::|g"" ./conf/kvrocks.conf
```

```bash
# lsof -i -P -n | grep LISTEN
kvrocks  523 root   16u  IPv4   4450      0t0  TCP *:6666 (LISTEN)
kvrocks  523 root   21u  IPv4   4452      0t0  TCP *:6666 (LISTEN)
kvrocks  523 root   26u  IPv4   4454      0t0  TCP *:6666 (LISTEN)
kvrocks  523 root   31u  IPv4   4456      0t0  TCP *:6666 (LISTEN)
kvrocks  523 root   36u  IPv4   4458      0t0  TCP *:6666 (LISTEN)
kvrocks  523 root   41u  IPv4   4460      0t0  TCP *:6666 (LISTEN)
kvrocks  523 root   46u  IPv4   4462      0t0  TCP *:6666 (LISTEN)
kvrocks  523 root   51u  IPv4   4464      0t0  TCP *:6666 (LISTEN)
```

**Expected behavior**
Kvrocks should listen on `IPv6 TCP *:6666`
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/491/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/491,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-bXRu,kvrocks,1047360622,491,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-22T02:14:08Z,2022-02-22T02:14:08Z,"Yes, kvrocks don't support ipv6 address now, we can support it on the next release. PR is always welcome!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-bXRu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/492,kvrocks,1146586732,492,[BUG] Kvrocks could not swich databases,yorkane,11476816,Kevin Yuan,whyork@qq.com,CLOSED,2022-02-22T08:15:19Z,2023-06-09T06:25:03Z,"**Describe the bug**
Kvrocks could not swich databases, any database key-value changes effect to all-other databases;

 - OS: Ununtu 20.04 /docker
 - Version 2.06/2.05

**To Reproduce**
Steps to reproduce the behavior:
1.  select 1 -> set t 1 -> get t -> ""1""
2.  select 2 -> get t -> ""1""

**Expected behavior**
database-1 key-value should not exist in database-2

```
127.0.0.1:6666> info
# Server
version:2.0.6
git_sha1:7c23f2fe
os:Linux 5.11.0-36-generic x86_64
gcc_version:7.5.0
arch_bits:64
process_id:1
tcp_port:6666
uptime_in_seconds:1277
uptime_in_days:0
# Clients
maxclients:10000
connected_clients:2
monitor_clients:0
# Memory
used_memory_rss:26529792
used_memory_human:25.30M
used_memory_lua:36864
used_memory_lua_human:36.00K
# Persistence
loading:0
bgsave_in_progress:0
last_bgsave_time:-1
last_bgsave_status:ok
last_bgsave_time_sec:-1
# Stats
total_connections_received:514
total_commands_processed:3090
instantaneous_ops_per_sec:1
total_net_input_bytes:76505
total_net_output_bytes:3490146
instantaneous_input_kbps:0
instantaneous_output_kbps:5
sync_full:0
sync_partial_ok:0
sync_partial_err:0
pubsub_channels:0
pubsub_patterns:0
# Replication
role:master
connected_slaves:0
master_repl_offset:1175757
# CPU
used_cpu_sys:0
used_cpu_user:1
# Commandstats
cmdstat_auth:calls=514,usec=1788,usec_per_call=3
cmdstat_client:calls=511,usec=747,usec_per_call=1
cmdstat_command:calls=3,usec=1770,usec_per_call=590
cmdstat_config:calls=510,usec=82148,usec_per_call=161
cmdstat_get:calls=4,usec=148,usec_per_call=37
cmdstat_info:calls=515,usec=373014,usec_per_call=724
cmdstat_keys:calls=5,usec=1709,usec_per_call=341
cmdstat_select:calls=6,usec=16,usec_per_call=2
cmdstat_set:calls=2,usec=268,usec_per_call=134
cmdstat_slowlog:calls=1020,usec=3864,usec_per_call=3
# Keyspace
# Last scan db time: Thu Jan  1 00:00:00 1970
db0:keys=0,expires=0,avg_ttl=0,expired=0
sequence:1175757
used_db_size:51464
max_db_size:0
used_percent: 0%
disk_capacity:490651459584
used_disk_size:111368089600
used_disk_percent: 22%
# RocksDB
estimate_keys[default]:0
block_cache_usage[default]:4256
block_cache_pinned_usage[default]:480
index_and_filter_cache_usage[default]:0
level0_file_limit_slowdown[default]:0
level0_file_limit_stop[default]:0
pending_compaction_bytes_slowdown[default]:0
pending_compaction_bytes_stop[default]:0
memtable_count_limit_slowdown[default]:0
memtable_count_limit_stop[default]:0
estimate_keys[metadata]:4
block_cache_usage[metadata]:4256
block_cache_pinned_usage[metadata]:480
index_and_filter_cache_usage[metadata]:224
level0_file_limit_slowdown[metadata]:0
level0_file_limit_stop[metadata]:0
pending_compaction_bytes_slowdown[metadata]:0
pending_compaction_bytes_stop[metadata]:0
memtable_count_limit_slowdown[metadata]:0
memtable_count_limit_stop[metadata]:0
estimate_keys[zset_score]:0
block_cache_usage[zset_score]:4256
block_cache_pinned_usage[zset_score]:480
index_and_filter_cache_usage[zset_score]:0
level0_file_limit_slowdown[zset_score]:0
level0_file_limit_stop[zset_score]:0
pending_compaction_bytes_slowdown[zset_score]:0
pending_compaction_bytes_stop[zset_score]:0
memtable_count_limit_slowdown[zset_score]:0
memtable_count_limit_stop[zset_score]:0
estimate_keys[pubsub]:0
block_cache_usage[pubsub]:432
block_cache_pinned_usage[pubsub]:0
index_and_filter_cache_usage[pubsub]:0
level0_file_limit_slowdown[pubsub]:0
level0_file_limit_stop[pubsub]:0
pending_compaction_bytes_slowdown[pubsub]:0
pending_compaction_bytes_stop[pubsub]:0
memtable_count_limit_slowdown[pubsub]:0
memtable_count_limit_stop[pubsub]:0
estimate_keys[propagate]:0
block_cache_usage[propagate]:0
block_cache_pinned_usage[propagate]:0
index_and_filter_cache_usage[propagate]:0
level0_file_limit_slowdown[propagate]:0
level0_file_limit_stop[propagate]:0
pending_compaction_bytes_slowdown[propagate]:0
pending_compaction_bytes_stop[propagate]:0
memtable_count_limit_slowdown[propagate]:0
memtable_count_limit_stop[propagate]:0
all_mem_tables:7343776
cur_mem_tables:7343776
snapshots:0
num_immutable_tables:0
num_running_flushes:0
memtable_flush_pending:0
compaction_pending:1
num_running_compactions:0
num_live_versions:5
num_superversion:7
num_background_errors:0
flush_count:0
compaction_count:2
put_per_sec:0
get_per_sec:0
seek_per_sec:0
next_per_sec:0
prev_per_sec:0
is_bgsaving:no
is_compacting:no
```

```
127.0.0.1:6666> set ttt 1
OK
127.0.0.1:6666> get ttt
""1""
127.0.0.1:6666> select 2
OK
127.0.0.1:6666[2]> get ttt
""1""
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/492/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cFRO,kvrocks,1047549006,492,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-22T08:38:04Z,2022-02-22T08:38:04Z,"Yes, it's expected behavior that SELECT db was designed to compatible with Redis SDK and do nothing when executing. We can use `namespace` if wants to isolate the user data.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cFRO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cIFz,kvrocks,1047560563,492,NA,yorkane,11476816,Kevin Yuan,whyork@qq.com,NA,2022-02-22T08:52:39Z,2022-02-22T08:52:39Z,"Got it.
Any guidelines or docs for this `namespace` feature?


All I found in `kvrocks.conf` :
```
################################ NAMESPACE #####################################
# namespace.test change.me
```
How to config mutiple-user-namespace mappings?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cIFz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cIsH,kvrocks,1047563015,492,NA,yorkane,11476816,Kevin Yuan,whyork@qq.com,NA,2022-02-22T08:55:32Z,2022-02-22T08:55:32Z,"I found this wiki:
> https://github.com/KvrocksLabs/kvrocks/wiki/Namespace
how to convert auth-token-namespace into `redis://passwd@127.0.0.1:6666/1` format?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cIsH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cL9q,kvrocks,1047576426,492,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-22T09:10:37Z,2022-02-22T09:10:37Z,"Each namespace would have its password, it should work like the different instances from the user side.

connection string should like below:
```
redis://passwd@127.0.0.1:6666/0  - use password1 to connect
redis://passwd@127.0.0.1:6666/0  - use password2 to connect
```

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cL9q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cOZX,kvrocks,1047586391,492,NA,yorkane,11476816,Kevin Yuan,whyork@qq.com,NA,2022-02-22T09:21:00Z,2022-02-22T09:21:00Z,"Seems not work.
I've cleaned all the existing databases and logs, and started a new docker-instance still got: 
```
127.0.0.1:6666> namespace add ns1 token1
(error) rename file encounter error: Device or resource busy
```
Any ideas?

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cOZX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cO2K,kvrocks,1047588234,492,NA,yorkane,11476816,Kevin Yuan,whyork@qq.com,NA,2022-02-22T09:23:00Z,2022-02-22T09:23:00Z,"### kvrocks.WARNING
```
Log file created at: 2022/02/22 09:19:32
Running on machine: kevin-office-ubuntu
Log line format: [IWEF]mmdd hh:mm:ss.uuuuuu threadid file:line] msg
W0222 09:19:32.145323   108 redis_cmd.cc:111] New namespace: ns1 with token: token1, addr: 127.0.0.1:53470, result: rename file encounter error: Device or resource busy
```


### kvrocks.INFO
```
Log file created at: 2022/02/22 09:19:06
Running on machine: kevin-office-ubuntu
Log line format: [IWEF]mmdd hh:mm:ss.uuuuuu threadid file:line] msg
I0222 09:19:06.896318     1 main.cc:312] Version: 2.0.6 @7c23f2fe
I0222 09:19:07.689527     1 storage.cc:280] [storage] Success to load the data from disk: 267 ms
I0222 09:19:07.690665     1 worker.cc:338] [worker] Thread #139787216299776 started
I0222 09:19:07.690726     1 worker.cc:338] [worker] Thread #139787258263296 started
I0222 09:19:07.690768     1 worker.cc:338] [worker] Thread #139787266656000 started
I0222 09:19:07.690831     1 worker.cc:338] [worker] Thread #139787325404928 started
I0222 09:19:07.690894     1 worker.cc:338] [worker] Thread #139787317012224 started
I0222 09:19:07.690948     1 worker.cc:338] [worker] Thread #139787308619520 started
I0222 09:19:07.691004     1 worker.cc:338] [worker] Thread #139787300226816 started
I0222 09:19:07.691073     1 worker.cc:338] [worker] Thread #139787291834112 started
W0222 09:19:32.145323   108 redis_cmd.cc:111] New namespace: ns1 with token: token1, addr: 127.0.0.1:53470, result: rename file encounter error: Device or resource busy
I0222 09:20:07.743521   118 compaction_checker.cc:10] [compaction checker] Start the compact the column family: pubsub
I0222 09:20:07.743623   118 compaction_checker.cc:13] [compaction checker] Compact the column family: pubsub finished, result: OK
I0222 09:20:07.743638   118 compaction_checker.cc:10] [compaction checker] Start the compact the column family: propagate
I0222 09:20:07.743666   118 compaction_checker.cc:13] [compaction checker] Compact the column family: propagate finished, result: OK
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cO2K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cQ3c,kvrocks,1047596508,492,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-22T09:32:05Z,2022-02-22T09:32:05Z,"oooop, update namespace would rewrite the configuration file, it seems that you didn't specify and failed to rewrite the configuration file. But we should regard it as a bug that don't allow to update namespace if the configuration file was not specified.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cQ3c/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cRTe,kvrocks,1047598302,492,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-22T09:34:03Z,2022-02-22T09:34:03Z,"For the workaround, we wen can assign the configuration file with `-c` flag.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cRTe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cRhT,kvrocks,1047599187,492,NA,yorkane,11476816,Kevin Yuan,whyork@qq.com,NA,2022-02-22T09:34:58Z,2022-02-22T09:34:58Z,"Here is my current local docker-compose.yml for testing
```yaml
  kvrocks:
    image: kvrocks/kvrocks:v2.0.6
    container_name: kvrocks
    ports:
      - ""6666:6666""
    network_mode: host
    volumes:
      - ./kvrocks:/tmp/kvrocks
      - ./kvrocks.conf:/kvrocks/conf/kvrocks.conf
  kvrocks-slave:
    image: kvrocks/kvrocks:v2.0.6
    container_name: kvrocks-slave
    depends_on:
      - kvrocks
    ports:
      - ""6667:6667""
    network_mode: host
    volumes:
      - ./kvrocks-slave:/tmp/kvrocks
      - ./kvrocks-slave.conf:/kvrocks/conf/kvrocks.conf
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cRhT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cdbY,kvrocks,1047647960,492,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-22T10:27:42Z,2022-02-22T10:27:42Z,"Thanks for your feedback, I'm wrong if you're using docker. Docker should have no permission to modify files from the outside volume? ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cdbY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cfGI,kvrocks,1047654792,492,NA,yorkane,11476816,Kevin Yuan,whyork@qq.com,NA,2022-02-22T10:34:51Z,2022-02-22T10:34:51Z,"No,  Docker do have the permission to operate mapping volumes (including files). 

Unless set the `./kvrocks-slave:/tmp/kvrocks:ro` specifically.
```
echo ""### test1"" >> kvrocks.conf  # The mapping file changed instantly.
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-cfGI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_i5R-,kvrocks,1066112126,492,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-13T14:18:59Z,2022-03-13T14:18:59Z,"My bad to mislead you, kvrocks dockerfile only supported the volumn: `/var/lib/kvrocks`, so you can mount your local dir to it.

https://github.com/KvrocksLabs/kvrocks/blob/unstable/Dockerfile#L10","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_i5R-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_pypc,kvrocks,1067919964,492,NA,yorkane,11476816,Kevin Yuan,whyork@qq.com,NA,2022-03-15T12:17:42Z,2022-03-15T12:17:42Z,"> My bad to mislead you, kvrocks dockerfile only supported the volumn: `/var/lib/kvrocks`, so you can mount your local dir to it.
> 
> https://github.com/KvrocksLabs/kvrocks/blob/unstable/Dockerfile#L10

Thanks!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_pypc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eW8aK,kvrocks,1583072906,492,NA,p1u3o,38067056,Daniel,,NA,2023-06-08T17:34:49Z,2023-06-08T17:34:49Z,"I have a fork here that hacks in support for SELECT by reusing the namespace functionality, although the patch is ugly. As it goes against the design decisions taken by upstream I won't be attempting to upstream it, I only needed it to get kvrocks working with a legacy application that uses select that I don't have the source code to anymore.

https://github.com/p1u3o/incubator-kvrocks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eW8aK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eZ3nn,kvrocks,1583839719,492,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T02:16:34Z,2023-06-09T02:16:34Z,"@p1u3o Thanks for your information. For the namespace design, it should be used to separate the data between different users and you can also regard each namespace as an instance. So we don't expect to allow selecting namespace directly for security concerns.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eZ3nn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eaovA,kvrocks,1584040896,492,NA,p1u3o,38067056,Daniel,,NA,2023-06-09T06:25:03Z,2023-06-09T06:25:03Z,"> @p1u3o Thanks for your information. For the namespace design, it should be used to separate the data between different users and you can also regard each namespace as an instance. So we don't expect to allow selecting namespace directly for security concerns.

I only allow the admin account to force into another namespace via SELECT, given that they have access indirectly anyway. Would this be something acceptable upstream?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eaovA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/494,kvrocks,1146908850,494,[QUESTION] performance drops dramatically on hotkey scenario,patpatbear,10203196,patpatbear,sr_zhao@trip.com,CLOSED,2022-02-22T13:24:37Z,2022-09-11T03:33:19Z,"we are using zset to keep track of user score with a fixed length, but benchmark shows if zset is a hot key, performance could drop to 100 qps (or event to 10 qps).

I'm aware that this is caused by rocksdb iterator iterating and skipping too much deleted keys.
I was wondering that if there are parameters to tweak to speedup a bit or workarounds?

following is the script to reproduce the performance drop:

```bash
#/bin/bash

for ((i = 0; i < 100000000; i++)); do

    /usr/bin/redis-benchmark -p 6666 -c 1 -n 10000000 -r 5000 zadd z __rand_int__ __rand_int__ > ./logs/zadd-$i.log 2>&1 &
    bench_zadd_pid=$!
    /usr/bin/redis-benchmark -p 6666 -c 1 -n 10000000 zremrangebyrank z 500 -1 > ./logs/zremrangebyrank-$i.log 2>&1 &
    bench_zrem_pid=$!

    echo ""$(date ""+%F %T"") =$i=: bench with zadd($bench_zadd_pid)/zrem($bench_zrem_pid)""

    wait $bench_zadd_pid
    wait $bench_zrem_pid

done
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/494/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dCGA,kvrocks,1047798144,494,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-22T13:29:20Z,2022-02-22T13:29:20Z,"@patpatbear Thanks for your feedback, which kvrocks version you're using? This PR: https://github.com/KvrocksLabs/kvrocks/pull/438 should help in this case, but I didn't have a try on my side.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dCGA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dCIm,kvrocks,1047798310,494,NA,patpatbear,10203196,patpatbear,sr_zhao@trip.com,NA,2022-02-22T13:29:31Z,2022-02-22T13:29:31Z,also note that hash/set performance also drops on similar hot key senario.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dCIm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dC2L,kvrocks,1047801227,494,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-22T13:32:40Z,2022-02-22T13:32:40Z,"Yes, too many tombstones would cause performance degrade when seeking the LSM Tree. For hash/set should only affect the command like hgetall, point lookup command like hget would be fine.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dC2L/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dFGr,kvrocks,1047810475,494,NA,patpatbear,10203196,patpatbear,sr_zhao@trip.com,NA,2022-02-22T13:43:17Z,2022-02-22T13:43:17Z,"i update to the most recent version (2.0.6), seems like this issue still exists.

```
ppb@ppb-vm:~/test/kvrocks/logs$ tailf zremrangebyrank-0.log  
zremrangebyrank z 500 -1: 154.23 
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dFGr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dP-2,kvrocks,1047855030,494,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-22T14:30:33Z,2022-02-22T14:30:33Z,oh.. what your mean was that deleted tombstones would slowdown zadd?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-dP-2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-fGts,kvrocks,1048341356,494,NA,patpatbear,10203196,patpatbear,sr_zhao@trip.com,NA,2022-02-23T00:29:48Z,2022-02-23T00:29:48Z,"would slowdown zremrangebyrank. but both zremrangebyrank and zadd are write commands to the same key,  so both zadd and zremrangebyrank would slowdown.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-fGts/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-fVHg,kvrocks,1048400352,494,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-23T02:40:26Z,2022-02-23T02:40:26Z," cool, thanks @patpatbear. For this case, the single hot key indeed affects the performance in data race condition since we have the key lock when writing. I would investigate it later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-fVHg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-uITJ,kvrocks,1052280009,494,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-26T16:30:58Z,2022-02-26T16:30:58Z,"I inspected this case, upper/lower bound help nothing since deletion tombstones may have the same prefix(same version). I'm not sure delete range whether can reduce the seek time or not when have many deletion tombstones. Do you have any thoughts except force compaction. @shangxiaoxiong @ShooterIT ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-uITJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-_Z-y,kvrocks,1056808882,494,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-03-02T11:17:02Z,2022-03-02T11:17:02Z,"Some ideas
- Enable prefix bloom filter, i am making this 😜
- optimize current locks guard（use rocksdb snapshot for reading instead of locks）, i am thinking, and i will discuss with @git-hulk soon after","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-_Z-y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-_wRA,kvrocks,1056900160,494,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-03-02T12:56:13Z,2022-03-02T12:56:13Z,"@patpatbear would you like to try my PR #508, i enable rocksdb prefix bloom filter","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-_wRA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_CSY9,kvrocks,1057564221,494,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-03-03T01:18:03Z,2022-03-03T01:18:03Z,"another way is that we can compact deleted keys or tombstones ASAP

- use NewCompactOnDeletionCollectorFactory of rocksdb
- our compaction checker implements fine-grained compaction ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_CSY9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AMlu-,kvrocks,1077042110,494,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-03-24T03:56:23Z,2022-03-24T03:56:23Z,"> optimize current locks guard（use rocksdb snapshot for reading instead of locks）, i am thinking, and i will discuss with @git-hulk soon after

Maybe i have a wrong idea, currently, we already used snapshot for reading instead of locks @shangxiaoxiong correct me","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AMlu-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/494,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM9r,kvrocks,1242877803,494,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:33:19Z,2022-09-11T03:33:19Z,Closed as stale. You can ask questions at the [Discussions forum](https://github.com/apache/incubator-kvrocks/discussions/categories/q-a).,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM9r/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/504,https://api.github.com/repos/apache/kvrocks/issues/504,kvrocks,1153747820,504,[BUG] Wrong replication state,ChrisZMF,18628342,,,CLOSED,2022-02-28T07:27:53Z,2022-03-01T04:30:55Z,"**Describe**
If a slave is in full syncing with master, the state can be seen via the item `master_sync_in_progress:1` of info replication. If master is down while slave is fetching SST, the slave will keep retrying connecting with master and the replication state will remain `kReplFetchSST`. The info replication will get `master_sync_in_progress:1`, but it should be `master_sync_in_progress:0`.

OS: all
Version: all

**To Reproduce**
Steps to reproduce the behavior:
- Start servers A and B
- Write a mount of data to A
- Set B as slave of A and guarantee the full-syncing will be triggered
- Kill A while B is fetching SST

**Expected behavior**
After killing A, check the state master_sync_in_progress on B, it should be `master_sync_in_progress:0`. But `master_sync_in_progress:1` is gotten.

![image](https://user-images.githubusercontent.com/18628342/155937374-113a9b66-dc46-46d4-888c-3676277d3f17.png)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/504/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/504,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-1a-a,kvrocks,1054191514,504,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-02-28T12:08:49Z,2022-02-28T12:08:49Z,good catch,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4-1a-a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/509,https://api.github.com/repos/apache/kvrocks/issues/509,kvrocks,1158062215,509,[BUG]  kvrocks migrate does not support pasword,tianshimoyi,68532999,天使莫忆,,CLOSED,2022-03-03T07:25:32Z,2022-03-09T13:17:57Z,"**Describe the bug**
When kvrocks migrate, if the cluster has a password, migrate fails。

 - OS: [e.g. Centos 7]
 - Version [2.0.6]


**To Reproduce**
Steps to reproduce the behavior:
1. 
![451646291138_ pic](https://user-images.githubusercontent.com/68532999/156516068-d789f428-f7cd-4981-8140-a82fad5e1c2a.jpg)

2.  redis-cli -h $ip -p $port -a $password clusterx migrate $slot $dst_nodeid

**Expected behavior**
migrate should successfully!

![441646291115_ pic](https://user-images.githubusercontent.com/68532999/156516477-05a6dbca-f234-4358-bc9a-506db6c5ae6a.jpg)

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/509/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/509,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_DNQ-,kvrocks,1057805374,509,NA,ChrisZMF,18628342,,,NA,2022-03-03T08:39:28Z,2022-03-03T08:39:28Z,Will be supported as soon as possible,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_DNQ-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/510,https://api.github.com/repos/apache/kvrocks/issues/510,kvrocks,1159301301,510,[QUESTION]  Does the kvrocks migrate command and setslot command support batch slot operations?,tianshimoyi,68532999,天使莫忆,,CLOSED,2022-03-04T06:39:00Z,2022-09-11T03:33:36Z,"

Are there any plans for the kvrocks migrate command and setslot to develop functionality to support batch slot migration？setslot needs to reset the version for each slot, which will make the version more and more difficult to control in the future.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/510/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/510,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_OALH,kvrocks,1060635335,510,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-03-07T12:27:10Z,2022-03-07T12:27:10Z,"Yes, we have the plan but now we don't have much spare time, may can't support it soon. And current implementation is generally available. Of course, PR is welcome 😜","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_OALH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/510,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AMdI3,kvrocks,1077006903,510,NA,ChrisZMF,18628342,,,NA,2022-03-24T02:34:54Z,2022-03-24T02:34:54Z,I will support batch slot operation for command setslot first.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AMdI3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/510,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM-E,kvrocks,1242877828,510,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:33:36Z,2022-09-11T03:33:36Z,Closed as stale. You can ask questions at the [Discussions forum](https://github.com/apache/incubator-kvrocks/discussions/categories/q-a).,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM-E/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/511,https://api.github.com/repos/apache/kvrocks/issues/511,kvrocks,1160214615,511,[NEW] more rocksdb options supporting for write stall needed,sjpcg,64124145,鹏北海,,OPEN,2022-03-05T03:32:20Z,2022-03-05T06:08:22Z,"In my tests, when I ran a new compaction strategy that combined an **automatic compation operation with a compaction checker**, MY disk space was blown up so fast that level5 reclamation was slow and my disk ran the risk of being full. If I change this to **auto compaction+cron compaction(hourly)**, it will trigger a write stall that usually lasts more than half an hour and performs poorly. When I read the log, I usually write stall because **level0FIleNum is too large**, so I set this parameter to a larger value. However, something new happens, such as **Estimated Pending compaction bytes**, so I want to change this parameter by changing the configuration file. It turns out that kVRocks is not currently supported, so more rockDB parameters need to be supported, not just this one, or have other good suggestions？thanks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/511/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/511,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_KZ--,kvrocks,1059692478,511,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-05T05:19:05Z,2022-03-05T05:19:05Z,"@sjpcg Thanks for your feedback. We need to find a new way to let users customize RocksDB options since it's impossible to integrate those options at once, and too trivial to add new option till users want it.


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_KZ--/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/511,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_KcjH,kvrocks,1059702983,511,NA,sjpcg,64124145,鹏北海,,NA,2022-03-05T06:08:21Z,2022-03-05T06:08:21Z,"> 
It's for the best. Thank you for your efforts
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_KcjH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/512,https://api.github.com/repos/apache/kvrocks/issues/512,kvrocks,1160266001,512,[QUESTION] how to use supervised,sjpcg,64124145,鹏北海,,CLOSED,2022-03-05T06:56:58Z,2022-03-06T04:45:25Z,"I noticed  a **configuration about supervisored** in the config file.But didn't really get it,Does it just like the **supervisored program** which can pulls  the kvrocks process up when it dies for some reason? And if so,how do i use it? Supervisored program need to be installed or  config it only? Thanks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/512/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_LLP-,kvrocks,1059894270,512,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-06T04:45:15Z,2022-03-06T04:45:15Z,"Yes, the config item `supervised` was used to interact with your supervision tree which means you need to install tools like supervisor or systemd first.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_LLP-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/513,https://api.github.com/repos/apache/kvrocks/issues/513,kvrocks,1160568694,513,[BUG] Slave can't re-sync with master again after changing password,ChrisZMF,18628342,,,CLOSED,2022-03-06T10:02:46Z,2022-03-14T00:47:36Z,"**Describe the bug**
If the connection between master and slave is broken (reasons may be network error, restarting master... ) after changing the password of master, the slave can't resynchronize with master again automatically. The resynchronization will fail because slave can't auth master successfully though the `masterauth` of slave is set rightly. It can be resolved by restarting slave with new `masterauth` or execute `slaveof no one` to reset the master-slave relationship.
![image](https://user-images.githubusercontent.com/18628342/156917178-a56aa134-42fc-4e89-9407-a1ca2a9d0ac2.png)


 - OS: all
 - Version: all


**To Reproduce**
Steps to reproduce the behavior:
1. Sync server B(slave) with server A(master)
2. Set or change `requirepass` of A and `masterauth` of B at the same time
3. Restart master with new password, then slave can't resync with master.

**Expected behavior**
The B(slave) can re-sync with A(master) automatically.

**Reason Analysis**
When slave sync with master, a `ReplicationThread` object will be created and the password of master will be assigned to its member variable `auth_`.  Although the value of `masterauth` is re-assigned, `auth_` will still hold the old value because it can't be re-assigned dynamically. 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/513/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/513,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_LZvn,kvrocks,1059953639,513,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-06T12:26:36Z,2022-03-06T12:26:36Z,"cool, can you help to handle this issue? @ChrisZMF ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_LZvn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/513,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_LffG,kvrocks,1059977158,513,NA,ChrisZMF,18628342,,,NA,2022-03-06T14:55:32Z,2022-03-06T14:55:32Z,"OK, I will fix it soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_LffG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/516,https://api.github.com/repos/apache/kvrocks/issues/516,kvrocks,1164819178,516,[QUESTION]Compile on ubuntu20.04,0xLaiHo,18321888,Tobias,laihox@outlook.com,CLOSED,2022-03-10T06:44:12Z,2022-03-11T16:21:53Z,"Build source with the command `make -j4` and got below error:

![image](https://user-images.githubusercontent.com/18321888/157604189-b2d3a5d4-1dfe-4493-b039-2e37ed0eb3c3.png)
![image](https://user-images.githubusercontent.com/18321888/157604434-83e7a9d4-34ed-43c6-a1ef-a87c23b123af.png)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/516/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/516,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_a6sx,kvrocks,1064020785,516,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-10T12:50:12Z,2022-03-10T12:50:12Z,"Do you install dependencies first, seems missing the libtool:

```shell
sudo apt-get install gcc g++ make libsnappy-dev autoconf automake libtool which libgtest-dev
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_a6sx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/516,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_dvhi,kvrocks,1064761442,516,NA,0xLaiHo,18321888,Tobias,laihox@outlook.com,NA,2022-03-11T04:29:03Z,2022-03-11T04:29:03Z,"of course,libtool version is 2.4.6,and i try it on another machines,still doesn't work","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_dvhi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/516,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_dvn_,kvrocks,1064761855,516,NA,0xLaiHo,18321888,Tobias,laihox@outlook.com,NA,2022-03-11T04:30:05Z,2022-03-11T04:30:05Z,"> Do you install dependencies first, seems missing the libtool:
> 
> ```shell
> sudo apt-get install gcc g++ make libsnappy-dev autoconf automake libtool which libgtest-dev
> ```

![image](https://user-images.githubusercontent.com/18321888/157802313-f2d9f511-ec1e-4a85-8670-b17f05f24afe.png)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_dvn_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/516,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_fG-A,kvrocks,1065119616,516,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-11T13:35:45Z,2022-03-11T13:35:45Z,"okay, thanks for your feedback, would have a try on my side soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_fG-A/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/516,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_fMp9,kvrocks,1065142909,516,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-11T14:04:42Z,2022-03-11T14:04:42Z,"![image](https://user-images.githubusercontent.com/4987594/157882056-0eaf5458-4668-49e1-b425-68bde850f66b.png)
I have a test on ubuntu 20.04 LTS, it's ok to compile from source. From your feedback, the autoconf did't use the `libtool`, you need to install dependencies before building. You need to check the `libtoolize --version` instead of libtool","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_fMp9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/516,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_fqhZ,kvrocks,1065265241,516,NA,0xLaiHo,18321888,Tobias,laihox@outlook.com,NA,2022-03-11T16:16:50Z,2022-03-11T16:16:50Z,"thank u for your help , it's success to compile . ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_fqhZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/516,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_frke,kvrocks,1065269534,516,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-11T16:21:53Z,2022-03-11T16:21:53Z,"cool, let's close this issue, welcome to reopen if you have any question or suggestion. Have fun.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_frke/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/519,https://api.github.com/repos/apache/kvrocks/issues/519,kvrocks,1167307778,519,[QUESTION]The ReadOptions uses the different snapshots when getting metadata and subkey values,ColinChamber,95634254,ColinChamber,,OPEN,2022-03-12T14:45:25Z,2022-04-12T01:36:03Z,The ReadOptions uses the different snapshots when getting metadata and subkey values. Could there be inconsistencies?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/519/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/519,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_if_V,kvrocks,1066008533,519,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-13T02:31:02Z,2022-03-13T02:31:02Z,"Yes, but it seems ok for most scenes, implementation in this way can keep the code more clean and simple.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_if_V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/519,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BUGSY,kvrocks,1095787672,519,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-04-12T01:36:03Z,2022-04-12T01:36:03Z,"I think we should avoid this, it is a bad design. We should find a time to refactor this implementation.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BUGSY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/521,https://api.github.com/repos/apache/kvrocks/issues/521,kvrocks,1167851143,521,How to delete a namespace and its datas fast?,ZonghaoWang,11403656,zonghaowang,657824033@qq.com,CLOSED,2022-03-14T03:55:53Z,2022-03-16T12:23:59Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/521/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/521,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_lUv8,kvrocks,1066748924,521,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-14T12:52:18Z,2022-03-14T12:52:18Z,"Can use `flushdb` command but the space wouldn't be reclaimed util compaction. Of course, you can use `compact` command to force trigger compaction.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM4_lUv8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/522,https://api.github.com/repos/apache/kvrocks/issues/522,kvrocks,1173267303,522,[BUG] The behavior that slave can delete expired key in compactionfilter may lead to Inconsistency with master forever,shangxiaoxiong,52746580,XiongDa,,OPEN,2022-03-18T07:27:34Z,2022-03-18T07:29:41Z,Pika has the same problem.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/522/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/528,https://api.github.com/repos/apache/kvrocks/issues/528,kvrocks,1179053102,528,[Question] how to get keys num in kvrocks ?,rfyiamcool,3785409,fengyun.rui,rfyiamcool@163.com,CLOSED,2022-03-24T06:10:13Z,2022-03-24T07:49:34Z,"how to get keys num in kvrocks by redis-cli ? 😁

in kvrocks

```
127.0.0.1:6379> info Keyspace
# Keyspace
```

in redis

```
127.0.0.1:6379> info Keyspace
# Keyspace
db0:keys=6,expires=0,avg_ttl=0
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/528/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/528,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ANhle,kvrocks,1077287262,528,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-24T06:39:15Z,2022-03-24T06:39:15Z,"@rfyiamcool Thanks for your attention. Unlike Redis that Kvrocks didn't store keys number directly and it need to background scan the db to get keys number. So we must call `dbsize scan` command first before getting keys num. 

Like below:

```
127.0.0.1:6666> dbsize scan
OK
127.0.0.1:6666> info keyspace
# Keyspace
# Last scan db time: Thu Mar 24 06:38:39 2022
db0:keys=1,expires=0,avg_ttl=0,expired=0
sequence:1
used_db_size:0
max_db_size:0
used_percent: 0%
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ANhle/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/528,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ANs0f,kvrocks,1077333279,528,NA,rfyiamcool,3785409,fengyun.rui,rfyiamcool@163.com,NA,2022-03-24T07:49:34Z,2022-03-24T07:49:34Z,thank u.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ANs0f/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/530,kvrocks,1182439762,530,[QUESTION] Change the license to Apache License Version 2.0,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2022-03-27T08:27:42Z,2022-10-11T07:44:39Z,"Hi, all Kvrocks contributors, we want to donate Kvrocks to Apache Software Foundation, the first step for us is changing the license to Apache License Version 2.0. As we know, Kvrocks is an open source software under the BSD-3-Clause license, we truly thank every contributor and user, you guys make Kvrocks great and have an active community, before we could submit PR to change license, we must to get your approval.

@git-hulk @karelrooted @ShooterIT  @Alfejik @caipengbo @ChrisZMF @shangxiaoxiong @ColinChamber @guoxiangCN @calvinxiao @patpatbear @WyattJia @smartlee @popunit @clyang @byronhe @QQxiaoyuyu @nioshield @singgel @liangjingyang @gaoyuanzong @rongzeng54 @unext-ops @fishery86 @xujianhai666 @LykxSassinator 

Please reply ""Approved"" if you agree.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/530/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXa6u,kvrocks,1079881390,530,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-03-27T08:28:07Z,2022-03-27T08:28:07Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXa6u/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXa9v,kvrocks,1079881583,530,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-03-27T08:29:28Z,2022-03-27T08:29:28Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXa9v/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXa_P,kvrocks,1079881679,530,NA,WyattJia,8580364,bitstring,i@eventloop.live,NA,2022-03-27T08:30:10Z,2022-03-27T08:30:10Z,Approved🎉,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXa_P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXbg1,kvrocks,1079883829,530,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-03-27T08:44:19Z,2022-03-27T08:44:19Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXbg1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXbwF,kvrocks,1079884805,530,NA,shangxiaoxiong,52746580,XiongDa,,NA,2022-03-27T08:50:55Z,2022-03-27T08:50:55Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXbwF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXfDR,kvrocks,1079898321,530,NA,karelrooted,523980,karelrooted,,NA,2022-03-27T10:14:36Z,2022-03-27T10:14:36Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXfDR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXf0-,kvrocks,1079901502,530,NA,ChrisZMF,18628342,,,NA,2022-03-27T10:34:31Z,2022-03-27T10:34:31Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AXf0-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AYPUA,kvrocks,1080096000,530,NA,Alfejik,11593864,Alfejik,,NA,2022-03-28T01:46:31Z,2022-03-28T01:46:31Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AYPUA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AYRLa,kvrocks,1080103642,530,NA,xujianhai666,52450794,,,NA,2022-03-28T02:06:07Z,2022-03-28T02:06:07Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AYRLa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AYVgx,kvrocks,1080121393,530,NA,ColinChamber,95634254,ColinChamber,,NA,2022-03-28T02:41:39Z,2022-03-28T02:41:39Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AYVgx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AYZrX,kvrocks,1080138455,530,NA,LykxSassinator,18441614,lucasliang,nkcs_lykx@hotmail.com,NA,2022-03-28T03:20:47Z,2022-03-28T03:20:47Z,"Approved！
LGTM！！！","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AYZrX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aapr1,kvrocks,1080728309,530,NA,patpatbear,10203196,patpatbear,sr_zhao@trip.com,NA,2022-03-28T14:29:40Z,2022-03-28T14:29:40Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aapr1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aaqby,kvrocks,1080731378,530,NA,liangjingyang,2056705,Yang,simple.continue@gmail.com,NA,2022-03-28T14:32:16Z,2022-03-28T14:32:16Z,"Approved

Get Outlook for iOS<https://aka.ms/o0ukef>
________________________________
From: patpatbear ***@***.***>
Sent: Monday, March 28, 2022 10:29:52 PM
To: KvrocksLabs/kvrocks ***@***.***>
Cc: Yang ***@***.***>; Mention ***@***.***>
Subject: Re: [KvrocksLabs/kvrocks] [QUESTION] Change the license to Apache License Version 2.0 (Issue #530)


Approved

—
Reply to this email directly, view it on GitHub<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FKvrocksLabs%2Fkvrocks%2Fissues%2F530%23issuecomment-1080728309&data=04%7C01%7C%7C0325d07c6292458b62db08da10c76fb8%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C637840746011285849%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=9L6lgLKFp8K6Kp6%2FKfSgbpt%2F2GrDAaG0mumLv%2BySs6M%3D&reserved=0>, or unsubscribe<https://nam12.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fnotifications%2Funsubscribe-auth%2FAAPWEAPGV4CAHT4ZAVSLQ2TVCG66BANCNFSM5RYONLMA&data=04%7C01%7C%7C0325d07c6292458b62db08da10c76fb8%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C637840746011285849%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=nMQP3r478arCd6dxgvgNdwaqkicxuvAcXjoIvFXyKdA%3D&reserved=0>.
You are receiving this because you were mentioned.Message ID: ***@***.***>
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aaqby/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aaq1v,kvrocks,1080733039,530,NA,unext-ops,18475820,unextops,,NA,2022-03-28T14:33:44Z,2022-03-28T14:33:44Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aaq1v/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AarDl,kvrocks,1080733925,530,NA,calvinxiao,929238,Calvin Xiao,calvin325@gmail.com,NA,2022-03-28T14:34:29Z,2022-03-28T14:34:29Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AarDl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aa6UY,kvrocks,1080796440,530,NA,nioshield,9985749,nio,,NA,2022-03-28T15:27:01Z,2022-03-28T15:27:01Z,Approved🎉🎉🎉,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aa6UY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aa9uz,kvrocks,1080810419,530,NA,singgel,18670310,阿拉斯加大闸蟹,,NA,2022-03-28T15:39:49Z,2022-03-28T15:39:49Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aa9uz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aa-RE,kvrocks,1080812612,530,NA,guoxiangCN,30590325,mzygdeaq@163.com,,NA,2022-03-28T15:41:59Z,2022-03-28T15:41:59Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Aa-RE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AbZiB,kvrocks,1080924289,530,NA,smartlee,1262498,BradLee,entropylee@gmail.com,NA,2022-03-28T17:10:08Z,2022-03-28T17:10:08Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AbZiB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ac6Zn,kvrocks,1081321063,530,NA,QQxiaoyuyu,34185590,,,NA,2022-03-29T02:01:21Z,2022-03-29T02:01:21Z,"Good ,Approved","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ac6Zn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ac9WR,kvrocks,1081333137,530,NA,popunit,1581852,Patrick Yu,pluy_yu@hotmail.com,NA,2022-03-29T02:25:05Z,2022-03-29T02:25:05Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ac9WR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AdAhO,kvrocks,1081346126,530,NA,rongzeng54,1867865,曾嵘,rongzeng54@gmail.com,NA,2022-03-29T02:53:15Z,2022-03-29T02:53:15Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AdAhO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AdGRp,kvrocks,1081369705,530,NA,clyang,2229479,,,NA,2022-03-29T03:45:06Z,2022-03-29T03:45:06Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AdGRp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AoEUb,kvrocks,1084245275,530,NA,byronhe,1394332,byronhe,,NA,2022-03-31T08:12:47Z,2022-03-31T08:12:47Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AoEUb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AoJbn,kvrocks,1084266215,530,NA,fishery86,63535239,,,NA,2022-03-31T08:34:07Z,2022-03-31T08:34:07Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AoJbn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AoJ7C,kvrocks,1084268226,530,NA,gaoyuanzong,3156656,yuanzong.gao,gaoyuanzong@126.com,NA,2022-03-31T08:36:12Z,2022-03-31T08:36:12Z,Approved,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AoJ7C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AoXKC,kvrocks,1084322434,530,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-03-31T09:28:47Z,2022-03-31T09:28:47Z,"<img width=""287"" alt=""image"" src=""https://user-images.githubusercontent.com/18362176/161023393-eaafba35-802a-4ee6-9bd1-8c61168323f1.png"">
<img width=""322"" alt=""image"" src=""https://user-images.githubusercontent.com/18362176/161023533-04d8cb0a-c625-44de-ba62-54f755310263.png"">

26 contributors, 26 `Approved`s 🎉

Truly thank all contributors  for approving donating to Apache and changing the license to Apache License Version 2.0.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5AoXKC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/530,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L80xI,kvrocks,1274235976,530,NA,LykxSassinator,18441614,lucasliang,nkcs_lykx@hotmail.com,NA,2022-10-11T07:44:39Z,2022-10-11T07:44:39Z,"Approved

从 Windows 版邮件<https://go.microsoft.com/fwlink/?LinkId=550986>发送

发件人: Wang ***@***.***>
发送时间: 2022年3月27日 16:28
收件人: ***@***.***>
抄送: ***@***.***>; ***@***.***>
主题: [KvrocksLabs/kvrocks] [QUESTION] Change the license to Apache License Version 2.0 (Issue #530)


Hi, all Kvrocks contributors, we want to donate Kvrocks to Apache Software Foundation, the first step for us is changing the license to Apache License Version 2.0. As we know, Kvrocks is an open source software under the BSD-3-Clause license, we truly thank every contributor and user, you guys make Kvrocks great and have an active community, before we could submit PR to change license, we must to get your approval.

@git-hulk<https://github.com/git-hulk> @karelrooted<https://github.com/karelrooted> @ShooterIT<https://github.com/ShooterIT> @Alfejik<https://github.com/Alfejik> @caipengbo<https://github.com/caipengbo> @ChrisZMF<https://github.com/ChrisZMF> @shangxiaoxiong<https://github.com/shangxiaoxiong> @ColinChamber<https://github.com/ColinChamber> @guoxiangCN<https://github.com/guoxiangCN> @calvinxiao<https://github.com/calvinxiao> @patpatbear<https://github.com/patpatbear> @WyattJia<https://github.com/WyattJia> @smartlee<https://github.com/smartlee> @popunit<https://github.com/popunit> @clyang<https://github.com/clyang> @byronhe<https://github.com/byronhe> @QQxiaoyuyu<https://github.com/QQxiaoyuyu> @nioshield<https://github.com/nioshield> @singgel<https://github.com/singgel> @liangjingyang<https://github.com/liangjingyang> @gaoyuanzong<https://github.com/gaoyuanzong> @rongzeng54<https://github.com/rongzeng54> @unext-ops<https://github.com/unext-ops> @fishery86<https://github.com/fishery86> @xujianhai666<https://github.com/xujianhai666> @LykxSassinator<https://github.com/LykxSassinator>

Please reply ""Approved"" if you agree.

―
Reply to this email directly, view it on GitHub<https://github.com/KvrocksLabs/kvrocks/issues/530>, or unsubscribe<https://github.com/notifications/unsubscribe-auth/AEMWLDUBNEUTLTCSTCGI6XDVCALY3ANCNFSM5RYONLMA>.
You are receiving this because you were mentioned.Message ID: ***@***.***>

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L80xI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/532,kvrocks,1194370787,532,[QUESTION] Any plan to support Redis Stream?,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2022-04-06T09:55:04Z,2022-08-17T09:30:54Z,"Hi, do you have any plans to support Redis Stream? That's good for use KVrocks as replacement for message-oriented system. My company is one of the needs of this.
Detailed: 

- [https://redis.io/commands/?group=stream](https://redis.io/commands/?group=stream) 
- [http://antirez.com/news/114](http://antirez.com/news/114)
- [http://antirez.com/news/128](http://antirez.com/news/128)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/532/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BBx_q,kvrocks,1090985962,532,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-04-07T01:32:00Z,2022-04-07T01:32:00Z,"Sorry, currently, we have no plan to implement Redis Stream. Why don't we use kafka?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BBx_q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BMaLd,kvrocks,1093771997,532,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-04-09T07:24:26Z,2022-04-09T07:24:26Z,We want to use one and simple storage and in-memory. Kafka is too complicity and for one function need a dedicated system and infrastructure (for us).  ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BMaLd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BeAM1,kvrocks,1098384181,532,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-04-13T19:02:02Z,2022-04-13T19:02:02Z,"A small questions - if we are ported a  stream code into KVRocks, are you approve it to merge into release?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BeAM1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Be86j,kvrocks,1098632867,532,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-04-14T01:54:01Z,2022-04-14T01:54:01Z,"Of course, I think we would be very happy to see this. cc @ShooterIT ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Be86j/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BfCYD,kvrocks,1098655235,532,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-04-14T02:45:04Z,2022-04-14T02:45:04Z,"Why not! for some features that redis has, we don't have enough time to implement it, it will be our pleasure if someone could push it forward.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BfCYD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DKwyy,kvrocks,1126894770,532,NA,seaguest,498853,Yongkan Huang,,NA,2022-05-15T09:31:30Z,2022-05-15T09:31:30Z,"@aleksraiden 

FYI, [NATS](https://github.com/nats-io/nats-server) is a good alternative of Kafka, lightweight and easy to run, it does support persistence in JetStream mode.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DKwyy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DKzJn,kvrocks,1126904423,532,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-05-15T10:30:01Z,2022-05-15T10:30:01Z,"WE start implements this feature after porting LMOVE command :) in first release we have a plan to implement a base functions, withoit consumers group","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DKzJn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HPQUS,kvrocks,1195181330,532,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-07-26T08:38:03Z,2022-07-26T08:38:03Z,"Please, help us - review and comment: https://github.com/apache/incubator-kvrocks/pull/745","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HPQUS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/532,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HPQZ3,kvrocks,1195181687,532,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-07-26T08:38:23Z,2022-07-26T08:38:23Z,A lot of thanks @torwig ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HPQZ3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/534,https://api.github.com/repos/apache/kvrocks/issues/534,kvrocks,1200749994,534,[BUG] Kvrocks SCAN does not match with Redis SCAN,VictorCam,43551031,Victor Campa,,CLOSED,2022-04-12T01:13:53Z,2023-06-25T16:25:56Z,"**Describe the bug**
Scanning on Kvrocks produces incorrect responses when compared to Redis.

![image](https://user-images.githubusercontent.com/43551031/162858658-999c7153-f7c2-4b76-bc05-be52a03dd350.png)
![image](https://user-images.githubusercontent.com/43551031/162858727-8997641f-6b87-43f6-82fa-8b7960f61b52.png)


**To Reproduce**
Steps to reproduce the behavior:
1. run docker
2. get images ""docker pull redis"" and ""docker pull kvrocks/kvrocks""
3. ""docker run --rm -d  -p 6666:6666/tcp kvrocks/kvrocks:latest""
4. ""docker run --rm -d  -p 6379:6379/tcp redis:latest""
5. open two redis-cli instances one on port 6739 and 6666
6. set ""hi"" and set ""hello there"" on both instances
7. preform the same queries as shown in the image.

**Expected behavior**
I believe scan should be the same as how redis is preforming the scan.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/534/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/534,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BUEwl,kvrocks,1095781413,534,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-04-12T01:30:40Z,2022-04-12T01:30:40Z,"@VictorCam Thanks for your report
there are two difference with redis, i find
- return value is string instead of integer, the reason is here https://github.com/KvrocksLabs/kvrocks/discussions/417
- From code, Kvrocks currently only support ""prefix"" match, so it return 0 when `match *he*`, for this, we can support it i think, even it may be inefficient.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BUEwl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/534,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BUNOb,kvrocks,1095816091,534,NA,VictorCam,43551031,Victor Campa,,NA,2022-04-12T01:58:25Z,2022-04-12T01:58:25Z,Thank you for the quick response and explanation. I'd be nice to have that implemented. I believe it can be useful in certain scenarios. Though feel free to decide if you'd like to implement it or not considering that fact that it will be inefficient.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BUNOb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/534,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CWe0K,kvrocks,1113189642,534,NA,adulau,3309,Alexandre Dulaunoy,a@foo.be,NA,2022-04-29T11:20:02Z,2022-04-29T11:20:02Z,"and if you are curious, we maintain a [fork of the Redis Python library](https://github.com/hashlookup/redis-py/commit/e9c53fb1398e636106c0ec0165ba564943564a83) to make the iterator works on kvrocks. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CWe0K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/534,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DKsZi,kvrocks,1126876770,534,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-15T07:21:46Z,2022-05-15T07:21:46Z,"@ShooterIT Another concern is that on Kvrocks, `SCAN` return the cursor ""_hello"" but actually if you want to iterate on next element, it requires a number based cursor.

For example:

```
127.0.0.1:6666> set ""hi there"" v0
OK
127.0.0.1:6666> set ""hello"" v1
OK
127.0.0.1:6666> SCAN 0 MATCH hel* COUNT 10000
1) ""_hello""
2) 1) ""hello""
127.0.0.1:6666> SCAN 0 MATCH he* COUNT 10000
1) ""_hello""
2) 1) ""hello""
127.0.0.1:6666> SCAN 0 MATCH h* COUNT 10000
1) ""_hi there""
2) 1) ""hello""
   2) ""hi there""
127.0.0.1:6666> SCAN ""_hi there"" MATCH h* COUNT 10000
1) ""0""
2) (empty array)
127.0.0.1:6666> SCAN ""hi there"" MATCH h* COUNT 10000
1) ""0""
2) (empty array)
127.0.0.1:6666> SCAN 1 MATCH h* COUNT 10000
1) ""_hi there""
2) 1) ""hi there""
```

Note that `SCAN ""_hi there"" ...` returns ""0"".","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DKsZi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/534,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DKsb-,kvrocks,1126876926,534,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-15T07:22:57Z,2022-05-15T07:22:57Z,"Sorry. I get it wrong.

```
127.0.0.1:6666> SCAN 1 MATCH h* COUNT 1
1) ""_hi there""
2) 1) ""hi there""
127.0.0.1:6666> SCAN 0 MATCH h* COUNT 1
1) ""_hello""
2) 1) ""hello""
127.0.0.1:6666> SCAN ""_hello"" MATCH h* COUNT 1
1) ""_hi there""
2) 1) ""hi there""
```

The cursor should work.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DKsb-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/534,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fu-hD,kvrocks,1606150211,534,NA,PragmaTwice,20042607,Twice,,NA,2023-06-25T16:25:56Z,2023-06-25T16:25:56Z,See #1489.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fu-hD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/535,https://api.github.com/repos/apache/kvrocks/issues/535,kvrocks,1206572658,535,[NEW] Could kvrocks support multi db paths,JackyLucifer,18521851,刘强,liu137800@126.com,CLOSED,2022-04-18T02:01:14Z,2022-04-20T03:20:15Z,"**The problem/use-case that the feature addresses**
During use kvrocks, we found kvrocks always write data to one db path, this behavior is not friendly, we want to kvrocks could write data to different db paths.

**Description of the feature**
As we know, rocksdb support multi db paths, so we hope kvrovks also could support this feature, we could set multi db paths by `config set` or `function`, maybe could create new db path if data file size of current db path exceeds setting threshold value.

**Alternatives you've considered**

different namespaces have different db paths.

**Additional information**

_NULL_


中文描述

**功能解决的问题/用例**

rocksdb能够对多个目录下的数据进行读写

**功能描述**

在使用过程中发现，在长时间写入后，都是写入到一个rocksdb数据文件中，希望通过函数控制数据库路径，或者控制rocksdb数据库文件在多大之后新建目录进行新的数据写入

**你考虑过的替代方案**
每次新建一个namespace，就按照namespace的名字，在rocksdb指定目录创建一个文件夹，相关数据存储到指定目录
在读写某个namespcae目录数据的时候对应打开，长时间不没有操作则关闭

**其他信息**
无","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/535/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BoNMp,kvrocks,1101058857,535,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-04-18T03:31:06Z,2022-04-18T03:31:06Z,"I think this idea makes sense. I ever also wanted to support it, this feature may bring many advantages
- If there are some small disks, we also could provide big db
- As we know, now there are many storage media with different speeds, such as AEP, SSD, HDD, we can store low level data on the fast storage, to gain better performance.
- In cloud environment, we could use local disk and remote storage simultaneously.

Some related problems
- Multi db paths bring troubles to maintain database storage.
- For backup, it may bring some problems, since we may not just use hard link for rocksdb backup
- Similar with backup, full replication needs also one checkpoint. And replica needs to handle how to store checkpoint of master.

PS: to acquire more people concerns, l add descriptions  in English, please correct me if I have misunderstandings","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BoNMp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BoOMl,kvrocks,1101062949,535,NA,JackyLucifer,18521851,刘强,liu137800@126.com,NA,2022-04-18T03:44:14Z,2022-04-18T03:44:14Z,"I see. Multipath database storage will cause other related problems
My requirement is to control the path to read the database through code
Is this feasible?
If you can, I hope to open it and dynamically modify the database path, so as to achieve my purpose

For example:
The database path in the configuration file is loaded by default, and redis and rocksdb data are synchronized
After modifying the database path, synchronize redis and rocksdb data again

明白了，多路径数据库存储存会产生其他先关问题
我这边的需求是想通过代码控制读取数据库的路径
这样是否可行？
如果可以希望能够开放出，动态修改数据库路径，从而达到我这种使用目的

例如：
默认加载配置文件中的数据库路径，redis与rocksdb数据同步
修改数据库路径后，再次同步redis与rocksdb数据
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BoOMl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BxLEQ,kvrocks,1103409424,535,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-04-20T02:38:57Z,2022-04-20T02:38:57Z,"Hi @JackyLucifer Even multi db paths solution has several problem we need to deal with, i think it make much sense, it is worth putting energy to dig into.
your requirement is much customized and trick, i don't think we could support it, you can implement it in your branch.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BxLEQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BxQDl,kvrocks,1103429861,535,NA,JackyLucifer,18521851,刘强,liu137800@126.com,NA,2022-04-20T03:20:14Z,2022-04-20T03:20:14Z,OK,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5BxQDl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/536,https://api.github.com/repos/apache/kvrocks/issues/536,kvrocks,1208635495,536,[BUG] make error  macos,supermy,7570552,supermy,springclick@gmail.com,CLOSED,2022-04-19T17:11:57Z,2022-04-27T16:34:49Z,"**Describe the bug**
cd src && /Applications/Xcode.app/Contents/Developer/usr/bin/make all
    CC server.o
    CC main.o
    LINK kvrocks
Undefined symbols for architecture x86_64:
  ""_dallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_mallctl"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_mallctlbymib"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_mallctlnametomib"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_malloc_stats_print"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_malloc_usable_size"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_mallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_nallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_rallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_sallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_sdallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_xallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
 - OS: [e.g. macos ]
 - Version [e.g. 1.1.5]


**To Reproduce**
Steps to reproduce the behavior:
1. 
2.
3.

**Expected behavior**
A clear and concise description of what you expected to happen.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/536/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/536,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Bw_jZ,kvrocks,1103362265,536,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-04-20T01:53:10Z,2022-04-20T01:53:10Z,@supermy Thanks for your feedback. Did you install the jemalloc on you side? ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Bw_jZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/536,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5B2mU-,kvrocks,1104831806,536,NA,supermy,7570552,supermy,springclick@gmail.com,NA,2022-04-21T07:50:23Z,2022-04-21T07:50:23Z,"# Operating system
# ifeq ($(uname_S),Darwin)
# 	# Darwin
# 	DISABLE_JEMALLOC=1
# else
# endif

make clean
make kvrocks
===============================================================================
jemalloc version   : 5.2.1-727-g12cd13cd418512d9e7596921ccdb62e25a103f87
library revision   : 2

CONFIG             : --enable-autogen --disable-libdl --enable-static --with-jemalloc-prefix= 'LDFLAGS=-pthread -ldl -lsnappy -lgflags -lz -lbz2 -llz4 -lzstd ' CPPFLAGS=-I/usr/local/opt/llvm/include
CC                 : gcc
CONFIGURE_CFLAGS   : -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops
SPECIFIED_CFLAGS   : 
EXTRA_CFLAGS       : 
CPPFLAGS           : -I/usr/local/opt/llvm/include -D_REENTRANT
CXX                : g++ -std=c++17
CONFIGURE_CXXFLAGS : -Wall -Wextra -g3 -Wimplicit-fallthrough -O3
SPECIFIED_CXXFLAGS : 
EXTRA_CXXFLAGS     : 
LDFLAGS            : -pthread -ldl -lsnappy -lgflags -lz -lbz2 -llz4 -lzstd 
EXTRA_LDFLAGS      : 
DSO_LDFLAGS        : -shared -Wl,-install_name,$(LIBDIR)/$(@F)
LIBS               : -lstdc++ -pthread
RPATH_EXTRA        : 

XSLTPROC           : /usr/bin/xsltproc
XSLROOT            : 

PREFIX             : /usr/local
BINDIR             : /usr/local/bin
DATADIR            : /usr/local/share
INCLUDEDIR         : /usr/local/include
LIBDIR             : /usr/local/lib
MANDIR             : /usr/local/share/man

srcroot            : 
abs_srcroot        : /Users/moyong/project/kvrocks/external/jemalloc/
objroot            : 
abs_objroot        : /Users/moyong/project/kvrocks/external/jemalloc/

JEMALLOC_PREFIX    : 
JEMALLOC_PRIVATE_NAMESPACE
                   : je_
install_suffix     : 
malloc_conf        : 
documentation      : 1
shared libs        : 1
static libs        : 1
autogen            : 1
debug              : 0
stats              : 1
experimetal_smallocx : 0
prof               : 0
prof-libunwind     : 0
prof-libgcc        : 0
prof-gcc           : 0
fill               : 1
utrace             : 0
xmalloc            : 0
log                : 0
lazy_lock          : 0
cache-oblivious    : 1
cxx                : 1
===============================================================================
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/jemalloc.sym.o src/jemalloc.c
nm -a src/jemalloc.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/jemalloc.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/arena.sym.o src/arena.c
nm -a src/arena.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/arena.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/background_thread.sym.o src/background_thread.c
nm -a src/background_thread.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/background_thread.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/base.sym.o src/base.c
nm -a src/base.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/base.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/bin.sym.o src/bin.c
nm -a src/bin.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/bin.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/bin_info.sym.o src/bin_info.c
nm -a src/bin_info.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/bin_info.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/bitmap.sym.o src/bitmap.c
nm -a src/bitmap.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/bitmap.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/buf_writer.sym.o src/buf_writer.c
nm -a src/buf_writer.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/buf_writer.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/cache_bin.sym.o src/cache_bin.c
nm -a src/cache_bin.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/cache_bin.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/ckh.sym.o src/ckh.c
nm -a src/ckh.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/ckh.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/counter.sym.o src/counter.c
nm -a src/counter.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/counter.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/ctl.sym.o src/ctl.c
nm -a src/ctl.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/ctl.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/decay.sym.o src/decay.c
nm -a src/decay.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/decay.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/div.sym.o src/div.c
nm -a src/div.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/div.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/ecache.sym.o src/ecache.c
nm -a src/ecache.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/ecache.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/edata.sym.o src/edata.c
nm -a src/edata.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/edata.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/edata_cache.sym.o src/edata_cache.c
nm -a src/edata_cache.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/edata_cache.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/ehooks.sym.o src/ehooks.c
nm -a src/ehooks.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/ehooks.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/emap.sym.o src/emap.c
nm -a src/emap.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/emap.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/eset.sym.o src/eset.c
nm -a src/eset.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/eset.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/exp_grow.sym.o src/exp_grow.c
nm -a src/exp_grow.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/exp_grow.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/extent.sym.o src/extent.c
nm -a src/extent.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/extent.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/extent_dss.sym.o src/extent_dss.c
nm -a src/extent_dss.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/extent_dss.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/extent_mmap.sym.o src/extent_mmap.c
nm -a src/extent_mmap.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/extent_mmap.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/fxp.sym.o src/fxp.c
nm -a src/fxp.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/fxp.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/hook.sym.o src/hook.c
nm -a src/hook.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/hook.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/hpa.sym.o src/hpa.c
nm -a src/hpa.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/hpa.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/hpa_central.sym.o src/hpa_central.c
nm -a src/hpa_central.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/hpa_central.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/hpdata.sym.o src/hpdata.c
nm -a src/hpdata.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/hpdata.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/inspect.sym.o src/inspect.c
nm -a src/inspect.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/inspect.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/large.sym.o src/large.c
nm -a src/large.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/large.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/log.sym.o src/log.c
nm -a src/log.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/log.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/malloc_io.sym.o src/malloc_io.c
nm -a src/malloc_io.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/malloc_io.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/mutex.sym.o src/mutex.c
nm -a src/mutex.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/mutex.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/nstime.sym.o src/nstime.c
nm -a src/nstime.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/nstime.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/pa.sym.o src/pa.c
nm -a src/pa.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/pa.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/pa_extra.sym.o src/pa_extra.c
nm -a src/pa_extra.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/pa_extra.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/pai.sym.o src/pai.c
nm -a src/pai.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/pai.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/pac.sym.o src/pac.c
nm -a src/pac.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/pac.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/pages.sym.o src/pages.c
nm -a src/pages.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/pages.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/peak_event.sym.o src/peak_event.c
nm -a src/peak_event.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/peak_event.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/prof.sym.o src/prof.c
nm -a src/prof.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/prof.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/prof_data.sym.o src/prof_data.c
nm -a src/prof_data.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/prof_data.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/prof_log.sym.o src/prof_log.c
nm -a src/prof_log.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/prof_log.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/prof_recent.sym.o src/prof_recent.c
nm -a src/prof_recent.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/prof_recent.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/prof_stats.sym.o src/prof_stats.c
nm -a src/prof_stats.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/prof_stats.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/prof_sys.sym.o src/prof_sys.c
nm -a src/prof_sys.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/prof_sys.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/psset.sym.o src/psset.c
nm -a src/psset.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/psset.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/rtree.sym.o src/rtree.c
nm -a src/rtree.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/rtree.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/safety_check.sym.o src/safety_check.c
nm -a src/safety_check.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/safety_check.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/sc.sym.o src/sc.c
nm -a src/sc.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/sc.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/sec.sym.o src/sec.c
nm -a src/sec.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/sec.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/stats.sym.o src/stats.c
nm -a src/stats.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/stats.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/sz.sym.o src/sz.c
nm -a src/sz.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/sz.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/tcache.sym.o src/tcache.c
nm -a src/tcache.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/tcache.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/test_hooks.sym.o src/test_hooks.c
nm -a src/test_hooks.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/test_hooks.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/thread_event.sym.o src/thread_event.c
nm -a src/thread_event.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/thread_event.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/ticker.sym.o src/ticker.c
nm -a src/ticker.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/ticker.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/tsd.sym.o src/tsd.c
nm -a src/tsd.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/tsd.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/witness.sym.o src/witness.c
nm -a src/witness.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/witness.sym
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -DJEMALLOC_NO_PRIVATE_NAMESPACE -o src/zone.sym.o src/zone.c
nm -a src/zone.sym.o | gawk -f include/jemalloc/internal/private_symbols.awk > src/zone.sym
/bin/sh include/jemalloc/internal/private_namespace.sh src/jemalloc.sym src/arena.sym src/background_thread.sym src/base.sym src/bin.sym src/bin_info.sym src/bitmap.sym src/buf_writer.sym src/cache_bin.sym src/ckh.sym src/counter.sym src/ctl.sym src/decay.sym src/div.sym src/ecache.sym src/edata.sym src/edata_cache.sym src/ehooks.sym src/emap.sym src/eset.sym src/exp_grow.sym src/extent.sym src/extent_dss.sym src/extent_mmap.sym src/fxp.sym src/hook.sym src/hpa.sym src/hpa_central.sym src/hpdata.sym src/inspect.sym src/large.sym src/log.sym src/malloc_io.sym src/mutex.sym src/nstime.sym src/pa.sym src/pa_extra.sym src/pai.sym src/pac.sym src/pages.sym src/peak_event.sym src/prof.sym src/prof_data.sym src/prof_log.sym src/prof_recent.sym src/prof_stats.sym src/prof_sys.sym src/psset.sym src/rtree.sym src/safety_check.sym src/sc.sym src/sec.sym src/stats.sym src/sz.sym src/tcache.sym src/test_hooks.sym src/thread_event.sym src/ticker.sym src/tsd.sym src/witness.sym src/zone.sym > include/jemalloc/internal/private_namespace.gen.h
cp include/jemalloc/internal/private_namespace.gen.h include/jemalloc/internal/private_namespace.h
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/jemalloc.pic.o src/jemalloc.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/arena.pic.o src/arena.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/background_thread.pic.o src/background_thread.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/base.pic.o src/base.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/bin.pic.o src/bin.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/bin_info.pic.o src/bin_info.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/bitmap.pic.o src/bitmap.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/buf_writer.pic.o src/buf_writer.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/cache_bin.pic.o src/cache_bin.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ckh.pic.o src/ckh.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/counter.pic.o src/counter.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ctl.pic.o src/ctl.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/decay.pic.o src/decay.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/div.pic.o src/div.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ecache.pic.o src/ecache.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/edata.pic.o src/edata.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/edata_cache.pic.o src/edata_cache.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ehooks.pic.o src/ehooks.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/emap.pic.o src/emap.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/eset.pic.o src/eset.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/exp_grow.pic.o src/exp_grow.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/extent.pic.o src/extent.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/extent_dss.pic.o src/extent_dss.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/extent_mmap.pic.o src/extent_mmap.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/fxp.pic.o src/fxp.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/hook.pic.o src/hook.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/hpa.pic.o src/hpa.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/hpa_central.pic.o src/hpa_central.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/hpdata.pic.o src/hpdata.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/inspect.pic.o src/inspect.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/large.pic.o src/large.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/log.pic.o src/log.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/malloc_io.pic.o src/malloc_io.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/mutex.pic.o src/mutex.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/nstime.pic.o src/nstime.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pa.pic.o src/pa.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pa_extra.pic.o src/pa_extra.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pai.pic.o src/pai.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pac.pic.o src/pac.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pages.pic.o src/pages.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/peak_event.pic.o src/peak_event.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof.pic.o src/prof.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_data.pic.o src/prof_data.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_log.pic.o src/prof_log.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_recent.pic.o src/prof_recent.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_stats.pic.o src/prof_stats.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_sys.pic.o src/prof_sys.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/psset.pic.o src/psset.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/rtree.pic.o src/rtree.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/safety_check.pic.o src/safety_check.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/sc.pic.o src/sc.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/sec.pic.o src/sec.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/stats.pic.o src/stats.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/sz.pic.o src/sz.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/tcache.pic.o src/tcache.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/test_hooks.pic.o src/test_hooks.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/thread_event.pic.o src/thread_event.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ticker.pic.o src/ticker.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/tsd.pic.o src/tsd.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/witness.pic.o src/witness.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/zone.pic.o src/zone.c
g++ -std=c++17 -Wall -Wextra -g3 -Wimplicit-fallthrough -O3 -fPIC -DPIC -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/jemalloc_cpp.pic.o src/jemalloc_cpp.cpp
In file included from src/jemalloc_cpp.cpp:10:
In file included from include/jemalloc/internal/jemalloc_internal_includes.h:51:
In file included from include/jemalloc/internal/prof_structs.h:4:
In file included from include/jemalloc/internal/ckh.h:4:
In file included from include/jemalloc/internal/tsd.h:303:
include/jemalloc/internal/tsd_generic.h:91:24: warning: suggest braces around initialization of subobject [-Wmissing-braces]
                        tsd_t initializer = TSD_INITIALIZER;
                                            ^~~~~~~~~~~~~~~
include/jemalloc/internal/tsd.h:146:9: note: expanded from macro 'TSD_INITIALIZER'
                                TSD_DATA_SLOW_INITIALIZER               \
                                ^~~~~~~~~~~~~~~~~~~~~~~~~
include/jemalloc/internal/tsd.h:117:24: note: expanded from macro 'TSD_DATA_SLOW_INITIALIZER'
    /* tcache_slow */           TCACHE_SLOW_ZERO_INITIALIZER,           \
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
include/jemalloc/internal/tcache_types.h:22:39: note: expanded from macro 'TCACHE_SLOW_ZERO_INITIALIZER'
#define TCACHE_SLOW_ZERO_INITIALIZER {0}
                                      ^
In file included from src/jemalloc_cpp.cpp:10:
In file included from include/jemalloc/internal/jemalloc_internal_includes.h:51:
In file included from include/jemalloc/internal/prof_structs.h:4:
In file included from include/jemalloc/internal/ckh.h:4:
In file included from include/jemalloc/internal/tsd.h:303:
include/jemalloc/internal/tsd_generic.h:134:22: warning: suggest braces around initialization of subobject [-Wmissing-braces]
        tsd_t initializer = TSD_INITIALIZER;
                            ^~~~~~~~~~~~~~~
include/jemalloc/internal/tsd.h:146:9: note: expanded from macro 'TSD_INITIALIZER'
                                TSD_DATA_SLOW_INITIALIZER               \
                                ^~~~~~~~~~~~~~~~~~~~~~~~~
include/jemalloc/internal/tsd.h:117:24: note: expanded from macro 'TSD_DATA_SLOW_INITIALIZER'
    /* tcache_slow */           TCACHE_SLOW_ZERO_INITIALIZER,           \
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
include/jemalloc/internal/tcache_types.h:22:39: note: expanded from macro 'TCACHE_SLOW_ZERO_INITIALIZER'
#define TCACHE_SLOW_ZERO_INITIALIZER {0}
                                      ^
In file included from src/jemalloc_cpp.cpp:10:
In file included from include/jemalloc/internal/jemalloc_internal_includes.h:77:
In file included from include/jemalloc/internal/jemalloc_internal_inlines_b.h:4:
include/jemalloc/internal/extent.h:86:10: warning: implicit conversion of NULL constant to 'bool' [-Wnull-conversion]
                return NULL;
                ~~~~~~ ^~~~
                       false
3 warnings generated.
gcc -shared -Wl,-install_name,/usr/local/lib/libjemalloc.2.dylib  -o lib/libjemalloc.2.dylib src/jemalloc.pic.o src/arena.pic.o src/background_thread.pic.o src/base.pic.o src/bin.pic.o src/bin_info.pic.o src/bitmap.pic.o src/buf_writer.pic.o src/cache_bin.pic.o src/ckh.pic.o src/counter.pic.o src/ctl.pic.o src/decay.pic.o src/div.pic.o src/ecache.pic.o src/edata.pic.o src/edata_cache.pic.o src/ehooks.pic.o src/emap.pic.o src/eset.pic.o src/exp_grow.pic.o src/extent.pic.o src/extent_dss.pic.o src/extent_mmap.pic.o src/fxp.pic.o src/hook.pic.o src/hpa.pic.o src/hpa_central.pic.o src/hpdata.pic.o src/inspect.pic.o src/large.pic.o src/log.pic.o src/malloc_io.pic.o src/mutex.pic.o src/nstime.pic.o src/pa.pic.o src/pa_extra.pic.o src/pai.pic.o src/pac.pic.o src/pages.pic.o src/peak_event.pic.o src/prof.pic.o src/prof_data.pic.o src/prof_log.pic.o src/prof_recent.pic.o src/prof_stats.pic.o src/prof_sys.pic.o src/psset.pic.o src/rtree.pic.o src/safety_check.pic.o src/sc.pic.o src/sec.pic.o src/stats.pic.o src/sz.pic.o src/tcache.pic.o src/test_hooks.pic.o src/thread_event.pic.o src/ticker.pic.o src/tsd.pic.o src/witness.pic.o src/zone.pic.o src/jemalloc_cpp.pic.o -pthread -ldl -lsnappy -lgflags -lz -lbz2 -llz4 -lzstd  -lstdc++ -pthread 
ln -sf libjemalloc.2.dylib lib/libjemalloc.dylib
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/jemalloc.o src/jemalloc.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/arena.o src/arena.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/background_thread.o src/background_thread.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/base.o src/base.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/bin.o src/bin.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/bin_info.o src/bin_info.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/bitmap.o src/bitmap.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/buf_writer.o src/buf_writer.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/cache_bin.o src/cache_bin.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ckh.o src/ckh.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/counter.o src/counter.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ctl.o src/ctl.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/decay.o src/decay.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/div.o src/div.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ecache.o src/ecache.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/edata.o src/edata.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/edata_cache.o src/edata_cache.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ehooks.o src/ehooks.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/emap.o src/emap.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/eset.o src/eset.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/exp_grow.o src/exp_grow.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/extent.o src/extent.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/extent_dss.o src/extent_dss.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/extent_mmap.o src/extent_mmap.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/fxp.o src/fxp.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/hook.o src/hook.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/hpa.o src/hpa.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/hpa_central.o src/hpa_central.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/hpdata.o src/hpdata.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/inspect.o src/inspect.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/large.o src/large.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/log.o src/log.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/malloc_io.o src/malloc_io.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/mutex.o src/mutex.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/nstime.o src/nstime.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pa.o src/pa.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pa_extra.o src/pa_extra.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pai.o src/pai.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pac.o src/pac.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/pages.o src/pages.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/peak_event.o src/peak_event.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof.o src/prof.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_data.o src/prof_data.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_log.o src/prof_log.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_recent.o src/prof_recent.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_stats.o src/prof_stats.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/prof_sys.o src/prof_sys.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/psset.o src/psset.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/rtree.o src/rtree.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/safety_check.o src/safety_check.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/sc.o src/sc.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/sec.o src/sec.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/stats.o src/stats.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/sz.o src/sz.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/tcache.o src/tcache.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/test_hooks.o src/test_hooks.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/thread_event.o src/thread_event.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/ticker.o src/ticker.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/tsd.o src/tsd.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/witness.o src/witness.c
gcc -std=gnu11 -Wall -Wextra -Wshorten-64-to-32 -Wsign-compare -Wundef -Wno-format-zero-length -Wpointer-arith -Wno-missing-braces -Wno-missing-field-initializers -pipe -g3 -Wimplicit-fallthrough -O3 -funroll-loops -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/zone.o src/zone.c
g++ -std=c++17 -Wall -Wextra -g3 -Wimplicit-fallthrough -O3 -c -I/usr/local/opt/llvm/include -D_REENTRANT -Iinclude -Iinclude -o src/jemalloc_cpp.o src/jemalloc_cpp.cpp
In file included from src/jemalloc_cpp.cpp:10:
In file included from include/jemalloc/internal/jemalloc_internal_includes.h:51:
In file included from include/jemalloc/internal/prof_structs.h:4:
In file included from include/jemalloc/internal/ckh.h:4:
In file included from include/jemalloc/internal/tsd.h:303:
include/jemalloc/internal/tsd_generic.h:91:24: warning: suggest braces around initialization of subobject [-Wmissing-braces]
                        tsd_t initializer = TSD_INITIALIZER;
                                            ^~~~~~~~~~~~~~~
include/jemalloc/internal/tsd.h:146:9: note: expanded from macro 'TSD_INITIALIZER'
                                TSD_DATA_SLOW_INITIALIZER               \
                                ^~~~~~~~~~~~~~~~~~~~~~~~~
include/jemalloc/internal/tsd.h:117:24: note: expanded from macro 'TSD_DATA_SLOW_INITIALIZER'
    /* tcache_slow */           TCACHE_SLOW_ZERO_INITIALIZER,           \
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
include/jemalloc/internal/tcache_types.h:22:39: note: expanded from macro 'TCACHE_SLOW_ZERO_INITIALIZER'
#define TCACHE_SLOW_ZERO_INITIALIZER {0}
                                      ^
In file included from src/jemalloc_cpp.cpp:10:
In file included from include/jemalloc/internal/jemalloc_internal_includes.h:51:
In file included from include/jemalloc/internal/prof_structs.h:4:
In file included from include/jemalloc/internal/ckh.h:4:
In file included from include/jemalloc/internal/tsd.h:303:
include/jemalloc/internal/tsd_generic.h:134:22: warning: suggest braces around initialization of subobject [-Wmissing-braces]
        tsd_t initializer = TSD_INITIALIZER;
                            ^~~~~~~~~~~~~~~
include/jemalloc/internal/tsd.h:146:9: note: expanded from macro 'TSD_INITIALIZER'
                                TSD_DATA_SLOW_INITIALIZER               \
                                ^~~~~~~~~~~~~~~~~~~~~~~~~
include/jemalloc/internal/tsd.h:117:24: note: expanded from macro 'TSD_DATA_SLOW_INITIALIZER'
    /* tcache_slow */           TCACHE_SLOW_ZERO_INITIALIZER,           \
                                ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
include/jemalloc/internal/tcache_types.h:22:39: note: expanded from macro 'TCACHE_SLOW_ZERO_INITIALIZER'
#define TCACHE_SLOW_ZERO_INITIALIZER {0}
                                      ^
In file included from src/jemalloc_cpp.cpp:10:
In file included from include/jemalloc/internal/jemalloc_internal_includes.h:77:
In file included from include/jemalloc/internal/jemalloc_internal_inlines_b.h:4:
include/jemalloc/internal/extent.h:86:10: warning: implicit conversion of NULL constant to 'bool' [-Wnull-conversion]
                return NULL;
                ~~~~~~ ^~~~
                       false
3 warnings generated.
ar crus lib/libjemalloc.a src/jemalloc.o src/arena.o src/background_thread.o src/base.o src/bin.o src/bin_info.o src/bitmap.o src/buf_writer.o src/cache_bin.o src/ckh.o src/counter.o src/ctl.o src/decay.o src/div.o src/ecache.o src/edata.o src/edata_cache.o src/ehooks.o src/emap.o src/eset.o src/exp_grow.o src/extent.o src/extent_dss.o src/extent_mmap.o src/fxp.o src/hook.o src/hpa.o src/hpa_central.o src/hpdata.o src/inspect.o src/large.o src/log.o src/malloc_io.o src/mutex.o src/nstime.o src/pa.o src/pa_extra.o src/pai.o src/pac.o src/pages.o src/peak_event.o src/prof.o src/prof_data.o src/prof_log.o src/prof_recent.o src/prof_stats.o src/prof_sys.o src/psset.o src/rtree.o src/safety_check.o src/sc.o src/sec.o src/stats.o src/sz.o src/tcache.o src/test_hooks.o src/thread_event.o src/ticker.o src/tsd.o src/witness.o src/zone.o src/jemalloc_cpp.o
ar crus lib/libjemalloc_pic.a src/jemalloc.pic.o src/arena.pic.o src/background_thread.pic.o src/base.pic.o src/bin.pic.o src/bin_info.pic.o src/bitmap.pic.o src/buf_writer.pic.o src/cache_bin.pic.o src/ckh.pic.o src/counter.pic.o src/ctl.pic.o src/decay.pic.o src/div.pic.o src/ecache.pic.o src/edata.pic.o src/edata_cache.pic.o src/ehooks.pic.o src/emap.pic.o src/eset.pic.o src/exp_grow.pic.o src/extent.pic.o src/extent_dss.pic.o src/extent_mmap.pic.o src/fxp.pic.o src/hook.pic.o src/hpa.pic.o src/hpa_central.pic.o src/hpdata.pic.o src/inspect.pic.o src/large.pic.o src/log.pic.o src/malloc_io.pic.o src/mutex.pic.o src/nstime.pic.o src/pa.pic.o src/pa_extra.pic.o src/pai.pic.o src/pac.pic.o src/pages.pic.o src/peak_event.pic.o src/prof.pic.o src/prof_data.pic.o src/prof_log.pic.o src/prof_recent.pic.o src/prof_stats.pic.o src/prof_sys.pic.o src/psset.pic.o src/rtree.pic.o src/safety_check.pic.o src/sc.pic.o src/sec.pic.o src/stats.pic.o src/sz.pic.o src/tcache.pic.o src/test_hooks.pic.o src/thread_event.pic.o src/ticker.pic.o src/tsd.pic.o src/witness.pic.o src/zone.pic.o src/jemalloc_cpp.pic.o
export ROCKSDB_DISABLE_BZIP=1 ROCKSDB_DISABLE_ZLIB=1 ROCKSDB_DISABLE_LZ4=1; \
        export JEMALLOC=1 JEMALLOC_INCLUDE=-I/Users/moyong/project/kvrocks/external/jemalloc/include JEMALLOC_LIB=/Users/moyong/project/kvrocks/external/jemalloc/lib/libjemalloc.a; \
        /Applications/Xcode.app/Contents/Developer/usr/bin/make USE_RTTI=1 PORTABLE=1 -C /Users/moyong/project/kvrocks/external/rocksdb/ static_lib
$DEBUG_LEVEL is 0
  AR       librocksdb.a
llvm-ar: warning: creating librocksdb.a
    CC cluster.o
    CC compact_filter.o
    CC config.o
    CC cron.o
    CC encoding.o
    CC event_listener.o
    CC lock_manager.o
    CC log_collector.o
    CC redis_bitmap.o
    CC redis_bitmap_string.o
    CC redis_cmd.o
    CC redis_connection.o
    CC redis_db.o
    CC redis_hash.o
    CC redis_list.o
    CC redis_metadata.o
    CC redis_slot.o
    CC redis_pubsub.o
    CC redis_reply.o
    CC redis_request.o
    CC redis_set.o
    CC redis_string.o
    CC redis_zset.o
    CC redis_geo.o
    CC replication.o
    CC server.o
    CC stats.o
    CC storage.o
    CC task_runner.o
    CC util.o
    CC geohash.o
    CC worker.o
    CC redis_sortedint.o
    CC compaction_checker.o
    CC table_properties_collector.o
    CC scripting.o
    CC sha1.o
    CC rand.o
    CC slot_migrate.o
    CC slot_import.o
    CC batch_extractor.o
    CC main.o
-pthread -ldl -lsnappy -lgflags -lz -lbz2 -llz4 -lzstd
/Users/moyong/project/kvrocks/external/glog/.libs/libglog.a /Users/moyong/project/kvrocks/external/libevent/.libs/libevent.a /Users/moyong/project/kvrocks/external/libevent/.libs/libevent_pthreads.a /Users/moyong/project/kvrocks/external/rocksdb/librocksdb.a /Users/moyong/project/kvrocks/external/lua/src/liblua.a /Users/moyong/project/kvrocks/external/jemalloc/lib/libjemalloc.a
/Users/moyong/project/kvrocks/external/jemalloc/lib/libjemalloc.a /Users/moyong/project/kvrocks/external/glog/.libs/libglog.a /Users/moyong/project/kvrocks/external/libevent/.libs/libevent.a /Users/moyong/project/kvrocks/external/rocksdb/librocksdb.a /Users/moyong/project/kvrocks/external/lua/src/liblua.a
# @echo cluster.o compact_filter.o config.o cron.o encoding.o event_listener.o lock_manager.o log_collector.o redis_bitmap.o redis_bitmap_string.o redis_cmd.o redis_connection.o redis_db.o redis_hash.o redis_list.o redis_metadata.o redis_slot.o redis_pubsub.o redis_reply.o redis_request.o redis_set.o redis_string.o redis_zset.o redis_geo.o replication.o server.o stats.o storage.o task_runner.o util.o geohash.o worker.o redis_sortedint.o compaction_checker.o table_properties_collector.o scripting.o sha1.o rand.o slot_migrate.o slot_import.o batch_extractor.o main.o
    LINK kvrocks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5B2mU-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/536,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5B2mzr,kvrocks,1104833771,536,NA,supermy,7570552,supermy,springclick@gmail.com,NA,2022-04-21T07:52:43Z,2022-04-21T07:52:43Z,"why ?

# Operating system
ifeq ($(uname_S),Darwin)
 	# Darwin
 	DISABLE_JEMALLOC=1
 else
 endif
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5B2mzr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/536,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5B3odi,kvrocks,1105102690,536,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-04-21T11:46:53Z,2022-04-21T11:46:53Z,"Do you mean why we disabled the jemalloc on MacOSX? If yes, the reason was that
we want to run memory sanitizer on MacOSX and use jemalloc may cause problem.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5B3odi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/536,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CO8n0,kvrocks,1111214580,536,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-04-27T16:34:49Z,2022-04-27T16:34:49Z,Will close this issue since lack of more context. Feel free to reopen if needed.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CO8n0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/537,https://api.github.com/repos/apache/kvrocks/issues/537,kvrocks,1211794170,537,[NEW] reduce concurrency conflicts by reduce the amount of concurrent data controlled by read-write locks,joeylichang,10592664,joey,joeycli0919@gmail.com,CLOSED,2022-04-22T04:14:07Z,2022-04-22T04:40:07Z,"**All workers preempt the global concurrent lock ‘RWLock::ReadWriteLock’**

All requests will preempt a global read-write lock (‘RWLock::ReadWriteLock’), but the data between requests is likely to have no conflict, increasing the waiting time of the lock.

**Increase the number of read-write locks and reduce the data range controlled by the locks**

E.g： 
1. RWLock::ReadWriteLock works_concurrency_rw_lock_[], the length called ‘len’.
 2. The key in the request is hashed by crc32, called 'hashkey'.
3. lock = works_concurrency_rw_lock_[hashkey % len], is request needs to preempte.

 The above method reduces the lock waiting time between requests and increases the amount of concurrency.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/537/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/541,https://api.github.com/repos/apache/kvrocks/issues/541,kvrocks,1216144671,541,[QUESTION] does kvrocks support pipeline command？,mythyygg,3206693,,,CLOSED,2022-04-26T15:39:01Z,2022-05-05T07:15:32Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/541/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/541,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CMCD2,kvrocks,1110450422,541,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-04-27T02:05:42Z,2022-04-27T02:05:42Z,"@ygmyth Kvrocks supported pipeline mode, can you offer more information about what's going wrong when using the pipeline mode. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CMCD2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/541,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cpwl1,kvrocks,1118243189,541,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-05T07:15:31Z,2022-05-05T07:15:31Z,@ygmyth Feel free to reopen if you have any question.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cpwl1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/542,https://api.github.com/repos/apache/kvrocks/issues/542,kvrocks,1219590865,542,[NEW] Apply Apache License header for source code,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-04-29T02:02:37Z,2022-04-29T03:13:30Z,"... and add a CI task to guard the situation.

This is a requirement for Apache release.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/542/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/544,https://api.github.com/repos/apache/kvrocks/issues/544,kvrocks,1219708694,544,[NEW] Add .asf.yaml file,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-04-29T03:22:58Z,2022-04-29T07:44:57Z,So that we can configure repo settings under apache org.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/544/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/547,https://api.github.com/repos/apache/kvrocks/issues/547,kvrocks,1221102311,547,[NEW] Apply Apache License header for Tcl files,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-04-29T15:35:26Z,2022-04-30T07:20:45Z,"This is a follow up to #542.

Finally I understand how to apply Apache License header for Tcl files.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/547/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/549,https://api.github.com/repos/apache/kvrocks/issues/549,kvrocks,1221684570,549,clear  call,liuqian1990,8868514,richie,,CLOSED,2022-04-30T01:21:01Z,2022-04-30T14:22:05Z,"`String::getValue value->clear();`  call clear
`String::getValues` not all clear
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/549/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/549,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CZJO4,kvrocks,1113887672,549,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-04-30T01:41:17Z,2022-04-30T01:41:17Z,"Thanks @liuqian1990 feedback. 

The String::getValues also clears the input values when calling the function `getRawValues`. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CZJO4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/549,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CZKt9,kvrocks,1113893757,549,NA,liuqian1990,8868514,richie,,NA,2022-04-30T02:17:32Z,2022-04-30T02:17:32Z,`function getRawValue also call clear`,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CZKt9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/549,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CZK6U,kvrocks,1113894548,549,NA,liuqian1990,8868514,richie,,NA,2022-04-30T02:22:59Z,2022-04-30T02:22:59Z,"`rocksdb::Status String::getRawValue(const std::string &ns_key, std::string *raw_value) {raw_value->clear();`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CZK6U/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/549,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CZayo,kvrocks,1113959592,549,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-04-30T09:49:25Z,2022-04-30T09:49:25Z,Sorry that I didn't get what your mean. Do you find any problems?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CZayo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/552,https://api.github.com/repos/apache/kvrocks/issues/552,kvrocks,1228486695,552,"[QUESTION]rocksdb is stored in key order, supports range api, redis does not support",melin,1145830,melin,,CLOSED,2022-05-07T01:29:15Z,2022-09-11T03:31:41Z,"rocksdb is stored in key order, supports range api, redis does not support","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/552/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/552,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cw3JJ,kvrocks,1120105033,552,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-05-07T01:36:34Z,2022-05-07T01:36:34Z,"Kvrocks supports rich Redis data types, some of which support range related APIs, like `zrange`, `lrange` etc, which you can find [here](https://github.com/apache/incubator-kvrocks/wiki/Support-Commands). Kvrocks implements the above APIs based on the rocksdb range APIs.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cw3JJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/552,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM6o,kvrocks,1242877608,552,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:31:41Z,2022-09-11T03:31:41Z,Closed as stale. You can ask questions at the [Discussions forum](https://github.com/apache/incubator-kvrocks/discussions/categories/q-a).,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM6o/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/556,https://api.github.com/repos/apache/kvrocks/issues/556,kvrocks,1228890677,556,[BUG] Failed to link jeamlloc when building with makefile,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-05-08T13:36:34Z,2022-05-09T06:06:21Z,"There're two issues when building with clang13 on MacOSX:
1. RocksDB can't be compiled with clang13, can be fixed by #555 
2. Failed to link jemalloc in rocksdb since rocksdb would auto detect and
enable the jemalloc if exists, but Kvrocks didn't link the jemalloc in MacOSX.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/556/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/556,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CyEQP,kvrocks,1120420879,556,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-08T13:38:35Z,2022-05-08T13:38:35Z,"I've tested with #555 but still failed to compile with:

```
    LINK kvrocks
Undefined symbols for architecture x86_64:
  ""_dallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_mallctl"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_mallctlbymib"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_mallctlnametomib"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_malloc_stats_print"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_malloc_usable_size"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_mallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_nallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_rallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_sallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_sdallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
  ""_xallocx"", referenced from:
      rocksdb::DumpMallocStats(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in librocksdb.a(malloc_stats.o)
ld: symbol(s) not found for architecture x86_64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[1]: *** [kvrocks] Error 1
make: *** [all] Error 2
```

with Clang version:

```
clang -v
Homebrew clang version 13.0.1
Target: x86_64-apple-darwin19.6.0
Thread model: posix
InstalledDir: /usr/local/opt/llvm/bin
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CyEQP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/556,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CyE3G,kvrocks,1120423366,556,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-08T13:54:53Z,2022-05-08T13:54:53Z,"Thanks @tisonkun

Need to run `make distclean` to rebuild dependencies. You can have a look at file `external/rocksdb/make_config.mk` should contain `JEAMLLOC=1` if didn't rebuild the rocksdb.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CyE3G/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/556,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cy6ub,kvrocks,1120643995,556,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-09T05:01:43Z,2022-05-09T05:01:43Z,"@git-hulk after this issue resolved, build still failed with:

<details>
<summary>Output</summary>
<pre>
$ clang -v
Homebrew clang version 13.0.1
Target: x86_64-apple-darwin19.6.0
Thread model: posix
InstalledDir: /usr/local/opt/llvm/bin
$ mkdir build
$ make -j8   
cd src && /Applications/Xcode.app/Contents/Developer/usr/bin/make all
cd /Users/tison/Brittani/incubator-kvrocks/external/glog;./autogen.sh; ./configure --disable-shared; \
		/Applications/Xcode.app/Contents/Developer/usr/bin/make CXXFLAGS='-fPIC' -C /Users/tison/Brittani/incubator-kvrocks/external/glog/
cd /Users/tison/Brittani/incubator-kvrocks/external/libevent; ./autogen.sh; \
		./configure --enable-shared=no --disable-openssl; \
		/Applications/Xcode.app/Contents/Developer/usr/bin/make -C /Users/tison/Brittani/incubator-kvrocks/external/libevent/
autoreconf: export WARNINGS=
autoreconf: Entering directory '.'
autoreconf: configure.ac: not using Gettext
autoreconf: running: aclocal --force -I m4
autoreconf: configure.ac: tracing
glibtoolize: putting auxiliary files in '.'.
glibtoolize: copying file './ltmain.sh'
glibtoolize: putting macros in AC_CONFIG_MACRO_DIRS, 'm4'.
glibtoolize: copying file 'm4/libtool.m4'
glibtoolize: copying file 'm4/ltoptions.m4'
autoreconf: running: glibtoolize --copy --force
glibtoolize: copying file 'm4/ltversion.m4'
glibtoolize: putting auxiliary files in '.'.
glibtoolize: copying file './ltmain.sh'
glibtoolize: putting macros in AC_CONFIG_MACRO_DIRS, 'm4'.
glibtoolize: copying file 'm4/libtool.m4'
glibtoolize: copying file 'm4/ltoptions.m4'
glibtoolize: copying file 'm4/ltsugar.m4'
glibtoolize: copying file 'm4/ltversion.m4'
glibtoolize: copying file 'm4/lt~obsolete.m4'
autoreconf: configure.ac: not using Intltool
autoreconf: configure.ac: not using Gtkdoc
autoreconf: running: aclocal --force -I m4
autoreconf: running: /usr/local/Cellar/autoconf/2.71/bin/autoconf --force
configure.ac:14: warning: 'AM_CONFIG_HEADER': this macro is obsolete.
configure.ac:14: You should use the 'AC_CONFIG_HEADERS' macro instead.
./lib/autoconf/general.m4:2434: AC_DIAGNOSE is expanded from...
aclocal.m4:745: AM_CONFIG_HEADER is expanded from...
configure.ac:14: the top level
configure.ac:24: warning: The macro `AC_PROG_LIBTOOL' is obsolete.
configure.ac:24: You should run autoupdate.
m4/libtool.m4:100: AC_PROG_LIBTOOL is expanded from...
configure.ac:24: the top level
configure.ac:28: warning: The macro `AC_HEADER_STDC' is obsolete.
configure.ac:28: You should run autoupdate.
./lib/autoconf/headers.m4:704: AC_HEADER_STDC is expanded from...
configure.ac:28: the top level
configure.ac:83: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:83: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
m4/ac_have_attribute.m4:1: AX_C___ATTRIBUTE__ is expanded from...
configure.ac:83: the top level
configure.ac:95: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:95: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
m4/ac_have_builtin_expect.m4:1: AX_C___BUILTIN_EXPECT is expanded from...
configure.ac:95: the top level
configure.ac:102: warning: The macro `AC_TRY_LINK' is obsolete.
configure.ac:102: You should run autoupdate.
./lib/autoconf/general.m4:2920: AC_TRY_LINK is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
m4/ac_have_sync_val_compare_and_swap.m4:1: AX_C___SYNC_VAL_COMPARE_AND_SWAP is expanded from...
configure.ac:102: the top level
configure.ac:124: warning: The macro `AC_LANG_C' is obsolete.
configure.ac:124: You should run autoupdate.
./lib/autoconf/c.m4:72: AC_LANG_C is expanded from...
m4/acx_pthread.m4:63: ACX_PTHREAD is expanded from...
configure.ac:124: the top level
configure.ac:124: warning: The macro `AC_TRY_LINK' is obsolete.
configure.ac:124: You should run autoupdate.
./lib/autoconf/general.m4:2920: AC_TRY_LINK is expanded from...
m4/acx_pthread.m4:63: ACX_PTHREAD is expanded from...
configure.ac:124: the top level
configure.ac:197: warning: The macro `AC_LANG_C' is obsolete.
configure.ac:197: You should run autoupdate.
./lib/autoconf/c.m4:72: AC_LANG_C is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/ac_rwlock.m4:15: AC_RWLOCK is expanded from...
configure.ac:197: the top level
configure.ac:197: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:197: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/ac_rwlock.m4:15: AC_RWLOCK is expanded from...
configure.ac:197: the top level
configure.ac:201: warning: The macro `AC_LANG_CPLUSPLUS' is obsolete.
configure.ac:201: You should run autoupdate.
./lib/autoconf/c.m4:262: AC_LANG_CPLUSPLUS is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/namespaces.m4:2: AC_CXX_NAMESPACES is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/stl_namespace.m4:3: AC_CXX_STL_NAMESPACE is expanded from...
configure.ac:201: the top level
configure.ac:201: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:201: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/namespaces.m4:2: AC_CXX_NAMESPACES is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/stl_namespace.m4:3: AC_CXX_STL_NAMESPACE is expanded from...
configure.ac:201: the top level
configure.ac:201: warning: The macro `AC_LANG_CPLUSPLUS' is obsolete.
configure.ac:201: You should run autoupdate.
./lib/autoconf/c.m4:262: AC_LANG_CPLUSPLUS is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/stl_namespace.m4:3: AC_CXX_STL_NAMESPACE is expanded from...
configure.ac:201: the top level
configure.ac:201: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:201: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/stl_namespace.m4:3: AC_CXX_STL_NAMESPACE is expanded from...
configure.ac:201: the top level
configure.ac:204: warning: The macro `AC_LANG_CPLUSPLUS' is obsolete.
configure.ac:204: You should run autoupdate.
./lib/autoconf/c.m4:262: AC_LANG_CPLUSPLUS is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/using_operator.m4:1: AC_CXX_USING_OPERATOR is expanded from...
configure.ac:204: the top level
configure.ac:204: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:204: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2249: AC_CACHE_VAL is expanded from...
./lib/autoconf/general.m4:2270: AC_CACHE_CHECK is expanded from...
m4/using_operator.m4:1: AC_CXX_USING_OPERATOR is expanded from...
configure.ac:204: the top level
configure.ac:206: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:206: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
m4/pc_from_ucontext.m4:12: AC_PC_FROM_UCONTEXT is expanded from...
configure.ac:206: the top level
configure.ac:246: warning: AC_OUTPUT should be used without arguments.
configure.ac:246: You should run autoupdate.
configure.ac:129: warning: The macro `AC_PROG_LIBTOOL' is obsolete.
configure.ac:129: You should run autoupdate.
m4/libtool.m4:100: AC_PROG_LIBTOOL is expanded from...
configure.ac:129: the top level
configure.ac:153: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:153: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
configure.ac:153: the top level
configure.ac:166: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:166: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
configure.ac:166: the top level
configure.ac:179: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:179: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
configure.ac:179: the top level
configure.ac:353: warning: The macro `AC_HEADER_TIME' is obsolete.
configure.ac:353: You should run autoupdate.
./lib/autoconf/headers.m4:743: AC_HEADER_TIME is expanded from...
configure.ac:353: the top level
configure.ac:427: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:427: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2823: _AC_COMPILE_IFELSE is expanded from...
./lib/autoconf/general.m4:2839: AC_COMPILE_IFELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/functions.m4:66: AC_CHECK_FUNC is expanded from...
configure.ac:427: the top level
configure.ac:427: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:427: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2823: _AC_COMPILE_IFELSE is expanded from...
./lib/autoconf/general.m4:2839: AC_COMPILE_IFELSE is expanded from...
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
lib/m4sugar/m4sh.m4:692: _AS_IF_ELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/general.m4:2823: _AC_COMPILE_IFELSE is expanded from...
./lib/autoconf/general.m4:2839: AC_COMPILE_IFELSE is expanded from...
lib/m4sugar/m4sh.m4:699: AS_IF is expanded from...
./lib/autoconf/functions.m4:66: AC_CHECK_FUNC is expanded from...
configure.ac:427: the top level
configure.ac:520: warning: The macro `AC_TRY_RUN' is obsolete.
configure.ac:520: You should run autoupdate.
./lib/autoconf/general.m4:2997: AC_TRY_RUN is expanded from...
configure.ac:520: the top level
configure.ac:592: warning: The macro `AC_TRY_RUN' is obsolete.
configure.ac:592: You should run autoupdate.
./lib/autoconf/general.m4:2997: AC_TRY_RUN is expanded from...
configure.ac:592: the top level
configure.ac:732: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:732: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
configure.ac:732: the top level
configure.ac:748: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:748: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
configure.ac:748: the top level
configure.ac:756: warning: The macro `AC_TRY_COMPILE' is obsolete.
configure.ac:756: You should run autoupdate.
./lib/autoconf/general.m4:2847: AC_TRY_COMPILE is expanded from...
configure.ac:756: the top level
configure.ac:767: warning: The macro `AC_LANG_C' is obsolete.
configure.ac:767: You should run autoupdate.
./lib/autoconf/c.m4:72: AC_LANG_C is expanded from...
m4/acx_pthread.m4:86: ACX_PTHREAD is expanded from...
configure.ac:767: the top level
configure.ac:767: warning: The macro `AC_TRY_LINK' is obsolete.
configure.ac:767: You should run autoupdate.
./lib/autoconf/general.m4:2920: AC_TRY_LINK is expanded from...
m4/acx_pthread.m4:86: ACX_PTHREAD is expanded from...
configure.ac:767: the top level
configure.ac:955: warning: AC_OUTPUT should be used without arguments.
configure.ac:955: You should run autoupdate.
autoreconf: running: /usr/local/Cellar/autoconf/2.71/bin/autoheader --force
autoreconf: running: automake --add-missing --copy --force-missing
configure.ac:19: installing './compile'
configure.ac:24: installing './config.guess'
configure.ac:24: installing './config.sub'
configure.ac:13: installing './install-sh'
configure.ac:13: installing './missing'
Makefile.am: installing './depcomp'
parallel-tests: installing './test-driver'
configure.ac:25: installing './compile'
configure.ac:33: installing './config.guess'
configure.ac:33: installing './config.sub'
configure.ac:13: installing './install-sh'
configure.ac:13: installing './missing'
Makefile.am: installing './depcomp'
parallel-tests: installing './test-driver'
autoreconf: Leaving directory '.'
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a race-free mkdir -p... ./install-sh -c -d
checking for gawk... no
checking for mawk... no
checking for nawk... no
checking for awk... awk
checking whether make sets $(MAKE)... yes
checking whether make supports nested variables... yes
checking for gcc... gcc
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a race-free mkdir -p... ./install-sh -c -d
checking for gawk... no
checking for mawk... no
checking for nawk... no
checking for awk... awk
checking whether make sets $(MAKE)... yes
checking whether make supports nested variables... yes
checking whether make supports nested variables... (cached) yes
checking whether make supports the include directive... yes (GNU style)
checking for gcc... gcc
checking whether the C compiler works... no
checking for suffix of object files... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... o
checking whether the compiler supports GNU C... yes
checking whether gcc accepts -g... 
checking whether we are cross compiling... yes
checking for gcc option to enable C11 features... none needed
checking whether gcc understands -c and -o together... no
checking for suffix of object files... yes
checking whether make supports the include directive... o
checking whether the compiler supports GNU C... yes (GNU style)
checking dependency style of gcc... yes
checking whether gcc accepts -g... yes
checking for gcc option to enable C11 features... gcc3
checking how to run the C preprocessor... none needed
checking whether gcc understands -c and -o together... gcc -E
yes
checking dependency style of gcc... checking for g++... g++
gcc3
checking for stdio.h... yes
checking for stdlib.h... yes
checking for string.h... checking whether the compiler supports GNU C++... yes
checking whether g++ accepts -g... yes
checking for inttypes.h... yes
checking for g++ option to enable C++11 features... yes
checking for stdint.h... yes
checking for strings.h... none needed
checking dependency style of g++... yes
checking for sys/stat.h... yes
checking for sys/types.h... gcc3
checking build system type... yes
checking for unistd.h... yes
checking for wchar.h... x86_64-apple-darwin19.6.0
checking host system type... x86_64-apple-darwin19.6.0
checking how to print strings... printf
checking for a sed that does not truncate output... yes
checking for minix/config.h... no
checking for sys/time.h... /usr/bin/sed
checking for grep that handles long lines and -e... yes
checking whether it is safe to define __EXTENSIONS__... yes
checking whether _XOPEN_SOURCE should be defined... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking for fgrep... /usr/bin/grep -F
checking for ld used by gcc... no
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld
checking if the linker (/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld) is GNU ld... checking build system type... x86_64-apple-darwin19.6.0
checking host system type... x86_64-apple-darwin19.6.0
checking whether ln -s works... yes
checking for a sed that does not truncate output... no
checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
checking the name lister (/usr/bin/nm -B) interface... /usr/bin/sed
checking how to run the C preprocessor... BSD nm
checking whether ln -s works... yes
checking the maximum length of command line arguments... 196608
checking how to convert x86_64-apple-darwin19.6.0 file names to x86_64-apple-darwin19.6.0 format... func_convert_file_noop
checking how to convert x86_64-apple-darwin19.6.0 file names to toolchain format... func_convert_file_noop
checking for /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld option to reload object files... -r
checking for file... file
checking for objdump... objdump
checking how to recognize dependent libraries... pass_all
checking for dlltool... no
checking how to associate runtime and link libraries... printf %s\n
checking for ar... ar
checking for archiver @FILE support... gcc -E
no
checking for strip... strip
checking for ranlib... ranlib
checking command to parse /usr/bin/nm -B output from gcc object... checking for grep that handles long lines and -e... /usr/bin/grep
checking for egrep... /usr/bin/grep -E
checking whether gcc needs -traditional... no
checking how to print strings... printf
checking for a sed that does not truncate output... (cached) /usr/bin/sed
checking for fgrep... /usr/bin/grep -F
checking for ld used by gcc... /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld
checking if the linker (/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld) is GNU ld... no
checking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B
checking the name lister (/usr/bin/nm -B) interface... BSD nm
checking the maximum length of command line arguments... 196608
checking how to convert x86_64-apple-darwin19.6.0 file names to x86_64-apple-darwin19.6.0 format... func_convert_file_noop
checking how to convert x86_64-apple-darwin19.6.0 file names to toolchain format... func_convert_file_noop
checking for /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld option to reload object files... -r
checking for file... file
checking for objdump... objdump
checking how to recognize dependent libraries... pass_all
checking for dlltool... no
checking how to associate runtime and link libraries... printf %s\n
checking for ar... ar
checking for archiver @FILE support... ok
checking for sysroot... no
checking for a working dd... no
checking for strip... strip
checking for ranlib... ranlib
checking command to parse /usr/bin/nm -B output from gcc object... /bin/dd
checking how to truncate binary pipes... /bin/dd bs=4096 count=1
checking for mt... no
checking if : is a manifest tool... no
checking for dsymutil... dsymutil
checking for nmedit... nmedit
checking for lipo... lipo
checking for otool... otool
checking for otool64... no
checking for -single_module linker flag... yes
checking for -exported_symbols_list linker flag... yes
checking for -force_load linker flag... ok
checking for sysroot... no
checking for a working dd... /bin/dd
checking how to truncate binary pipes... /bin/dd bs=4096 count=1
checking for mt... no
checking if : is a manifest tool... no
checking for dsymutil... dsymutil
checking for nmedit... nmedit
checking for lipo... lipo
checking for otool... otool
checking for otool64... no
checking for -single_module linker flag... yes
checking for stdio.h... yes
checking for -exported_symbols_list linker flag... yes
checking for stdlib.h... yes
checking for -force_load linker flag... yes
checking for string.h... yes
checking for inttypes.h... yes
checking for dlfcn.h... yes
checking for objdir... .libs
yes
checking for stdint.h... yes
checking for strings.h... checking if gcc supports -fno-rtti -fno-exceptions... yes
checking for gcc option to produce PIC... -fno-common -DPIC
checking if gcc PIC flag -fno-common -DPIC works... yes
checking for sys/stat.h... yes
checking if gcc static flag -static works... no
checking if gcc supports -c -o file.o... yes
checking for sys/types.h... yes
checking if gcc supports -c -o file.o... (cached) yes
checking whether the gcc linker (/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld) supports shared libraries... yes
checking dynamic linker characteristics... yes
checking for unistd.h... darwin19.6.0 dyld
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... no
checking whether to build static libraries... yes
checking for library containing inet_ntoa... yes
checking for dlfcn.h... none required
checking for library containing socket... yes
checking for objdir... .libs
none required
checking for library containing inet_aton... none required
checking for library containing clock_gettime... checking if gcc supports -fno-rtti -fno-exceptions... yes
checking for gcc option to produce PIC... -fno-common -DPIC
checking if gcc PIC flag -fno-common -DPIC works... none required
checking for clock_gettime... yes
checking if gcc static flag -static works... no
checking if gcc supports -c -o file.o... yes
checking for library containing sendfile... yes
checking if gcc supports -c -o file.o... (cached) yes
checking whether the gcc linker (/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld) supports shared libraries... yes
checking dynamic linker characteristics... none required
checking for WIN32... darwin19.6.0 dyld
checking how to hardcode library paths into programs... immediate
checking whether stripping libraries is possible... yes
checking if libtool supports shared libraries... yes
checking whether to build shared libraries... no
checking whether to build static libraries... yes
no
checking for MIDIPIX... checking how to run the C++ preprocessor... no
checking for CYGWIN... no
checking for zlib.h... g++ -E
yes
checking for library containing inflateEnd... checking for ld used by g++... -lz
checking for special C compiler options needed for large files... no
checking for _FILE_OFFSET_BITS value needed for large files... /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld
checking if the linker (/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld) is GNU ld... no
checking whether the g++ linker (/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld) supports shared libraries... yes
no
checking for pkg-config... /usr/local/bin/pkg-config
checking if pkg-config is at least version 0.15.0... yes
checking for arpa/inet.h... checking for g++ option to produce PIC... -fno-common -DPIC
checking if g++ PIC flag -fno-common -DPIC works... yes
checking if g++ static flag -static works... yes
checking for fcntl.h... no
checking if g++ supports -c -o file.o... yes
checking for ifaddrs.h... yes
checking if g++ supports -c -o file.o... (cached) yes
checking whether the g++ linker (/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/ld) supports shared libraries... yes
checking dynamic linker characteristics... darwin19.6.0 dyld
checking how to hardcode library paths into programs... immediate
checking for egrep... (cached) /usr/bin/grep -E
checking for stdint.h... (cached) yes
checking for sys/types.h... (cached) yes
checking for inttypes.h... (cached) yes
checking for pwd.h... yes
checking for mach/mach_time.h... yes
checking for netdb.h... yes
checking for unistd.h... (cached) yes
checking for syscall.h... yes
checking for netinet/in.h... no
checking for sys/syscall.h... yes
checking for netinet/in6.h... no
checking for netinet/tcp.h... yes
checking for execinfo.h... yes
checking for sys/un.h... yes
checking for libunwind.h... yes
checking for poll.h... yes
checking for port.h... yes
checking for ucontext.h... no
checking for stdarg.h... no
checking for sys/utsname.h... yes
checking for stddef.h... yes
checking for sys/devpoll.h... yes
checking for pwd.h... (cached) yes
checking for syslog.h... no
checking for sys/epoll.h... yes
checking for sys/time.h... no
checking for sys/event.h... yes
checking for sys/eventfd.h... yes
checking for glob.h... no
checking for sys/ioctl.h... yes
checking for unwind.h... yes
checking for sys/mman.h... yes
checking for sys/param.h... yes
checking for windows.h... yes
checking for sys/queue.h... yes
checking for sys/resource.h... no
checking size of void *... yes
checking for sys/select.h... yes
checking for sys/sendfile.h... no
checking for sys/socket.h... yes
checking for sys/stat.h... (cached) yes
checking for sys/time.h... (cached) yes
checking for sys/timerfd.h... no
checking for sys/uio.h... yes
checking for sys/wait.h... yes
checking for errno.h... 8
checking for uint16_t... yes
checking for sys/sysctl.h... yes
checking for TAILQ_FOREACH in sys/queue.h... yes
checking for timeradd in sys/time.h... yes
checking for timercmp in sys/time.h... yes
checking for u_int16_t... yes
checking for timerclear in sys/time.h... yes
checking for timerisset in sys/time.h... yes
checking for gcc options needed to detect all undeclared functions... yes
checking for __uint16... none needed
checking whether CTL_KERN is declared... yes
checking whether KERN_RANDOM is declared... no
checking for sigaltstack... no
checking whether RANDOM_UUID is declared... yes
checking for sigaction... no
checking whether KERN_ARND is declared... yes
checking for dladdr... no
checking for an ANSI C-conforming const... yes
checking for inline... yes
checking for fcntl... inline
checking for accept4... yes
checking for pread... no
checking for arc4random... yes
checking for pwrite... yes
checking for arc4random_buf... yes
checking for __attribute__... yes
checking for arc4random_addrandom... yes
checking for __builtin_expect... yes
checking for eventfd... yes
checking for __sync_val_compare_and_swap... no
checking for epoll_create1... yes
checking for the pthreads library -lpthreads... no
checking for fcntl... no
checking whether pthreads work without any flags... yes
checking for getegid... yes
checking for joinable pthread attribute... yes
checking for geteuid... PTHREAD_CREATE_JOINABLE
checking if more special flags are required for pthreads... -D_THREAD_SAFE
checking whether to check for GCC pthread/shared inconsistencies... yes
checking for getifaddrs... no
checking for pthread_self in -lpthread... yes
checking for getnameinfo... yes
checking for main in -lgflags... yes
checking for getprotobynumber... no
checking for gtest-config... no
checking for main in -lgtest... yes
checking for gettimeofday... yes
checking for backtrace in -lunwind... no
checking support for pthread_rwlock_* functions... yes
checking for inet_ntop... yes
checking whether the compiler implements namespaces... yes
checking what namespace STL code is in... yes
checking for inet_pton... yes
checking for issetugid... yes
checking for mach_absolute_time... yes
checking for mmap... yes
checking for nanosleep... yes
checking for pipe... std
checking whether compiler supports using ::operator<<... yes
checking for pipe2... no
checking for putenv... yes
checking for sendfile... yes
checking for setenv... 1
checking for ucontext.h... (cached) no
checking for sys/ucontext.h... yes
checking for setrlimit... yes
checking how to access the program counter from a struct ucontext... yes
checking for sigaction... yes
checking for signal... yes
checking for splice... no
checking for strlcpy... yes
checking for strsep... yes
checking for strtok_r... yes
checking for strtoll... yes
checking for sysctl... yes
checking for timerfd_create... uc_mcontext->__ss.__rip
no
checking for umask... checking that generated files are newer than configure... done
configure: creating ./config.status
yes
checking for unsetenv... yes
checking for usleep... yes
checking for vasprintf... yes
checking for getservbyname... yes
checking for getaddrinfo... yes
checking for F_SETFD in fcntl.h... yes
checking for select... yes
checking for poll... yes
checking for kqueue... yes
checking for working kqueue... config.status: creating Makefile
config.status: creating src/glog/logging.h
config.status: creating src/glog/raw_logging.h
config.status: creating src/glog/vlog_is_on.h
config.status: creating src/glog/stl_logging.h
config.status: creating libglog.pc
config.status: creating src/config.h
config.status: executing depfiles commands
yes
checking for epoll_ctl... no
checking for port_create... no
checking for pid_t... yes
checking for size_t... config.status: executing libtool commands
yes
checking for ssize_t... g++ -DHAVE_CONFIG_H -I. -I./src  -I./src  -D_THREAD_SAFE      -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare  -DNO_FRAME_POINTER  -fPIC -MT src/logging_unittest-logging_unittest.o -MD -MP -MF src/.deps/logging_unittest-logging_unittest.Tpo -c -o src/logging_unittest-logging_unittest.o `test -f 'src/logging_unittest.cc' || echo './'`src/logging_unittest.cc
/bin/sh ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I./src  -I./src     -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare  -DNO_FRAME_POINTER  -DNDEBUG -fPIC -MT src/libglog_la-logging.lo -MD -MP -MF src/.deps/libglog_la-logging.Tpo -c -o src/libglog_la-logging.lo `test -f 'src/logging.cc' || echo './'`src/logging.cc
/bin/sh ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I./src  -I./src     -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare  -DNO_FRAME_POINTER  -DNDEBUG -fPIC -MT src/libglog_la-raw_logging.lo -MD -MP -MF src/.deps/libglog_la-raw_logging.Tpo -c -o src/libglog_la-raw_logging.lo `test -f 'src/raw_logging.cc' || echo './'`src/raw_logging.cc
/bin/sh ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I./src  -I./src     -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare  -DNO_FRAME_POINTER  -DNDEBUG -fPIC -MT src/libglog_la-vlog_is_on.lo -MD -MP -MF src/.deps/libglog_la-vlog_is_on.Tpo -c -o src/libglog_la-vlog_is_on.lo `test -f 'src/vlog_is_on.cc' || echo './'`src/vlog_is_on.cc
/bin/sh ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I./src  -I./src     -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare  -DNO_FRAME_POINTER  -DNDEBUG -fPIC -MT src/libglog_la-utilities.lo -MD -MP -MF src/.deps/libglog_la-utilities.Tpo -c -o src/libglog_la-utilities.lo `test -f 'src/utilities.cc' || echo './'`src/utilities.cc
/bin/sh ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I./src  -I./src     -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare  -DNO_FRAME_POINTER  -DNDEBUG -fPIC -MT src/libglog_la-demangle.lo -MD -MP -MF src/.deps/libglog_la-demangle.Tpo -c -o src/libglog_la-demangle.lo `test -f 'src/demangle.cc' || echo './'`src/demangle.cc
/bin/sh ./libtool  --tag=CXX   --mode=compile g++ -DHAVE_CONFIG_H -I. -I./src  -I./src     -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare  -DNO_FRAME_POINTER  -DNDEBUG -fPIC -MT src/libglog_la-symbolize.lo -MD -MP -MF src/.deps/libglog_la-symbolize.Tpo -c -o src/libglog_la-symbolize.lo `test -f 'src/symbolize.cc' || echo './'`src/symbolize.cc
make[2]: *** read jobs pipe: Resource temporarily unavailable.  Stop.
make[2]: *** Waiting for unfinished jobs....
yes
checking for uint64_t... libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I./src -I./src -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare -DNO_FRAME_POINTER -DNDEBUG -fPIC -MT src/libglog_la-vlog_is_on.lo -MD -MP -MF src/.deps/libglog_la-vlog_is_on.Tpo -c src/vlog_is_on.cc -o src/libglog_la-vlog_is_on.o
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I./src -I./src -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare -DNO_FRAME_POINTER -DNDEBUG -fPIC -MT src/libglog_la-logging.lo -MD -MP -MF src/.deps/libglog_la-logging.Tpo -c src/logging.cc -o src/libglog_la-logging.o
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I./src -I./src -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare -DNO_FRAME_POINTER -DNDEBUG -fPIC -MT src/libglog_la-symbolize.lo -MD -MP -MF src/.deps/libglog_la-symbolize.Tpo -c src/symbolize.cc -o src/libglog_la-symbolize.o
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I./src -I./src -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare -DNO_FRAME_POINTER -DNDEBUG -fPIC -MT src/libglog_la-utilities.lo -MD -MP -MF src/.deps/libglog_la-utilities.Tpo -c src/utilities.cc -o src/libglog_la-utilities.o
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I./src -I./src -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare -DNO_FRAME_POINTER -DNDEBUG -fPIC -MT src/libglog_la-demangle.lo -MD -MP -MF src/.deps/libglog_la-demangle.Tpo -c src/demangle.cc -o src/libglog_la-demangle.o
libtool: compile:  g++ -DHAVE_CONFIG_H -I. -I./src -I./src -Wall -Wwrite-strings -Woverloaded-virtual -Wno-sign-compare -DNO_FRAME_POINTER -DNDEBUG -fPIC -MT src/libglog_la-raw_logging.lo -MD -MP -MF src/.deps/libglog_la-raw_logging.Tpo -c src/raw_logging.cc -o src/libglog_la-raw_logging.o
yes
checking for uint32_t... yes
checking for uint16_t... yes
checking for uint8_t... In file included from src/logging_unittest.cc:58:
./src/googletest.h:589:7: warning: 'operator new' is missing exception specification 'throw(std::bad_alloc)' [-Wmissing-exception-spec]
void* operator new(size_t size) {
      ^
                                throw(std::bad_alloc)
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/../include/c++/v1/new:186:66: note: previous declaration is here
_LIBCPP_NODISCARD_AFTER_CXX17 _LIBCPP_OVERRIDABLE_FUNC_VIS void* operator new(std::size_t __sz) _THROW_BAD_ALLOC;
                                                                 ^
In file included from src/logging_unittest.cc:58:
./src/googletest.h:596:7: warning: 'operator new[]' is missing exception specification 'throw(std::bad_alloc)' [-Wmissing-exception-spec]
void* operator new[](size_t size) {
      ^
                                  throw(std::bad_alloc)
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/../include/c++/v1/new:194:66: note: previous declaration is here
_LIBCPP_NODISCARD_AFTER_CXX17 _LIBCPP_OVERRIDABLE_FUNC_VIS void* operator new[](std::size_t __sz) _THROW_BAD_ALLOC;
                                                                 ^
In file included from src/logging_unittest.cc:58:
./src/googletest.h:600:6: warning: 'operator delete' is missing exception specification 'throw()' [-Wmissing-exception-spec]
void operator delete(void* p) {
     ^
                              throw()
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/../include/c++/v1/new:188:36: note: previous declaration is here
_LIBCPP_OVERRIDABLE_FUNC_VIS void  operator delete(void* __p) _NOEXCEPT;
                                   ^
In file included from src/logging_unittest.cc:58:
./src/googletest.h:604:6: warning: 'operator delete[]' is missing exception specification 'throw()' [-Wmissing-exception-spec]
void operator delete[](void* p) {
     ^
                                throw()
/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/../include/c++/v1/new:196:36: note: previous declaration is here
_LIBCPP_OVERRIDABLE_FUNC_VIS void  operator delete[](void* __p) _NOEXCEPT;
                                   ^
src/raw_logging.cc:139:3: warning: 'syscall' is deprecated: first deprecated in macOS 10.12 - syscall(2) is unsupported; please switch to a supported interface.
      For SYS_kdebug_trace use kdebug_signpost(). [-Wdeprecated-declarations]
  safe_write(STDERR_FILENO, buffer, strlen(buffer));
  ^
src/raw_logging.cc:63:34: note: expanded from macro 'safe_write'
# define safe_write(fd, s, len)  syscall(SYS_write, fd, s, len)
                                 ^
/Library/Developer/CommandLineTools/SDKs/MacOSX10.15.sdk/usr/include/unistd.h:742:6: note: 'syscall' has been explicitly marked deprecated here
int      syscall(int, ...);
         ^
src/utilities.cc:262:17: warning: 'syscall' is deprecated: first deprecated in macOS 10.12 - syscall(2) is unsupported; please switch to a supported interface.
      For SYS_kdebug_trace use kdebug_signpost(). [-Wdeprecated-declarations]
    pid_t tid = syscall(__NR_gettid);
                ^
/Library/Developer/CommandLineTools/SDKs/MacOSX10.15.sdk/usr/include/unistd.h:742:6: note: 'syscall' has been explicitly marked deprecated here
int      syscall(int, ...);
         ^
mv -f src/.deps/libglog_la-symbolize.Tpo src/.deps/libglog_la-symbolize.Plo
1 warning generated.
mv -f src/.deps/libglog_la-raw_logging.Tpo src/.deps/libglog_la-raw_logging.Plo
mv -f src/.deps/libglog_la-vlog_is_on.Tpo src/.deps/libglog_la-vlog_is_on.Plo
1 warning generated.
mv -f src/.deps/libglog_la-demangle.Tpo src/.deps/libglog_la-demangle.Plo
mv -f src/.deps/libglog_la-utilities.Tpo src/.deps/libglog_la-utilities.Plo
yes
checking for uintptr_t... src/logging_unittest.cc:1079:13: warning: unused function 'MyFatal' [-Wunused-function]
static void MyFatal() {
            ^
src/logging_unittest.cc:1082:13: warning: unused function 'MyCheck' [-Wunused-function]
static void MyCheck(bool a, bool b) {
            ^
yes
checking for fd_mask... yes
checking size of long long... mv -f src/.deps/libglog_la-logging.Tpo src/.deps/libglog_la-logging.Plo
6 warnings generated.
mv -f src/.deps/logging_unittest-logging_unittest.Tpo src/.deps/logging_unittest-logging_unittest.Po
8
checking size of long... 8
checking size of int... 4
checking size of short... 2
checking size of size_t... 8
checking size of void *... 8
checking size of off_t... 8
checking size of time_t... 8
checking for struct in6_addr... yes
checking for struct sockaddr_in6... yes
checking for struct sockaddr_un... yes
checking for sa_family_t... yes
checking for struct addrinfo... yes
checking for struct sockaddr_storage... yes
checking for struct in6_addr.s6_addr32... no
checking for struct in6_addr.s6_addr16... no
checking for struct sockaddr_in.sin_len... yes
checking for struct sockaddr_in6.sin6_len... yes
checking for struct sockaddr_storage.ss_family... yes
checking for struct sockaddr_storage.__ss_family... no
checking for struct linger... yes
checking for socklen_t... yes
checking whether our compiler supports __func__... yes
checking whether our compiler supports __FUNCTION__... yes
checking for the pthreads library -lpthreads... no
checking whether pthreads work without any flags... yes
checking for joinable pthread attribute... PTHREAD_CREATE_JOINABLE
checking if more special flags are required for pthreads... -D_THREAD_SAFE
checking size of pthread_t... 8
checking that generated files are newer than configure... done
configure: creating ./config.status
config.status: creating libevent.pc
config.status: creating libevent_openssl.pc
config.status: creating libevent_pthreads.pc
config.status: creating libevent_core.pc
config.status: creating libevent_extra.pc
config.status: creating Makefile
config.status: creating config.h
config.status: creating evconfig-private.h
config.status: executing depfiles commands
config.status: executing libtool commands
  GEN      test/rpcgen-attempted
  GEN      include/event2/event-config.h
/Applications/Xcode.app/Contents/Developer/usr/bin/make  all-am
make[3]: *** read jobs pipe: Resource temporarily unavailable.  Stop.
make[3]: *** Waiting for unfinished jobs....
  CC       buffer.lo
  CC       bufferevent.lo
  CC       bufferevent_filter.lo
  CC       bufferevent_pair.lo
  CC       bufferevent_ratelim.lo
  CC       bufferevent_sock.lo
make[2]: *** [all] Error 2
make: *** [all] Error 2
</pre>
</details>

And there is no `external/rocksdb/make_config.mk` file.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cy6ub/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/556,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cy-7Q,kvrocks,1120661200,556,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-09T05:34:10Z,2022-05-09T05:34:10Z,"> read jobs pipe: Resource temporarily unavailable

I also got this error on MacOSX before when using `-j` to run jobs simultaneously,
but I didn't investigate the reason. Can workaround by remove `-j4`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cy-7Q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/556,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cy_Gw,kvrocks,1120661936,556,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-09T05:35:40Z,2022-05-09T05:35:40Z,"@tisonkun I think we can change the README guide to use `make` instead of `make -j4` before 
resolving. How do you think?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cy_Gw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/556,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cy_-C,kvrocks,1120665474,556,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-09T05:40:24Z,2022-05-09T05:40:24Z,@git-hulk make sense.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cy_-C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/556,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzDcO,kvrocks,1120679694,556,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-09T06:06:21Z,2022-05-09T06:06:21Z,"@tisonkun OK, thanks. Will do it later.
This issue seems caused by resource was NOT enough when building.
Other softwares like `openresty` also have this issue on MacOSX: https://github.com/openresty/openresty/issues/22.
But I still don't know why, need further study.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzDcO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/559,https://api.github.com/repos/apache/kvrocks/issues/559,kvrocks,1229260323,559,Remove unused and misleading variable `kDefaultConfPath`,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-05-09T06:45:45Z,2022-05-13T11:03:19Z,"https://github.com/apache/incubator-kvrocks/blob/a5a5434a93388137be640c55b5440a66f42e1659/src/main.cc#L48

It seems we don't actually load config from `../kvrocks.conf` if `-c` is not specific.

cc @git-hulk @ShooterIT ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/559/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/559,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzKiF,kvrocks,1120708741,559,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-09T06:52:00Z,2022-05-09T06:52:00Z,"Yes, u are right. It won't use this default config path any more.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzKiF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/559,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzsQj,kvrocks,1120846883,559,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-09T09:10:53Z,2022-05-09T09:10:53Z,"Current solution is not a good idea. But i think kvrocks should provide a way to start without conf file. i.e. without `-c xxx.conf`, this makes it easy to try.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzsQj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/559,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Czs5I,kvrocks,1120849480,559,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-09T09:13:11Z,2022-05-09T09:13:11Z,"@ShooterIT Kvrocks had supported that, so the default path was unused actually.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Czs5I/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/559,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DGAlR,kvrocks,1125648721,559,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-13T04:35:34Z,2022-05-13T04:35:34Z,I'm going to prepare a patch to remove related code later today :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DGAlR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/559,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DHGQv,kvrocks,1125934127,559,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-13T11:03:19Z,2022-05-13T11:03:19Z,"FYI I record the experience to solve this issue on bilibili: https://www.bilibili.com/video/BV1w54y1Z7VP/

It may be a content to show how to participant Kvrocks community :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DHGQv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/560,https://api.github.com/repos/apache/kvrocks/issues/560,kvrocks,1229264386,560,Adopt issue template configs,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-05-09T06:50:56Z,2022-05-10T08:01:26Z,"So far, we use GitHub legacy markdown format for issue template. However, GitHub provides a new [config feature for setting up issue template](https://docs.github.com/en/communities/using-templates-to-encourage-useful-issues-and-pull-requests/configuring-issue-templates-for-your-repository#creating-issue-forms).

Also, we'd better keep bug report and enhancement while guiding questions to mailing list and/or Discussions. We can make use of https://github.com/apache/skywalking/tree/master/.github/ISSUE_TEMPLATE.

If you like this idea, I can provide a patch in days.

cc @git-hulk @ShooterIT @karelrooted ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/560/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/560,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzKsL,kvrocks,1120709387,560,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-09T06:53:01Z,2022-05-09T06:53:01Z,"+1, really cool.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzKsL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/560,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzrEH,kvrocks,1120841991,560,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-09T09:06:31Z,2022-05-09T09:06:31Z,"cool, thanks!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5CzrEH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/561,https://api.github.com/repos/apache/kvrocks/issues/561,kvrocks,1229398843,561,[QUESTION] Consider reintroducing googletest to cmake dependencies?,PragmaTwice,20042607,Twice,,CLOSED,2022-05-09T09:00:51Z,2022-05-12T07:46:15Z,"The current `cmake/gtest.cmake` is confusing, especially since it contains a directory on [line 38](https://github.com/apache/incubator-kvrocks/blob/cf9901f88f5905f75e542999529fcbad2ec66dd1/cmake/gtest.cmake#L38) that does not exist, so this file does not seem to provide any functionality.

The project uses the system-supplied gtest, which makes it difficult to control its version. It also seems that the project does not use mechanisms such as `find_package` for gtest, but relies directly on the system header directory (e.g. `/usr/include` to find `gtest/gest.h`) and the `-lgtest` link option.

I think it would be better to reintroduce googletest with fixed tag/commit hash at the cmake level (source level) using `ExternalProject` or `FetchContent`. Since gtest doesn't have many translation units, it doesn't take long to compile.

I'm happy to provide PRs if that sounds like a good idea.

@tisonkun 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/561/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/561,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Czvot,kvrocks,1120860717,561,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-09T09:22:40Z,2022-05-09T09:22:40Z,"+1, other guys also suffered this problem, I think we can reintroduce `gtest` to make the build process easier.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Czvot/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/561,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cz3EY,kvrocks,1120891160,561,NA,ColinChamber,95634254,ColinChamber,,NA,2022-05-09T09:53:59Z,2022-05-09T09:53:59Z,By the way could you help to finish this PR #525 ? I'm sorry I don't have the time currently. Thanks @PragmaTwice ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cz3EY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/561,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cz4cE,kvrocks,1120896772,561,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-09T10:00:42Z,2022-05-09T10:00:42Z,"@ColinChamber we can delay this PR since glog0.5 remove the autoconf which would
break the makefile.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cz4cE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/561,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cz9D3,kvrocks,1120915703,561,NA,ColinChamber,95634254,ColinChamber,,NA,2022-05-09T10:19:39Z,2022-05-09T10:19:39Z,OK,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Cz9D3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/561,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DCLjE,kvrocks,1124645060,561,NA,PragmaTwice,20042607,Twice,,NA,2022-05-12T07:46:15Z,2022-05-12T07:46:15Z,Solved in #564,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DCLjE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/562,kvrocks,1229399615,562,[NEW] Consider using `FetchContent` instead of `ExternalProject` and git submodules?,PragmaTwice,20042607,Twice,,CLOSED,2022-05-09T09:01:29Z,2022-05-12T07:46:26Z,"[`FetchContent`](https://cmake.org/cmake/help/latest/module/FetchContent.html) has been adopted by many projects as a dependency fetching method introduced in newer versions of cmake, for example [the official documentation for gtest](https://google.github.io/googletest/quickstart-cmake.html#set-up-a-project) already recommends using `FetchContent` to import itself into other projects (replacing the previous recommended `ExternalProject`).

The advantage of `FetchContent` is that it is executed during the cmake configuration phase, which allows the configuration information of dependent projects to be introduced into the main project, unlike `ExternalProject`, which is executed during the build phase.

This is quite useful especially for dependency projects built with cmake, because the configured cmake target of a dependency project can be used directly in the main project via `add_subdirectory` (e.g. `gtest::gtest`), instead of having to manually configure the dependency's header directories, static or shared libraries, compilation options, install directories, etc. and keeping maintaining these redundant information in the main project.

This also makes git submodules unnecessary: by `FetchContent`, dependencies can be downloaded and configured at the cmake configuration stage, and URLs and commit hash/tag can be flexibly adjusted based on cmake options.

There are NOT a lot of dependencies in kvrocks, and I think using `FetchContent` to manage dependencies as opposed to `ExternalProject` will improve the development experience. Of course, introducing a dependency manager such as vcpkg or conan may be a good option, but it introduces additional complexity in development and build management, so there is a trade-off.

I'm happy to provide PRs if that sounds like a good idea.

@tisonkun 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/562/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C30jI,kvrocks,1121929416,562,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-10T04:50:22Z,2022-05-10T04:50:22Z,"If this effort can be done, I'm glad to see a lightweight repo to be cloned and we may converge to a unified build system (CMake).

WDYT @git-hulk @ShooterIT?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C30jI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C37Mw,kvrocks,1121956656,562,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-10T05:46:18Z,2022-05-10T05:46:18Z,"Thanks @PragmaTwice @tisonkun, I think it's very great to make the build process faster. I like this improvement.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C37Mw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C38h7,kvrocks,1121962107,562,NA,PragmaTwice,20042607,Twice,,NA,2022-05-10T05:57:43Z,2022-05-10T05:57:43Z,"I noticed that this project also maintains handwritten Makefiles, 
is it acceptable to keep cmake and delete the handwritten Makefiles?

I think keeping only cmake will reduce the maintenance cost.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C38h7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C3-PU,kvrocks,1121969108,562,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-10T06:10:00Z,2022-05-10T06:10:00Z,"Yes, @tisonkun have proposed this in #566 comment, I'm ok to remove the makefile. But I think we should do this on the other PR.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C3-PU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C3_vT,kvrocks,1121975251,562,NA,PragmaTwice,20042607,Twice,,NA,2022-05-10T06:19:44Z,2022-05-10T06:19:44Z,"> Yes, @tisonkun have proposed this in #566 comment, I'm ok to remove the makefile. But I think we should do this on the other PR.

Agree with that. I will try to keep Makefiles working in this PR. https://github.com/apache/incubator-kvrocks/pull/564#issuecomment-1121972637","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C3_vT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C-2R0,kvrocks,1123771508,562,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-11T13:35:04Z,2022-05-11T13:35:04Z,"@PragmaTwice perhaps you can think of creating a tracking issue for build system changes.

In #564 we replace `ExternalProject` with `FetchContent`. As mentioned above, we'd follow up a PR later to remove git submodules and Makefile based build logics.

There is another issue #561 to be addressed in build system settings.

Also, I notice that we don't have a config about CXX_STANDARD used in Kvrocks. It may help for contributors understanding which standard to follow (which features is allowed or welcomed).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C-2R0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C-_EC,kvrocks,1123807490,562,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-11T14:04:55Z,2022-05-11T14:04:55Z,"> Also, I notice that we don't have a config about CXX_STANDARD used in Kvrocks. It may help for contributors understanding which standard to follow (which features is allowed or welcomed).

We set the CXX_STANDARD at target compile instruction, like [MakeLists.txt#L78](https://github.com/apache/incubator-kvrocks/blob/unstable/CMakeLists.txt#L78). Do you mean that's NOT obvious enough for developers?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C-_EC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_CPq,kvrocks,1123820522,562,NA,PragmaTwice,20042607,Twice,,NA,2022-05-11T14:10:50Z,2022-05-11T14:10:50Z,"> @PragmaTwice perhaps you can think of creating a tracking issue for build system changes.
> 
> In #564 we replace `ExternalProject` with `FetchContent`. As mentioned above, we'd follow up a PR later to remove git submodules and Makefile based build logics.
> 
> There is another issue #561 to be addressed in build system settings.
> 
> Also, I notice that we don't have a config about CXX_STANDARD used in Kvrocks. It may help for contributors understanding which standard to follow (which features is allowed or welcomed).

Great idea! I will create a tracking issue about the build system later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_CPq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_Eup,kvrocks,1123830697,562,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-11T14:16:30Z,2022-05-11T14:16:30Z,"@git-hulk Sorry for missing this point. Then it's OK for me. If we encounter further confusion on c++ standard part, we can review the setting style or mention it in doc / readme. I'm OK with current status after you point it out.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_Eup/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_Hc1,kvrocks,1123841845,562,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-11T14:24:38Z,2022-05-11T14:24:38Z,"Got it. Current linter may also frustrate developers since it's not easy to run on local, since it depends on special version of cpplint and cppcheck, but won't discuss here. @PragmaTwice can help to close this issue if planning to create another issue to track the build process change.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_Hc1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_OZ8,kvrocks,1123870332,562,NA,PragmaTwice,20042607,Twice,,NA,2022-05-11T14:44:58Z,2022-05-11T14:44:58Z,"> Got it. Current linter may also frustrate developers since it's not easy to run on local, since it depends on special version of cpplint and cppcheck, but won't discuss here. @PragmaTwice can help to close this issue if planning to create another issue to track the build process change.

Ok, I'll close it. BTW, since I have some experience in static analyzer development, I am glad to give some suggestions and enhancements on lint/code analysis. 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_OZ8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_QlT,kvrocks,1123879251,562,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-11T14:50:18Z,2022-05-11T14:50:18Z,"Cool! We are very eager to improve this, thanks dude.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C_QlT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DCLlf,kvrocks,1124645215,562,NA,PragmaTwice,20042607,Twice,,NA,2022-05-12T07:46:25Z,2022-05-12T07:46:25Z,Solved in #564,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DCLlf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/563,https://api.github.com/repos/apache/kvrocks/issues/563,kvrocks,1229404463,563,[QUESTION] About compile option `-O0` in the cmake target `kvrocks`,PragmaTwice,20042607,Twice,,CLOSED,2022-05-09T09:05:15Z,2022-05-18T08:24:50Z,"The `-O0` option currently added to target `kvrocks` in [CMakeLists.txt](https://github.com/apache/incubator-kvrocks/blob/unstable/CMakeLists.txt#L85) is confusing, as it may prevent compilation optimizations in Release mode.

The performance impact of compile optimizations can be huge, especially with heavy use of the c++ standard library, where optimized versions can be tens of times faster than unoptimized versions.

Were there any special considerations for adding `-O0` at that time?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/563/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/563,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Czuni,kvrocks,1120856546,563,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-09T09:19:07Z,2022-05-09T09:19:07Z,"Thanks @PragmaTwice 

No special consideration, we set it as O0 to make the debug easier.
I also agree it's a good idea to change it to `O2`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Czuni/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/565,https://api.github.com/repos/apache/kvrocks/issues/565,kvrocks,1229599230,565, CI should also check the build status with CMake on ubuntu,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-05-09T12:00:10Z,2022-05-10T09:00:28Z,"Currently, Kvrocks supported make and cmake ways to build the source,
but CI workflow only check the make command. To be more rigorous, we
need to also check the cmake way.

I will file a PR to do this.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/565/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/569,https://api.github.com/repos/apache/kvrocks/issues/569,kvrocks,1230664765,569,Proposal: Consider introducing target `libkvrocks` and using `file(GLOB ...)` to avoid redundance in CMake,PragmaTwice,20042607,Twice,,CLOSED,2022-05-10T06:12:42Z,2022-05-18T08:24:50Z,"Currently there are three targets in cmakelists: `kvrocks`, `kvrocks2redis` and `unittest`. these three targets have many common properties which are redundant, we can introduce a new target `libkvrocks`, define common properties in this target (e.g. source files in `src/` except `src/main.cc`), header directories to include, compilation options `-Wall ...`, standard versions `cxx_std_11`, etc.), and link this target to `kvrocks`, `kvrocks2redis`, and `unittest`.

We can also use `file(GLOB ...) ` and list operations in CMake to search for specific files in a directory to avoid a handwritten list of source files.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/569/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/570,https://api.github.com/repos/apache/kvrocks/issues/570,kvrocks,1230751199,570,[QUESTION] kvrocks process crash sometimes in kvrocks cluster.,erwadba,43768654,erwadba,erwadba@hotmail.com,CLOSED,2022-05-10T07:42:22Z,2022-09-11T03:30:29Z,"Env: 6 same server  4c 16G 
```
# uname -a
Linux kvrocks-0001 3.10.0-1160.53.1.el7.x86_64 #1 SMP Fri Jan 14 13:59:45 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
# cat /etc/redhat-release 
CentOS Linux release 7.8.2003 (Core)
# 
```
```
10.181.130.15:6666> cluster nodes
kvrockskvrockskvrockskvrockskvrocksnode6 10.181.130.52:6666@16666 slave kvrockskvrockskvrockskvrockskvrocksnode5 1652168487999 1652168488000 1 connected
kvrockskvrockskvrockskvrockskvrocksnode5 10.181.130.154:6666@16666 master - 1652168487999 1652168488000 1 connected 10993-16383
kvrockskvrockskvrockskvrockskvrocksnode3 10.181.130.248:6666@16666 master - 1652168487999 1652168488000 1 connected 5461-10992
kvrockskvrockskvrockskvrockskvrocksnode4 10.181.130.194:6666@16666 slave kvrockskvrockskvrockskvrockskvrocksnode3 1652168487999 1652168488000 1 connected
kvrockskvrockskvrockskvrockskvrocksnode2 10.181.130.188:6666@16666 slave kvrockskvrockskvrockskvrockskvrocksnode1 1652168487999 1652168488000 1 connected
kvrockskvrockskvrockskvrockskvrocksnode1 10.181.130.15:6666@16666 myself,master - 1652168487999 1652168488000 1 connected 0-5460
10.181.130.15:6666>
```

Problem:
kvrocks process crash sometimes. The kernel error like this 
```
May 10 14:44:01 kvrocks-0001 systemd: Started Session 28215 of user root.
May 10 14:44:02 kvrocks-0001 kernel: traps: worker[8996] general protection ip:886515 sp:7fc215bef530 error:0 in kvrocks[400000+5c6000]
May 10 14:45:01 kvrocks-0001 systemd: Started Session 28216 of user root.
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/570/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/570,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C4aEs,kvrocks,1122083116,570,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-10T08:23:28Z,2022-05-10T08:23:28Z,do you have core dump stack trace?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C4aEs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/570,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C4by_,kvrocks,1122090175,570,NA,erwadba,43768654,erwadba,erwadba@hotmail.com,NA,2022-05-10T08:29:47Z,2022-05-10T08:29:47Z,"I find the server not open core dump.
[root@kvrocks-0001 kvrocks]# addr2line -e /www/kvrocks/bin/kvrocks 886515
/__w/kvrocks/kvrocks/external/jemalloc/include/jemalloc/internal/pai.h:36
[root@kvrocks-0001 kvrocks]#

This is kvorcks one node conf.
[kvrocks.conf.txt](https://github.com/apache/incubator-kvrocks/files/8660013/kvrocks.conf.txt)

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5C4by_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/570,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DBgpe,kvrocks,1124469342,570,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-12T02:35:01Z,2022-05-12T02:35:01Z,"Hi @erwadba from current messages, i have no idea to catch. Please open core dump, and reproduce it ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DBgpe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/570,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM4t,kvrocks,1242877485,570,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:30:29Z,2022-09-11T03:30:29Z,Closed as stale. You can ask questions at the [Discussions forum](https://github.com/apache/incubator-kvrocks/discussions/categories/q-a).,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM4t/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/572,https://api.github.com/repos/apache/kvrocks/issues/572,kvrocks,1232811808,572,Proposal: add multiple platforms and CPUs build workflow in GitHub Actions,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-05-11T15:11:13Z,2022-09-11T03:32:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As far as I know, Kvrocks works well on platforms like CentOS/Ubuntu/Debian and MacOSX, as well as CPU like ARM64 and Apple M1. But we didn't check the build system status now and we can't guarantee it's always fine over time. So I think we should check those statuses periodically.

### Solution

For most PRs won't affect the build system status, but it's a bit time and resource costly. The workaround is to check daily or weekly instead of every PR, and we can fix them in time when anyone was broken. Do you guys have any thoughts? 

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/572/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/572,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DBQ5D,kvrocks,1124404803,572,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-12T00:23:39Z,2022-05-12T00:23:39Z,"IIRC [GitHub Actions doesn't provide hosted ARM64 machine](https://github.community/t/ask-about-github-hosted-runners-arm64-platform-support/167483) ([another instance](https://issues.apache.org/jira/browse/CURATOR-634)). We may need a sponsor for self-hosted runners, other CI platform or ask ASF Infra for more information.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DBQ5D/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/572,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DBdxZ,kvrocks,1124457561,572,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-12T02:09:45Z,2022-05-12T02:09:45Z,"Thanks @tisonkun.

Another solution can run those ARM64 jobs on Travis CI, but I'm wondering whether it makes sense or not.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DBdxZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/572,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM8l,kvrocks,1242877733,572,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:32:54Z,2022-09-11T03:32:54Z,"Closed as now we're using Travis to achieve multiple platform supports. If GitHub Actions support ARM platform later, we can review this proposal.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM8l/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/574,https://api.github.com/repos/apache/kvrocks/issues/574,kvrocks,1233580754,574,Proposal: Remove handwritten makefiles to keep only one build system,PragmaTwice,20042607,Twice,,CLOSED,2022-05-12T07:45:03Z,2022-05-13T10:59:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As already discussed in https://github.com/apache/incubator-kvrocks/issues/562, https://github.com/apache/incubator-kvrocks/pull/564 and https://github.com/apache/incubator-kvrocks/pull/566, remove handwritten makfiles allow us to focus on improving CMake builds and reduce maintenance costs. CMake is a build system (generator) with a higher level of abstraction than makefiles, which can describe the build structure and hierarchy of a project in a more convenient form.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/574/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/574,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DC3kr,kvrocks,1124825387,574,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-12T10:27:41Z,2022-05-12T10:27:41Z,+1,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DC3kr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/575,kvrocks,1233580915,575,Tracking issue for build system enhancements,PragmaTwice,20042607,Twice,,CLOSED,2022-05-12T07:45:12Z,2022-06-02T12:06:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Modern CMake provides many amazing features to organize the build structure of a project in a more convenient way, and we can make full use of them to improve the development experience!
@tisonkun had a good suggestion in https://github.com/apache/incubator-kvrocks/issues/562#issuecomment-1123771508 of creating a tracking issue to help keep the discussion more focused, so this issue is created for that purpose.

### Solution

The list below tracks some of the improvements that have been proposed so far, and I'd appreciate it if anyone came up with new ideas for improvements, PRs for current improvements, or participated in this discussion!

- [x] #561
- [x] #562
- [x] #574
- [x] #569
- [x] #563
- [x] #580
- [x] #589
- [x] #590

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/575/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DDgSV,kvrocks,1124992149,575,NA,torwig,8588372,Yaroslav,,NA,2022-05-12T13:25:11Z,2022-05-12T13:25:11Z,"I'm trying to build kvrocks on Fedora35 with CMake (cmake version 3.22.2):

```
mkdir build
cd build
cmake ../
make -j8

[ 96%] Linking CXX executable kvrocks
[ 96%] Building CXX object CMakeFiles/kvrocks2redis.dir/tools/kvrocks2redis/sync.cc.o
[ 96%] Building CXX object CMakeFiles/kvrocks2redis.dir/tools/kvrocks2redis/redis_writer.cc.o
[ 96%] Building CXX object CMakeFiles/unittest.dir/tests/string_util_test.cc.o
[ 97%] Building CXX object CMakeFiles/unittest.dir/tests/rwlock_test.cc.o
[ 97%] Building CXX object CMakeFiles/unittest.dir/tests/cron_test.cc.o
[ 97%] Building CXX object CMakeFiles/kvrocks2redis.dir/tools/kvrocks2redis/writer.cc.o
[ 98%] Building CXX object CMakeFiles/kvrocks2redis.dir/tools/kvrocks2redis/parser.cc.o
/usr/bin/ld: cannot find -lstdc++
collect2: error: ld returned 1 exit status
make[2]: *** [CMakeFiles/kvrocks.dir/build.make:761: kvrocks] Error 1
make[1]: *** [CMakeFiles/Makefile2:314: CMakeFiles/kvrocks.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....
[ 98%] Building CXX object CMakeFiles/unittest.dir/tests/config_test.cc.o
[ 98%] Building CXX object CMakeFiles/unittest.dir/tests/task_runner_test.cc.o
[ 98%] Building CXX object CMakeFiles/unittest.dir/tests/t_bitmap_test.cc.o
[ 98%] Building CXX object CMakeFiles/unittest.dir/tests/compact_test.cc.o
[100%] Building CXX object CMakeFiles/unittest.dir/tests/log_collector_test.cc.o
[100%] Building CXX object CMakeFiles/unittest.dir/src/sha1.cc.o
[100%] Building CXX object CMakeFiles/unittest.dir/src/rand.cc.o
[100%] Linking CXX executable kvrocks2redis
/usr/bin/ld: cannot find -lstdc++
collect2: error: ld returned 1 exit status
make[2]: *** [CMakeFiles/kvrocks2redis.dir/build.make:841: kvrocks2redis] Error 1
make[1]: *** [CMakeFiles/Makefile2:346: CMakeFiles/kvrocks2redis.dir/all] Error 2
[100%] Linking CXX executable unittest
/usr/bin/ld: cannot find -lstdc++
collect2: error: ld returned 1 exit status
make[2]: *** [CMakeFiles/unittest.dir/build.make:1067: unittest] Error 1
make[1]: *** [CMakeFiles/Makefile2:380: CMakeFiles/unittest.dir/all] Error 2
make: *** [Makefile:156: all] Error 2
```


However, just doing `make -j8` successfully builds the application.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DDgSV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DDrz8,kvrocks,1125039356,575,NA,PragmaTwice,20042607,Twice,,NA,2022-05-12T14:06:21Z,2022-05-12T14:06:21Z,"Can you locate `libstdc++.a` in your environment?
Refer to [here](https://www.linuxquestions.org/questions/fedora-35/fedora-22-ld-cannot-find-lstdc-4175555440/), the command in fedora maybe `dnf provides */libstdc++.a`, and you could try to install `libstdc++-static`.

https://unix.stackexchange.com/questions/416875/fedora-27-usr-bin-ld-cannot-find-lstdc","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DDrz8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DDt22,kvrocks,1125047734,575,NA,PragmaTwice,20042607,Twice,,NA,2022-05-12T14:13:14Z,2022-05-12T14:13:14Z,"The problem is caused by that `-static-libstdc++` is added as a flag to the compiler in [CMakeLists.txt#L72](https://github.com/apache/incubator-kvrocks/blob/unstable/CMakeLists.txt#L72), which is not added in makefiles, so a static library of libstdc++ is needed.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DDt22/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DDx94,kvrocks,1125064568,575,NA,PragmaTwice,20042607,Twice,,NA,2022-05-12T14:27:27Z,2022-05-12T14:27:27Z,"> The problem is caused by that `-static-libstdc++` is added as a flag to the compiler in [CMakeLists.txt#L72](https://github.com/apache/incubator-kvrocks/blob/unstable/CMakeLists.txt#L72), which is not added in makefiles, so a static library of libstdc++ is needed.

Maybe some tips should be added to README to let users know that kvrocks need libstdc++.a for build. @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DDx94/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DD59s,kvrocks,1125097324,575,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-12T14:55:29Z,2022-05-12T14:55:29Z,"> > The problem is caused by that `-static-libstdc++` is added as a flag to the compiler in [CMakeLists.txt#L72](https://github.com/apache/incubator-kvrocks/blob/unstable/CMakeLists.txt#L72), which is not added in makefiles, so a static library of libstdc++ is needed.
> 
> Maybe some tips should be added to README to let users know that kvrocks need libstdc++.a for build. @git-hulk

Yes, you are right. Do you think it's a good idea to search library first before linking?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DD59s/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DECU-,kvrocks,1125131582,575,NA,torwig,8588372,Yaroslav,,NA,2022-05-12T15:25:31Z,2022-05-12T15:25:31Z,"@PragmaTwice 
Thank you, `sudo dnf install libstdc++-static` solved the issue, and now the application is successfully built.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DECU-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DEYJU,kvrocks,1125220948,575,NA,PragmaTwice,20042607,Twice,,NA,2022-05-12T16:56:38Z,2022-05-12T16:56:38Z,"> > > The problem is caused by that `-static-libstdc++` is added as a flag to the compiler in [CMakeLists.txt#L72](https://github.com/apache/incubator-kvrocks/blob/unstable/CMakeLists.txt#L72), which is not added in makefiles, so a static library of libstdc++ is needed.
> > 
> > 
> > Maybe some tips should be added to README to let users know that kvrocks need libstdc++.a for build. @git-hulk
> 
> Yes, you are right. Do you think it's a good idea to search library first before linking?

I think it is a good idea, there are two solutions for searching library:
1. find library, and give an error or warning if not found; give an option to user of whether `-static-libstdc++` is enabled
2. find library, do not enable `-static-libstdc++` if not found

I prefer the first solution, because I think the second is more implicit, users may not know whether `-static-libstdc++` is enabled while they are building the project (it is totally depend on the environment).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DEYJU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DFuVc,kvrocks,1125573980,575,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-13T01:39:49Z,2022-05-13T01:39:49Z,"agree, explicitly always better than implicitly.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DFuVc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DN8wj,kvrocks,1127730211,575,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-16T14:14:17Z,2022-05-16T14:14:17Z,"I try to build on CentOS8(also CentOS7) and got the error:
```
/root/incubator-kvrocks/build/_deps/jemalloc-src/include/jemalloc/internal/rtree.h:109:19: error: variably modified ‘root’ at file scope
  rtree_leaf_elm_t root[1U << (RTREE_NSB/RTREE_HEIGHT)];
```
But I didn't find the root cause, just commented first.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DN8wj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DOh9I,kvrocks,1127882568,575,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-16T16:27:34Z,2022-05-16T16:27:34Z,"> I try to build on CentOS8(also CentOS7) and got the error:
> 
> ```
> /root/incubator-kvrocks/build/_deps/jemalloc-src/include/jemalloc/internal/rtree.h:109:19: error: variably modified ‘root’ at file scope
>   rtree_leaf_elm_t root[1U << (RTREE_NSB/RTREE_HEIGHT)];
> ```
> 
> But I didn't find the root cause, just commented first.

It also failed on the old version, so NOT related with the new build system.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DOh9I/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DOoPH,kvrocks,1127908295,575,NA,PragmaTwice,20042607,Twice,,NA,2022-05-16T16:54:24Z,2022-05-16T16:54:24Z,"That's weird. I think it is probably due to the macro `RTREE_NSB` or `RTREE_HEIGHT`, which are original `LG_VADDR` and `LG_PAGE`. Could you check your `include/jemalloc/internal/jemalloc_internal_defs.h` generated by `configure` which includes these two macro definition?
And sometimes try clang or other version of gcc could let you find some useful info.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DOoPH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DQCIR,kvrocks,1128276497,575,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-17T00:37:38Z,2022-05-17T00:37:38Z,"I checked the generated defs, looks the `LG_VADDR` shouldn't be 0:
```c
#define LG_VADDR 0

/* One page is 2^LG_PAGE bytes. */
#define LG_PAGE 12
```
I will compare the normal version on ubuntu later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DQCIR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DQY15,kvrocks,1128369529,575,NA,PragmaTwice,20042607,Twice,,NA,2022-05-17T03:30:45Z,2022-05-17T03:30:45Z,"```
$ bat include/jemalloc/internal/jemalloc_internal_defs.h | rg ""LG_(VADDR|PAGE)""
#define LG_VADDR 48
/* One page is 2^LG_PAGE bytes. */
#define LG_PAGE 12
```
These two macro definition in my side. Maybe the reason is that `0` can lead `RTREE_NSB` to be a negative number.

> In any case, if the value of the right operand is negative or is greater or equal to the number of bits in the promoted left operand, the behavior is undefined.

Refer to https://en.cppreference.com/w/cpp/language/operator_arithmetic#Bitwise_shift_operators, that's an UB.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DQY15/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DQcXO,kvrocks,1128383950,575,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-17T04:03:13Z,2022-05-17T04:03:13Z,"Yes, you're right. I also find this on my side and this only appears in MacOSX docker environment.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DQcXO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EOP0A,kvrocks,1144585472,575,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-02T08:21:08Z,2022-06-02T08:21:08Z,"Given that all subtasks done, @PragmaTwice do you think that we can close this issue as resolved?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EOP0A/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/575,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EO-55,kvrocks,1144778361,575,NA,PragmaTwice,20042607,Twice,,NA,2022-06-02T11:56:39Z,2022-06-02T11:56:39Z,"> Given that all subtasks done, @PragmaTwice do you think that we can close this issue as resolved?

Yeah, althought there is some issue in #615, I temporarily have no more enhancement idea, so I think we can close it since all of these enhancements are done.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EO-55/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/580,https://api.github.com/repos/apache/kvrocks/issues/580,kvrocks,1236234591,580,Proposal: Search library first before linking `libstdc++.a` in CMake,PragmaTwice,20042607,Twice,,CLOSED,2022-05-15T09:30:07Z,2022-05-19T12:31:48Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This idea comes from @git-hulk, and the following is the discussion at that time:
> > > The problem is caused by that `-static-libstdc++` is added as a flag to the compiler in [CMakeLists.txt#L72](https://github.com/apache/incubator-kvrocks/blob/unstable/CMakeLists.txt#L72), which is not added in makefiles, so a static library of libstdc++ is needed.
> > 
> > 
> > Maybe some tips should be added to README to let users know that kvrocks need libstdc++.a for build. @git-hulk
> 
> Yes, you are right. Do you think it's a good idea to search library first before linking?

I think it is a good idea, there are two solutions for searching library:
1. find library, and give an error or warning if not found; give an option to user of whether `-static-libstdc++` is enabled
2. find library, do not enable `-static-libstdc++` if not found

I prefer the first solution, because I think the second is more implicit, users may not know whether `-static-libstdc++` is enabled while they are building the project (it is totally depend on the environment).

_Originally posted by @PragmaTwice in https://github.com/apache/incubator-kvrocks/issues/575#issuecomment-1125220948_

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/580/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/581,https://api.github.com/repos/apache/kvrocks/issues/581,kvrocks,1236240820,581,Proposal: Just return values instead of passing pointers if possible,PragmaTwice,20042607,Twice,,CLOSED,2022-05-15T09:58:43Z,2022-10-23T03:50:45Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

C++ specifies a number of strategies in the standard to eliminate unnecessary copies, which are called [copy elision](https://en.cppreference.com/w/cpp/language/copy_elision).

One of these optimizations is called *named return value optimization* (NRVO), which is defined in the standard. 
This optimization works on the return value, in short, the returned object is not copied onto the current stack.

GCC and Clang both perform this optimization by default (even in the `-O0` case). 
The following simple code demonstrates it:

```c++
T f() {
    T a;
    ... // operations on a
    return a;
}
 
T a = f(); // T::T(const T&) or T::T(T&&) will not be called
```

You can view the assembly or modify and execute this code online on [godbolt](https://godbolt.org/z/xcYK31nGY).

So passing pointers to optimize efficiency maybe not necessary, and returning values is usually easier to make the operation be expressed in the same expression and more intuitive. Some parts of this project use this approach, like [these functions](https://github.com/apache/incubator-kvrocks/blob/unstable/src/util.h#L79-L81).

So I think it would be better to change them to return the results directly.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/581/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/581,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DK0cO,kvrocks,1126909710,581,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-15T11:02:47Z,2022-05-15T11:02:47Z,"Cool, thanks @PragmaTwice. We use many C style passing pointers in function parameter,
it's good to me since it won't affect readable.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DK0cO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/581,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxUVJ,kvrocks,1287996745,581,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-23T03:50:44Z,2022-10-23T03:50:44Z,"Closed as no more insights here. If you find more patterns to adopt, feel free to start a new initiative.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxUVJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/582,https://api.github.com/repos/apache/kvrocks/issues/582,kvrocks,1237176368,582,Failed to build the cmake(3.23.1) on Centos7,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-05-16T13:36:59Z,2022-05-16T17:46:01Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

4f9f01c785cfea7ae4cc66f9c6cf55fa0c4866d9

### Minimal reproduce step

```
$ mkdir build
$ sh build.sh build
```

### What did you expect to see?

Can build the newer cmake version

### What did you see instead?

```
loading initial cache file /incubator-kvrocks/build/cmake-3.23.1/Bootstrap.cmk/InitialCacheFlags.cmake
-- Could NOT find OpenSSL, try to set the path to OpenSSL root folder in the system variable OPENSSL_ROOT_DIR (missing: OPENSSL_CRYPTO_LIBRARY OPENSSL_INCLUDE_DIR)
CMake Error at Utilities/cmcurl/CMakeLists.txt:586 (message):
  Could not find OpenSSL.  Install an OpenSSL development package or
  configure CMake with -DCMAKE_USE_OPENSSL=OFF to build without OpenSSL.
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/582/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/585,https://api.github.com/repos/apache/kvrocks/issues/585,kvrocks,1238438999,585,Redis Python client cannot find follower node with sentinel,luger1990,2096878,Luger Smith,,CLOSED,2022-05-17T10:38:45Z,2022-05-17T10:58:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

kvrocks:2.0.6

### Minimal reproduce step

python code:
```
import redis
from redis.exceptions import (ConnectionError, TimeoutError)
from redis.sentinel import Sentinel

sentinel_instance_list = [('192.168.100.66', 5001),
                                       ('192.168.100.66', 5002),
                                       ('192.168.100.66', 5003)
                                      ]
sentinel = Sentinel(sentinel_instance_list, socket_timeout=0.5)
master = sentinel.discover_master('dev-kvrocks')
print(master)
print('-------')
slaves = sentinel.discover_slaves('dev-kvrocks')
print(slaves)
```

### What did you expect to see?

```
('192.168.100.66', 6666)
-------
[other slave node]

```

### What did you see instead?

```
('192.168.100.66', 6666)
-------
[]

```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/585/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DRvCv,kvrocks,1128722607,585,NA,luger1990,2096878,Luger Smith,,NA,2022-05-17T10:54:43Z,2022-05-17T10:54:43Z,"thanks @tisonkun change my title to english

I found the cause of the problem. The redis-7xx version does not support the command `SENTINEL slaves`, just replace it with redis-6xx","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DRvCv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DRvzP,kvrocks,1128725711,585,NA,luger1990,2096878,Luger Smith,,NA,2022-05-17T10:58:12Z,2022-05-17T10:58:12Z,"and thanks kvrocks,I try to replace pika and ssdb with kvrocks. 👍 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DRvzP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/587,https://api.github.com/repos/apache/kvrocks/issues/587,kvrocks,1238720593,587,Fail to build project on MacOS running on M1,indianmifan,32297804,,lyang1817@163.com,CLOSED,2022-05-17T14:21:55Z,2022-05-18T05:41:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

building Kvrocks, commit id: 411bf43710679a7fa8a5c4b5e4946225757be562
-- Available event backends: 
-- CMAKE_BINARY_DIR:         /Users/mifan/incubator-kvrocks/build
-- CMAKE_CURRENT_BINARY_DIR: /Users/mifan/incubator-kvrocks/build/_deps/libevent-build
-- CMAKE_SOURCE_DIR:         /Users/mifan/incubator-kvrocks
-- CMAKE_CURRENT_SOURCE_DIR: /Users/mifan/incubator-kvrocks/build/_deps/libevent-src
-- PROJECT_BINARY_DIR:       /Users/mifan/incubator-kvrocks/build/_deps/libevent-build
-- PROJECT_SOURCE_DIR:       /Users/mifan/incubator-kvrocks/build/_deps/libevent-src
-- CMAKE_MODULE_PATH:        /Users/mifan/incubator-kvrocks/build/_deps/libevent-src/cmake/
-- CMAKE_COMMAND:            /opt/homebrew/Cellar/cmake/3.23.0/bin/cmake
-- CMAKE_ROOT:               /opt/homebrew/Cellar/cmake/3.23.0/share/cmake
-- CMAKE_SYSTEM:             Darwin-21.4.0
-- CMAKE_SYSTEM_NAME:        Darwin
-- CMAKE_SYSTEM_VERSION:     21.4.0
-- CMAKE_SYSTEM_PROCESSOR:   arm64
-- CMAKE_SKIP_RPATH:         NO
-- CMAKE_VERBOSE_MAKEFILE:   FALSE
-- CMAKE_C_FLAGS:             -Wall -Wextra -Wno-unused-parameter -Wstrict-aliasing -Wstrict-prototypes -fno-strict-aliasing -Wmissing-prototypes -Winit-self -Wmissing-field-initializers -Wdeclaration-after-statement -Waddress -Woverride-init -Wwrite-strings -Wno-unused-function -Wno-error=deprecated-declarations -Qunused-arguments
-- CMAKE_BUILD_TYPE:         Release
-- CMAKE_C_COMPILER:         /Library/Developer/CommandLineTools/usr/bin/cc (id AppleClang, clang 1, GNUC 1)
-- CMAKE_AR:                 /Library/Developer/CommandLineTools/usr/bin/ar
-- CMAKE_RANLIB:             /Library/Developer/CommandLineTools/usr/bin/ranlib

### Minimal reproduce step

```
$ git clone https://github.com/apache/incubator-kvrocks.git
$ cd kvrocks
$ mkdir build
$ ./build.sh build

```

### What did you expect to see?

successfully build 

### What did you see instead?

```
......
Consolidate compiler generated dependencies of target kvrocks
[ 88%] Linking CXX executable kvrocks
ld: warning: ignoring file _deps/lua-src/src/liblua.a, building for macOS-arm64 but attempting to link with file built for unknown-unsupported file format ( 0x21 0x3C 0x61 0x72 0x63 0x68 0x3E 0x0A 0x2F 0x20 0x20 0x20 0x20 0x20 0x20 0x20 )
Undefined symbols for architecture arm64:
  ""_luaL_argerror"", referenced from:
      Lua::redisMathRandom(lua_State*) in scripting.cc.o
  ""_luaL_checkinteger"", referenced from:
      Lua::redisMathRandom(lua_State*) in scripting.cc.o
      Lua::redisMathRandomSeed(lua_State*) in scripting.cc.o
......
......
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/587/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSpCK,kvrocks,1128960138,587,NA,PragmaTwice,20042607,Twice,,NA,2022-05-17T14:43:01Z,2022-05-17T14:43:01Z,"Could you provide the full error log? i.e. the full output of `cmake -DCMAKE_VERBOSE_MAKEFILE=ON ..; make` in a fresh build directory (e.g. empty dir). Thanks!
It is sad that I do not have any device with apple silicon. 😢 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSpCK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSpq3,kvrocks,1128962743,587,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-17T14:45:12Z,2022-05-17T14:45:12Z,Me too. @ShooterIT @Alfejik Can help to have a try if you have the M1 machine. Seems the `lua` library only supported `macosx` platform but can't specify the `arm64` arch. I'm not sure whether we can fix it with passing compile flags or not.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSpq3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSvKB,kvrocks,1128985217,587,NA,indianmifan,32297804,,lyang1817@163.com,NA,2022-05-17T15:04:18Z,2022-05-17T15:04:18Z,"> Could you provide the full error log? i.e. the full output of `cmake -DCMAKE_VERBOSE_MAKEFILE=ON ..; make` in a fresh build directory (e.g. empty dir). Thanks! It is sad that I do not have any device with apple silicon. 😢

// stdout is omitted
```
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lapi.c:16:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lcode.c:13:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from ldebug.c:16:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from ldo.c:15:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from ldump.c:12:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lfunc.c:13:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lgc.c:12:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from llex.c:15:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lmem.c:13:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lobject.c:16:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lopcodes.c:11:
In file included from ./lopcodes.h:10:
In file included from ./llimits.h:15:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lparser.c:13:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lstate.c:13:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lstring.c:13:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from ltable.c:27:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from ltm.c:13:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lundump.c:12:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lvm.c:15:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lzio.c:13:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lauxlib.c:23:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lbaselib.c:17:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from ldblib.c:15:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from liolib.c:16:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lmathlib.c:14:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from loslib.c:17:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from ltablib.c:13:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lstrlib.c:17:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from loadlib.c:19:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from linit.c:11:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lua_cjson.c:43:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lua_struct.c:36:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
/Users/mifan/incubator-kvrocks/build/_deps/glog-src/src/raw_logging.cc:139:3: warning: 'syscall' is deprecated: first deprecated in macOS 10.12 - syscall(2) is unsupported; please switch to a supported interface. For SYS_kdebug_trace use kdebug_signpost(). [-Wdeprecated-declarations]
  safe_write(STDERR_FILENO, buffer, strlen(buffer));
  ^
/Users/mifan/incubator-kvrocks/build/_deps/glog-src/src/raw_logging.cc:63:34: note: expanded from macro 'safe_write'
# define safe_write(fd, s, len)  syscall(SYS_write, fd, s, len)
                                 ^
/Library/Developer/CommandLineTools/SDKs/MacOSX12.3.sdk/usr/include/unistd.h:746:6: note: 'syscall' has been explicitly marked deprecated here
int      syscall(int, ...);
         ^
1 warning generated.
In file included from lua_cmsgpack.c:7:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
clang: warning: -lreadline: 'linker' input unused [-Wunused-command-line-argument]
In file included from lua_bit.c:32:
In file included from ./lua.h:16:
./luaconf.h:55:9: warning: 'LUA_USE_MKSTEMP' macro redefined [-Wmacro-redefined]
#define LUA_USE_MKSTEMP
        ^
<command line>:4:9: note: previous definition is here
#define LUA_USE_MKSTEMP 1
        ^
1 warning generated.
ar: `u' modifier ignored since `D' is the default (see `U')
/Users/mifan/incubator-kvrocks/build/_deps/libevent-src/evutil_rand.c:197:2: warning: 'arc4random_addrandom' is deprecated: first deprecated in macOS 10.12 - use arc4random_stir [-Wdeprecated-declarations]
        arc4random_addrandom((unsigned char*)buf,
        ^
/Library/Developer/CommandLineTools/SDKs/MacOSX12.3.sdk/usr/include/stdlib.h:258:7: note: 'arc4random_addrandom' has been explicitly marked deprecated here
void     arc4random_addrandom(unsigned char * /*dat*/, int /*datlen*/)
         ^
1 warning generated.
/Users/mifan/incubator-kvrocks/build/_deps/glog-src/src/utilities.cc:262:17: warning: 'syscall' is deprecated: first deprecated in macOS 10.12 - syscall(2) is unsupported; please switch to a supported interface. For SYS_kdebug_trace use kdebug_signpost(). [-Wdeprecated-declarations]
    pid_t tid = syscall(__NR_gettid);
                ^
/Library/Developer/CommandLineTools/SDKs/MacOSX12.3.sdk/usr/include/unistd.h:746:6: note: 'syscall' has been explicitly marked deprecated here
int      syscall(int, ...);
         ^
1 warning generated.
ld: warning: ignoring file _deps/lua-src/src/liblua.a, building for macOS-arm64 but attempting to link with file built for unknown-unsupported file format ( 0x21 0x3C 0x61 0x72 0x63 0x68 0x3E 0x0A 0x2F 0x20 0x20 0x20 0x20 0x20 0x20 0x20 )
Undefined symbols for architecture arm64:
  ""_luaL_argerror"", referenced from:
      Lua::redisMathRandom(lua_State*) in scripting.cc.o
  ""_luaL_checkinteger"", referenced from:
      Lua::redisMathRandom(lua_State*) in scripting.cc.o
      Lua::redisMathRandomSeed(lua_State*) in scripting.cc.o
  ""_luaL_error"", referenced from:
      Lua::redisMathRandom(lua_State*) in scripting.cc.o
  ""_luaL_loadbuffer"", referenced from:
      Lua::loadFuncs(lua_State*) in scripting.cc.o
      Lua::enableGlobalsProtection(lua_State*) in scripting.cc.o
      Lua::createFunction(Server*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
  ""_luaL_newstate"", referenced from:
      Lua::CreateState() in scripting.cc.o
  ""_lua_call"", referenced from:
      Lua::loadLibraries(lua_State*)::$_0::operator()(lua_State*, char const*, int (*)(lua_State*)) const in scripting.cc.o
      Lua::sortArray(lua_State*) in scripting.cc.o
  ""_lua_close"", referenced from:
      Lua::DestroyState(lua_State*) in scripting.cc.o
  ""_lua_createtable"", referenced from:
      Lua::loadFuncs(lua_State*) in scripting.cc.o
      Lua::setGlobalArray(lua_State*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) in scripting.cc.o
      Lua::pushError(lua_State*, char const*) in scripting.cc.o
      Lua::redisReturnSingleFieldTable(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Status(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Error(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Aggregate(lua_State*, char const*, int) in scripting.cc.o
      ...
  ""_lua_error"", referenced from:
      Lua::redisLogCommand(lua_State*) in scripting.cc.o
      Lua::redisSha1hexCommand(lua_State*) in scripting.cc.o
      Lua::raiseError(lua_State*) in scripting.cc.o
  ""_lua_gc"", referenced from:
      Server::GetMemoryInfo(std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in server.cc.o
      Lua::evalGenericCommand(Redis::Connection*, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
  ""_lua_getfield"", referenced from:
      Lua::loadFuncs(lua_State*) in scripting.cc.o
      Lua::evalGenericCommand(Redis::Connection*, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
      Lua::sortArray(lua_State*) in scripting.cc.o
  ""_lua_gettable"", referenced from:
      Lua::replyToRedisReply(lua_State*) in scripting.cc.o
      Lua::raiseError(lua_State*) in scripting.cc.o
      Lua::sortArray(lua_State*) in scripting.cc.o
  ""_lua_gettop"", referenced from:
      Lua::redisLogCommand(lua_State*) in scripting.cc.o
      Lua::redisSha1hexCommand(lua_State*) in scripting.cc.o
      Lua::redisMathRandom(lua_State*) in scripting.cc.o
      Lua::redisGenericCommand(lua_State*, int) in scripting.cc.o
      Lua::redisReturnSingleFieldTable(lua_State*, char const*) in scripting.cc.o
  ""_lua_isnumber"", referenced from:
      Lua::redisLogCommand(lua_State*) in scripting.cc.o
  ""_lua_pcall"", referenced from:
      Lua::loadFuncs(lua_State*) in scripting.cc.o
      Lua::enableGlobalsProtection(lua_State*) in scripting.cc.o
      Lua::evalGenericCommand(Redis::Connection*, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
      Lua::createFunction(Server*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
      Lua::sortArray(lua_State*) in scripting.cc.o
  ""_lua_pushboolean"", referenced from:
      Lua::redisProtocolToLuaType_Bulk(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Aggregate(lua_State*, char const*, int) in scripting.cc.o
      Lua::redisProtocolToLuaType_Bool(lua_State*, char const*, int) in scripting.cc.o
  ""_lua_pushcclosure"", referenced from:
      Lua::loadFuncs(lua_State*) in scripting.cc.o
      Lua::loadLibraries(lua_State*)::$_0::operator()(lua_State*, char const*, int (*)(lua_State*)) const in scripting.cc.o
  ""_lua_pushlstring"", referenced from:
      Lua::setGlobalArray(lua_State*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) in scripting.cc.o
      Lua::redisProtocolToLuaType_Bulk(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Status(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Error(lua_State*, char const*) in scripting.cc.o
  ""_lua_pushnil"", referenced from:
      Lua::removeUnsupportedFunctions(lua_State*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Null(lua_State*, char const*) in scripting.cc.o
  ""_lua_pushnumber"", referenced from:
      Lua::loadFuncs(lua_State*) in scripting.cc.o
      Lua::redisMathRandom(lua_State*) in scripting.cc.o
      Lua::replyToRedisReply(lua_State*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Int(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Aggregate(lua_State*, char const*, int) in scripting.cc.o
      Lua::redisProtocolToLuaType_Double(lua_State*, char const*) in scripting.cc.o
  ""_lua_pushstring"", referenced from:
      Lua::loadFuncs(lua_State*) in scripting.cc.o
      Lua::redisLogCommand(lua_State*) in scripting.cc.o
      Lua::redisSha1hexCommand(lua_State*) in scripting.cc.o
      Lua::replyToRedisReply(lua_State*) in scripting.cc.o
      Lua::pushError(lua_State*, char const*) in scripting.cc.o
      Lua::raiseError(lua_State*) in scripting.cc.o
      Lua::loadLibraries(lua_State*)::$_0::operator()(lua_State*, char const*, int (*)(lua_State*)) const in scripting.cc.o
      ...
  ""_lua_pushvalue"", referenced from:
      Lua::redisReturnSingleFieldTable(lua_State*, char const*) in scripting.cc.o
      Lua::sortArray(lua_State*) in scripting.cc.o
  ""_lua_rawseti"", referenced from:
      Lua::setGlobalArray(lua_State*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) in scripting.cc.o
  ""_lua_setfield"", referenced from:
      Lua::removeUnsupportedFunctions(lua_State*) in scripting.cc.o
      Lua::loadFuncs(lua_State*) in scripting.cc.o
      Lua::setGlobalArray(lua_State*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&) in scripting.cc.o
  ""_lua_settable"", referenced from:
      Lua::loadFuncs(lua_State*) in scripting.cc.o
      Lua::pushError(lua_State*, char const*) in scripting.cc.o
      Lua::redisReturnSingleFieldTable(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Status(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Error(lua_State*, char const*) in scripting.cc.o
      Lua::redisProtocolToLuaType_Aggregate(lua_State*, char const*, int) in scripting.cc.o
      Lua::redisProtocolToLuaType_Double(lua_State*, char const*) in scripting.cc.o
      ...
  ""_lua_settop"", referenced from:
      Lua::evalGenericCommand(Redis::Connection*, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
      Lua::createFunction(Server*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
      Lua::replyToRedisReply(lua_State*) in scripting.cc.o
      Lua::sortArray(lua_State*) in scripting.cc.o
  ""_lua_toboolean"", referenced from:
      Lua::replyToRedisReply(lua_State*) in scripting.cc.o
  ""_lua_tolstring"", referenced from:
      Lua::redisLogCommand(lua_State*) in scripting.cc.o
      Lua::redisSha1hexCommand(lua_State*) in scripting.cc.o
      Lua::evalGenericCommand(Redis::Connection*, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
      Lua::createFunction(Server*, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > const&, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
      Lua::replyToRedisReply(lua_State*) in scripting.cc.o
      Lua::redisGenericCommand(lua_State*, int) in scripting.cc.o
  ""_lua_tonumber"", referenced from:
      Lua::redisLogCommand(lua_State*) in scripting.cc.o
      Lua::replyToRedisReply(lua_State*) in scripting.cc.o
      Lua::redisGenericCommand(lua_State*, int) in scripting.cc.o
  ""_lua_type"", referenced from:
      Lua::evalGenericCommand(Redis::Connection*, std::__1::vector<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >, std::__1::allocator<std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> > > > const&, bool, std::__1::basic_string<char, std::__1::char_traits<char>, std::__1::allocator<char> >*) in scripting.cc.o
      Lua::replyToRedisReply(lua_State*) in scripting.cc.o
      Lua::redisGenericCommand(lua_State*, int) in scripting.cc.o
      Lua::redisReturnSingleFieldTable(lua_State*, char const*) in scripting.cc.o
  ""_luaopen_base"", referenced from:
      Lua::loadLibraries(lua_State*) in scripting.cc.o
  ""_luaopen_bit"", referenced from:
      Lua::loadLibraries(lua_State*) in scripting.cc.o
  ""_luaopen_cjson"", referenced from:
      Lua::loadLibraries(lua_State*) in scripting.cc.o
  ""_luaopen_cmsgpack"", referenced from:
      Lua::loadLibraries(lua_State*) in scripting.cc.o
  ""_luaopen_debug"", referenced from:
      Lua::loadLibraries(lua_State*) in scripting.cc.o
  ""_luaopen_math"", referenced from:
      Lua::loadLibraries(lua_State*) in scripting.cc.o
  ""_luaopen_string"", referenced from:
      Lua::loadLibraries(lua_State*) in scripting.cc.o
  ""_luaopen_struct"", referenced from:
      Lua::loadLibraries(lua_State*) in scripting.cc.o
  ""_luaopen_table"", referenced from:
      Lua::loadLibraries(lua_State*) in scripting.cc.o
ld: symbol(s) not found for architecture arm64
clang: error: linker command failed with exit code 1 (use -v to see invocation)
make[3]: *** [kvrocks] Error 1
make[2]: *** [CMakeFiles/kvrocks.dir/all] Error 2
make[1]: *** [CMakeFiles/kvrocks.dir/rule] Error 2
make: *** [kvrocks] Error 2
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSvKB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSvt8,kvrocks,1128987516,587,NA,PragmaTwice,20042607,Twice,,NA,2022-05-17T15:06:22Z,2022-05-17T15:06:22Z,"Maybe you can try this solution https://github.com/bitcoin/bitcoin/issues/20825#issuecomment-753444519. 
Don't know if it will work but there are a lot of similarities.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSvt8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSwwx,kvrocks,1128991793,587,NA,PragmaTwice,20042607,Twice,,NA,2022-05-17T15:10:13Z,2022-05-17T15:10:13Z,"Refer to https://stackoverflow.com/questions/69335349/error-when-compiling-protobuf-for-c-in-ios-undefined-symbols-and-ld-warni ,you can try `brew uninstall binutils`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DSwwx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DS2Fw,kvrocks,1129013616,587,NA,indianmifan,32297804,,lyang1817@163.com,NA,2022-05-17T15:29:12Z,2022-05-17T15:29:12Z,"> Refer to https://stackoverflow.com/questions/69335349/error-when-compiling-protobuf-for-c-in-ios-undefined-symbols-and-ld-warni ,you can try `brew uninstall binutils`.

Thanks, this solves my problem !","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DS2Fw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DVCwd,kvrocks,1129589789,587,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-18T05:41:25Z,2022-05-18T05:41:25Z,thanks @PragmaTwice and @indianmifan Closed,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DVCwd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/589,https://api.github.com/repos/apache/kvrocks/issues/589,kvrocks,1240058830,589,Improve `version.h.in` processing in CMake,PragmaTwice,20042607,Twice,,CLOSED,2022-05-18T14:31:18Z,2022-05-19T11:03:44Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Now the generated version.h by CMake is not comsistent with the previous Makefiles.
The version is now set in [CMakeLists.txt#L20](https://github.com/apache/incubator-kvrocks/blob/unstable/CMakeLists.txt#L20), we can remove it and read version in the Changelog file, so we do not need to change CMakeLists while a new version is released.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/589/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/589,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DbMLO,kvrocks,1131201230,589,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-19T04:56:21Z,2022-05-19T04:56:21Z,+1,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DbMLO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/590,https://api.github.com/repos/apache/kvrocks/issues/590,kvrocks,1240063525,590,Improve using of ASan and TSan in CMake build,PragmaTwice,20042607,Twice,,CLOSED,2022-05-18T14:34:42Z,2022-06-02T08:20:33Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As discussed in #586, we can improve using of ASan and TSan in the CMake build.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/590/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/590,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dax41,kvrocks,1131093557,590,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-19T03:09:32Z,2022-05-19T03:09:32Z,"cool, thanks, l like this idea. And we can also run tests with ASan and TSan in daily CI.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dax41/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/595,https://api.github.com/repos/apache/kvrocks/issues/595,kvrocks,1241685765,595,You can help Kvrocks to support more Redis commands,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,OPEN,2022-05-19T12:17:19Z,2023-07-12T14:28:10Z,"### Motivation

Now Kvrocks only support most commands of Redis 4.0 version. Here are supported commands https://github.com/apache/incubator-kvrocks/wiki/Support-Commands.

But now Redis is 7.0, developers want us to support some useful commands to make development easier.  Just a few of us is not enough to implement so many command. To make this project better, we need your help!

### Solution

If you want to implement one command, you can firstly open an issue for it (if it is not already created by others).

Here are the basic steps to implement a new command for your reference.
2. Implement the storage algorithm in `types/redis_xx.cc` (`redis_hash.cc`, `redis_list.cc`, `redis_zset.cc`, ...) and command parsing/executing class in `commands/cmd_xx.cc` (`cmd_string.cc`, `cmd_set.cc`, ...), you can refer other similar commands.
3. Add c++ and golang tests (unit tests, and integration tests if necessary).

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/595/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/595,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dcytt,kvrocks,1131621229,595,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-05-19T12:25:14Z,2022-05-19T12:25:14Z,"Here an issue #456 is needed to resolve

move comments from @PragmaTwice  to #456 to trace","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dcytt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/595,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OG2zn,kvrocks,1310420199,595,NA,boatrainlsz,18243785,boatrainlsz,yinger521999@gmail.com,NA,2022-11-10T14:58:37Z,2022-11-10T14:58:37Z,"try to implement `SINTERCARD` command, see #1083  for more details","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OG2zn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/598,https://api.github.com/repos/apache/kvrocks/issues/598,kvrocks,1242637684,598,A unified abstraction for redis command parsing,PragmaTwice,20042607,Twice,,CLOSED,2022-05-20T05:33:22Z,2022-12-18T15:33:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

**comments from @PragmaTwice:**
I feel that it might be a bit too cumbersome to operate a `vector<string>` for each command to parse, and there would be a lot of duplicated logic. It might be nice to design some unified abstraction, but I haven't figured out how to do that yet.

Here are some initial ideas.

To parse `SET key value [ NX | XX] [GET] [ EX seconds | PX milliseconds | EXAT unix-time-seconds | PXAT unix-time-milliseconds | KEEPTTL]` ([ref](https://redis.io/commands/set/)):

```
#define CHECK(x) if(!x.ok()) return parse failed
#define CHECK_ASSIGN(x, v, default) if(x == default || x == v) x = v else return parse failed

iter = parsing iterator(args...);

CHECK(iter.pick_str(&key)); // insure the arg exists, eat it and dump to `key` if exists
CHECK(iter.pick_str(&value));

while(!iter.reach_end()) {
  auto pos = iter.get_pos();

  if(iter.pick_eq(""NX"")) { // check the current arg is NX, eat it and return true if it is, otherwise return false
    CHECK_ASSIGN(set_flag, nx, none)
  } else if(iter.pick_eq(""XX"")) {
    CHECK_ASSIGN(set_flag, xx, none)
  }

  if(iter.pick_eq(""GET"")) {
     get_flag = true;
  }
  
  if(iter.pick_eq(""EX"")) {
    CHECK_ASSIGN(expire_flag, ex, none);
    CHECK(iter.pick_int(&expire_value));
  } else if(iter.pick_eq(""PX"")) {
    CHECK_ASSIGN(expire_flag, px, none);
    CHECK(iter.pick_int(&expire_value));
  } else if(iter.pick_eq(""EXAT"")) {
    CHECK_ASSIGN(expire_flag, exat, none);
    CHECK(iter.pick_int(&expire_value));
  } else if(iter.pick_eq(""PXAT"")) {
    CHECK_ASSIGN(expire_flag, pxat, none);
    CHECK(iter.pick_int(&expire_value));
  } else if(iter.pick_eq(""KEEPTTL"")) {
    CHECK_ASSIGN(expire_flag, keepttl, none);
  }

  if(iter.at(pos)) return parse failed;
}
```

or a shorter version with string literal as enums:

```
#define CHECK_ASSIGN(x, v) if(x == nullptr || x == v) x = v else return parse failed

const char *iter.pick_eq_literals(const char *strs[]) {
  for(str : strs) {
    if(iter.pick_eq(str)) return str;
  }
  return nullptr;
}

iter = parsing iterator(args...);

CHECK(iter.pick_str(&key));
CHECK(iter.pick_str(&value));

while(!iter.reach_end()) {
  auto pos = iter.get_pos();

  if(new_set_flag = iter.pick_eq_literals(""NX"", ""XX"")) {
    CHECK_ASSIGN(set_flag, new_set_flag)
  }

  if(iter.pick_eq(""GET"")) {
     get_flag = true
  }

  if(new_expire_flag = iter.pick_eq_literals(""EX"", ""PX"", ""EXAT"", ""PXAT"", ""KEEPTTL"")) {
    CHECK_ASSIGN(expire_flag, new_expire_flag);
  }
  
  if(new_expire_flag && new_expire_flag != ""KEEPTTL""s) {
    CHECK(iter.pick_int(&expire_value));
  }

  if(iter.at(pos)) return parse failed;
}
```

We can design it as an utility class, so command authors are free to use it or not.

Advantages:
- do not need to maintain the parsing state by ourselves (mostly)
- do not need to parse integer, float, or any input type by ourselves; report parse error for these types
- as efficient as previous

What do you think? I would appreciate any comments! @git-hulk  @ShooterIT 

**comments from @git-hulk**
It looks better than before, this idea is really nice to me.

_Originally posted by @ShooterIT in https://github.com/apache/incubator-kvrocks/issues/456#issuecomment-1132391216_

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/598/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/600,https://api.github.com/repos/apache/kvrocks/issues/600,kvrocks,1243843619,600,SlotImport::StopForLinkError(int fd) call_back received signal 11,joeylichang,10592664,joey,joeycli0919@gmail.com,CLOSED,2022-05-21T02:37:52Z,2022-05-25T12:51:46Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

kvrocks 2.0
macos 11.3.1 (20E241)
Darwin 20.4.0

### Minimal reproduce step

1. write tool auto migrate data by slot
2. migrating data and check migrating status by cluster info command
3. the importing node run a while, then received signal 11
```
W0521 09:00:24.454731 134987776 main.cc:85] ======= Ooops! kvrocks 2.0.6 got signal: 11 =======
W0521 09:00:24.475903 134987776 main.cc:93] 1   kvrocks_s1                          0x000000010a70930a _ZNKSt3__110__function12__value_funcIFviEEclEOi + 74
W0521 09:00:24.509127 134987776 main.cc:93] 2   ???                                 0x0000000000000000 0x0 + 0
W0521 09:00:24.528713 134987776 main.cc:93] 3   kvrocks_s1                          0x000000010a700ebf _ZNKSt3__18functionIFviEEclEi + 47
W0521 09:00:24.547070 134987776 main.cc:93] 4   kvrocks_s1                          0x000000010a700e18 _ZN5Redis10Connection5CloseEv + 360
W0521 09:00:24.548506 134987776 main.cc:93] 5   kvrocks_s1                          0x000000010a702ce7 _ZN5Redis10Connection7OnEventEP11buffereventsPv + 871
W0521 09:00:24.549592 134987776 main.cc:93] 6   kvrocks_s1                          0x000000010ad4fa94 bufferevent_run_deferred_callbacks_unlocked + 468
W0521 09:00:24.550586 134987776 main.cc:93] 7   kvrocks_s1                          0x000000010ad5b6c5 event_process_active_single_queue + 1093
W0521 09:00:24.551573 134987776 main.cc:93] 8   kvrocks_s1                          0x000000010ad581ff event_base_loop + 1775
W0521 09:00:24.552402 134987776 main.cc:93] 9   kvrocks_s1                          0x000000010a710da5 _ZN6Worker3RunENSt3__111__thread_idE + 37
W0521 09:00:24.553221 134987776 main.cc:93] 10  kvrocks_s1                          0x000000010a71ba65 _ZZN12WorkerThread5StartEvENK3$_0clEv + 69
W0521 09:00:24.553964 134987776 main.cc:93] 11  kvrocks_s1                          0x000000010a71b9cd _ZNSt3__1L8__invokeIZN12WorkerThread5StartEvE3$_0JEEEDTclclsr3std3__1E7forwardIT_Efp_Espclsr3std3__1E7forwardIT0_Efp0_EEEOS3_DpOS4_ + 29
W0521 09:00:24.554687 134987776 main.cc:93] 12  kvrocks_s1                          0x000000010a71b965 _ZNSt3__1L16__thread_executeINS_10unique_ptrINS_15__thread_structENS_14default_deleteIS2_EEEEZN12WorkerThread5StartEvE3$_0JEJEEEvRNS_5tupleIJT_T0_DpT1_EEENS_15__tuple_indicesIJXspT2_EEEE + 37
W0521 09:00:24.555402 134987776 main.cc:93] 13  kvrocks_s1                          0x000000010a71b202 _ZNSt3__1L14__thread_proxyINS_5tupleIJNS_10unique_ptrINS_15__thread_structENS_14default_deleteIS3_EEEEZN12WorkerThread5StartEvE3$_0EEEEEPvSA_ + 98
W0521 09:00:24.556113 134987776 main.cc:93] 14  libsystem_pthread.dylib             0x00007fff205f8954 _pthread_start + 224
W0521 09:00:24.556841 134987776 main.cc:93] 15  libsystem_pthread.dylib             0x00007fff205f44a7 thread_start + 15
```

debug trace call path
1. cluster import command build connectin bind close_cb_ whith StopForLinkError
2. when connectin fd receive 'BEV_EVENT_EOF' event, will call close_cb_
3. then received signal 11

```
Status Cluster::ImportSlot(Redis::Connection *conn, int slot, int state) {
....
  switch (state) {
    case kImportStart:
      if (!svr_->slot_import_->Start(conn->GetFD(), slot)) {
        return Status(Status::NotOK, ""Can't start importing slot "" + std::to_string(slot));
      }
      // Set link importing
      conn->SetImporting();
      myself_->importing_slot_ = slot;
      // Set link error callback
      conn->close_cb_ = std::bind(&SlotImport::StopForLinkError, svr_->slot_import_, conn->GetFD());
  }
 .....
}

// libevent return 'BEV_EVENT_EOF' event , call close
void Connection::Close() {
  owner_->FreeConnection(this);
  if (close_cb_) {
    close_cb_(GetFD());
  }
}

// do not enter close_cb_, but at close_cb_ line receive signal 11
close_cb_ bind StopForLinkError
void SlotImport::StopForLinkError(int fd) {
  std::lock_guard<std::mutex> guard(mutex_);
  if (import_status_ != kImportStart) return;
  if (!svr_->IsSlave()) {
    // Clean imported slot data
    LOG(ERROR) << ""SlotImport 4444444444"";
    auto s = ClearKeysOfSlot(namespace_, import_slot_);
    if (!s.ok()) {
      LOG(ERROR) << ""[import] Failed to clear keys of slot "" << import_slot_
                << "" Current status is link error""
                << "", Err: "" << s.ToString();
    }
  }

  LOG(ERROR) << ""[import] Stop importing for link error, slot: "" << import_slot_;
  import_status_ = kImportFailed;
  import_fd_ = -1;
}

```


### What did you expect to see?

any ideas?

### What did you see instead?

I try cancel call close_cb_ at connection close, tested for a long time with no problems
so initial confirmation should be the problem here

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/600/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/600,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DkAuF,kvrocks,1133513605,600,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-21T02:41:42Z,2022-05-21T02:41:42Z,"@joeylichang Can you have a try at the latest version, it should be fixed at: https://github.com/apache/incubator-kvrocks/commit/f3a1fb54526b30734737d814eb39994c34421c6b","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DkAuF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/600,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DyEze,kvrocks,1137200350,600,NA,joeylichang,10592664,joey,joeycli0919@gmail.com,NA,2022-05-25T12:51:46Z,2022-05-25T12:51:46Z,"yes, newest commit on unstable branch is right","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DyEze/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/601,https://api.github.com/repos/apache/kvrocks/issues/601,kvrocks,1244154979,601,[NEW] add lz4 lib,xiaobiaozhao,52393536,xiaobiaozhao,,CLOSED,2022-05-22T05:49:36Z,2022-06-23T11:19:21Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

KVrocks not included lz4 lib for lz4 compresssion. Only snappy is not enough，lz4 is a  efficient algorithm.

https://user-images.githubusercontent.com/52393536/168716155-82a51edf-74df-48e5-b047-f4e05a192719.png

### Solution

1. Add lz4 lib into build file.
2. Add conf for rocksdb.compression ""lz4""

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/601/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/601,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DlZcr,kvrocks,1133877035,601,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-22T11:42:55Z,2022-05-22T11:42:55Z,"Cool, agreed.

the compression ration and performance are better than `snappy`
in many scenarios. Someone also requests this feature if my memory serves.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DlZcr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/602,https://api.github.com/repos/apache/kvrocks/issues/602,kvrocks,1244628331,602,Add clang tidy for static analysis,PragmaTwice,20042607,Twice,,CLOSED,2022-05-23T06:08:15Z,2022-10-23T01:32:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Clang tidy is a static analysis tool based on libclang, which itself is able to match problematic code patterns at the AST level. 
Its power lies in the ability to directly call checkers in Clang StaticAnalyzer that perform basic symbolic execution and constraint solving on the control flow graph converted directly from the Clang AST.

This allows clang tidy to check both code smell and some code safety issues such as memory leaks, null pointer dereferences or double frees in a more precise way (than cppcheck, cpplint, etc.). The full set of checkers in clang tidy can be viewed here: https://clang.llvm.org/extra/clang-tidy/checks/list.html.


### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/602/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/603,https://api.github.com/repos/apache/kvrocks/issues/603,kvrocks,1245095164,603,The slave would crash when restoring the db from checkpoint error,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-05-23T12:31:47Z,2022-05-25T08:10:41Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.0.6

### Minimal reproduce step

1. slaveof `x.x.x.x`
2. remove some files to fail the restore db process

### What did you expect to see?

The slave should serve with the old database

### What did you see instead?

![image](https://user-images.githubusercontent.com/4987594/169819811-64cf7906-2650-4317-b0ce-71d0a40e909f.png)


### Anything Else?

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/603/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/603,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DxCTo,kvrocks,1136927976,603,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-25T08:09:52Z,2022-05-25T08:09:52Z,"Sorry for forgetting to add more information. From the ip, we can see it crashed
at [src/server.cc:496](https://github.com/apache/incubator-kvrocks/blob/v2.0.6/src/server.cc#L496):

> addr2line -e /www/kvrocks/bin/kvrocks 0x00000000004eecfc

/__w/kvrocks/kvrocks/src/server.cc:496

cc @ShooterIT @tisonkun ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DxCTo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/607,https://api.github.com/repos/apache/kvrocks/issues/607,kvrocks,1247753516,607,get an error when i write data to kvrocks--ERR Corruption: Corrupted compressed block contents: Snappy,luger1990,2096878,Luger Smith,,CLOSED,2022-05-25T08:34:42Z,2022-06-01T15:56:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.0.6

### Minimal reproduce step

set ER6mKDKmhr 123

### What did you expect to see?

write data to kvrocks

### What did you see instead?

(error) ERR Corruption: Corrupted compressed block contents: Snappy

### Anything Else?

```
192.168.100.121:6382> set ER6mKDKmhr 123
(error) ERR Corruption: Corrupted compressed block contents: Snappy
192.168.100.121:6382> 
```

```
web@nct:/data/kvrocks/develop-6382/logs$ cat kvrocks.ERROR
Log file created at: 2022/05/24 20:32:56
Running on machine: nct
Log line format: [IWEF]mmdd hh:mm:ss.uuuuuu threadid file:line] msg
E0524 20:32:56.061395 1220550 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:40572, while encounter error: Connection reset by peer
E0524 20:37:05.776957 1220550 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:40478, while encounter error: Connection reset by peer
E0525 13:20:04.996747 1220547 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:35084, while encounter error: Connection reset by peer
E0525 13:36:15.581916 1220545 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:35730, while encounter error: Connection reset by peer
E0525 15:14:23.671350 1220544 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:50194, while encounter error: Connection reset by peer
E0525 15:14:33.936123 1220461 event_listener.cc:113] [event_listener/background_error] reason: compact, status: Corruption: Corrupted compressed block contents: Snappy
E0525 15:17:35.954617 1220547 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:50446, while encounter error: Connection reset by peer
```

```
web@nct:/data/kvrocks/develop-6382/logs$ cat kvrocks.WARNING
Log file created at: 2022/05/24 20:30:37
Running on machine: nct
Log line format: [IWEF]mmdd hh:mm:ss.uuuuuu threadid file:line] msg
W0524 20:30:37.310361 1220458 server.cc:1452] [server] Increased maximum number of open files to 18224 (it's originally set to 1024)
E0524 20:32:56.061395 1220550 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:40572, while encounter error: Connection reset by peer
E0524 20:37:05.776957 1220550 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:40478, while encounter error: Connection reset by peer
E0525 13:20:04.996747 1220547 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:35084, while encounter error: Connection reset by peer
E0525 13:36:15.581916 1220545 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:35730, while encounter error: Connection reset by peer
E0525 15:14:23.671350 1220544 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:50194, while encounter error: Connection reset by peer
E0525 15:14:33.936123 1220461 event_listener.cc:113] [event_listener/background_error] reason: compact, status: Corruption: Corrupted compressed block contents: Snappy
E0525 15:17:35.954617 1220547 redis_connection.cc:107] [connection] Going to remove the client: 192.168.100.121:50446, while encounter error: Connection reset by peer
```

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/607/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/607,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DxfpR,kvrocks,1137048145,607,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-25T10:04:48Z,2022-05-25T10:04:48Z,@luger1990 Thanks for your feedback. Did you install the snappy library on your machine?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5DxfpR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/607,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dx-1z,kvrocks,1137175923,607,NA,luger1990,2096878,Luger Smith,,NA,2022-05-25T12:25:48Z,2022-05-25T12:25:48Z,"i think i have installed snappy library 
```
root@nct:~# dpkg -l|grep snappy 
ii  libsnappy-dev:amd64                   1.1.8-1build1                         amd64        fast compression/decompression library (development files)
ii  libsnappy1v5:amd64                    1.1.8-1build1                         amd64        fast compression/decompression library
```

At the beginning, it was writable. After writing dozens of M data, this error was prompted.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Dx-1z/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/607,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D6ymS,kvrocks,1139485074,607,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-27T10:20:58Z,2022-05-27T10:20:58Z,"@luger1990 can you add more information about how you install and run the Kvrocks? For the previous steps, I can't reproduce the condition, thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D6ymS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/607,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7vcz,kvrocks,1139734323,607,NA,luger1990,2096878,Luger Smith,,NA,2022-05-27T15:41:03Z,2022-05-27T15:41:03Z,"> @luger1990 can you add more information about how you install and run the Kvrocks? For the previous steps, I can't reproduce the condition, thanks.

i will test on other machines tomorrow. thanks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7vcz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/607,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D72rp,kvrocks,1139763945,607,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-27T16:16:47Z,2022-05-27T16:16:47Z,"@luger1990 cool, thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D72rp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/607,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D-gCv,kvrocks,1140457647,607,NA,luger1990,2096878,Luger Smith,,NA,2022-05-29T14:11:56Z,2022-05-29T14:11:56Z,"> @luger1990 cool, thanks.

our new machines will be ready next day i will test when machines is ready","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D-gCv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/607,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EKvQm,kvrocks,1143665702,607,NA,luger1990,2096878,Luger Smith,,NA,2022-06-01T14:12:29Z,2022-06-01T14:12:29Z,"> @luger1990 can you add more information about how you install and run the Kvrocks? For the previous steps, I can't reproduce the condition, thanks.

i install snappy to my machine, and it works.
```
apt install libsnappy-dev
```

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EKvQm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/607,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ELNwO,kvrocks,1143790606,607,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-01T15:56:27Z,2022-06-01T15:56:27Z,"Thanks @luger1990, can use the CMake way, it will link the snappy as the static library so that we needn't to install snappy everywhere.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ELNwO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/609,kvrocks,1250436216,609,Memory leaks in Lua::redisGenericCommand,PragmaTwice,20042607,Twice,,CLOSED,2022-05-27T07:23:35Z,2022-06-02T06:00:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

`redisGenericCommand` use `raiseError` to process errors, but `raiseError` will perform a longjmp in the `lua_error` api call, so `raiseError` never returns.

longjmp does not compatible with RAII in C++ (C++ exceptions may use longjmp in implementation but the compiler will insert some dtor call autometically and carefully, i.e. stack unwinding), so every object in the stack of `redisGenericCommand` will never be destroyed, i.e. no destructor will be call, hence all resource allocated in ctor like `std::vector`, `std::unique_ptr` etc. cannot be released.

@git-hulk

### Minimal reproduce step

`./runtest --dont-clean` on a kvrocks binary with Address Sanitizer enabled. (try to build with #599)
You can only run tests in unit/scripting to save time : )

### What did you expect to see?

No memory leaks

### What did you see instead?

Memory leaks are reported by Address Sanitizer

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/609/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D6f0A,kvrocks,1139408128,609,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-27T08:41:11Z,2022-05-27T08:41:11Z,"Cool, Thanks for Twice great investigation.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D6f0A/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D63sN,kvrocks,1139505933,609,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-27T10:49:43Z,2022-05-27T10:49:43Z,"@PragmaTwice Really good catch, I wasn't aware the destructor would be ignored by longjump. Lua supported using `try..catch` to workaround the C++ condition: https://github.com/KvrocksLabs/lua/blob/3e2d94b3b98d774dcd4fb448b1cb64615ae0590d/src/luaconf.h#L606","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D63sN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7KqB,kvrocks,1139583617,609,NA,PragmaTwice,20042607,Twice,,NA,2022-05-27T12:43:07Z,2022-05-27T12:43:07Z,"> @PragmaTwice Really good catch, I wasn't aware the destructor would be ignored by longjump. Lua supported using `try..catch` to workaround the C++ condition: https://github.com/KvrocksLabs/lua/blob/3e2d94b3b98d774dcd4fb448b1cb64615ae0590d/src/luaconf.h#L606

Yeah, I found two method to solve this problem:
1. build lua with a C++ compiler like `CC=g++`, then lua will use these `try..catch` stuff to implement `lua_error` or other functions, refer to ""4.6 – Error Handling in C"" in https://www.lua.org/manual/5.3/manual.html.
2. raise C++ exception manually, like in http://lua-users.org/wiki/ErrorHandlingBetweenLuaAndCplusplus or https://stackoverflow.com/questions/4615890/how-to-handle-c-exceptions-when-calling-functions-from-lua.

Which solution do you prefer?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7KqB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7N_w,kvrocks,1139597296,609,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-27T13:01:22Z,2022-05-27T13:01:22Z,"@PragmaTwice it seems that the minimal solution is opinion 1 proposed above. If we'd like to raise C++ exception manually, both `pushError` and `raiseError` and their call points should be investigated and changed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7N_w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7Otw,kvrocks,1139600240,609,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-05-27T13:05:05Z,2022-05-27T13:05:05Z,"Yes, it will be good to use solution 1, since we don't need to prevent using those functions(which contains `longjump`) every time. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7Otw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7WGI,kvrocks,1139630472,609,NA,PragmaTwice,20042607,Twice,,NA,2022-05-27T13:40:35Z,2022-05-27T13:40:35Z,@tisonkun @git-hulk Agree with that. I'll try the first solution.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7WGI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7Xgz,kvrocks,1139636275,609,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-05-27T13:47:31Z,2022-05-27T13:47:31Z,@PragmaTwice Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D7Xgz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EIbKb,kvrocks,1143059099,609,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-01T02:46:11Z,2022-06-01T02:46:11Z,"With a closer look into this issue, I'm considering whether we can use a new version of Lua or LuaJIT to workaround this issue with C++ compiler. Hacking on a fork is possibly hard to maintain.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EIbKb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EIb1p,kvrocks,1143061865,609,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-01T02:52:35Z,2022-06-01T02:52:35Z,"@tisonkun Yes, many guys proposed this in Redis community, but didn't have any progress. The main issue is that will break the old Lua scripts, coz Lua 5.2+ have many breaking changes compared with 5.1. That's the reason why we still stuck in 5.1.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EIb1p/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EIeFg,kvrocks,1143071072,609,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-01T03:11:53Z,2022-06-01T03:11:53Z,"@git-hulk @PragmaTwice Hmmm, I just notice that Redis uses a [Lua 5.1 fork](https://github.com/redis/redis/tree/unstable/deps/lua) also. Is it possible that we pull Lua code directly into this repo and port them into c++ code? As a kvrocks bundle Lua engine, it needs not to be able to build with C compiler. It may be an approach we working around the compiling issues at #614.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EIeFg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EIpmB,kvrocks,1143118209,609,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-01T04:57:51Z,2022-06-01T04:57:51Z,"> @git-hulk @PragmaTwice Hmmm, I just notice that Redis uses a [Lua 5.1 fork](https://github.com/redis/redis/tree/unstable/deps/lua) also. Is it possible that we pull Lua code directly into this repo and port them into c++ code? As a kvrocks bundle Lua engine, it needs not to be able to build with C compiler. It may be an approach we working around the compiling issues at #614.

@tisonkun Do you mean that we can pull the Lua codes from Redis repo and only patch some files we wanted? If yes, I'm didn't have experience by this way but I think it's a good way to keep consistency with Redis repo.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EIpmB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EItBO,kvrocks,1143132238,609,NA,PragmaTwice,20042607,Twice,,NA,2022-06-01T05:27:35Z,2022-06-01T05:27:35Z,Maybe we can discuss it in a new issue since this issue is closed? @tisonkun,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EItBO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EK0oH,kvrocks,1143687687,609,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-01T14:31:00Z,2022-06-01T14:31:00Z,"@PragmaTwice Yes. I only have an unclear idea yet so I'll create an issue if I get some time to prototype. If you're interested in this topic you can create an issue and go ahead :)

Since #614 is resolved this idea isn't a required work now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EK0oH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ELJMn,kvrocks,1143771943,609,NA,PragmaTwice,20042607,Twice,,NA,2022-06-01T15:40:38Z,2022-06-01T15:40:38Z,"> @PragmaTwice Yes. I only have an unclear idea yet so I'll create an issue if I get some time to prototype. If you're interested in this topic you can create an issue and go ahead :)
> 
> Since #614 is resolved this idea isn't a required work now.

Thanks. Here are some of ideas from the conversation above and my comments:

#### Solution 1: ""pull the Lua codes from Redis repo and only patch some files we wanted"" mentioned by @git-hulk 
If I understand correctly, this means that the redis code is fetched and patched during the build process.
I am familiar with applying patch in cmake after FetchContent, but my concern is that we may have to fetch all files in redis to local since I do not know how to just fetch a subdir of a git repo. And I think it may confuse users that we depend on redis. 
And I feel that maintaining patch files is more troublesome than maintaining a git repo.

#### Solution 2: copy lua codes from Redis repo directly to a subdir of this repo and modify it
I think having lua fork as another repo might avoid some redundant commits and make the main repo cleaner.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ELJMn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/609,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ENzSz,kvrocks,1144468659,609,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-02T06:00:08Z,2022-06-02T06:00:08Z,"@PragmaTwice thanks for your feedback. After some investigation I also agree that current status is good enough for running Kvrocks project. If we meet further concrete issue, we may review this approach then.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ENzSz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/612,https://api.github.com/repos/apache/kvrocks/issues/612,kvrocks,1251658082,612,Change the unit of the rocksdb options,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-05-28T15:26:18Z,2022-06-11T14:58:02Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

PR https://github.com/apache/incubator-kvrocks/pull/497 and https://github.com/apache/incubator-kvrocks/pull/503 allowed changing the rocksdb options `blob_file_size` and `max_bytes_for_level_base` in-flight. But from the literal, we would think that the unit of these two configurations should be bytes(like `max_bytes_for_level_base`), but in fact was MiB. So it should be a good idea to change them with the right unit, this will NOT break the behavior  since we didn't release those features yet.

### Solution

Change the unit of `max_bytes_for_level_base` and `blob_file_size` to bytes in the configuration file.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/612/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/612,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D-nYA,kvrocks,1140487680,612,NA,WyattJia,8580364,bitstring,i@eventloop.live,NA,2022-05-29T17:03:36Z,2022-05-29T17:03:36Z,"And about max_bytes_for_level configuration's change, I opened another PR on #610 ,please review and thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5D-nYA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/616,https://api.github.com/repos/apache/kvrocks/issues/616,kvrocks,1258184861,616,Failed to run the unittest in  the daily CI,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-06-02T13:25:31Z,2022-06-02T13:50:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

a13465b5306a40ca04e37db02595bee0b36b0192

### Minimal reproduce step

Manually trigger the daily CI in GitHub Actions

### What did you expect to see?

Daily CI can run normally

### What did you see instead?

[Failed to run the unittest](https://github.com/apache/incubator-kvrocks/runs/6705190334?check_suite_focus=true)

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/616/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/621,https://api.github.com/repos/apache/kvrocks/issues/621,kvrocks,1260983264,621,Enhancement: support Ninja as a CMake backend,PragmaTwice,20042607,Twice,,CLOSED,2022-06-05T07:33:48Z,2022-06-10T07:09:31Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

CMake support Ninja (`-G Ninja`) as a build tools to generate, just like Makefiles, which provides more efficient build processing.
But there are some problem in current CMake configurations in kvrocks so we cannot use it.

I will investigate it and make a fix.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/621/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/621,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EWiui,kvrocks,1146760098,621,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-05T08:00:29Z,2022-06-05T08:00:29Z,"Agree. ClickHouse using ninja as the default build system and it does speed up the process.

When you prepare a patch, it'll be valuable to provide a report on the improvement by changing build system. Otherwise we may not make such switch without a clear motivation.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EWiui/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/621,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EWi6P,kvrocks,1146760847,621,NA,PragmaTwice,20042607,Twice,,NA,2022-06-05T08:05:05Z,2022-06-05T08:05:05Z,"> Agree. ClickHouse using ninja as the default build system and it does speed up the process.
> 
> When you prepare a patch, it'll be valuable to provide a report on the improvement by changing build system. Otherwise we may not make such switch without a clear motivation.

My idea is to make ninja an option for build, e.g. specify `--ninja` (`./build.sh build --ninja`) to use ninja, otherwise (the default behavior is) use make, and because CMake already supports Ninja so only a few fixes are needed, not too many changes.
I will make a benchmark between make and ninja for kvrocks to test whether ninja speed up the build.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EWi6P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/622,https://api.github.com/repos/apache/kvrocks/issues/622,kvrocks,1260984663,622,Enhancement: Support GitHub mirrors in CMake build configurations,PragmaTwice,20042607,Twice,,CLOSED,2022-06-05T07:42:25Z,2022-06-28T15:35:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

GitHub has some access issues in some countries (connection resets or slow speeds), 
so we can support custom URL of dependencies in CMake configurations, such as `ghproxy.com`, 
which will speed up build procedure, e.g. `./build.sh build -DGITHUB_PROXY=https://ghproxy.com`.

**NOTICE: we may need to add SHA verification of fetched files to ensure that users are not vulnerable to MITM attacks by public proxy providers if we decide to add this feature.**

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/622/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/622,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EWirE,kvrocks,1146759876,622,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-05T07:58:40Z,2022-06-05T07:58:40Z,Sounds reasonable :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EWirE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/623,https://api.github.com/repos/apache/kvrocks/issues/623,kvrocks,1261671354,623,Improve website logo asset,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-06-06T10:43:45Z,2022-06-07T23:02:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

![image](https://user-images.githubusercontent.com/18818196/172305964-987626d6-f547-4f12-af54-0a7d530e38d2.png)

> > @git-hulk the logo svg and favicon isn't quite good-look, though. I'm unfamiliar with draw a logo and maybe you can help on creating a better version.
> 
> OK, I'm also unfamiliar with that. Will contact the original designer to help.

Originally posted at https://github.com/apache/incubator-kvrocks-website/pull/5#issuecomment-1147160341.

cc @git-hulk 

### Solution

_No response_
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/623/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/623,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EdNJB,kvrocks,1148506689,623,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-07T10:51:18Z,2022-06-07T10:51:18Z,"Thanks @tisonkun, the original designer has helped to update the logo, will submit soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EdNJB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/623,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EeeAF,kvrocks,1148837893,623,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-07T15:37:52Z,2022-06-07T15:37:52Z,"@tisonkun can have a look at https://kvrocks.apache.org/, if looks good then we can close this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EeeAF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/623,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EgDl2,kvrocks,1149254006,623,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-07T23:02:25Z,2022-06-07T23:02:25Z,"
<img width=""1792"" alt=""image"" src=""https://user-images.githubusercontent.com/18818196/172497252-ed83458c-af17-49f3-8501-3ef3534335a1.png"">

It looks pretty better! Closed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EgDl2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/624,https://api.github.com/repos/apache/kvrocks/issues/624,kvrocks,1264902527,624,Benchmark between make and ninja build for kvrocks,PragmaTwice,20042607,Twice,,CLOSED,2022-06-08T15:06:17Z,2022-06-08T15:18:00Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

In #621, @tisonkun came up with a great idea: benchmark ninja build and make build of kvrocks.
I did this test after making some fixes to make cmake configuration of kvrocks support ninja. 
A PR for that will follow.

### Preparation
```sh
mkdir bm-make-build && cd bm-make-build && cmake .. -DCMAKE_BUILD_TYPE=RelWithDbgInfo
mkdir bm-ninja-build && cd bm-ninja-build && cmake .. -DCMAKE_BUILD_TYPE=RelWithDbgInfo -G Ninja
```

### Clean Build
```sh
$ hyperfine -r 1 ""cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest"" ""cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest""
Benchmark 1: cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest
  Time (abs ≡):        186.883 s               [User: 1139.316 s, System: 62.312 s]
 
Benchmark 2: cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest
  Time (abs ≡):        212.749 s               [User: 1129.823 s, System: 60.877 s]
 
Summary
  'cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest' ran
    1.14 times faster than 'cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest'
```

### No-op Incremental Build
```sh
$ hyperfine -r 1 ""cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest"" ""cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest""
Benchmark 1: cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest
  Time (abs ≡):        657.1 ms               [User: 707.8 ms, System: 224.1 ms]
 
Benchmark 2: cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest
  Time (abs ≡):         39.0 ms               [User: 25.7 ms, System: 17.7 ms]
 
Summary
  'cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest' ran
   16.86 times faster than 'cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest
```

### Incremental Build after modifying a source file
```sh
$ hyperfine -r 1 ""cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest"" ""cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest""
Benchmark 1: cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest
  Time (abs ≡):        16.158 s               [User: 14.762 s, System: 1.640 s]
 
Benchmark 2: cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest
  Time (abs ≡):         6.797 s               [User: 16.019 s, System: 1.530 s]
 
Summary
  'cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest' ran
    2.38 times faster than 'cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest'
```

### Incremental Build after modifying a header file
```sh
$ hyperfine -r 1 ""cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest"" ""cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest""
Benchmark 1: cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest
  Time (abs ≡):        39.906 s               [User: 143.227 s, System: 7.891 s]
 
Benchmark 2: cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest
  Time (abs ≡):        27.103 s               [User: 163.895 s, System: 8.882 s]
 
Summary
  'cd bm-ninja-build; ninja -j8 kvrocks kvrocks2redis unittest' ran
    1.47 times faster than 'cd bm-make-build; make -j8 kvrocks kvrocks2redis unittest'
```

### Conclusion
As you can see, ninja is slightly slower than make build in clean build, but has huge advantages in incremental build, which is very friendly to kvrocks developers who need to do frequent incremental builds.

I would like to make kvrocks use make by default, but have a `--ninja` option to enable ninja.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/624/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/624,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EjFtY,kvrocks,1150049112,624,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-08T15:10:39Z,2022-06-08T15:10:39Z,"@PragmaTwice I guess this can be a reply on #621 or since this issue has been created, we can move it to Discussions?

It doesn't seem like an issue to resolve but a general topic about benchmark.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EjFtY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/624,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EjG6a,kvrocks,1150054042,624,NA,PragmaTwice,20042607,Twice,,NA,2022-06-08T15:14:42Z,2022-06-08T15:14:42Z,"> @PragmaTwice I guess this can be a reply on #621 or since this issue has been created, we can move it to Discussions?
> 
> It doesn't seem like an issue to resolve but a general topic about benchmark.

Oh yeah, I also think moving to Discussions is better.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5EjG6a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/627,https://api.github.com/repos/apache/kvrocks/issues/627,kvrocks,1265971128,627,RocksDB can't auto resume after disk quota exceeded error,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2022-06-09T11:10:43Z,2022-06-10T07:46:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

Kvrocks: 2.0.6

### Minimal reproduce step

1. limit the disk of kvrocks data-dir
2. create some big files when rocksdb compaction, make these files fill up the disk
3. if you keep writing to kvrocks, you'll find that you can't write to it
4. delete the useless files created in step 2 and find that kvrocks still cannot write

### What did you expect to see?

When disk space is available, kvrocks can write data normally.

### What did you see instead?

The kvrocks log keeps appearing: 
```
[event_listener.cc:93] [event_listener/background_error] reason: writecallback, status: IO error: While appending to file: /data/db/xxxx.sst: Disk quota exceeded
```
Kvrocks has been unable to write data unless it is restarted. 

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/627/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/633,https://api.github.com/repos/apache/kvrocks/issues/633,kvrocks,1273416554,633,Wrongly parsed the RESP empty/null array,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-06-16T11:12:54Z,2022-06-24T10:52:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

b1eb17f0228b40244694b308639a8876c90444ba

### Minimal reproduce step

According to https://redis.io/docs/reference/protocol-spec/#resp-arrays, 
empty/null array is allowed in RESP but Kvrocks got the protocol error.

```shell
# empty array
$ echo '*0\r\n*2\r\n$3\r\nget\r\n$3\r\nkey\r\n'|nc 127.0.0.1 6666
# null array
$ echo '*-1\r\n*2\r\n$3\r\nget\r\n$3\r\nkey\r\n'|nc 127.0.0.1 6666
```

### What did you expect to see?

Kvrocks can parse those protocol correctly and response the right value of the `key`
like Redis behavior:
```shell
❯ echo '*0\r\n*2\r\n$3\r\nget\r\n$3\r\nkey\r\n'|nc 127.0.0.1 6379                                                                                                  
$-1

❯ echo '*-1\r\n*2\r\n$3\r\nget\r\n$3\r\nkey\r\n'|nc 127.0.0.1 6379                                                                                                 
$-1
```

### What did you see instead?

```shell
❯ echo '*0\r\n*2\r\n$3\r\nget\r\n$3\r\nkey\r\n'|nc 127.0.0.1 6666                                                                                                  
-Protocol error: expected '$'

❯ echo '*-1\r\n*2\r\n$3\r\nget\r\n$3\r\nkey\r\n'|nc 127.0.0.1 6666                                                                                                 
-Protocol error: invalid multibulk length
```

### Anything Else?

For the empty array case, Kvrocks should NOT enter the next state when the multi bulk length is 0 at line:[redis_request.cc#L71](https://github.com/apache/incubator-kvrocks/blob/unstable/src/redis_request.cc#L71)

For the null array case, Kvrocks should use `stoll` to parse the number instead of `stoull` since the length maybe negative at line: [redis_request.cc#L62](https://github.com/apache/incubator-kvrocks/blob/unstable/src/redis_request.cc#L62). Also, we need to skip the null array like the empty array case.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/633/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/633,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FEK88,kvrocks,1158721340,633,NA,willshS,41932662,,,NA,2022-06-17T10:10:15Z,2022-06-17T10:10:15Z,I would like to fix this issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FEK88/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/633,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FELtB,kvrocks,1158724417,633,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-17T10:14:17Z,2022-06-17T10:14:17Z,"> I would like to fix this issue.

OK, thanks @willshS ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FELtB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/633,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FENW6,kvrocks,1158731194,633,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-17T10:23:20Z,2022-06-17T10:23:20Z,@willshS thanks for picking this issue. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FENW6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/637,https://api.github.com/repos/apache/kvrocks/issues/637,kvrocks,1274756084,637,Enhancement: More user-friendly error message ,gogim1,10893839,Jinze Wu,,CLOSED,2022-06-17T08:47:56Z,2023-01-06T07:27:48Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

I get two kinds of error messages when I exec kvrock2redis like this:
* if the `data-dir` in config file is an unexist path,  it shows `Failed to load config, err: NotFound: `
* if the config file is not found,  it shows `Failed to load config, err: No such file or directory`

I think it need a more accurate error message to distinguish this two cases. 

### Solution

Maybe the simpliest way to solve this problem is to append `+ data_dir` after `s.ToString()`:
https://github.com/apache/incubator-kvrocks/blob/c391953f92fc03b4d22e100a42024a898f3fae47/tools/kvrocks2redis/config.cc#L143

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/637/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/637,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FEM45,kvrocks,1158729273,637,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-17T10:20:42Z,2022-06-17T10:20:42Z,This improvement makes sense to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FEM45/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/639,https://api.github.com/repos/apache/kvrocks/issues/639,kvrocks,1275960472,639,BUG: Data race reported by TSan in kvrocks,PragmaTwice,20042607,Twice,,CLOSED,2022-06-19T05:45:33Z,2022-07-31T15:20:33Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable, linux

### Minimal reproduce step

```sh
./build.sh build --unittest -DENABLE_TSAN=ON
./build/unittest
```

### What did you expect to see?

No TSan report.

### What did you see instead?

Selected TSan log in unittest:
```
WARNING: ThreadSanitizer: data race (pid=14679)
  Read of size 1 at 0x7b7c0000673b by thread T1:
    #0 memcmp <null> (libtsan.so.0+0x67cb3)
    #1 rocksdb::Slice::compare(rocksdb::Slice const&) const /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/rocksdb-src/include/rocksdb/slice.h:250 (unittest+0x5d75ef)
    #2 Compare /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/rocksdb-src/util/comparator.cc:34 (unittest+0x5d75ef)
    #3 Engine::SubKeyFilter::Filter(int, rocksdb::Slice const&, rocksdb::Slice const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*, bool*) const /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/compact_filter.cc:111 (unittest+0x18605c)
    #4 rocksdb::CompactionFilter::FilterV2(int, rocksdb::Slice const&, rocksdb::CompactionFilter::ValueType, rocksdb::Slice const&, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*) const /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/rocksdb-src/include/rocksdb/compaction_filter.h:171 (unittest+0x67ba24)
    #5 rocksdb::CompactionIterator::InvokeFilterIfNeeded(bool*, rocksdb::Slice*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/rocksdb-src/db/compaction/compaction_iterator.cc:276 (unittest+0x67ba24)
  Previous write of size 1 at 0x7b7c0000673b by main thread (mutexes: write M19766):
    #0 memcpy <null> (libtsan.so.0+0x61afe)
    #1 memcpy /usr/include/x86_64-linux-gnu/bits/string_fortified.h:34 (unittest+0x427deb)
    #2 rocksdb::MemTable::Add(unsigned long, rocksdb::ValueType, rocksdb::Slice const&, rocksdb::Slice const&, rocksdb::ProtectionInfoKVOS<unsigned long> const*, bool, rocksdb::MemTablePostProcessInfo*, void**) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/rocksdb-src/db/memtable.cc:556 (unittest+0x427deb)
    #3 Redis::Bitmap::SetBit(rocksdb::Slice const&, unsigned int, bool, bool*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/redis_bitmap.cc:217 (unittest+0x1b727e)
    #4 RedisBitmapTest_BitPosSetBit_Test::TestBody() /home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/t_bitmap_test.cc:86 (unittest+0xedaa1)
    #5 void testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/gtest-src/googletest/src/gtest.cc:2607 (unittest+0x7ee349)
    #6 void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/gtest-src/googletest/src/gtest.cc:2643 (unittest+0x7ee349)
    #7 __libc_start_main <null> (libc.so.6+0x21c86)
  Location is heap block of size 3264 at 0x7b7c00006200 allocated by main thread:
    #0 operator new(unsigned long) <null> (libtsan.so.0+0x8e62e)
    #1 rocksdb::ColumnFamilyData::ConstructNewMemtable(rocksdb::MutableCFOptions const&, unsigned long) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/rocksdb-src/db/column_family.cc:1065 (unittest+0x66cc9d)
    #2 Engine::Storage::Open() /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage.cc:323 (unittest+0x306775)
    #3 TestBase::TestBase() /home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/test_base.h:34 (unittest+0xef3c8)
    #4 RedisBitmapTest::RedisBitmapTest() /home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/t_bitmap_test.cc:28 (unittest+0xef3c8)
    #5 RedisBitmapTest_BitPosSetBit_Test::RedisBitmapTest_BitPosSetBit_Test() /home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/t_bitmap_test.cc:82 (unittest+0xef3c8)
    #6 testing::internal::TestFactoryImpl<RedisBitmapTest_BitPosSetBit_Test>::CreateTest() /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/gtest-src/googletest/include/gtest/internal/gtest-internal.h:472 (unittest+0xef3c8)
    #7 testing::Test* testing::internal::HandleSehExceptionsInMethodIfSupported<testing::internal::TestFactoryBase, testing::Test*>(testing::internal::TestFactoryBase*, testing::Test* (testing::internal::TestFactoryBase::*)(), char const*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/gtest-src/googletest/src/gtest.cc:2607 (unittest+0x7ee4f9)
    #8 testing::Test* testing::internal::HandleExceptionsInMethodIfSupported<testing::internal::TestFactoryBase, testing::Test*>(testing::internal::TestFactoryBase*, testing::Test* (testing::internal::TestFactoryBase::*)(), char const*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/gtest-src/googletest/src/gtest.cc:2643 (unittest+0x7ee4f9)
    #9 __libc_start_main <null> (libc.so.6+0x21c86)
  Mutex M19766 (0x7b0c000cbc70) created at:
    #0 pthread_mutex_lock <null> (libtsan.so.0+0x532b4)
    #1 __gthread_mutex_lock /usr/include/x86_64-linux-gnu/c++/7/bits/gthr-default.h:748 (unittest+0x1ada7e)
    #2 std::mutex::lock() /usr/include/c++/7/bits/std_mutex.h:103 (unittest+0x1ada7e)
    #3 LockManager::Lock(rocksdb::Slice const&) /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/lock_manager.cc:49 (unittest+0x1ada7e)
    #4 LockGuard::LockGuard(LockManager*, rocksdb::Slice) /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/lock_manager.h:52 (unittest+0x1b698f)
    #5 Redis::Bitmap::SetBit(rocksdb::Slice const&, unsigned int, bool, bool*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/redis_bitmap.cc:[169](https://github.com/apache/incubator-kvrocks/runs/6922999327?check_suite_focus=true#step:7:170) (unittest+0x1b698f)
    #6 RedisBitmapTest_BitPosSetBit_Test::TestBody() /home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/t_bitmap_test.cc:86 (unittest+0xedaa1)
    #7 void testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/gtest-src/googletest/src/gtest.cc:2607 (unittest+0x7ee349)
    #8 void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/gtest-src/googletest/src/gtest.cc:2643 (unittest+0x7ee349)
    #9 __libc_start_main <null> (libc.so.6+0x21c86)
  Thread T1 'rocksdb:low' (tid=14682, running) created by main thread at:
    #0 pthread_create <null> (libtsan.so.0+0x5fe84)
    #1 std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) <null> (unittest+0x83c9d4)
    #2 Engine::Storage::Open(bool) /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage.cc:238 (unittest+0x304953)
    #3 Engine::Storage::Open() /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage.cc:323 (unittest+0x306775)
    #4 Compact_Filter_Test::TestBody() /home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/compact_test.cc:36 (unittest+0xc57be)
    #5 void testing::internal::HandleSehExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/gtest-src/googletest/src/gtest.cc:2607 (unittest+0x7ee349)
    #6 void testing::internal::HandleExceptionsInMethodIfSupported<testing::Test, void>(testing::Test*, void (testing::Test::*)(), char const*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/gtest-src/googletest/src/gtest.cc:2643 (unittest+0x7ee349)
    #7 __libc_start_main <null> (libc.so.6+0x21c86)
SUMMARY: ThreadSanitizer: data race (/usr/lib/x86_64-linux-gnu/libtsan.so.0+0x67cb3) in memcmp
```

For more details check https://github.com/apache/incubator-kvrocks/runs/6922999327 or reproduce in your side.

### Anything Else?

As in https://github.com/apache/incubator-kvrocks/pull/630#discussion_r900909805, we create an issue for this bug to reference easily.


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/639/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/639,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6SS2,kvrocks,1172907190,639,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-02T14:25:08Z,2022-07-02T14:25:08Z,"I think maybe it's a false leak report. Coz the main thread will write the memtable
and convert the memtable to immutable state after it reached the max limit, then RocksDB background will read the memtable and flush them into disk. So it should be expected behavior that have the data race between main thread and background thread, but will not cause problem.

HDYT? @ShooterIT @PragmaTwice @tisonkun ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6SS2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/639,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6qk-,kvrocks,1173006654,639,NA,PragmaTwice,20042607,Twice,,NA,2022-07-03T03:57:52Z,2022-07-03T03:57:52Z,"> I think maybe it's a false leak report. Coz the main thread will write the memtable and convert the memtable to immutable state after it reached the max limit, then RocksDB background will read the memtable and flush them into disk. So it should be expected behavior that have the data race between main thread and background thread, but will not cause problem.
> 
> HDYT? @ShooterIT @PragmaTwice @tisonkun

Seems the writing in kvrocks main thread and the reading in rocksdb background thread occurs at the same time and in the same memory location? Won't this be a problem?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6qk-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/639,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6sgl,kvrocks,1173014565,639,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-03T05:24:57Z,2022-07-03T05:24:57Z,"Yes, background thread will read the immutable memory table only which the main thread won't write after it become immutable.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6sgl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/639,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6xrg,kvrocks,1173035744,639,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-07-03T08:16:31Z,2022-07-03T08:16:31Z,"RocksDB will only have one ""writeable"" memtable, on default, it will be a lock-free skiplist. And when it's full, it will be ""frozen"" and only readable. Frozen memtable will only be read by user or compaction, it will never be modified.

I think the case strange, the memory is created by `ConstructNewMemtable`, modified by `rocksdb::MemTable::Add`, and detect a race when `CompactionFilter` is called. And an ""writable"" memtable will not be compacted.

Maybe TSAN thinks Memtable is protected by `LockGuard`, but only write is guarded by it, and the following read didn't call LockGuard.

I'm not familiar with TSAN, maybe I made some mistakes. @PragmaTwice 

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6xrg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/639,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6zB0,kvrocks,1173041268,639,NA,PragmaTwice,20042607,Twice,,NA,2022-07-03T08:57:27Z,2022-07-03T08:57:27Z,"I may know the root cause of this problem, it may be a false positive due to the rocksdb library not being instrumented by TSan. 

Did not notice this when I refactor cmake files. I will fix it later. 😢 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6zB0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/639,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HjIZb,kvrocks,1200391771,639,NA,PragmaTwice,20042607,Twice,,NA,2022-07-31T10:02:54Z,2022-07-31T10:02:54Z,Solved by #759.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HjIZb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/639,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HjVfG,kvrocks,1200445382,639,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-31T15:20:33Z,2022-07-31T15:20:33Z,"Thanks for @PragmaTwice great help, we finally got the TSAN and ASAN in CI.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HjVfG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/640,https://api.github.com/repos/apache/kvrocks/issues/640,kvrocks,1276443638,640,namespace  is case-sensitive but namespace configed in file is not and namespace command does ,fishery86,63535239,,,CLOSED,2022-06-20T06:42:05Z,2022-06-20T13:08:52Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

1.3.3

### Minimal reproduce step

add namespace with command 

>> namespace add ""Big_case_namespace"" ""anypass""
ok

then 
restart the instance ,get namespace info
>> namespace get *
1) big_case_namespace
2) anypass

### What did you expect to see?

when restart we should get a namespace named ""Big_case_namespace"" not ""big_case_namespace"", it makes data could not be access with auth ""anypass"",it point to another namespace with lowercase

### What did you see instead?

>> namespace get *
1) big_case_namespace
2) anypass

### Anything Else?

config with namespace and command has the same result

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/640/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/647,kvrocks,1280104064,647,Track failed frequently integration test cases,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-06-22T12:58:15Z,2022-10-23T08:17:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As mentioned in https://github.com/apache/incubator-kvrocks/pull/646#issuecomment-1162660044, some integration test cases failed frequently
which may frustrate and confuse contributors, so I think we can find out
and disable them from old runs.


### Solution

- [x] Find out all failure frequently cases from old runs and fix them

## Flaky tests

### Replication Related

- [x] #655
- [x] #656
- [x] #676

### Cluster Related
- [x] #657

### Commands
- [x] #658","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/647/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FUwzH,kvrocks,1163070663,647,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-22T13:03:06Z,2022-06-22T13:03:06Z,"You may give a report (sheet) for flaky tests, sorting out by categorizes. For example, tcl tests or unit tests.

It should be helpful for anyone who tries to contribute to stabilize tests.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FUwzH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FU0m1,kvrocks,1163086261,647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-22T13:17:44Z,2022-06-22T13:17:44Z,"


> You may give a report (sheet) for flaky tests, sorting out by categorizes. For example, tcl tests or unit tests.
> 
> It should be helpful for anyone who tries to contribute to stabilize tests.

Good point, all cases are from tcl tests. I will find them all recently and group them together.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FU0m1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdCnH,kvrocks,1165240775,647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-24T06:21:15Z,2022-06-24T06:21:15Z,"@tisonkun I found most failures were caused by four tcl test cases，should we create issue for each one to track them?
<img width=""736"" alt=""image"" src=""https://user-images.githubusercontent.com/4987594/175474994-58b7cb7a-d89c-48f3-bae8-72e024e14ba8.png"">


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdCnH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdMVP,kvrocks,1165280591,647,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-24T07:20:03Z,2022-06-24T07:20:03Z,"@git-hulk yes. We can create subtasks for them. Basically we create issue if someone volunteer to investigate (otherwise we create dangling issues), and it happens I'll give a look at these cases :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdMVP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdOxa,kvrocks,1165290586,647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-24T07:32:59Z,2022-06-24T07:32:59Z,"> @git-hulk yes. We can create subtasks for them. Basically we create issue if someone volunteer to investigate (otherwise we create dangling issues), and it happens I'll give a look at these cases :)

OK, will create issues later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdOxa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdQJx,kvrocks,1165296241,647,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-24T07:40:48Z,2022-06-24T07:40:48Z,@git-hulk I've created them.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdQJx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdQOI,kvrocks,1165296520,647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-24T07:41:09Z,2022-06-24T07:41:09Z,Many thanks!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdQOI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fh9gm,kvrocks,1166530598,647,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-26T13:19:58Z,2022-06-26T13:19:58Z,"@git-hulk all previous subtasks resolved. However, there is a new failure #676 detected :/","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fh9gm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiCcH,kvrocks,1166550791,647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-26T14:32:30Z,2022-06-26T14:32:30Z,"> @git-hulk all previous subtasks resolved. However, there is a new failure #676 detected :/

Got it, thanks @tisonkun. I will follow up and try to figure out the root cause.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiCcH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Frf_0,kvrocks,1169031156,647,NA,PragmaTwice,20042607,Twice,,NA,2022-06-28T17:40:53Z,2022-06-28T17:40:53Z,"```
*** [err]: Set instance A as slave of B in tests/integration/replication.tcl
Expected '1' to be equal to '0' (context: type source line 41 file /Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/tcl/tests/integration/replication.tcl cmd {assert_equal {1} [s -1 loading]} proc ::test)
*** [err]: requests on cluster are ok in tests/integration/cluster.tcl
Expected '16383' to be equal to '' (context: type source line 257 file /Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/tcl/tests/integration/cluster.tcl cmd {assert_equal ""16383"" [$r3 get $slot_16383_key]} proc ::test)
```
in https://github.com/apache/incubator-kvrocks/runs/7096118532?check_suite_focus=true","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Frf_0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxZ40,kvrocks,1288019508,647,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-23T06:19:28Z,2022-10-23T06:19:28Z,Closed as all subtasks done.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxZ40/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mxg7Y,kvrocks,1288048344,647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-23T08:17:20Z,2022-10-23T08:17:20Z,"👍 Really great work, it's really to debug the flaky tests now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mxg7Y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/655,https://api.github.com/repos/apache/kvrocks/issues/655,kvrocks,1283383162,655,Executing test client: LOADING kvrocks is restoring the db from backup,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-06-24T07:40:14Z,2022-06-28T07:33:58Z,Report: https://github.com/apache/incubator-kvrocks/runs/7026847364?check_suite_focus=true#step:10:713,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/655/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/655,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fd1PJ,kvrocks,1165448137,655,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-24T10:43:20Z,2022-06-24T10:43:20Z,"I will follow up this issue, it should be caused by forbidding to get role when restoring
the data.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fd1PJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/655,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fo2YT,kvrocks,1168336403,655,NA,PragmaTwice,20042607,Twice,,NA,2022-06-28T07:24:18Z,2022-06-28T07:24:18Z,"There is another fail with same exception: https://github.com/apache/incubator-kvrocks/runs/7085774273?check_suite_focus=true
But I feel that the root cause of this error and the above error may be different, because the execution path seems to be different.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fo2YT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/655,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fo41F,kvrocks,1168346437,655,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-28T07:33:58Z,2022-06-28T07:33:58Z,"Looks caused by this line: [replication.tcl#L196](https://github.com/apache/incubator-kvrocks/blob/unstable/tests/tcl/tests/integration/replication.tcl#L196), need to wait for restoring. Will fix it later.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fo41F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/656,https://api.github.com/repos/apache/kvrocks/issues/656,kvrocks,1283383324,656,Executing test client: couldn't open socket: connection refused,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-06-24T07:40:26Z,2022-06-25T04:59:32Z,Report: https://github.com/apache/incubator-kvrocks/runs/6981007645?check_suite_focus=true#step:10:703,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/656/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/657,https://api.github.com/repos/apache/kvrocks/issues/657,kvrocks,1283383373,657,Migrate incremental data via parsing and filtering data,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-06-24T07:40:29Z,2022-06-25T07:42:51Z,Report https://github.com/apache/incubator-kvrocks/runs/7034653085?check_suite_focus=true#step:10:687,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/657/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/657,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fd_PO,kvrocks,1165489102,657,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-24T11:38:01Z,2022-06-24T11:38:01Z,"This test case spent almost 30s on my local machine and it should be even slower in CI environment. So we can increase the wait time from 50s => 100s if has no idea. Do guys
have any thoughts about this case? @ChrisZMF @ShooterIT @caipengbo","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fd_PO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/657,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgr5f,kvrocks,1166196319,657,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-25T05:20:49Z,2022-06-25T05:20:49Z,"It's a valid workaround. However, it's better to make the waiting determinately - is it possible?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgr5f/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/657,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgsSE,kvrocks,1166197892,657,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-25T05:35:38Z,2022-06-25T05:35:38Z,"> It's a valid workaround. However, it's better to make the waiting determinately - is it possible?

Yes, can check the migrate finished status which we're doing at line: [slotmigrate.tcl#L513](https://github.com/apache/incubator-kvrocks/blob/e2640f8e4297311dae1dabec76b203ded31b4aaf/tests/tcl/tests/integration/slotmigrate.tcl#L513), we can remove the time limit.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgsSE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/657,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgtik,kvrocks,1166203044,657,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-25T06:21:45Z,2022-06-25T06:21:45Z,"@tisonkun removed the time limit, can help to take a look again.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgtik/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/657,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgtqn,kvrocks,1166203559,657,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-06-25T06:25:49Z,2022-06-25T06:25:49Z,Is there any way we can reduce the waiting time?  I think this test case is taking too long.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgtqn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/657,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FguLR,kvrocks,1166205649,657,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-25T06:40:36Z,2022-06-25T06:40:36Z,Maybe we can test whether increase the pipeline size can help or not,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FguLR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/658,https://api.github.com/repos/apache/kvrocks/issues/658,kvrocks,1283383490,658,get rocksdb ops by COMMAND INFO in tests/unit/command.tcl [expr abs($cmd_qps - $put_qps)] < 10,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-06-24T07:40:38Z,2022-06-26T12:50:54Z,Report: https://github.com/apache/incubator-kvrocks/runs/6453256361?check_suite_focus=true#step:7:2018,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/658/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdRot,kvrocks,1165302317,658,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-06-24T07:48:48Z,2022-06-24T07:48:48Z,Let me track this problem.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FdRot/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgsui,kvrocks,1166199714,658,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-25T05:52:51Z,2022-06-25T05:52:51Z,"@caipengbo I took a look at this test case and those metrics would be affected by other test cases, maybe we should change the test case to avoid that.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgsui/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgs5J,kvrocks,1166200393,658,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-06-25T05:59:48Z,2022-06-25T05:59:48Z,"> I took a look at this test case and those metrics would be affected by other test cases, maybe we should change the test case to avoid that.

Yeah, it should be the effect of previous OPS, how about wait a little longer to let QPS empty? @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgs5J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgtCK,kvrocks,1166200970,658,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-25T06:04:44Z,2022-06-25T06:04:44Z,"Another workaround can be also fetching those metrics before running `lpush` and `lrange` command, then fetch and compare the diff value. So that we can make sure the metrics would affected by current test case only. How do you think? @caipengbo  ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgtCK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgvNe,kvrocks,1166209886,658,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-06-25T07:07:09Z,2022-06-25T07:07:09Z,"I looked again, and it didn't seem to be the influence of the previous OPS;  I took a look at this failed case：https://github.com/apache/incubator-kvrocks/runs/6453256361?check_suite_focus=true#step:7:2018, it show only 432 OPS. But theoretically, OPS should be 1000, the gap is too large. 

My guess is that tcl `after` statement is too short to be accurate in CI environments, HDYT @git-hulk 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgvNe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgxl0,kvrocks,1166219636,658,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-25T07:55:25Z,2022-06-25T07:55:25Z,"It's expected since we used time based metrics instead of counter: https://github.com/apache/incubator-kvrocks/blob/0b2de8ab6f661d90a279a0c11096755d7733b11c/src/stats.cc#L108

So ops can be affected by the elapsed time, I think it's too long instead of too short? ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgxl0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/662,https://api.github.com/repos/apache/kvrocks/issues/662,kvrocks,1283868991,662,Consider only output to LOG instead of hardcoded stdout/stderr,PragmaTwice,20042607,Twice,,OPEN,2022-06-24T15:12:52Z,2022-10-23T11:17:02Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Refer to https://github.com/apache/incubator-kvrocks/pull/660#issuecomment-1165637383.

It is good to keep kvrocks with only one output location.
But currently, kvrocks also outputs some information to stdout when logdir is set to a regular file, which can be confusing for users.


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/662/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/662,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxjJp,kvrocks,1288057449,662,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-23T09:02:43Z,2022-10-23T09:02:43Z,"cc @git-hulk 

<img width=""1728"" alt=""image"" src=""https://user-images.githubusercontent.com/18818196/197383662-02ed392d-69be-447a-82e6-f2b0c0cd6870.png"">

Currently, I found only these three lines in the source code that we print to the stdout in starting up logic. I don't know whether we should have a rule that only output to LOG everywhere and the current status looks good to me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxjJp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/662,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxmYK,kvrocks,1288070666,662,NA,PragmaTwice,20042607,Twice,,NA,2022-10-23T09:56:24Z,2022-10-23T09:56:24Z,"Actually something is unexpectedly written to stderr:

![image](https://user-images.githubusercontent.com/20042607/197385705-cc5dbcf9-fed2-4535-8cbd-9633c2ceeb01.png)

So it need some investigation.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxmYK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/662,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mxqg5,kvrocks,1288087609,662,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-23T11:06:56Z,2022-10-23T11:06:56Z,"> cc @git-hulk
> 
> <img alt=""image"" width=""1728"" src=""https://user-images.githubusercontent.com/18818196/197383662-02ed392d-69be-447a-82e6-f2b0c0cd6870.png"">
> 
> Currently, I found only these three lines in the source code that we print to the stdout in starting up logic. I don't know whether we should have a rule that only output to LOG everywhere and the current status looks good to me.

To be honest, we don't have an explicit rule on when should send logs to the stdout instead of LOG file, but I think all logs should go into LOG except:
- command outputs like `./kvrock --help`
- logs before the logging instance was setup","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mxqg5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/662,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mxqi5,kvrocks,1288087737,662,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-23T11:07:50Z,2022-10-23T11:07:50Z,"> Actually something is unexpectedly written to stderr:
> 
> ![image](https://user-images.githubusercontent.com/20042607/197385705-cc5dbcf9-fed2-4535-8cbd-9633c2ceeb01.png)
> 
> So it need some investigation.

Yes, I searched the keyword `cout` and found some places are still using `std::cout`. 
And it's weird in this case, coz I find `Logging` is always initialized before opening DB.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mxqi5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/663,https://api.github.com/repos/apache/kvrocks/issues/663,kvrocks,1283887330,663,Use `unique_ptr` to eliminate some trivial manual deallocation,PragmaTwice,20042607,Twice,,CLOSED,2022-06-24T15:28:43Z,2022-10-23T07:46:00Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

There are many manual memory (or other system resources like file) allocation and deallocation such as `new`/`delete` in kvrocks.

Memory management is a complex topic (after RC/tracing GC is involved quickly) and there are some smart pointers like `unique_ptr`, `shared_ptr` in C++ to abstract a specific way to manage resources.

For some trivial scenario which do not require to share objects, we can do it via `unique_ptr`, which is a zero-overhead abstraction.

We can switch some manual deallocations to `unique_ptr` to make the code more maintainable and less prone to memory leaks.

NOTE: We try to use `unique_ptr` instead of creating our own RAII class types because `unique_ptr` has good semantics: it prohibits copy construction and only allows move construction, which keeps us from accidentally sharing objects and causing Use After Free or Double Free. (And we should carefully to retrieve raw pointers via `get()` by checking that the callee do not require ownership)

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/663/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/663,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fe0De,kvrocks,1165705438,663,NA,jackwener,30525741,jakevin,jakevingoo@gmail.com,NA,2022-06-24T15:51:31Z,2022-06-24T15:51:31Z,I'd like to do it.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fe0De/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/663,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fe1jP,kvrocks,1165711567,663,NA,PragmaTwice,20042607,Twice,,NA,2022-06-24T15:58:37Z,2022-06-24T15:58:37Z,"> I'd like to do it.

Thanks, feel free to submit a PR.

Since this issue may be divided into many PRs, everyone can directly submit a PR for a specific part (no need to reply this issue), so I think it would be better not to assign this issue to a specific person.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fe1jP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/663,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM6P,kvrocks,1242877583,663,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:31:24Z,2022-09-11T03:31:24Z,@PragmaTwice is there any remaining works and do you want to continue driving this effort?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFM6P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/663,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFbN1,kvrocks,1242936181,663,NA,PragmaTwice,20042607,Twice,,NA,2022-09-11T10:39:49Z,2022-09-11T10:39:49Z,"I think most of trivial manual deallocation is removed, but there still remains some raw memory allocation and fd allocation.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFbN1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/663,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxUWq,kvrocks,1287996842,663,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-23T03:51:26Z,2022-10-23T03:51:26Z,"@PragmaTwice is there a way we can find and list them out here? Otherwise, it seems this proposal stalls.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxUWq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/663,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxfYY,kvrocks,1288042008,663,NA,PragmaTwice,20042607,Twice,,NA,2022-10-23T07:45:34Z,2022-10-23T07:45:34Z,Closed. Will create new issue if more manual deallocation is found.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxfYY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/664,https://api.github.com/repos/apache/kvrocks/issues/664,kvrocks,1284411217,664,Cancel previous CI workflow if new commit pushed,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-06-25T02:22:53Z,2022-06-25T06:09:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

So that we don't waste time to verify a previous commit - what we're interested in is the latest view.

### Solution

Add the following snippet to `kvrocks.yaml`:

```yaml
concurrency:
  group: ${{ github.ref }}-${{ github.workflow }}
  cancel-in-progress: true
```

See also https://github.com/apache/pulsar/blob/b23689930e3af65cfc913e2890164a071acda440/.github/workflows/pulsar-ci.yaml#L29-L31.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/664/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/664,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgmVe,kvrocks,1166173534,664,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-25T02:24:54Z,2022-06-25T02:24:54Z,"For more information about GitHub Actions settings, see also https://docs.github.com/en/actions/using-jobs/using-concurrency#example-only-cancel-in-progress-jobs-or-runs-for-the-current-workflow","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgmVe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/664,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgmZ9,kvrocks,1166173821,664,NA,Xuanwo,5351546,Xuanwo,github@xuanwo.io,NA,2022-06-25T02:27:15Z,2022-06-25T02:27:15Z,"Let me take this issue.

Ideally, this will be my first contribution to Apache project.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgmZ9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/664,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgmdQ,kvrocks,1166174032,664,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-25T02:29:00Z,2022-06-25T02:29:00Z,"@Xuanwo Thanks!

I'll assign to you. Go ahead!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FgmdQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/664,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgmyh,kvrocks,1166175393,664,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-25T02:39:33Z,2022-06-25T02:39:33Z,I love this feature!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fgmyh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/665,https://api.github.com/repos/apache/kvrocks/issues/665,kvrocks,1284419887,665,Add a label to trigger daily CI in PR,PragmaTwice,20042607,Twice,,CLOSED,2022-06-25T02:59:27Z,2022-06-30T01:38:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We could add a label like `need-daily-CI`, and when the label is applied to a PR, all jobs of daily CI will join in the checking sequence of this PR.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/665/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/665,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fg2dQ,kvrocks,1166239568,665,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-25T09:25:58Z,2022-06-25T09:25:58Z,cc @Xuanwo IIRC you have the knowledge to implement this requirement. Would you like to take over this issue or help on sharing knowledge need to implement this feature?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fg2dQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/665,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fuo3E,kvrocks,1169853892,665,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-29T11:14:38Z,2022-06-29T11:14:38Z,"Actually since we already trigger daily CI if workflow file changed, I'm thinking of whether we can implement this as simple as adding a comment line in the workflow file and change that line to trigger it in PR.

```yaml
# This line is to trigger CI in pull request by changing the digest to any other random value; digest: 1096
```

cc @GoGim1 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fuo3E/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/665,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Furht,kvrocks,1169864813,665,NA,PragmaTwice,20042607,Twice,,NA,2022-06-29T11:26:48Z,2022-06-29T11:26:48Z,"> Actually since we already trigger daily CI if workflow file changed, I'm thinking of whether we can implement this as simple as adding a comment line in the workflow file and change that line to trigger it in PR.
> 
> ```yaml
> # This line is to trigger CI in pull request by changing the digest to any other random value; digest: 1096
> ```
> 
> cc @GoGim1

I think it is more like a workaround rather than a solution 🤣 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Furht/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/665,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FusIW,kvrocks,1169867286,665,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-29T11:29:32Z,2022-06-29T11:29:32Z,Fair enough. It's possible to implement this feature with label changed.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FusIW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/676,https://api.github.com/repos/apache/kvrocks/issues/676,kvrocks,1284911737,676,Executing test client: I/O error reading reply.,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-06-26T13:19:09Z,2022-09-20T03:13:06Z,Report: https://github.com/apache/incubator-kvrocks/runs/7060886256?check_suite_focus=true,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/676/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/676,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fh_Hs,kvrocks,1166537196,676,NA,PragmaTwice,20042607,Twice,,NA,2022-06-26T13:46:09Z,2022-06-26T13:46:09Z,and https://github.com/apache/incubator-kvrocks/runs/7052214974?check_suite_focus=true,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fh_Hs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/676,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiCrR,kvrocks,1166551761,676,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-26T14:36:38Z,2022-06-26T14:36:38Z,"cc @ShooterIT since you ported these tests into Kvrocks, would you like to investigate the root cause of this error? It seems far more general to debug without more backgorund.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiCrR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/676,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fo6DU,kvrocks,1168351444,676,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-06-28T07:38:38Z,2022-06-28T07:38:38Z,"copy that, i will have a look.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fo6DU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/676,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FqQGU,kvrocks,1168703892,676,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-06-28T13:11:21Z,2022-06-28T13:11:21Z,"> Report: https://github.com/apache/incubator-kvrocks/runs/7060886256?check_suite_focus=true

This may be resolved by #688 

> and https://github.com/apache/incubator-kvrocks/runs/7052214974?check_suite_focus=true

I don't find its clue🙃
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FqQGU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/676,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FqhjR,kvrocks,1168775377,676,NA,PragmaTwice,20042607,Twice,,NA,2022-06-28T14:08:12Z,2022-06-28T14:08:12Z,another example: https://github.com/apache/incubator-kvrocks/runs/7093289052?check_suite_focus=true,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FqhjR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/676,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KnLIw,kvrocks,1251783216,676,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-20T03:13:06Z,2022-09-20T03:13:06Z,"Closed as invalid anymore. Also, we are migrating tests to Go cases and will fix further issues there https://github.com/apache/incubator-kvrocks/issues/811 potentially.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KnLIw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/677,https://api.github.com/repos/apache/kvrocks/issues/677,kvrocks,1284947017,677,Exclude unstable branch while canceling previous workflows,PragmaTwice,20042607,Twice,,CLOSED,2022-06-26T14:59:04Z,2022-10-23T06:18:15Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

![image](https://user-images.githubusercontent.com/20042607/175820242-e318efaa-3b18-4cfa-a235-ec3caba21e10.png)

As shown in the figure above, the retrying workflow was canceled due to a new commit.
We may retry the kvrocks ci action of some commits in the unstable branch. 
At this time, if the unstable branch can only run one workflow at the same time, it will cause some trouble.


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/677/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/677,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiHjU,kvrocks,1166571732,677,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-26T15:56:42Z,2022-06-26T15:56:42Z,"I don't think this is a big deal. Always we focus on the latest version and it's fine if only the nightly version passes CI.

If you want to debugging an unstable test, you may open a branch on fork or send a draft pull request.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiHjU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/677,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiIVs,kvrocks,1166574956,677,NA,PragmaTwice,20042607,Twice,,NA,2022-06-26T16:09:04Z,2022-06-26T16:09:04Z,"> I don't think this is a big deal. Always we focus on the latest version and it's fine if only the nightly version passes CI.
> 
> If you want to debugging an unstable test, you may open a branch on fork or send a draft pull request.

In fact, there is another situation. 

For example, if two commits are merged into the unstable branch within a short time interval, the workflow of the previous commit will be canceled, and the actions status of the previous commit will display a ❌.

This can lead users to think that our unstable branch will often fail, which may not be what we expected, and this situation may be more serious than the one above.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiIVs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/677,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiJ9u,kvrocks,1166581614,677,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-26T16:34:28Z,2022-06-26T16:34:28Z,"@PragmaTwice since we require every PR should be up-to-date before merge, actually we can skip running CI in `unstable` branch.

See also [Apache Pulsar's CI settings](https://github.com/apache/pulsar/blob/6c715e08c67c40221c8c08cbe0b31d3a6aa1bf32/.github/workflows/pulsar-ci.yaml):

```yaml
on:
  pull_request:
    branches:
      - master
  push:
    branches:
      - branch-*
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiJ9u/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/677,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiKq9,kvrocks,1166584509,677,NA,PragmaTwice,20042607,Twice,,NA,2022-06-26T16:45:43Z,2022-06-26T16:45:43Z,"> @PragmaTwice since we require every PR should be up-to-date before merge, actually we can skip running CI in `unstable` branch.
> 
> See also [Apache Pulsar's CI settings](https://github.com/apache/pulsar/blob/6c715e08c67c40221c8c08cbe0b31d3a6aa1bf32/.github/workflows/pulsar-ci.yaml):
> 
> ```yaml
> on:
>   pull_request:
>     branches:
>       - master
>   push:
>     branches:
>       - branch-*
> ```

Good idea, actually I think maybe we can use another workflow on unstable branch to build and test kvrocks with more environment and build options than the current workflow trigger by PRs.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FiKq9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/677,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fiht2,kvrocks,1166678902,677,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-26T23:33:41Z,2022-06-26T23:33:41Z,"@PragmaTwice it sounds like something similar to ""MergeCI"" in TiDB project. However, I'd prefer running tests as early as possible instead of running less tests and fix bugs later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fiht2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/691,https://api.github.com/repos/apache/kvrocks/issues/691,kvrocks,1288275646,691,Review build docker image CI task which takes more than 2 hours to finish,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-06-29T07:15:38Z,2022-06-30T01:38:13Z,"@git-hulk @ShooterIT @PragmaTwice Perhaps we can move build and test tasks from daily CI to per PR CI. They take less than half hour to finish. While building docker image takes more than 2 hours to finish and I'm curious why.

_Originally posted by @tisonkun in https://github.com/apache/incubator-kvrocks/issues/689#issuecomment-1169606788_","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/691/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/691,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FtwEH,kvrocks,1169621255,691,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-29T07:16:54Z,2022-06-29T07:16:54Z,"> @git-hulk @ShooterIT @PragmaTwice Perhaps we can move build and test tasks from daily CI to per PR CI. They take less than half hour to finish. While building docker image takes more than 2 hours to finish and I'm curious why.

Maybe it is due to that we use QEMU to simulate an arm64 environment, and I think that is slow.

_Originally posted by @PragmaTwice in https://github.com/apache/incubator-kvrocks/issues/689#issuecomment-1169609906_

@PragmaTwice thanks for your input. Another approach is still run more Build and Test tasks every day but separate docker job into another workflow.

_Originally posted by @tisonkun in https://github.com/apache/incubator-kvrocks/issues/689#issuecomment-1169611332_

Another thing is that since we build the nightly version of the docker image we can automatically publish it to some registries like the docker hub, e.g. some tags like `nightly`, `nightly-20220629`.

And I also think building docker image in CI triggered by PRs is unnecessary (maybe an arm evironment is useful, but a docker environment is not necessary for build and test).

_Originally posted by @PragmaTwice in https://github.com/apache/incubator-kvrocks/issues/689#issuecomment-1169614450_

> Another thing is that since we build the nightly version of the docker image we can automatically publish it to some registries like the docker hub, e.g. some tags like `nightly`, `nightly-20220629`.
> 
> And I also think building docker image in CI triggered by PRs is unnecessary (maybe an arm evironment is useful, but a docker environment is not necessary for build and test).

Good point that we can push the `nightly` docker image, latest image need to wait for the new release is too slow for most users.

_Originally posted by @git-hulk in https://github.com/apache/incubator-kvrocks/issues/689#issuecomment-1169619824_","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FtwEH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/691,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ftw8Q,kvrocks,1169624848,691,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-29T07:21:02Z,2022-06-29T07:21:02Z,"The QEMU was introduce in PR: https://github.com/apache/incubator-kvrocks/pull/550, maybe we can move other jobs to per CI from daily CI except the QEMU docker image.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ftw8Q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/691,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fu_4J,kvrocks,1169948169,691,NA,PragmaTwice,20042607,Twice,,NA,2022-06-29T12:58:11Z,2022-06-29T12:58:11Z,"> Another thing is that since we build the nightly version of the docker image we can automatically publish it to some registries like the docker hub, e.g. some tags like `nightly`, `nightly-20220629`.

I will open a seperate issue for this : )","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fu_4J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/691,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvClH,kvrocks,1169959239,691,NA,PragmaTwice,20042607,Twice,,NA,2022-06-29T13:08:26Z,2022-06-29T13:08:26Z,"For the arm related issue, I wonder whether we can find a (native) arm64 enviroment on other CI platforms like Circle CI, which maybe more fast than the QEMU way. Any comments? @git-hulk @tisonkun ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvClH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/691,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvDmY,kvrocks,1169963416,691,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-29T13:12:12Z,2022-06-29T13:12:12Z,"This sounds good to me, it's really frustrated to debug the daily CI now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvDmY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/691,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvEJJ,kvrocks,1169965641,691,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-29T13:14:09Z,2022-06-29T13:14:09Z,@PragmaTwice That's possible. You may start a discussion on dev@ and we'll ask ASF INFRA team to enable related integration.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvEJJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/691,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvO1C,kvrocks,1170009410,691,NA,PragmaTwice,20042607,Twice,,NA,2022-06-29T13:52:24Z,2022-06-29T13:52:24Z,"> @PragmaTwice That's possible. You may start a discussion on dev@ and we'll ask ASF INFRA team to enable related integration.

Thanks, I will start a discussion later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvO1C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/691,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvWVx,kvrocks,1170040177,691,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-29T14:16:59Z,2022-06-29T14:16:59Z,"@PragmaTwice @git-hulk I write a patch to separate daily CI and run daily CI iff `needs-daily-ci` labeled. You may give it a look https://github.com/apache/incubator-kvrocks/pull/695.

For ARM64 issue, I'm actually wonder whether we should build an image on ARM64.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvWVx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/696,https://api.github.com/repos/apache/kvrocks/issues/696,kvrocks,1288690285,696,Automatically publish the nightly version of kvrocks to docker hub in daily CI,PragmaTwice,20042607,Twice,,CLOSED,2022-06-29T13:00:51Z,2022-07-31T10:04:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Refer to #689 and #691, since we build the nightly version of the docker image we can automatically publish it to some registries like the docker hub, e.g. some tags like `nightly`, `nightly-20220629`.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/696/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/696,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvBfz,kvrocks,1169954803,696,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-06-29T13:04:28Z,2022-06-29T13:04:28Z,"This may not be as trivial as it looks like, since we must decide whether this is an official docker image endorsed by the Kvrocks PMC. If so, then it's an Apache release that we should vote before release.

However, since it's nightly image only, I'd share you some other Apache projects practice that we can publish images automatically.

* https://issues.apache.org/jira/browse/FLINK-26214
* https://github.com/apache/flink-kubernetes-operator/pull/118
* https://cwiki.apache.org/confluence/display/INFRA/Github+Actions+to+DockerHub","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvBfz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/696,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvCMa,kvrocks,1169957658,696,NA,PragmaTwice,20042607,Twice,,NA,2022-06-29T13:07:04Z,2022-06-29T13:07:04Z,"> This may not be as trivial as it looks like, since we must decide whether this is an official docker image endorsed by the Kvrocks PMC. If so, then it's an Apache release that we should vote before release.
> 
> However, since it's nightly image only, I'd share you some other Apache projects practice that we can publish images automatically.
> 
> * https://issues.apache.org/jira/browse/FLINK-26214
> * [[FLINK-26214] Publish Docker images to GitHub Registry flink-kubernetes-operator#118](https://github.com/apache/flink-kubernetes-operator/pull/118)
> * https://cwiki.apache.org/confluence/display/INFRA/Github+Actions+to+DockerHub

So thanks, seems there are lots of similiar works.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FvCMa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/696,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HjIcw,kvrocks,1200391984,696,NA,PragmaTwice,20042607,Twice,,NA,2022-07-31T10:04:18Z,2022-07-31T10:04:18Z,"Solved by #741, #746, #747 and #748. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HjIcw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/699,https://api.github.com/repos/apache/kvrocks/issues/699,kvrocks,1289704011,699,BUG: Use after free in CommandBPop reported by ASan,PragmaTwice,20042607,Twice,,CLOSED,2022-06-30T07:16:45Z,2022-07-20T08:29:40Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

```
./build.sh build -DENABLE_ASAN=ON
cd tests/tcl
./runtest --dont-clean
grep Sanitizer tests/tmp -r
```
This bug is not 100% reproducible and may require multiple test executions before it appears.

### What did you expect to see?

No ASan report.

### What did you see instead?

```
=================================================================
==1872112==ERROR: AddressSanitizer: heap-use-after-free on address 0x608000014070 at pc 0x55d1a126595a bp 0x7fa436fee820 sp 0x7fa436fee810
READ of size 8 at 0x608000014070 thread T98
    #0 0x55d1a1265959 in Redis::CommandBPop::TryPopFromList() /home/twice/incubator-kvrocks/src/redis_cmd.cc:1568
    #1 0x55d1a1266851 in Redis::CommandBPop::WriteCB(bufferevent*, void*) /home/twice/incubator-kvrocks/src/redis_cmd.cc:1590
    #2 0x55d1a190f519 in bufferevent_run_deferred_callbacks_unlocked /home/twice/incubator-kvrocks/sanbuild/_deps/libevent-src/bufferevent.c:215
    #3 0x55d1a19169ac in event_process_active_single_queue /home/twice/incubator-kvrocks/sanbuild/_deps/libevent-src/event.c:1726
    #4 0x55d1a1917406 in event_process_active /home/twice/incubator-kvrocks/sanbuild/_deps/libevent-src/event.c:1789
    #5 0x55d1a1917406 in event_base_loop /home/twice/incubator-kvrocks/sanbuild/_deps/libevent-src/event.c:2012
    #6 0x55d1a14ffe9f in Worker::Run(std::thread::id) /home/twice/incubator-kvrocks/src/worker.cc:234
    #7 0x55d1a150017d in operator() /home/twice/incubator-kvrocks/src/worker.cc:435
    #8 0x55d1a150017d in __invoke_impl<void, WorkerThread::Start()::<lambda()> > /usr/include/c++/11.2.0/bits/invoke.h:61
    #9 0x55d1a150017d in __invoke<WorkerThread::Start()::<lambda()> > /usr/include/c++/11.2.0/bits/invoke.h:96
    #10 0x55d1a150017d in _M_invoke<0> /usr/include/c++/11.2.0/bits/std_thread.h:253
    #11 0x55d1a150017d in operator() /usr/include/c++/11.2.0/bits/std_thread.h:260
    #12 0x55d1a150017d in _M_run /usr/include/c++/11.2.0/bits/std_thread.h:211
    #13 0x55d1a19fa4a3 in execute_native_thread_routine (/home/twice/incubator-kvrocks/tests/tcl/redis-server+0xacd4a3)
    #14 0x7fa440e6b5c1 in start_thread (/usr/lib/libc.so.6+0x8d5c1)
    #15 0x7fa440ef0583 in __clone (/usr/lib/libc.so.6+0x112583)

0x608000014070 is located 80 bytes inside of 96-byte region [0x608000014020,0x608000014080)
freed by thread T98 here:
    #0 0x7fa4411a48d9 in operator delete(void*, unsigned long) /usr/src/debug/gcc/libsanitizer/asan/asan_new_delete.cpp:172
    #1 0x55d1a1424770 in std::default_delete<Redis::Commander>::operator()(Redis::Commander*) const /usr/include/c++/11.2.0/bits/unique_ptr.h:85
    #2 0x55d1a1424770 in std::__uniq_ptr_impl<Redis::Commander, std::default_delete<Redis::Commander> >::reset(Redis::Commander*) /usr/include/c++/11.2.0/bits/unique_ptr.h:182
    #3 0x55d1a1424770 in std::__uniq_ptr_impl<Redis::Commander, std::default_delete<Redis::Commander> >::operator=(std::__uniq_ptr_impl<Redis::Commander, std::default_delete<Redis::Commander> >&&) /usr/include/c++/11.2.0/bits/unique_ptr.h:167
    #4 0x55d1a1424770 in std::__uniq_ptr_data<Redis::Commander, std::default_delete<Redis::Commander>, true, true>::operator=(std::__uniq_ptr_data<Redis::Commander, std::default_delete<Redis::Commander>, true, true>&&) /usr/include/c++/11.2.0/bits/unique_ptr.h:212
    #5 0x55d1a1424770 in std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> >::operator=(std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> >&&) /usr/include/c++/11.2.0/bits/unique_ptr.h:371
    #6 0x55d1a1424770 in Server::LookupAndCreateCommand(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> >*) /home/twice/incubator-kvrocks/src/server.cc:1340
    #7 0x55d1a12c65ad in Redis::Connection::ExecuteCommands(std::vector<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > > const&) /home/twice/incubator-kvrocks/src/redis_connection.cc:330
    #8 0x55d1a12cef3f in Redis::Connection::OnRead(bufferevent*, void*) /home/twice/incubator-kvrocks/src/redis_connection.cc:89
    #9 0x55d1a190f4ad in bufferevent_run_deferred_callbacks_unlocked /home/twice/incubator-kvrocks/sanbuild/_deps/libevent-src/bufferevent.c:208

previously allocated by thread T98 here:
    #0 0x7fa4411a3811 in operator new(unsigned long) /usr/src/debug/gcc/libsanitizer/asan/asan_new_delete.cpp:99
    #1 0x55d1a11c3c56 in Redis::redisCommandTable::{lambda()#81}::operator()() const /home/twice/incubator-kvrocks/src/redis_cmd.cc:4807
    #2 0x55d1a11c3c56 in std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> > std::__invoke_impl<std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> >, Redis::redisCommandTable::{lambda()#81}&>(std::__invoke_other, Redis::redisCommandTable::{lambda()#81}&) /usr/include/c++/11.2.0/bits/invoke.h:61
    #3 0x55d1a11c3c56 in std::enable_if<is_invocable_r_v<std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> >, Redis::redisCommandTable::{lambda()#81}&>, std::enable_if>::type std::__invoke_r<std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> >, Redis::redisCommandTable::{lambda()#81}&>(std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> >&&, (Redis::redisCommandTable::{lambda()#81}&)...) /usr/include/c++/11.2.0/bits/invoke.h:116
    #4 0x55d1a11c3c56 in std::_Function_handler<std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> > (), Redis::redisCommandTable::{lambda()#81}>::_M_invoke(std::_Any_data const&) /usr/include/c++/11.2.0/bits/std_function.h:292
    #5 0x55d1a142439e in std::function<std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> > ()>::operator()() const /usr/include/c++/11.2.0/bits/std_function.h:560
    #6 0x55d1a142439e in Server::LookupAndCreateCommand(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::unique_ptr<Redis::Commander, std::default_delete<Redis::Commander> >*) /home/twice/incubator-kvrocks/src/server.cc:1340
    #7 0x55d1a12c65ad in Redis::Connection::ExecuteCommands(std::vector<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > > const&) /home/twice/incubator-kvrocks/src/redis_connection.cc:330
    #8 0x55d1a12cef3f in Redis::Connection::OnRead(bufferevent*, void*) /home/twice/incubator-kvrocks/src/redis_connection.cc:89
    #9 0x55d1a190f4ad in bufferevent_run_deferred_callbacks_unlocked /home/twice/incubator-kvrocks/sanbuild/_deps/libevent-src/bufferevent.c:208

Thread T98 created by T0 here:
    #0 0x7fa441143eb7 in __interceptor_pthread_create /usr/src/debug/gcc/libsanitizer/asan/asan_interceptors.cpp:216
    #1 0x55d1a19fa78a in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/home/twice/incubator-kvrocks/tests/tcl/redis-server+0xacd78a)
    #2 0x55d1a1443c6b in Server::Start() /home/twice/incubator-kvrocks/src/server.cc:125
    #3 0x55d1a1086cf5 in main /home/twice/incubator-kvrocks/src/main.cc:354
    #4 0x7fa440e0b30f in __libc_start_call_main (/usr/lib/libc.so.6+0x2d30f)

SUMMARY: AddressSanitizer: heap-use-after-free /home/twice/incubator-kvrocks/src/redis_cmd.cc:1568 in Redis::CommandBPop::TryPopFromList()
Shadow bytes around the buggy address:
  0x0c107fffa7b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fffa7c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fffa7d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fffa7e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c107fffa7f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x0c107fffa800: fa fa fa fa fd fd fd fd fd fd fd fd fd fd[fd]fd
  0x0c107fffa810: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fd
  0x0c107fffa820: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 fa
  0x0c107fffa830: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fffa840: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 00
  0x0c107fffa850: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
  Shadow gap:              cc
==1872112==ABORTING
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/699/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/699,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fye-b,kvrocks,1170861979,699,NA,PragmaTwice,20042607,Twice,,NA,2022-06-30T07:23:32Z,2022-06-30T07:23:32Z,"I think I found the root cause:

The the current `CommandBPop` object is deallocated while `CommandBPop::WriteCB` is called by bufferevent.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fye-b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/699,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fygxj,kvrocks,1170869347,699,NA,PragmaTwice,20042607,Twice,,NA,2022-06-30T07:31:40Z,2022-06-30T07:31:40Z,"I think we may need to change some logic: we may not be able to use a pattern like `unique_ptr<Commander> Connection::current_cmd_`, because that makes the current command get destructured when the next command is read in.

There may be commands, such as `CommandBPop`, that need to have a longer lifetime and not be destructured immediately before the next command is executed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Fygxj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/699,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FymqV,kvrocks,1170893461,699,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-06-30T07:58:12Z,2022-06-30T07:58:12Z,"Yes, maybe we can use shared_ptr to workaround this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5FymqV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/699,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5G3Ugo,kvrocks,1188907048,699,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-19T10:53:50Z,2022-07-19T10:53:50Z,"@PragmaTwice I fixed this issue in #714, can take a look if you have free time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5G3Ugo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/702,https://api.github.com/repos/apache/kvrocks/issues/702,kvrocks,1290824906,702,Memory leak reports in tcl test cases,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-07-01T02:25:38Z,2022-07-01T02:44:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

```
$ ./build.sh build -DENABLE_ASAN=ON
$ cd tests/tcl
$ ./runtest --dont-clean
```

### What did you expect to see?

No memory leak reported

### What did you see instead?

https://github.com/apache/incubator-kvrocks/runs/7133747333?check_suite_focus=true

```
=================================================================
==30270==ERROR: LeakSanitizer: detected memory leaks
Direct leak of 1023 byte(s) in 1 object(s) allocated from:
    #0 0x7f0b2c2e5b40 in __interceptor_malloc (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xdeb40)
    #1 0x55ef1f258c72 in strbuf_init (/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/tcl/redis-server+0xa1ec72)
```

### Anything Else?

I noticed only the `cjson` library is using `strbuf_init`.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/702/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/702,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F2TCg,kvrocks,1171861664,702,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-07-01T02:33:51Z,2022-07-01T02:33:51Z,"@git-hulk is it an issue on unstable branch or #697 only? We shouldn't create issue for further problem. It seems we may fix this issue at KvrocksLabs/luajit aspect?

In another word, I don't see what we can do before #697 merged and on unstable branch.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F2TCg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/702,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F2UYT,kvrocks,1171867155,702,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-01T02:44:24Z,2022-07-01T02:44:24Z,"



> @git-hulk is it an issue on unstable branch or #697 only? We shouldn't create issue for further problem. It seems we may fix this issue at KvrocksLabs/luajit aspect?
> 
> In another word, I don't see what we can do before #697 merged and on unstable branch.

My bad. I think the Lua library is using `cjson`, so it should have the same problem as well. Will close this issue since it looks introduced by #697 and have an eye on this case. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F2UYT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/706,kvrocks,1292236072,706,Enhancement: Too much `Slice::ToString()` when encoding the key,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2022-07-03T07:53:50Z,2022-09-11T03:23:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

When encoding the user's key to kvrocks' internal key, there are too much `rocksdb::Slice::ToString` called, for example:

```
void ComposeNamespaceKey(const Slice& ns, const Slice& key, std::string *ns_key, bool slot_id_encoded) {
  ns_key->clear();

  PutFixed8(ns_key, static_cast<uint8_t>(ns.size()));
  ns_key->append(ns.ToString());

  if (slot_id_encoded) {
    auto slot_id = GetSlotNumFromKey(key.ToString());
    PutFixed16(ns_key, slot_id);
  }

  ns_key->append(key.ToString());
}
```

If the key is short, it just copy the slice on the stack. If the key is long, a on-heap string is allocated just for appending to a key. It will generate lots of little heap object, which will be a waste of both cpu and heap-memory.

### Solution

Just use `append(ns.data(), ns.size())` is ok.

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/706/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6xEN,kvrocks,1173033229,706,NA,PragmaTwice,20042607,Twice,,NA,2022-07-03T08:01:03Z,2022-07-03T08:01:03Z,Great catch. Feel free to submite patches!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6xEN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6zps,kvrocks,1173043820,706,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-07-03T09:13:42Z,2022-07-03T09:13:42Z,"https://github.com/apache/incubator-kvrocks/pull/707 @PragmaTwice 
This pr solve part of this problem. There are still some callings in `GetSlotNumFromKey`. Maybe cast `Slice` to `std::string_view`, and using it's `find` and `subslice` can solve this. But `string_view` is introduced in C++17. Other solvings may include some string libraries. So I left them there.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F6zps/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F68ub,kvrocks,1173080987,706,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-03T13:02:15Z,2022-07-03T13:02:15Z,Resolved by #707 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F68ub/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F7AXv,kvrocks,1173095919,706,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-07-03T14:01:17Z,2022-07-03T14:01:17Z,@git-hulk IIUC #707 only resolves part of this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F7AXv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F7Atn,kvrocks,1173097319,706,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-03T14:07:57Z,2022-07-03T14:07:57Z,"> @git-hulk IIUC #707 only resolves part of this issue?

I thought @mapleFU won't push forward to solve other parts since it needs to introduce new string library or C++17. Correct me or feel free to reopen this issue if I was missing something.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F7Atn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F7I9O,kvrocks,1173131086,706,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-07-03T16:26:04Z,2022-07-03T16:26:04Z,"Which the help of `string_view` the code can be simplified:

``` c++
uint16_t GetSlotNumFromKey(const std::string &key) {
  auto tag = GetTagFromKey(key);
  if (tag.empty()) {
    tag = key;
  }

  auto crc = crc16(tag.data(), static_cast<int>(tag.size()));
  return static_cast<int>(crc & HASH_SLOTS_MASK);
}

std::string GetTagFromKey(const std::string &key) {
  auto left_pos = key.find(""{"");
  if (left_pos == std::string::npos) return std::string();
  auto right_pos = key.find(""}"", left_pos + 1);
  // Note that we hash the whole key if there is nothing between {}.
  if (right_pos == std::string::npos || right_pos <= left_pos + 1) {
    return std::string();
  }

  return key.substr(left_pos + 1, right_pos - left_pos - 1);
}
```

`GetTagFromKey` will cause the `key` call a `ToString()`, then `GetSlotNumFromKey` will generate a `std::string`, just to compute the crc of the slice.

Also, I notice there is a `Metadata::Decode`, which will cast the slice to `std::string` for argument `const std::string& ..`. In kvrocks, the metadata will be short, usally about 16bytes. Allocating them on heap is lightweight, but the interface is kind of ugly.

It's posible to support interface like:

```
uint16_t GetSlotNumFromKey(rocksdb::Slice key);
rocksdb::Slice GetTagFromKey(rocksdb::Slice key);
Status Decode(rocksdb::Slice key);
```

When calling them with `std::string`, just using `Slice(s)` is ok.  But RocksDB didn't has enough string operations support, like `find`, which is required in `GetTagFromKey`. Although it has `__cpp_lib_string_view` and can cast `rocksdb::Slice` to `std::string_view`, which supports `find` and `substr`, I think introduce it might be trickey. 

If we want to solve this problem, there might be some methods:
1. Using `std::string_view`.
2. folly, abseil, boost has library like `string_view`, but this project didn't include them.
3. Using `rocksdb::Slice` or `const char*` and `size_t length`. Support `find` and other operations in project's utils.

I'm not familiar with handling C++ project, and I have no idea how to handle this problem. Can you give me some advice? @git-hulk @tisonkun @PragmaTwice 


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F7I9O/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F7mwm,kvrocks,1173253158,706,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-04T01:54:36Z,2022-07-04T01:54:36Z,"In my personal opinion, it's a bit heavy to introduce boost or C++17(require newer version compiler) to improve this situation. We can also reopen this issue if want to discuss further.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F7mwm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GA1wq,kvrocks,1174625322,706,NA,PragmaTwice,20042607,Twice,,NA,2022-07-05T05:21:53Z,2022-07-05T05:21:53Z,"I think it is a long term target to update the standard version. GCC 4.8 is just too old and has no more support and backport from the gnu team. 

I know that in some old distros (like debian stable or centos which has a default package repo with all antique version software) it is not a super simple job to get more up-to-date compiler, but I think it is not the reason to stuck the standard version since kvrocks is not a library which ABI breaking is insufferable. 

For example, clickhouse uses c++20, mongodb uses c++17, and mysql will look for at least GCC 7 from devtoolset in an rhel or suse environment.

But of cause, we can use some workarounds like https://github.com/martinmoene/string-view-lite now, which is a lightweight header-only library.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GA1wq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/706,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFMun,kvrocks,1242876839,706,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:23:52Z,2022-09-11T03:23:52Z,"Closed as inactive. If @mapleFU or @PragmaTwice want to continue the effort, feel free to reopen with an estimate or create a new issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFMun/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/708,https://api.github.com/repos/apache/kvrocks/issues/708,kvrocks,1292255525,708,Enhancement: trying to reduce calling to `GetCurrentTime()` when not neccessary,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2022-07-03T09:28:11Z,2022-07-05T08:34:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

`Metadata::TTL()` and `Metadata::Expired()` will call `rocksdb::Env::Default()->GetCurrentTime(&now)` every time we called it. rocksdb's `GetCurrentTime` will ask time on OS, and mostly it will be a vdso call and may take about 10ns to get the current time.

But sometimes we don't need to call it here. If `expire == 0`, just return without `GetCurrentTime` is ok.

By the way, I'm confused that when would `expire` less than 0? Can some one helps me find out why?

### Solution

remove `GetCurrentTime` when not neccessary.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/708/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/708,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F60dP,kvrocks,1173047119,708,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-03T09:35:20Z,2022-07-03T09:35:20Z,"@mapleFU `expire` should be never less than 0, so it's good to reduce the `GetCurrentTime` function call when expire is zero.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5F60dP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/708,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GBa7e,kvrocks,1174777566,708,NA,PragmaTwice,20042607,Twice,,NA,2022-07-05T08:34:38Z,2022-07-05T08:34:38Z,Solved in #709.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GBa7e/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/713,https://api.github.com/repos/apache/kvrocks/issues/713,kvrocks,1293020624,713,BUG: Use after free in `CommandFetchFile` reported by ASan,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-07-04T11:13:27Z,2022-07-20T07:56:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step


```
./build.sh build -DENABLE_ASAN=ON
cd tests/tcl
./runtest --dont-clean
grep Sanitizer tests/tmp -r
```

### What did you expect to see?

No ASAN reports

### What did you see instead?

For more detail can see: https://github.com/apache/incubator-kvrocks/runs/7174515538?check_suite_focus=true

```
\o/ All tests passed without errors!
tests/tmp/server.21550.23/stderr:==30422==ERROR: AddressSanitizer: heap-use-after-free on address 0x606000003500 at pc 0x7f97aad45733 bp 0x7f97961e5840 sp 0x7f97961e4fe8
tests/tmp/server.21550.23/stderr:SUMMARY: AddressSanitizer: heap-use-after-free (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x79732) 
\ndetail reports:\n
E20220704 05:25:13.181370 29782 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:25:14.181675 29782 replication.cc:248] [replication] Failed to connect the master, err: Connection refused
E20220704 05:25:59.096598  1453 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:26:01.526546  1765 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:25:40.944598 31108 slot_migrate.cc:476] [migrate] Failed to read response, Err: Connection reset by peer
E20220704 05:25:40.944772 31108 slot_migrate.cc:792] [migrate] Wrong response
E20220704 05:25:40.944813 31108 slot_migrate.cc:588] [migrate] Failed to migrate complex key: 0QG
E20220704 05:25:40.944831 31108 slot_migrate.cc:310] [migrate] Failed to migrate key: 0QG
E20220704 05:25:40.944859 31108 slot_migrate.cc:181] [migrate] Failed to send snapshot
E20220704 05:25:40.944891 31108 slot_migrate.cc:420] [migrate] Failed to send import command to destination, slot: 8, error: Broken pipe
E20220704 05:24:59.634393 26964 replication.cc:77] Ping slave[127.0.0.1:41322] err: Broken pipe, would stop the thread
WARNING: Logging before InitGoogleLogging() is written to STDERR
I20220704 05:25:50.447059 21587 event_listener.cc:132] [event_listener/table_file_deleted] db: ./tests/tmp/server.21553.1/db, sst file: ./tests/tmp/server.21553.1/db/000017.sst, status: OK
=================================================================
==30422==ERROR: AddressSanitizer: heap-use-after-free on address 0x606000003500 at pc 0x7f97aad45733 bp 0x7f97961e5840 sp 0x7f97961e4fe8
READ of size 38 at 0x606000003500 thread T103 (feed-repl-file)
    #0 0x7f97aad45732  (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x79732)
    #1 0x5560df5a4ece in void std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char*>(char*, char*, std::forward_iterator_tag) (/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/tcl/redis-server+0xaabece)
    #2 0x5560df5a4f0e in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::basic_string(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) (/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/tcl/redis-server+0xaabf0e)
    #3 0x5560df048ff1 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > std::operator+<char, std::char_traits<char>, std::allocator<char> >(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, char const*) /usr/include/c++/7/bits/basic_string.h:5928
    #4 0x5560df012557 in Engine::Storage::ReplDataManager::OpenDataFile(Engine::Storage*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, unsigned long*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage.cc:836
    #5 0x5560dedaf46d in Redis::CommandFetchFile::Execute(Server*, Redis::Connection*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)::{lambda()#1}::operator()() const /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/redis_cmd.cc:4395
    #6 0x5560dedb0a3c in void std::__invoke_impl<void, Redis::CommandFetchFile::Execute(Server*, Redis::Connection*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)::{lambda()#1}>(std::__invoke_other, Redis::CommandFetchFile::Execute(Server*, Redis::Connection*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)::{lambda()#1}&&) /usr/include/c++/7/bits/invoke.h:60
    #7 0x5560dedb0a3c in std::__invoke_result<Redis::CommandFetchFile::Execute(Server*, Redis::Connection*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)::{lambda()#1}>::type std::__invoke<Redis::CommandFetchFile::Execute(Server*, Redis::Connection*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)::{lambda()#1}>(std::__invoke_result&&, (Redis::CommandFetchFile::Execute(Server*, Redis::Connection*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)::{lambda()#1}&&)...) /usr/include/c++/7/bits/invoke.h:95
    #8 0x5560dedb0a3c in decltype (__invoke((_S_declval<0ul>)())) std::thread::_Invoker<std::tuple<Redis::CommandFetchFile::Execute(Server*, Redis::Connection*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)::{lambda()#1}> >::_M_invoke<0ul>(std::_Index_tuple<0ul>) /usr/include/c++/7/thread:234
    #9 0x5560dedb0a3c in std::thread::_Invoker<std::tuple<Redis::CommandFetchFile::Execute(Server*, Redis::Connection*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)::{lambda()#1}> >::operator()() /usr/include/c++/7/thread:243
    #10 0x5560dedb0a3c in std::thread::_State_impl<std::thread::_Invoker<std::tuple<Redis::CommandFetchFile::Execute(Server*, Redis::Connection*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >*)::{lambda()#1}> > >::_M_run() /usr/include/c++/7/thread:186
    #11 0x5560df5a07de in execute_native_thread_routine (/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/tcl/redis-server+0xaa77de)
    #12 0x7f97aaab46da in start_thread (/lib/x86_64-linux-gnu/libpthread.so.0+0x76da)
    #13 0x7f97aa43f61e in __clone (/lib/x86_64-linux-gnu/libc.so.6+0x12161e)
0x606000003500 is located 0 bytes inside of 55-byte region [0x606000003500,0x606000003537)
freed by thread T0 here:
    #0 0x7f97aadad2c0 in operator delete(void*) (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xe12c0)
    #1 0x5560debe9a12 in __gnu_cxx::new_allocator<char>::deallocate(char*, unsigned long) /usr/include/c++/7/ext/new_allocator.h:125
    #2 0x5560debe9a12 in std::allocator_traits<std::allocator<char> >::deallocate(std::allocator<char>&, char*, unsigned long) /usr/include/c++/7/bits/alloc_traits.h:462
    #3 0x5560debe9a12 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_destroy(unsigned long) /usr/include/c++/7/bits/basic_string.h:226
    #4 0x5560debe9a12 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_dispose() /usr/include/c++/7/bits/basic_string.h:221
    #5 0x5560debe9a12 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::~basic_string() /usr/include/c++/7/bits/basic_string.h:647
    #6 0x5560debe9a12 in Config::~Config() /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/config.h:66
    #7 0x5560deb9b44c in main /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/main.cc:316
    #8 0x7f97aa33fc86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
previously allocated by thread T0 here:
    #0 0x7f97aadac448 in operator new(unsigned long) (/usr/lib/x86_64-linux-gnu/libasan.so.4+0xe0448)
    #1 0x5560df5a28f9 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_mutate(unsigned long, unsigned long, char const*, unsigned long) (/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/tcl/redis-server+0xaa98f9)
Thread T103 (feed-repl-file) created by T97 (worker) here:
    #0 0x7f97aad03d2f in __interceptor_pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x37d2f)
    #1 0x5560df5a0ac4 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/tcl/redis-server+0xaa7ac4)
    #2 0x5560dee1f8a4 in Redis::Connection::ExecuteCommands(std::vector<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > > const&) /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/redis_connection.cc:422
    #3 0x5560dee233f5 in Redis::Connection::OnRead(bufferevent*, void*) /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/redis_connection.cc:89
    #4 0x5560df4df61d in bufferevent_run_deferred_callbacks_unlocked /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/_deps/libevent-src/bufferevent.c:208
Thread T97 (worker) created by T0 here:
    #0 0x7f97aad03d2f in __interceptor_pthread_create (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x37d2f)
    #1 0x5560df5a0ac4 in std::thread::_M_start_thread(std::unique_ptr<std::thread::_State, std::default_delete<std::thread::_State> >, void (*)()) (/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/tcl/redis-server+0xaa7ac4)
    #2 0x5560def939bb in Server::Start() /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server.cc:121
    #3 0x5560deb9b2ee in main /home/runner/work/incubator-kvrocks/incubator-kvrocks/src/main.cc:354
    #4 0x7f97aa33fc86 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x21c86)
SUMMARY: AddressSanitizer: heap-use-after-free (/usr/lib/x86_64-linux-gnu/libasan.so.4+0x79732) 
Shadow bytes around the buggy address:
  0x0c0c7fff8650: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8660: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8670: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff8680: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fa
  0x0c0c7fff8690: fa fa fa fa fd fd fd fd fd fd fd fa fa fa fa fa
=>0x0c0c7fff86a0:[fd]fd fd fd fd fd fd fa fa fa fa fa fd fd fd fd
  0x0c0c7fff86b0: fd fd fd fa fa fa fa fa fd fd fd fd fd fd fd fa
  0x0c0c7fff86c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff86d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff86e0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0c0c7fff86f0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07 
  Heap left redzone:       fa
  Freed heap region:       fd
  Stack left redzone:      f1
  Stack mid redzone:       f2
  Stack right redzone:     f3
  Stack after return:      f5
  Stack use after scope:   f8
  Global redzone:          f9
  Global init order:       f6
  Poisoned by user:        f7
  Container overflow:      fc
  Array cookie:            ac
  Intra object redzone:    bb
  ASan internal:           fe
  Left alloca redzone:     ca
  Right alloca redzone:    cb
==30422==ABORTING
E20220704 05:25:13.181382 29785 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:24:53.779562 25091 replication.cc:128] Write error while sending batch to slave: Broken pipe. batches: 0x2433380D0A02000000000000000100000003013105010D0B5F5F6E616D65737061636561060100000000620D0A
E20220704 05:24:53.780030 25099 replication.cc:128] Write error while sending batch to slave: Broken pipe. batches: 0x2433380D0A02000000000000000100000003013105010D0B5F5F6E616D65737061636561060100000000620D0A
E20220704 05:24:53.780268 25131 replication.cc:128] Write error while sending batch to slave: Broken pipe. batches: 0x2433380D0A02000000000000000100000003013105010D0B5F5F6E616D65737061636561060100000000620D0A
E20220704 05:24:56.222230 25861 slot_migrate.cc:241] [migrate] Failed to connect destination server
E20220704 05:24:56.222508 25861 slot_migrate.cc:170] [migrate] Failed to start migrating
E20220704 05:24:49.706113 24751 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:25:52.255283 32602 slot_migrate.cc:288] [migrate] Stop migrating snapshot due to the thread stoped
E20220704 05:25:52.255439 32602 slot_migrate.cc:181] [migrate] Failed to send snapshot
E20220704 05:25:04.225044 26691 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:25:56.253038   591 slot_migrate.cc:494] [migrate] Got invalid response: -NOAUTH Authentication required., line length: 32
E20220704 05:25:56.253249   591 slot_migrate.cc:256] [migrate] Failed to notify the destination to prepare to import data
E20220704 05:25:56.253271   591 slot_migrate.cc:170] [migrate] Failed to start migrating
E20220704 05:25:56.253386   591 slot_migrate.cc:494] [migrate] Got invalid response: -NOAUTH Authentication required., line length: 32
E20220704 05:25:56.254267   591 slot_migrate.cc:494] [migrate] Got invalid response: -ERR invalid password, line length: 21
E20220704 05:25:56.254307   591 slot_migrate.cc:406] [migrate] Failed to auth destination server with 'pass', stop migrating slot 22
E20220704 05:25:56.254325   591 slot_migrate.cc:170] [migrate] Failed to start migrating
E20220704 05:25:56.254431   591 slot_migrate.cc:494] [migrate] Got invalid response: -NOAUTH Authentication required., line length: 32
E20220704 05:25:10.059321 29194 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:25:06.633349 28188 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:24:59.645223 27469 replication.cc:248] [replication] Failed to connect the master, err: Connection refused
E20220704 05:25:02.869042 27470 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:24:46.901080 23284 redis_cmd.cc:1582] Failed to execute redis command: blpop, err: Invalid argument: WRONGTYPE Operation against a key holding the wrong kind of value
E20220704 05:24:48.914759 23284 redis_cmd.cc:1582] Failed to execute redis command: brpop, err: Invalid argument: WRONGTYPE Operation against a key holding the wrong kind of value
E20220704 05:25:41.277627 30700 replication.cc:698] [replication] Failed to parallel fetch files while fetch file err: read size: File exists
E20220704 05:25:51.290735 30700 replication.cc:162] [replication] connection error/eof, reconnect the master
E20220704 05:25:48.578738 31962 slot_migrate.cc:494] [migrate] Got invalid response: -MOVED 10 127.0.0.1:28122, line length: 25
E20220704 05:25:48.5[790](https://github.com/apache/incubator-kvrocks/runs/7174515538?check_suite_focus=true#step:9:791)25 31962 slot_migrate.cc:792] [migrate] Wrong response
E20220704 05:25:48.579075 31962 slot_migrate.cc:588] [migrate] Failed to migrate complex key: 7Ok
E20220704 05:25:48.5[791](https://github.com/apache/incubator-kvrocks/runs/7174515538?check_suite_focus=true#step:9:792)13 31962 slot_migrate.cc:310] [migrate] Failed to migrate key: 7Ok
E20220704 05:25:48.57[913](https://github.com/apache/incubator-kvrocks/runs/7174515538?check_suite_focus=true#step:9:914)8 31962 slot_migrate.cc:181] [migrate] Failed to send snapshot
sanitizer error was reported, exiting...
Error: Process completed with exit code 1.
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/713/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/715,https://api.github.com/repos/apache/kvrocks/issues/715,kvrocks,1293156886,715,Synchronization of slowlog and perflog,AvivPl,108676515,,,OPEN,2022-07-04T13:11:45Z,2024-03-16T13:38:51Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As discussed on the KVRocks slack channel,
It would be beneficial for performance debugging to force the two tools (`slowlog` and `perflog`) to sample the same commands and synchronize them on both perflog's and slowlog's lists.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/715/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/715,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GChua,kvrocks,1175067546,715,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-05T13:34:10Z,2022-07-05T13:34:10Z,Thanks @AvivPl for filling this. I think it's a good idea to synchronize perflog and showlog.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GChua/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/717,https://api.github.com/repos/apache/kvrocks/issues/717,kvrocks,1294316694,717,Remove deprecated configuration `auto-resize-block-and-sst`,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-07-05T13:38:31Z,2022-07-06T01:57:02Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

`auto-resize-block-and-sst` was used to auto-resize block and sst size in flight,
but we deprecated it after using the rocksdb partition index, so we should remove it
from the config file.

### Solution

remove deprecated `auto-resize-block-and-sst` from config file.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/717/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/718,kvrocks,1294440676,718,Build docker image with Travis CI,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-07-05T15:16:44Z,2022-07-11T06:20:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

#550 introduces a CI task to build docker image, especially including build on ARM64 which is simulated via QEMU. This task generally takes more than 2 hours to complete and we currently have to run it daily in a dedicate job.

GitHub Actions support only x86 arch at the moment, and among CI platforms ASF provides, Travis CI seems a good fit to run CI tasks on other arches including ARM64. [I ask INFRA how to configure Travis CI settings](https://issues.apache.org/jira/browse/INFRA-23444), and the answer is directly pushing a `.travis.yml` file to the root path.

IIRC @git-hulk @PragmaTwice show your interests in this topic before, you may take a look and give it a try. I may find sometime later this month to give it a try if nobody moves forward.

cc @foxdalas as the original author of #550.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/718/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GDCLA,kvrocks,1175200448,718,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-07-05T15:34:38Z,2022-07-05T15:34:38Z,"Perhaps useful references:

* https://docs.travis-ci.com/user/docker/
* https://docs.travis-ci.com/user/installing-dependencies/
* https://docs.travis-ci.com/user/languages/cpp/","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GDCLA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GDaTg,kvrocks,1175299296,718,NA,PragmaTwice,20042607,Twice,,NA,2022-07-05T17:05:36Z,2022-07-05T17:05:36Z,"https://docs.travis-ci.com/user/cron-jobs/

Seems cron jobs in Travis CI can only be set on web UI rather than `.travis.yml`, which maybe more hard since we have no permission to access Travis web UI of the Apache org.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GDaTg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GEt2g,kvrocks,1175641504,718,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-07-06T00:48:28Z,2022-07-06T00:48:28Z,"@PragmaTwice currently, we run docker build daily due to it's slow. If using travis we can finish the task within an hour, we can run the task per PR. For cron settings, you can comment at the JIRA ticket, asking the best practice from INFRA team.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GEt2g/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFbEX,kvrocks,1175826711,718,NA,PragmaTwice,20042607,Twice,,NA,2022-07-06T06:20:56Z,2022-07-06T06:20:56Z,Thanks. I think it maybe unnecessary to build docker images for every commit in a PR: we've fully tested them in other workflows. I think we can consider building docker images for each new commit in the unstable branch and release it as a nightly version (of course we can do some pruning when releasing to ensure that only one nightly image is released per day),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFbEX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFrRz,kvrocks,1175893107,718,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-07-06T07:43:36Z,2022-07-06T07:43:36Z,"> building docker images for each new commit in the unstable branch and release it as a nightly version

That's possible. Actually SkyWalking provides such features along with GitHub Packages (https://github.com/orgs/apache/packages?repo_name=skywalking). Also they support build on ARM64 arch while doesn't involve Travis CI dependency. It should be worth to investigate.

cc @kezhenxu94 could you share some background how SkyWalking implements the workflow here?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFrRz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFuXW,kvrocks,1175905750,718,NA,kezhenxu94,15965696,kezhenxu94,kezhenxu94@apache.org,NA,2022-07-06T07:56:12Z,2022-07-06T07:56:12Z,"Personally I'd prefer GitHub Actions over Travis CI as GHA is integrated smoothly in terms of development experience, and you don't need to ask Apache infra team to provide token and configure them in Travis CI (this is usually forbidden by infra team for the sake of security).

> Thanks. I think it maybe unnecessary to build docker images for every commit in a PR: we've fully tested them in other workflows.

I agree we don't need to build Docker images in every commit **in a PR**, not to say pushing/publishing to GitHub Container Registry, ghcr,

> I think we can consider building docker images for each new commit in the unstable branch and release it as a nightly version (of course we can do some pruning when releasing to ensure that only one nightly image is released per day).

In SkyWalking, we build and push a Docker image for every commit in the `master` branch, tagged with the commit hash as well as the `latest` tag, so we'd recommend testers (not users) to use the `:latest` tag when they want to try something new, or help to test the latest codes.

Also, to build multi-arch Docker images, you actually don't need an ARM-arch machine, by leveraging qemu and Docker build kit you can cross build Docker images for all architectures https://github.com/apache/skywalking/blob/47cc2f7bb99fefda37a3adcc85206e1743d32757/.github/workflows/publish-docker.yaml#L55-L58

And to just build for every commit in `master` branch, just set the `on` condition to `branch.master` so the workflow won't be triggered in PR commits

https://github.com/apache/skywalking/blob/47cc2f7bb99fefda37a3adcc85206e1743d32757/.github/workflows/publish-docker.yaml#L19-L22

All the works 👆 can be done on your own, without asking apache infra team to configure tokens, which is impossible in Travis CI.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFuXW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFvAr,kvrocks,1175908395,718,NA,kezhenxu94,15965696,kezhenxu94,kezhenxu94@apache.org,NA,2022-07-06T07:59:10Z,2022-07-06T07:59:10Z,I think you already have the workflow https://github.com/apache/incubator-kvrocks/blob/c094ea46ae500169dcc3e9b3b28ee6c47ea098bc/.github/workflows/release.yaml#L82-L94 so you only need to add a trigger condition when pushed to main branch.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFvAr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFwDI,kvrocks,1175912648,718,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-07-06T08:03:40Z,2022-07-06T08:03:40Z,"@kezhenxu94 the main argument about using QEMU for kvrocks is that it takes over 2 hours to complete, while I can see that the SkyWalking job take ~20 mins to complete. I have no idea yet how can kvrocks build behaves so different. Perhaps jar files are platform-agnostic so that you can simply copy the generated file into the image, while we should build kvrocks from scratch on ARM64 platform - each inst emitted by QEMU and it's slow.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GFwDI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GF3ly,kvrocks,1175943538,718,NA,kezhenxu94,15965696,kezhenxu94,kezhenxu94@apache.org,NA,2022-07-06T08:35:20Z,2022-07-06T08:35:20Z,"From [the logs](https://github.com/apache/incubator-kvrocks/runs/7206849766?check_suite_focus=true#step:6:4651) I can see the time in building ARM Docker image dominates (~2 hours), and [the time in building AMD image is about 20 minutes](https://github.com/apache/incubator-kvrocks/runs/7206849766?check_suite_focus=true#step:6:4150). I remember it indeed takes longer time to build ARM compared to AMD when I tried to build ARM Docker images for apache/pulsar, which includes some C++ codes for their C++ client.

> Perhaps jar files are platform-agnostic so that you can simply copy the generated file into the image

I agree this might be the main reason","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GF3ly/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GF4cY,kvrocks,1175947032,718,NA,PragmaTwice,20042607,Twice,,NA,2022-07-06T08:38:51Z,2022-07-06T08:38:51Z,"In this workflow run https://github.com/apache/incubator-kvrocks/runs/7206849766?check_suite_focus=true, we can see

build kvrocks on native amd64: 1161.3s ~ 20 min
build kvrocks on QEMU arm64 : 7678.7s ~ 2h 8min

more than x6 times longer in QEMU simulation, it is frustrating 😢 

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GF4cY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GGJCD,kvrocks,1176014979,718,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-06T09:44:58Z,2022-07-06T09:44:58Z,"I'm wondering whether builds the arm64 only in QMEMU can reduce the cost time or not, and
build the amd64 in previous way.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GGJCD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GULBa,kvrocks,1179693146,718,NA,foxdalas,131937,Maxim Pogozhiy,,NA,2022-07-10T09:37:29Z,2022-07-10T09:37:29Z,You can use cross-compiling and just copy binary inside arm-based container. It will be faster ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GULBa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GULSA,kvrocks,1179694208,718,NA,PragmaTwice,20042607,Twice,,NA,2022-07-10T09:45:29Z,2022-07-10T09:45:29Z,"> You can use cross-compiling and just copy binary inside arm-based container. It will be faster

Thanks. I think it is a greate idea, but I do not know if it will be more complicated than the travis ci way.

Maybe need some trying.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GULSA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/718,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GUXDs,kvrocks,1179742444,718,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-07-10T14:48:06Z,2022-07-10T14:48:06Z,You can review #724 for an attempt.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GUXDs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/727,https://api.github.com/repos/apache/kvrocks/issues/727,kvrocks,1302035980,727,set command is inconsistent with redis ,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2022-07-12T13:04:44Z,2022-07-15T11:42:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.0.6

### Minimal reproduce step

```
kvrocks:6666> set key value ex 1000 px 2
OK

kvrocks:6666> set key value ex 1000xyz
OK
```
But in redis:
```
redis:6379> set key value ex 1000 px 2
(error) syntax error

redis:6379> set key value ex 1000xyz
(error) value is not an integer or out of range
```

### What did you expect to see?

The set command should be the same as [redis](https://redis.io/commands/set/).

### What did you see instead?

Can set new data using incorrect syntax.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/727/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/727,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GcCv5,kvrocks,1181756409,727,NA,PragmaTwice,20042607,Twice,,NA,2022-07-12T13:23:43Z,2022-07-12T13:23:43Z,"Has something in common with #456.


```
set key value ex 1000xyz
```
I think this is because we are using functions like `stoi` directly without using parse techniques for error handling.

I proposed a unified abstraction in #598 to better parse redis commands and solve all these problem.  But I haven't taken the time to implement them.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GcCv5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/727,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Gfb3G,kvrocks,1182645702,727,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-07-13T00:58:37Z,2022-07-13T00:58:37Z,"> I proposed a unified abstraction in https://github.com/apache/incubator-kvrocks/issues/598 to better parse redis commands and solve all these problem. But I haven't taken the time to implement them.I proposed a unified abstraction in https://github.com/apache/incubator-kvrocks/issues/598 to better parse redis commands and solve all these problem. But I haven't taken the time to implement them.

Yes, it may be a big change, and it may take a long time.  

However, `set` command is a very common command, and I thought it would be a simple matter to fix it first.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Gfb3G/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/733,https://api.github.com/repos/apache/kvrocks/issues/733,kvrocks,1307128759,733,Delete changelog and maintain it out of the repo ,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-07-17T15:26:57Z,2022-07-18T13:49:41Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As discussed in https://github.com/apache/incubator-kvrocks/discussions/731, we are agreed to remove the changelog from the repo since it's NOT easy to maintain.

### Solution

Remove the changelog file and maintain the release history on our website: https://kvrocks.apache.org

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/733/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/736,https://api.github.com/repos/apache/kvrocks/issues/736,kvrocks,1307559938,736,org.redisson.client.WriteRedisConnectionException: Channel has been closed,chenchenfang,50065243,chenchenfang,,CLOSED,2022-07-18T08:07:31Z,2023-06-05T02:33:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

linux：CentOS Linux release 7.9.2009 (Core)
kvrocks：version:2.0.6

### Minimal reproduce step

After Tomcat is started,i used Redisson 3.17.3  to get kvrocks data

### What did you expect to see?

do not throw exception......

### What did you see instead?

org.redisson.client.WriteRedisConnectionException: Channel has been closed! Can't write command: (SUBSCRIBE), promise: java.util.concurrent.CompletableFuture@1cea627f[Not completed], params: [{USER_REDIS231}:topic] to channel: [id: 0x2edf3aa0, L:0.0.0.0/0.0.0.0:35480 ! R:192.168.1.131/192.168.1.131:6666]
CAUSE:null
	at org.redisson.client.handler.CommandsQueuePubSub.channelInactive(CommandsQueuePubSub.java:76)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)
	at org.redisson.client.handler.ConnectionWatchdog.channelInactive(ConnectionWatchdog.java:82)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$7.run(AbstractChannel.java:813)
	at io.netty.util.concurrent.AbstractEventExecutor.runTask(AbstractEventExecutor.java:174)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:167)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:470)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:503)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:995)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)
	at java.lang.Thread.run(Thread.java:748)

and then


org.redisson.client.RedisException: Unexpected exception while processing command
CAUSE:io.netty.channel.StacklessClosedChannelException
	at org.redisson.command.CommandAsyncService.convertException(CommandAsyncService.java:276)
	at org.redisson.command.CommandAsyncService.get(CommandAsyncService.java:132)
	at org.redisson.RedissonTopic.addListener(RedissonTopic.java:104)
	at org.redisson.cache.LocalCacheListener.add(LocalCacheListener.java:141)
	at org.redisson.RedissonLocalCachedMap.init(RedissonLocalCachedMap.java:97)
	at org.redisson.RedissonLocalCachedMap.<init>(RedissonLocalCachedMap.java:70)
	at org.redisson.Redisson.getLocalCachedMap(Redisson.java:249)
	at tools.ERedisson.getLocalCachedMap(ERedisson.kt:86)
	at tools.ERedisson.getLocalCachedMap$default(ERedisson.kt:80)
	at toredisson.BeanToRedisson.getObjectObjectRLocalCachedMap(BeanToRedisson.kt:650)
	at toredisson.BeanToRedisson.rediscaffecacheL2$lambda-2$lambda-1(BeanToRedisson.kt:411)
	at java.util.concurrent.ForkJoinTask$RunnableExecuteAction.exec(ForkJoinTask.java:1402)
	at java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:289)
	at java.util.concurrent.ForkJoinPool$WorkQueue.runTask(ForkJoinPool.java:1056)
	at java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1692)
	at java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:157)


### Anything Else?

when i used Redisson 3.13.6 , everything is OK
so maybe there are certain things that kVRocks does not support

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/736/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/736,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GwVxD,kvrocks,1187077187,736,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-18T11:01:36Z,2022-07-18T11:01:36Z,"@chenchenfang Thanks for filling the issue, but I can't tell what goes wrong with current error stack. You can use the `monitor` command to see what commands were called when errors happened.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GwVxD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/736,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5G_WbB,kvrocks,1191012033,736,NA,chenchenfang,50065243,chenchenfang,,NA,2022-07-21T04:01:45Z,2022-07-21T04:01:45Z,"> @chenchenfang Thanks for filling the issue, but I can't tell what goes wrong with current error stack. You can use the `monitor` command to see what commands were called when errors happened.

kvrocks  request volume is too large, so i think use the `monitor` not a good idea

Is there another way?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5G_WbB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/736,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-zh,kvrocks,1200090337,736,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-30T05:01:02Z,2022-07-30T05:01:02Z,"


> > @chenchenfang Thanks for filling the issue, but I can't tell what goes wrong with current error stack. You can use the `monitor` command to see what commands were called when errors happened.
> 
> kvrocks request volume is too large, so i think use the `monitor` not a good idea
> 
> Is there another way?

Yet another way is capture packets with tools like tcpdump.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-zh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/736,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFMso,kvrocks,1242876712,736,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:22:30Z,2022-09-11T03:22:30Z,"> After Tomcat is started,i used Redisson 3.17.3 to get kvrocks data

This is quite vague. I suppose you start a Kvrocks server or cluster in someway. It would be better if you can provide a sample repo to reproduce the issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFMso/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/736,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZssGE,kvrocks,1504887172,736,NA,cloudInspire,87846800,,,NA,2023-04-12T08:39:42Z,2023-04-12T08:39:42Z,"my redis version : 3.12.2
have the save question","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZssGE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/737,https://api.github.com/repos/apache/kvrocks/issues/737,kvrocks,1307833983,737,there is a bug with hscan_iter,luger1990,2096878,Luger Smith,,CLOSED,2022-07-18T11:47:15Z,2022-08-06T06:04:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.0.6

### Minimal reproduce step

```
master = my_sentinel.master_for(master_name, socket_timeout=2000, password=password)
key = ""u:uuid:20220718""
for u, uuid in master.hscan_iter(name=key, count=500):
    print(u, uuid)
```

### What did you expect to see?

key, value output

### What did you see instead?

```
/usr/lib/python3/dist-packages/requests/__init__.py:89: RequestsDependencyWarning: urllib3 (1.26.9) or chardet (3.0.4) doesn't match a supported version!
  warnings.warn(""urllib3 ({}) or chardet ({}) doesn't match a supported ""
Traceback (most recent call last):
  File ""xxx.py"", line 60, in <module>
    update()
  File ""song_rec_history_update.py"", line 32, in update
    for item in master.hscan_iter(name=key):
  File ""/usr/local/lib/python3.8/dist-packages/redis/commands/core.py"", line 3002, in hscan_iter
    cursor, data = self.hscan(name, cursor=cursor, match=match, count=count)
  File ""/usr/local/lib/python3.8/dist-packages/redis/commands/core.py"", line 2984, in hscan
    return self.execute_command(""HSCAN"", *pieces)
  File ""/usr/local/lib/python3.8/dist-packages/redis/client.py"", line 1227, in execute_command
    return conn.retry.call_with_retry(
  File ""/usr/local/lib/python3.8/dist-packages/redis/retry.py"", line 46, in call_with_retry
    return do()
  File ""/usr/local/lib/python3.8/dist-packages/redis/client.py"", line 1228, in <lambda>
    lambda: self._send_command_parse_response(
  File ""/usr/local/lib/python3.8/dist-packages/redis/client.py"", line 1204, in _send_command_parse_response
    return self.parse_response(conn, command_name, **options)
  File ""/usr/local/lib/python3.8/dist-packages/redis/client.py"", line 1249, in parse_response
    return self.response_callbacks[command_name](response, **options)
  File ""/usr/local/lib/python3.8/dist-packages/redis/client.py"", line 394, in parse_hscan
    return int(cursor), r and pairs_to_dict(r) or {}
ValueError: invalid literal for int() with base 10: b'001947E61B404408A0FE96500AE7D7F8'

```

### Anything Else?

![origin_img_v2_810b0a51-158c-40fd-8352-aaa88e57c7ch](https://user-images.githubusercontent.com/2096878/179504344-dabd1ec6-4573-4d65-b017-e2d6ad55bf09.jpg)


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/737/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/737,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GxA4a,kvrocks,1187253786,737,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-07-18T12:15:39Z,2022-07-18T12:15:39Z,Hi @luger1990 FYI https://github.com/apache/incubator-kvrocks/discussions/417,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5GxA4a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/737,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HYyWs,kvrocks,1197680044,737,NA,luger1990,2096878,Luger Smith,,NA,2022-07-28T05:27:17Z,2022-07-28T05:27:17Z,"> Hi @luger1990 FYI #417

but why pika can support this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HYyWs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/737,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-sg,kvrocks,1200089888,737,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-30T04:56:55Z,2022-07-30T04:56:55Z,"> > Hi @luger1990 FYI #417
> 
> but why pika can support this?

The design internal is different, but very happy to see anyone who would like to improve it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-sg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/737,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5H871P,kvrocks,1207156047,737,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-06T06:04:03Z,2022-08-06T06:04:03Z,"Will close this issue if we have no further discussion, feel free to reopen if needed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5H871P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/738,https://api.github.com/repos/apache/kvrocks/issues/738,kvrocks,1310934778,738,Remove all *.md in `docs` dir and apply license header for some files,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-07-20T11:53:33Z,2022-07-21T13:08:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

All those documentations are existed in our website and wiki,
so I think we can remove them and won't keep any docs in the repo anymore.

### Solution

Delete all *.md and change the dir name to `static` or others.

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/738/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/742,https://api.github.com/repos/apache/kvrocks/issues/742,kvrocks,1313261952,742,Test case failed occasionally in `test/unit/expire.tcl` ,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-07-21T13:27:46Z,2022-07-21T16:01:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Check expire at test case failed occasionally, we should fix it to make the CI happy.

```
*** [err]: EXPIREAT - Check for EXPIRE alike behavior in tests/unit/expire.tcl
Expected '1[345]' to equal or match '16'
Error: Process completed with exit code 1.
```

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/742/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/742,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HBUal,kvrocks,1191528101,742,NA,PragmaTwice,20042607,Twice,,NA,2022-07-21T14:04:59Z,2022-07-21T14:04:59Z,"```
*** [err]: PERSIST can undo an EXPIRE in tests/unit/expire.tcl
Expected '50 1 -1 foo' to equal or match '49 1 -1 foo'
```

Another failure in `expire.tcl`: https://github.com/apache/incubator-kvrocks/runs/7450339994?check_suite_focus=true","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HBUal/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/742,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HBWgZ,kvrocks,1191536665,742,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-21T14:12:24Z,2022-07-21T14:12:24Z,"Thanks @PragmaTwice, also fixed it by add some tolerant range.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HBWgZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/749,https://api.github.com/repos/apache/kvrocks/issues/749,kvrocks,1314916450,749,Send logs to stdout/stderr by default,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-07-22T11:58:54Z,2022-07-26T04:02:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, we sent logs to the log file and it's non obvious enough when failed to start the server. We can send logs to stdout/stderr which will also make docker users happy.

### Solution

Change the log-dir to `stdout` in the config file

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/749/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/753,https://api.github.com/repos/apache/kvrocks/issues/753,kvrocks,1316458267,753,Support the `hello` command,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-07-25T08:27:30Z,2022-10-08T06:04:37Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Redis supported the hello command to detect the different protocol and some Redis SDKs will
use it to switch a different protocol. So it will be good to support the command to make those
SDKs happy.

### Solution

Add the hello command and keep the output same with `https://redis.io/commands/hello/`

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/753/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IrFNj,kvrocks,1219253091,753,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-08-18T09:31:24Z,2022-08-18T09:31:24Z,"Hi hulk, after reading document and code of redis (mainly https://github.com/redis/redis/blob/unstable/src/networking.c#L3432 ), I found that `hello` defines the protocol redis use ( RESP2 or RESP3), and return the data via `hello`'s ""protocol"".

After go through the code of kvrocks ( `redis_cmd` and `server` ), I didn't found implementions for RESP3, did I miss it?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IrFNj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IrMIv,kvrocks,1219281455,753,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-18T09:46:31Z,2022-08-18T09:46:31Z,"@mapleFU You're right that we only implemented RESP2 and have no plan to implement RESP3 recently. The main purpose of this command is to compatible with some Redis clients, which may send the `hello` command to check the protocol version after connecting to the server. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IrMIv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IrVW3,kvrocks,1219319223,753,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-08-18T10:25:46Z,2022-08-18T10:25:46Z,"> @mapleFU You're right that we only implemented RESP2 and have no plan to implement RESP3 recently. The main purpose of this command is to compatible with some Redis clients, which may send the `hello` command to check the protocol version after connecting to the server.

So, user should get response like https://github.com/redis/redis/blob/unstable/src/networking.c#L3439 if they use `protocol`   as `3`? What about acl?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IrVW3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Iravv,kvrocks,1219341295,753,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-18T10:43:47Z,2022-08-18T10:43:47Z,"> > @mapleFU You're right that we only implemented RESP2 and have no plan to implement RESP3 recently. The main purpose of this command is to compatible with some Redis clients, which may send the `hello` command to check the protocol version after connecting to the server.
> 
> So, user should get response like https://github.com/redis/redis/blob/unstable/src/networking.c#L3439 if they use `protocol` as `3`? What about acl?

Yes, can respond the protocol version is out of range like Redis. For the ACL, we don't support the user/password like Redis 6/7, so I think we can just read ignore the AUTH parameters. That said those clients must use legacy way to auth.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Iravv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JziYZ,kvrocks,1238246937,753,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-06T14:40:06Z,2022-09-06T14:40:06Z,"It's interesting that when executing `HELLO 3 AUTH default foobar` with `requirepass foobar` Kvrocks returns ""NOAUTH Authentication required."" instead of `ERR unknown command` so that some assumption made by go-redis doesn't work.

cc @vmihailenco this can be an incompatible issue with Kvrocks and go-redis, but I suppose it should be resolved by Kvrocks support HELLO or at least returns `ERR unknown command` on unknown command.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JziYZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JznPc,kvrocks,1238266844,753,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-06T14:55:03Z,2022-09-06T14:55:03Z,"Good catch. I think the right behavior should return `ERR unknown command` on Kvrock's side, but unfortunately that Kvrocks will check the auth first now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JznPc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jznus,kvrocks,1238268844,753,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-06T14:56:28Z,2022-09-06T14:56:28Z,@git-hulk I change the order in #830 and all tests look good.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jznus/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jzo0h,kvrocks,1238273313,753,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-06T14:59:43Z,2022-09-06T14:59:43Z,"> @git-hulk I change the order in #830 and all tests look good.

Thanks!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jzo0h/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/755,https://api.github.com/repos/apache/kvrocks/issues/755,kvrocks,1319003430,755,Metrics for namespace  level,liangyuanpeng,28711504,Lan,gcslyp@gmail.com,OPEN,2022-07-27T04:24:23Z,2024-05-13T07:53:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Ref: https://github.com/apache/incubator-kvrocks/discussions/726
We are using the namespace to separate data between users and it works well.
But the metrics from the info command stats didn't separate by namespace as well.
As a user, we want to know the speed of commands for each namespace.


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/755/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/755,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-oY,kvrocks,1200089624,755,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-07-30T04:54:03Z,2022-07-30T04:54:03Z,"@liangyuanpeng Thanks for your feedback, it makes a lot sense.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Hh-oY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/755,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aeL7d,kvrocks,1517862621,755,NA,zevin02,92536645,pt,zevin9427@gmail.com,NA,2023-04-21T13:48:43Z,2023-04-21T13:48:43Z,"Do you want only the data of stats to be isolated according to the namespace, or all parameters of the command INFO are required?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aeL7d/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/755,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d5kYR,kvrocks,1575372305,755,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-04T04:11:43Z,2023-06-04T04:11:43Z,"Now kvrocks don't save stat data for each namespace, if we need make it we should save stat for each namespace.

we can change `Server#stats` to a map that save namespace to stat mapping.

This will increase additional cost above:

1. Roughly 2KB memory usage per namespace
2. lock namespace-stat map when we add namespace
3. One more indirect addressing for access stat
4. Administrator `info` command need to foreach all namespace stat and count sum/average.

For 1rd we won't have thousands of namespace, so this memory usage is not large.
For 2nd add namespace is low-frequency operation and it is fast.
For 3rd if we think indirect addressing expensive, we can cache it in connect.(I don't think this is necessary)
For 4rd this is not important.

I think them is acceptable. So do we need do it?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d5kYR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/755,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59lJEI,kvrocks,2106888456,755,NA,gofort,11654185,Bogdan Kurnosov,kurnosov_bogdan@hotmail.com,NA,2024-05-13T07:53:18Z,2024-05-13T07:53:18Z,"+1 it would be cool to have this
use case is simple: we see the amount of keys is growing, but we have no idea in which namespace this happens, so now we need to check each namespace manually which is not convenient at all if you have a lot of namespaces","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59lJEI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/756,https://api.github.com/repos/apache/kvrocks/issues/756,kvrocks,1319131257,756,Move tests/tcl/runtest script to x.py,PragmaTwice,20042607,Twice,,CLOSED,2022-07-27T07:23:23Z,2022-08-03T07:39:58Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

`runtest` script currently has some limitations, such as not being able to provide a build dir and handle the current working directory and the tcl version well, etc. We can achieve this by migrating the logic of this script to `x.py`, such as `./x.py tcl-test`.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/756/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/760,https://api.github.com/repos/apache/kvrocks/issues/760,kvrocks,1322426943,760,Some tcl test cases can't run on macOS,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-07-29T15:53:47Z,2022-07-30T04:47:15Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

```
$ ./x.py build
$ cd tests/tcl && ./runtest
```

### What did you expect to see?

All tests can pass normally

### What did you see instead?

Some test cases got below error:
```
ERROR:### Starting server for test 
Version: 999.999.999 @9b721b1
*** [err]: Can't start the Redis server
CONFIGURATION:bind 127.0.0.1
timeout 0
workers 2
master-use-repl-port no
daemonize no
maxclients 10000
db-name change.me.db
dir ./tests/tmp/server.50285.1
pidfile ./kvrocks.pid
slave-read-only yes
tcp-backlog 511
slave-serve-stale-data yes
max-replication-mb 0
max-io-mb 500
max-db-size 0
port 25111
unixsocket /Users/hulk/code/cxx/incubator-kvrocks/tests/tcl/tests/tmp/server.50285.1/socket
list-max-ziplist-size 16
ERROR:### Starting server for test 
Version: 999.999.999 @9b721b1
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/760/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/766,https://api.github.com/repos/apache/kvrocks/issues/766,kvrocks,1326586420,766,The atoi exception was not caught,Ranxy,3327004,ran,,CLOSED,2022-08-03T02:08:04Z,2022-08-03T10:44:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

There is some code in the project as follows
```cpp
try {
        slot_ = atoi(args[2].c_str());
        dst_node_id_ = args[3];
      } catch (std::exception &e) {
        return Status(Status::RedisParseErr, errValueNotInterger);
      }
```
However `atoi` does not throw exceptions, so perhaps we should use `std::stoi` to replace these.



### Solution

Replace `atoi` to `std::stoi`

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/766/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HunfO,kvrocks,1203402702,766,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-03T02:11:27Z,2022-08-03T02:11:27Z,"Good catch, I think we can use `Util::OctalStringToNum` to replace the `atoi` which also can check the min/max boundary.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5HunfO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/769,https://api.github.com/repos/apache/kvrocks/issues/769,kvrocks,1328202722,769,[feature] Support key expire listener,liangyuanpeng,28711504,Lan,gcslyp@gmail.com,CLOSED,2022-08-04T07:39:02Z,2022-09-11T03:20:37Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation


Support key expire listener.

```
192.168.3.228:6666> config set notify-keyspace-events AE
(error) CONFIG SET 'notify-keyspace-events' error: Unsupported CONFIG parameter: notify-keyspace-events
```

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/769/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/769,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IJzVI,kvrocks,1210529096,769,NA,w4096,7794103,WangYu,wangyu4096@gmail.com,NA,2022-08-10T11:15:12Z,2022-08-10T11:15:12Z,@liangyuanpeng   kvrocks doesn't support keyspace notify yet. ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IJzVI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/769,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IJ--a,kvrocks,1210576794,769,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-10T12:02:14Z,2022-08-10T12:02:14Z,"> @liangyuanpeng kvrocks doesn't support keyspace notify yet.

It should be NOT easy to implement this feature for Kvrocks since
its data are kept in disk, so we have no way to figure out which entries
are expired except scanning the DB.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IJ--a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/769,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFMqo,kvrocks,1242876584,769,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T03:20:37Z,2022-09-11T03:20:37Z,Closed as no clear plan and the author doesn't propose a design.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFMqo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/770,https://api.github.com/repos/apache/kvrocks/issues/770,kvrocks,1328635742,770,"[BUG] forbidden to create namespace ""__namespace""",mathspanda,8100956,mathspanda,mathspanda826@gmail.com,CLOSED,2022-08-04T13:28:48Z,2022-08-07T15:44:35Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

341a989d75783d8dad76bbd5a4473dd345472337

### Minimal reproduce step

```
./redis-cli -p 6666
127.0.0.1:6666> auth XXX
OK
127.0.0.1:6666> namespace add ns1 token1
OK
127.0.0.1:6666> namespace add ns2 token2
OK
127.0.0.1:6666> namespace get *
1) ""ns1""
2) ""token1""
3) ""ns2""
4) ""token2""
127.0.0.1:6666> namespace add __namespace token3
OK
127.0.0.1:6666> namespace get *
1) ""ns1""
2) ""token1""
3) ""ns2""
4) ""token2""
5) ""__namespace""
6) ""token3""
```

### What did you expect to see?

1. Forbidden to create namespace ""__namespace""
2. Add default namespace ""__namespace"" into the results of ""namespace get *""

### What did you see instead?

Pls See `Minimal reproduce step`

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/770/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/770,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5H1xAH,kvrocks,1205276679,770,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-04T13:42:45Z,2022-08-04T13:42:45Z,@mathspanda good catch,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5H1xAH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/770,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5H9_05,kvrocks,1207434553,770,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-07T15:44:35Z,2022-08-07T15:44:35Z,closed by #772 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5H9_05/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/774,https://api.github.com/repos/apache/kvrocks/issues/774,kvrocks,1333712722,774,cmake version validation is broken,druban,35857466,,,CLOSED,2022-08-09T19:48:20Z,2022-08-09T19:52:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable, 8ffdfaf2d5caf73977a9855066d7e06ecc93c76f

### Minimal reproduce step

% ./x.py build
Traceback (most recent call last):
  File ""./x.py"", line 312, in <module>
    args.func(**arg_dict)
  File ""./x.py"", line 95, in build
    check_version(cmake_version, CMAKE_REQUIRE_VERSION, ""CMake"")
  File ""./x.py"", line 80, in check_version
    raise RuntimeError(f""{prog_name} {require_version} or higher is required, got: {current}"")
RuntimeError: CMake 3.13.0 or higher is required, got: 3.22.2

..
% 

### What did you expect to see?

cmake 3.22.2 should be accepted

### What did you see instead?

cmake 3.22.2 was rejected

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/774/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/774,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IHDzK,kvrocks,1209810122,774,NA,druban,35857466,,,NA,2022-08-09T19:52:54Z,2022-08-09T19:52:54Z,Sorry for the false alarm. Issue seems to be addressed already.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5IHDzK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/776,https://api.github.com/repos/apache/kvrocks/issues/776,kvrocks,1337164020,776,Report a failure fast if `CMAKE_OSX_DEPLOYMENT_TARGET` unset on MacOS,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-08-12T12:46:27Z,2022-09-10T04:48:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

See also https://github.com/apache/incubator-kvrocks/commit/341a989d75783d8dad76bbd5a4473dd345472337#r80998035.

cc @PragmaTwice @xiaobiaozhao 

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/776/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/776,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7BFc,kvrocks,1240207708,776,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-08T04:35:38Z,2022-09-08T04:35:38Z,"Hi. I am using MacBook M1. According to https://github.com/apache/incubator-kvrocks/commit/341a989d75783d8dad76bbd5a4473dd345472337#r80998035, If I replace `${CMAKE_OSX_DEPLOYMENT_TARGET}` with `11.0`, The compilation can be successful. I am not very familiar with cmake. Do you have time to repair it? I noticed that you don't have an apple device to test. I can compile and test for you. @PragmaTwice ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7BFc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/776,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7DTs,kvrocks,1240216812,776,NA,PragmaTwice,20042607,Twice,,NA,2022-09-08T04:51:00Z,2022-09-08T04:51:00Z,"> Hi. I am using MacBook M1. According to [341a989#r80998035](https://github.com/apache/incubator-kvrocks/commit/341a989d75783d8dad76bbd5a4473dd345472337#r80998035), If I replace `${CMAKE_OSX_DEPLOYMENT_TARGET}` with `11.0`, The compilation can be successful. I am not very familiar with cmake. Do you have time to repair it? I noticed that you don't have an apple device to test. I can compile and test for you. @PragmaTwice

Hi @tanruixiang, actually you can directly pass the option to cmake, e.g. `cmake -DCMAKE_OSX_DEPLOYMENT_TARGET=10.3 ..`, `MACOSX_DEPLOYMENT_TARGET=10.3 cmake ..` or `./x.py build  -DCMAKE_OSX_DEPLOYMENT_TARGET=10.3` rather than modifying cmake files.

If you want to try to fix this problem, you can add an `if ... else ...` to CMakeLists, i.e. when it is currently in macos and `CMAKE_OSX_DEPLOYMENT_TARGET` is not configured, an error should be reported and the user will be reminded to configure it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7DTs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/776,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7L9W,kvrocks,1240252246,776,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-08T05:52:11Z,2022-09-08T05:52:11Z,"> > Hi. I am using MacBook M1. According to [341a989#r80998035](https://github.com/apache/incubator-kvrocks/commit/341a989d75783d8dad76bbd5a4473dd345472337#r80998035), If I replace `${CMAKE_OSX_DEPLOYMENT_TARGET}` with `11.0`, The compilation can be successful. I am not very familiar with cmake. Do you have time to repair it? I noticed that you don't have an apple device to test. I can compile and test for you. @PragmaTwice
> 
> Hi @tanruixiang, actually you can directly pass the option to cmake, e.g. `cmake -DCMAKE_OSX_DEPLOYMENT_TARGET=10.3 ..`, `MACOSX_DEPLOYMENT_TARGET=10.3 cmake ..` or `./x.py build -DCMAKE_OSX_DEPLOYMENT_TARGET=10.3` rather than modifying cmake files.
> 
> If you want to try to fix this problem, you can add an `if ... else ...` to CMakeLists, i.e. when it is currently in macos and `CMAKE_OSX_DEPLOYMENT_TARGET` is not configured, an error should be reported and the user will be reminded to configure it.

The current error report is like this `Makefile:320: *** missing: export MACOSX_DEPLOYMENT_TARGET=XX.YY.  Stop.`
As a new user, I will be a little confused about this error report. Can we update readme and note that MacOS needs to use the command you gave? Or if `MACOSX_DEPLOYMENT_TARGET` does not exist, give a default value(like 11.0 before).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7L9W/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/776,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7SrY,kvrocks,1240279768,776,NA,PragmaTwice,20042607,Twice,,NA,2022-09-08T06:27:55Z,2022-09-08T06:27:55Z,"My current plan was narrated above:
> If you want to try to fix this problem, you can add an if ... else ... to CMakeLists, i.e. when it is currently in macos and CMAKE_OSX_DEPLOYMENT_TARGET is not configured, an error should be reported and the user will be reminded to configure it.

If you want to specify a default value, maybe you need to investigate how to specify a valid (and proper) default value for various macos version (10.x, 11, ...) that mac users are currently using, e.g. if you specify 11.0 then you need to know the behavior when macos10 users build the repo.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7SrY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/776,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7T79,kvrocks,1240284925,776,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-08T06:34:34Z,2022-09-08T06:34:34Z,"I also found this issue on M1, but I'm wondering if we should make the LuaJIT as our default Lua VM. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J7T79/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/776,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9ksu,kvrocks,1240877870,776,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-08T15:29:51Z,2022-09-08T15:29:51Z,"@PragmaTwice @git-hulk Thank you for your reply. Do you think we need to indicate in readme that MacOS needs to use the instructions @PragmaTwice  provide?
Let me share my thoughts as a new user. When I encountered a compilation error on MacOS, I gave up using MacOS directly. The docker installation Ubuntu image is used instead. If there is a MacOS build version in readme, I think I can use it more happily.
```
$ git clone https://github.com/apache/incubator-kvrocks.git
$ cd incubator-kvrocks
$ ./x.py build # `./x.py build -h` to check more options;
               # especially, `./x.py build --ghproxy` will fetch dependencies via ghproxy.com.
# macOS 
./x.py build -DCMAKE_OSX_DEPLOYMENT_TARGET = Appropriate version
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9ksu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/776,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KEP-P,kvrocks,1242627983,776,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-10T04:48:29Z,2022-09-10T04:48:29Z,Thanks for your contribution and fixing this issue :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KEP-P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/777,https://api.github.com/repos/apache/kvrocks/issues/777,kvrocks,1338272541,777,Group each redis command by data structures,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-08-14T15:04:05Z,2023-08-16T06:51:49Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As @caipengbo mentioned at https://github.com/apache/incubator-kvrocks/pull/745#issuecomment-1214174446, `redis_command.cc` is too long and it'll be NOT easy to maintain if we keep adding more commands.

### Solution

We can separate commands into each data structure file. For example, move all hash-related commands into `redis_hash.cc`, and so on.

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/777/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/783,https://api.github.com/repos/apache/kvrocks/issues/783,kvrocks,1345521896,783,Expose some stats in RocksDB Perf Context and IO Stats Context ,mathspanda,8100956,mathspanda,mathspanda826@gmail.com,CLOSED,2022-08-21T15:43:15Z,2024-01-02T15:51:03Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Stats in Perf Context or IO Stat Context are useful to pinpoint some performance issues of redis commands.
For example, Counters `internal_delete_skipped_count` could illustrate why `zrangebyscore`  is so slow if there is too many tombstones.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/783/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I0w6t,kvrocks,1221791405,783,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-22T04:20:14Z,2022-08-22T04:20:14Z,"@mathspanda Thanks for your report, `internal_delete_skipped_count ` makes a lot sense, would you like to contribute it?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I0w6t/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s3HOA,kvrocks,1826386816,783,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-11-25T17:53:32Z,2023-11-25T17:53:32Z,"Hi @git-hulk , if nobody is working on this, can I take over?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s3HOA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s3H-2,kvrocks,1826389942,783,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-25T18:10:26Z,2023-11-25T18:10:26Z,@chrisxu333 Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s3H-2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s4d6N,kvrocks,1826741901,783,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-11-26T10:09:22Z,2023-11-26T10:09:22Z,"https://github.com/apache/kvrocks/pull/1902

As mentioned here, maybe compaction-cpu-time can also be added here.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s4d6N/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s4zoV,kvrocks,1826830869,783,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-11-26T16:39:20Z,2023-11-26T16:39:20Z,"@git-hulk As I'm thinking, this exposure of rocksdb perf and io stats would incur additional costs, so we maybe need a toggle to control it? Also what would be the proper way of displaying such stats, I'm thinking include them inside the result of info command?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s4zoV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s8cQt,kvrocks,1827783725,783,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-27T12:56:27Z,2023-11-27T12:56:27Z,"Hi @chrisxu333 

Yes, I didn't think through this issue. It's not only about how to display the information but also how to collect that perf information since we don't enable them by default.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s8cQt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s9fo0,kvrocks,1828059700,783,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-11-27T15:30:32Z,2023-11-27T15:30:32Z,"> Hi @chrisxu333
> 
> Yes, I didn't think through this issue. It's not only about how to display the information but also how to collect that perf information since we don't enable them by default.

Sounds good I'll try to figure out a design :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s9fo0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6K0X,kvrocks,1860742423,783,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-12-18T15:03:57Z,2023-12-18T15:03:57Z,"Hi @git-hulk and @PragmaTwice , I've opened a pr for this issue. Please help review :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6K0X/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/784,https://api.github.com/repos/apache/kvrocks/issues/784,kvrocks,1345849580,784,Use failure signal handler in glog,PragmaTwice,20042607,Twice,,CLOSED,2022-08-22T05:44:39Z,2022-08-31T15:00:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We can use signal handle in glog, refer to https://github.com/google/glog#failure-signal-handler, instead of currently hand-written one.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/784/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/784,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jfuyu,kvrocks,1233054894,784,NA,PragmaTwice,20042607,Twice,,NA,2022-08-31T15:00:26Z,2022-08-31T15:00:26Z,remitted in #796,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jfuyu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/785,https://api.github.com/repos/apache/kvrocks/issues/785,kvrocks,1345934619,785,Kvrocks 2.1 build failed On CentOS 7.8 x86_64,corningsun,11749559,Corning Sun,corningsun@163.com,CLOSED,2022-08-22T07:16:36Z,2022-08-22T08:19:58Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

V2.1

`git clone git@github.com:apache/incubator-kvrocks.git -b 2.1`

### Minimal reproduce step

# upgrade cmake2 to cmake3
yum remove cmake -y
wget https://cmake.org/files/v3.24/cmake-3.24.0-linux-x86_64.tar.gz
tar -zxvf cmake-3.24.1.tar.gz
cd cmake-3.24.1
yum install -y openssl-devel
./configure --prefix=/usr/local/cmake
make && make install
ln -s /usr/local/cmake/bin/cmake /usr/bin/cmake
cmake -version

# build kvrocks 2.1
git clone git@github.com:apache/incubator-kvrocks.git -b 2.1
cd incubator-kvrocks/
yum install -y epel-release
yum install -y git gcc gcc-c++ make cmake autoconf automake libtool which
yum install -y libunwind-devel

nohup ./x.py build --ghproxy > build.log 2>&1 &

### What did you expect to see?

build success

### What did you see instead?

* build.log

```
nohup: ignoring input
CMake Warning (dev) at /usr/local/cmake/share/cmake-3.24/Modules/FetchContent.cmake:1264 (message):
  The DOWNLOAD_EXTRACT_TIMESTAMP option was not given and policy CMP0135 is
  not set.  The policy's OLD behavior will be used.  When using a URL
  download, the timestamps of extracted files should preferably be that of
  the time of extraction, otherwise code that depends on the extracted
  contents might not be rebuilt if the URL changes.  The OLD behavior
  preserves the timestamps from the archive instead, but this is usually not
  what you want.  Update your project to the NEW behavior or specify the
  DOWNLOAD_EXTRACT_TIMESTAMP option with a value of true to avoid this
  robustness issue.
Call Stack (most recent call first):
  cmake/utils.cmake:48 (FetchContent_Declare)
  cmake/utils.cmake:55 (FetchContent_DeclareWithMirror)
  cmake/jemalloc.cmake:22 (FetchContent_DeclareGitHubWithMirror)
  CMakeLists.txt:50 (include)
This warning is for project developers.  Use -Wno-dev to suppress it.

configure: loading cache config.cache
configure: error: `CC' has changed since the previous run:
configure:   former value:  `'
configure:   current value: `/usr/bin/cc'
configure: error: `CXX' was set to `/usr/bin/c++' in the previous run
configure: error: in `/root/incubator-kvrocks/build/_deps/jemalloc-build':
configure: error: changes in the environment can compromise the build
configure: error: run `make distclean' and/or `rm config.cache' and start over
CMake Warning (dev) at /usr/local/cmake/share/cmake-3.24/Modules/FetchContent.cmake:1264 (message):
  The DOWNLOAD_EXTRACT_TIMESTAMP option was not given and policy CMP0135 is
  not set.  The policy's OLD behavior will be used.  When using a URL
  download, the timestamps of extracted files should preferably be that of
  the time of extraction, otherwise code that depends on the extracted
  contents might not be rebuilt if the URL changes.  The OLD behavior
  preserves the timestamps from the archive instead, but this is usually not
  what you want.  Update your project to the NEW behavior or specify the
  DOWNLOAD_EXTRACT_TIMESTAMP option with a value of true to avoid this
  robustness issue.
Call Stack (most recent call first):
  cmake/utils.cmake:48 (FetchContent_Declare)
  cmake/utils.cmake:55 (FetchContent_DeclareWithMirror)
  cmake/gtest.cmake:22 (FetchContent_DeclareGitHubWithMirror)
  CMakeLists.txt:56 (include)
This warning is for project developers.  Use -Wno-dev to suppress it.

CMake Warning (dev) at /usr/local/cmake/share/cmake-3.24/Modules/FetchContent.cmake:1264 (message):
  The DOWNLOAD_EXTRACT_TIMESTAMP option was not given and policy CMP0135 is
  not set.  The policy's OLD behavior will be used.  When using a URL
  download, the timestamps of extracted files should preferably be that of
  the time of extraction, otherwise code that depends on the extracted
  contents might not be rebuilt if the URL changes.  The OLD behavior
  preserves the timestamps from the archive instead, but this is usually not
  what you want.  Update your project to the NEW behavior or specify the
  DOWNLOAD_EXTRACT_TIMESTAMP option with a value of true to avoid this
  robustness issue.
Call Stack (most recent call first):
  cmake/utils.cmake:48 (FetchContent_Declare)
  cmake/utils.cmake:55 (FetchContent_DeclareWithMirror)
  cmake/glog.cmake:22 (FetchContent_DeclareGitHubWithMirror)
  CMakeLists.txt:57 (include)
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Found Unwind: /usr/include (found version ""1.2"") 
CMake Warning (dev) at /usr/local/cmake/share/cmake-3.24/Modules/FetchContent.cmake:1264 (message):
  The DOWNLOAD_EXTRACT_TIMESTAMP option was not given and policy CMP0135 is
  not set.  The policy's OLD behavior will be used.  When using a URL
  download, the timestamps of extracted files should preferably be that of
  the time of extraction, otherwise code that depends on the extracted
  contents might not be rebuilt if the URL changes.  The OLD behavior
  preserves the timestamps from the archive instead, but this is usually not
  what you want.  Update your project to the NEW behavior or specify the
  DOWNLOAD_EXTRACT_TIMESTAMP option with a value of true to avoid this
  robustness issue.
Call Stack (most recent call first):
  cmake/utils.cmake:48 (FetchContent_Declare)
  cmake/utils.cmake:55 (FetchContent_DeclareWithMirror)
  cmake/snappy.cmake:22 (FetchContent_DeclareGitHubWithMirror)
  CMakeLists.txt:58 (include)
This warning is for project developers.  Use -Wno-dev to suppress it.

CMake Warning (dev) at /usr/local/cmake/share/cmake-3.24/Modules/FetchContent.cmake:1264 (message):
  The DOWNLOAD_EXTRACT_TIMESTAMP option was not given and policy CMP0135 is
  not set.  The policy's OLD behavior will be used.  When using a URL
  download, the timestamps of extracted files should preferably be that of
  the time of extraction, otherwise code that depends on the extracted
  contents might not be rebuilt if the URL changes.  The OLD behavior
  preserves the timestamps from the archive instead, but this is usually not
  what you want.  Update your project to the NEW behavior or specify the
  DOWNLOAD_EXTRACT_TIMESTAMP option with a value of true to avoid this
  robustness issue.
Call Stack (most recent call first):
  cmake/utils.cmake:48 (FetchContent_Declare)
  cmake/utils.cmake:55 (FetchContent_DeclareWithMirror)
  cmake/lz4.cmake:22 (FetchContent_DeclareGitHubWithMirror)
  CMakeLists.txt:59 (include)
This warning is for project developers.  Use -Wno-dev to suppress it.

CMake Warning (dev) at /usr/local/cmake/share/cmake-3.24/Modules/FetchContent.cmake:1264 (message):
  The DOWNLOAD_EXTRACT_TIMESTAMP option was not given and policy CMP0135 is
  not set.  The policy's OLD behavior will be used.  When using a URL
  download, the timestamps of extracted files should preferably be that of
  the time of extraction, otherwise code that depends on the extracted
  contents might not be rebuilt if the URL changes.  The OLD behavior
  preserves the timestamps from the archive instead, but this is usually not
  what you want.  Update your project to the NEW behavior or specify the
  DOWNLOAD_EXTRACT_TIMESTAMP option with a value of true to avoid this
  robustness issue.
Call Stack (most recent call first):
  cmake/utils.cmake:48 (FetchContent_Declare)
  cmake/utils.cmake:55 (FetchContent_DeclareWithMirror)
  cmake/rocksdb.cmake:28 (FetchContent_DeclareGitHubWithMirror)
  CMakeLists.txt:60 (include)
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Found JeMalloc in /root/incubator-kvrocks/build/_deps/jemalloc-src
-- Found Snappy in /root/incubator-kvrocks/build/_deps/snappy-src
-- Found lz4 in /root/incubator-kvrocks/build/_deps/lz4-src
-- Could NOT find uring (missing: uring_LIBRARIES uring_INCLUDE_DIR) 
-- Enabling RTTI
-- ROCKSDB_PLUGINS: 
-- JNI library is disabled
CMake Warning (dev) at /usr/local/cmake/share/cmake-3.24/Modules/FetchContent.cmake:1264 (message):
  The DOWNLOAD_EXTRACT_TIMESTAMP option was not given and policy CMP0135 is
  not set.  The policy's OLD behavior will be used.  When using a URL
  download, the timestamps of extracted files should preferably be that of
  the time of extraction, otherwise code that depends on the extracted
  contents might not be rebuilt if the URL changes.  The OLD behavior
  preserves the timestamps from the archive instead, but this is usually not
  what you want.  Update your project to the NEW behavior or specify the
  DOWNLOAD_EXTRACT_TIMESTAMP option with a value of true to avoid this
  robustness issue.
Call Stack (most recent call first):
  cmake/utils.cmake:48 (FetchContent_Declare)
  cmake/utils.cmake:55 (FetchContent_DeclareWithMirror)
  cmake/libevent.cmake:22 (FetchContent_DeclareGitHubWithMirror)
  CMakeLists.txt:61 (include)
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Found Git: /usr/bin/git  
CMake Warning at build/_deps/libevent-src/CMakeLists.txt:1492 (message):
  The doxygen target will not support since doxygen command was not found!


-- 
--         ---( Libevent 2.1.11-stable )---
-- 
-- Available event backends: 
-- CMAKE_BINARY_DIR:         /root/incubator-kvrocks/build
-- CMAKE_CURRENT_BINARY_DIR: /root/incubator-kvrocks/build/_deps/libevent-build
-- CMAKE_SOURCE_DIR:         /root/incubator-kvrocks
-- CMAKE_CURRENT_SOURCE_DIR: /root/incubator-kvrocks/build/_deps/libevent-src
-- PROJECT_BINARY_DIR:       /root/incubator-kvrocks/build/_deps/libevent-build
-- PROJECT_SOURCE_DIR:       /root/incubator-kvrocks/build/_deps/libevent-src
-- CMAKE_MODULE_PATH:        /root/incubator-kvrocks/build/_deps/libevent-src/cmake/
-- CMAKE_COMMAND:            /usr/local/cmake/bin/cmake
-- CMAKE_ROOT:               /usr/local/cmake/share/cmake-3.24
-- CMAKE_SYSTEM:             Linux-3.10.0-1127.19.1.el7.x86_64
-- CMAKE_SYSTEM_NAME:        Linux
-- CMAKE_SYSTEM_VERSION:     3.10.0-1127.19.1.el7.x86_64
-- CMAKE_SYSTEM_PROCESSOR:   x86_64
-- CMAKE_SKIP_RPATH:         NO
-- CMAKE_VERBOSE_MAKEFILE:   FALSE
-- CMAKE_C_FLAGS:             -Wall -Wextra -Wno-unused-parameter -Wstrict-aliasing -Wstrict-prototypes -fno-strict-aliasing -Wmissing-prototypes -Winit-self -Wmissing-field-initializers -Wdeclaration-after-statement -Waddress -Wnormalized=id -Woverride-init -Wlogical-op -Wwrite-strings
-- CMAKE_BUILD_TYPE:         RelWithDebInfo
-- CMAKE_C_COMPILER:         /usr/bin/cc (id GNU, clang 0, GNUC 1)
-- CMAKE_AR:                 /usr/bin/ar
-- CMAKE_RANLIB:             /usr/bin/ranlib
-- 
CMake Warning (dev) at /usr/local/cmake/share/cmake-3.24/Modules/FetchContent.cmake:1264 (message):
  The DOWNLOAD_EXTRACT_TIMESTAMP option was not given and policy CMP0135 is
  not set.  The policy's OLD behavior will be used.  When using a URL
  download, the timestamps of extracted files should preferably be that of
  the time of extraction, otherwise code that depends on the extracted
  contents might not be rebuilt if the URL changes.  The OLD behavior
  preserves the timestamps from the archive instead, but this is usually not
  what you want.  Update your project to the NEW behavior or specify the
  DOWNLOAD_EXTRACT_TIMESTAMP option with a value of true to avoid this
  robustness issue.
Call Stack (most recent call first):
  cmake/utils.cmake:48 (FetchContent_Declare)
  cmake/utils.cmake:55 (FetchContent_DeclareWithMirror)
  cmake/lua.cmake:22 (FetchContent_DeclareGitHubWithMirror)
  CMakeLists.txt:62 (include)
This warning is for project developers.  Use -Wno-dev to suppress it.

-- Found Git: /usr/bin/git (found version ""1.8.3.1"") 
CMake Error at CMakeLists.txt:91 (message):
  cannot find static library of libstdc++, please add
  ENABLE_STATIC_LIBSTDCXX=OFF to disable


-- Configuring incomplete, errors occurred!
See also ""/root/incubator-kvrocks/build/CMakeFiles/CMakeOutput.log"".
See also ""/root/incubator-kvrocks/build/CMakeFiles/CMakeError.log"".
Traceback (most recent call last):
  File ""./x.py"", line 221, in <module>
    args.func(args)
  File ""./x.py"", line 105, in build
    run([cmake, basedir, *cmake_options])
  File ""./x.py"", line 60, in run
    raise RuntimeError(err)
RuntimeError: 
failed to run: ['/usr/bin/cmake', PosixPath('/root/incubator-kvrocks'), '-DCMAKE_BUILD_TYPE=RelWithDebInfo', '-DDEPS_FETCH_PROXY=https://ghproxy.com/']
exit with code: 1
error message: None

```

### Anything Else?

* CMakeError.log

```

Performing C SOURCE FILE Test EVENT__HAVE_STRUCT_SOCKADDR_IN_SIN_LEN failed with the following output:
Change Dir: /root/incubator-kvrocks/build/CMakeFiles/CMakeTmp

Run Build Command(s):/usr/bin/gmake -f Makefile cmTC_4b3e1/fast && /usr/bin/gmake  -f CMakeFiles/cmTC_4b3e1.dir/build.make CMakeFiles/cmTC_4b3e1.dir/build
gmake[1]: Entering directory `/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp'
Building C object CMakeFiles/cmTC_4b3e1.dir/src.c.o
/usr/bin/cc -DEVENT__HAVE_STRUCT_SOCKADDR_IN_SIN_LEN  -Wall -Wextra -Wno-unused-parameter -Wstrict-aliasing -Wstrict-prototypes -fno-strict-aliasing -Wmissing-prototypes -Winit-self -Wmissing-field-initializers -Wdeclaration-after-statement -Waddress -Wnormalized=id -Woverride-init -Wlogical-op -Wwrite-strings  -o CMakeFiles/cmTC_4b3e1.dir/src.c.o -c /root/incubator-kvrocks/build/CMakeFiles/CMakeTmp/src.c
/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp/src.c:6:5: warning: function declaration isn’t a prototype [-Wstrict-prototypes]
 int main()
     ^
/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp/src.c: In function ‘main’:
/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp/src.c:8:42: error: ‘struct sockaddr_in6’ has no member named ‘sin_len’
   (void)sizeof(((struct sockaddr_in6 *)0)->sin_len);
                                          ^
gmake[1]: *** [CMakeFiles/cmTC_4b3e1.dir/src.c.o] Error 1
gmake[1]: Leaving directory `/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp'
gmake: *** [cmTC_4b3e1/fast] Error 2


Source file was:

#include <netinet/in.h>
#include <sys/socket.h>
#include <netdb.h>

int main()
{
  (void)sizeof(((struct sockaddr_in6 *)0)->sin_len);
  return 0;
}

Performing C SOURCE FILE Test EVENT__HAVE_STRUCT_SOCKADDR_STORAGE___SS_FAMILY failed with the following output:
Change Dir: /root/incubator-kvrocks/build/CMakeFiles/CMakeTmp

Run Build Command(s):/usr/bin/gmake -f Makefile cmTC_fa186/fast && /usr/bin/gmake  -f CMakeFiles/cmTC_fa186.dir/build.make CMakeFiles/cmTC_fa186.dir/build
gmake[1]: Entering directory `/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp'
Building C object CMakeFiles/cmTC_fa186.dir/src.c.o
/usr/bin/cc -DEVENT__HAVE_STRUCT_SOCKADDR_STORAGE___SS_FAMILY  -Wall -Wextra -Wno-unused-parameter -Wstrict-aliasing -Wstrict-prototypes -fno-strict-aliasing -Wmissing-prototypes -Winit-self -Wmissing-field-initializers -Wdeclaration-after-statement -Waddress -Wnormalized=id -Woverride-init -Wlogical-op -Wwrite-strings  -o CMakeFiles/cmTC_fa186.dir/src.c.o -c /root/incubator-kvrocks/build/CMakeFiles/CMakeTmp/src.c
/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp/src.c:6:5: warning: function declaration isn’t a prototype [-Wstrict-prototypes]
 int main()
     ^
/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp/src.c: In function ‘main’:
/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp/src.c:8:46: error: ‘struct sockaddr_storage’ has no member named ‘__ss_family’
   (void)sizeof(((struct sockaddr_storage *)0)->__ss_family);
                                              ^
gmake[1]: *** [CMakeFiles/cmTC_fa186.dir/src.c.o] Error 1
gmake[1]: Leaving directory `/root/incubator-kvrocks/build/CMakeFiles/CMakeTmp'
gmake: *** [cmTC_fa186/fast] Error 2


Source file was:

#include <netinet/in.h>
#include <sys/socket.h>
#include <netdb.h>

int main()
{
  (void)sizeof(((struct sockaddr_storage *)0)->__ss_family);
  return 0;
}
```

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/785/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/785,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I1Ytm,kvrocks,1221954406,785,NA,PragmaTwice,20042607,Twice,,NA,2022-08-22T07:22:17Z,2022-08-22T07:22:17Z,"Hi @corningsun , thanks for your report.

Could you try `yum install libstdc++-static` and rerun the script?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I1Ytm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/785,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I1a-8,kvrocks,1221963708,785,NA,corningsun,11749559,Corning Sun,corningsun@163.com,NA,2022-08-22T07:31:52Z,2022-08-22T07:31:52Z,"> Hi @corningsun , thanks for your report.
> 
> Could you try `yum install libstdc++-static` and rerun the script?

ok, i'll try it","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I1a-8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/785,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I1nK_,kvrocks,1222013631,785,NA,corningsun,11749559,Corning Sun,corningsun@163.com,NA,2022-08-22T08:19:57Z,2022-08-22T08:19:57Z,"Thanks a lot, It's OK for me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I1nK_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/788,kvrocks,1347661853,788,ERR Corruption: Corrupted compressed block contents: Snappy,corningsun,11749559,Corning Sun,corningsun@163.com,CLOSED,2022-08-23T09:54:09Z,2022-08-25T11:42:15Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.1

### Minimal reproduce step

1 build kvrocks with branch 2.1

2 start kvrocks cluster (One Master)

3 set cluster nodes

```
CLUSTERX SETNODEID kvrockskvrockskvrockskvrocksstgnodeid001
CLUSTERX SETNODES ""kvrockskvrockskvrockskvrocksstgnodeid001 127.0.0.1 6666 master - 0-16383"" 1
```

4 put random key and value to redis

eg: use jedis client。

 I have test other ways like [RedisShake](https://github.com/alibaba/RedisShake) and got the same error.

```java
package com.corning.kvrocks;

import org.apache.commons.lang3.RandomStringUtils;
import redis.clients.jedis.HostAndPort;
import redis.clients.jedis.JedisCluster;

import java.util.HashSet;
import java.util.Set;
import java.util.concurrent.atomic.AtomicInteger;

public class KvrocksTest {

    private static final AtomicInteger threadNum = new AtomicInteger(0);

    public static void main(String[] args) {
        int keyNum = Integer.parseInt(args[0]);
        System.out.println(""keyNum="" + keyNum);

        int thread = args.length == 1 ? 1 : Integer.parseInt(args[1]);
        System.out.println(""thread="" + thread);

        for (int i = 0; i < thread; i++) {
            new Thread(() -> startInsert(keyNum / thread)).start();
        }
    }

    private static void startInsert(int keyNum) {
        final int threadId = threadNum.getAndIncrement();
        System.out.printf(""thread-%s: insertStart, keyNum=%s\n"", threadId, keyNum);

        String pwd = ""pwd"";
        String host = ""127.0.0.1"";
        int port = 6666;
        long seconds = 60 * 60 * 24;

        Set<HostAndPort> nodes = new HashSet<>();
        nodes.add(new HostAndPort(host, port));

        try (JedisCluster cluster = new JedisCluster(nodes, null, pwd)) {
            for (int i = 0; i < keyNum; i++) {
                String key = ""LOCAL_"" + RandomStringUtils.randomAlphanumeric(1, 50);
                String value = RandomStringUtils.randomAlphanumeric(1, 100);
                cluster.setex(key, seconds, value);
            }
        }
        System.out.printf(""thread-%s: insertEnd, keyNum=%s\n"", threadId, keyNum);
    }

}

```

`nohup java -jar kvorcks-test-1.0-SNAPSHOT.jar 10000000 10 > test.log 2>&1 &`



### What did you expect to see?

put all 10,000,000 random key/value to redis success

### What did you see instead?

run well at first, bu after set about 4,000,000 keys, then set any key to redis will got ERROR

`(error) ERR Corruption: Corrupted compressed block contents: Snappy`

* log of redis-cli 

```
redis-cli -h 127.0.0.1 -p 6666
127.0.0.1:6666> get a
""cTesZxX72jU1KkUoXCOejE5OKL6lTX0xXxK74ML3BTpahXzB3JDjr4I7KSrdIqz""
127.0.0.1:6666 set a 1
(error) ERR Corruption: Corrupted compressed block contents: Snappy
127.0.0.1:6666> set b 1
(error) ERR Corruption: Corrupted compressed block contents: Snappy
127.0.0.1:6666> get b
""WQz33uQAaMXhDMaNfyb7yk4ka0UtXO4DLqiR3oci0jnIQYCWxFXDOjLSfn2ynDDgabioA9mWJkOpuGgkxG""
127.0.0.1:6666> ttl b
(integer) 83826
```


* log of `kvrocks.INFO` file

```
I20220823 16:56:35.059758  3087 event_listener.cc:145] [event_listener/table_file_created] column family: metadata, file path: /opt/kvrocks/incubator-kvrocks/data/db/000020.sst, file size: 88686084, job id: 4, reason: flush, status: OK
I20220823 16:56:35.066828  3087 event_listener.cc:93] [event_listener/flush_completed] column family: metadata, thread_id: 140259820037888, job_id: 4, file: /opt/kvrocks/incubator-kvrocks/data/db/000020.sst, reason: 6, is_write_slowdown: no, is_write_stall: no, largest seqno: 1937914, smallest seqno: 974572
I20220823 16:59:47.759503  3090 event_listener.cc:85] [event_listener/flush_begin] column family: metadata, thread_id: 140259776001792, job_id: 5, reason: 6
I20220823 16:59:48.534060  3090 event_listener.cc:145] [event_listener/table_file_created] column family: metadata, file path: /opt/kvrocks/incubator-kvrocks/data/db/000023.sst, file size: 85550996, job id: 5, reason: flush, status: OK
I20220823 16:59:48.541939  3090 event_listener.cc:93] [event_listener/flush_completed] column family: metadata, thread_id: 140259776001792, job_id: 5, file: /opt/kvrocks/incubator-kvrocks/data/db/000023.sst, reason: 6, is_write_slowdown: no, is_write_stall: no, largest seqno: 2866819, smallest seqno: 1937915
I20220823 17:02:58.819249  3088 event_listener.cc:85] [event_listener/flush_begin] column family: metadata, thread_id: 140259805361920, job_id: 6, reason: 6
I20220823 17:02:59.652449  3088 event_listener.cc:145] [event_listener/table_file_created] column family: metadata, file path: /opt/kvrocks/incubator-kvrocks/data/db/000026.sst, file size: 84559171, job id: 6, reason: flush, status: OK
I20220823 17:02:59.666702  3088 event_listener.cc:93] [event_listener/flush_completed] column family: metadata, thread_id: 140259805361920, job_id: 6, file: /opt/kvrocks/incubator-kvrocks/data/db/000026.sst, reason: 6, is_write_slowdown: no, is_write_stall: no, largest seqno: 3785962, smallest seqno: 2866820
I20220823 17:03:01.341382  3083 event_listener.cc:145] [event_listener/table_file_created] column family: metadata, file path: /opt/kvrocks/incubator-kvrocks/data/db/000027.sst, file size: 136316402, job id: 7, reason: compaction, status: OK
I20220823 17:03:03.065637  3083 event_listener.cc:145] [event_listener/table_file_created] column family: metadata, file path: /opt/kvrocks/incubator-kvrocks/data/db/000028.sst, file size: 136303910, job id: 7, reason: compaction, status: OK
I20220823 17:03:04.008123  3083 event_listener.cc:145] [event_listener/table_file_created] column family: metadata, file path: /opt/kvrocks/incubator-kvrocks/data/db/000029.sst, file size: 72948978, job id: 7, reason: compaction, status: OK
I20220823 17:03:04.030848  3083 event_listener.cc:71] [event_listener/compaction_completed] column family: metadata, compaction reason: 1, output compression type: no, base input level(files): 0(4), output level(files): 1(3), input bytes: 348430487, output bytes:345569290, is_manual_compaction:no, elapsed(micro): 4341217
I20220823 17:03:04.047273  3083 event_listener.cc:132] [event_listener/table_file_deleted] db: /opt/kvrocks/incubator-kvrocks/data/db, sst file: /opt/kvrocks/incubator-kvrocks/data/db/000026.sst, status: OK
I20220823 17:03:04.063731  3083 event_listener.cc:132] [event_listener/table_file_deleted] db: /opt/kvrocks/incubator-kvrocks/data/db, sst file: /opt/kvrocks/incubator-kvrocks/data/db/000023.sst, status: OK
I20220823 17:03:04.080839  3083 event_listener.cc:132] [event_listener/table_file_deleted] db: /opt/kvrocks/incubator-kvrocks/data/db, sst file: /opt/kvrocks/incubator-kvrocks/data/db/000020.sst, status: OK
I20220823 17:03:04.092478  3083 event_listener.cc:132] [event_listener/table_file_deleted] db: /opt/kvrocks/incubator-kvrocks/data/db, sst file: /opt/kvrocks/incubator-kvrocks/data/db/000017.sst, status: OK
I20220823 17:03:06.037737  3083 event_listener.cc:145] [event_listener/table_file_created] column family: metadata, file path: /opt/kvrocks/incubator-kvrocks/data/db/000030.sst, file size: 136221198, job id: 8, reason: compaction, status: OK
I20220823 17:03:06.041982  3083 event_listener.cc:71] [event_listener/compaction_completed] column family: metadata, compaction reason: 2, output compression type: snappy, base input level(files): 1(1), output level(files): 2(0), input bytes: 136316402, output bytes:136221198, is_manual_compaction:no, elapsed(micro): 1945242
E20220823 17:03:06.042018  3083 event_listener.cc:127] [event_listener/background_error] reason: compact, bg_error: Corruption: Corrupted compressed block contents: Snappy
I20220823 17:03:07.067961  3083 event_listener.cc:132] [event_listener/table_file_deleted] db: /opt/kvrocks/incubator-kvrocks/data/db, sst file: /opt/kvrocks/incubator-kvrocks/data/db/000030.sst, status: OK
```




### Anything Else?


* server info

CentOS Linux release 7.9.2009 (Core)
Linux version 3.10.0-1127.19.1.el7.x86_64 (mockbuild@kbuilder.bsys.centos.org) (gcc version 4.8.5 20150623 (Red Hat 4.8.5-39) (GCC) ) #1 SMP Tue Aug 25 17:23:54 UTC 2020



### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/788/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8qBF,kvrocks,1223860293,788,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-23T10:15:12Z,2022-08-23T10:15:12Z,"@corningsun Thanks for your feedback.

This issue looks like the same with https://github.com/apache/incubator-kvrocks/issues/607, you can have a try at installing snappy. But I think it should a bug even it works after installing  the snappy since we expected to static link the snappy.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8qBF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8rZQ,kvrocks,1223865936,788,NA,corningsun,11749559,Corning Sun,corningsun@163.com,NA,2022-08-23T10:20:35Z,2022-08-23T10:20:35Z,"> It's not work for me, snappy already installed

[root@VM-24-10-centos ~]# yum install snappy
Loaded plugins: fastestmirror, langpacks
Repository epel is listed more than once in the configuration
Loading mirror speeds from cached hostfile
Package snappy-1.1.0-3.el7.x86_64 already installed and latest version
Nothing to do","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8rZQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8sfW,kvrocks,1223870422,788,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-23T10:24:54Z,2022-08-23T10:24:54Z,"@corningsun Can you paste the output of `ldd ./kvrocks`? I want to check whether Kvrocks dynamic linked the snappy library.

And output like below was expected:
```
root@39c518410166:/kvrocks# ldd bin/kvrocks
	linux-vdso.so.1 (0x00007ffdd551d000)
	libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f9fbd8a6000)
	libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f9fbd883000)
	libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f9fbd734000)
	libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f9fbd542000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f9fbe4f7000)
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8sfW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8s6c,kvrocks,1223872156,788,NA,corningsun,11749559,Corning Sun,corningsun@163.com,NA,2022-08-23T10:26:34Z,2022-08-23T10:26:34Z,"[root@VM-24-10-centos build]# ldd ./kvrocks
	linux-vdso.so.1 =>  (0x00007ffc679a3000)
	librt.so.1 => /lib64/librt.so.1 (0x00007f5fe0c3d000)
	libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f5fe0a21000)
	libunwind.so.8 => /lib64/libunwind.so.8 (0x00007f5fe0807000)
	libm.so.6 => /lib64/libm.so.6 (0x00007f5fe0505000)
	libc.so.6 => /lib64/libc.so.6 (0x00007f5fe0137000)
	/lib64/ld-linux-x86-64.so.2 (0x00007f5fe0e45000)
	libgcc_s.so.1 => /lib64/libgcc_s.so.1 (0x00007f5fdff21000)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8s6c/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8zjQ,kvrocks,1223899344,788,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-23T10:54:45Z,2022-08-23T10:54:45Z,"hmmmm, I don't know why it happens and need to reproduce on my side later. You can try to uninstall the snappy library and rebuild the source from scratch again.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I8zjQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I9oW-,kvrocks,1224115646,788,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-23T13:57:31Z,2022-08-23T13:57:31Z,"@corningsun I can reproduce it on CentOS 7 but need more time to investigate the root cause. You can workaround by switching `rocksdb.compression` to lz4 in kvrocks.conf, I tried the `lz4` and it works well.

BTW: @PragmaTwice I'm not sure whether current snappy library has any difference with old cmake way, can help me out if you have any clues. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I9oW-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I_So5,kvrocks,1224550969,788,NA,PragmaTwice,20042607,Twice,,NA,2022-08-23T18:25:23Z,2022-08-23T18:25:23Z,"Currently no, but I will try to reproduce it and see what happened.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5I_So5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JBUlh,kvrocks,1225083233,788,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-24T01:58:51Z,2022-08-24T01:58:51Z,"Thanks @PragmaTwice, I used the `redis-benchmark -p 6666 -t set -d 102400 -r 100000000 -n 10000000` command to reproduce this on CentOS7. It happens after compacting into level 2 which will use the snappy compression, to fast reproduce that we can remove the `if` condition https://github.com/apache/incubator-kvrocks/blob/unstable/src/storage.cc#L144","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JBUlh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JCIWm,kvrocks,1225295270,788,NA,corningsun,11749559,Corning Sun,corningsun@163.com,NA,2022-08-24T07:14:32Z,2022-08-24T07:14:32Z,"> @corningsun I can reproduce it on CentOS 7 but need more time to investigate the root cause. You can workaround by switching `rocksdb.compression` to lz4 in kvrocks.conf, I tried the `lz4` and it works well.
> 
> BTW: @PragmaTwice I'm not sure whether current snappy library has any difference with old cmake way, can help me out if you have any clues.

`rocksdb.compression lz4` is OK for me, Thanks for the answer.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JCIWm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JEZnG,kvrocks,1225890246,788,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-24T15:35:24Z,2022-08-24T15:35:24Z,"@corningsun I found it's caused by the newer version(v1.1.9) snappy didn't work right with RocksDB. I have submitted #790 to fix it but didn't have time to study and investigate what happens in the snappy library. You can also help to try and confirm this fix if you don't mind.

cc @PragmaTwice ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JEZnG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JIGD0,kvrocks,1226858740,788,NA,corningsun,11749559,Corning Sun,corningsun@163.com,NA,2022-08-25T07:03:15Z,2022-08-25T07:03:15Z,"> @corningsun I found it's caused by the newer version(v1.1.9) snappy didn't work right with RocksDB. I have submitted #790 to fix it but didn't have time to study and investigate what happens in the snappy library. You can also help to try and confirm this fix if you don't mind.
> 
> cc @PragmaTwice

@git-hulk snappy v1.1.7 works fine. 

With branch `revert-snappy-to-old-version`, I have had insert 52 Mil keys to kvrocks, everything is OK.

```
git clone git@github.com:git-hulk/incubator-kvrocks.git -b revert-snappy-to-old-version
```


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JIGD0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/788,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JIIa_,kvrocks,1226868415,788,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-25T07:14:19Z,2022-08-25T07:14:19Z,@corningsun Many thanks to your kind check.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JIIa_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/792,https://api.github.com/repos/apache/kvrocks/issues/792,kvrocks,1352398064,792,CMake error building on Fedora 35,torwig,8588372,Yaroslav,,CLOSED,2022-08-26T15:08:54Z,2022-09-01T10:36:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

Unstable branch: fac42b092810f7273385cd57e881c5e4b91e1158
OS: Fedora 35


### Minimal reproduce step

Clone repo.

mkdir build
cd build
cmake ../

### What did you expect to see?

No errors

### What did you see instead?

```
CMake Error at /usr/lib64/cmake/GTest/GTestTargets.cmake:37 (message):
  Some (but not all) targets in this export set were already defined.

  Targets Defined: GTest::gtest;GTest::gtest_main

  Targets not yet defined: GTest::gmock;GTest::gmock_main

Call Stack (most recent call first):
  /usr/lib64/cmake/GTest/GTestConfig.cmake:42 (include)
  /usr/share/cmake/Modules/FindGTest.cmake:187 (find_package)
  build/_deps/snappy-src/CMakeLists.txt:40 (find_package)
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/792/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/792,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JQqG9,kvrocks,1229103549,792,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-27T02:27:40Z,2022-08-27T02:27:40Z,Many thanks to @torwig. We can add the `Fedora` OS as well if you know how to do that. ❤️ ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JQqG9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/792,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JQ6Oy,kvrocks,1229169586,792,NA,torwig,8588372,Yaroslav,,NA,2022-08-27T10:47:25Z,2022-08-27T10:47:25Z,"@git-hulk I don't think that I know how to do that. I guess Fedora is very similar to Red Hat, so this issue is rather an exception than the rule, so maybe Fedora doesn't need a separate section/build/etc.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JQ6Oy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/792,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JQ-_S,kvrocks,1229189074,792,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-27T13:02:58Z,2022-08-27T13:02:58Z,"Thanks, @torwig.
Sorry that I didn't claim the context clearly. What I mean is we can run the build and test on Fedora to aware the similar build error in the future. Like we have done in Ubuntu/macOS with different modes in [GitHub Actions](https://github.com/apache/incubator-kvrocks/blob/unstable/.github/workflows/kvrocks.yaml). But I think it's ok to fix the build error only.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JQ-_S/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/792,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JjFi5,kvrocks,1233934521,792,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-01T08:30:50Z,2022-09-01T08:30:50Z,"Reproduced at Debian 11 too

`-- Looking for sysconf
-- Looking for sysconf - found
CMake Error at /usr/lib/x86_64-linux-gnu/cmake/GTest/GTestTargets.cmake:37 (message):
  Some (but not all) targets in this export set were already defined.

  Targets Defined: GTest::gtest;GTest::gtest_main

  Targets not yet defined: GTest::gmock;GTest::gmock_main

Call Stack (most recent call first):
  /usr/lib/x86_64-linux-gnu/cmake/GTest/GTestConfig.cmake:42 (include)
  /usr/local/share/cmake-3.24/Modules/FindGTest.cmake:194 (find_package)
  build/_deps/snappy-src/CMakeLists.txt:40 (find_package)
`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JjFi5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/794,https://api.github.com/repos/apache/kvrocks/issues/794,kvrocks,1353059268,794,Tracking issue for new command parsing framework,PragmaTwice,20042607,Twice,,CLOSED,2022-08-27T14:24:50Z,2023-06-16T13:24:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

In kvrocks, command parsing is currently done by some primitive array operations, which works fine for simple commands, but when command parsing rules become complex, the code becomes extremely difficult to understand and maintain. In addition, the parsing of data values such as numerics and enumerations is not well encapsulated.

This work was originally described in #598 to provide an easy-to-use parsing framework for parsing redis commands, especially complex redis commands. In addition, another goal of this work is to eliminate redundant string copies, which are currently widespread in kvrocks, and we will try to introduce something like `std::string_view` or design APIs that make better use of move semantics of `std::string`.

### Solution

working PRs:

- #768
- #787
- #1032
- #1218
- #1227

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/794/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/794,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JRsvi,kvrocks,1229376482,794,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-28T04:57:14Z,2022-08-28T04:57:14Z,Many thanks for @PragmaTwice bringing those awesome features to the community.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JRsvi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/795,https://api.github.com/repos/apache/kvrocks/issues/795,kvrocks,1353061594,795,Add more linux distro environments in GitHub Actions,PragmaTwice,20042607,Twice,,CLOSED,2022-08-27T14:34:53Z,2023-07-10T05:00:52Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As in https://docs.github.com/en/actions/using-jobs/running-jobs-in-a-container, we can use `jobs.<job_id>.container` to make all steps run on a specific docker image, like `centos` or others.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/795/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/795,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KMrJJ,kvrocks,1244836425,795,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-13T03:04:19Z,2022-09-13T03:04:19Z,@PragmaTwice the issue here is what distros are supported on GitHub Actions (public).,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KMrJJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/795,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KMsyl,kvrocks,1244843173,795,NA,PragmaTwice,20042607,Twice,,NA,2022-09-13T03:17:54Z,2022-09-13T03:17:54Z,"> @PragmaTwice the issue here is what distros are supported on GitHub Actions (public).

I think we can use images in docker hub, e.g.
```yaml
jobs:
  build:
    runs-on: ubuntu:latest
    container: centos:7 # `centos:7` image from docker hub
    steps:
      ... # commands running on centos docker container
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KMsyl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/798,https://api.github.com/repos/apache/kvrocks/issues/798,kvrocks,1353460073,798,Unit tests don't remove test directory,torwig,8588372,Yaroslav,,CLOSED,2022-08-28T20:25:20Z,2023-03-18T11:22:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

Kvrocks version: the latest unstable e4ae784a271b4d815eb3a015e27c6f6e296b3036
OS: Fedora 35


### Minimal reproduce step

Build and run unit tests by executing `./unittest`


### What did you expect to see?

Deletion of the `testdb` folder at the end of unit tests.


### What did you see instead?

Directory `testdb` exists, because `rmdir` function (https://github.com/apache/incubator-kvrocks/blob/unstable/tests/cppunit/test_base.h#L41) is unable to remove a non-empty directory.



### Anything Else?

Directory `compactdb` also exists after unit tests have finished.
If there were a function to traverse the content of a directory removing files and folders recursively, it would be applied to `compactdb` as well.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/798/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/798,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JSwin,kvrocks,1229654183,798,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-29T01:57:54Z,2022-08-29T01:57:54Z,We didn't have the recursive delete directory yet.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JSwin/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/799,https://api.github.com/repos/apache/kvrocks/issues/799,kvrocks,1355117273,799,Unexpected behavior in configuration parsing,PragmaTwice,20042607,Twice,,CLOSED,2022-08-30T03:33:24Z,2022-09-22T09:58:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

In kvrocks.conf

```
somekey1 = value # comment
somekey2 = ""value x"" # comment
```

### What did you expect to see?

The parsed items:
```
{""somekey1"": ""value"", ""somekey1"": ""value x""}
```

### What did you see instead?

The parsed items:
```
{""somekey1"": ""value # comment"", ""somekey1"": ""\""value x\"" # comment""}
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/799/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/799,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JYlhq,kvrocks,1231181930,799,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-08-30T06:01:07Z,2022-08-30T06:01:07Z,"Good catch, Redis also not support inline comment and I think it'll be better if we can support.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JYlhq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/800,https://api.github.com/repos/apache/kvrocks/issues/800,kvrocks,1355765484,800,Use clang-format and clang-tidy instead of cpplint and cppcheck,PragmaTwice,20042607,Twice,,CLOSED,2022-08-30T13:21:36Z,2022-10-23T01:32:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

clang-tidy is described in #602.

clang-format is currently the de facto standard of C++ code formatting.

It has lots of benefits, like:
- currently, cpplint reports some format error, but it can hardly automatically fix the code. So we need check errors in CI, and manually fix them one by one. But in clang-format, we can format code to a consistent style with just one command. And we can even add the auto-fix phase to CI (lots of projects do so). That is a huge convenience for developers. 
- we cannot control the version of cpplint well: it has different report in different version for same code. So different report in local and CI, it is unacceptable.
- cpplint cannot handle some detail of C++ language well. clang-format uses Clang AST and every powerful compiler technology in Clang. C++ is a super complicated language, no one can handle the syntax and semantics in different C++ standard well, except compilers like GCC or Clang. It is the core reason why cpplint and cppcheck failed to become great tools (recently cppcheck supports to use libClang instead of its own toy parser and type/semantics checker).

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/800/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/800,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MPnoD,kvrocks,1279162883,800,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-14T15:35:04Z,2022-10-14T15:35:04Z,"By the way, I get the same result with clang14 which is the default version of macos. The latest clang is 15. If you can be sure that the result of 15 is the same, maybe there is no need to make judgments here. I think at least we can give a warning here and give the recommended clang version. Direct RuntimeError seems a bit inappropriate.@PragmaTwice 
https://github.com/apache/incubator-kvrocks/blob/unstable/x.py#L140","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MPnoD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/800,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MPpSf,kvrocks,1279169695,800,NA,PragmaTwice,20042607,Twice,,NA,2022-10-14T15:41:31Z,2022-10-14T15:41:31Z,"> By the way, I get the same result with clang14 which is the default version of macos. The latest clang is 15. If you can be sure that the result of 15 is the same, maybe there is no need to make judgments here. I think at least we can give a warning here and give the recommended clang version. Direct RuntimeError seems a bit inappropriate.@PragmaTwice https://github.com/apache/incubator-kvrocks/blob/unstable/x.py#L140

There are some difference (may not be encountered often) in format result between different version of clang-format. So I recommand developers use the same version of clang-format as in github actions.

You can install a clang-format 12 or download from the URL provided in the message.

I think it can be a warning, but developers may become angry when they format the code but still fail in the CI :rofl:","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MPpSf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/800,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MPqsH,kvrocks,1279175431,800,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-14T15:46:55Z,2022-10-14T15:46:55Z,"> There are some difference (may not be encountered often) in format result between different version of clang-format. So I recommand developers use the same version of clang-format as in github actions.
> 
> You can install a clang-format 12 or download from the URL provided in the message.
> 
> I think it can be a warning, but developers may become angry when they format the code but still fail in the CI 🤣

At least on clang-14 the result is the same. Will clang-format be forward compatibility? If it doesn't then it's reasonable to throw an error.🤔
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MPqsH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/800,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MPsQ7,kvrocks,1279181883,800,NA,PragmaTwice,20042607,Twice,,NA,2022-10-14T15:53:25Z,2022-10-14T15:53:25Z,I can confirm there is some difference since I had some experience with this problem in [Oneflow](https://github.com/Oneflow-Inc/oneflow). Maybe there is currently no such code in kvrocks that might trigger compatibility issues for clang-format. I will change this message to warning.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MPsQ7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/801,https://api.github.com/repos/apache/kvrocks/issues/801,kvrocks,1357485217,801,key from STREAM are always in lowercase,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2022-08-31T15:12:19Z,2022-09-01T04:16:03Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

694d5617bcb873db8d107decd7fe297e4588360b

### Minimal reproduce step

- Connect via redis-cli
- XADD TESTSTREAM * myKey message
- Then, XREAD TESTSTREAM 0-0


### What did you expect to see?

I expect to see: {myKey, message}

### What did you see instead?

- We get: { mykey, message }

### Anything Else?

@torwig known this bug and preparing patch

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/801/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/804,https://api.github.com/repos/apache/kvrocks/issues/804,kvrocks,1358640413,804,No CMAKE_CXX_COMPILER could be found,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2022-09-01T10:49:31Z,2022-09-01T11:22:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

latest unstable, after #803

### Minimal reproduce step

git clone && ./x.py build

### What did you expect to see?

Normal build process

### What did you see instead?

$ /usr/local/bin/cmake /tmp/incubator-kvrocks -DCMAKE_BUILD_TYPE=RelWithDebInfo
-- The CXX compiler identification is unknown
CMake Error at CMakeLists.txt:19 (project):
  No CMAKE_CXX_COMPILER could be found.

  Tell CMake where to find the compiler by setting either the environment
  variable ""CXX"" or the CMake cache entry CMAKE_CXX_COMPILER to the full path
  to the compiler, or to the compiler name if it is in the PATH.


### Anything Else?

Debian 11

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/804/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/804,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JjvkC,kvrocks,1234106626,804,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-01T10:55:27Z,2022-09-01T10:55:27Z,"Something are wrong. After I install tcl for tests, build are broken. Try to reset and re-install all dependency ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JjvkC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/805,https://api.github.com/repos/apache/kvrocks/issues/805,kvrocks,1358730527,805,"Can't run only unixsocket, without any TCP.",aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2022-09-01T11:58:49Z,2022-09-06T05:57:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

In local env, when we configure fro maximal performance, we want use only unixsocket, without any TCP. 
If I comment bind and port options and uncomment unixsocket, after start, kvrocks try to bing localhost:6666 port, ignoring disable option. In other hands, Redis works very well :)

### Solution

Not trying to bind TCP if both options are disabled (bind and port)

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/805/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JkFbE,kvrocks,1234196164,805,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-01T12:13:25Z,2022-09-01T12:13:25Z,"Update: if we have one another instance kvrocks with TCP, second server instance with commented options not runned with message: main.cc:293] Could not create server TCP since the specified port[6666] is already in use","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JkFbE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JrZLM,kvrocks,1236112076,805,NA,torwig,8588372,Yaroslav,,NA,2022-09-03T12:42:06Z,2022-09-03T12:42:06Z,"If everyone is OK with it, I'll try to resolve this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JrZLM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JrcNX,kvrocks,1236124503,805,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-03T13:51:54Z,2022-09-03T13:51:54Z,"Thanks to @aleksraiden and @torwig, I think we can do this since no objection.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JrcNX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jrfyy,kvrocks,1236139186,805,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-03T15:05:52Z,2022-09-03T15:05:52Z,"After little bit more deep investigation, we improve config check and comparability with Cluster mode. So, if you are turn on cluster or replication settings, you can't run without TCP. 
Thanks to @torwig ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Jrfyy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JrgMx,kvrocks,1236140849,805,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-03T15:14:56Z,2022-09-03T15:14:56Z,"> After little bit more deep investigation, we improve config check and comparability with Cluster mode. So, if you are turn on cluster or replication settings, you can't run without TCP. Thanks to @torwig

Yes, exactly. This is really a good point.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JrgMx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/807,https://api.github.com/repos/apache/kvrocks/issues/807,kvrocks,1360665535,807,redis-cli --pipe syntax error ,dirkpetersen,1427719,Dirk Petersen,,CLOSED,2022-09-02T22:44:55Z,2022-09-03T07:46:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

kvrocks unstable 40989fc26dc4229bd9f797c14eaa4df07574f47e
ubuntu 22.04



### Minimal reproduce step

```
root@localhost:~# cat /tmp/text1.txt
set zzzap zzzzzzzzzzzzzzzzznologin
set vv zzzzzzzzzzzzzzzzpsbinnologin
```

```
root@localhost:~# cat /tmp/text1.txt | redis-cli --pipe --verbose
```


### What did you expect to see?

This is with redis or keydb 

```
root@localhost:~# cat /tmp/text1.txt | redis-cli -h xx.79.179.186 --pipe --verbose
All data transferred. Waiting for the last reply...
Last reply received from server.
errors: 0, replies: 2
```

### What did you see instead?

root@localhost:~# cat /tmp/text1.txt | redis-cli --pipe --verbose
All data transferred. Waiting for the last reply...
ERR syntax error
Last reply received from server.
errors: 1, replies: 1


### Anything Else?

> redis-cli --version
redis-cli 6.0.16

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/807/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/807,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JrBY4,kvrocks,1236014648,807,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-03T01:10:07Z,2022-09-03T01:10:07Z,"Hello @dirkpetersen, many thanks for your feedback.

The root cause is that Kvrocks's inline protocol didn't support the `\r\n` separator. Will align this with Redis behavior and it only works like below:

```
❯ echo ""set a 1\r\nset b 2\r\n"" > pipes.txt
❯ cat pipes.txt
set a 1
set b 2

❯ cat pipes.txt | redis-cli -p 6666 --pipe --verbose
All data transferred. Waiting for the last reply...
Last reply received from server.
errors: 0, replies: 2
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JrBY4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/811,https://api.github.com/repos/apache/kvrocks/issues/811,kvrocks,1361031842,811,Tracking issue for moving TCL tests to Go cases,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T03:57:26Z,2022-10-20T13:38:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

See also https://github.com/apache/incubator-kvrocks/pull/806.

### Solution

### Cases

* [x] #829
* [x] #995
* [x] #841
* [x] #842
* [x] #814
* [x] #815
* [x] #816
* [x] #817
* [x] #818
* [x] #819
* [x] #820
* [x] #821
* [x] #822
* [x] #823
* [x] #824
* [x] #855
* [x] #856
* [x] #857
* [x] #861
* [x] #889
* [x] #890
* [x] #851
* [x] #860
* [x] #864
* [x] #872
* [x] #812
* [x] #945
* [x] #946
* [x] #947
* [x] #948
* [x] #949
* [x] #950

### Fixture

* [x] #813","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/811/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/811,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mn7Qu,kvrocks,1285534766,811,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-20T13:24:22Z,2022-10-20T13:24:22Z,"Closed as done. @vmihailenco You may notice now we have a ""compatibility tests set"" for interacting Kvrocks with go-redis :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mn7Qu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/811,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoAkH,kvrocks,1285556487,811,NA,vmihailenco,290976,Vladimir Mihailenco,vladimir.webdev@gmail.com,NA,2022-10-20T13:38:28Z,2022-10-20T13:38:28Z,Hope go-redis will serve you well :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoAkH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/812,https://api.github.com/repos/apache/kvrocks/issues/812,kvrocks,1361031852,812,Move TCL test unit/protocol to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T03:57:31Z,2022-09-05T07:08:56Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/812/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/813,https://api.github.com/repos/apache/kvrocks/issues/813,kvrocks,1361038249,813,Integrate Go cases into build scripts,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:22:38Z,2022-09-07T10:10:16Z,"I think basically we can treat Go cases as a standalone module and write a `Makefile` to it for running linters and tests.

Then we wire it into the `x.py` script.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/813/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/813,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J18GX,kvrocks,1238876567,813,NA,PragmaTwice,20042607,Twice,,NA,2022-09-07T03:52:30Z,2022-09-07T03:52:30Z,"I am thinking whether the makefile is necessary, since it is just a test module and we already have `x.py` which is a general script for developers. 

If there are two scripts that need to be maintained, I think it might cause some confusion. The functionality of the makefile is not orthogonal to our current `x.py`, they have similiar capabilities.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J18GX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/813,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J1_EH,kvrocks,1238888711,813,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-07T04:17:02Z,2022-09-07T04:17:02Z,"@PragmaTwice you're right. Previously I'm thinking of adding linters for Go code and then build/test can depend on the lint task. Makefile does a good job for task dependencies while implementing it inside a script is awkward. However, now I believe we can run lint in another `x.py` command and there's no dependency between tasks to handle. So your patch is great.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J1_EH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/813,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J3IIJ,kvrocks,1239187977,813,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-07T10:10:16Z,2022-09-07T10:10:16Z,Closed by #832.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J3IIJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/814,https://api.github.com/repos/apache/kvrocks/issues/814,kvrocks,1361038490,814,Move TCL test unit/type/string to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:23Z,2022-10-11T10:09:59Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/814/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/814,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LcJID,kvrocks,1265668611,814,NA,gogim1,10893839,Jinze Wu,,NA,2022-10-03T15:48:42Z,2022-10-03T15:48:42Z,i would like to work on this issue😋,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LcJID/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/814,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LcX4x,kvrocks,1265729073,814,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-03T16:36:33Z,2022-10-03T16:36:33Z,@GoGim1  assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LcX4x/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/815,https://api.github.com/repos/apache/kvrocks/issues/815,kvrocks,1361038495,815,Move TCL test unit/type/incr to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:26Z,2022-09-09T07:30:06Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/815/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/815,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J30Y2,kvrocks,1239369270,815,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-07T13:10:02Z,2022-09-07T13:10:02Z,Hi. I'd like to do this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J30Y2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/815,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J30tZ,kvrocks,1239370585,815,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-07T13:11:09Z,2022-09-07T13:11:09Z,@tanruixiang assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J30tZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/815,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J48tU,kvrocks,1239665492,815,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-07T17:14:19Z,2022-09-07T17:14:19Z,"Hi. The comments in [incr.tcl](https://github.com/apache/incubator-kvrocks/blob/unstable/tests/tcl/tests/unit/type/incr.tcl#L133) indicate that these two cases cannot be tested. Should we also keep these two cases in the form of comments in go?
```
  test {INCRBYFLOAT does not allow NaN or Infinity} {
        r set foo 0
        set err {}
        catch {r incrbyfloat foo +inf} err
        set err
        # p.s. no way I can force NaN to test it from the API because
        # there is no way to increment / decrement by infinity nor to
        # perform divisions.
    } {ERR*would produce*}

    # TODO: INCRBYFLOAT precision for human friendly
    # test {INCRBYFLOAT decrement} {
    #     r set foo 1
    #     roundFloat [r incrbyfloat foo -1.1]
    # } {-0.1}
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J48tU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/815,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J4-Ot,kvrocks,1239671725,815,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-07T17:19:13Z,2022-09-07T17:19:13Z,@tanruixiang Yes. You can carry the TODO items as is.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J4-Ot/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/816,https://api.github.com/repos/apache/kvrocks/issues/816,kvrocks,1361038502,816,Move TCL test unit/type/list to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:29Z,2022-10-18T16:28:47Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/816/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/816,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFqgu,kvrocks,1242998830,816,NA,suica,8041462,Sg,,NA,2022-09-11T16:29:39Z,2022-09-11T16:29:39Z,I would like to migrate all list test cases. Please assign this issue to me :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFqgu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/816,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFq7g,kvrocks,1243000544,816,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T16:40:47Z,2022-09-11T16:40:47Z,"@suica Assigned. Go ahead! It seems a large file, you can do it in several steps - be careful :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFq7g/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/816,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRXYs,kvrocks,1279620652,816,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-15T01:08:41Z,2022-10-15T01:08:41Z,@IoCing would you like to take a look at this issue? You may do it in several minor steps and even part of it does help :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRXYs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/816,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRmmV,kvrocks,1279682965,816,NA,IoCing,39056297,IoCing,,NA,2022-10-15T07:19:18Z,2022-10-15T07:19:18Z,"@tisonkun ok , i would like to ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRmmV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/817,https://api.github.com/repos/apache/kvrocks/issues/817,kvrocks,1361038508,817,Move TCL test unit/type/list-2 to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:32Z,2022-09-07T06:56:50Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/817/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/817,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J0Bfa,kvrocks,1238374362,817,NA,suica,8041462,Sg,,NA,2022-09-06T16:23:07Z,2022-09-06T16:23:07Z,"Hi, I would like to work on this issue :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J0Bfa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/817,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J0Du6,kvrocks,1238383546,817,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-06T16:27:46Z,2022-09-06T16:27:46Z,@suica assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J0Du6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/818,https://api.github.com/repos/apache/kvrocks/issues/818,kvrocks,1361038511,818,Move TCL test unit/type/list-3 to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:35Z,2022-09-11T17:05:08Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/818/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/818,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J28EM,kvrocks,1239138572,818,NA,suica,8041462,Sg,,NA,2022-09-07T09:25:30Z,2022-09-07T09:25:30Z,I would like to do this task :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J28EM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/818,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J3Hvl,kvrocks,1239186405,818,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-07T10:08:50Z,2022-09-07T10:08:50Z,@suica assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J3Hvl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/819,https://api.github.com/repos/apache/kvrocks/issues/819,kvrocks,1361038525,819,Move TCL test unit/type/set to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:41Z,2022-09-13T03:03:14Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/819/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/819,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KCI9f,kvrocks,1242074975,819,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-09T14:50:37Z,2022-09-09T14:50:37Z,I'd like to do this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KCI9f/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/819,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KCJjH,kvrocks,1242077383,819,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-09T14:52:50Z,2022-09-09T14:52:50Z,@tanruixiang Assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KCJjH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/819,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KESLl,kvrocks,1242637029,819,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-10T05:36:08Z,2022-09-10T05:36:08Z,"Hi. I'm not very familiar with go. How to use go to pass the value exceeding Int64 in int ？Do we just need to pass it in the form of a string(I found that kvrocks should not implement large numbers, and automatically convert this to a string)?
```
    test ""SADD an integer larger than 64 bits"" {
        create_set myset {213244124402402314402033402}
        #assert_encoding hashtable myset
        assert_equal 1 [r sismember myset 213244124402402314402033402]
        assert_equal {1} [r smismember myset 213244124402402314402033402]
    }
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KESLl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/819,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KEWfy,kvrocks,1242654706,819,NA,PragmaTwice,20042607,Twice,,NA,2022-09-10T07:18:38Z,2022-09-10T07:18:38Z,"> Hi. I'm not very familiar with go. How to use go to pass the value exceeding Int64 in int ？Do we just need to pass it in the form of a string(I found that kvrocks should not implement large numbers, and automatically convert this to a string)?
> 
> ```
>     test ""SADD an integer larger than 64 bits"" {
>         create_set myset {213244124402402314402033402}
>         #assert_encoding hashtable myset
>         assert_equal 1 [r sismember myset 213244124402402314402033402]
>         assert_equal {1} [r smismember myset 213244124402402314402033402]
>     }
> ```

I think maybe there is no difference between string and integer here, i.e. you can use string here. cc @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KEWfy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/819,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KElH7,kvrocks,1242714619,819,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-10T12:02:17Z,2022-09-10T12:02:17Z,"> > Hi. I'm not very familiar with go. How to use go to pass the value exceeding Int64 in int ？Do we just need to pass it in the form of a string(I found that kvrocks should not implement large numbers, and automatically convert this to a string)?
> > ```
> >     test ""SADD an integer larger than 64 bits"" {
> >         create_set myset {213244124402402314402033402}
> >         #assert_encoding hashtable myset
> >         assert_equal 1 [r sismember myset 213244124402402314402033402]
> >         assert_equal {1} [r smismember myset 213244124402402314402033402]
> >     }
> > ```
> 
> I think maybe there is no difference between string and integer here, i.e. you can use string here. cc @git-hulk

Yes, exactly.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KElH7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/820,https://api.github.com/repos/apache/kvrocks/issues/820,kvrocks,1361038530,820,Move TCL test unit/type/zset to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:43Z,2022-10-15T01:07:07Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/820/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/820,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LhIPm,kvrocks,1266975718,820,NA,IoCing,39056297,IoCing,,NA,2022-10-04T13:12:25Z,2022-10-04T13:12:25Z,i would like to do it !,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LhIPm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/820,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LhKKr,kvrocks,1266983595,820,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-04T13:17:59Z,2022-10-04T13:17:59Z,@IoCing assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LhKKr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/820,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MNBlP,kvrocks,1278482767,820,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-14T04:55:38Z,2022-10-14T04:55:38Z,@IoCing any progress here? You may do it in several minor steps as I'm doing for https://github.com/apache/incubator-kvrocks/issues/824.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MNBlP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/820,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MNUdj,kvrocks,1278560099,820,NA,IoCing,39056297,IoCing,,NA,2022-10-14T06:48:53Z,2022-10-14T06:48:53Z,@tisonkun sorry ，i just finished it ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MNUdj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/820,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MNVYl,kvrocks,1278563877,820,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-14T06:52:57Z,2022-10-14T06:52:57Z,Cool!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MNVYl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/820,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRXR5,kvrocks,1279620217,820,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-15T01:07:07Z,2022-10-15T01:07:07Z,Closed by #988.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRXR5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/821,https://api.github.com/repos/apache/kvrocks/issues/821,kvrocks,1361038546,821,Move TCL test unit/type/hash to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:49Z,2022-09-27T15:31:08Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/821/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/821,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kinaz,kvrocks,1250588339,821,NA,IoCing,39056297,IoCing,,NA,2022-09-19T05:33:11Z,2022-09-19T05:33:11Z,i would like to work on it !,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kinaz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/821,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KioK2,kvrocks,1250591414,821,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-19T05:39:47Z,2022-09-19T05:39:47Z,@IoCing assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KioK2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/822,https://api.github.com/repos/apache/kvrocks/issues/822,kvrocks,1361038553,822,Move TCL test unit/type/sint to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:52Z,2022-09-09T15:38:26Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/822/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/822,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J49qV,kvrocks,1239669397,822,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-07T17:18:04Z,2022-09-07T17:18:04Z,Hi. I'd like to do this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J49qV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/822,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J4-XQ,kvrocks,1239672272,822,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-07T17:19:30Z,2022-09-07T17:19:30Z,@tanruixiang Assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J4-XQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/823,kvrocks,1361038567,823,Move TCL test unit/type/bitmap to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:55Z,2022-09-19T07:23:39Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/823/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsKJh,kvrocks,1236312673,823,NA,ryuusama09,80237556,Harsh Shah,,NA,2022-09-04T11:05:47Z,2022-09-04T11:05:47Z,I would like to work on it ! ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsKJh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsKQP,kvrocks,1236313103,823,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-04T11:08:11Z,2022-09-04T11:08:11Z,"@ryuusama09 Thanks for your participation! Assigned.

Go ahead and you can take a looks at existing examples.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsKQP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsK-b,kvrocks,1236316059,823,NA,ryuusama09,80237556,Harsh Shah,,NA,2022-09-04T11:24:58Z,2022-09-04T11:24:58Z,"> 

hi  , can you provide a link to project documentation , and a bit more understanding on what exactly needs to be done here
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsK-b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsLy8,kvrocks,1236319420,823,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-04T11:45:35Z,2022-09-04T11:45:35Z,"You can read the pull request https://github.com/apache/incubator-kvrocks/pull/810 and https://github.com/apache/incubator-kvrocks/pull/806 for example.

For locally verifying, run:

```
GO_CASE_WORKSPACE=./workspace KVROCKS_BIN_PATH=../../build/kvrocks go test -v ./...
```

... under `tests/gocase`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsLy8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KEj09,kvrocks,1242709309,823,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-10T11:25:09Z,2022-09-10T11:25:09Z,Inactive assigner. Unassign and release the opportunity.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KEj09/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFW_8,kvrocks,1242918908,823,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-11T08:46:53Z,2022-09-11T08:46:53Z,"Hi. I'd like to do this. ~By the way, is `bitop`'s support in our plan? If the difficulty is moderate, I am willing to develop this command.~ I found that `bittop` has been implemented, but the wiki is not updated. [kvrocks's wiki](https://github.com/apache/incubator-kvrocks/wiki/Support-Commands)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFW_8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFeer,kvrocks,1242949547,823,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-11T12:02:38Z,2022-09-11T12:02:38Z,"Hi @tanruixiang, You can just do the identical migration which means only replacing those bitmap tcl cases with Go. Can also take a look at a look at other PRs if you don't know how
to do that.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFeer/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFe3v,kvrocks,1242951151,823,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T12:11:02Z,2022-09-11T12:11:02Z,"> but the wiki is not updated

@tanruixiang we should gradually migrate the document to our docsite https://kvrocks.apache.org/. You can find the source code at: https://github.com/apache/incubator-kvrocks-website. You're welcome to make a contribution on this topic if you find this doc is also missing on the docsite.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFe3v/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFe43,kvrocks,1242951223,823,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-11T12:11:26Z,2022-09-11T12:11:26Z,"> Hi @tanruixiang, You can just do the identical migration which means only replacing those bitmap tcl cases with Go. Can also take a look at a look at other PRs if you don't know how to do that.

Ok. In fact I've done several PRs to migrate from tcl to go. I was just wondering if I could do something different. Do you have any advice? Of course, please assign this task to me. 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFe43/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFfg7,kvrocks,1242953787,823,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-11T12:25:46Z,2022-09-11T12:25:46Z,"@tanruixiang I saw your PRs, thanks again. I misunderstood what you mean. 😆 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFfg7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/824,https://api.github.com/repos/apache/kvrocks/issues/824,kvrocks,1361038572,824,Move TCL test unit/type/stream to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-04T04:24:58Z,2022-10-17T05:26:49Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/824/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/824,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsOiN,kvrocks,1236330637,824,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-04T12:36:25Z,2022-09-04T12:36:25Z,"@tisonkun maybe some script error, because a lot of identical issue created?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsOiN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/824,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsRou,kvrocks,1236343342,824,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-04T13:33:38Z,2022-09-04T13:33:38Z,"@aleksraiden No. If you take a closer look, they're similar issues for different test case.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsRou/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/824,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsS89,kvrocks,1236348733,824,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-04T14:03:50Z,2022-09-04T14:03:50Z,"@tisonkun Oh yes, you are right, sorry, my mistake. Maybe I need to sleep )) ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsS89/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/824,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsViT,kvrocks,1236359315,824,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-04T14:58:29Z,2022-09-04T14:58:29Z,"@aleksraiden I'll handle them as a relax, haha. If you have some spare time or want to write some trivial patches for relaxation, welcome to comment at any of them and I'll assign you :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5JsViT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/826,https://api.github.com/repos/apache/kvrocks/issues/826,kvrocks,1362938827,826,Warning on latest CMake 3.24.1 - DOWNLOAD_EXTRACT_TIMESTAMP option,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2022-09-06T08:56:56Z,2022-09-06T16:28:44Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Building a KVRocks with latest CMake produced a lot of warnings like this: 

> 
> CMake Warning (dev) at /usr/local/share/cmake-3.24/Modules/FetchContent.cmake:1264 (message):
>   The DOWNLOAD_EXTRACT_TIMESTAMP option was not given and policy CMP0135 is
>   not set.  The policy's OLD behavior will be used.  When using a URL
>   download, the timestamps of extracted files should preferably be that of
>   the time of extraction, otherwise code that depends on the extracted
>   contents might not be rebuilt if the URL changes.  The OLD behavior
>   preserves the timestamps from the archive instead, but this is usually not
>   what you want.  Update your project to the NEW behavior or specify the
>   DOWNLOAD_EXTRACT_TIMESTAMP option with a value of true to avoid this
>   robustness issue.
> Call Stack (most recent call first):
>   cmake/utils.cmake:48 (FetchContent_Declare)
>   cmake/utils.cmake:55 (FetchContent_DeclareWithMirror)
>   cmake/luajit.cmake:22 (FetchContent_DeclareGitHubWithMirror)
>   CMakeLists.txt:88 (include)
> This warning is for project developers.  Use -Wno-dev to suppress it.

Link to this at CMake docs: [https://cmake.org/cmake/help/latest/policy/CMP0135.html](https://cmake.org/cmake/help/latest/policy/CMP0135.html)

### Solution

Add options DOWNLOAD_EXTRACT_TIMESTAMP with value NEW into FetchContent_Declare function (cmake/utils.cmake)

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/826/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/829,https://api.github.com/repos/apache/kvrocks/issues/829,kvrocks,1363398694,829,Move TCL test unit/auth to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-06T14:41:59Z,2022-09-06T16:29:23Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/829/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/831,https://api.github.com/repos/apache/kvrocks/issues/831,kvrocks,1363443032,831,[BUG] Should read the multiple blocking pushed element,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-06T15:13:11Z,2022-09-09T02:14:09Z,"The following test can pass if set `KVROCKS_BIN_PATH` to `redis-server`.

https://github.com/apache/incubator-kvrocks/blob/dbd968b47a08184b3a0b6492f28f9ba8edf6d11b/tests/gocase/unit/protocol/regression_test.go#L58-L63

We should figure out the cause and to fix it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/831/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/831,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J3-WX,kvrocks,1239410071,831,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-07T13:43:43Z,2022-09-07T13:43:43Z,"This's a bug in blocking pop, let's me handle it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J3-WX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/831,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J4pJs,kvrocks,1239585388,831,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-07T15:58:50Z,2022-09-07T15:58:50Z,I found the root cause is the secondary blocking command has been read into the connection but didn't run since the NO read event was triggered again. I need some time to fix it since we can't force running read callback directly.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J4pJs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/836,kvrocks,1366406608,836,Updating C++ 17 and start implementation of RocksDB 7.х,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2022-09-08T14:04:56Z,2022-11-04T12:15:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

RocksDB are expressive storage engine and a lot of engineers improve it. Currently, a head version are 7.5.х and 7.6 are coming in next week. Great work, many new features, a lot of performance patch and bugs are fixed. We want it!

### Solution

We are using a stable but old version 6.29.х. So, lets start to updating! 

In collaboration with @torwig we have a ambitious plan to implement support of major release of RocksDB, implement API changes and new features. 

A first step are:

1. Updating C++ up to 17 (now we use v11). In some cases this should be not so clean (Ubuntu 16.х maybe not supported).
2. Updating RocksDB up to 7.2.2 - this version haven't many breaking changes, so we integrate it without rewrite a code base. 

And this is a base platform for step-by-step updating next version of RocksDB. 

If our plan is OK, we submit PR and will work about next integrations.


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/836/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9LZZ,kvrocks,1240774233,836,NA,torwig,8588372,Yaroslav,,NA,2022-09-08T14:12:13Z,2022-09-08T14:12:13Z,@git-hulk @PragmaTwice @tisonkun Do we have any blockers or considerations that might stop us from updating RocksDb to a newer major version?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9LZZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9PCE,kvrocks,1240789124,836,NA,PragmaTwice,20042607,Twice,,NA,2022-09-08T14:23:16Z,2022-09-08T14:23:16Z,"I favor updating to newer c++ standard, but it may be a more complicated task and I think you could open a separate issue to discuss the standard updating.

Things that might need to be investigated to update the c++ standard include:
- compiler support, which version of the compiler standard we need to upgrade to
- breaking changes of the newer standard and semantic changes, and their impact on kvrocks
- behavior differences of dependency libraries across standards","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9PCE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9PJe,kvrocks,1240789598,836,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-08T14:23:36Z,2022-09-08T14:23:36Z,"The main concern from my side is that C++17 may be too new for many users,
and RocksDB 7.x is too radical since it should NOT have enough users now. 
So I prefer to keep 6.29.X and C++11 for a while before we have the strong intention
to introduce some cool features in RocksDB 7.x.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9PJe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9SsS,kvrocks,1240804114,836,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-08T14:34:28Z,2022-09-08T14:34:28Z,"In other hands - if we keep old version of RocksDB, any other migrations will be a lot of pain. Now, in our private fork, has no critical changes, all test are passed, all dependency build clean. 

We can slowly migration step by step to forward version of RocksDB, but from 7.2 this is much more trivial now, than when they are going to next release like 8.х.

Maybe we can separate task - and a first prepare PR for C++17, and then look into rocksdb?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9SsS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9fh0,kvrocks,1240856692,836,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-08T15:13:44Z,2022-09-08T15:13:44Z,In new version binary file has 20.3Mb vs 35Mb old (6.2/C++11) while use Release building mode,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9fh0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9gE-,kvrocks,1240858942,836,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-08T15:15:23Z,2022-09-08T15:15:23Z,"@aleksraiden I suggest you start a discussion about upgrading the C++ standard in the Discussion forum. It's not an actionable task (for now) but an open-ended discussion. Also, answering in-thread should be better than quote and reply in an issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9gE-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9geI,kvrocks,1240860552,836,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-08T15:16:35Z,2022-09-08T15:16:35Z,"Good idea, thanks @tisonkun. lets go to Discussion, @torwig ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5J9geI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KttBO,kvrocks,1253494862,836,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-21T10:13:13Z,2022-09-21T10:13:13Z,"For info - in our fork with updates, successfully merged with current upstream RocksDB without any code changes. And work into internal evn in a week. 
As I think, this can be a flag for x.py to choose a version of RocksDB","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KttBO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3GX-,kvrocks,1255958014,836,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-23T08:56:40Z,2022-09-23T08:56:40Z,A little bit bad news - for performance boost some options needs to be compiled with C++20 (concurrently read data blocks from multiple files in a level in batched MultiGet). ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3GX-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3JuB,kvrocks,1255971713,836,NA,PragmaTwice,20042607,Twice,,NA,2022-09-23T09:10:56Z,2022-09-23T09:10:56Z,"> For info - in our fork with updates, successfully merged with current upstream RocksDB without any code changes. And work into internal evn in a week. As I think, this can be a flag for x.py to choose a version of RocksDB

I think it is hard to maintain kvrocks with multiple version of rocksdb or multiple standard in same time, so I prefer update standard/dependency version directly.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3JuB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3q2V,kvrocks,1256107413,836,NA,PragmaTwice,20042607,Twice,,NA,2022-09-23T11:43:24Z,2022-09-23T11:43:24Z,"> A little bit bad news - for performance boost some options needs to be compiled with C++20 (concurrently read data blocks from multiple files in a level in batched MultiGet).

Could you give some more specific information? For example, which source file/code segment that requires c++20 is involved in rocksdb.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3q2V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NrwaD,kvrocks,1303316099,836,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-11-04T11:50:21Z,2022-11-04T11:50:21Z,@git-hulk @PragmaTwice can this patch be closed now? Sinces kvrocks is already using C++17 and RocksDB 7.x,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NrwaD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NsA3r,kvrocks,1303383531,836,NA,PragmaTwice,20042607,Twice,,NA,2022-11-04T12:15:20Z,2022-11-04T12:15:20Z,"> @git-hulk @PragmaTwice can this patch be closed now? Sinces kvrocks is already using C++17 and RocksDB 7.x

Sure.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NsA3r/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/841,https://api.github.com/repos/apache/kvrocks/issues/841,kvrocks,1368004066,841,Move TCL test unit/keyspace to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-09T15:38:45Z,2022-09-11T04:04:00Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/841/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/842,https://api.github.com/repos/apache/kvrocks/issues/842,kvrocks,1368004160,842,Move TCL test unit/scan to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-09T15:38:48Z,2022-09-30T11:08:15Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/842/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/842,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LSUA4,kvrocks,1263091768,842,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-30T04:34:38Z,2022-09-30T04:34:38Z,I'm working on this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LSUA4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/844,https://api.github.com/repos/apache/kvrocks/issues/844,kvrocks,1368657898,844,"When the key does not exist, the return value of georadius is inconsistent with that of Redis.",ColinChamber,95634254,ColinChamber,,CLOSED,2022-09-10T15:43:06Z,2022-09-11T03:42:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

GEORADIUS key 6 17 50 km

### What did you expect to see?

(empty list or set)

### What did you see instead?

(error) ERR NotFound:

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/844/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/851,https://api.github.com/repos/apache/kvrocks/issues/851,kvrocks,1368848445,851,Move TCL test unit/limits to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-11T06:36:07Z,2022-09-12T00:58:02Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/851/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/851,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KGBQz,kvrocks,1243092019,851,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-12T00:58:01Z,2022-09-12T00:58:01Z,Closed by #854.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KGBQz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/855,https://api.github.com/repos/apache/kvrocks/issues/855,kvrocks,1368857138,855,Move TCL test unit/multi to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-11T07:18:58Z,2022-10-06T16:31:21Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/855/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/856,https://api.github.com/repos/apache/kvrocks/issues/856,kvrocks,1368857181,856,Move TCL test unit/expire to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-11T07:19:12Z,2022-10-08T02:37:14Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/856/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/856,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ktixv,kvrocks,1253452911,856,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2022-09-21T09:35:19Z,2022-09-21T09:35:19Z,"I'd like to work on it, can assign to me :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ktixv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/856,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KtlKp,kvrocks,1253462697,856,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-21T09:44:38Z,2022-09-21T09:44:38Z,@maochongxin assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KtlKp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/856,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LrlHH,kvrocks,1269715399,856,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-06T09:53:08Z,2022-10-06T09:53:08Z,Inactive. Unassign to release the seat.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LrlHH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/856,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LsKGF,kvrocks,1269866885,856,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2022-10-06T11:35:12Z,2022-10-06T11:35:12Z,"Sorry for the delay. I have finished the coding and will finish it as soon as possible
#955 
> Inactive. Unassign to release the seat.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LsKGF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/856,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1EoQ,kvrocks,1272203792,856,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-08T02:37:13Z,2022-10-08T02:37:13Z,Closed by #955. Thank you @maochongxin!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1EoQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/857,https://api.github.com/repos/apache/kvrocks/issues/857,kvrocks,1368857201,857,Move TCL test unit/quit to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-11T07:19:18Z,2022-09-19T06:37:37Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/857/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/857,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFW0C,kvrocks,1242918146,857,NA,IoCing,39056297,IoCing,,NA,2022-09-11T08:41:34Z,2022-09-11T08:41:34Z,I would like to work on it !,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFW0C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/857,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFez-,kvrocks,1242950910,857,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-11T12:09:36Z,2022-09-11T12:09:36Z,@IoCing assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KFez-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/859,https://api.github.com/repos/apache/kvrocks/issues/859,kvrocks,1368962267,859,Complete and beautify the kvrocks website,PragmaTwice,20042607,Twice,,CLOSED,2022-09-11T14:25:18Z,2022-10-23T08:33:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

What you can do for [kvrocks.apache.org](https://kvrocks.apache.org/) (repo: [apache/incubator-kvrocks-website](https://github.com/apache/incubator-kvrocks-website)):
- Fix outdated paragraphs and typos in the documentation
- Beautify the typography and color scheme of the website
- Complete unfinished documents or add new ones

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/859/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/859,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KRUnw,kvrocks,1246054896,859,NA,chewitt1,44040034,Carrima Hewitt,,NA,2022-09-13T23:34:25Z,2022-09-13T23:34:25Z,Hi can I work on this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KRUnw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/859,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KRpa8,kvrocks,1246140092,859,NA,PragmaTwice,20042607,Twice,,NA,2022-09-14T02:10:17Z,2022-09-14T02:10:17Z,"> Hi can I work on this issue?

@chewitt1  Sure! Since it is more like a general / tracking issue, feel free to open more concrete issues to this repo or create PRs to incubator-kvrocks-website.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KRpa8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/859,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KVa65,kvrocks,1247129273,859,NA,chewitt1,44040034,Carrima Hewitt,,NA,2022-09-14T18:07:15Z,2022-09-14T18:07:15Z,Ok thank you! I will do that,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KVa65/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/859,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LHQK6,kvrocks,1260192442,859,NA,chewitt1,44040034,Carrima Hewitt,,NA,2022-09-27T23:55:38Z,2022-09-27T23:55:38Z,"Hi, I just wanted update and say I unfortunately will not be able to help with this issue at this time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LHQK6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/859,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LH6vb,kvrocks,1260366811,859,NA,PragmaTwice,20042607,Twice,,NA,2022-09-28T04:18:53Z,2022-09-28T04:18:53Z,"> Hi, I just wanted update and say I unfortunately will not be able to help with this issue at this time.

That's all right. Welcome to participate in kvrocks when you have time in the future.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LH6vb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/859,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxhwV,kvrocks,1288051733,859,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-23T08:33:55Z,2022-10-23T08:33:55Z,"Closed as information delivered.

We don't open a generic issue like this. Only file issues if we have concrete actionable tasks for improving the website.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxhwV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/860,https://api.github.com/repos/apache/kvrocks/issues/860,kvrocks,1369126997,860,Move TCL test unit/geo to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-12T00:58:25Z,2022-10-17T00:01:36Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/860/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/860,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MKOOI,kvrocks,1277748104,860,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-13T14:56:12Z,2022-10-13T14:56:12Z,Please assign it to me.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MKOOI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/860,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MMSgv,kvrocks,1278289967,860,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-13T23:44:09Z,2022-10-13T23:44:09Z,@tanruixiang assigned :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MMSgv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/861,https://api.github.com/repos/apache/kvrocks/issues/861,kvrocks,1369127020,861,Move TCL test unit/slowlog to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-12T00:58:29Z,2022-10-04T02:54:45Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/861/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/862,https://api.github.com/repos/apache/kvrocks/issues/862,kvrocks,1369414781,862,Provide an option to clean temp directory after running Go tests,suica,8041462,Sg,,CLOSED,2022-09-12T07:33:38Z,2022-10-03T13:08:23Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, after running the Go test, in the workspace, temp directories for each case will be created, which include the db logs.
```
λ ~/workspace/incubator-kvrocks/tests/gocase/workspace/ issue-816 du -h --max-depth=1                    
75M     ./TestList-1662965128040-1301705625
1.7G    ./TestZipList-1662965129047-2609311019
1.8G    .
λ ~/workspace/incubator-kvrocks/tests/gocase/workspace/TestZipList-1662965129047-2609311019/db/archive/ issue-816 ll -h
total 1.1G
-rw-r--r-- 1 suicca suicca 62M Sep 12 14:45 000012.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000015.log
-rw-r--r-- 1 suicca suicca 60M Sep 12 14:45 000016.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000018.log
-rw-r--r-- 1 suicca suicca 60M Sep 12 14:45 000020.log
-rw-r--r-- 1 suicca suicca 60M Sep 12 14:45 000022.log
-rw-r--r-- 1 suicca suicca 60M Sep 12 14:45 000023.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000025.log
-rw-r--r-- 1 suicca suicca 38M Sep 12 14:45 000026.log
-rw-r--r-- 1 suicca suicca 22M Sep 12 14:45 000028.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000031.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000032.log
-rw-r--r-- 1 suicca suicca 60M Sep 12 14:45 000034.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000035.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000037.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000038.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000040.log
-rw-r--r-- 1 suicca suicca 59M Sep 12 14:45 000041.log
-rw-r--r-- 1 suicca suicca 22M Sep 12 14:45 000043.log
```
The problem is that the db folders occupy too much disk space. My disk just ran out of space after running test many times : (



### Solution

Maybe we could pass a custom flag `-clean-temp` to `go test` command, indicating whether to clean the temp directory when the tests finish. And this should be disabled by default.
```
go test -v ./... -clean-temp
```
In `func StartServer` of tests/gocase/util/server.go, we read this flag and decide whether to perform cleaning in `func (s *KvrocksServer) Close()`. To do cleaning, we just need to simply delete the temp directory by its name, which is generated in `StartServer`.

It is also reasonable to do cleaning *only* when all the tests pass. But I think when we are developing test cases, there will still be bunch of test failure; And this would be more complicated since it requires to obtaining the test result. So, I prefer to let this flag to control whether the temp dir will be cleaned.

For VSCode users, extra flags could be configured via `Go: Generate Tests Flags`.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/862/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/862,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KHODd,kvrocks,1243406557,862,NA,PragmaTwice,20042607,Twice,,NA,2022-09-12T08:41:57Z,2022-09-12T08:41:57Z,It sounds good to me. cc @tisonkun ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KHODd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/862,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KHbY7,kvrocks,1243461179,862,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-12T09:27:08Z,2022-09-12T09:27:08Z,+1 I have a similar idea. Glad to see someone pick it up. ~~Wire to the `x.py` script may spend some time to improve the usability. I notice that current we pass `rest` at the end and it conflicts how `go test` processes args.~~,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KHbY7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/862,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KI6N_,kvrocks,1243849599,862,NA,PragmaTwice,20042607,Twice,,NA,2022-09-12T14:43:48Z,2022-09-12T14:43:48Z,"> +1 I have a similar idea. Glad to see someone pick it up. Wire to the `x.py` script may spend some time to improve the usability. I notice that current we pass `rest` at the end and it conflicts how `go test` processes args.

@tisonkun Maybe it is because `<build-dir>` is not specified? If you want to pass `rest`, `<build-dir>` will become a required option, e.g.
```
./x.py test go <build-dir> --some-args
```
to
```
go test ./... --some-args

# usage: go test [build/test flags] [packages] [build/test flags & test binary flags]
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KI6N_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/862,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KJBGi,kvrocks,1243877794,862,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-12T15:04:26Z,2022-09-12T15:04:26Z,@PragmaTwice you're right!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KJBGi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/862,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KnMs8,kvrocks,1251789628,862,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-20T03:25:26Z,2022-09-20T03:25:26Z,"This patch can work, but we may think a bit more on the CLI arguments part - how to pass the option.

```patch
diff --git a/tests/gocase/util/server.go b/tests/gocase/util/server.go
index d0ab1b7..3c80ec8 100644
--- a/tests/gocase/util/server.go
+++ b/tests/gocase/util/server.go
@@ -113,6 +113,7 @@ func StartServer(t testing.TB, configs map[string]string) *KvrocksServer {
                clean: func() {
                        require.NoError(t, stdout.Close())
                        require.NoError(t, stderr.Close())
+                       require.NoError(t, os.RemoveAll(dir))
                },
        }
 }
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KnMs8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/864,https://api.github.com/repos/apache/kvrocks/issues/864,kvrocks,1369509808,864,Move TCL test unit/config to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-12T08:50:24Z,2022-09-12T11:58:55Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/864/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/867,https://api.github.com/repos/apache/kvrocks/issues/867,kvrocks,1369593700,867,"Ci results are random, and the same code may succeed or fail",tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,CLOSED,2022-09-12T09:51:34Z,2022-09-13T15:15:11Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

[tison's pr](https://github.com/apache/incubator-kvrocks/pull/865) and [my pr](https://github.com/apache/incubator-kvrocks/pull/858)  both seem to have this problem.

### Minimal reproduce step

You can view it through my [PR](https://github.com/apache/incubator-kvrocks/pull/858) history.
If you have permission, you can reproduce it by restarting the CI.

### What did you expect to see?

There was no randomness in CI results.

### What did you see instead?

Ci results are random

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/867/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/867,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KIFWb,kvrocks,1243633051,867,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-12T11:58:46Z,2022-09-12T11:58:46Z,"These failures seem all to `scripting.tcl`. Since we're migrating tests, we can revisit all those tests.

If you found failures for other test cases, please point in out.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KIFWb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/867,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KPcZh,kvrocks,1245562465,867,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-13T15:15:11Z,2022-09-13T15:15:11Z,Closed to be covered as https://github.com/apache/incubator-kvrocks/issues/872. This issue doesn't have a clear target in description.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KPcZh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/868,https://api.github.com/repos/apache/kvrocks/issues/868,kvrocks,1370052647,868,Go testcases run failed for ziplist in CI,PragmaTwice,20042607,Twice,,CLOSED,2022-09-12T14:57:19Z,2022-09-13T15:13:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable e8efdf28260d31f181fc200ec9082f36d9294c47

### Minimal reproduce step

refer to https://github.com/apache/incubator-kvrocks/runs/8303808021

```
    list_test.go:202: 
        	Error Trace:	/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/list/list_test.go:202
        	Error:      	Not equal: 
        	            	expected: 200
        	            	actual  : 201
        	Test:       	TestZipList/ziplist_implementation:_value_encoding_and_backlink
=== RUN   TestZipList/ziplist_implementation:_encoding_stress_testing
    list_test.go:229: 
        	Error Trace:	/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/list/list_test.go:229
        	Error:      	Not equal: 
        	            	expected: 282
        	            	actual  : 283
        	Test:       	TestZipList/ziplist_implementation:_encoding_stress_testing
--- FAIL: TestZipList (18.74s)
```

### What did you expect to see?

success

### What did you see instead?

fail

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/868/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/868,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KI_r7,kvrocks,1243871995,868,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-12T15:00:05Z,2022-09-12T15:00:05Z,cc @torwig It seems this is an unstable test. Could you try to dig it out?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KI_r7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/868,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KJJ0q,kvrocks,1243913514,868,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-12T15:29:50Z,2022-09-12T15:29:50Z,"Not sure whether is caused by Go Redis client retry (default is 3) or not, see: [options.go#L63](https://github.com/go-redis/redis/blob/3d1e2e5bc8af1bfec675334a9a3f4cd9919dfda3/options.go#L63). Can disable the retry first if we don't know how to reproduce.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KJJ0q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/868,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KMOBz,kvrocks,1244717171,868,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-12T23:43:56Z,2022-09-12T23:43:56Z,@git-hulk OK. I made a patch #869 and let's see whether it works.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KMOBz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/868,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KPb1c,kvrocks,1245560156,868,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-13T15:13:27Z,2022-09-13T15:13:27Z,Closed as #869 merged. Feel free to reopen if it occurs again.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KPb1c/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/872,https://api.github.com/repos/apache/kvrocks/issues/872,kvrocks,1371617570,872,Move TCL test unit/scripting to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-13T15:13:58Z,2022-09-23T13:22:57Z,Be aware that current scripting tests are unstable. See also https://github.com/apache/incubator-kvrocks/issues/867.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/872/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/872,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KaGQe,kvrocks,1248355358,872,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-15T16:44:48Z,2022-09-15T16:44:48Z,[list_test.go](https://github.com/apache/incubator-kvrocks/actions/runs/3061992524/jobs/4942482133) is also unstable.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KaGQe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/872,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kb4rh,kvrocks,1248824033,872,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-16T01:53:28Z,2022-09-16T01:53:28Z,@tanruixiang can you provide run reports?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kb4rh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/872,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kb4ud,kvrocks,1248824221,872,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-16T01:53:53Z,2022-09-16T01:53:53Z,OK I see it.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kb4ud/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/872,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kb48e,kvrocks,1248825118,872,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-16T01:55:41Z,2022-09-16T01:55:41Z,"@vmihailenco it seems after Kvrocks tests migrated to go-redis, some cases fail with:

```
    list_test.go:203: 
        	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/list/list_test.go:203
        	Error:      	Received unexpected error:
        	            	read tcp 127.0.0.1:55526->127.0.0.1:45695: i/o timeout
        	Test:       	TestZipList/ziplist_implementation:_value_encoding_and_backlink
```

when under stress. What's the best practice go-redis retry to set up a reasonable timeout in this case?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kb48e/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/872,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kccn0,kvrocks,1248971252,872,NA,vmihailenco,290976,Vladimir Mihailenco,vladimir.webdev@gmail.com,NA,2022-09-16T06:32:30Z,2022-09-16T06:32:30Z,"There is a `MaxRetries` options and it seems to be enabled by default - https://github.com/go-redis/redis/blob/master/options.go#L61-L69

What Read/WriteTimeout do you use?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kccn0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/872,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KgsCM,kvrocks,1250082956,872,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-17T14:38:56Z,2022-09-17T14:38:56Z,"@vmihailenco I think the first time we even disable retry https://github.com/apache/incubator-kvrocks/pull/869 to try to address this flaky test. The reason then is we may reduce the workload caused by retries. But it seems we need to extend the retry time and timeout interval. However, always increasing waiting interval and retry time seems not a good idea...

Would you suggest a suitable config here?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KgsCM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/872,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K4C9V,kvrocks,1256206165,872,NA,vmihailenco,290976,Vladimir Mihailenco,vladimir.webdev@gmail.com,NA,2022-09-23T13:22:57Z,2022-09-23T13:22:57Z,">Would you suggest a suitable config here?

Looks like you are using the default config which has Read/WriteTimeout = 3 seconds. It should work just fine, but you can try to increase the timeout. Nothing else comes to mind.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K4C9V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/873,https://api.github.com/repos/apache/kvrocks/issues/873,kvrocks,1371621201,873,Unit test has wrong sleep time,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-13T15:16:22Z,2022-09-26T09:17:33Z,"https://github.com/apache/incubator-kvrocks/blob/unstable/tests/cppunit/rwlock_test.cc#L170

This unit test sleep time is NOT right, expected 100ms but current is 1ms. I think 1ms is too short to guarantee the else condition thread will be always be scheduled before the if condition. I'll bring this sleep time fix in the next PR.

_Originally posted by @git-hulk in https://github.com/apache/incubator-kvrocks/issues/870#issuecomment-1244844809_","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/873/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/874,https://api.github.com/repos/apache/kvrocks/issues/874,kvrocks,1372418857,874,The requirement of two commands for Kvrocks ,lrb1996,113498860,,,CLOSED,2022-09-14T06:27:57Z,2022-10-11T06:52:56Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

 I have a requirement which I hope you dear admins can fix.  When we use Redis, we can easily know the memory usage of the specific key by using command ""memory usage key "" as well as the keyspace hits percentage of the specific key by using command ""info"".  **But for Kvrocks, we can't easily get the information by using commands.**  In conclusion, i'll appreciate it if you can solve this problem.  Looking forward to your reply, thank you!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/874/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/874,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KTKjJ,kvrocks,1246537929,874,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-14T10:09:02Z,2022-09-14T10:09:02Z,"Do you mean the disk space usage of key? Kvrocks stores its data in disk instead of the memory, so the memory usage of key is meaningless for Kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KTKjJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/874,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KTPiZ,kvrocks,1246558361,874,NA,lrb1996,113498860,,,NA,2022-09-14T10:24:15Z,2022-09-14T10:24:15Z,"> 

Thanks for your reply.  I know that Kvrocks stores its data in disk instead of the memory,  but i think it's also necessary to know the size of the specific key accurately, otherwize it may cause the abnormal increment of the cpu percentage or some other related indexes for the machine.  As a dba, i need to contact the developers to focus the unusual key as fast as i find unusal indexes mentioned above of machines. So I wonder if there's a fast way to get the size of the specific key (disk space usage of key)  clearly like Redis. Thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KTPiZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/874,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KTeEi,kvrocks,1246617890,874,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-14T11:18:36Z,2022-09-14T11:18:36Z,"Thanks for your clarification. It makes sense to export the value size of the specific key, and it should be possible since the RocksDB has a way to get the approximate size with the prefix if my memory serves.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KTeEi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/874,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KUxW8,kvrocks,1246959036,874,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-14T15:42:10Z,2022-09-14T15:42:10Z,"> 



> Thanks for your clarification. It makes sense to export the value size of the specific key, and it should be possible since the RocksDB has a way to get the approximate size with the prefix if my memory serves.
 
@git-hulk  Hi. Maybe u mean `GetApproximateSizes`. I am willing to do this task. Can you give me some guidance?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KUxW8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/874,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KVF0Q,kvrocks,1247042832,874,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-14T16:49:14Z,2022-09-14T16:49:14Z,"@tanruixiang sure, thanks for your interest. We want a command like Redis [MEMORY USAGE](https://redis.io/commands/memory-usage/) except the usage should be disk space, and as you said we can use `GetApproximateSizes` to count the approximate size. 

So what we need to do is:
1. implement a command like `DISK USAGE key` and [SAMPLES count] is no need.
2. Count the value size directly if the key type is a string, or we need to use `GetApproximateSizes` to get the key size with a prefix. The prefix should be composed of key and version since we use the version to identify the live subkeys. I think you can have a look at [How Kvrocks Design Complex Structure On Rocksdb](https://kvrocks.apache.org/docs/Design/design-structure-on-rocksdb) and come back to discuss if you still don't know how to do that.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KVF0Q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/876,https://api.github.com/repos/apache/kvrocks/issues/876,kvrocks,1373871665,876,Delete expired big keys during first query,Phoeniwx,25687584,,phoeniwx@outlook.com,OPEN,2022-09-15T03:45:23Z,2022-09-15T05:47:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We encountered a slow log problem when accessing a rather small key. This key is in cold data and kvrocks took 0.82s to get it every time.
```
10.x.x.x:6379> strlen ""scene:xxx:-1""
(integer) 0
(0.82s)
```
Here is the perflog. We can see it took most time in reading block phase, which processed 73752672 bytes. Every time we accessed the key, same thing happened, until a compaction.
```
10.x.x.x:6379> perflog get *
1) 1) (integer) 1
   2) (integer) 1662454072
   3) ""strlen""
   4) (integer) 633163
   5) ""user_key_comparison_count = 76, block_read_count = 1, block_read_byte = 73752672, block_read_time = 59590859, block_checksum_time = 9643232, block_decompress_time = 350221281, get_read_bytes = 247610038, get_snapshot_time = 883, get_from_memtable_time = 4306, get_from_memtable_count = 1, get_post_process_time = 1681, get_from_output_files_time = 426225825, new_table_block_iter_nanos = 426163267, block_seek_nanos = 36515, bloom_sst_hit_count = 1, bloom_sst_miss_count = 2, ""
   6) ""thread_pool_id = 4, bytes_read = 73752672, read_nanos = 59588262, ""
```
After discussing with developers, we found this is caused by a expired big key. In every querying, kvrocks  accessed the big key to retrive its ttl, which took a lot of IO time. 


### Solution

Maybe we can solve this problem by deleting these kind of expired big keys during the first querying, which should avoid accessing bigkeys every time. Or there may be a better solution. Hope you guys can solve this, thanks.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/876/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/876,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KXD-K,kvrocks,1247559562,876,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-15T04:14:05Z,2022-09-15T04:14:05Z,Thanks for your feedback. Maybe we need a smarter compaction strategy which can compact range in-flight when finding there're too many deleted or expired tombstones.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KXD-K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/877,https://api.github.com/repos/apache/kvrocks/issues/877,kvrocks,1373887497,877,bigkeys analyze support,Phoeniwx,25687584,,phoeniwx@outlook.com,CLOSED,2022-09-15T04:11:03Z,2023-06-25T11:54:05Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We all know redis support --bigkeys & --memkeys commands, which can help us analyze bigkeys conveniently. Or we can use rdb generated by redis to parse bigkeys.
```
$ redis-cli --bigkeys

# Scanning the entire keyspace to find biggest keys as well as
# average sizes per key type.  You can use -i 0.01 to sleep 0.01 sec
# per SCAN command (not usually needed).

[00.00%] Biggest string found so far 'key-419' with 3 bytes
[05.14%] Biggest list   found so far 'mylist' with 100004 items
[35.77%] Biggest string found so far 'counter:__rand_int__' with 6 bytes
[73.91%] Biggest hash   found so far 'myobject' with 3 fields
```
However, according to my knowledge, kvrocks does not support --bigkeys or --memkeys, because of its different iteration way and other reasons, wshich makes it hard to analyze bigkeys.

### Solution

Maybe you guys can add a --bigkeys(--memkeys) feature like redis or generate some kind of rdb-like file for us to analyze? thanks ; ).

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/877/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/877,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KhIjY,kvrocks,1250199768,877,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-09-18T06:05:15Z,2022-09-18T06:05:15Z,"Seems that redis implement `--bigkey` as a client tool: https://github.com/redis/redis/blob/unstable/src/redis-cli.c#L8257 , it will send `scan` to sample the bigkeys.

Maybe I can try to test using `--bigkey` in client in next few weeks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KhIjY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/877,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KhNKx,kvrocks,1250218673,877,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-18T08:17:30Z,2022-09-18T08:17:30Z,"Thanks to @mapleFU, it's true that Redis implements its big key detection in the redis-cli with the scan command. The reason why Kvrocks don't support the `redis-cli --bigkey` is we now return the string as scan iterator cursor instead of an integer, so it can't be compatible with redis-cli now","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KhNKx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/877,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5edQUQ,kvrocks,1584727312,877,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-09T15:00:57Z,2023-06-09T15:00:57Z,"![image](https://github.com/apache/incubator-kvrocks/assets/32858525/d170713a-4f8e-4bdd-adfe-7f943bee46e0)
After I fix https://github.com/apache/incubator-kvrocks/issues/1402, `redis-cli --bigkeys` is work.
But redis-cli uses `DBSIZE` to get the total number of keys and calculates the progress based on this information. 
So before we run  `DBSIZE scan`, dbsize is 0,  progress bar wiil display [ -nan%] or [  inf%].
We need to fix this issue? @git-hulk 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5edQUQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/877,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5edT3a,kvrocks,1584741850,877,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T15:10:03Z,2023-06-09T15:10:03Z,"@jihuayu 

Cool, I think it's fine to display [-nan%] or [inf%], and ask users to execute the dbsize scan command if they wanna see the percent.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5edT3a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/877,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eddwP,kvrocks,1584782351,877,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-09T15:36:58Z,2023-06-09T15:36:58Z,"@git-hulk 
These texts are completely from redis-cli and we cannot control them. 
I think we can add the FAQ to our doc.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eddwP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/877,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ef2BV,kvrocks,1585406037,877,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-10T01:27:52Z,2023-06-10T01:27:52Z,"> @git-hulk
> These texts are completely from redis-cli and we cannot control them.
> I think we can add the FAQ to our doc.

Yes, we can guide them via the documentation.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ef2BV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/878,https://api.github.com/repos/apache/kvrocks/issues/878,kvrocks,1374352503,878,disableWAL option,tufitko,10697000,Andrei Vydrin,tufitko@gmail.com,CLOSED,2022-09-15T11:10:09Z,2022-09-29T06:39:01Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We are using kvrocks with client sharding, also we can lose data. So, WAL is useless for us and it just makes additional write pressure. 

### Solution

I made some changes to ensure about this: https://github.com/apache/incubator-kvrocks/commit/bb1ba2eb0e2897b17e73ec3af8320d82d4872a07

I can replace `rocksdb::WriteOptions()` to global WriteOptions with optional disabledWAL, what do you think about it?

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/878/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/878,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KYrjV,kvrocks,1247983829,878,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-15T11:37:46Z,2022-09-15T11:37:46Z,"Thanks for @tufitko feedback. So you don't need the replication, right?

I thinks we can add a new config option to let users to disable the WAL, and also need to forbid the `slaveof` command when the WAL is disabled since the replication can't work without it. How do you think?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KYrjV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/878,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KY5V9,kvrocks,1248040317,878,NA,tufitko,10697000,Andrei Vydrin,tufitko@gmail.com,NA,2022-09-15T12:33:30Z,2022-09-15T12:33:30Z,"@git-hulk yeah, we don't need replicas. About `slaveof` sounds good, so I'm gonna make PR at the weekends","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KY5V9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/878,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KZBVR,kvrocks,1248073041,878,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-15T13:03:25Z,2022-09-15T13:03:25Z,"> @git-hulk yeah, we don't need replicas. About `slaveof` sounds good, so I'm gonna make PR at the weekends

Cool, thanks. Can just reply error in the slaveof command if the WAL is disabled.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KZBVR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/878,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kc5b7,kvrocks,1249089275,878,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-16T08:41:04Z,2022-09-16T08:41:04Z,"What is the benefits from disabling WAL? This mechanism, as I remember, used for parallels writers, thats can work without blocking too. And, of course, data safety are poor. This only reduce a disk I/O, but in sequential mode (like WAL) I think, its no a lot of problem. maybe you want to reduce storage - you can disable wal history (in archive directory inside). Maybe this can help you quickly?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kc5b7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/878,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KdZhC,kvrocks,1249220674,878,NA,tufitko,10697000,Andrei Vydrin,tufitko@gmail.com,NA,2022-09-16T10:52:50Z,2022-09-16T10:52:50Z,"@aleksraiden It's exactly for reducing a disk I/O. We have a lot of data to write, so any reduction of IO helps us.  ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KdZhC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/878,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kdn6M,kvrocks,1249279628,878,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-16T12:02:29Z,2022-09-16T12:02:29Z,"@tufitko, ok, interested to me too. I have a medium-load system (streams, ~20K rps, 100M+ msg in history, but 7.2.2 rocksdb) based on kvrocks, I will interest to test this patch too. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kdn6M/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/879,https://api.github.com/repos/apache/kvrocks/issues/879,kvrocks,1375135245,879,Add support for function commands like Redis,usrtax,110233389,wac.tax,i@user.tax,CLOSED,2022-09-15T22:02:31Z,2023-10-01T06:30:56Z,"
is kvrocks suppport redis function ? 

Redis functions Scripting with Redis 7 and beyond
https://redis.io/docs/manual/programmability/functions-intro/

Redis Functions is an API for managing code to be executed on the server. This feature, which became available in Redis 7, supersedes the use of [EVAL](https://redis.io/docs/manual/programmability/eval-intro) in prior versions of Redis.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/879/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/880,https://api.github.com/repos/apache/kvrocks/issues/880,kvrocks,1375155018,880,Add support for RESP3,usrtax,110233389,wac.tax,i@user.tax,CLOSED,2022-09-15T22:20:05Z,2024-03-11T09:14:16Z,"https://redis.io/commands/hello/
```
redis.setresp(3)
```

https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md
RESP3 is an updated version of RESP v2, which is the protocol used in Redis starting with roughly version 2.0 (1.2 already supported it, but Redis 2.0 was the first version to talk only this protocol). The name of this protocol is just RESP3 and not RESP v3 or RESP 3.0.


for example use in lua

```
local function my_hgetall(keys, args)
  redis.setresp(3)
  local hash = keys[1]
  local res = redis.call('HGETALL', hash)
  res['map']['_last_modified_'] = nil
  return res
end
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/880/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/880,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eat2X,kvrocks,1584061847,880,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-09T06:48:39Z,2023-06-09T06:48:39Z,"BTW, we can split the task to many functions and support the resp3 protocol gradually.

We can give a tracking issue based on different types from [resp3.md](https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md) currently.

Could I ask your advice? @torwig @PragmaTwice @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eat2X/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/880,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebX6X,kvrocks,1584234135,880,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T09:08:14Z,2023-06-09T09:08:14Z,"> We can give a tracking issue based on different types from [resp3.md](https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md) currently.

Sure, it's good to separate sub-tasks by the data type, but we need to offer a unified way to determine whether to use RESP3 or not like the encoding: https://github.com/apache/incubator-kvrocks/blob/f557255cec8d4f43cf63144b712c71026bc9320e/CMakeLists.txt#L34. And should NOT enable it before all data types are supported RESP3.


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebX6X/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/884,https://api.github.com/repos/apache/kvrocks/issues/884,kvrocks,1376982911,884,Add redis-benchmark to CI,PragmaTwice,20042607,Twice,,OPEN,2022-09-18T08:23:12Z,2024-09-10T20:04:46Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We can design a phase in CI (triggerred by PR or daily) to automatically run redis-benchmark to test the stability and performance of kvrocks under a certain commit, and report it while an evident performance downgrade or crash occurs in the benchmark phase.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/884/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/884,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LYKjj,kvrocks,1264625891,884,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-10-02T11:59:21Z,2022-10-02T11:59:21Z,"I thinked about this feature. Very cool, we need this tests.

IMHO, we can add to x.py file something like this:

`./x.py benchmark --bench-path=` 

with default value of client/request etc. 

In CI script, we change step ""Install redis"" and copy redis-benchmark into  $HOME/local/bin/.

Then we use -q options and run benchmark in quite format, just output req/sec. 

In a first stage this numbers only for view, but maybe we can store a some historical tests results into file and after bench are running, check deviations. 

So, I'am not a excellent C/Python/CI dev, but I can try to realize this step-by-step","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LYKjj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/884,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LYWMy,kvrocks,1264673586,884,NA,PragmaTwice,20042607,Twice,,NA,2022-10-02T15:49:10Z,2022-10-02T15:49:10Z,"Thanks for your interest, please go ahead!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LYWMy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/884,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LYZRb,kvrocks,1264686171,884,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-10-02T16:49:52Z,2022-10-02T16:49:52Z,"Thanks, gets to work","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LYZRb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/884,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LlsZr,kvrocks,2341914219,884,NA,thbley,941223,Thomas,,NA,2024-09-10T20:04:45Z,2024-09-10T20:04:45Z,"I used ""apk add redis"" within the standard-container (apache/kvrocks:2.8.0) and Ryzen7 PRO 7840U.

benchmark command:
- redis-benchmark -r 10000 -c 64 --threads 8 -p 6379 -t set -n 10000000 -d 64

Redis 7.0.15 (default config):
- ""io-threads 1"": rps=159115.5
- ""io-threads 2"": rps=210508.0
- ""io-threads 4"": rps=249928.0
- ""io-threads 8"": rps=248720.0
- ""io-threads 12"": rps=166864.0
- ""io-threads 16"": rps=81694.4

kvrocks v2.8
- ""worker 1"": rps=80468.0
- ""worker 2"": rps=151312.0
- ""worker 4"": rps=223028.0
- ""worker 8"": rps=265768.9
- ""worker 12"": rps=206741.0
- ""worker 16"": rps=188637.5

Quite impressive!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LlsZr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/886,https://api.github.com/repos/apache/kvrocks/issues/886,kvrocks,1376991669,886,rework compaction filter when used blobs,tufitko,10697000,Andrei Vydrin,tufitko@gmail.com,CLOSED,2022-09-18T09:04:18Z,2022-09-29T06:38:49Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We have quite big messages (~100Mib), so we decided to use BlobDB to decrease pressure on disk. But this action decreases write throughput and increase read iops because RocksDB reads data from blobfiles.
Current SubKeyFilter gets values of keys only to check bitmap emptiness. I think it's too wasteful. Every compaction is painful. 
It's possible to implement `FilterBlobByKey`?  

### Solution

I've made implementation of `FilterBlobByKey`. We don't use bitmaps, so it works for us. This almost completely removes the reads of blobs
What do you think about it?
https://github.com/apache/incubator-kvrocks/commit/299f45a680970c84ac75759848b6fb1b9f4dd6fa

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/886/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/886,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KhTMB,kvrocks,1250243329,886,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-18T10:53:22Z,2022-09-18T10:53:22Z,"Cool, @ShooterIT @caipengbo @shangxiaoxiong Can help to have a look if you're free?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KhTMB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/886,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ki3g_,kvrocks,1250654271,886,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-09-19T07:17:42Z,2022-09-19T07:17:42Z,"@tufitko This is a good optimization point, in most cases we can make a decision about a key-value solely based on the key in compaction filter. 

Just as you said we can introduce new `FilterBlobByKey` interface to optimize it:
- For the bitmap type, we can return `kUndetermined` in `FilterBlobByKey` to read the value further. 
- For the other types, we just need to read the key through `FilterBlobByKey`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ki3g_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/886,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kjrt9,kvrocks,1250868093,886,NA,tufitko,10697000,Andrei Vydrin,tufitko@gmail.com,NA,2022-09-19T10:58:19Z,2022-09-19T10:58:19Z,"@caipengbo so, I can create PR based on my commit? Should it be optional or nothing to worry about bitmap?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kjrt9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/886,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KjvZ7,kvrocks,1250883195,886,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-09-19T11:15:02Z,2022-09-19T11:15:02Z,"@tufitko Good job! I don't think there's anything to worry about with bitmap, just do it!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KjvZ7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/889,https://api.github.com/repos/apache/kvrocks/issues/889,kvrocks,1377521782,889,Move TCL test unit/pubsub to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-19T07:25:19Z,2022-10-13T08:15:52Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/889/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/890,https://api.github.com/repos/apache/kvrocks/issues/890,kvrocks,1377522041,890,Move TCL test unit/introspection to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-09-19T07:25:33Z,2022-10-07T08:51:45Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/890/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/891,https://api.github.com/repos/apache/kvrocks/issues/891,kvrocks,1377724925,891,Kvrocks sends negative ttl while migrating slot,ellutionist,35825540,CHENG PENG,impc53802956@163.com,CLOSED,2022-09-19T10:17:18Z,2022-10-04T11:44:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

OS:
Distributor ID: Ubuntu
Description:    Ubuntu 22.04.1 LTS
Release:        22.04

Kvrocks:
v2.1.0

### Minimal reproduce step

1. Create a kvrocks cluster of 2 nodes:
```
127.0.0.1:6666> cluster nodes
KEp2lfd524nItcLDNm=nkrTgxxRa2OnyfCorGqiw 127.0.0.1:6666@16666 myself,master - 1663582260999 1663582261000 1 connected 0-8191
iv3zxA39N1kXg23BmGAchLynaNCG2K284QvpgklT 127.0.0.1:6667@16667 master - 1663582260999 1663582261000 1 connected 8192-16383
```

2. Set a key into one node, which expres in 5 seconds:
```
127.0.0.1:6666> set key00000000000000007100 key00000000000000007100 ex 5
OK
```

3. Check the slot:
```
127.0.0.1:6666> cluster keyslot key00000000000000007100
(integer) 35
```

4. After 5 seconds, migrate the slot to the other node, the migration will fail:
```
127.0.0.1:6666> clusterx migrate 35 iv3zxA39N1kXg23BmGAchLynaNCG2K284QvpgklT
OK
```

```
127.0.0.1:6666> cluster info
cluster_state:ok
cluster_slots_assigned:16384
cluster_slots_ok:16384
cluster_slots_pfail:0
cluster_slots_fail:0
cluster_known_nodes:2
cluster_size:2
cluster_current_epoch:1
cluster_my_epoch:1
migrating_slot: 35
destination_node: iv3zxA39N1kXg23BmGAchLynaNCG2K284QvpgklT
migrating_state: fail
```

5. Error log:
```
E20220919 18:14:55.837342 639656 slot_migrate.cc:495] [migrate] Got invalid response: -ERR invalid expire time, line length: 24
E20220919 18:14:55.837354 639656 slot_migrate.cc:793] [migrate] Wrong response
E20220919 18:14:55.837363 639656 slot_migrate.cc:320] [migrate] Failed to send left data in pipeline
E20220919 18:14:55.837378 639656 slot_migrate.cc:182] [migrate] Failed to send snapshot
I20220919 18:14:55.837489 639656 slot_migrate.cc:211] [migrate] Failed to migrate slot35
I20220919 18:14:55.837498 639656 slot_migrate.cc:380] [migrate] Clean resources of migrating slot 35
```

### What did you expect to see?

Migrate success when executing `cluster info`.

### What did you see instead?

Migrate failed.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/891/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/891,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KjuAu,kvrocks,1250877486,891,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-19T11:08:52Z,2022-09-19T11:08:52Z,"Cool, thanks for your feedback.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KjuAu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/891,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Km2CV,kvrocks,1251696789,891,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2022-09-20T00:12:40Z,2022-09-20T00:12:40Z,Looking forward to your PR,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Km2CV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/891,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KnGgd,kvrocks,1251764253,891,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-09-20T02:34:55Z,2022-09-20T02:34:55Z,"Indeed, this is a bug. For expired keys, we should filter them out at the source side.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KnGgd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/891,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LerYt,kvrocks,1266333229,891,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-04T03:03:14Z,2022-10-04T03:03:14Z,@ellutionist @git-hulk @caipengbo shall we close this issue as completed with https://github.com/apache/incubator-kvrocks/pull/901?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LerYt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/891,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LgsYt,kvrocks,1266861613,891,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-04T11:44:19Z,2022-10-04T11:44:19Z,"Yes, sorry for forgetting this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LgsYt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/893,https://api.github.com/repos/apache/kvrocks/issues/893,kvrocks,1378055745,893,"After the single test, sending SIGTERM or SIGINT",ColinChamber,95634254,ColinChamber,,CLOSED,2022-09-19T14:30:14Z,2022-09-25T07:25:23Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

After the single test, sending SIGTERM or SIGINT that kvrocks can handle may be better than sending it directly to [KILL](https://github.com/apache/incubator-kvrocks/blob/unstable/tests/gocase/util/server.go#L62). We can also check whether kvrocks can exit gracefully.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/893/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/894,https://api.github.com/repos/apache/kvrocks/issues/894,kvrocks,1378073810,894,Support Hrange command,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,CLOSED,2022-09-19T14:42:41Z,2022-09-20T16:14:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

According to [kvrocks 3.0 roadmap](https://github.com/apache/incubator-kvrocks/projects/2#card-81014194), add hrange command.

### Solution

Since kvrocks uses rocksdb as the storage engine, keys are ordered in sstable. So we can easily provide a range query command for hash.
We give the following command:
hrange hashkey $start $end [LIMIT $number]
For the specified hashkey, We will get the kv-pair with the kv-pair's key located in [start, stop) interval in the hash. If the limit is set, at most limit kv pairs will be returned.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/894/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/894,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KnFVu,kvrocks,1251759470,894,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-09-20T02:25:48Z,2022-09-20T02:25:48Z,"It would be nice to explain the syntax of the hrange command in this PR, not only to make it easier to read the code, but also to migrate the syntax to a document (website) in the future.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KnFVu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/896,https://api.github.com/repos/apache/kvrocks/issues/896,kvrocks,1378101677,896,Replace std::stol with ParseInt.,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,CLOSED,2022-09-19T15:01:21Z,2022-09-25T08:04:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

There are many places in the code that use std::stol. Replace std::stol with ParseInt. Use ParseInt instead of std::stol for safer parsing.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/896/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/904,https://api.github.com/repos/apache/kvrocks/issues/904,kvrocks,1381710019,904,Avoid using Get interface to obtain Metadata when iterating data during migration,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2022-09-22T01:56:01Z,2022-09-24T09:00:49Z,"### Motivation

When migrating data, I found that when migrating the same number of keys (about 10W), the migration time was very variable, sometimes very short, sometimes very long. When the migration took a long time, I found that the CPU was full. 

Looking at the flame diagram below:

![image](https://user-images.githubusercontent.com/19643013/191640494-84217f78-48d4-442b-b18d-12ac1628b306.png)

we can see that there is a **deep call stack** on the left. 

Zoomed in it:

![image](https://user-images.githubusercontent.com/19643013/191640728-2c04c864-39b2-45e4-bc52-7a34c2e1912a.png)

When we parsed and sent the full data (`SlotMigrate::SendSnapshot()`), we used the `rocksdb::DB::Get()` interface to get the metadata, which was CPU consuming.

### How much does this affect migration speed?

1. Because we set the iterator to not fill the cache, when the amount of data is larger than cache, it is very likely that we will call `rocksdb::DB::Get()` to read disk, which greatly affects the performance!
2. If the retrieval in memtable is bad( it depends on workload), then it will consume more CPU, which will bring more serious impact.

### Solution

In fact, we do not need to get the value through the `rocksdb::DB::Get()` interface. When we iterate data, value and key are together, so we can directly get the value through the iterator and then encode into metadata.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/904/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/904,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KxT5v,kvrocks,1254440559,904,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-22T02:36:02Z,2022-09-22T02:36:02Z,"Yes, good catch.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5KxT5v/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/904,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kx_pO,kvrocks,1254619726,904,NA,datavisorxiaobiaozhao,45584929,XiaobiaoZhao,,NA,2022-09-22T07:10:33Z,2022-09-22T07:10:33Z,I have tested and confirmed that this is an issue. The fix works and can speed up migration by 10-100 times.Looking forward to your PR,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Kx_pO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/904,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K2koo,kvrocks,1255819816,904,NA,shangxiaoxiong,52746580,XiongDa,,NA,2022-09-23T05:41:34Z,2022-09-23T05:41:34Z,"> I have tested and confirmed that this is an issue. The fix works and can speed up migration by 10-100 times.Looking forward to your PR

More than 10 times? Are you serious?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K2koo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/904,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K36R3,kvrocks,1256170615,904,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-09-23T12:50:54Z,2022-09-23T12:50:54Z,"The original purpose of using `rocksdb::DB::Get()` to Get Metadata, I guess is to get the latest metadata (but mistakenly using the old snapshot).

The purpose of this is: snapshot is created at the beginning of the migration. If a slot has been migrated for a long time, users may change the number of subkeys in complex types or change the expiration time. If we use metadata in very old snapshot to determine the expiration time, we may make a mistake. The subkey cannot be migrated to the target end. WAL only records metadata changes, not subkeys. In this case, subkeys will be completely lost. 

However, as we discussed in #906, even if we get the latest snaphot, we still can't prevent users from modifying complex types of metadata. We still make errors in judgment. 

As of now, this problem is unavoidable, and we welcome discussion of effective solutions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K36R3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/907,https://api.github.com/repos/apache/kvrocks/issues/907,kvrocks,1381956508,907,Disable the TLS by default when building,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-09-22T07:19:06Z,2022-09-24T15:14:23Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

For most users should NOT need TLS version,  so I think we can disable it by default like `Redis` and guide users to enable it if they need this feature.

### Solution

Change `ENABLE_OPENSSL` from `ON` to `OFF`

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/907/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/908,https://api.github.com/repos/apache/kvrocks/issues/908,kvrocks,1381961234,908,Use Lua vm by default instead of LuaJIT,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-09-22T07:23:03Z,2022-10-04T03:12:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

LuaJIT can improve the performance a lot in compute intensive scenario,
but we didn't test carefully about compatible. So I think we can use the Lua
VM by default and guide user to enable it if they need it.

cc @xiaobiaozhao 


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/908/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/908,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3V1w,kvrocks,1256021360,908,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-23T10:04:17Z,2022-09-23T10:04:17Z,"@git-hulk is there a real use case for this claim? LuaJIT passes all our test cases and if we don't enable new feature by default, it will hardly get feedback to be solid.

I'd say, if you're unconfident with LuaJIT, please build with Lua following these commands: ...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3V1w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/908,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3Z0J,kvrocks,1256037641,908,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-23T10:21:51Z,2022-09-23T10:21:51Z,"Yes, my concern is we didn't have enough test cases to prove the LuaJIT compatibility, so I think it's too rush to replace Lua VM in the next release. Besides, I think it's fine to enable by default if it's totally a new feature and useful for most users.

Does it sound good to disable by default in next release? I will contact and push users what I know to have a test.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3Z0J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/908,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3tCb,kvrocks,1256116379,908,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-23T11:54:07Z,2022-09-23T11:54:07Z,"@git-hulk It's reasonable to have a clear signal of stability; otherwise, it's a ""pocket"" to prevent enabling the feature by default. For example, Flink supports RegionFailoverStrategy in 1.9 and has a determinate target to enable it by default in 1.11. So contributors are encouraged to polish the feature since it _will_ be pushed to production.

Besides, a well-written release note will highlight this change and users should upgrade with awareness.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3tCb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/908,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3u4F,kvrocks,1256123909,908,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-23T12:02:36Z,2022-09-23T12:02:36Z,"Yes, agree we should enable new features by default if possible. But it's our first release to involve LuaJIT, so I think it will be better to let users know and try it first, then we can claim clearly that we will enable by default in the next feature. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K3u4F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/908,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K4bxD,kvrocks,1256307779,908,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2022-09-23T14:43:58Z,2022-09-23T14:43:58Z,"I don't think there's any question about Luajit's stability. However, if turned on luajit as the default switch, it is not friendly to users who upgrade directly. An important tip for users who need high performance is to enable Luajit.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K4bxD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/908,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LestU,kvrocks,1266338644,908,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-04T03:12:17Z,2022-10-04T03:12:17Z,Closed by #916.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LestU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/915,https://api.github.com/repos/apache/kvrocks/issues/915,kvrocks,1384612587,915, Is it appropriate to change StartServer to a factory that returns the Server interface? ,ColinChamber,95634254,ColinChamber,,CLOSED,2022-09-24T09:50:44Z,2022-10-04T03:04:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

I will submit a PR about save-rdb, which needs to start Redis server to do some integration tests. Kvrocks2redis can also use that. And some tests can also be written as

-  `require.EqualValues(t, rdb.Get(ctx, ""foo"").Val(), kdb.Get(ctx, ""foo"").Val()))`

### Solution

func StartServer(t testing.TB, st ServerType, configs map[string]string) IServer { 
...
}

srvRedis := util.StartServer(t, util.TypeRedis ,map[string]string{})
srvKvrocks := util.StartServer(t, util.TypeKvrocks ,map[string]string{})

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/915/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/915,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K6z02,kvrocks,1256930614,915,NA,PragmaTwice,20042607,Twice,,NA,2022-09-24T10:09:37Z,2022-09-24T10:09:37Z,"I think if the code of `StartServer` can be reused well for both kvrocks and redis, they can be implemented in one function. If it is just a dispatch, but the two parts of the code need to be completely separately implemented, then I think it is better to implement it as two functions `StartKvrocksServer` and `StartRedisServer`, and then you can implement a function like `StartServer` to do a dynamic dispatch. cc @tisonkun ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K6z02/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/915,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K7m1u,kvrocks,1257139566,915,NA,ColinChamber,95634254,ColinChamber,,NA,2022-09-25T07:37:02Z,2022-09-25T07:37:02Z,"Thanks for your guidance. I've tried several things.  #920 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K7m1u/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/915,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lerir,kvrocks,1266333867,915,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-04T03:04:12Z,2022-10-04T03:04:12Z,"See also:

* https://github.com/apache/incubator-kvrocks/pull/920#issuecomment-1265418310
* https://github.com/apache/incubator-kvrocks/pull/920#issuecomment-1265422735","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lerir/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/918,kvrocks,1384861672,918,support Multi-disk(Multi-path),xiaobiaozhao,52393536,xiaobiaozhao,,OPEN,2022-09-25T01:27:30Z,2023-02-03T02:06:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

When the host has multiple disks, multiple disks can be used for data storage to increase the performance of KVROCKS.
Hot data can be stored on local SSDS and cold data can be stored on cloud disks

### Solution

```
option.db_paths = {
                     {""/disk1"", 1000 * 1000 * 1000},
                     {""/disk2"", 1000 * 1000 * 1000},
                     {""/disk3"", 1000 * 1000 * 1000},
                     {""/disk4"", 1000 * 1000 * 1000}};
```

https://github.com/facebook/rocksdb/blob/main/include/rocksdb/options.h#L672

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/918/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K7cl6,kvrocks,1257097594,918,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-09-25T01:38:12Z,2022-09-25T01:38:12Z,"Hi @xiaobiaozhao, I have two questions: 
1. Why can multiple disks improve performance? Multiple paths do not seem to work in parallel.
3. How do we judge hot and cold data in kvrocks? Rocksdb simply determines where to place the SST based on when the SST was generated.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K7cl6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K760s,kvrocks,1257221420,918,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-25T15:46:45Z,2022-09-25T15:46:45Z,"> Hi @xiaobiaozhao, I have two questions:
> 
> 1. Why can multiple disks improve performance? Multiple paths do not seem to work in parallel.
> 2. How do we judge hot and cold data in kvrocks? Rocksdb simply determines where to place the SST based on when the SST was generated.

According to the description of the configuration, the lower level SST will be stored in the front of the `db_paths`. So we can arrange the `db_paths` according to the speed of the storage medium, and put the low-level SST in the faster storage medium, for example, put the SSD in the first of the `db_paths` to storage the low-level SST.

In fact, the level at which `SST` is located represents the hot and coldness of the data. Because rocksdb uses the LSM tree, it will naturally merge cold data to a higher level.

So if this feature is used, rocksdb can help us store cold data in slower storage media such as mechanical hard drives, and store hot data in faster storage media such as SSD.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K760s/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K8Rg_,kvrocks,1257314367,918,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2022-09-25T23:56:56Z,2022-09-25T23:56:56Z,"
> > Hi @xiaobiaozhao, I have two questions:
> > 
> > 1. Why can multiple disks improve performance? Multiple paths do not seem to work in parallel.
> > 2. How do we judge hot and cold data in kvrocks? Rocksdb simply determines where to place the SST based on when the SST was generated.
> 
> According to the description of the configuration, the lower level SST will be stored in the front of the `db_paths`. So we can arrange the `db_paths` according to the speed of the storage medium, and put the low-level SST in the faster storage medium, for example, put the SSD in the first of the `db_paths` to storage the low-level SST.
> 
> In fact, the level at which `SST` is located represents the hot and coldness of the data. Because rocksdb uses the LSM tree, it will naturally merge cold data to a higher level.
> 
> So if this feature is used, rocksdb can help us store cold data in slower storage media such as mechanical hard drives, and store hot data in faster storage media such as SSD.

Yes，In my test demo，rocksdb use first & last of the `dp_paths` config only. 

```
option.db_paths = {
                     {""/disk1"", 1000 * 1000 * 1000},
                     {""/disk2"", 1000 * 1000 * 1000},
                     {""/disk3"", 1000 * 1000 * 1000},
                     {""/disk4"", 1000 * 1000 * 1000}};
```
Only disk1 & disk4 wiil be use to write data. And rocks limit max 4 db_paths. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K8Rg_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K8c53,kvrocks,1257361015,918,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-09-26T01:36:14Z,2022-09-26T01:36:14Z,"> In fact, the level at which SST is located represents the hot and coldness of the data. Because rocksdb uses the LSM tree, it will naturally merge cold data to a higher level.

@tanruixiang But about 90% of the data falls to the last layer of the LSM, so does that mean that 90% of the data is cold?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K8c53/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K9CPR,kvrocks,1257513937,918,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-09-26T05:51:05Z,2022-09-26T05:51:05Z,"> > In fact, the level at which SST is located represents the hot and coldness of the data. Because rocksdb uses the LSM tree, it will naturally merge cold data to a higher level.
> 
> @tanruixiang But about 90% of the data falls to the last layer of the LSM, so does that mean that 90% of the data is cold?

Most of the data should be cold data. If it is hot data, it will re-enter the previous layers, and the data in the last layer may be deleted.
For example, if `key1` is in the last layer and we put `key1` again, then `key1` will go back to the previous layers after going from mmtable to sst, and at the same time, the key1 of the last layer will be invalid. Of course, if a certain data is only read, it should be placed in the cache even if it is in the last layer.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5K9CPR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T8xWp,kvrocks,1408439721,918,NA,jishengming1,113986247,jishengming,,NA,2023-01-30T11:17:05Z,2023-01-30T11:17:05Z,"Hi @xiaobiaozhao , I have a questions:
I get  two ssd , Is there a way to  split the hot  data?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T8xWp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UCYyZ,kvrocks,1409911961,918,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-01-31T07:51:06Z,2023-01-31T07:51:06Z,"> Hi @xiaobiaozhao , I have a questions: I get two ssd , Is there a way to split the hot data?

https://github.com/apache/incubator-kvrocks/pull/953/files#diff-e29cedc586b39d07b64be1df007101989a20f7d4452fc18fe23136f6d4ccd331R792

""/mnt/ssd 10G; /mnt/hdd 1T;""
hot data            cool data","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UCYyZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UCeVJ,kvrocks,1409934665,918,NA,jishengming1,113986247,jishengming,,NA,2023-01-31T08:10:22Z,2023-01-31T08:10:22Z,"> > Hi @xiaobiaozhao , I have a questions: I get two ssd , Is there a way to split the hot data?
> 
> https://github.com/apache/incubator-kvrocks/pull/953/files#diff-e29cedc586b39d07b64be1df007101989a20f7d4452fc18fe23136f6d4ccd331R792
> 
> ""/mnt/ssd 10G; /mnt/hdd 1T;"" hot data cool data

I am not trying to distinguish between hot data and cool data. I mean to make the pressure of both disks the same. 
Hot data is distributed in two disks. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UCeVJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UEgPc,kvrocks,1410466780,918,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-01-31T14:34:03Z,2023-01-31T14:34:03Z,"> > > Hi @xiaobiaozhao , I have a questions: I get two ssd , Is there a way to split the hot data?
> > 
> > 
> > https://github.com/apache/incubator-kvrocks/pull/953/files#diff-e29cedc586b39d07b64be1df007101989a20f7d4452fc18fe23136f6d4ccd331R792
> > ""/mnt/ssd 10G; /mnt/hdd 1T;"" hot data cool data
> 
> I am not trying to distinguish between hot data and cool data. I mean to make the pressure of both disks the same. Hot data is distributed in two disks.

You can try cluster
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UEgPc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UH8FC,kvrocks,1411367234,918,NA,jishengming1,113986247,jishengming,,NA,2023-02-01T02:31:23Z,2023-02-01T02:31:23Z,"> > > > Hi @xiaobiaozhao , I have a questions: I get two ssd , Is there a way to split the hot data?
> > > 
> > > 
> > > https://github.com/apache/incubator-kvrocks/pull/953/files#diff-e29cedc586b39d07b64be1df007101989a20f7d4452fc18fe23136f6d4ccd331R792
> > > ""/mnt/ssd 10G; /mnt/hdd 1T;"" hot data cool data
> > 
> > 
> > I am not trying to distinguish between hot data and cool data. I mean to make the pressure of both disks the same. Hot data is distributed in two disks.
> 
> You can try cluster
Thanks, is there any other way if there is only one host?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UH8FC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5USGTV,kvrocks,1414030549,918,NA,marlboroman81,14112719,,,NA,2023-02-02T16:35:02Z,2023-02-02T16:35:02Z,"> I get two ssd , Is there a way to split the hot data?

You can make a raid0 from several disks and place the datadir on it. Or you can use zfs pool consisting of several disks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5USGTV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/918,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UUd6W,kvrocks,1414651542,918,NA,jishengming1,113986247,jishengming,,NA,2023-02-03T02:06:16Z,2023-02-03T02:06:16Z,"> > I get two ssd , Is there a way to split the hot data?
> 
> You can make a raid0 from several disks and place the datadir on it. Or you can use zfs pool consisting of several disks.

Thanks, I'll try.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UUd6W/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/926,https://api.github.com/repos/apache/kvrocks/issues/926,kvrocks,1389502032,926,"PING returns PONG if no argument is provided, otherwise return a copy of the argument as a bulk.",ColinChamber,95634254,ColinChamber,,CLOSED,2022-09-28T14:49:28Z,2022-10-04T02:57:51Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

ping message

### What did you expect to see?

message

### What did you see instead?

wrong number of arguments

### Anything Else?

[redis ping](https://redis.io/commands/ping/)

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/926/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/926,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LKefE,kvrocks,1261037508,926,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-09-28T14:55:12Z,2022-09-28T14:55:12Z,"wow, it refreshes my knowledge.😃","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LKefE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/926,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LPpy4,kvrocks,1262394552,926,NA,ColinChamber,95634254,ColinChamber,,NA,2022-09-29T14:49:55Z,2022-09-29T14:49:55Z,"I haven't used Kvrocks for a long time. I can only do some boring PR first. 😃 However, there are indeed applications that add parameters to ping, such as celery. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LPpy4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/927,https://api.github.com/repos/apache/kvrocks/issues/927,kvrocks,1390164963,927,Can not build use x.py,17998384,51736290,我叫城北徐公°,,CLOSED,2022-09-29T02:37:07Z,2022-09-29T18:55:49Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.1.0

### Minimal reproduce step

The following error is displayed when using./x.py build

### What did you expect to see?

I want the build to succeed

### What did you see instead?

```[x@xx incubator-kvrocks-2.1.0]$ ./x.py build
  File ""./x.py"", line 59
    """"""
      ^
SyntaxError: invalid syntax
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/927/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/927,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM41H,kvrocks,1261669703,927,NA,PragmaTwice,20042607,Twice,,NA,2022-09-29T02:40:18Z,2022-09-29T02:40:18Z,Which python version are you using? We support only python 3+.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM41H/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/927,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM5vc,kvrocks,1261673436,927,NA,17998384,51736290,我叫城北徐公°,,NA,2022-09-29T02:48:21Z,2022-09-29T02:48:21Z,"> Which python version are you using? We support only python 3+.
I use python version is 3.4
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM5vc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/927,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM6XV,kvrocks,1261675989,927,NA,PragmaTwice,20042607,Twice,,NA,2022-09-29T02:54:06Z,2022-09-29T02:54:06Z,"I will try to reproduce it with python 3.4. You can use more recent version to build it, such as python 3.9 or 3.10. Or you can try x.py in the unstable branch.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM6XV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/927,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM8HX,kvrocks,1261683159,927,NA,17998384,51736290,我叫城北徐公°,,NA,2022-09-29T02:58:32Z,2022-09-29T02:58:32Z,"> I will try to reproduce it with python 3.4. You can use more recent version to build it, such as python 3.9 or 3.10. Or you can use x.py in the unstable branch.

OK，I think I know what the problem is. Strings starting with f are only supported after python3.6. Thank you for answering my question","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM8HX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/927,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM9UH,kvrocks,1261688071,927,NA,17998384,51736290,我叫城北徐公°,,NA,2022-09-29T03:03:32Z,2022-09-29T03:03:32Z,This can be resolved using python3.6 or higher,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM9UH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/927,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM9Zf,kvrocks,1261688415,927,NA,PragmaTwice,20042607,Twice,,NA,2022-09-29T03:04:08Z,2022-09-29T03:04:08Z,Good catch! Maybe we should add a notice or something for users to limit the minimum version of python. cc @tisonkun @git-hulk ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LM9Zf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/927,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LQxl_,kvrocks,1262688639,927,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-29T18:55:49Z,2022-09-29T18:55:49Z,"@PragmaTwice perhaps read the version by `platform.python_version()` or `sys.version_info`, failed if version not match. Then the script is self-explained.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LQxl_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/928,https://api.github.com/repos/apache/kvrocks/issues/928,kvrocks,1390169841,928,TYPE and SCAN commands are inconsistent with Redis,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2022-09-29T02:44:59Z,2023-04-03T12:29:23Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

Release 2.1.0

### Minimal reproduce step

1. [Type command](https://redis.io/commands/type/) return simple string in redis, but return bulk string in kvrocks.
2. [Scan command](https://redis.io/commands/scan/) can return empty key in redis, but return none in kvrocks.

### What did you expect to see?

These two commands should be consistent with Redis.

```
127.0.0.1:6379> set """" value
OK

127.0.0.1:6379 > TYPE """"
string

127.0.0.1:6379 > scan 0
1) ""0""
2) 1) """"
```

### What did you see instead?

The semantics of the Type and Scan commands are inconsistent with redis.

```
127.0.0.1:8888> set """" value
OK

127.0.0.1:8888 > TYPE key
""string""

127.0.0.1:8888 > scan 0
1) ""0""
2) 1) (nil)
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/928/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/928,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LSOnw,kvrocks,1263069680,928,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-09-30T03:48:56Z,2022-09-30T03:48:56Z,"Agree. Also, SCAN returns ""_cursor"" instead of ""cursor"" on Redis, which causes #842 cannot directly make use of `redis.Client#Scan`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LSOnw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/928,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZD9j6,kvrocks,1494210810,928,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-04-03T12:12:17Z,2023-04-03T12:12:17Z,this was fixed in #1269,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZD9j6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/928,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZEDpD,kvrocks,1494235715,928,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-03T12:29:23Z,2023-04-03T12:29:23Z,"@enjoy-binbin Thanks for your warm reminder, closing...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZEDpD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/929,https://api.github.com/repos/apache/kvrocks/issues/929,kvrocks,1390214617,929,Some `return` is missing in redis_metadata.cc,xumingbo,21134467,Bo Xu,,CLOSED,2022-09-29T03:54:46Z,2022-09-29T18:49:06Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

Latest commit [73092dc](https://github.com/apache/incubator-kvrocks/commit/73092dc4a5e4f87411133efdcf10b393dd8f9ae9) on Aug 17



### Minimal reproduce step

in redis_metadata.cc

in rocksdb::Status ListMetadata::Decode(const std::string &bytes) 
line 282
   if (input.size() < 12) rocksdb::Status::InvalidArgument(kErrMetadataTooShort);

Should be:
if (input.size() < 12) **return** rocksdb::Status::InvalidArgument(kErrMetadataTooShort);

same error at line 287


### What did you expect to see?

if (input.size() < 12) **return** rocksdb::Status::InvalidArgument(kErrMetadataTooShort);

### What did you see instead?

if (input.size() < 12) rocksdb::Status::InvalidArgument(kErrMetadataTooShort);

### Anything Else?

same issue on line 282 and 287

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/929/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/929,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LNHfx,kvrocks,1261729777,929,NA,PragmaTwice,20042607,Twice,,NA,2022-09-29T04:10:28Z,2022-09-29T04:10:28Z,Good catch! Thanks. Are you willing to submit a PR?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LNHfx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/929,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LNomy,kvrocks,1261865394,929,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-09-29T07:15:55Z,2022-09-29T07:15:55Z,I try to fix this,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LNomy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/929,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LQksb,kvrocks,1262635803,929,NA,xumingbo,21134467,Bo Xu,,NA,2022-09-29T18:06:58Z,2022-09-29T18:06:58Z," 
Also:at line 325  if (input.size() < 12) {
    rocksdb::Status::InvalidArgument(kErrMetadataTooShort);
  }

Regards,
Bo Xu
    On Thursday, September 29, 2022 at 12:16:07 AM PDT, Aleks Lozovyuk ***@***.***> wrote:  
 
 


I try to fix this

—
Reply to this email directly, view it on GitHub, or unsubscribe.
You are receiving this because you authored the thread.Message ID: ***@***.***>
  ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LQksb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/929,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LQro4,kvrocks,1262664248,929,NA,torwig,8588372,Yaroslav,,NA,2022-09-29T18:30:44Z,2022-09-29T18:30:44Z,@xumingbo Pull request also fixes line 325,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LQro4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/941,kvrocks,1394564938,941,Github deprecated Ubuntu-18.04 in CI builds.,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2022-10-03T11:21:18Z,2022-10-05T10:25:41Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

See [GitHub Actions: The Ubuntu 18.04 Actions runner image is being deprecated and will be removed by 12/1/22](https://github.blog/changelog/2022-08-09-github-actions-the-ubuntu-18-04-actions-runner-image-is-being-deprecated-and-will-be-removed-by-12-1-22/)



### Solution

So, maybe we can:

- start to migrate on next version of Ubuntu base images (20.04)
- add Ubuntu 22.04 as second images into matrix

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/941/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5La0NR,kvrocks,1265320785,941,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-10-03T11:44:43Z,2022-10-03T11:44:43Z,"Also, tcl will be upgraded to 8.6 (default in Ubuntu 20.04 and above)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5La0NR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5La-tw,kvrocks,1265363824,941,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-10-03T12:24:04Z,2022-10-03T12:24:04Z,"I have tested it in private fork, all builds and tests passed OK. Trying to add Ubuntu 22.04 into matrix ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5La-tw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LbHPX,kvrocks,1265398743,941,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-10-03T12:55:44Z,2022-10-03T12:55:44Z,"At now, a default ubuntu-latest images changed to 20.04, so cpplint not working now. In cooperation with  @torvig working to fix them","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LbHPX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lboue,kvrocks,1265535902,941,NA,PragmaTwice,20042607,Twice,,NA,2022-10-03T14:31:45Z,2022-10-03T14:31:45Z,"I also noticed the problem, feel free to open a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lboue/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LbvQ3,kvrocks,1265562679,941,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-03T14:43:15Z,2022-10-03T14:43:15Z,"> At now, a default ubuntu-latest images changed to 20.04, so cpplint not working now. In cooperation with @Torvig working to fix them

I noticed that there has been an [issue](https://github.com/apache/incubator-kvrocks/issues/800) proposing to replace cpplint with `clang-*`, raised by @PragmaTwice .  If you have time, you can try using `clang-*` by the way to solve this problem.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LbvQ3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lb1PC,kvrocks,1265587138,941,NA,PragmaTwice,20042607,Twice,,NA,2022-10-03T14:52:49Z,2022-10-03T14:52:49Z,"> I noticed that there has been an [issue](https://github.com/apache/incubator-kvrocks/issues/800) proposing to replace cpplint with `clang-*`, raised by @PragmaTwice . If you have time, you can try using `clang-*` by the way to solve this problem.

Switching to `clang-*` can be a work involving so many code changes and discussions, I suggest we can remain cpplint in this PR if you want to keep the changes minimal. And it may take the focus away from the content of this issue and make it more difficult to merge.

But feel free to try replacing the current cpplint and cppcheck with `clang-*` in other PRs.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lb1PC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lb2Bh,kvrocks,1265590369,941,NA,PragmaTwice,20042607,Twice,,NA,2022-10-03T14:54:53Z,2022-10-03T14:54:53Z,You can try to modify the current flags used in cpplint or cppcheck here: https://github.com/apache/incubator-kvrocks/blob/unstable/x.py#L119-L137,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lb2Bh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lb2ns,kvrocks,1265592812,941,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-10-03T14:56:33Z,2022-10-03T14:56:33Z,"@torwig could we doing here? I will prepare a PR with updated Ubuntu, but cpp* is on your side","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lb2ns/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lb5jf,kvrocks,1265604831,941,NA,torwig,8588372,Yaroslav,,NA,2022-10-03T15:04:28Z,2022-10-03T15:04:28Z,"@aleksraiden Sure, I'll help you.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lb5jf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LhTtO,kvrocks,1267022670,941,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2022-10-04T13:42:50Z,2022-10-04T13:42:50Z,"All task are done, except use Ubuntu 22, maybe this is too much for us, ci perform too long in this way. 

Some troubles with tcl test on macos-11, try to rebuild.  

Awesome @torwig fix all files, currently we are still used cpplint/check (v1.6.1) not clang.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LhTtO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/945,https://api.github.com/repos/apache/kvrocks/issues/945,kvrocks,1395591848,945,Move TCL test integration/slotmigrate to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-04T02:55:16Z,2022-10-18T13:36:07Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/945/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/946,kvrocks,1395591898,946,Move TCL test integration/slotimport to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-04T02:55:21Z,2022-10-09T14:49:03Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/946/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1mVv,kvrocks,1272341871,946,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-08T15:23:29Z,2022-10-08T15:23:29Z,@git-hulk @ShooterIT may I ask how the CRC16 table is generated? I don't want to hard code the table once more..,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1mVv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1mzw,kvrocks,1272343792,946,NA,PragmaTwice,20042607,Twice,,NA,2022-10-08T15:34:47Z,2022-10-08T15:34:47Z,https://github.com/lammertb/libcrc/blob/master/src/crc16.c#L124 here?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1mzw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1m0H,kvrocks,1272343815,946,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-08T15:34:57Z,2022-10-08T15:34:57Z,"@git-hulk @ShooterIT may I ask how the CRC16 table is generated? I don't want to hard code the table once more..

https://redis.io/docs/reference/cluster-spec/ This doc explained how Redis calculates the CRC16. `go-redis` also implements this function but it's an internal function: https://github.com/go-redis/redis/blob/27f0addeb2e6997bdd2faa1b48f6a989f83c4751/internal/hashtag/hashtag.go#L65","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1m0H/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1-hq,kvrocks,1272440938,946,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-09T02:51:05Z,2022-10-09T02:51:05Z,"```c++
    // 3) port
    auto parse_result = ParseInt<int>(fields[2], NumericRange<int>{1, 65535 - kClusterPortIncr - 1}, 10);
    if (!parse_result) {
      return Status(Status::ClusterInvalidInfo, ""Invalid cluster node port"");
    }
    int port = *parse_result;
```

Why cluster node port must be in `[1, 55534]`?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1-hq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1-p5,kvrocks,1272441465,946,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-09T02:55:15Z,2022-10-09T02:55:15Z,"This should be unnecessary for Kvrocks, coz we don't need the extra cluster port. cc @ShooterIT @caipengbo @ChrisZMF ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1-p5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1_fl,kvrocks,1272444901,946,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-09T03:22:59Z,2022-10-09T03:22:59Z,"@git-hulk thank you! The next question is that when kill a ""cluster-enable: yes"" server, it cannot exit properly but:

```
Log file created at: 2022/10/09 11:21:41
Running on machine: chenzilis-MacBook-Pro-2.local
Running duration (h:mm:ss): 0:00:00
Log line format: [IWEF]yyyymmdd hh:mm:ss.uuuuuu threadid file:line] msg
E20221009 11:21:41.602181 3879347 main.cc:69] ======= Ooops! kvrocks 999.999.999 @a8e06c7 got signal: Abort trap: 6 (6) =======
E20221009 11:21:41.603391 3879347 main.cc:76] 1   libsystem_platform.dylib            0x00000001a597f4a4 _sigtramp + 56: _sigtramp
E20221009 11:21:41.603444 3879347 main.cc:76] 2   libsystem_pthread.dylib             0x00000001a5967ee0 pthread_kill + 288: pthread_kill
E20221009 11:21:41.603477 3879347 main.cc:76] 3   libsystem_c.dylib                   0x00000001a58a2340 abort + 168: abort
E20221009 11:21:41.603511 3879347 main.cc:76] 4   libc++abi.dylib                     0x00000001a5922b08 _ZN10__cxxabiv130__aligned_malloc_with_fallbackEm + 0: __cxxabiv1::__aligned_malloc_with_fallback()
E20221009 11:21:41.603543 3879347 main.cc:76] 5   libc++abi.dylib                     0x00000001a5912834 _ZL28demangling_terminate_handlerv + 52: demangling_terminate_handler()
E20221009 11:21:41.603569 3879347 main.cc:76] 6   libc++abi.dylib                     0x00000001a5921ea4 _ZSt11__terminatePFvvE + 20: std::__terminate()
E20221009 11:21:41.603595 3879347 main.cc:76] 7   libc++abi.dylib                     0x00000001a5921e2c _ZSt9terminatev + 44: std::terminate()
E20221009 11:21:41.603726 3879347 main.cc:76] 8   kvrocks                             0x00000001043f6b58 _ZN11SlotMigrateD2Ev + 108: SlotMigrate::~SlotMigrate()
E20221009 11:21:41.603857 3879347 main.cc:76] 9   kvrocks                             0x00000001043ead70 _ZN6ServerD2Ev + 624: Server::~Server()
E20221009 11:21:41.604001 3879347 main.cc:76] 10  kvrocks                             0x000000010441a694 main + 1760: main
E20221009 11:21:41.604032 3879347 main.cc:78] 11  dyld                                0x000000010530508c start + 520
```

Although we can simply ignore the error, do you have idea on this case?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1_fl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1_oD,kvrocks,1272445443,946,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-09T03:28:22Z,2022-10-09T03:28:22Z,@tisonkun It's caused by the migrate didn't terminate the internal thread before destroying. Will create an issue to track.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1_oD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2ByD,kvrocks,1272454275,946,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-10-09T04:43:38Z,2022-10-09T04:43:38Z,"> Why cluster node port must be in [1, 55534]?

In redis cluster mode, it needs extra cluster port for gossip, and its default number is `listen port + 10000`. so i add this check. but now this cluster port is configurable, so i think we just check if it is right port.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2ByD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2CRz,kvrocks,1272456307,946,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-09T05:02:44Z,2022-10-09T05:02:44Z,"@ShooterIT Included in https://github.com/apache/incubator-kvrocks/pull/966/files#diff-a4e8a56bf7d9d0e658d90784eab42c809b59dd142ee4ae1dafa54d5d657d688d, please take a look :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2CRz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/947,https://api.github.com/repos/apache/kvrocks/issues/947,kvrocks,1395591924,947,Move TCL test integration/redis-cli to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-04T02:55:24Z,2022-10-12T09:37:13Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/947/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/948,https://api.github.com/repos/apache/kvrocks/issues/948,kvrocks,1395591962,948,Move TCL test integration/replication to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-04T02:55:29Z,2022-10-16T03:56:45Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/948/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/948,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRcN5,kvrocks,1279640441,948,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-15T02:46:51Z,2022-10-15T02:46:51Z,"@tisonkun I will handle it this weekend, assigned to myself.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRcN5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/949,https://api.github.com/repos/apache/kvrocks/issues/949,kvrocks,1395591988,949,Move TCL test integration/rsid_psync to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-04T02:55:32Z,2022-10-08T05:59:54Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/949/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/949,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LfN1-,kvrocks,1266474366,949,NA,amoghrajesh,35884252,Amogh Desai,amoghdesai.oss@gmail.com,NA,2022-10-04T06:45:23Z,2022-10-04T06:45:23Z,@tisonkun i would like to work on this. Can you point me where to get started and assign the issue to me?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LfN1-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/949,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LfN_I,kvrocks,1266474952,949,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-04T06:45:57Z,2022-10-04T06:45:57Z,@amoghrajesh assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LfN_I/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/949,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LfgwO,kvrocks,1266551822,949,NA,amoghrajesh,35884252,Amogh Desai,amoghdesai.oss@gmail.com,NA,2022-10-04T08:00:12Z,2022-10-04T08:00:12Z,@tisonkun can you point me to a getting started guide or explain to me what the issue is?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LfgwO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/949,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LfhrD,kvrocks,1266555587,949,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-04T08:03:52Z,2022-10-04T08:03:52Z,"You can take a look at other similar issues in #811 while migrating integration tests can be more complex than unit tests.

If you don't know what's the issue here, I suggest you unassign yourself instead - don't pick up something beyond your ability at the moment. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LfhrD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/949,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lfh96,kvrocks,1266556794,949,NA,amoghrajesh,35884252,Amogh Desai,amoghdesai.oss@gmail.com,NA,2022-10-04T08:05:00Z,2022-10-04T08:05:00Z,Un assigning myself and releasing the opportunity.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Lfh96/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/950,https://api.github.com/repos/apache/kvrocks/issues/950,kvrocks,1395592010,950,Move TCL test integration/cluster to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-04T02:55:34Z,2022-10-15T01:12:52Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/950/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/952,https://api.github.com/repos/apache/kvrocks/issues/952,kvrocks,1396333112,952,Pub/Sub doesn't take namespace into account,torwig,8588372,Yaroslav,,OPEN,2022-10-04T14:01:11Z,2022-10-09T07:59:40Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

Latest from the `unstable` branch, Fedora 35.

### Minimal reproduce step

Run `kvrocks` with additional two namespaces, e.g.

```
namespace.one password4one
namespace.two password4two
```

Run two `redisc-cli` instances, and connect to `kvrocks`. 
Switch to the first namespace via the first `redis-cli`: `auth password4one`.
Switch to the second namespace via the second `redis-cli`: `auth password4two`.
Execute `subscribe channel` via the second `redisc-cli`.
Execute `publish channel not-for-second-ns` via the first `redis-cli`.

### What did you expect to see?

The message, published in `namespace.one` should not be received by the subscribers in `namespace.two`, even if the channel names are the same.

### What did you see instead?

Subscribers from `namespace.two` received the message, published in `namespace.one`.
For Pub/Sub namespaces aren't isolated.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/952/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LrPfh,kvrocks,1269626849,952,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-06T09:00:08Z,2022-10-06T09:00:08Z,Good Catch. It seems that the reason for the problem is that the namespace information in `Connection` is not used.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LrPfh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LwyXn,kvrocks,1271080423,952,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-07T03:53:53Z,2022-10-07T03:53:53Z,I'm also wondering if any users need this feature,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5LwyXn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2FEO,kvrocks,1272467726,952,NA,manchurio,82277001,,,NA,2022-10-09T06:27:42Z,2022-10-09T06:27:42Z,"I think this is ok, so does redis.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2FEO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2GrK,kvrocks,1272474314,952,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-09T07:11:30Z,2022-10-09T07:11:30Z,"> I think this is ok, so does redis.

Yes, this behavior is matched the Redis if we regard the namespace as the Redis DB. So I'm wondering if any users need this feature.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2GrK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2G24,kvrocks,1272475064,952,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-09T07:15:58Z,2022-10-09T07:15:58Z,"> Yes, this behavior is matched the Redis if we regard the namespace as the Redis DB. So I'm wondering if any users need this feature.

If someone needs this feature, I think they can just use stream.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2G24/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2HBh,kvrocks,1272475745,952,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-09T07:19:59Z,2022-10-09T07:19:59Z,"> > Yes, this behavior is matched the Redis if we regard the namespace as the Redis DB. So I'm wondering if any users need this feature.
> 
> If someone needs this feature, I think they can just use stream.

There's a bit different between stream and pubsub. For the stream, it likes most message queue system, all message can be saw before the retention ttl but the pubsub is fire and forget.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2HBh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2Ilx,kvrocks,1272482161,952,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-09T07:58:46Z,2022-10-09T07:58:46Z,"> There's a bit different between stream and pubsub. For the stream, it likes most message queue system, all message can be saw before the retention ttl but the pubsub is fire and forget.

Yes, I mean that if someone needs this feature, they can use stream instead in the current situation. In fact, many people who directly use Redis also use stream instead of pubsub to avoid the disadvantages of pubsub. I think it is enough for kvrocks to align with Redis.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2Ilx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/957,https://api.github.com/repos/apache/kvrocks/issues/957,kvrocks,1400909566,957,INCR and DECR command with unsigned value,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,OPEN,2022-10-07T09:47:02Z,2023-08-15T13:28:40Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Traditionally, KVrocks like Redis, use signed Int64/Float64 for counter commands (INCR/DECR and HINCR/HDECR). But in extra case, we need more data, a full 64 bit number (unsigned).

### Solution

Could we add a command-flag to create only signed value for this commands. 

A little bit more, maybe a good idea to add other flag for increment/decrement ONLY. 

Why? In my case, we use HSET with incremented fields as a central repository for global counters. like tradeId. So, we need always monotonic counter, without possibility of modify element in decrement. 

And we need real Int64 unsigned value, because in hi-load HFT-system and hundred of assets, this counter must be presents over all period (need for regulatory requirements, an least 5 years all data must be stored and availability)

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/957/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/957,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iwD2g,kvrocks,1656765856,957,NA,uds5501,21087061,Uddeshya Singh,singhuddeshyaofficial@gmail.com,NA,2023-07-29T16:07:09Z,2023-07-29T16:07:09Z,Will pick this up,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iwD2g/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/957,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iwENG,kvrocks,1656767302,957,NA,torwig,8588372,Yaroslav,,NA,2023-07-29T16:15:00Z,2023-07-29T16:15:00Z,@uds5501 Assigned. Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iwENG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/957,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5j8FoU,kvrocks,1676696084,957,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-14T05:21:49Z,2023-08-14T05:21:49Z,"@aleksraiden @torwig I have a bit of doubt about this improvement. If the 63-bit is not enough for recording id, then the 64-bit should be also helpless. It makes sense to extend the 64-bit integer to 128-bit, but not from 63 to 64 from my perspective.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5j8FoU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/957,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5j-WnN,kvrocks,1677289933,957,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-08-14T13:12:14Z,2023-08-14T13:12:14Z,"As I think, no. So, this is a two different points:

1. Extend a value up to 128 bit. But in this way maybe we have a lot of troubles with external system (and need to use string type over a Int64)
2. Add an option to modify INCR (or add new version of it) when we can't change increment to decr in same key. We need an only totally always increment or decrement, but nobody cant do about INCR test 1 and then DECR test 1. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5j-WnN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/957,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kBR45,kvrocks,1678057017,957,NA,uds5501,21087061,Uddeshya Singh,singhuddeshyaofficial@gmail.com,NA,2023-08-14T21:02:55Z,2023-08-14T21:02:55Z,">Add an option to modify INCR (or add new version of it) when we can't change increment to decr in same key. We need an only totally always increment or decrement, but nobody cant do about INCR test 1 and then DECR test 1.

@aleksraiden @git-hulk I am a bit lost here, what kind of behaviour is expected? Why shouldn't we be able to both INCR and DECR a key? Why have a monotonic function?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kBR45/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/957,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kEopT,kvrocks,1678936659,957,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-15T13:28:40Z,2023-08-15T13:28:40Z,"> Add an option to modify INCR (or add new version of it) when we can't change increment to decr in same key. We need an only totally always increment or decrement, but nobody cant do about INCR test 1 and then DECR test 1.

@aleksraiden @uds5501 I don't think we should offer this ability in a generalized database and should control this on the user's side.

> Extend a value up to 128 bit. But in this way maybe we have a lot of troubles with external system (and need to use string type over a Int64)

That's right, my doubt is why 64-bit can help compared to 63-bit. My opinion is 64-bit shouldn't help if 63-bit is not enough for your scenario.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kEopT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/960,https://api.github.com/repos/apache/kvrocks/issues/960,kvrocks,1401838665,960,Support `GetEX` command,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-10-08T06:12:15Z,2022-10-12T16:52:15Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Redis supports the `GetEX` command since 6.2.0. We can follow-up as well since this command can benefit users if they want to extend or reduce the expire time when touching.

### Solution

Implement the command described in: https://redis.io/commands/getex/

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/960/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/960,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1b6_,kvrocks,1272299199,960,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2022-10-08T11:38:19Z,2022-10-08T11:38:19Z,Can I try it on ? #961 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1b6_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/960,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1ce2,kvrocks,1272301494,960,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-08T11:51:55Z,2022-10-08T11:51:55Z,"> Can I try it on ? #961

Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1ce2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/962,https://api.github.com/repos/apache/kvrocks/issues/962,kvrocks,1401926825,962,Align the expire option behavior of redis,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,CLOSED,2022-10-08T12:10:11Z,2022-10-23T03:35:49Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable branch.

### Minimal reproduce step

```
127.0.0.1:6666> cas key old new ex 1 ex 10
(integer) 0
```

### What did you expect to see?

(error) ERR syntax error

### What did you see instead?

Executed successfully.

### Anything Else?

Maybe other commands have this problem too. I'll fix them after double-checking. Even if the command was coded to prevent this issue (such as CommandSet), the code was written with no generality. I will provide a more general parsing function in this pr.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/962/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/962,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1lfU,kvrocks,1272338388,962,NA,PragmaTwice,20042607,Twice,,NA,2022-10-08T15:03:35Z,2022-10-08T15:03:35Z,"I notice that actually it is ok in redis to repeat the same keyword and arguments, e.g.

```
127.0.0.1:6379> set key value ex 22 ex 333
OK
127.0.0.1:6379> ttl key
(integer) 331
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1lfU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/962,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1lxL,kvrocks,1272339531,962,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-08T15:10:04Z,2022-10-08T15:10:04Z,"> I notice that actually it is ok in redis to repeat the same keyword and arguments, e.g.
> 
> ```
> 127.0.0.1:6379> set key value ex 22 ex 333
> OK
> 127.0.0.1:6379> ttl key
> (integer) 331
> ```

Yes, I've tested redis too, but I think duplication is a very confusing behavior. I think this is also a bug of redis, because in redis, the`set key value ex 10 px 1` will get `ERR syntax error`

```
127.0.0.1:6379> set key value px 1
OK
127.0.0.1:6379> set key value ex 10 px 1
(error) ERR syntax error
127.0.0.1:6379> set key value ex 10 ex 1
OK
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1lxL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/962,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1mL9,kvrocks,1272341245,962,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-08T15:19:43Z,2022-10-08T15:19:43Z,It can't tell whether it's a bug or not from the Redis code. But I guess Redis won't regard this behavior as a bug since most arguments like `LIMIT` and `COUNT` are allowed duplicate. Perhaps can raise an issue to ask the Redis community.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1mL9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/962,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1nGH,kvrocks,1272344967,962,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-08T15:41:57Z,2022-10-08T15:41:57Z,"> It can't tell whether it's a bug or not from the Redis code. But I guess Redis won't regard this behavior as a bug since most arguments like LIMIT and COUNT are allowed duplicate. Perhaps can raise an issue to ask the Redis community.

If aligning redis is the starting point, we should at least guarantee `cas key old new ex 1 px 10` will throw an error.  In fact, our code is also inconsistent in the implementation of whether there can be repeated arguments, which also makes me more confused. For example, the current `CommandSet` logic does not support repeated commands. Do we need to change the `CommandSet`?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1nGH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/962,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1nU3,kvrocks,1272345911,962,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-08T15:47:19Z,2022-10-08T15:47:19Z,"Yes, you're right that Redis also don't allow using `ex`|`px`|`exat` at the same time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L1nU3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/962,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2Bur,kvrocks,1272454059,962,NA,PragmaTwice,20042607,Twice,,NA,2022-10-09T04:41:01Z,2022-10-09T04:41:01Z,+1. There should be a syntax error while different options in same functionality is encountered to match the behavior of redis : ),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2Bur/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/962,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxRNN,kvrocks,1287983949,962,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-23T02:32:16Z,2022-10-23T02:32:16Z,@tanruixiang shall we close this issue as #1017 merged?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxRNN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/962,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxT0k,kvrocks,1287994660,962,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-23T03:35:46Z,2022-10-23T03:35:46Z,"> @tanruixiang shall we close this issue as #1017 merged?

Ok. There are still some unresolved discussions that will be resolved after twice proposes a parsing-design's issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MxT0k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/964,https://api.github.com/repos/apache/kvrocks/issues/964,kvrocks,1402122296,964,[bug] kvrocks2redis should not lowercase all lines when reading configuration files ,manchurio,82277001,,,CLOSED,2022-10-09T02:19:25Z,2022-10-11T05:14:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

![image](https://user-images.githubusercontent.com/82277001/194734491-d922e926-37aa-43e9-906d-636f86290462.png)

Cannot connect to the server when the password contains uppercase letters

### Minimal reproduce step

```
# kvrocks <kvrocks_ip> <kvrocks_port> [<kvrocks_auth>]
kvrocks 127.0.0.1 6666 Pass
```

### What did you expect to see?

connect to the server successfully

### What did you see instead?

invalid password

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/964/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/964,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2HKf,kvrocks,1272476319,964,NA,torwig,8588372,Yaroslav,,NA,2022-10-09T07:23:37Z,2022-10-09T07:23:37Z,@manchurio Good catch!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L2HKf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/965,https://api.github.com/repos/apache/kvrocks/issues/965,kvrocks,1402136931,965,The server cannot exit properly when enabling cluster mode,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-10-09T03:34:53Z,2022-10-11T05:11:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

a8e06c7e373f374e1528861fb96942ebbbb63b2f

### Minimal reproduce step

1. Enable the cluster mode
2. Start the migrate thread
3. Exit the server

### What did you expect to see?

No error happens when shut downing the server with cluster mode

### What did you see instead?

As mentioned in comment: As mentioned in https://github.com/apache/incubator-kvrocks/issues/946#issuecomment-1272444901, we can see the migrate thread was aborted after the server exited.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/965/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/975,https://api.github.com/repos/apache/kvrocks/issues/975,kvrocks,1404890945,975,Flaky test TestString/SETBIT/GETBIT/BITCOUNT/BITPOS_boundary_check_(type_string),tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-11T16:04:20Z,2022-10-12T01:59:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Fix the flaky test:

```
=== RUN   TestString/SETBIT/GETBIT/BITCOUNT/BITPOS_boundary_check_(type_string)
    strings_test.go:246: 
        	Error Trace:	/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/strings/strings_test.go:246
        	Error:      	Received unexpected error:
        	            	read tcp 127.0.0.1:50003->127.0.0.1:49993: i/o timeout
        	Test:       	TestString/SETBIT/GETBIT/BITCOUNT/BITPOS_boundary_check_(type_string)
```

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/975/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/975,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L_v8A,kvrocks,1275002624,975,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-11T16:59:50Z,2022-10-11T16:59:50Z,https://github.com/apache/incubator-kvrocks/actions/runs/3228064427/jobs/5283723078,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5L_v8A/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/977,kvrocks,1405548005,977,Proposal: Refactor source file structure,PragmaTwice,20042607,Twice,,CLOSED,2022-10-12T04:32:24Z,2022-10-17T00:00:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As mentioned in https://github.com/apache/incubator-kvrocks/pull/973#pullrequestreview-1137848493, we can categorize source files in to different folders to modularize the source structure.

### Solution

The preliminary plan is as follows:

```
common/
  event_util fd_util parse_util cron encoding db_util event_util log_collector
  parse_util rw_lock status tls_util util

database/
  batch_extractor compact_filter compaction_checker event_listener geohash
  lock_manager redis_db redis_disk redis_metadata redis_pubsub
  scripting stats storage table_properties_collector

service/
  server worker redis_reply redis_connection redis_request

distributed/
  cluster redis_slot replication slot_import slot_migrate 

data_types/
  redis_bitmap redis_bitmap_string redis_geo redis_list redis_hash redis_set
  redis_sortedint redis_stream_base redis_stream redis_string redis_zset

commands/
  redis_cmd (need to be divided)

config/
  config config_type config_util
  
crypto/
  rand sha1 rocksdb_crc32c

```

Since I am not very familiar with certain parts of the code, I welcome everyone's thoughts, comments and suggestions!

cc @git-hulk @ShooterIT @caipengbo @tisonkun @torwig 


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/977/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MDBlh,kvrocks,1275861345,977,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-12T09:25:27Z,2022-10-12T09:25:27Z,Will `version.h.in` leave as is? I'm thinking of moving `VERSION` file in the `src` folder so that we have a shorter top-level file list.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MDBlh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MDEvm,kvrocks,1275874278,977,NA,PragmaTwice,20042607,Twice,,NA,2022-10-12T09:35:37Z,2022-10-12T09:35:37Z,"In my thought, these source folders are all in the `src` directory.

I am not sure where to put `version.h.in` now, maybe just in `src/`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MDEvm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MEMjj,kvrocks,1276168419,977,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-12T13:23:03Z,2022-10-12T13:23:03Z,"I think the separation of `redis_cmd` can be done by referring to the official command classification of redis.
https://redis.io/commands/","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MEMjj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MJcQw,kvrocks,1277543472,977,NA,PragmaTwice,20042607,Twice,,NA,2022-10-13T12:37:35Z,2022-10-13T12:37:35Z,"Hi everyone, how do you like this proposal? 

I think the current source files are cluttered in one directory, and as the source files become more and more numerous, it becomes more and more inconvenient to manage & locate them in one directory.

If you like this, you can give your thoughts and opinions on the current file classification to avoid me misclassifying some source files.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MJcQw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MJej3,kvrocks,1277552887,977,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-13T12:45:03Z,2022-10-13T12:45:03Z,"@PragmaTwice I have some proposals about naming:

1. distributed vs cluster - `distributed` looks too general and those files are cluster related
2. data_types vs types - types is intuitive enough?
3. database vs storage - I think storage is more precise than database
4. service vs network

and seems a bit confused that putting `crc32` and `rand` in crypto.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MJej3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MJe77,kvrocks,1277554427,977,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-13T12:46:16Z,2022-10-13T12:46:16Z,see whether folks have other suggestions.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MJe77/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MJt83,kvrocks,1277615927,977,NA,PragmaTwice,20042607,Twice,,NA,2022-10-13T13:28:20Z,2022-10-13T13:28:20Z,"> @PragmaTwice I have some proposals about naming:
> 
> 1. distributed vs cluster - `distributed` looks too general and those files are cluster related
> 2. data_types vs types - types is intuitive enough?
> 3. database vs storage - I think storage is more precious than database
> 4. service vs network
> 
> and seems a bit confuse that puts `crc32` and `rand` in crypto.

Greate advices, I will follow them later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MJt83/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MMdbW,kvrocks,1278334678,977,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-10-14T00:49:58Z,2022-10-14T00:49:58Z,"@PragmaTwice I have a few ideas of my own: 
- `crypto` seem to fit under `common`(or `util`)? 
- `commands` may be split up and placed under each data type?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MMdbW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MM4wf,kvrocks,1278446623,977,NA,PragmaTwice,20042607,Twice,,NA,2022-10-14T03:55:31Z,2022-10-14T03:55:31Z,"Thanks. Here is the second edition: cc @git-hulk @caipengbo 

```
common/
  event_util fd_util parse_util cron encoding db_util event_util log_collector
  parse_util rw_lock status tls_util util rand sha1 rocksdb_crc32c

storage/
  batch_extractor compact_filter compaction_checker event_listener
  lock_manager redis_db redis_disk redis_metadata redis_pubsub
  scripting stats storage table_properties_collector geohash

network/
  server worker redis_reply redis_connection redis_request

cluster/
  cluster redis_slot replication slot_import slot_migrate 

types/
  redis_bitmap redis_bitmap_string redis_geo redis_list redis_hash redis_set
  redis_sortedint redis_stream_base redis_stream redis_string redis_zset

commands/
  redis_cmd (need to be divided)

config/
  config config_type config_util

./
  version main

```

> commands may be split up and placed under each data type?

Great idea, I think we can discuss this after this classification.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MM4wf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MM6De,kvrocks,1278451934,977,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-14T04:04:35Z,2022-10-14T04:04:35Z,Looks good to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MM6De/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MM7c4,kvrocks,1278457656,977,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-10-14T04:13:01Z,2022-10-14T04:13:01Z,LGTM,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MM7c4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MNSuM,kvrocks,1278552972,977,NA,PragmaTwice,20042607,Twice,,NA,2022-10-14T06:40:54Z,2022-10-14T06:40:54Z,Thanks all. I will prepare a PR soon.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MNSuM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/983,kvrocks,1407153498,983,Flaky test on expire precision,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-13T05:10:34Z,2022-10-25T07:26:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

https://github.com/apache/incubator-kvrocks/pull/981/commits/461d0e8cc95cf959df50db2d75fecffbfd919875

### Minimal reproduce step

Flaky test on CI env.

### What did you expect to see?

Tests passed.

### What did you see instead?

```
--- FAIL: TestString (12.24s)
    --- FAIL: TestString/GETEX_EXAT_option (0.00s)
        assertions.go:36: 
            	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/strings/assertions.go:36
            	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/strings/strings_test.go:155
            	Error:      	""11s"" is not less than or equal to ""10s""
            	Test:       	TestString/GETEX_EXAT_option
    --- FAIL: TestString/GETEX_PXAT_option (0.00s)
        assertions.go:36: 
            	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/strings/assertions.go:36
            	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/strings/strings_test.go:162
            	Error:      	""11s"" is not less than or equal to ""10s""
            	Test:       	TestString/GETEX_PXAT_option
```

### Anything Else?

cc @git-hulk please take a look.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/983/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MHhJf,kvrocks,1277039199,983,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-13T05:11:09Z,2022-10-13T05:11:09Z,"It's interesting that the TTL even ""longer"" than what is set.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MHhJf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MHhQq,kvrocks,1277039658,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-13T05:12:04Z,2022-10-13T05:12:04Z,@tisonkun Let me fix it,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MHhQq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRifK,kvrocks,1279666122,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-15T05:29:14Z,2022-10-15T05:29:14Z,"@tisonkun After looking into those flaky test cases, I guess the reason is the way of getting timestamps. For example:
```
require.NoError(t, rdb.Do(ctx, ""getex"", ""foo"", ""exat"", time.Now().Add(10*time.Second).Unix()).Err())
util.BetweenValues(t, rdb.TTL(ctx, ""foo"").Val(), 5*time.Second, 10*time.Second)
```
The expiration timestamp is calculated in Go(wall clock) and TTL will use the C++ `gettimeofday` system.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRifK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MSaDp,kvrocks,1279893737,983,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-16T05:09:53Z,2022-10-16T05:09:53Z,@git-hulk can we have an approach to guard the boundary of tests?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MSaDp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MSiZo,kvrocks,1279927912,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-16T09:09:52Z,2022-10-16T09:09:52Z,"@tisonkun Yes, will be harden by increasing the upper bound for all tests which used EXAT instrument.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MSiZo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MrWI0,kvrocks,1286431284,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-21T04:06:49Z,2022-10-21T04:06:49Z,https://github.com/apache/incubator-kvrocks/actions/runs/3294519235/jobs/5432141189 also caused by the time precision.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MrWI0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M0bi8,kvrocks,1288812732,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-24T10:36:32Z,2022-10-24T10:36:32Z,"I have a basic idea to try hardening those test cases. From the current analysis, the only clue is the different behavior of getting current time in Go and C++, C++ will always use `gettimeofday` and Go is platform and runtime related(used `clock_gettime` in most Linux systems). So I think we can also use `gettimeofday` for those cases and have an eye on whether has this flaky condition or not.


Below code is from Go1.19's runtime:

`time_linux_amd64.s`
```ASM
 14 TEXT time·now<ABIInternal>(SB),NOSPLIT,$16-24
...
 32     CMPQ    R14, m_curg(BX) // Only switch if on curg.
 33     JNE noswitch
 38 noswitch:
 39     SUBQ    $32, SP     // Space for two time results
 40     ANDQ    $~15, SP    // Align for C code
 41
 42     MOVL    $0, DI // CLOCK_REALTIME
 43     LEAQ    16(SP), SI
 44     MOVQ    runtime·vdsoClockgettimeSym(SB), AX
 45     CMPQ    AX, $0
 46     JEQ fallback
 47     CALL    AX
 48
 49     MOVL    $1, DI // CLOCK_MONOTONIC
 50     LEAQ    0(SP), SI
 51     MOVQ    runtime·vdsoClockgettimeSym(SB), AX
 52     CALL    AX
 78 fallback:
 79     MOVQ    $SYS_clock_gettime, AX
 80     SYSCALL
 81
 82     MOVL    $1, DI // CLOCK_MONOTONIC
 83     LEAQ    0(SP), SI
 84     MOVQ    $SYS_clock_gettime, AX
 85     SYSCALL
 86
 87     JMP ret
```

`vdso_linux_amd64.go`

```Go
 15 var vdsoSymbolKeys = []vdsoSymbolKey{
 16     {""__vdso_gettimeofday"", 0x315ca59, 0xb01bca00, &vdsoGettimeofdaySym},
 17     {""__vdso_clock_gettime"", 0xd35ec75, 0x6e43a318, &vdsoClockgettimeSym},
 18 }
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M0bi8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M0t7q,kvrocks,1288888042,983,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-24T11:21:59Z,2022-10-24T11:21:59Z,@git-hulk I think that [`gettimeofday`](https://stackoverflow.com/questions/12392278/measure-time-in-linux-time-vs-clock-vs-getrusage-vs-clock-gettime-vs-gettimeof) is deprecated and we may instead replace `gettimeofday` with `clock_gettime` in the cpp code side?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M0t7q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M0u9k,kvrocks,1288892260,983,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T11:25:41Z,2022-10-24T11:25:41Z,"There are multiple `time` calling in kvrocks:
1. `std::time`, which is from c's api, setting the backup_time and checkpoint access time
2. `rocksdb::Env::GetCurrentTime`, which also calls `std::time` on posix
3. `gettimeofday` in `Worker::FeedMonitorConns`

Notes that:
1. `gettimeofday` is not monotonic, and can be updated by system: https://man7.org/linux/man-pages/man2/gettimeofday.2.html
2. std::time: https://en.cppreference.com/w/cpp/chrono/c/time

As for golang, after 1. Seems it uses monotonic clock ( https://pkg.go.dev/time#hdr-Monotonic_Clocks ). C++11 also provides monotonic clock: https://en.cppreference.com/w/cpp/chrono/steady_clock 

In redis, I found an issue and the solving, maybe we could follow it: https://github.com/redis/redis/issues/416

At least, keep 3 or more `time` in kvrocks is really confusing.

Updated: golang gets both monotonic clock and system clock. It will try to maintain both of them.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M0u9k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M04e3,kvrocks,1288931255,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-24T12:03:38Z,2022-10-24T12:03:38Z,"> @git-hulk I think that [gettimeofday](https://stackoverflow.com/questions/12392278/measure-time-in-linux-time-vs-clock-vs-getrusage-vs-clock-gettime-vs-gettimeof) is deprecated and we may instead replace gettimeofday with clock_gettime in the cpp code side?

Thanks, I didn't notice that `gettimeofday` is deprecated, that's a sure thing since we should NOT use the deprecated API if possible.

> At least, keep 3 or more time in kvrocks is really confusing.

@mapleFU Thanks for your nice input. You're right that we should use a coherent way to get time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M04e3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1pR_,kvrocks,1289131135,983,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T14:32:55Z,2022-10-24T14:32:55Z,"Holdon, I think here is another problem in `ParseTTL`, which would cause this problem, after go through the code of `ParseTTL` in `redis_cmd.cc`, I found that:
1. `expire` is rounded to `seconds`
2. `now` is also rounded to `seconds`

And assume that:
```
now: 10.99s
expire: 21.01s
expected: 10.02s -> 10s ( bias for 20ms between clock maybe ok )
currently: 11s
```

@git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1pR_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1tBI,kvrocks,1289146440,983,NA,PragmaTwice,20042607,Twice,,NA,2022-10-24T14:42:37Z,2022-10-24T14:42:37Z,"I got this point. But I recommand we solve the problem after (or in) #1032, since ParseTTL changes hugely in this PR. :rofl:","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1tBI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1ttS,kvrocks,1289149266,983,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T14:44:34Z,2022-10-24T14:44:34Z,"> 🤣

OK, seems that we should using millseconds to `minus` and do rounding 🤣. So trickey for fixing tests","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1ttS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M15pz,kvrocks,1289198195,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-24T15:18:37Z,2022-10-24T15:18:37Z,":333333, let's increase the upper boundary.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M15pz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M17Rm,kvrocks,1289204838,983,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-24T15:23:36Z,2022-10-24T15:23:36Z,@git-hulk perhaps wait for one more occurrence ;-),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M17Rm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M18PC,kvrocks,1289208770,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-24T15:26:26Z,2022-10-24T15:26:26Z,okay,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M18PC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M19l2,kvrocks,1289214326,983,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-24T15:30:39Z,2022-10-24T15:30:39Z,@mapleFU could you help with preparing a fix for https://github.com/apache/incubator-kvrocks/issues/983#issuecomment-1289131135?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M19l2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1-81,kvrocks,1289219893,983,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T15:34:48Z,2022-10-24T15:34:48Z,"> @mapleFU could you help with preparing a fix for [#983 (comment)](https://github.com/apache/incubator-kvrocks/issues/983#issuecomment-1289131135)?

@tisonkun Glad to fix it, but should I waiting for #1032 to be merged first?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1-81/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1_H7,kvrocks,1289220603,983,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-24T15:35:20Z,2022-10-24T15:35:20Z,"> Holdon, I think here is another problem in `ParseTTL`, which would cause this problem, after go through the code of `ParseTTL` in `redis_cmd.cc`, I found that:
> 
> 1. `expire` is rounded to `seconds`
> 2. `now` is also rounded to `seconds`
> 
> And assume that:
> 
> ```
> now: 10.99s
> expire: 21.01s
> expected: 10.02s -> 10s ( bias for 20ms between clock maybe ok )
> currently: 11s
> ```
> 
> @git-hulk

Our failing test case (Like `Extended SET EXAT option`) uses an expiration time in seconds, which doesn't seem to be a problem due to rounding. I think the main problem is the inconsistency in the way of getting time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1_H7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2CmA,kvrocks,1289234816,983,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T15:46:05Z,2022-10-24T15:46:05Z,"> Our failing test case (Like `Extended SET EXAT option`) uses an expiration time in seconds, which doesn't seem to be a problem due to rounding. I think the main problem is the inconsistency in the way of getting time.

At most of the time, the `value = expected_largest + 1`. Since clock may not have too large bias, it may be a sequence like:

```
now: 10s
now in kvrocks: 9.8s
now + expire - kvrocks_time = 10s
```

The 20ms' bias cames from different way of getting time, but it also could cames from NTP or others, since in C++, we just use system clock. 
@tanruixiang 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2CmA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2IZS,kvrocks,1289258578,983,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-24T16:03:29Z,2022-10-24T16:03:29Z,"> > Our failing test case (Like `Extended SET EXAT option`) uses an expiration time in seconds, which doesn't seem to be a problem due to rounding. I think the main problem is the inconsistency in the way of getting time.
> 
> At most of the time, the `value = expected_largest + 1`. Since clock may not have too large bias, it may be a sequence like:
> 
> ```
> now: 10s
> now in kvrocks: 9.8s
> now + expire - kvrocks_time = 10s
> ```
> 
> The 20ms' bias cames from different way of getting time, but it also could cames from NTP or others, since in C++, we just use system clock. @tanruixiang

But our tests are all on the same machine. Will it be monotonic to use the same method to obtain the time on the same machine? If it is monotonic(go and c++ get time the same way), Then there will be no case of getting 11s in the failed test.

```
go-redis get time:t1
set tll t1+10
get ttl from kvrocks : t2
if t1<=t2
=> t1+10 -t2 >=11
=> t1-t2>=1   is impossible 
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2IZS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2Mqh,kvrocks,1289276065,983,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T16:17:12Z,2022-10-24T16:17:12Z,"> But our tests are all on the same machine. Will it be monotonic to use the same method to obtain the time on the same machine? If it is monotonic(go and c++ get time the same way), Then there will be no case of getting 11s in the failed test.

Golang's standard `Now` uses `CLOCK_MONOTONIC`, so, it's monotonic.

In C++, since it use `system_clock`, it uses `CLOCK_REALTIME`. `CLOCK_REALTIME` can be affected by NTP or setting, so it can move backward.

As a result:
1. Time api is different in golang and C++
2. The rounding would make problem worse
3. `CLOCK_REALTIME` may come accross time drifting

@tanruixiang 

(Updated: golang will tend to use `CLOCK_REALTIME` when casting to Unix timestamp )
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2Mqh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2NWH,kvrocks,1289278855,983,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T16:19:38Z,2022-10-24T16:19:38Z,"Actually, I'm not saying that `rounding cause the problem`, I just declares that `it may made the problem worse`. Since the two clocks maybe just have ~10ms' bias. And it maybe not harmful, because one second may only harm our testings ╮(￣▽￣"""")╭","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2NWH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2OsG,kvrocks,1289284358,983,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-24T16:24:19Z,2022-10-24T16:24:19Z,"> > But our tests are all on the same machine. Will it be monotonic to use the same method to obtain the time on the same machine? If it is monotonic(go and c++ get time the same way), Then there will be no case of getting 11s in the failed test.
> 
> Golang's standard `Now` uses `CLOCK_MONOTONIC`, so, it's monotonic.
> 
> In C++, since it use `system_clock`, it uses `CLOCK_REALTIME`. `CLOCK_REALTIME` can be affected by NTP or setting, so it can move backward.
> 
> As a result:
> 
> 1. Time api is different in golang and C++
> 2. The rounding would make problem worse
> 3. `CLOCK_REALTIME` may come accross time drifting
> 
> @tanruixiang

Ok. I misunderstood that after this [modification](https://github.com/apache/incubator-kvrocks/pull/1038), Go and C++ would use the same clock. Thank you for your patience. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2OsG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2PqE,kvrocks,1289288324,983,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-24T16:27:44Z,2022-10-24T16:27:44Z,"> Actually, I'm not saying that `rounding cause the problem`, I just declares that `it may made the problem worse`. Since the two clocks maybe just have ~10ms' bias. And it maybe not harmful, because one second may only harm our testings ╮(￣▽￣"""")╭

It seems that the main problem is still go and c++ using different clocks. Rounding in the same direction won't cause a problem if use the same clocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2PqE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2WqI,kvrocks,1289317000,983,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T16:50:40Z,2022-10-24T16:50:40Z,"@tanruixiang @git-hulk Maybe I made a mistake, after go through go's `time.Now`, the `nsecs` just return a wall time if possible. Let's just waiting for testing now","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2WqI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4n-H,kvrocks,1289912199,983,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-25T03:01:26Z,2022-10-25T03:01:26Z,"> @tanruixiang @git-hulk Maybe I made a mistake, after go through go's `time.Now`, the `nsecs` just return a wall time if possible. Let's just waiting for testing now

OK. Closed as completed. Reopen or relax the upper bound if it happens again.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4n-H/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4n_q,kvrocks,1289912298,983,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-25T03:01:36Z,2022-10-25T03:01:36Z,"> @tanruixiang @git-hulk Maybe I made a mistake, after go through go's `time.Now`, the `nsecs` just return a wall time if possible. Let's just waiting for testing now

OK. Closed as completed. Reopen or relax the upper bound if it happens again.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4n_q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4owF,kvrocks,1289915397,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-25T03:06:43Z,2022-10-25T03:06:43Z,"> `ck`, it uses `CLOCK_REALTIME`. `CLOCK_REALTIME` can be affected by NTP or setting, so it can move backward.

Yes, I copied the assemble in https://github.com/apache/incubator-kvrocks/issues/983#issuecomment-1288812732, Go runtime will use `CLOCK_REALTIME` first then fallback to `CLOCK_MONOTONIC` if it's failed. Many thanks for your great study and input.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4owF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M5HqN,kvrocks,1290041997,983,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-25T06:20:54Z,2022-10-25T06:20:54Z,"@tisonkun @PragmaTwice @mapleFU @tanruixiang After rethinking about this issue,  `gettimeofday`[1] is also using `clock_gettime`(as well as `chrono::system_clock`[2]) indeed and the only different is the time precision and Go `time.Now().Unix()` shouldn't be affected by the time precision(it's second unit), but we got 11s in test case which means the current second of Kvrocks was smaller than getting from Go. I guess the root cause is NTP synchronization backwards the unix second and nothing to do with using `gettimeofday` or `clock_gettime`, so #1038 can't fix current issue. Correct me if was wrong.

[1] https://elixir.bootlin.com/glibc/latest/source/time/gettimeofday.c#L35
[2] https://codebrowser.dev/llvm/libcxx/src/chrono.cpp.html#_ZN6chronoL25__libcpp_system_clock_nowEv","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M5HqN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M5YZP,kvrocks,1290110543,983,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-25T07:26:34Z,2022-10-25T07:26:34Z,"> @tisonkun @PragmaTwice @mapleFU @tanruixiang After rethinking about this issue, `gettimeofday`[1] is also using `clock_gettime`(as well as `chrono::system_clock`[2]) indeed and the only different is the time precision and Go `time.Now().Unix()` shouldn't be affected by the time precision(it's second unit), but we got 11s in test case which means the current second of Kvrocks was smaller than getting from Go. I guess the root cause is NTP synchronization backwards the unix second and nothing to do with using `gettimeofday` or `clock_gettime`, so #1038 can't fix current issue. Correct me if was wrong.
> 
> [1] https://elixir.bootlin.com/glibc/latest/source/time/gettimeofday.c#L35 [2] https://codebrowser.dev/llvm/libcxx/src/chrono.cpp.html#_ZN6chronoL25__libcpp_system_clock_nowEv



Can we avoid this problem by disabling ntp, or configuring ntp?  If we use the -x option, ntp will always use slew mode, which will not cause time back.
Reference:
https://groups.google.com/g/comp.protocols.time.ntp/c/u3bmMHV1g5o
https://docs.ntpsec.org/latest/ntpd.html","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M5YZP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/992,https://api.github.com/repos/apache/kvrocks/issues/992,kvrocks,1409511905,992,"When GeoRadiusStore uses store*, kvrocks returns a value, but redis returns a number",tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,CLOSED,2022-10-14T15:21:42Z,2022-10-14T17:23:37Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

https://github.com/apache/incubator-kvrocks/commit/b1f73a86f299a3263b887ece0fdf07a5f115d0e8

### Minimal reproduce step

```
127.0.0.1:6666> geoadd points 13.361389 38.115556 ""Palermo"" 15.087269 37.502669 ""Catania""
(integer) 2
127.0.0.1:6666> georadius points 13.361389 38.115556 500 km storedist mytest
1) ""Palermo""
2) ""Catania""
```

### What did you expect to see?

```
127.0.0.1:6379> geoadd points 13.361389 38.115556 ""Palermo"" 15.087269 37.502669 ""Catania""
(integer) 2
127.0.0.1:6379> georadius points 13.361389 38.115556 500 km storedist mytest
(integer) 2
```

### What did you see instead?

```
127.0.0.1:6666> geoadd points 13.361389 38.115556 ""Palermo"" 15.087269 37.502669 ""Catania""
(integer) 2
127.0.0.1:6666> georadius points 13.361389 38.115556 500 km storedist mytest
1) ""Palermo""
2) ""Catania""
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/992/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/995,https://api.github.com/repos/apache/kvrocks/issues/995,kvrocks,1409999574,995,Move TCL test unit/tls to Go case,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-15T01:19:24Z,2022-10-20T13:22:03Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/995/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/995,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRYBH,kvrocks,1279623239,995,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-15T01:19:57Z,2022-10-15T01:19:57Z,@PragmaTwice could you spend some time taking care of the TLS tests?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MRYBH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/995,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MReAi,kvrocks,1279647778,995,NA,PragmaTwice,20042607,Twice,,NA,2022-10-15T03:39:15Z,2022-10-15T03:39:15Z,Sure.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MReAi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/995,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MfN0N,kvrocks,1283251469,995,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-19T01:29:20Z,2022-10-19T01:29:20Z,go-redis's TLS config: https://redis.uptrace.dev/guide/go-redis.html#using-tls,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MfN0N/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/995,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mfs5F,kvrocks,1283378757,995,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-19T03:43:56Z,2022-10-19T03:43:56Z,"https://github.com/tisonkun/incubator-kvrocks/tree/tls-tests

Here is a prototype that you can make use of. Although, TLS config is a bit complex that I cannot handle it soon :(","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mfs5F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/995,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgXxv,kvrocks,1283554415,995,NA,PragmaTwice,20042607,Twice,,NA,2022-10-19T07:27:51Z,2022-10-19T07:27:51Z,Thanks! I will try to use these patches.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgXxv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/996,https://api.github.com/repos/apache/kvrocks/issues/996,kvrocks,1410162532,996,Fix didn't send replication master auth if it's created in flight,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-10-15T13:09:52Z,2022-10-16T03:56:45Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

21b92a9f11cdd479498e592e500c29d137d8eec1

### Minimal reproduce step

1. Start `serverA` and `serverB` without `requirepass`
2. `ServerB` slave of `slaveA`
3. Use the config set command to create requirepass/master for the `serverA` and `serverB`
4. Client kill type slave in the master(`serverA`)


### What did you expect to see?

The slave(`serverB`) is disconnected from the master `slaveA`

### What did you see instead?

The slave(`serverB`) is re-connected with the master `slaveA` normally

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/996/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/999,https://api.github.com/repos/apache/kvrocks/issues/999,kvrocks,1410446905,999,Flaky test TestReplicationWithLimitSpeed,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-16T10:38:37Z,2022-10-16T13:18:44Z,"```
--- FAIL: TestReplicationWithLimitSpeed (10.10s)
    client.go:72: 
        	Error Trace:	/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/replication/client.go:72
        	            				/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/replication/replication_test.go:209
        	Error:      	Received unexpected error:
        	            	i/o timeout
        	Test:       	TestReplicationWithLimitSpeed
```

Unstable test. @git-hulk perhaps release the read timeout for the specific case.

_Originally posted by @tisonkun in https://github.com/apache/incubator-kvrocks/issues/998#issuecomment-1279942166_

Check run: https://github.com/apache/incubator-kvrocks/actions/runs/3258497049/jobs/5350638195","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/999/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/999,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MSn0b,kvrocks,1279950107,999,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-16T11:26:14Z,2022-10-16T11:26:14Z,"Yes, I will handle it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MSn0b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1001,https://api.github.com/repos/apache/kvrocks/issues/1001,kvrocks,1410477477,1001,Make kvrocks dump rdb file which redis can load.,ColinChamber,95634254,ColinChamber,,CLOSED,2022-10-16T12:43:02Z,2022-11-07T04:55:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

  Making Kvrocks write RDB is more straightforward than making it parse RDB.
  Because Redis is backward compatible, which can load the original RDB file. 
  We can easily utilize the primitive RDB object types, which follow the simple 
  encoding pattern:  <type> <len> <key> <len> <value> 
  or <type> <len> <key> <size> <data> (<data> consists of <len><key(value)>)
  RDB_TYPE_STRING, RDB_TYPE_LIST, RDB_TYPE_SET, RDB_TYPE_ZSET, RDB_TYPE_HASH,
  these five types follow this pattern. We ignore the RDB_TYPE_HASH_ZIPMAP, 
  RDB_TYPE_LIST_ZIPLIST, RDB_TYPE_SET_INTSET, and other complicated types 
  only implement the five simple type.
 
  There is a mapping relationship between Redis object type and RDB object type.
  But you don't have to worry about Redis using ineffective object types after loading RDB. 
  Redis will convert it to an efficient type automatically.
  E.g
  	kvrocks> hmset foo foo1 bar1 foo2 bar2
	kvrocks> save (use RDB_TYPE_HASH rather than RDB_TYPE_HASH_ZIPLIST)
   --------  Redis loads the RDB that kvrocks dumped  --------
   redis> OBJECT ENCODING foo
   ""ziplist""
   
  There are more detailed references to RDB.
   https://github.com/sripathikrishnan/redis-rdb-tools/wiki/Redis-RDB-Dump-File-Format
   https://github.com/sripathikrishnan/redis-rdb-tools/blob/master/docs/RDB_Version_History.textile
   https://rdb.fnordig.de/file_format.html

### Solution

#958 

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1001/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1001,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MVbhr,kvrocks,1280686187,1001,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-17T11:06:39Z,2022-10-17T11:06:39Z,"cool, thanks for @ColinChamber great work.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MVbhr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1001,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NyHR5,kvrocks,1304982649,1001,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-11-07T01:55:41Z,2022-11-07T01:55:41Z,"Hi @ColinChamber @git-hulk i don't think supporting dumping RDB in Kvrocks is a good idea.
Kvrocks builds its data based on SSD, and its data volume usually is huge, so the RDB usually is big, i don't think it is a general requirement of loading so big RDB file into redis. What's more, Kvrocks is Kvrocks rather than a fork of redis, we support redis protocol and some commands, don't need to support everything, so i think it is not suitable to support dumping RDB in Kvrocks core code,  and now we already has `kvrocks2redis` which could generate AOF, i think it looks enough, even we want to support dumping rdb, we should implement this feature in `kvrocks2redis`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NyHR5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1001,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Nyerv,kvrocks,1305078511,1001,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-07T04:55:18Z,2022-11-07T04:55:18Z,"> Hi @ColinChamber @git-hulk i don't think supporting dumping RDB in Kvrocks is a good idea. Kvrocks builds its data based on SSD, and its data volume usually is huge, so the RDB usually is big, i don't think it is a general requirement of loading so big RDB file into redis. What's more, Kvrocks is Kvrocks rather than a fork of redis, we support redis protocol and some commands, don't need to support everything, so i think it is not suitable to support dumping RDB in Kvrocks core code, and now we already has `kvrocks2redis` which could generate AOF, i think it looks enough, even we want to support dumping rdb, we should implement this feature in `kvrocks2redis`.

Yes, maybe we need a basic guide or consensus to determine what features can be merged or not.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Nyerv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1007,https://api.github.com/repos/apache/kvrocks/issues/1007,kvrocks,1412529604,1007,Support config 'backup-dir' can be changed,iushas,7236171,tanic.xiao,,CLOSED,2022-10-18T03:52:51Z,2022-10-24T04:18:35Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Support config 'backup-dir' can be changed,
now can't be modify 


```
127.0.0.1:6379> config set backup-dir /home/data/backup/db
(error) CONFIG SET 'backup-dir' error: Unsupported CONFIG parameter: backup-dir
```

### Solution

backup disk or filesystem may be damaged， wo need change the backupdir  to ensure backup process is normal

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1007/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1007,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mf-Sj,kvrocks,1283450019,1007,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-19T05:27:42Z,2022-10-19T05:27:42Z,"I'd like to submit a patch for this issue, but I have some problems
@git-hulk What's the expective behavior for `config set backup-dir ...` when:
1. Previous database is backing up?
2. Have previous backup?

Changing the `backup_dir` is easy, but it may tears using it. And previous `backup_dir` may having backup data. Should we purge old backup or rename dir when the dir is changed?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mf-Sj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1007,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgEbk,kvrocks,1283475172,1007,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-19T06:03:44Z,2022-10-19T06:03:44Z,"> I'd like to submit a patch for this issue, but I have some problems @git-hulk What's the expective behavior for `config set backup-dir ...` when:
> 
> 1. Previous database is backing up?
> 2. Have previous backup?
> 
> Changing the `backup_dir` is easy, but it may tears using it. And previous `backup_dir` may having backup data. Should we purge old backup or rename dir when the dir is changed?

@mapleFU Thank you! 

1. Previous database is backing up?

**The change can only affect the new coming backup request, the on going backup can be still i the old backup dir.**

3. Have previous backup?

**Yes, we can keep at most one backup**


4. And previous `backup_dir` may having backup data. Should we purge old backup or rename dir when the dir is changed?

**I think we can left the old backup data as it be and users can delete it manually if they want.**
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgEbk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1007,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgFGH,kvrocks,1283477895,1007,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-19T06:06:56Z,2022-10-19T06:06:56Z,"Seems that after gothrough issue: 
https://github.com/redis/redis/issues/3594
and code for redis about `dbfilename` and `server.rdb_filename`, it may not purge the old files. I think we can make user drop it themselves.

Another problem is, when a previous task is running, should `config` waiting for it or just grab the `rdb` mutex to avoid the tear read and  change the config? And how can I testing it, do we have some hooks for testing in our code?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgFGH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1007,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgLio,kvrocks,1283504296,1007,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-19T06:36:51Z,2022-10-19T06:36:51Z,"> when a previous task is running, should config waiting for it or just grab the rdb mutex to avoid the tear read and change the config? 

Yes, we have the backup mutex to prevent concurrent creating backup, can see: https://github.com/apache/incubator-kvrocks/blob/unstable/src/storage/storage.cc#L334

> And how can I testing it, do we have some hooks for testing in our code?

No test now, can test locally only if have no good way to add the test case.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgLio/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1007,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mg1mH,kvrocks,1283676551,1007,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-19T09:07:44Z,2022-10-19T09:07:44Z,"@git-hulk Seems making `backup_dir_` guarded by `backup_mu_`, though `backup_mu_` is too coarse( `DestoryDB` and `rocksdb::Checkpoint::Create` in `backup_mu_` is heavy ).
I will add a patch for implement and testing `backup-dir`, and not change the scope of `backup_mu_`, you can assign this issue to me","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mg1mH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1007,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MhGuT,kvrocks,1283746707,1007,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-19T10:03:11Z,2022-10-19T10:03:11Z,"@mapleFU assigned, thanks! 

> Seems making backup_dir_ guarded by backup_mu_, though backup_mu_ is too coarse( DestoryDB and rocksdb::Checkpoint::Create in backup_mu_ is heavy ).

Yes, but I think it can avoid the backup mutex by copying `backup_dir_` variable instead of the reference.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MhGuT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1010,https://api.github.com/repos/apache/kvrocks/issues/1010,kvrocks,1413718444,1010,Missing Docker image for v2.1.0,kinoute,623763,Yann Defretin,yann@defret.in,CLOSED,2022-10-18T19:12:55Z,2022-10-29T08:00:21Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

I am looking for the Docker image on the Hub for the version 2.1.0.

### Solution

Build, tag and push the image of the version v2.1.0 here https://hub.docker.com/r/kvrocks/kvrocks/tags

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1010/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1010,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mf5hT,kvrocks,1283430483,1010,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-19T04:58:34Z,2022-10-19T04:58:34Z,"We only make a source release for 2.1.0 as it's the first Apache release and we're going through the process.

@git-hulk however, since there're quite a few users who want to use 2.1.0 via docker image, perhaps we can stage and vote for a docker image release specifically.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mf5hT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1010,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgGDz,kvrocks,1283481843,1010,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-19T06:11:32Z,2022-10-19T06:11:32Z,"@tisonkun Yes, but I'm not clear about where to place the docker image, since seems the apache organization in DockerHub is out of seat: [About docker image release and license
](https://lists.apache.org/thread/hfg1h5yrz2bs1d20vq7lm669wcjsfcp1). I'm wondering if it's ok to release in Kvrocks organization after passing the voting process.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgGDz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1010,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgLT5,kvrocks,1283503353,1010,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-19T06:35:53Z,2022-10-19T06:35:53Z,"> @tisonkun Yes, but I'm not clear about where to place the docker image, since seems the apache organization in DockerHub is out of seat: [About docker image release and license ](https://lists.apache.org/thread/hfg1h5yrz2bs1d20vq7lm669wcjsfcp1). I'm wondering if it's ok to release in Kvrocks organization after passing the voting process.

I noticed that doris is still updating images on dockerhub. Can we continue to update images on dockerhub like they do? Maybe we need some process to put kvrocks into apache organization in dockerhub.

https://hub.docker.com/r/apache/doris","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgLT5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1010,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgMLV,kvrocks,1283506901,1010,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-19T06:39:29Z,2022-10-19T06:39:29Z,"@tanruixiang Yes, the best choice is to place in apache organization, but looks it's out of seat now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgMLV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1010,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgQHH,kvrocks,1283523015,1010,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-19T06:57:00Z,2022-10-19T06:57:00Z,"@git-hulk Pulsar and Flink both use their own dockerhub entry to release images so I think it's OK for now.

You can also file a ticket on [the INFRA JIRA project](https://issues.apache.org/jira/projects/INFRA) to ask for permissions login the apache org and release the docker images there.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgQHH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1010,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgQl-,kvrocks,1283524990,1010,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-19T06:59:03Z,2022-10-19T06:59:03Z,"> @git-hulk Pulsar and Flink both use their own dockerhub entry to release images so I think it's OK for now.
> 
> You can also file a ticket on [the INFRA JIRA project](https://issues.apache.org/jira/projects/INFRA) to ask for permissions login the apache org and release the docker images there.

okay, thanks. Will do it today.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgQl-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1010,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgSOB,kvrocks,1283531649,1010,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-10-19T07:05:47Z,2022-10-19T07:05:47Z,"> @tanruixiang Yes, the best choice is to place in apache organization, but looks it's out of seat now.

I understand now. I'm sorry I misunderstood your meaning before. I noticed that the `linkis` community who asked this question uses an alternative to the github registry.

https://github.com/orgs/apache/packages?repo_name=incubator-linkis","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgSOB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1010,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgVl5,kvrocks,1283545465,1010,NA,PragmaTwice,20042607,Twice,,NA,2022-10-19T07:19:24Z,2022-10-19T07:19:24Z,"> > @tanruixiang Yes, the best choice is to place in apache organization, but looks it's out of seat now.
> 
> I understand now. I'm sorry I misunderstood your meaning before. I noticed that the `linkis` community who asked this question uses an alternative to the github registry.
> 
> https://github.com/orgs/apache/packages?repo_name=incubator-linkis

Sure, we can use github package registry, but I prefer dockerhub since
```sh
docker run -it apache/kvrocks # or kvrocks/kvrocks
```
is shorter than
```sh
docker run -it ghcr.io/apache/incubator-kvrocks
```
🤣 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MgVl5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1014,https://api.github.com/repos/apache/kvrocks/issues/1014,kvrocks,1415920829,1014,"Flaky test ""kill normal client""",tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-20T04:25:06Z,2022-10-21T03:14:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

```
--- FAIL: TestIntrospection (3.80s)
    --- FAIL: TestIntrospection/Kill_normal_client (0.00s)
        introspection_test.go:120: 
            	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/introspection/introspection_test.go:120
            	Error:      	Not equal: 
            	            	expected: int(1)
            	            	actual  : int64(2)
            	Test:       	TestIntrospection/Kill_normal_client
```

https://github.com/apache/incubator-kvrocks/actions/runs/3286622831/jobs/5414949088

### Solution

Perhaps we should tolerate 1 or 2.

@vmihailenco is this behavior related to go-redis auto reconnecting?

cc @git-hulk 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1014/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MlhoE,kvrocks,1284905476,1014,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-20T04:25:33Z,2022-10-20T04:25:33Z,"Related test code:

```go
	t.Run(""Kill normal client"", func(t *testing.T) {
		defer func() { rdb = srv.NewClient() }()

		c := srv.NewClient()
		defer func() { require.NoError(t, c.Close()) }()
		r := c.Do(ctx, ""CLIENT"", ""SETNAME"", ""normal"")
		require.NoError(t, r.Err())
		require.Equal(t, ""OK"", r.Val())
		require.Regexp(t, "".*name=normal.*"", rdb.ClientList(ctx).Val())

		require.EqualValues(t, 1, rdb.ClientKillByFilter(ctx, ""skipme"", ""yes"", ""type"", ""normal"").Val())
		require.EqualValues(t, 1, rdb.ClientKillByFilter(ctx, ""skipme"", ""no"", ""type"", ""normal"").Val())

		// reconnect
		require.NoError(t, rdb.Close())
		rdb = srv.NewClient()

		// now the client should no longer be listed
		require.Eventually(t, func() bool {
			r := rdb.ClientList(ctx).Val()
			return !strings.Contains(r, ""normal"")
		}, 5*time.Second, 100*time.Millisecond)
	})
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MlhoE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ml1eg,kvrocks,1284986784,1014,NA,vmihailenco,290976,Vladimir Mihailenco,vladimir.webdev@gmail.com,NA,2022-10-20T06:04:47Z,2022-10-20T06:04:47Z,">@vmihailenco is this behavior related to go-redis auto reconnecting?

Probably not, but ClientKillByFilter with `""skipme"", ""no""` could be retried, but that is just a guess.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ml1eg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MmCOq,kvrocks,1285039018,1014,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-20T06:59:16Z,2022-10-20T06:59:16Z,@vmihailenco Thanks for your information! @git-hulk is digging with network traffic now..,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MmCOq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoU-9,kvrocks,1285640125,1014,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-20T14:25:00Z,2022-10-20T14:25:00Z,"Yes, @vmihailenco is right, I can't find the reconnect behavior after being killed. And as mentioned in #1020, it may be caused by the duplicate count and killed in the Kvrocks server. Many thanks for your help.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoU-9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1016,https://api.github.com/repos/apache/kvrocks/issues/1016,kvrocks,1416402811,1016,Flaky Test TestSlotMigrateFromSlave,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-20T10:51:12Z,2022-11-04T01:43:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

```
--- FAIL: TestSlotMigrateFromSlave (2.36s)
    server.go:106: 
        	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/server.go:106
        	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/server.go:112
        	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/server.go:101
        	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:47
        	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:65
        	Error:      	Received unexpected error:
        	            	signal: aborted (core dumped)
        	Test:       	TestSlotMigrateFromSlave
FAIL
```

### Solution

Perhaps we should upload server output on test failures? cc @PragmaTwice 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1016/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1016,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MnH2K,kvrocks,1285324170,1016,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-20T10:51:33Z,2022-10-20T10:51:33Z,https://github.com/apache/incubator-kvrocks/actions/runs/3288512905/jobs/5418990199,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MnH2K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1016,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MnONV,kvrocks,1285350229,1016,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-20T11:16:45Z,2022-10-20T11:16:45Z,"Looks crash after sending the terminate signal, but have no idea to reproduce it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MnONV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1016,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4Zqz,kvrocks,1289853619,1016,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-25T01:22:13Z,2022-10-25T01:22:13Z,https://github.com/apache/incubator-kvrocks/actions/runs/3314140570/jobs/5474097740 Another flaky case,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4Zqz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1016,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4aFo,kvrocks,1289855336,1016,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-25T01:25:18Z,2022-10-25T01:25:18Z,"@git-hulk they're somehow different issues - not the exact failure cause, or not the exact test case:

```
--- FAIL: TestSlotMigrateDataType (85.48s)
    --- FAIL: TestSlotMigrateDataType/MIGRATE_-_Migrate_incremental_data_via_parsing_and_filtering_data_in_WAL (60.85s)
        slotmigrate_test.go:703: 
            	Error Trace:	/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:703
            	            				/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:625
            	Error:      	Condition never satisfied
            	Test:       	TestSlotMigrateDataType/MIGRATE_-_Migrate_incremental_data_via_parsing_and_filtering_data_in_WAL
FAIL
exit status 1
```

```
--- FAIL: TestPubSub (1.20s)
    server.go:106: 
        	Error Trace:	/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/pubsub/server.go:106
        	            				/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/pubsub/server.go:112
        	            				/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/pubsub/server.go:101
        	            				/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/pubsub/pubsub_test.go:369
        	Error:      	Received unexpected error:
        	            	signal: abort trap
        	Test:       	TestPubSub
FAIL
exit status 1
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4aFo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1016,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4af-,kvrocks,1289857022,1016,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-25T01:28:23Z,2022-10-25T01:28:23Z,"> @git-hulk they're somehow different issues - not the exact failure cause, or not the exact test case:
> 
> ```
> --- FAIL: TestSlotMigrateDataType (85.48s)
>     --- FAIL: TestSlotMigrateDataType/MIGRATE_-_Migrate_incremental_data_via_parsing_and_filtering_data_in_WAL (60.85s)
>         slotmigrate_test.go:703: 
>             	Error Trace:	/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:703
>             	            				/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:625
>             	Error:      	Condition never satisfied
>             	Test:       	TestSlotMigrateDataType/MIGRATE_-_Migrate_incremental_data_via_parsing_and_filtering_data_in_WAL
> FAIL
> exit status 1
> ```
> 
> ```
> --- FAIL: TestPubSub (1.20s)
>     server.go:106: 
>         	Error Trace:	/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/pubsub/server.go:106
>         	            				/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/pubsub/server.go:112
>         	            				/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/pubsub/server.go:101
>         	            				/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/pubsub/pubsub_test.go:369
>         	Error:      	Received unexpected error:
>         	            	signal: abort trap
>         	Test:       	TestPubSub
> FAIL
> exit status 1
> ```

Yes, for the `TestPusSub` test case, it should be the same with [TestSlotMigrateFromSlave](https://github.com/apache/incubator-kvrocks/issues/1016#top), there're core when exiting the server.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4af-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1016,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4avh,kvrocks,1289858017,1016,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-25T01:30:10Z,2022-10-25T01:30:10Z,"@git-hulk I'm thinking of uploading the log files if there's a test failure...Don't have a concrete plan yet, though.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4avh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1016,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4cSM,kvrocks,1289864332,1016,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-25T01:40:54Z,2022-10-25T01:40:54Z,I'm also thinking how to download the log file if it cored,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4cSM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1018,https://api.github.com/repos/apache/kvrocks/issues/1018,kvrocks,1416535096,1018,Support ZADD options,manchurio,82277001,,,CLOSED,2022-10-20T12:27:55Z,2022-10-28T05:53:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

ZADD supports a list of options.
Starting with Redis version 3.0.2: Added the XX, NX, CH and INCR options.
Starting with Redis version 6.2.0: Added the GT and LT options.

I need these in my business scenario.

### Solution

https://redis.io/commands/zadd/

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1018/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/1019,kvrocks,1416644759,1019,Move docker image to  the Apache organization,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-10-20T13:38:34Z,2022-11-04T06:22:44Z,"### Search before asking

- [X] I searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, we're holding the Kvrocks docker image in the personal repo and Apache infra has created the repo for [Kvrocks](https://hub.docker.com/r/apache/kvrocks), so I think we can move the nightly docker image to the apache organization and then also release tag after knowing how to meet the apache requirements.

### Solution

Push to apache/kvrocks instead of kvrocks/kvrocks after building the docker image.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1019/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoAuO,kvrocks,1285557134,1019,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-20T13:38:55Z,2022-10-20T13:38:55Z,cc @tisonkun @torwig @ShooterIT @caipengbo ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoAuO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoKlc,kvrocks,1285597532,1019,NA,torwig,8588372,Yaroslav,,NA,2022-10-20T14:00:17Z,2022-10-20T14:00:17Z,"Are there any drawbacks for end users if the image will be pushed to another repository?
Can we keep the `kvrocks` image in both repositories for some time? Or it is useless?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoKlc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoMi_,kvrocks,1285605567,1019,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-20T14:04:08Z,2022-10-20T14:04:08Z,"> Are there any drawbacks for end users if the image will be pushed to another repository? Can we keep the `kvrocks` image in both repositories for some time? Or it is useless?

Yes, agree we can keep both repositories for some time and the only drawback should be history images can't be seen in the new organization.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MoMi_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mre6y,kvrocks,1286467250,1019,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-10-21T05:07:08Z,2022-10-21T05:07:08Z,"+1.

I am not sure we could keep both repositories, since we have donated this  project into apache.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mre6y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MriZx,kvrocks,1286481521,1019,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-21T05:32:48Z,2022-10-21T05:32:48Z,"> +1.
> 
> I am not sure we could keep both repositories, since we have donated this project into apache.

😭 it will affect users whose using the old image if we can't keep the both for some time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MriZx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mrizx,kvrocks,1286483185,1019,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-21T05:35:55Z,2022-10-21T05:35:55Z,"@git-hulk I think that we can host Apache releases in the apache org while leaving the previous ones as is.

Similar decisions: https://github.com/apache/pulsar-helm-chart/pull/301#discussion_r998937325","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Mrizx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MrlRW,kvrocks,1286493270,1019,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-21T05:53:37Z,2022-10-21T05:53:37Z,Thanks @tisonkun,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MrlRW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M13gI,kvrocks,1289189384,1019,NA,PragmaTwice,20042607,Twice,,NA,2022-10-24T15:12:24Z,2022-10-24T15:12:24Z,"I think we can firstly vote and release the docker image for kvrocks 2.1.0 in the apache org.

And leave a message in kvrocks/kvrocks like ""move to apache/kvrocks for new stable versions"".","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M13gI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2eFg,kvrocks,1289347424,1019,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2022-10-24T17:17:06Z,2022-10-24T17:17:06Z,@PragmaTwice That would be great,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M2eFg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4ZV6,kvrocks,1289852282,1019,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-25T01:20:04Z,2022-10-25T01:20:04Z,@PragmaTwice Do you have time to drive this voting process recently?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4ZV6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4mHc,kvrocks,1289904604,1019,NA,PragmaTwice,20042607,Twice,,NA,2022-10-25T02:48:20Z,2022-10-25T02:48:20Z,"> @PragmaTwice Do you have time to drive this voting process recently?

Sure. I will do it recently.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4mHc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4pJE,kvrocks,1289916996,1019,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-25T03:09:32Z,2022-10-25T03:09:32Z,"Cool, thanks~","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M4pJE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NmHX5,kvrocks,1301837305,1019,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-11-03T09:30:03Z,2022-11-03T09:30:03Z,I think this issue can be closed as completed now?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NmHX5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1019,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NmOjV,kvrocks,1301866709,1019,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-03T09:58:38Z,2022-11-03T09:58:38Z,"nightly image is still in kvrocks organization, will do it soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NmOjV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1021,https://api.github.com/repos/apache/kvrocks/issues/1021,kvrocks,1416852733,1021,Persist the cluster topology after applying,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-10-20T15:38:47Z,2023-01-12T09:43:07Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, Kvrocks didn't persist the cluster nodes topology and it needs to resync every time after restarting which it's not very convenient. I think we can store and reload it in the local configuration.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1021/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1024,https://api.github.com/repos/apache/kvrocks/issues/1024,kvrocks,1418221596,1024,Skip build and test steps for no code changes,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-21T11:52:39Z,2023-05-06T09:49:16Z,"@PragmaTwice we can have a path filter for skipping CI on docs change.

But since we required the status, it can be a bit tricky and we should make use of https://github.com/dorny/paths-filter to skip steps.

It's not a requirement of this patch, of course.

_Originally posted by @tisonkun in https://github.com/apache/incubator-kvrocks/issues/1023#issuecomment-1286772481_
      ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1024/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1029,https://api.github.com/repos/apache/kvrocks/issues/1029,kvrocks,1419696855,1029,Tracking issue: Fix clang-tidy reports in kvrocks,PragmaTwice,20042607,Twice,,CLOSED,2022-10-23T08:05:50Z,2022-12-12T02:35:07Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

```
    clang-analyzer-core.CallAndMessage
    clang-analyzer-core.CallAndMessageModeling
    clang-analyzer-core.DivideZero
    clang-analyzer-core.DynamicTypePropagation
    clang-analyzer-core.NonNullParamChecker
    clang-analyzer-core.NonnilStringConstants
    clang-analyzer-core.NullDereference
    clang-analyzer-core.StackAddrEscapeBase
    clang-analyzer-core.StackAddressEscape
    clang-analyzer-core.UndefinedBinaryOperatorResult
    clang-analyzer-core.VLASize
    clang-analyzer-core.builtin.BuiltinFunctions
    clang-analyzer-core.builtin.NoReturnFunctions
    clang-analyzer-core.uninitialized.ArraySubscript
    clang-analyzer-core.uninitialized.Assign
    clang-analyzer-core.uninitialized.Branch
    clang-analyzer-core.uninitialized.CapturedBlockVariable
    clang-analyzer-core.uninitialized.UndefReturn
    clang-analyzer-cplusplus.InnerPointer
    clang-analyzer-cplusplus.Move
    clang-analyzer-cplusplus.NewDelete
    clang-analyzer-cplusplus.NewDeleteLeaks
    clang-analyzer-cplusplus.PlacementNew
    clang-analyzer-cplusplus.PureVirtualCall
    clang-analyzer-cplusplus.SelfAssignment
    clang-analyzer-cplusplus.SmartPtrModeling
    clang-analyzer-cplusplus.VirtualCallModeling
    clang-analyzer-deadcode.DeadStores
    clang-analyzer-nullability.NullPassedToNonnull
    clang-analyzer-nullability.NullReturnedFromNonnull
    clang-analyzer-nullability.NullabilityBase
    clang-analyzer-nullability.NullableDereferenced
    clang-analyzer-nullability.NullablePassedToNonnull
    clang-analyzer-nullability.NullableReturnedFromNonnull
    clang-analyzer-security.FloatLoopCounter
    clang-analyzer-security.insecureAPI.DeprecatedOrUnsafeBufferHandling
    clang-analyzer-security.insecureAPI.SecuritySyntaxChecker
    clang-analyzer-security.insecureAPI.UncheckedReturn
    clang-analyzer-security.insecureAPI.bcmp
    clang-analyzer-security.insecureAPI.bcopy
    clang-analyzer-security.insecureAPI.bzero
    clang-analyzer-security.insecureAPI.decodeValueOfObjCType
    clang-analyzer-security.insecureAPI.getpw
    clang-analyzer-security.insecureAPI.gets
    clang-analyzer-security.insecureAPI.mkstemp
    clang-analyzer-security.insecureAPI.mktemp
    clang-analyzer-security.insecureAPI.rand
    clang-analyzer-security.insecureAPI.strcpy
    clang-analyzer-security.insecureAPI.vfork
    clang-analyzer-unix.API
    clang-analyzer-unix.DynamicMemoryModeling
    clang-analyzer-unix.Malloc
    clang-analyzer-unix.MallocSizeof
    clang-analyzer-unix.MismatchedDeallocator
    clang-analyzer-unix.Vfork
    clang-analyzer-unix.cstring.BadSizeArg
    clang-analyzer-unix.cstring.CStringModeling
    clang-analyzer-unix.cstring.NullArg
    clang-analyzer-valist.CopyToSelf
    clang-analyzer-valist.Uninitialized
    clang-analyzer-valist.Unterminated
    clang-analyzer-valist.ValistBase
    cppcoreguidelines-init-variables 197
    cppcoreguidelines-interfaces-global-init 0
    cppcoreguidelines-macro-usage 21
    cppcoreguidelines-narrowing-conversions 122
    cppcoreguidelines-no-malloc 0
    cppcoreguidelines-prefer-member-initializer 0
    cppcoreguidelines-slicing 0
    cppcoreguidelines-special-member-functions 3
    google-build-explicit-make-pair 0
    google-default-arguments 0
    google-explicit-constructor 0
    modernize-avoid-bind 3
    modernize-loop-convert 7
    modernize-make-shared 0
    modernize-make-unique 2
    modernize-pass-by-value 0
    modernize-redundant-void-arg 5
    modernize-return-braced-init-list 0
    modernize-use-auto 9
    modernize-use-bool-literals 1
    modernize-use-emplace 0
    modernize-use-equals-default 0
    modernize-use-equals-delete 0
    modernize-use-nullptr 5
    modernize-use-override 0
    modernize-use-using 1
    performance-faster-string-find 3
    performance-for-range-copy 2
    performance-implicit-conversion-in-loop 0
    performance-inefficient-algorithm 0
    performance-inefficient-vector-operation 6
    performance-move-const-arg 0
    performance-move-constructor-init 0
    performance-no-automatic-move 0
    performance-trivially-destructible 0
    performance-type-promotion-in-math-fn 0
    performance-unnecessary-copy-initialization 0
    performance-unnecessary-value-param 16
```

Currently we have enabled lots of clang-tidy checks, but there are so many reports in current kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings.

We can solve these report and enable warning-as-error: https://github.com/apache/incubator-kvrocks/actions/runs/3399280291/jobs/5652921393#step:8:899

For example:
```
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/cluster/redis_slot.cc:72:29: warning: 'find' called with a string literal consisting of a single character; consider using the more effective overload accepting a character [performance-faster-string-find]
  auto right_pos = key.find(""}"", left_pos + 1);
                            ^~~
                            '}'
```
For this report (categorized as `performance-faster-string-find`), we can replace ""}"" with '}', and submit a patch. If all `performance-faster-string-find` tagged report are solved within this patch, we can add `performance-faster-string-find` to `WarningsAsErrors` in `.clang-tidy`. Then, if `performance-faster-string-find` tagged report appears in a future PR, the CI will fail.


### Solution

Tasks:
- [x] #1090
- [x] #1091
- [x] #1092
- [x] #1093
- [x] #1094 
- [x] #1095 
- [x] #1096 
- [x] #1097 
- [x] #1098 
- [x] #1099 
- [x] #1100 
- [x] #1101 
- [x] #1102 
- [x] #1103 
- [x] #1104 
- [x] #1105 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1029/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/1033,kvrocks,1420211450,1033,Proposal: New encoding with compatibility to old data,PragmaTwice,20042607,Twice,,CLOSED,2022-10-24T04:45:09Z,2023-03-23T09:23:58Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

[The current encoding](https://kvrocks.apache.org/docs/Design/design-structure-on-rocksdb) of kvrocks has several notable problems:
1. The length of `size` field is 32 bits, which makes it impossible to store large collection exceeding `4Gi` (items);
2. The length of `expire` field is 32 bits, which means that kvrocks has the Y2038 problem, i.e. kvrocks will lose availability in 2038.

### Solution

Since currently the higher 4 bits of `flags` field are still unused, we will use one of them to distinguish between the old encoding and the new one, i.e. 
```
 0 0 0 0 <4-bit redis-type> -> old encoding
 1 0 0 0 <4-bit redis-type> -> new encoding
```

The new protocol uses fixed 64bit and varint encoding to represent `expire` and `size` field, and all other fields remain the same as before. In this way, the new protocol can be extended to 64bit (or even higher) to solve the above two problems without significantly increasing the space ~~(actually shrinking, because for small number, 4 bytes are not needed to storage).~~

In fact, I discussed this solution with @torwig in slack before, but only considered the `size` field and used fixed-length 64bit encoding. But now I think varint encoding might be a better fit. ~I do not know if the `version` field is suitable for varint encoding, so some advice might be needed.~

For example, the new hash metadata:
```
        +------------------+------------+-----------+-----------+
key =>  |  flags           |  expire    |  version  |  size     |
        |(1000 + 4bit type)| (64bit ms) |  (64bit)  | (64bit)   |
        +------------------+------------+-----------+-----------+
```

The old hash metadata just for compare:
```
        +------------------+------------+-----------+-----------+
key =>  |  flags           |  expire    |  version  |  size     |
        |(0000 + 4bit type)| (32bit sec)|  (64bit)  | (32bit)   |
        +------------------+------------+-----------+-----------+
```

Note that we store millisecond timestamp in the new `expire` field.

In implementation, we can read data with both old and new encoding, and **always write data by the new encoding**.

cc @git-hulk @torwig @ShooterIT @caipengbo 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1033/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5My_uN,kvrocks,1288436621,1033,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-24T05:23:24Z,2022-10-24T05:23:24Z,"Cool, thanks for @PragmaTwice great proposal 

For the `version` is always 64 bits now, so it's ok to use fixed bits.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5My_uN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzCIr,kvrocks,1288446507,1033,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T05:40:10Z,2022-10-24T05:40:10Z,"I dislike the idea that using varint to store `expire`. The `varint` is sutable for ""value tends to be small"", maybe suitable for size, but using it as timestamp may be both harms cpu and storage.

32bits' size is ok in most cases.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzCIr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzDCf,kvrocks,1288450207,1033,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T05:46:29Z,2022-10-24T05:46:29Z,"Personally, I think it's even ok to extend `flags`:

```
if flags's MSB is 1, extent flag to 2bytes or more
flag represent expire and size's size
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzDCf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzDFO,kvrocks,1288450382,1033,NA,PragmaTwice,20042607,Twice,,NA,2022-10-24T05:46:48Z,2022-10-24T05:46:48Z,"> I dislike the idea that using varint to store `expire`. The `varint` is sutable for ""value tends to be small"", maybe suitable for size, but using it as timestamp may be both harms cpu and storage.
> 
> 32bits' size is ok in most cases.

For a recently timestamp (~2022 AD), the value is about 2^31. If using varint encoding, the data will be about 5 bytes, which is less than 8 bytes.

Although I am open for this, it can be fixed 8 bytes. But I think the size field need to be varint encoded in the new encoding.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzDFO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzFIr,kvrocks,1288458795,1033,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-10-24T06:01:25Z,2022-10-24T06:01:25Z,"> Although I am open for this, it can be fixed 8 bytes. But I think the size field need to be varint encoded in the new encoding.

By the way, in most of cases, `meta` would not be the bottleneck of store and cpu. When it comes to `String`, changing it to varint would occupy more spaces and spend more time paring the value.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzFIr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzOyE,kvrocks,1288498308,1033,NA,PragmaTwice,20042607,Twice,,NA,2022-10-24T06:46:52Z,2022-10-24T06:46:52Z,"> > Although I am open for this, it can be fixed 8 bytes. But I think the size field need to be varint encoded in the new encoding.
> 
> By the way, in most of cases, `meta` would not be the bottleneck of store and cpu. When it comes to `String`, changing it to varint would occupy more spaces and spend more time paring the value.

I got your point. I will change `expire` field from varint to fixed 8bit.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzOyE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzPiq,kvrocks,1288501418,1033,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-24T06:50:29Z,2022-10-24T06:50:29Z,This can be related to #983 that we're storing TTL in seconds now so that it cannot reflect more fine-grained precision. ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzPiq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzUmM,kvrocks,1288522124,1033,NA,PragmaTwice,20042607,Twice,,NA,2022-10-24T07:11:32Z,2022-10-24T07:11:32Z,The encoding description is now updated.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzUmM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzaOh,kvrocks,1288545185,1033,NA,torwig,8588372,Yaroslav,,NA,2022-10-24T07:31:59Z,2022-10-24T07:31:59Z,I like the updated encoding description (especially because I was asking about the size field but didn't have time to implement it).,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzaOh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1033,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1uAI,kvrocks,1289150472,1033,NA,PragmaTwice,20042607,Twice,,NA,2022-10-24T14:45:26Z,2022-10-24T14:45:26Z,"> This can be related to #983 that we're storing TTL in seconds now so that it cannot reflect more fine-grained precision.

Good point. We can use millisecond timestamp in the new `expire` field.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M1uAI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1034,https://api.github.com/repos/apache/kvrocks/issues/1034,kvrocks,1420314784,1034,Add support for CLI arguments/environment variables to overwrite conf file values,kesavkolla,274645,Kesav Kolla,,CLOSED,2022-10-24T06:54:18Z,2022-10-24T15:29:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

It will be good idea to support some configuration overwrites via CLI arguments or Environment variables. Specially it will be so much useful in containerized environment. We can pack the default conf file in the docker image and overwrite respective values by setting environment variables or CLI args.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1034/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1034,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzRa4,kvrocks,1288509112,1034,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-24T06:59:21Z,2022-10-24T06:59:21Z,"Yes, it makes a lot sense to support overriding configurations through passing environments.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzRa4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1034,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzWVQ,kvrocks,1288529232,1034,NA,PragmaTwice,20042607,Twice,,NA,2022-10-24T07:17:59Z,2022-10-24T07:17:59Z,I will try to implement it when I am free.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5MzWVQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1040,https://api.github.com/repos/apache/kvrocks/issues/1040,kvrocks,1421913564,1040,rename commands don't work,iushas,7236171,tanic.xiao,,CLOSED,2022-10-25T06:09:42Z,2022-10-28T08:40:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.1.0

### Minimal reproduce step

1、add rename-command in kvrocks.conf
rename-command flushall                             dont_run_flushall_rudely
rename-command flushdb                             dont_run_flushdb_rudely
rename-command bgsave                              dont_run_bgsave_rudely
rename-command config                               dont_run_config_rudely
2、start kvrocks

3、exec dont_run_bgsave_rudely
127.0.0.1:6379> dont_run_bgsave_rudely
(error) ERR unknown command dont_run_bgsave_rudely

exec dont_run_config_rudely   can success

127.0.0.1:6379> config get rename-command
1) ""rename-command""
2) ""config                              dont_run_config_rudely""


as it shows in config info，only dont_run_config_rudely effects。

4、exec config rewrite
127.0.0.1:6379> dont_run_config_rudely rewrite
OK
127.0.0.1:6379> dont_run_config_rudely get rename-command
1) ""rename-command""
2) ""config                              dont_run_config_rudely""

but rename-commands in kvrocks.conf still are old contents.
root@redis-kvsenior01-290192:/home/redis/etc# grep rename /home/redis/data/conf/kvrocks.conf
# rename
# rename
rename-command flushall                             dont_run_flushall_rudely
rename-command flushdb                             dont_run_flushdb_rudely
rename-command bgsave                              dont_run_bgsave_rudely
...
rename-command config                              dont_run_config_rudely


### What did you expect to see?

all rename commands can work

### What did you see instead?

no

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1040/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1040,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M6E1B,kvrocks,1290292545,1040,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-25T09:57:03Z,2022-10-25T09:57:03Z,@iushas Thanks for your feedback!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5M6E1B/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1042,https://api.github.com/repos/apache/kvrocks/issues/1042,kvrocks,1422269849,1042,Incorrect regex to get cmake version,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,CLOSED,2022-10-25T10:54:43Z,2022-10-25T12:37:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

https://github.com/apache/incubator-kvrocks/commit/a1bb45d72b3db7784f1f214fdcaba6705417b29e

### Minimal reproduce step

The latest version of cmake is [cmake-3.25.0-rc2](https://github.com/Kitware/CMake/releases/download/v3.25.0-rc2/cmake-3.25.0-rc2.tar.gz). The existing regular expression will parse it incorrectly as `3.25.02`.

### What did you expect to see?

Parse it as `3.25.0`.

### What did you see instead?

Parse it as `3.25.02`.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1042/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1049,https://api.github.com/repos/apache/kvrocks/issues/1049,kvrocks,1427437452,1049,Export the block cache hit/miss statistics ,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-10-28T15:37:02Z,2023-01-13T08:06:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Block cache hit/miss is the key metric for the read performance, so it can help a lot when profiling if we can export the block cache hit/miss statistics to users.

### Solution

Read the block cache statistics from RocksDB, then export through the info command.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1049/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1049,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NPbPt,kvrocks,1295889389,1049,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2022-10-29T16:20:23Z,2022-10-29T16:20:23Z,please assign to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NPbPt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1049,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NPbVV,kvrocks,1295889749,1049,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-10-29T16:21:34Z,2022-10-29T16:21:34Z,"Thanks, assigned.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NPbVV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1052,https://api.github.com/repos/apache/kvrocks/issues/1052,kvrocks,1428125329,1052,Upload go case log if integration tests failed,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-10-29T06:54:01Z,2022-11-03T09:29:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Otherwise, it's hard to debug and get the root cause of failure in CI environment.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1052/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1052,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NO6IV,kvrocks,1295753749,1052,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-10-29T06:55:41Z,2022-10-29T06:55:41Z,The go case log locates at `$WORKSPACE/tests/gocase/workspace`.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NO6IV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1052,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NmHSj,kvrocks,1301836963,1052,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-11-03T09:29:42Z,2022-11-03T09:29:42Z,See also https://github.com/apache/incubator-kvrocks/pull/1065/files#r1012663263,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5NmHSj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1059,https://api.github.com/repos/apache/kvrocks/issues/1059,kvrocks,1431405071,1059,"When log-dir and backup-dir appear at the same time, log-dir does not take effect",manchurio,82277001,,,CLOSED,2022-11-01T13:10:06Z,2022-11-04T08:15:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable branch.
This bug was introduced on October 24.
https://github.com/apache/incubator-kvrocks/blob/684bcc6ce7060ab507627b8299b8326e9ffbf133/src/config/config.cc#L357-L359

### Minimal reproduce step

There are two ways to reproduce

1. Using the command flags
./kvrocks --log-dir /data/log --backup-dir /data/backup

2. Use configuration files(kvrocks.conf)
backup-dir /data/kvrocks/backup
log-dir /data/log


### What did you expect to see?

Log appears in /data/log

### What did you see instead?

Log appears in /tmp

### Anything Else?

If backup-dir appears, It will trigger the execution of this line of code.
https://github.com/apache/incubator-kvrocks/blob/684bcc6ce7060ab507627b8299b8326e9ffbf133/src/config/config.cc#L357-L359

Just remove this line and the bug will be fixed.
Or we reinitialize glog,because macro LOG will  initialize a singleton object before setting the log location.

https://github.com/google/glog/blob/05fbc65278db1aa545ca5cb743c31bc717a48d0f/src/logging.cc#L930-L940


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1059/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1059,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Nq8RP,kvrocks,1303102543,1059,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2022-11-04T08:15:59Z,2022-11-04T08:15:59Z,"@manchurio I have tried to fix this via #1061 , would you like to have a try?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Nq8RP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1072,https://api.github.com/repos/apache/kvrocks/issues/1072,kvrocks,1435508798,1072,Flaky Test TestRedisCli,PragmaTwice,20042607,Twice,,CLOSED,2022-11-04T03:51:22Z,2022-11-20T12:52:47Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/incubator-kvrocks/actions/runs/3390804518/jobs/5635396698

### What did you expect to see?

PASS

### What did you see instead?

```
--- FAIL: TestRedisCli (14.64s)
    --- FAIL: TestRedisCli/test_interactive_cli (0.02s)
        --- FAIL: TestRedisCli/test_interactive_cli/INFO_response_should_be_printed_raw (0.01s)
            cli_test.go:[155](https://github.com/apache/incubator-kvrocks/actions/runs/3390804518/jobs/5635396698#step:12:156): 
                	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:155
                	Error:      	Expect ""is_compac"" to match ""^$|^#|^[^#:]+:""
                	Test:       	TestRedisCli/test_interactive_cli/INFO_response_should_be_printed_raw
        --- FAIL: TestRedisCli/test_interactive_cli/Status_reply (0.00s)
            cli_test.go:97: 
                	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:97
                	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:[160](https://github.com/apache/incubator-kvrocks/actions/runs/3390804518/jobs/5635396698#step:12:161)
                	Error:      	Not equal: 
                	            	expected: ""OK""
                	            	actual  : ""ting:no""
                	            	
                	            	Diff:
                	            	--- Expected
                	            	+++ Actual
                	            	@@ -1 +1 @@
                	            	-OK
                	            	+ting:no
                	Test:       	TestRedisCli/test_interactive_cli/Status_reply
        --- FAIL: TestRedisCli/test_interactive_cli/Integer_reply (0.00s)
            cli_test.go:97: 
                	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:97
                	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:[164](https://github.com/apache/incubator-kvrocks/actions/runs/3390804518/jobs/5635396698#step:12:165)
                	Error:      	Not equal: 
                	            	expected: ""(integer) 1""
                	            	actual  : ""OK""
                	            	
                	            	Diff:
                	            	--- Expected
                	            	+++ Actual
                	            	@@ -1 +1 @@
                	            	-(integer) 1
                	            	+OK
                	Test:       	TestRedisCli/test_interactive_cli/Integer_reply
        --- FAIL: TestRedisCli/test_interactive_cli/Bulk_reply (0.00s)
            cli_test.go:97: 
                	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:97
                	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:[169](https://github.com/apache/incubator-kvrocks/actions/runs/3390804518/jobs/5635396698#step:12:170)
                	Error:      	Not equal: 
                	            	expected: ""\""foo\""""
                	            	actual  : ""(integer) 1""
                	            	
                	            	Diff:
                	            	--- Expected
                	            	+++ Actual
                	            	@@ -1 +1 @@
                	            	-""foo""
                	            	+(integer) 1
                	Test:       	TestRedisCli/test_interactive_cli/Bulk_reply
        --- FAIL: TestRedisCli/test_interactive_cli/Multi-bulk_reply (0.00s)
            cli_test.go:97: 
                	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:97
                	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:[175](https://github.com/apache/incubator-kvrocks/actions/runs/3390804518/jobs/5635396698#step:12:176)
                	Error:      	Not equal: 
                	            	expected: ""1) \""foo\""\n2) \""bar\""""
                	            	actual  : ""\""foo\""""
                	            	
                	            	Diff:
                	            	--- Expected
                	            	+++ Actual
                	            	@@ -1,2 +1 @@
                	            	-1) ""foo""
                	            	-2) ""bar""
                	            	+""foo""
                	Test:       	TestRedisCli/test_interactive_cli/Multi-bulk_reply
        --- FAIL: TestRedisCli/test_interactive_cli/Parsing_quotes (0.00s)
            cli_test.go:97: 
                	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:97
                	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/cli/cli_test.go:[182](https://github.com/apache/incubator-kvrocks/actions/runs/3390804518/jobs/5635396698#step:12:183)
                	Error:      	Not equal: 
                	            	expected: ""OK""
                	            	actual  : ""1) \""foo\""\n2) \""bar\""""
                	            	
                	            	Diff:
                	            	--- Expected
                	            	+++ Actual
                	            	@@ -1 +1,2 @@
                	            	-OK
                	            	+1) ""foo""
                	            	+2) ""bar""
                	Test:       	TestRedisCli/test_interactive_cli/Parsing_quotes
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1072/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1072,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OZg7C,kvrocks,1315311298,1072,NA,PragmaTwice,20042607,Twice,,NA,2022-11-15T13:27:42Z,2022-11-15T13:27:42Z,"This failure has been appearing not infrequently lately, and I thought we could do some investigation into it. cc @git-hulk @tisonkun ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OZg7C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1072,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OZh_L,kvrocks,1315315659,1072,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-15T13:31:42Z,2022-11-15T13:31:42Z,@PragmaTwice assigned to me and will follow up.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OZh_L/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1082,https://api.github.com/repos/apache/kvrocks/issues/1082,kvrocks,1444013990,1082,Doubt about the HRANGE command,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2022-11-10T14:32:49Z,2023-01-17T03:42:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, we implement HRANGE command, but i think the name is not suitable.

For zset, we have `ZRANGEBYLEX` which could get members with lexicographical ordering,
of course, `ZRANGE` has `BYLEX` option.
HRANGE also get fields with lexicographical ordering, so i think its name should be
`HRANGEBYLEX` aligned with `ZRANGEBYLEX`. If we use `HRANGE`, users may think it is
similar with `ZRANGE` which `start` and `stop` are the position in it.

What's more, i think the `min` and `max` arguments of `HRANGE` should start with
( or [, in order to specify if the range item is respectively exclusive or inclusive, also align
with `ZRANGEBYLEX`


### Solution

I suggest to change its name to `HRANGEBYLEX` and the `min` and `max` arguments of it
should start with `(` or `[` 

of course, we can implement `HRANGE` command with different options, but now, i think it
is not urgent since there is no demand of HRANGE(the same semantic of ZRANGE).

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1082/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1082,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OG1mR,kvrocks,1310415249,1082,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-10T14:55:08Z,2022-11-10T14:55:08Z,"This is an excellent proposition, from my side, I think the HRANGE command is similar to ZRANGE over ZRANGEBYLEX, so I regarded those parameters as `start` and `stop` when reviewing the PR. But I'm wondering if it's right to align them because ZSET is a sorted array and it makes sense to use the index as the start/stop but it's a bit confusing for HASH.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OG1mR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1082,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OG_7V,kvrocks,1310457557,1082,NA,PragmaTwice,20042607,Twice,,NA,2022-11-10T15:24:55Z,2022-11-10T15:24:55Z,"Good point, currently `ZRANGE` and `HRANGE` have different semantics (indexes v.s. elements) and argument types (integers v.s. strings), so I also think `ZRANGEBYLEX` is more concrete.

BTW cc @tanruixiang ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OG_7V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1082,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OHMmv,kvrocks,1310509487,1082,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-11-10T15:55:43Z,2022-11-10T15:55:43Z,I also misunderstood `start` and `stop` when I first started implementing `HRANGE`.I'll add `hrange` and `hrangebylex` this weekend.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OHMmv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1082,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RyBRR,kvrocks,1372066897,1082,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-05T10:56:55Z,2023-01-05T10:56:55Z,@tanruixiang Any update?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RyBRR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1082,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ryc4U,kvrocks,1372179988,1082,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2023-01-05T12:55:09Z,2023-01-05T12:55:09Z,"> @tanruixiang Any update?

I'm sorry for the long absence of updates due to illness. I will continue this work this weekend.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ryc4U/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1082,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RygqJ,kvrocks,1372195465,1082,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-05T13:08:10Z,2023-01-05T13:08:10Z,"@tanruixiang Thanks for your feedback. No hurry, I'm just wondering if I missed anything.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RygqJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1083,https://api.github.com/repos/apache/kvrocks/issues/1083,kvrocks,1444056144,1083,[NEW] Add `SINTERCARD` command aligned Redis,boatrainlsz,18243785,boatrainlsz,yinger521999@gmail.com,CLOSED,2022-11-10T14:57:00Z,2023-06-13T04:48:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

add support for [SINTERCARD](https://redis.io/commands/sintercard/) command in Redis, which is available since Redis 7.0.0

### Solution

Since `SINTER` and `SCARD` were implemented already, I think it's quite straightforward to combine those two commands' logic.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1083/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1083,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OG7gF,kvrocks,1310439429,1083,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-10T15:12:41Z,2022-11-10T15:12:41Z,"@boatrainlsz Thanks, assigned.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OG7gF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1087,https://api.github.com/repos/apache/kvrocks/issues/1087,kvrocks,1446188336,1087,Add support for migrating STREAM in cluster mode,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-11-12T02:23:59Z,2022-12-21T07:04:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

The STREAM type(partial commands) is supported in #745, but didn't add support for migrating in the cluster mode.

For more detail can see: https://github.com/apache/incubator-kvrocks/blob/unstable/src/cluster/slot_migrate.cc#L617

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1087/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1087,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OOWgu,kvrocks,1312385070,1087,NA,torwig,8588372,Yaroslav,,NA,2022-11-12T06:27:53Z,2022-11-12T06:27:53Z,@git-hulk I'll try to implement this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OOWgu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1087,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OOXe3,kvrocks,1312389047,1087,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-12T06:50:32Z,2022-11-12T06:50:32Z,"> @git-hulk I'll try to implement this.

cool, thanks @torwig ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OOXe3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1090,https://api.github.com/repos/apache/kvrocks/issues/1090,kvrocks,1446488135,1090,Fix `cppcoreguidelines-init-variables` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:11:37Z,2022-12-03T15:03:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `cppcoreguidelines-init-variables` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `cppcoreguidelines-init-variables` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:81:12: warning: variable 'a' is not initialized [cppcoreguidelines-init-variables]
  uint32_t a, b, c, d, e;
           ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:81:15: warning: variable 'b' is not initialized [cppcoreguidelines-init-variables]
  uint32_t a, b, c, d, e;
              ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:81:18: warning: variable 'c' is not initialized [cppcoreguidelines-init-variables]
  uint32_t a, b, c, d, e;
                 ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:81:21: warning: variable 'd' is not initialized [cppcoreguidelines-init-variables]
  uint32_t a, b, c, d, e;
                    ^
                      = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:81:24: warning: variable 'e' is not initialized [cppcoreguidelines-init-variables]
  uint32_t a, b, c, d, e;
                       ^
                         = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:212:12: warning: variable 'i' is not initialized [cppcoreguidelines-init-variables]
  uint32_t i, j;
           ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:212:15: warning: variable 'j' is not initialized [cppcoreguidelines-init-variables]
  uint32_t i, j;
              ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:233:12: warning: variable 'i' is not initialized [cppcoreguidelines-init-variables]
  unsigned i;
           ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:235:17: warning: variable 'c' is not initialized [cppcoreguidelines-init-variables]
  unsigned char c;
                ^
                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:70:7: warning: variable 'rv' is not initialized [cppcoreguidelines-init-variables]
  int rv;
      ^
         = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:72:20: warning: variable 'servinfo' is not initialized [cppcoreguidelines-init-variables]
  addrinfo hints, *servinfo, *p;
                   ^
                            = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:72:31: warning: variable 'p' is not initialized [cppcoreguidelines-init-variables]
  addrinfo hints, *servinfo, *p;
                              ^
                                = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:192:9: warning: variable 'socket_arg' is not initialized [cppcoreguidelines-init-variables]
    int socket_arg;
        ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:268:7: warning: variable 'flags' is not initialized [cppcoreguidelines-init-variables]
  int flags;
      ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:448:13: warning: variable 'not_symbol' is not initialized [cppcoreguidelines-init-variables]
        int not_symbol, match;
            ^
                       = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:448:25: warning: variable 'match' is not initialized [cppcoreguidelines-init-variables]
        int not_symbol, match;
                        ^
                              = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:544:10: warning: variable 'd' is not initialized [cppcoreguidelines-init-variables]
  double d;
         ^
           = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:578:67: warning: variable 'p' is not initialized [cppcoreguidelines-init-variables]
  const char *start = value.data(), *end = start + value.size(), *p;
                                                                  ^
                                                                    = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:648:20: warning: variable 'retval' is not initialized [cppcoreguidelines-init-variables]
  int retmask = 0, retval;
                   ^
                          = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/config/config.cc:263:18: warning: variable 'start' is not initialized [cppcoreguidelines-init-variables]
         int64_t start, stop;
                 ^
                       = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/config/config.cc:263:25: warning: variable 'stop' is not initialized [cppcoreguidelines-init-variables]
         int64_t start, stop;
                        ^
                             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/config/config.cc:518:14: warning: variable 'val' is not initialized [cppcoreguidelines-init-variables]
         int val;
             ^
                 = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/config/config_util.cc:37:8: warning: variable 'quote' is not initialized [cppcoreguidelines-init-variables]
  char quote;  // single or double quote
       ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/redis_connection.cc:37:10: warning: variable 'now' is not initialized [cppcoreguidelines-init-variables]
  time_t now;
         ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/redis_connection.cc:137:10: warning: variable 'now' is not initialized [cppcoreguidelines-init-variables]
  time_t now;
         ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/redis_connection.cc:145:10: warning: variable 'now' is not initialized [cppcoreguidelines-init-variables]
  time_t now;
         ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:702:12: warning: variable 'memtable_sizes' is not initialized [cppcoreguidelines-init-variables]
  uint64_t memtable_sizes, cur_memtable_sizes, num_snapshots, num_running_flushes;
           ^
                          = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:702:28: warning: variable 'cur_memtable_sizes' is not initialized [cppcoreguidelines-init-variables]
  uint64_t memtable_sizes, cur_memtable_sizes, num_snapshots, num_running_flushes;
                           ^
                                              = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:702:48: warning: variable 'num_snapshots' is not initialized [cppcoreguidelines-init-variables]
  uint64_t memtable_sizes, cur_memtable_sizes, num_snapshots, num_running_flushes;
                                               ^
                                                             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:702:63: warning: variable 'num_running_flushes' is not initialized [cppcoreguidelines-init-variables]
  uint64_t memtable_sizes, cur_memtable_sizes, num_snapshots, num_running_flushes;
                                                              ^
                                                                                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:703:12: warning: variable 'num_immutable_tables' is not initialized [cppcoreguidelines-init-variables]
  uint64_t num_immutable_tables, memtable_flush_pending, compaction_pending;
           ^
                                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:703:34: warning: variable 'memtable_flush_pending' is not initialized [cppcoreguidelines-init-variables]
  uint64_t num_immutable_tables, memtable_flush_pending, compaction_pending;
                                 ^
                                                        = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:703:58: warning: variable 'compaction_pending' is not initialized [cppcoreguidelines-init-variables]
  uint64_t num_immutable_tables, memtable_flush_pending, compaction_pending;
                                                         ^
                                                                            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:704:12: warning: variable 'num_running_compaction' is not initialized [cppcoreguidelines-init-variables]
  uint64_t num_running_compaction, num_live_versions, num_superversion, num_backgroud_errors;
           ^
                                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:704:36: warning: variable 'num_live_versions' is not initialized [cppcoreguidelines-init-variables]
  uint64_t num_running_compaction, num_live_versions, num_superversion, num_backgroud_errors;
                                   ^
                                                     = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:704:55: warning: variable 'num_superversion' is not initialized [cppcoreguidelines-init-variables]
  uint64_t num_running_compaction, num_live_versions, num_superversion, num_backgroud_errors;
                                                      ^
                                                                       = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:704:73: warning: variable 'num_backgroud_errors' is not initialized [cppcoreguidelines-init-variables]
  uint64_t num_running_compaction, num_live_versions, num_superversion, num_backgroud_errors;
                                                                        ^
                                                                                             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:720:14: warning: variable 'estimate_keys' is not initialized [cppcoreguidelines-init-variables]
    uint64_t estimate_keys, block_cache_usage, block_cache_pinned_usage, index_and_filter_cache_usage;
             ^
                           = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:720:29: warning: variable 'block_cache_usage' is not initialized [cppcoreguidelines-init-variables]
    uint64_t estimate_keys, block_cache_usage, block_cache_pinned_usage, index_and_filter_cache_usage;
                            ^
                                              = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:720:48: warning: variable 'block_cache_pinned_usage' is not initialized [cppcoreguidelines-init-variables]
    uint64_t estimate_keys, block_cache_usage, block_cache_pinned_usage, index_and_filter_cache_usage;
                                               ^
                                                                        = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:720:74: warning: variable 'index_and_filter_cache_usage' is not initialized [cppcoreguidelines-init-variables]
    uint64_t estimate_keys, block_cache_usage, block_cache_pinned_usage, index_and_filter_cache_usage;
                                                                         ^
                                                                                                      = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:772:10: warning: variable 'now' is not initialized [cppcoreguidelines-init-variables]
  time_t now;
         ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:826:10: warning: variable 'now' is not initialized [cppcoreguidelines-init-variables]
  time_t now;
         ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/worker.cc:121:16: warning: variable 'bev' is not initialized [cppcoreguidelines-init-variables]
  bufferevent *bev;
               ^
                   = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/worker.cc:165:12: warning: variable 'port' is not initialized [cppcoreguidelines-init-variables]
  uint32_t port;
           ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/worker.cc:200:7: warning: variable 'af' is not initialized [cppcoreguidelines-init-variables]
  int af, rv, fd, sock_opt = 1;
      ^
         = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/worker.cc:200:11: warning: variable 'rv' is not initialized [cppcoreguidelines-init-variables]
  int af, rv, fd, sock_opt = 1;
          ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/worker.cc:200:15: warning: variable 'fd' is not initialized [cppcoreguidelines-init-variables]
  int af, rv, fd, sock_opt = 1;
              ^
                 = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/worker.cc:208:27: warning: variable 'srv_info' is not initialized [cppcoreguidelines-init-variables]
  struct addrinfo hints, *srv_info, *p;
                          ^
                                   = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/worker.cc:208:38: warning: variable 'p' is not initialized [cppcoreguidelines-init-variables]
  struct addrinfo hints, *srv_info, *p;
                                     ^
                                       = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:56:10: warning: variable 'n' is not initialized [cppcoreguidelines-init-variables]
  size_t n;
         ^
           = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:95:10: warning: variable 'n' is not initialized [cppcoreguidelines-init-variables]
  size_t n;
         ^
           = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/redis_db.cc:520:28: warning: variable 'snapshot' is not initialized [cppcoreguidelines-init-variables]
  const rocksdb::Snapshot *snapshot;
                           ^
                                    = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/redis_metadata.cc:45:12: warning: variable 'key_size' is not initialized [cppcoreguidelines-init-variables]
  uint32_t key_size;
           ^
                    = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/redis_metadata.cc:46:11: warning: variable 'namespace_size' is not initialized [cppcoreguidelines-init-variables]
  uint8_t namespace_size;
          ^
                         = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/redis_metadata.cc:64:11: warning: variable 'namespace_size' is not initialized [cppcoreguidelines-init-variables]
  uint8_t namespace_size;
          ^
                         = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/redis_metadata.cc:128:11: warning: variable 'namespace_size' is not initialized [cppcoreguidelines-init-variables]
  uint8_t namespace_size;
          ^
                         = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/redis_metadata.cc:134:14: warning: variable 'slot_id' is not initialized [cppcoreguidelines-init-variables]
    uint16_t slot_id;
             ^
                     = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:196:7: warning: variable 'j' is not initialized [cppcoreguidelines-init-variables]
  int j, level, argc = lua_gettop(lua);
      ^
        = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:196:10: warning: variable 'level' is not initialized [cppcoreguidelines-init-variables]
  int j, level, argc = lua_gettop(lua);
         ^
               = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:217:12: warning: variable 'len' is not initialized [cppcoreguidelines-init-variables]
    size_t len;
           ^
               = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:218:17: warning: variable 's' is not initialized [cppcoreguidelines-init-variables]
    const char *s;
                ^
                  = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:341:7: warning: variable 'j' is not initialized [cppcoreguidelines-init-variables]
  int j, argc = lua_gettop(lua);
      ^
        = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:359:19: warning: variable 'obj_s' is not initialized [cppcoreguidelines-init-variables]
      const char *obj_s;
                  ^
                        = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:360:14: warning: variable 'obj_len' is not initialized [cppcoreguidelines-init-variables]
      size_t obj_len;
             ^
                     = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:522:10: warning: variable 'len' is not initialized [cppcoreguidelines-init-variables]
  size_t len;
         ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:523:15: warning: variable 's' is not initialized [cppcoreguidelines-init-variables]
  const char *s;
              ^
                = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:550:7: warning: variable 'j' is not initialized [cppcoreguidelines-init-variables]
  int j;
      ^
        = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:625:11: warning: variable 'value' is not initialized [cppcoreguidelines-init-variables]
  int64_t value;
          ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:634:11: warning: variable 'bulklen' is not initialized [cppcoreguidelines-init-variables]
  int64_t bulklen;
          ^
                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:668:11: warning: variable 'mbulklen' is not initialized [cppcoreguidelines-init-variables]
  int64_t mbulklen;
          ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:702:10: warning: variable 'd' is not initialized [cppcoreguidelines-init-variables]
  double d;
         ^
           = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:734:10: warning: variable 'obj_len' is not initialized [cppcoreguidelines-init-variables]
  size_t obj_len;
         ^
                 = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:208:16: warning: variable 'tmp_db' is not initialized [cppcoreguidelines-init-variables]
  rocksdb::DB *tmp_db;
               ^
                      = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:588:12: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
  uint64_t size, total_size = 0;
           ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:606:8: warning: variable 'reach_db_size_limit' is not initialized [cppcoreguidelines-init-variables]
  bool reach_db_size_limit;
       ^
                           = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:946:12: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
  uint64_t size;
           ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/table_properties_collector.cc:33:7: warning: variable 'now' is not initialized [cppcoreguidelines-init-variables]
  int now;
      ^
          = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/table_properties_collector.cc:34:11: warning: variable 'type' is not initialized [cppcoreguidelines-init-variables]
  uint8_t type;
          ^
               = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/table_properties_collector.cc:35:12: warning: variable 'expired' is not initialized [cppcoreguidelines-init-variables]
  uint32_t expired, subkeys = 0;
           ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/table_properties_collector.cc:36:12: warning: variable 'version' is not initialized [cppcoreguidelines-init-variables]
  uint64_t version;
           ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:390:10: warning: variable 'min_lon' is not initialized [cppcoreguidelines-init-variables]
  double min_lon, max_lon, min_lat, max_lat;
         ^
                 = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:390:19: warning: variable 'max_lon' is not initialized [cppcoreguidelines-init-variables]
  double min_lon, max_lon, min_lat, max_lat;
                  ^
                          = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:390:28: warning: variable 'min_lat' is not initialized [cppcoreguidelines-init-variables]
  double min_lon, max_lon, min_lat, max_lat;
                           ^
                                   = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:390:37: warning: variable 'max_lat' is not initialized [cppcoreguidelines-init-variables]
  double min_lon, max_lon, min_lat, max_lat;
                                    ^
                                            = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:392:7: warning: variable 'steps' is not initialized [cppcoreguidelines-init-variables]
  int steps;
      ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:475:10: warning: variable 'lat1r' is not initialized [cppcoreguidelines-init-variables]
  double lat1r, lon1r, lat2r, lon2r, u, v;
         ^
               = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:475:17: warning: variable 'lon1r' is not initialized [cppcoreguidelines-init-variables]
  double lat1r, lon1r, lat2r, lon2r, u, v;
                ^
                      = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:475:24: warning: variable 'lat2r' is not initialized [cppcoreguidelines-init-variables]
  double lat1r, lon1r, lat2r, lon2r, u, v;
                       ^
                             = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:475:31: warning: variable 'lon2r' is not initialized [cppcoreguidelines-init-variables]
  double lat1r, lon1r, lat2r, lon2r, u, v;
                              ^
                                    = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:475:38: warning: variable 'u' is not initialized [cppcoreguidelines-init-variables]
  double lat1r, lon1r, lat2r, lon2r, u, v;
                                     ^
                                       = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:475:41: warning: variable 'v' is not initialized [cppcoreguidelines-init-variables]
  double lat1r, lon1r, lat2r, lon2r, u, v;
                                        ^
                                          = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:125:12: warning: variable 'frag_index' is not initialized [cppcoreguidelines-init-variables]
  uint32_t frag_index, valid_size;
           ^
                      = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:125:24: warning: variable 'valid_size' is not initialized [cppcoreguidelines-init-variables]
  uint32_t frag_index, valid_size;
                       ^
                                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:201:12: warning: variable 'expand_size' is not initialized [cppcoreguidelines-init-variables]
    size_t expand_size;
           ^
                       = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:391:14: warning: variable 'i' is not initialized [cppcoreguidelines-init-variables]
    uint64_t i, frag_numkeys = num_keys, stop_index = (max_size - 1) / kBitmapSegmentBytes;
             ^
               = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:395:19: warning: variable 'output' is not initialized [cppcoreguidelines-init-variables]
    unsigned char output, byte;
                  ^
                         = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:395:27: warning: variable 'byte' is not initialized [cppcoreguidelines-init-variables]
    unsigned char output, byte;
                          ^
                               = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:133:13: warning: variable 'p4' is not initialized [cppcoreguidelines-init-variables]
  uint32_t *p4;
            ^
               = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:144:14: warning: variable 'aux1' is not initialized [cppcoreguidelines-init-variables]
    uint32_t aux1, aux2, aux3, aux4, aux5, aux6, aux7;
             ^
                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:144:20: warning: variable 'aux2' is not initialized [cppcoreguidelines-init-variables]
    uint32_t aux1, aux2, aux3, aux4, aux5, aux6, aux7;
                   ^
                        = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:144:26: warning: variable 'aux3' is not initialized [cppcoreguidelines-init-variables]
    uint32_t aux1, aux2, aux3, aux4, aux5, aux6, aux7;
                         ^
                              = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:144:32: warning: variable 'aux4' is not initialized [cppcoreguidelines-init-variables]
    uint32_t aux1, aux2, aux3, aux4, aux5, aux6, aux7;
                               ^
                                    = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:144:38: warning: variable 'aux5' is not initialized [cppcoreguidelines-init-variables]
    uint32_t aux1, aux2, aux3, aux4, aux5, aux6, aux7;
                                     ^
                                          = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:144:44: warning: variable 'aux6' is not initialized [cppcoreguidelines-init-variables]
    uint32_t aux1, aux2, aux3, aux4, aux5, aux6, aux7;
                                           ^
                                                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:144:50: warning: variable 'aux7' is not initialized [cppcoreguidelines-init-variables]
    uint32_t aux1, aux2, aux3, aux4, aux5, aux6, aux7;
                                                 ^
                                                      = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:195:13: warning: variable 'l' is not initialized [cppcoreguidelines-init-variables]
  uint64_t *l;
            ^
              = nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:196:12: warning: variable 'skipval' is not initialized [cppcoreguidelines-init-variables]
  uint64_t skipval, word = 0, one;
           ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:196:31: warning: variable 'one' is not initialized [cppcoreguidelines-init-variables]
  uint64_t skipval, word = 0, one;
                              ^
                                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:198:12: warning: variable 'j' is not initialized [cppcoreguidelines-init-variables]
  uint64_t j;
           ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:199:7: warning: variable 'found' is not initialized [cppcoreguidelines-init-variables]
  int found;
      ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:122:11: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
      int ret;
          ^
              = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:193:9: warning: variable 'idx' is not initialized [cppcoreguidelines-init-variables]
    int idx;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:216:16: warning: variable 'i' is not initialized [cppcoreguidelines-init-variables]
  unsigned int i, count = 0, last_processed = 0;
               ^
                 = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:254:20: warning: variable 'min' is not initialized [cppcoreguidelines-init-variables]
  GeoHashFix52Bits min, max;
                   ^
                       = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:254:25: warning: variable 'max' is not initialized [cppcoreguidelines-init-variables]
  GeoHashFix52Bits min, max;
                        ^
                            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:309:7: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
  int size;
      ^
           = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:328:10: warning: variable 'distance' is not initialized [cppcoreguidelines-init-variables]
  double distance, xy[2];
         ^
                  = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:274:45: warning: variable 'new_elem_index' is not initialized [cppcoreguidelines-init-variables]
6346 warnings generated.
  uint64_t pivot_index = metadata.head - 1, new_elem_index;
Suppressed 6349 warnings (6346 in non-user code, 3 NOLINT).
                                            ^
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
                                                           = 0
6386 warnings generated.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:400:14: warning: variable 'index' is not initialized [cppcoreguidelines-init-variables]
Suppressed 2699 warnings (2699 in non-user code).
    uint64_t index;
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
             ^
345 warnings generated.
                   = 0
Suppressed 345 warnings (345 in non-user code).
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:439:13: warning: variable 'type' is not initialized [cppcoreguidelines-init-variables]
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
  RedisType type;
4811 warnings generated.
Suppressed 4813 warnings (4810 in non-user code, 3 NOLINT).
            ^
                 = 0
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:449:7: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
5701 warnings generated.
  int ret;
Suppressed 5686 warnings (5681 in non-user code, 5 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
      ^
          = 0
6848 warnings generated.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_set.cc:247:13: warning: variable 'type' is not initialized [cppcoreguidelines-init-variables]
  RedisType type;
            ^
                 = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_sortedint.cc:144:12: warning: variable 'id' is not initialized [cppcoreguidelines-init-variables]
  uint64_t id, pos = 0;
           ^
              = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_sortedint.cc:193:12: warning: variable 'id' is not initialized [cppcoreguidelines-init-variables]
  uint64_t id;
           ^
              = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_stream_base.cc:158:14: warning: variable 'len' is not initialized [cppcoreguidelines-init-variables]
    uint32_t len;
             ^
                 = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:250:7: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
  int size;
      ^
           = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:339:15: warning: variable 'idx' is not initialized [cppcoreguidelines-init-variables]
  std::size_t idx;
              ^
                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:399:7: warning: variable 'exists' is not initialized [cppcoreguidelines-init-variables]
  int exists;
      ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:156:7: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
  int ret;
      ^
          = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:386:12: warning: variable 'score' is not initialized [cppcoreguidelines-init-variables]
    double score;
           ^
                 = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:622:12: warning: variable 'score' is not initialized [cppcoreguidelines-init-variables]
    double score;
           ^
                 = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:664:7: warning: variable 'target_size' is not initialized [cppcoreguidelines-init-variables]
  int target_size;
      ^
                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:721:7: warning: variable 'target_size' is not initialized [cppcoreguidelines-init-variables]
  int target_size;
      ^
                  = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:508:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
Suppressed 5876 warnings (5873 in non-user code, 3 NOLINT).
    int ret;
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
        ^
5855 warnings generated.
            = 0
Suppressed 5852 warnings (5849 in non-user code, 3 NOLINT).
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:541:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
    int ret;
5846 warnings generated.
        ^
Suppressed 5849 warnings (5846 in non-user code, 3 NOLINT).
            = 0
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:683:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
6169 warnings generated.
    int ret;
Suppressed 6162 warnings (6159 in non-user code, 3 NOLINT).
        ^
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
            = 0
6219 warnings generated.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:704:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
Suppressed 6209 warnings (6206 in non-user code, 3 NOLINT).
    int ret;
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
        ^
7195 warnings generated.
            = 0
Suppressed 7196 warnings (7193 in non-user code, 3 NOLINT).
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:722:13: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
    int64_t ret;
7293 warnings generated.
            ^
                = 0
Suppressed 7178 warnings (7175 in non-user code, 3 NOLINT).
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:734:13: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int64_t ret;
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
            ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:755:13: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int64_t ret;
            ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:779:12: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    double ret;
           ^
               = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:803:13: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int64_t ret;
            ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:896:10: warning: variable 'bit' is not initialized [cppcoreguidelines-init-variables]
    bool bit;
         ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:925:10: warning: variable 'old_bit' is not initialized [cppcoreguidelines-init-variables]
    bool old_bit;
         ^
                 = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:960:14: warning: variable 'cnt' is not initialized [cppcoreguidelines-init-variables]
    uint32_t cnt;
             ^
                 = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1001:13: warning: variable 'pos' is not initialized [cppcoreguidelines-init-variables]
    int64_t pos;
            ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1055:15: warning: variable 'type' is not initialized [cppcoreguidelines-init-variables]
    RedisType type;
              ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1090:9: warning: variable 'ttl' is not initialized [cppcoreguidelines-init-variables]
    int ttl;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1105:9: warning: variable 'ttl' is not initialized [cppcoreguidelines-init-variables]
    int ttl;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1245:9: warning: variable 'ttl' is not initialized [cppcoreguidelines-init-variables]
    int ttl;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1277:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1305:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1337:14: warning: variable 'count' is not initialized [cppcoreguidelines-init-variables]
    uint32_t count;
             ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1359:13: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int64_t ret;
            ^
                = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1384:12: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    double ret;
           ^
               = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1432:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1552:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1823:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1851:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1897:14: warning: variable 'count' is not initialized [cppcoreguidelines-init-variables]
    uint32_t count;
             ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2044:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2062:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2076:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2104:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2209:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2357:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2425:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2443:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2467:12: warning: variable 'score' is not initialized [cppcoreguidelines-init-variables]
    double score;
           ^
                 = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2493:9: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
    int size;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2629:9: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
    int size;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2679:9: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
    int size;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2707:9: warning: variable 'rank' is not initialized [cppcoreguidelines-init-variables]
    int rank;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2743:9: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
    int size;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2772:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2799:9: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
    int size;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2824:9: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
    int size;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2841:12: warning: variable 'score' is not initialized [cppcoreguidelines-init-variables]
    double score;
           ^
                 = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2938:9: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
    int size;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2959:9: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
    int size;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3045:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3071:12: warning: variable 'distance' is not initialized [cppcoreguidelines-init-variables]
    double distance;
           ^
                    = NAN
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3326:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3354:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3371:9: warning: variable 'ret' is not initialized [cppcoreguidelines-init-variables]
    int ret;
        ^
            = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3493:9: warning: variable 'size' is not initialized [cppcoreguidelines-init-variables]
    int size;
        ^
             = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3537:15: warning: variable 'type' is not initialized [cppcoreguidelines-init-variables]
    RedisType type;
              ^
                   = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4304:15: warning: variable 'protocol' is not initialized [cppcoreguidelines-init-variables]
      int64_t protocol;
              ^
                       = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4758:15: warning: variable 'state' is not initialized [cppcoreguidelines-init-variables]
      int64_t state;
              ^
                    = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5058:16: warning: variable 'max_len_idx' is not initialized [cppcoreguidelines-init-variables]
        size_t max_len_idx;
               ^
                           = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5087:16: warning: variable 'min_id_idx' is not initialized [cppcoreguidelines-init-variables]
        size_t min_id_idx;
               ^
                          = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5205:14: warning: variable 'deleted' is not initialized [cppcoreguidelines-init-variables]
    uint64_t deleted;
             ^
                     = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5224:14: warning: variable 'len' is not initialized [cppcoreguidelines-init-variables]
    uint64_t len;
             ^
                 = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5812:14: warning: variable 'max_len_idx' is not initialized [cppcoreguidelines-init-variables]
      size_t max_len_idx;
             ^
                         = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5831:14: warning: variable 'min_id_idx' is not initialized [cppcoreguidelines-init-variables]
      size_t min_id_idx;
             ^
                        = 0
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5877:14: warning: variable 'removed' is not initialized [cppcoreguidelines-init-variables]
    uint64_t removed;
             ^
                     = 0
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `cppcoreguidelines-init-variables` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., cppcoreguidelines-init-variables
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1090/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1091,https://api.github.com/repos/apache/kvrocks/issues/1091,kvrocks,1446488331,1091,Fix `cppcoreguidelines-macro-usage` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:12:07Z,2022-12-04T12:30:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `cppcoreguidelines-macro-usage` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `cppcoreguidelines-macro-usage` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:46:9: warning: function-like macro 'rol' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define rol(value, bits) (((value) << (bits)) | ((value) >> (32 - (bits))))
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:51:9: warning: function-like macro 'blk0' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define blk0(i) (block->l[i] = (rol(block->l[i], 24) & 0xFF00FF00) | (rol(block->l[i], 8) & 0x00FF00FF))
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:57:9: warning: function-like macro 'blk' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define blk(i)        \
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:62:9: warning: function-like macro 'R0' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define R0(v, w, x, y, z, i)                                   \
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:65:9: warning: function-like macro 'R1' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define R1(v, w, x, y, z, i)                                  \
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:68:9: warning: function-like macro 'R2' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define R2(v, w, x, y, z, i)                          \
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:71:9: warning: function-like macro 'R3' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define R3(v, w, x, y, z, i)                                            \
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:74:9: warning: function-like macro 'R4' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define R4(v, w, x, y, z, i)                          \
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:63:9: warning: macro 'AE_READABLE' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define AE_READABLE 1
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:64:9: warning: macro 'AE_WRITABLE' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define AE_WRITABLE 2
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:65:9: warning: macro 'AE_ERROR' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define AE_ERROR 4
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:66:9: warning: macro 'AE_HUP' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define AE_HUP 8
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:69:9: warning: macro 'MAX_LONG_DOUBLE_CHARS' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define MAX_LONG_DOUBLE_CHARS 5 * 1024
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:324:9: warning: macro 'LUA_GC_CYCLE_PERIOD' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define LUA_GC_CYCLE_PERIOD 50
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:62:9: warning: macro 'D_R' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define D_R (M_PI / 180.0)
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:63:9: warning: macro 'R_MAJOR' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define R_MAJOR 6378137.0
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:64:9: warning: macro 'R_MINOR' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define R_MINOR 6356752.3142
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:65:9: warning: macro 'RATIO' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define RATIO (R_MINOR / R_MAJOR)
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:66:9: warning: macro 'ECCENT' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define ECCENT (sqrt(1.0 - (RATIO * RATIO)))
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:67:9: warning: macro 'COM' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define COM (0.5 * ECCENT)
        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/main.cc:30:9: warning: macro '_XOPEN_SOURCE' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define _XOPEN_SOURCE 700
        ^
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `cppcoreguidelines-macro-usage` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., cppcoreguidelines-macro-usage
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1091/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1092,https://api.github.com/repos/apache/kvrocks/issues/1092,kvrocks,1446488631,1092,Fix `cppcoreguidelines-narrowing-conversions` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:12:54Z,2022-12-12T02:32:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `cppcoreguidelines-narrowing-conversions` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `cppcoreguidelines-narrowing-conversions` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:207:17: warning: narrowing conversion from 'unsigned long' to signed type '__time_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    tv.tv_sec = timeout / 1000;
                ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:208:18: warning: narrowing conversion from 'unsigned long' to signed type '__suseconds_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    tv.tv_usec = (timeout % 1000) * 1000;
                 ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:422:42: warning: narrowing conversion from 'std::basic_string<char>::size_type' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  return StringMatchLen(pattern.c_str(), pattern.length(), in.c_str(), in.length(), nocase);
                                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:422:72: warning: narrowing conversion from 'std::basic_string<char>::size_type' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  return StringMatchLen(pattern.c_str(), pattern.length(), in.c_str(), in.length(), nocase);
                                                                       ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:655:31: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if ((retval = poll(&pfd, 1, timeout)) == 1) {
                              ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/config/config.cc:269:43: warning: narrowing conversion from 'int64_t' (aka 'long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
         compaction_checker_range.Start = start;
                                          ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/config/config.cc:270:42: warning: narrowing conversion from 'int64_t' (aka 'long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
         compaction_checker_range.Stop = stop;
                                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/config/config.cc:817:50: warning: narrowing conversion from 'std::basic_string<char>::size_type' (aka 'unsigned long') to signed type 'std::streamsize' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  output_file.write(string_stream.str().c_str(), string_stream.str().size());
                                                 ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/redis_connection.cc:200:37: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    if (reply != nullptr) reply("""", subcribe_patterns_.size());
                                    ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/redis_connection.cc:237:37: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    if (reply != nullptr) reply("""", subscribe_channels_.size());
                                    ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/redis_request.cc:114:70: warning: narrowing conversion from 'unsigned long' to signed type 'ssize_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
        char *data = reinterpret_cast<char *>(evbuffer_pullup(input, bulk_len_ + 2));
                                                                     ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:183:31: warning: narrowing conversion from 'long' to signed type 'int32_t' (aka 'int') is implementation-defined [cppcoreguidelines-narrowing-conversions]
          last_compact_date = now / 86400;
                              ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:242:30: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    config_->SetMaster(host, port);
                             ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:1036:81: warning: narrowing conversion from 'unsigned long' to 'double' [cppcoreguidelines-narrowing-conversions]
    double used_percent = config_->max_db_size ? storage_->GetTotalSize() * 100 / (config_->max_db_size * GiB) : 0;
                                                                                ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:1044:34: warning: narrowing conversion from 'unsigned long' to 'double' [cppcoreguidelines-narrowing-conversions]
      double used_disk_percent = used_disk_size * 100 / disk_capacity;
                                 ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:1413:39: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  std::string value = Redis::MultiLen(tokens.size());
                                      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/worker.cc:167:23: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    conn->SetAddr(ip, port);
                      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:30:32: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  output.append(Redis::Integer(id));
                               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:32:32: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  output.append(Redis::Integer(duration));
                               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:40:32: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  output.append(Redis::Integer(id));
                               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:43:32: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  output.append(Redis::Integer(duration));
                               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:59:10: warning: narrowing conversion from 'size_t' (aka 'unsigned long') to signed type 'ssize_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  return n;
         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:104:33: warning: narrowing conversion from 'size_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  output.append(Redis::MultiLen(n));
                                ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/lock_manager.cc:28:16: warning: narrowing conversion from 'unsigned int' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  hash_mask_ = (1U << hash_power) - 1;
               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:206:11: warning: narrowing conversion from 'lua_Number' (aka 'double') to 'int' [cppcoreguidelines-narrowing-conversions]
  level = lua_tonumber(lua, -argc);
          ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:272:67: warning: narrowing conversion from 'int' to signed type 'char' is implementation-defined [cppcoreguidelines-narrowing-conversions]
      funcname[j + 2] = (sha[j] >= 'A' && sha[j] <= 'Z') ? sha[j] + ('a' - 'A') : sha[j];
                                                                  ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:272:83: warning: narrowing conversion from 'int' to signed type 'char' is implementation-defined [cppcoreguidelines-narrowing-conversions]
      funcname[j + 2] = (sha[j] >= 'A' && sha[j] <= 'Z') ? sha[j] + ('a' - 'A') : sha[j];
                                                                                  ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/scripting.cc:843:26: warning: narrowing conversion from 'unsigned long' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    lua_rawseti(lua, -2, i + 1);
                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:173:88: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  rate_limiter_ = std::shared_ptr<rocksdb::RateLimiter>(rocksdb::NewGenericRateLimiter(max_io_mb * MiB));
                                                                                       ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:629:36: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  rate_limiter_->SetBytesPerSecond(max_io_mb * MiB);
                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:648:27: warning: narrowing conversion from 'size_t' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  const int charset_len = strlen(charset);
                          ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:188:17: warning: narrowing conversion from 'unsigned long long' to 'double' [cppcoreguidelines-narrowing-conversions]
  lat_offset *= (1ULL << step);
                ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:189:18: warning: narrowing conversion from 'unsigned long long' to 'double' [cppcoreguidelines-narrowing-conversions]
  long_offset *= (1ULL << step);
                 ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:190:29: warning: narrowing conversion from 'double' to 'uint32_t' (aka 'unsigned int') [cppcoreguidelines-narrowing-conversions]
  hash->bits = interleave64(lat_offset, long_offset);
                            ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:190:41: warning: narrowing conversion from 'double' to 'uint32_t' (aka 'unsigned int') [cppcoreguidelines-narrowing-conversions]
  hash->bits = interleave64(lat_offset, long_offset);
                                        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:223:55: warning: narrowing conversion from 'unsigned long long' to 'double' [cppcoreguidelines-narrowing-conversions]
  area->latitude.min = lat_range.min + (ilato * 1.0 / (1ull << step)) * lat_scale;
                                                      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:224:61: warning: narrowing conversion from 'unsigned long long' to 'double' [cppcoreguidelines-narrowing-conversions]
  area->latitude.max = lat_range.min + ((ilato + 1) * 1.0 / (1ull << step)) * lat_scale;
                                                            ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:225:57: warning: narrowing conversion from 'unsigned long long' to 'double' [cppcoreguidelines-narrowing-conversions]
  area->longitude.min = long_range.min + (ilono * 1.0 / (1ull << step)) * long_scale;
                                                        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:226:63: warning: narrowing conversion from 'unsigned long long' to 'double' [cppcoreguidelines-narrowing-conversions]
  area->longitude.max = long_range.min + ((ilono + 1) * 1.0 / (1ull << step)) * long_scale;
                                                              ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:168:21: warning: narrowing conversion from 'uint8_t' (aka 'unsigned char') to signed type '__gnu_cxx::__alloc_traits<std::allocator<char>, char>::value_type' (aka 'char') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      fragment[i] = swap_table[static_cast<uint8_t>(fragment[i])];
                    ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:214:26: warning: narrowing conversion from 'int' to signed type '__gnu_cxx::__alloc_traits<std::allocator<char>, char>::value_type' (aka 'char') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    value[byte_index] |= 1 << bit_offset;
                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:216:26: warning: narrowing conversion from 'int' to signed type '__gnu_cxx::__alloc_traits<std::allocator<char>, char>::value_type' (aka 'char') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    value[byte_index] &= ~(1 << bit_offset);
                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:539:10: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  *len = max_size;
         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:54:14: warning: narrowing conversion from 'int' to signed type 'char' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  byteval &= ~(1 << bit_offset);
             ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:55:14: warning: narrowing conversion from 'int' to signed type 'char' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  byteval |= ((new_bit & 0x1) << bit_offset);
             ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:75:26: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if (start < 0) start = strlen + start;
                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:76:24: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if (stop < 0) stop = strlen + stop;
                       ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:79:52: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if (stop >= static_cast<int64_t>(strlen)) stop = strlen - 1;
                                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:95:26: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if (start < 0) start = strlen + start;
                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:96:24: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if (stop < 0) stop = strlen + stop;
                       ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap_string.cc:99:52: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if (stop >= static_cast<int64_t>(strlen)) stop = strlen - 1;
                                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:109:29: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    int64_t result_length = geo_points->size();
                            ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:200:13: warning: narrowing conversion from 'unsigned long' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
      idx = (hash.bits >> (52 - ((i + 1) * 5))) & 0x1f;
            ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:246:10: warning: narrowing conversion from 'unsigned int' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  return count;
         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:257:37: warning: narrowing conversion from 'GeoHashFix52Bits' (aka 'unsigned long') to 'double' [cppcoreguidelines-narrowing-conversions]
  return getPointsInRange(user_key, min, max, lon, lat, radius, geo_points);
                                    ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_geo.cc:257:42: warning: narrowing conversion from 'GeoHashFix52Bits' (aka 'unsigned long') to 'double' [cppcoreguidelines-narrowing-conversions]
  return getPointsInRange(user_key, min, max, lon, lat, radius, geo_points);
                                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_hash.cc:135:21: warning: narrowing conversion from 'double' to 'float' [cppcoreguidelines-narrowing-conversions]
        old_value = std::stod(value_bytes, &idx);
                    ^
4668 warnings generated.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:87:10: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
6728 warnings generated.
  *ret = metadata.size;
Suppressed 6733 warnings (6728 in non-user code, 5 NOLINT).
         ^
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:337:10: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
Suppressed 6391 warnings (6386 in non-user code, 5 NOLINT).
  *ret = metadata.size;
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
         ^
4135 warnings generated.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:350:27: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
Suppressed 4138 warnings (4135 in non-user code, 3 NOLINT).
  if (index < 0) index += metadata.size;
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
                          ^
2699 warnings generated.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:417:26: warning: narrowing conversion from 'unsigned int' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
  if (index < 0) index = metadata.size + index;
767 warnings generated.
Suppressed 754 warnings (749 in non-user code, 5 NOLINT).
                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:600:26: warning: narrowing conversion from 'unsigned int' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
Suppressed 6839 warnings (6836 in non-user code, 3 NOLINT).
  if (start < 0) start = metadata.size + start;
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
                         ^
4672 warnings generated.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:601:85: warning: narrowing conversion from 'unsigned int' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
Suppressed 4674 warnings (4671 in non-user code, 3 NOLINT).
  if (stop < 0) stop = static_cast<int>(metadata.size) >= -1 * stop ? metadata.size + stop : -1;
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
                                                                                    ^
6367 warnings generated.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:601:94: warning: narrowing conversion from constant value 4294967295 (0xFFFFFFFF) of type 'unsigned int' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
Suppressed 6363 warnings (6360 in non-user code, 3 NOLINT).
  if (stop < 0) stop = static_cast<int>(metadata.size) >= -1 * stop ? metadata.size + stop : -1;
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
                                                                                             ^
3314 warnings generated.
Suppressed 3314 warnings (3314 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
6363 warnings generated.
Suppressed 6367 warnings (6362 in non-user code, 5 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
6748 warnings generated.
Suppressed 6725 warnings (6722 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
6504 warnings generated.
Suppressed 6499 warnings (6495 in non-user code, 4 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
5847 warnings generated.
Suppressed 5850 warnings (5847 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
3867 warnings generated.
Suppressed 3857 warnings (3857 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
5013 warnings generated.
Suppressed 5014 warnings (5011 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
6366 warnings generated.
Suppressed 6365 warnings (6362 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
5853 warnings generated.
Suppressed 5856 warnings (5853 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
5835 warnings generated.
Suppressed 5838 warnings (5835 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
5842 warnings generated.
Suppressed 5845 warnings (5842 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
3773 warnings generated.
Suppressed 3772 warnings (3772 in non-user code).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
6370 warnings generated.
Suppressed 6369 warnings (6366 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
4914 warnings generated.
Suppressed 4912 warnings (4909 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
5838 warnings generated.
Suppressed 5841 warnings (5838 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
6685 warnings generated.
Suppressed 6667 warnings (6664 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
7315 warnings generated.
Suppressed 7304 warnings (7298 in non-user code, 6 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
6369 warnings generated.
Suppressed 6368 warnings (6365 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
1582 warnings generated.
Suppressed 1556 warnings (1555 in non-user code, 1 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
5868 warnings generated.
Suppressed 5856 warnings (5853 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
5859 warnings generated.
Suppressed 5841 warnings (5838 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
5894 warnings generated.
Suppressed 5885 warnings (5882 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
6161 warnings generated.
Suppressed 6163 warnings (6160 in non-user code, 3 NOLINT).
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_set.cc:132:10: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  *ret = metadata.size;
         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_sortedint.cc:110:10: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  *ret = metadata.size;
         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:167:21: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  metadata.expire = expire;
                    ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:243:21: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  metadata.expire = expire;
                    ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:375:23: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    metadata.expire = expire;
                      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:417:23: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    metadata.expire = expire;
                      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:463:23: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    metadata.expire = expire;
                      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:146:10: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  *ret = metadata.size;
         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:176:56: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if (count > static_cast<int>(metadata.size)) count = metadata.size;
                                                       ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:241:27: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if (start < 0) start += metadata.size;
                          ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:242:25: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
  if (stop < 0) stop += metadata.size;
                        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:708:23: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    if (size) *size = mscores.size();
                      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:757:23: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    if (size) *size = mscores.size();
                      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/main.cc:83:44: warning: narrowing conversion from 'size_t' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
      LOG(ERROR) << std::left << std::setw(max_msg_len) << messages[i] << ""  "" << func_info;
                                           ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:414:32: warning: narrowing conversion from 'std::basic_string<char>::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
Suppressed 5848 warnings (5845 in non-user code, 3 NOLINT).
      *output = Redis::Integer(value.size());
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
                               ^
5876 warnings generated.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:641:14: warning: narrowing conversion from 'long' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
4696 warnings generated.
      ttl_ = *ttl_ms / 1000;
Suppressed 4695 warnings (4692 in non-user code, 3 NOLINT).
             ^
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1075:38: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      output->append(Redis::MultiLen(infos.size()));
                                     ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1195:18: warning: narrowing conversion from 'StatusOr<long>::value_type' (aka 'long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    timestamp_ = *parse_result;
                 ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2131:36: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::MultiLen(exists.size()));
                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2529:36: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::MultiLen(memeber_scores.size() * 2));
                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2579:38: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      output->append(Redis::MultiLen(member_scores.size()));
                                     ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2581:38: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      output->append(Redis::MultiLen(member_scores.size() * 2));
                                     ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2687:38: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      output->append(Redis::MultiLen(member_scores.size()));
                                     ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:2689:38: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      output->append(Redis::MultiLen(member_scores.size() * 2));
                                     ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3222:32: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      *output = Redis::Integer(geo_points.size());
                               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3230:25: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
    int result_length = geo_points.size();
                        ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3402:36: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::MultiLen(exists.size()));
                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3442:36: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::MultiLen(ids.size()));
                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3498:36: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::MultiLen(ids.size()));
                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3546:30: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    *output = Redis::Integer(result);
                             ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3603:33: warning: narrowing conversion from 'std::deque::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    conn->Reply(Redis::MultiLen(conn->GetMultiExecCommands()->size()));
                                ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3675:32: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      *output = Redis::Integer(stats.n_key);
                               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3802:38: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      output->append(Redis::MultiLen(channel_subscribe_nums.size() * 2));
                                     ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3805:39: warning: narrowing conversion from 'size_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
        output->append(Redis::Integer(chan_subscribe_num.subscribe_num));
                                      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4161:32: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      *output = Redis::Integer(conn->GetID());
                               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4271:47: warning: narrowing conversion from 'unsigned long' to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
        auto s = GetKeysFromCommand(args_[2], args_.size() - 2, &keys_indexes);
                                              ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4618:30: warning: narrowing conversion from 'uint32_t' (aka 'unsigned int') to signed type 'int' is implementation-defined [cppcoreguidelines-narrowing-conversions]
      conn->SetListeningPort(port_);
                             ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4715:68: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to 'double' [cppcoreguidelines-narrowing-conversions]
            static_cast<uint64_t>(static_cast<double>(file_size) / max_replication_bytes * (1000 * 1000));
                                                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4786:40: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
        output->append(Redis::MultiLen(infos.size()));
                                       ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4788:42: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
          output->append(Redis::MultiLen(info.nodes.size() + 2));
                                         ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4904:61: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      Status s = svr->cluster_->SetClusterNodes(nodes_str_, set_version_, force_);
                                                            ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4918:61: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      Status s = svr->cluster_->SetSlot(slot_id_, args_[4], set_version_);
                                                            ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4925:19: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      int64_t v = svr->cluster_->GetVersion();
                  ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5013:33: warning: narrowing conversion from 'unsigned long' to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      *output = Redis::MultiLen(args_.size() - 2);
                                ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5211:30: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    *output = Redis::Integer(deleted);
                             ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5230:30: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    *output = Redis::Integer(len);
                             ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5286:35: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::Integer(info.size));
                                  ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5292:35: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::Integer(info.entries_added));
                                  ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5314:38: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      output->append(Redis::MultiLen(info.entries.size()));
                                     ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5396:36: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::MultiLen(result.size()));
                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5486:36: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::MultiLen(result.size()));
                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5631:36: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output->append(Redis::MultiLen(results.size()));
                                   ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5636:38: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      output->append(Redis::MultiLen(result.entries.size()));
                                     ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5742:35: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    output.append(Redis::MultiLen(results.size()));
                                  ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5747:37: warning: narrowing conversion from 'std::vector::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
      output.append(Redis::MultiLen(result.entries.size()));
                                    ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:5883:30: warning: narrowing conversion from 'uint64_t' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
    *output = Redis::Integer(removed);
                             ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:6160:32: warning: narrowing conversion from 'std::map<std::basic_string<char>, const Redis::CommandAttributes *>::size_type' (aka 'unsigned long') to signed type 'int64_t' (aka 'long') is implementation-defined [cppcoreguidelines-narrowing-conversions]
  info->append(Redis::MultiLen(original_commands.size()));
                               ^
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `cppcoreguidelines-narrowing-conversions` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., cppcoreguidelines-narrowing-conversions
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1092/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1093,https://api.github.com/repos/apache/kvrocks/issues/1093,kvrocks,1446488962,1093,Fix `cppcoreguidelines-special-member-functions` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:13:47Z,2022-11-15T15:40:06Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `cppcoreguidelines-special-member-functions` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `cppcoreguidelines-special-member-functions` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:112:16: warning: class 'LogCollector' defines a non-default destructor but does not define a copy constructor, a copy assignment operator, a move constructor or a move assignment operator [cppcoreguidelines-special-member-functions]
template class LogCollector<SlowEntry>;
               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/log_collector.cc:113:16: warning: class 'LogCollector' defines a non-default destructor but does not define a copy constructor, a copy assignment operator, a move constructor or a move assignment operator [cppcoreguidelines-special-member-functions]
template class LogCollector<PerfEntry>;
               ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1661:7: warning: class 'CommandBPop' defines a non-default destructor but does not define a copy constructor, a copy assignment operator, a move constructor or a move assignment operator [cppcoreguidelines-special-member-functions]
class CommandBPop : public Commander {
      ^
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `cppcoreguidelines-special-member-functions` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., cppcoreguidelines-special-member-functions
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1093/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1093,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OXKjx,kvrocks,1314695409,1093,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2022-11-15T03:02:52Z,2022-11-15T03:02:52Z,I'd like to do,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OXKjx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1093,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OXM5k,kvrocks,1314704996,1093,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-15T03:15:26Z,2022-11-15T03:15:26Z,"@maochongxin assigned, thanks~","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OXM5k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1094,https://api.github.com/repos/apache/kvrocks/issues/1094,kvrocks,1446489181,1094,Fix `modernize-avoid-bind` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:14:26Z,2022-11-14T12:49:08Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `modernize-avoid-bind` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `modernize-avoid-bind` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/cluster/cluster.cc:322:25: warning: prefer a lambda to std::bind [modernize-avoid-bind]
      conn->close_cb_ = std::bind(&SlotImport::StopForLinkError, svr_->slot_import_, conn->GetFD());
                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                        [ObjectPtr = svr_->slot_import_, capture0 = conn->GetFD()] { ObjectPtr->StopForLinkError(capture0); }
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3733:11: warning: prefer a lambda to std::bind [modernize-avoid-bind]
          std::bind(SubscribeCommandReply, output, ""unsubscribe"", std::placeholders::_1, std::placeholders::_2));
          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          [output](auto && PH1, auto && PH2) { return SubscribeCommandReply(output, ""unsubscribe"", std::forward<decltype(PH1)>(PH1), std::forward<decltype(PH2)>(PH2)); }
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3761:11: warning: prefer a lambda to std::bind [modernize-avoid-bind]
          std::bind(SubscribeCommandReply, output, ""punsubscribe"", std::placeholders::_1, std::placeholders::_2));
          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
          [output](auto && PH1, auto && PH2) { return SubscribeCommandReply(output, ""punsubscribe"", std::forward<decltype(PH1)>(PH1), std::forward<decltype(PH2)>(PH2)); }
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `modernize-avoid-bind` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., modernize-avoid-bind
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1094/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1095,https://api.github.com/repos/apache/kvrocks/issues/1095,kvrocks,1446489372,1095,Fix `modernize-loop-convert` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:15:00Z,2022-11-16T03:31:45Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `modernize-loop-convert` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `modernize-loop-convert` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/task_runner.cc:57:3: warning: use range-based for loop instead [modernize-loop-convert]
  for (size_t i = 0; i < threads_.size(); i++) {
  ^   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      (auto & thread : threads_)
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/stats.cc:33:5: warning: use range-based for loop instead [modernize-loop-convert]
    for (int j = 0; j < STATS_METRIC_SAMPLES; j++) {
    ^   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
        (unsigned long & sample : im.samples)
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/stats/stats.cc:108:3: warning: use range-based for loop instead [modernize-loop-convert]
  for (int j = 0; j < STATS_METRIC_SAMPLES; j++) sum += inst_metrics[metric].samples[j];
  ^   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      (unsigned long sample : inst_metrics[metric].samples) sample
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/redis_db.cc:614:3: warning: use range-based for loop instead [modernize-loop-convert]
  for (size_t i = 0; i < args_.size(); i++) {
  ^   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      (auto & arg : args_)
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_set.cc:311:3: warning: use range-based for loop instead [modernize-loop-convert]
  for (size_t i = 0; i < keys.size(); i++) {
  ^   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      (auto key : keys)
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:140:3: warning: use range-based for loop instead [modernize-loop-convert]
  for (size_t i = 0; i < ns_keys.size(); i++) {
  ^   ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
      (auto & ns_key : ns_keys)
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `modernize-loop-convert` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., modernize-loop-convert
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1095/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1096,https://api.github.com/repos/apache/kvrocks/issues/1096,kvrocks,1446489614,1096,Fix `modernize-make-unique` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:15:39Z,2022-11-14T05:40:01Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `modernize-make-unique` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `modernize-make-unique` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:233:25: warning: use std::make_unique instead [modernize-make-unique]
  replication_thread_ = std::unique_ptr<ReplicationThread>(new ReplicationThread(host, master_listen_port, this));
                        ^~~~~~~~~~~~~~~                    ~~~~~~~~~~~~~~~~~~~~~~                              ~
                        std::make_unique
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:950:14: warning: use std::make_unique instead [modernize-make-unique]
  src_reader.reset(new rocksdb::SequentialFileWrapper(src_file.get()));
            ~^~~~~ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~              ~
             = std::make_unique<rocksdb::SequentialFileWrapper>
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `modernize-make-unique` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., modernize-make-unique
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1096/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1097,https://api.github.com/repos/apache/kvrocks/issues/1097,kvrocks,1446489866,1097,Fix `modernize-redundant-void-arg` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:16:24Z,2022-11-14T10:55:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `modernize-redundant-void-arg` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `modernize-redundant-void-arg` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:646:27: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
bool Storage::ShiftReplId(void) {
                          ^~~~
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:698:27: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
    std::string GetReplId(void) { return replid_in_wal_; }
                          ^~~~
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:711:44: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
std::string Storage::GetReplIdFromDbEngine(void) {
                                           ^~~~
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:778:31: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
bool Storage::ExistCheckpoint(void) {
                              ^~~~
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:783:35: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
bool Storage::ExistSyncCheckpoint(void) { return env_->FileExists(config_->sync_checkpoint_dir).ok(); }
                                  ^~~~
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `modernize-redundant-void-arg` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., modernize-redundant-void-arg
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1097/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1098,https://api.github.com/repos/apache/kvrocks/issues/1098,kvrocks,1446490305,1098,Fix `modernize-use-auto` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:17:44Z,2022-11-15T03:35:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `modernize-use-auto` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `modernize-use-auto` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/batch_extractor.cc:73:9: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
        RedisCommand cmd = static_cast<RedisCommand>(*parse_result);
        ^~~~~~~~~~~~
        auto
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/batch_extractor.cc:106:9: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
        RedisCommand cmd = static_cast<RedisCommand>(*parse_result);
        ^~~~~~~~~~~~
        auto
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/batch_extractor.cc:152:9: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
        RedisCommand cmd = static_cast<RedisCommand>(*parse_result);
        ^~~~~~~~~~~~
        auto
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/batch_extractor.cc:243:9: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
        RedisCommand cmd = static_cast<RedisCommand>(*parse_result);
        ^~~~~~~~~~~~
        auto
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:250:3: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
  uint32_t u_start = static_cast<uint32_t>(start);
  ^~~~~~~~
  auto
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:251:3: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
  uint32_t u_stop = static_cast<uint32_t>(stop);
  ^~~~~~~~
  auto
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:300:3: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
  uint32_t u_start = static_cast<uint32_t>(start);
  ^~~~~~~~
  auto
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:301:3: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
  uint32_t u_stop = static_cast<uint32_t>(stop);
  ^~~~~~~~
  auto
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_bitmap.cc:433:11: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
          uint64_t *lres = reinterpret_cast<uint64_t *>(frag_res.get());
          ^~~~~~~~
          auto
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4714:9: warning: use auto when initializing with a cast to avoid duplicating the type name [modernize-use-auto]
        uint64_t shortest =
        ^~~~~~~~
        auto
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `modernize-use-auto` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., modernize-use-auto
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1098/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1099,https://api.github.com/repos/apache/kvrocks/issues/1099,kvrocks,1446490539,1099,Fix `modernize-use-bool-literals` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:18:20Z,2022-11-14T03:53:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `modernize-use-bool-literals` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `modernize-use-bool-literals` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/util.cc:458:16: warning: converting integer literal to bool, use bool literal instead [modernize-use-bool-literals]
        while (1) {
               ^
               true
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `modernize-use-bool-literals` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., modernize-use-bool-literals
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1099/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1100,https://api.github.com/repos/apache/kvrocks/issues/1100,kvrocks,1446490703,1100,Fix `modernize-use-nullptr` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:18:51Z,2022-12-04T02:03:03Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `modernize-use-nullptr` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `modernize-use-nullptr` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/redis_db.cc:338:30: warning: use nullptr [modernize-use-nullptr]
    unsigned int seed = time(NULL);
                             ^~~~
                             nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:340:37: warning: use nullptr [modernize-use-nullptr]
  rocksdb::Checkpoint *checkpoint = NULL;
                                    ^~~~
                                    nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:733:39: warning: use nullptr [modernize-use-nullptr]
    rocksdb::Checkpoint *checkpoint = NULL;
                                      ^~~~
                                      nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:169:15: warning: use nullptr [modernize-use-nullptr]
  if (hash == NULL || step > 32 || step == 0 || RANGEPISZERO(lat_range) || RANGEPISZERO(long_range)) return 0;
              ^~~~
              nullptr
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/geohash.cc:206:27: warning: use nullptr [modernize-use-nullptr]
  if (HASHISZERO(hash) || NULL == area || RANGEISZERO(lat_range) || RANGEISZERO(long_range)) {
                          ^~~~
                          nullptr
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `modernize-use-nullptr` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., modernize-use-nullptr
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1100/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1100,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OO3Zt,kvrocks,1312519789,1100,NA,WyattJia,8580364,bitstring,i@eventloop.live,NA,2022-11-12T16:23:36Z,2022-11-12T16:23:36Z,assign to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OO3Zt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1100,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OO5vP,kvrocks,1312529359,1100,NA,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,NA,2022-11-12T17:08:03Z,2022-11-12T17:08:03Z,@WyattJia  Assigned. Go ahead! ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OO5vP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1101,https://api.github.com/repos/apache/kvrocks/issues/1101,kvrocks,1446490897,1101,Fix `modernize-use-using` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:19:28Z,2022-11-15T06:42:48Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `modernize-use-using` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `modernize-use-using` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/common/sha1.cc:82:3: warning: use 'using' instead of 'typedef' [modernize-use-using]
  typedef union {
  ^~~~~~~~~~~~~~~
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `modernize-use-using` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., modernize-use-using
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1101/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1102,https://api.github.com/repos/apache/kvrocks/issues/1102,kvrocks,1446491053,1102,Fix `performance-faster-string-find` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:19:56Z,2022-11-14T09:46:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `performance-faster-string-find` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `performance-faster-string-find` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_stream_base.cc:64:25: warning: 'find' called with a string literal consisting of a single character; consider using the more effective overload accepting a character [performance-faster-string-find]
  auto pos = input.find(""-"");
                        ^~~
                        '-'
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_stream_base.cc:87:25: warning: 'find' called with a string literal consisting of a single character; consider using the more effective overload accepting a character [performance-faster-string-find]
  auto pos = input.find(""-"");
                        ^~~
                        '-'
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_stream_base.cc:121:25: warning: 'find' called with a string literal consisting of a single character; consider using the more effective overload accepting a character [performance-faster-string-find]
  auto pos = input.find(""-"");
                        ^~~
                        '-'
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `performance-faster-string-find` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., performance-faster-string-find
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1102/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1103,https://api.github.com/repos/apache/kvrocks/issues/1103,kvrocks,1446491202,1103,Fix `performance-for-range-copy` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:20:18Z,2022-11-14T08:17:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `performance-for-range-copy` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `performance-for-range-copy` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:769:13: warning: loop variable is copied but only used as const reference; consider making it a const reference [performance-for-range-copy]
  for (auto f : result) {
            ^
       const  &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/storage.cc:793:13: warning: loop variable is copied but only used as const reference; consider making it a const reference [performance-for-range-copy]
  for (auto file : tmp_files) {
            ^
       const  &
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `performance-for-range-copy` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., performance-for-range-copy
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1103/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1104,https://api.github.com/repos/apache/kvrocks/issues/1104,kvrocks,1446491385,1104,Fix `performance-inefficient-vector-operation` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:20:46Z,2022-11-15T12:35:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `performance-inefficient-vector-operation` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `performance-inefficient-vector-operation` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_string.cc:402:5: warning: 'emplace_back' is called inside a loop; consider pre-allocating the container capacity before the loop [performance-inefficient-vector-operation]
    keys.emplace_back(pair.key);
    ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:755:7: warning: 'emplace_back' is called inside a loop; consider pre-allocating the container capacity before the loop [performance-inefficient-vector-operation]
      mscores.emplace_back(MemberScore{iter.first, iter.second});
      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1462:7: warning: 'emplace_back' is called inside a loop; consider pre-allocating the container capacity before the loop [performance-inefficient-vector-operation]
      keys.emplace_back(fv.field);
      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:1480:7: warning: 'emplace_back' is called inside a loop; consider pre-allocating the container capacity before the loop [performance-inefficient-vector-operation]
      values.emplace_back(p.value);
      ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4279:11: warning: 'emplace_back' is called inside a loop; consider pre-allocating the container capacity before the loop [performance-inefficient-vector-operation]
          keys.emplace_back(args_[key_index + 2]);
          ^
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:4562:7: warning: 'emplace_back' is called inside a loop; consider pre-allocating the container capacity before the loop [performance-inefficient-vector-operation]
      score_strings.emplace_back(Util::Float2String(score));
      ^
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `performance-inefficient-vector-operation` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., performance-inefficient-vector-operation
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1104/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1105,https://api.github.com/repos/apache/kvrocks/issues/1105,kvrocks,1446491532,1105,Fix `performance-unnecessary-value-param` warning reported by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-12T15:21:12Z,2022-11-14T03:00:15Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

*This issue is tracked by #1029.*

***We welcome new contributors to take these issues as a beginning of a deep dive to kvrocks***

Currently we have enabled lots of clang-tidy checks, but there are so many reports already exist in the kvrocks code, so we cannot treat these report as errors to block future PR with some clang-tidy reported warnings in CI.

Hence the goal of this issue is to solve all `performance-unnecessary-value-param` tagged clang-tidy reports, and then enable `warnings-as-errors` for this specific check in `.clang-tidy`.

To get clang-tidy reports for latest kvrocks code, there are several ways: you can run `./x.py check tidy` locally, or check the log of the latest run of GitHub Actions on the unstable branch (e.g. https://github.com/apache/incubator-kvrocks/actions/runs/3449328741/jobs/5757148924#step:8:916). To be friendly for new contributors, we list all `performance-unnecessary-value-param` tagged reports below, so in normal cases you can just follow the log below and fix them one by one.

```log
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/config/config.cc:724:30: warning: the parameter 'key' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
void Config::Get(std::string key, std::vector<std::string> *values) {
                             ^
                 const      &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/redis_connection.cc:198:54: warning: the parameter 'reply' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
void Connection::UnSubscribeAll(unsubscribe_callback reply) {
                                                     ^
                                const               &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/redis_connection.cc:235:55: warning: the parameter 'reply' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
void Connection::PUnSubscribeAll(unsubscribe_callback reply) {
                                                      ^
                                 const               &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:215:38: warning: the parameter 'host' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
Status Server::AddMaster(std::string host, uint32_t port, bool force_reconnect) {
                                     ^
                         const      &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:406:63: warning: the parameter 'channels' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
void Server::ListChannelSubscribeNum(std::vector<std::string> channels,
                                                              ^
                                     const                   &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/server.cc:1324:54: warning: the parameter 'addr' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
void Server::KillClient(int64_t *killed, std::string addr, uint64_t id, uint64_t type, bool skipme,
                                                     ^
                                         const      &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/server/worker.cc:426:75: warning: the parameter 'addr' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
void Worker::KillClient(Redis::Connection *self, uint64_t id, std::string addr, uint64_t type, bool skipme,
                                                                          ^
                                                              const      &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/storage/redis_db.cc:166:33: warning: the parameter 'prefix' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
void Database::Keys(std::string prefix, std::vector<std::string> *keys, KeyNumStats *stats) {
                                ^
                    const      &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_list.cc:54:70: warning: the parameter 'elems' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
rocksdb::Status List::push(const Slice &user_key, std::vector<Slice> elems, bool create_if_missing, bool left,
6420 warnings generated.
                                                                     ^
Suppressed 6422 warnings (6419 in non-user code, 3 NOLINT).
                                                  const             &
Use -header-filter=.* to display errors from all non-system headers. Use -system-headers to display errors from system headers as well.
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_sortedint.cc:36:77: warning: the parameter 'ids' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
rocksdb::Status Sortedint::Add(const Slice &user_key, std::vector<uint64_t> ids, int *ret) {
                                                                            ^
                                                      const                &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_sortedint.cc:70:80: warning: the parameter 'ids' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
rocksdb::Status Sortedint::Remove(const Slice &user_key, std::vector<uint64_t> ids, int *ret) {
                                                                               ^
                                                         const                &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_sortedint.cc:213:80: warning: the parameter 'ids' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
rocksdb::Status Sortedint::MExist(const Slice &user_key, std::vector<uint64_t> ids, std::vector<int> *exists) {
                                                                               ^
                                                         const                &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/types/redis_zset.cc:418:71: warning: the parameter 'spec' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
rocksdb::Status ZSet::RangeByLex(const Slice &user_key, ZRangeLexSpec spec, std::vector<std::string> *members,
                                                                      ^
                                                        const        &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:877:45: warning: the parameter 'arg' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
Status getBitOffsetFromArgument(std::string arg, uint32_t *offset) {
                                            ^
                                const      &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3710:61: warning: the parameter 'name' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
void SubscribeCommandReply(std::string *output, std::string name, std::string sub_name, int num) {
                                                            ^
                                                const      &
/home/runner/work/incubator-kvrocks/incubator-kvrocks/src/commands/redis_cmd.cc:3710:79: warning: the parameter 'sub_name' is copied for each invocation but only used as a const reference; consider making it a const reference [performance-unnecessary-value-param]
void SubscribeCommandReply(std::string *output, std::string name, std::string sub_name, int num) {
                                                                              ^
                                                                  const      &
```

Some of these reports will give modification suggestions in the log, you can refer to them directly; otherwise, you need to understand the content of the warning and combine your C++ knowledge to fix it. (Fortunately, most reports (except those by clang static analyzer) are intuitive and easy to fix.)

When you fixed these all reports listed above, you can now add the check `performance-unnecessary-value-param` to `warnings-as-errors` in `.clang-tidy` (in the root dir of the repo): We show a sample diff below to illustrate how to modify `.clang-tidy`:

```diff
--- a/.clang-tidy
+++ b/.clang-tidy
@@ -1,7 +1,7 @@
 # refer to https://clang.llvm.org/extra/clang-tidy/checks/list.html
 Checks: ...

-WarningsAsErrors: ...
+WarningsAsErrors: ..., performance-unnecessary-value-param
```

Then, if all of the above are completed, congratulations, you can submit a PR for your changes now!



### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1105/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1117,https://api.github.com/repos/apache/kvrocks/issues/1117,kvrocks,1446759554,1117,Support more `ZRANGE` options,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,CLOSED,2022-11-13T06:26:03Z,2023-05-07T08:23:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Redis no longer supports `ZRANGEBYLEX` and `ZRANGEBYSCORE` since `6.2.0`, merging this feature into options in `ZRANGE`. Currently our `ZRANGE` has almost no options and needs to be aligned with redis.
https://redis.io/commands/zrange/
https://redis.io/commands/zrangebylex/
https://redis.io/commands/zrangebyscore/

Related to #1082 's discussion.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1117/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1118,https://api.github.com/repos/apache/kvrocks/issues/1118,kvrocks,1446762250,1118,Support more `HRANGE` options,tanruixiang,34568378,Ruixiang Tan,tanruixiang0104@gmail.com,CLOSED,2022-11-13T06:35:40Z,2023-01-17T03:42:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Based on the discussion in #1082 , we will align the `HRANGE` instruction with the `ZRANGE`.
The format is as follows:
```
HRANGE key start stop [BYLEX] [REV] [LIMIT offset count]
```
Similar to `zrange`, if we use `bylex`, then `start` and `stop` are the indexes. If we use `bylex`, then `start` and `stop` are strings. `Limit` can specify `offset` and `count` regardless of whether `bylex` is used.
### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1118/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/1122,kvrocks,1447886723,1122,Can't start kvrocks in Docker container on macos.,ruslangm,11218579,Ruslan,ruslan.gmz@gmail.com,CLOSED,2022-11-14T11:26:24Z,2022-12-17T03:24:03Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

**MacOS version:** 12.6, MacBook Pro Apple M1 Max
**Docker desktop version:** 4.12.0 (85629)
**kvrocks version:** latest from Docker hub
https://hub.docker.com/layers/apache/kvrocks/latest/images/sha256-9ef819b07e071f03125846c08e01ee4651710f2ee70518987fbaf6944a6e5b62?context=explore

### Minimal reproduce step

```
❯ docker run -it -p 6666:6666 apache/kvrocks
<jemalloc>: MADV_DONTNEED does not work (memset will be used instead)
<jemalloc>: (This is the expected behaviour if you are running under QEMU)

❯ docker ps -a
CONTAINER ID   IMAGE            COMMAND                  CREATED              STATUS                            PORTS                    NAMES
2c5f0f887f81   apache/kvrocks   ""./bin/kvrocks -c ./…""   About a minute ago   Exited (137) About a minute ago                            
```

### What did you expect to see?

`kvrocks` start log.

### What did you see instead?

```
<jemalloc>: MADV_DONTNEED does not work (memset will be used instead)
<jemalloc>: (This is the expected behaviour if you are running under QEMU)
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1122/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTFQu,kvrocks,1313625134,1122,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-14T12:35:34Z,2022-11-14T12:35:34Z,"I tried it on Mac Pro(intel) and M1 Pro, but they work well. I'm wondering if the CPU arch is different between M1 Pro and M1 Max. @ruslangm could you paste the output of the command `uname -a`? And it will print the information looks like below:

```
Darwin hulks-MBP 21.4.0 Darwin Kernel Version 21.4.0: Mon Feb 21 20:35:58 PST 2022; root:xnu-8020.101.4~2/RELEASE_ARM64_T6000 arm64
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTFQu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTHNS,kvrocks,1313633106,1122,NA,ruslangm,11218579,Ruslan,ruslan.gmz@gmail.com,NA,2022-11-14T12:43:32Z,2022-11-14T12:43:32Z,"@git-hulk btw, I just built and ran `kvrocks` from sources according to the [build section from doc.](https://github.com/apache/incubator-kvrocks#build) and it works good.

```
❯ uname -a
Darwin nd9w29p9vd 21.6.0 Darwin Kernel Version 21.6.0: Mon Aug 22 20:19:52 PDT 2022; root:xnu-8020.140.49~2/RELEASE_ARM64_T6000 arm64
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTHNS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTKQs,kvrocks,1313645612,1122,NA,ruslangm,11218579,Ruslan,ruslan.gmz@gmail.com,NA,2022-11-14T12:55:39Z,2022-11-14T12:55:39Z,"`nightly` build provides one more line of error:
```
❯ docker run -it -p 6666:6666 --name apache/kvrocks:nightly
<jemalloc>: MADV_DONTNEED does not work (memset will be used instead)
<jemalloc>: (This is the expected behaviour if you are running under QEMU)
qemu: uncaught target signal 4 (Illegal instruction) - core dumped
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTKQs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTTv3,kvrocks,1313684471,1122,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-14T13:18:11Z,2022-11-14T13:18:11Z,"@ruslangm Thanks for your feedback. It looks like the docker client wrongly recognizes the CPU platform. Would you like to have a try at pulling the image with explicitly specify the platform arch: `docker pull apache/kvrocks:2.2.0 --platform arm64`

I can reproduce it on my M1 Pro if wrongly specified the platform:
```
❯ docker pull apache/kvrocks:2.2.0 --platform amd64
2.2.0: Pulling from apache/kvrocks
Digest: sha256:24dc33d8d2b69b1bfad073e63f13edc53bfa38235eb2f7320377ea7aa2691f49
Status: Downloaded newer image for apache/kvrocks:2.2.0
docker.io/apache/kvrocks:2.2.0
❯ docker run -it -p 6666:6666 apache/kvrocks:2.2.0
WARNING: The requested image's platform (linux/amd64) does not match the detected host platform (linux/arm64/v8) and no specific platform was requested
<jemalloc>: MADV_DONTNEED does not work (memset will be used instead)
<jemalloc>: (This is the expected behaviour if you are running under QEMU)
``","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTTv3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OThYG,kvrocks,1313740294,1122,NA,ruslangm,11218579,Ruslan,ruslan.gmz@gmail.com,NA,2022-11-14T13:50:09Z,2022-11-14T13:50:09Z,"@git-hulk sure.
```
❯ docker pull apache/kvrocks:2.2.0 --platform arm64
2.2.0: Pulling from apache/kvrocks
4e7e0215f4ad: Already exists
2b847dde0550: Pull complete
c81f793545a7: Pull complete
e371fbf3a5a8: Pull complete
3ce5b4e75401: Pull complete
9e36f583daf1: Pull complete
4f41328fbfd0: Pull complete
19c45c51368f: Pull complete
Digest: sha256:24dc33d8d2b69b1bfad073e63f13edc53bfa38235eb2f7320377ea7aa2691f49
Status: Downloaded newer image for apache/kvrocks:2.2.0
WARNING: image with reference apache/kvrocks was found but does not match the specified platform: wanted linux/arm64, actual: linux/amd64
docker.io/apache/kvrocks:2.2.0

❯ docker run -it -p 6666:6666 apache/kvrocks@sha256:24dc33d8d2b69b1bfad073e63f13edc53bfa38235eb2f7320377ea7aa2691f49
<jemalloc>: MADV_DONTNEED does not work (memset will be used instead)
<jemalloc>: (This is the expected behaviour if you are running under QEMU)
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OThYG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTnZb,kvrocks,1313764955,1122,NA,PragmaTwice,20042607,Twice,,NA,2022-11-14T14:07:08Z,2022-11-14T14:07:08Z,"> @git-hulk sure.
> 
> ```
> ❯ docker pull apache/kvrocks:2.2.0 --platform arm64
> 2.2.0: Pulling from apache/kvrocks
> 4e7e0215f4ad: Already exists
> 2b847dde0550: Pull complete
> c81f793545a7: Pull complete
> e371fbf3a5a8: Pull complete
> 3ce5b4e75401: Pull complete
> 9e36f583daf1: Pull complete
> 4f41328fbfd0: Pull complete
> 19c45c51368f: Pull complete
> Digest: sha256:24dc33d8d2b69b1bfad073e63f13edc53bfa38235eb2f7320377ea7aa2691f49
> Status: Downloaded newer image for apache/kvrocks:2.2.0
> WARNING: image with reference apache/kvrocks was found but does not match the specified platform: wanted linux/arm64, actual: linux/amd64
> docker.io/apache/kvrocks:2.2.0
> 
> ❯ docker run -it -p 6666:6666 apache/kvrocks@sha256:24dc33d8d2b69b1bfad073e63f13edc53bfa38235eb2f7320377ea7aa2691f49
> <jemalloc>: MADV_DONTNEED does not work (memset will be used instead)
> <jemalloc>: (This is the expected behaviour if you are running under QEMU)
> ```

I notice there is one line in your log that seems to be the reason of the error you encountered:
```
WARNING: image with reference apache/kvrocks was found but does not match the specified platform: wanted linux/arm64, actual: linux/amd64
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OTnZb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OToZa,kvrocks,1313769050,1122,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-14T14:09:38Z,2022-11-14T14:09:38Z,"That's so weird. Your docker's qemu is running in `linux/amd64` but from my side is `aarch64`. So you got the error since the docker client thought its arch is arm64 and pulled the image with the `arm64` platform.

```
❯ ps aux|grep qemu
hulk             13890   1.9  7.4 418260112 1247520   ??  S     8:28PM   3:30.06 /Applications/Docker.app/Contents/MacOS/qemu-system-aarch64 -accel hvf -cpu host -machine virt,highmem=off -m 8092 -smp 5 -kernel /Applications/Docker.app/Contents/Resources/linuxkit/kernel -append page_poison=1 vsyscall=emulate panic=1 nospec_store_bypass_disable noibrs noibpb no_stf_barrier mitigations=off linuxkit.unified_cgroup_hierarchy=1    vpnkit.connect=tcp+bootstrap+client://192.168.65.2:62364/bcb9f8f0f5a636d920d70e033a3333c9f4fe0807b19bb748bbd1561af926d878 vpnkit.disable=osxfs-data console=ttyAMA0 -initrd /Applications/Docker.app/Contents/Resources/linuxkit/initrd.img -serial pipe:/var/folders/ls/jsfyf9g52h94_tmgys0895qw0000gn/T/qemu-console1146358452/fifo -drive if=none,file=/Users/hulk/Library/Containers/com.docker.docker/Data/vms/0/data/Docker.raw,format=raw,id=hd0 -device virtio-blk-pci,drive=hd0,serial=dummyserial -netdev socket,id=net1,fd=3 -device virtio-net-device,netdev=net1,mac=02:50:00:00:00:01 -vga none -nographic -monitor none
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OToZa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OUGcE,kvrocks,1313892100,1122,NA,ruslangm,11218579,Ruslan,ruslan.gmz@gmail.com,NA,2022-11-14T15:02:48Z,2022-11-14T15:02:48Z,@git-hulk can it be related to difference between `Docker Desktop for Intel Chip` and `Docker Desktop for Apple Chip`?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OUGcE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OULIE,kvrocks,1313911300,1122,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-14T15:14:07Z,2022-11-14T15:14:07Z,"I also tested it on my intel chip, it also works well. You can take a look at qemu with `ps aux|grep qemu`. If I guess right, it should be running in `x86_64` mode.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OULIE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OUpwL,kvrocks,1314036747,1122,NA,ruslangm,11218579,Ruslan,ruslan.gmz@gmail.com,NA,2022-11-14T16:32:28Z,2022-11-14T16:32:28Z,"```
❯ ps aux | grep qemu
user             20177  13.8  1.2 418377584 387504   ??  R     7:38PM  13:39.97 /Applications/Docker.app/Contents/MacOS/qemu-system-aarch64 -accel hvf -cpu host ...
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OUpwL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OaHZe,kvrocks,1315468894,1122,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-15T15:24:28Z,2022-11-15T15:24:28Z,"> ```
> ❯ ps aux | grep qemu
> user             20177  13.8  1.2 418377584 387504   ??  R     7:38PM  13:39.97 /Applications/Docker.app/Contents/MacOS/qemu-system-aarch64 -accel hvf -cpu host ...
> ```

ummm... I have no idea why it happened, your QEMU is running in `aarch64` but it thought itself needs the `amd64` image:

```
was found but does not match the specified platform: wanted linux/arm64, actual: linux/amd64
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OaHZe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1122,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Q0tWt,kvrocks,1355994541,1122,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-12-17T03:23:51Z,2022-12-17T03:23:51Z,Moved questions to the Q&A forum.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Q0tWt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1123,https://api.github.com/repos/apache/kvrocks/issues/1123,kvrocks,1449313024,1123,Abort due to detaching un-joinable threads in slotmigrate_test,PragmaTwice,20042607,Twice,,CLOSED,2022-11-15T07:35:58Z,2022-12-18T15:33:02Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/incubator-kvrocks/actions/runs/3467209459/jobs/5791922270

### What did you expect to see?

PASS

### What did you see instead?

```
--- FAIL: TestSlotMigrateFromSlave (2.18s)
    server.go:106: 
        	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/server.go:106
        	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/server.go:112
        	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/server.go:101
        	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:47
        	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:65
        	Error:      	Received unexpected error:
        	            	signal: aborted (core dumped)
        	Test:       	TestSlotMigrateFromSlave
FAIL
```

```
E20221115 04:06:34.430215 38266 main.cc:67] ======= Ooops! kvrocks 999.999.999 @7fb3d64 got signal: Aborted (6) =======
E20221115 04:06:34.439514 38266 main.cc:85] /lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f64354c0420]
E20221115 04:06:34.439740 38266 main.cc:83] /lib/x86_64-linux-gnu/libc.so.6(gsignal+0xcb) [0x7f64351ae00b]                                   gsignal
E20221115 04:06:34.439891 38266 main.cc:83] /lib/x86_64-linux-gnu/libc.so.6(abort+0x12b) [0x7f643518d859]                                    abort
E20221115 04:06:34.440196 38266 main.cc:83] /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/kvrocks(+0xe89a9) [0x5557203199a9]   _ZN9__gnu_cxx27__verbose_terminate_handlerEv.cold
E20221115 04:06:34.441274 38266 main.cc:83] /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/kvrocks(+0x9199bc) [0x555720b4a9bc]  __cxxabiv1::__terminate()
E20221115 04:06:34.442413 38266 main.cc:85] /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/kvrocks(+0x919a27) [0x555720b4aa27]
E20221115 04:06:34.443441 38266 main.cc:85] /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/kvrocks(+0x919b89) [0x555720b4ab89]
E20221115 04:06:34.443967 38266 main.cc:83] /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/kvrocks(+0xea6a0) [0x55572031b6a0]   std::__throw_system_error()
E20221115 04:06:34.444846 38266 main.cc:83] /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/kvrocks(+0x99e4f0) [0x555720bcf4f0]  std::thread::detach()
E20221115 04:06:34.445474 38266 main.cc:83] /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/kvrocks(+0x12a8a1) [0x55572035b8a1]  ReplicationThread::Stop()
E20221115 04:06:34.446453 38266 main.cc:83] /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/kvrocks(+0x1ec8cf) [0x55572041d8cf]  Server::Stop()
E20221115 04:06:34.446888 38266 main.cc:83] /home/runner/work/incubator-kvrocks/incubator-kvrocks/build/kvrocks(+0x26aec8) [0x55572049bec8]  signalHandler
E20221115 04:06:34.447082 38266 main.cc:85] /lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f64354c0420]
E20221115 04:06:34.447254 38266 main.cc:83] /lib/x86_64-linux-gnu/libc.so.6(clone+0x35) [0x7f643528a[125](https://github.com/apache/incubator-kvrocks/actions/runs/3467209459/jobs/5791922270#step:13:126)]                                     clone
```


### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1123/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1123,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Q33js,kvrocks,1356822764,1123,NA,PragmaTwice,20042607,Twice,,NA,2022-12-18T15:33:02Z,2022-12-18T15:33:02Z,Fixed in #1195.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Q33js/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1126,https://api.github.com/repos/apache/kvrocks/issues/1126,kvrocks,1452999205,1126,Unstable Go case list_test,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-11-17T09:24:24Z,2022-11-25T14:13:49Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/apache/incubator-kvrocks/actions/runs/3476132400/jobs/5811155755

```
--- FAIL: TestList (6.74s)
    --- FAIL: TestList/brpop:_arguments_are_empty (1.00s)
        tcp_client.go:79: 
            	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/list/tcp_client.go:79
            	            				/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/list/list_test.go:435
            	Error:      	Not equal: 
            	            	expected: int32(42)
            	            	actual  : uint8(0x24)
            	Test:       	TestList/brpop:_arguments_are_empty
```

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1126/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1127,https://api.github.com/repos/apache/kvrocks/issues/1127,kvrocks,1453094918,1127,command compact turn to be unknown command after rename compact to xxx,iushas,7236171,tanic.xiao,,CLOSED,2022-11-17T10:27:46Z,2022-11-18T02:43:14Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

All version 

### Minimal reproduce step

1. add rename config into config file
 ```
rename-command compact                             _dont_run_compact_rudely
```
2. exce compact or _dont_run_compact_rudely
```
127.0.0.1:6379> _dont_run_compact_rudely
(error) ERR unknown command _dont_run_compact_rudely
```


compacion_checker can worker well，
![image](https://user-images.githubusercontent.com/7236171/202422151-658f5d3f-89a3-40b4-a3fc-9a071b954a19.png)



### What did you expect to see?

compact can be executed manual after rename 

### What did you see instead?

UP

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1127/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1127,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OlbQE,kvrocks,1318433796,1127,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-17T10:38:15Z,2022-11-17T10:38:15Z,"@iushas That's a known bug and it's fixed in #1047. Good news is @PragmaTwice has called the release vote in Apache community, 2.2.0 will be coming tonight if no further objection.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OlbQE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1127,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OlcSx,kvrocks,1318438065,1127,NA,PragmaTwice,20042607,Twice,,NA,2022-11-17T10:41:31Z,2022-11-17T10:41:31Z,"@iushas Hi, you can try docker image apache/kvrocks:2.2.0 and see if it is solved. It is a prerelease now but will be an official release soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OlcSx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1127,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OpYkj,kvrocks,1319471395,1127,NA,iushas,7236171,tanic.xiao,,NA,2022-11-18T02:38:21Z,2022-11-18T02:38:21Z,thans @git-hulk  and @PragmaTwice ， it's normal in 2.2.0。 Looking forward to the official release！,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OpYkj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1127,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OpZJe,kvrocks,1319473758,1127,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-18T02:43:14Z,2022-11-18T02:43:14Z,"> thans @git-hulk and @PragmaTwice ， it's normal in 2.2.0。 Looking forward to the official release！

@iushas New release is available now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5OpZJe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1131,https://api.github.com/repos/apache/kvrocks/issues/1131,kvrocks,1458988201,1131,Expose a parameter in dockerfile to specify the concurrent job level,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-11-22T03:42:28Z,2023-04-29T00:57:34Z,"I think we need expose a parameter in dockerfile to specify the concurrent job level. Maybe in another PR.

_Originally posted by @PragmaTwice in https://github.com/apache/incubator-kvrocks/pull/1130#pullrequestreview-1189281426_

@PragmaTwice make sense. Perhaps `ARG BUILD_PARALLELISM`. You can read https://docs.docker.com/engine/reference/builder/#arg.

_Originally posted by @tisonkun in https://github.com/apache/incubator-kvrocks/issues/1130#issuecomment-1322995426_
      ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1131/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1131,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bGLtl,kvrocks,1528347493,1131,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-04-29T00:57:33Z,2023-04-29T00:57:33Z,"This should be somehow covered by https://github.com/apache/incubator-kvrocks/pull/1233.

That you can use `docker build --build-arg ARG MORE_BUILD_ARGS='-j xx' .`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bGLtl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1132,https://api.github.com/repos/apache/kvrocks/issues/1132,kvrocks,1461596000,1132,lua script load return bool true (PHP client),jasonhe88,6936520,,alenhe@hotmail.com,CLOSED,2022-11-23T11:38:01Z,2022-11-23T15:44:33Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

MacOS 12.2.1
KVRocks 2.1.0

### Minimal reproduce step

```php
 <?php
  
 $redis = new Redis();
  
 $redis->connect('127.0.0.1', 6379);
  
$r = $redis->script('load', 'return ""hello""');
var_dump($r);
```

### What did you expect to see?

hash value of lua script

### What did you see instead?

bool(true)

### Anything Else?

if switch to Redis, above code return correct hash value

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1132/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1132,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5O-SsV,kvrocks,1324952341,1132,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-23T12:02:01Z,2022-11-23T12:02:01Z,"@jasonhe88 Thanks for your feedback. You're right that's a bug which caused by Kvrocks return the inconsistent string with Redis.

The expected result is the bulk string(`$40\r\n{SHA}\r\n`) but returned the simple string(`+{SHA}\r\n`) instead. Refer: https://github.com/apache/incubator-kvrocks/blame/unstable/src/commands/redis_cmd.cc#L5036","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5O-SsV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1132,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5O-aEL,kvrocks,1324982539,1132,NA,jasonhe88,6936520,,alenhe@hotmail.com,NA,2022-11-23T12:24:23Z,2022-11-23T12:24:23Z,"thank you for your quick response

is there any workaround to resolve this issue?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5O-aEL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1132,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5O-qOP,kvrocks,1325048719,1132,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-23T13:14:56Z,2022-11-23T13:14:56Z,"@jasonhe88 Are you using `phpredis`? if yes, you can workaround by using the `raw` command and enable the OPT_REPLY_LITERAL option to send the `script load` which will parse the simple string as a string(except in the pipeline or multi mode): https://github.com/phpredis/phpredis/blob/b580505b40ef8b182ca79d49cda38c7d1ea9b5c7/redis.c#L3070


For the raw command, you can have a look at: https://github.com/phpredis/phpredis#rawcommand

For the bug fix can see: #1133 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5O-qOP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1132,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5O_i-B,kvrocks,1325281153,1132,NA,jasonhe88,6936520,,alenhe@hotmail.com,NA,2022-11-23T15:44:29Z,2022-11-23T15:44:29Z,"Get it, Thank you so much!
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5O_i-B/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1135,https://api.github.com/repos/apache/kvrocks/issues/1135,kvrocks,1463074141,1135,Check source code of kvrocks2redis by clang-tidy,PragmaTwice,20042607,Twice,,CLOSED,2022-11-24T09:56:44Z,2022-12-27T03:19:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As currently we run clang-tidy in CI to check source code of kvrocks (`src/*.cc`),  we can also add source code of kvrocks2redis as the input of clang-tidy.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1135/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1136,https://api.github.com/repos/apache/kvrocks/issues/1136,kvrocks,1463085127,1136,Fuzzing on kvrocks!,PragmaTwice,20042607,Twice,,OPEN,2022-11-24T10:03:37Z,2022-11-24T10:36:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We can perform some fuzz testing (specifically, some coverage-guided grey-box fuzzing, like libfuzzer or afl++) on kvrocks to ensure the robustness and stability of kvrocks and try to find more bugs via an automated way.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1136/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1138,https://api.github.com/repos/apache/kvrocks/issues/1138,kvrocks,1463470417,1138,Split commands/redis_cmd.cc to multiple source files,PragmaTwice,20042607,Twice,,CLOSED,2022-11-24T14:58:33Z,2023-02-05T03:01:44Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

`redis_cmd.cc` is becoming increasingly large, and it might be more organized to split it into multiple source files (or, translation units) by some sort of classification.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1138/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/1146,kvrocks,1466521748,1146,Docker container exits with code 132 and no output,SamSpiri,281731,Simon Spiridonov,,CLOSED,2022-11-28T14:22:07Z,2023-07-21T06:54:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

Ubuntu 20.04.1 LTS \n \l
Linux home 5.4.0-122-generic #138-Ubuntu SMP Wed Jun 22 15:00:31 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux
Docker version 19.03.5, build 633a0ea838

docker image apache/kvrocks:2.2.0

### Minimal reproduce step

$ docker run -i --rm apache/kvrocks:2.2.0
$ echo $?
132


### What did you expect to see?

1. Output logs with the reason why kvrocks exited
2. Kvrocks don't exit but works

### What did you see instead?

no logs, no output, just exit 132

### Anything Else?

tried tags nightly, 2.1.0 with same bad result.
but kvrocks/kvrocks:latest image did output version number and worked until i triggered CTRL-C:
```
$ docker run -i --rm kvrocks/kvrocks
Version: 2.0.6 @4e5883e9
^C
```


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1146/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5POrN5,kvrocks,1329247097,1146,NA,PragmaTwice,20042607,Twice,,NA,2022-11-28T14:56:29Z,2022-11-28T14:56:29Z,"Hi, I am afraid kvrocks aborted due to the `Illegal Instruction` (128 + 4) signal, that is, the kvrocks executable binary in the docker image uses some instruction sets which is not supported by your cpu (in x64, it may be avx512 or something, you can use gdb to determine the concrete instruction which leads to termination).

I will investigate this problem, and you can build kvrocks on your local device to avoid this problem. (or build the docker image on your local.)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5POrN5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PPfWs,kvrocks,1329460652,1146,NA,SamSpiri,281731,Simon Spiridonov,,NA,2022-11-28T17:16:51Z,2022-11-28T17:16:51Z,"> not supported by your cpu 

I tried on intel and it also worked until i triggered CTRL-C,
but it didn't produce any output while running and then before exiting it prints all the logs.
That's my main concern, because i have no logs of kvrocks in my kubernetes.
```
$ docker run -i --rm apache/kvrocks:2.2.0
^CI20221128 17:10:47.559381     1 main.cc:306] kvrocks version 2.2.0 @17b31e7
I20221128 17:10:47.606953     1 storage.cc:326] [storage] Success to load the data from disk: 21 ms
I20221128 17:10:47.608379     1 worker.cc:67] [worker] Listening on: 0.0.0.0:6666
I20221128 17:10:47.608695     1 worker.cc:67] [worker] Listening on: 0.0.0.0:6666
I20221128 17:10:47.608955     1 worker.cc:67] [worker] Listening on: 0.0.0.0:6666
I20221128 17:10:47.609221     1 worker.cc:67] [worker] Listening on: 0.0.0.0:6666
I20221128 17:10:47.609475     1 worker.cc:67] [worker] Listening on: 0.0.0.0:6666
I20221128 17:10:47.609719     1 worker.cc:67] [worker] Listening on: 0.0.0.0:6666
I20221128 17:10:47.609954     1 worker.cc:67] [worker] Listening on: 0.0.0.0:6666
I20221128 17:10:47.610208     1 worker.cc:67] [worker] Listening on: 0.0.0.0:6666
I20221128 17:10:47.610711     1 worker.cc:483] [worker] Thread #140263785711360 started
I20221128 17:10:47.610746     1 worker.cc:483] [worker] Thread #140263794104064 started
I20221128 17:10:47.610776     1 worker.cc:483] [worker] Thread #140263802496768 started
I20221128 17:10:47.610828     1 worker.cc:483] [worker] Thread #140263878031104 started
I20221128 17:10:47.610872     1 worker.cc:483] [worker] Thread #140263869638400 started
I20221128 17:10:47.610915     1 worker.cc:483] [worker] Thread #140263861245696 started
I20221128 17:10:47.610956     1 worker.cc:483] [worker] Thread #140263852852992 started
I20221128 17:10:47.610994     1 worker.cc:483] [worker] Thread #140263844460288 started
I20221128 17:10:47.611133     1 server.cc:190] Ready to accept connections
I20221128 17:10:49.275743     1 main.cc:59] Bye Bye
```

Previously it crashed on the old AMD:
```
vendor_id	: AuthenticAMD
cpu family	: 21
model		: 48
model name	: AMD Athlon(tm) X4 860K Quad Core Processor
stepping	: 1
microcode	: 0x6003106
cpu MHz		: 1792.078
cache size	: 2048 KB
physical id	: 0
siblings	: 4
core id		: 3
cpu cores	: 2
apicid		: 19
initial apicid	: 3
fpu		: yes
fpu_exception	: yes
cpuid level	: 13
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good nopl nonstop_tsc cpuid extd_apicid aperfmperf pni pclmulqdq monitor ssse3 fma cx16 sse4_1 sse4_2 popcnt aes xsave avx f16c lahf_lm cmp_legacy svm extapic cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw ibs xop skinit wdt lwp fma4 tce nodeid_msr tbm topoext perfctr_core perfctr_nb bpext ptsc cpb hw_pstate ssbd vmmcall fsgsbase bmi1 xsaveopt arat npt lbrv svm_lock nrip_save tsc_scale vmcb_clean flushbyasid decodeassists pausefilter pfthreshold overflow_recov
bugs		: fxsave_leak sysret_ss_attrs null_seg spectre_v1 spectre_v2 spec_store_bypass
bogomips	: 7386.96
TLB size	: 1536 4K pages
clflush size	: 64
cache_alignment	: 64
address sizes	: 48 bits physical, 48 bits virtual
power management: ts ttp tm 100mhzsteps hwpstate cpb eff_freq_ro [13]
```


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PPfWs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PRj4N,kvrocks,1330003469,1146,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-29T02:46:50Z,2022-11-29T02:46:50Z,"@SamSpiri You can run `docker run -it --rm -p 6666:6666 apache/kvrocks:2.2.0` that specified the `-t` option to allocate a pseudo-TTY, then you should see the output if all goes smoothly.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PRj4N/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PTd7Q,kvrocks,1330503376,1146,NA,SamSpiri,281731,Simon Spiridonov,,NA,2022-11-29T11:46:38Z,2022-11-29T11:46:38Z,"yep! with tty all goes smoothly.
It also worked for me in Kubernetes, now i get logs from the start. I just added one line ""tty: true"":
```
apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ include ""app.fullname"" . }}-kvrocks
spec:
  replicas: 1
  selector:
    matchLabels:
      app.kubernetes.io/name: {{ include ""app.fullname"" . }}-kvrocks
  template:
    metadata:
      labels:
        app.kubernetes.io/name: {{ include ""app.fullname"" . }}-kvrocks
    spec:
      containers:
        - name: kvrocks
          image: {{ .Values.kvrocks.image }}
          tty: true
          ports:
            - containerPort: 8888
          resources:
            {{- toYaml .Values.kvrocks.resources | nindent 12 }}
          command:
            - /bin/sh
            - -c
            - |-
                cd /kvrocks
                cp conf/kvrocks.conf /tmp
                [ ! -z ""$REDIS_AUTH"" ] && sed -i -r ""s/^(# )?requirepass.*/requirepass $REDIS_AUTH/"" conf/kvrocks.conf
                [ ! -z ""$WRITE_BUFFER_SIZE"" ] && sed -i -r ""s/^(# )?rocksdb.write_buffer_size.*/rocksdb.write_buffer_size $WRITE_BUFFER_SIZE/"" conf/kvrocks.conf
                exec ./bin/kvrocks -c ./conf/kvrocks.conf
          env:
            - name: WRITE_BUFFER_SIZE
              value: ""{{ .Values.kvrocks.write_buffer_size }}""
            - name: REDIS_AUTH
              value: ""...""
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PTd7Q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PT548,kvrocks,1330617916,1146,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-11-29T13:00:18Z,2022-11-29T13:00:18Z,"Cool, I will close this issue if no further discussion.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PT548/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h1hCC,kvrocks,1641418882,1146,NA,ovaistariq,1632658,Ovais Tariq,ot@tigrisdata.com,NA,2023-07-19T05:09:44Z,2023-07-19T05:09:44Z,"The nightly build of kvrocks crashes for me on AMD system. 

```
/ # kvrocks -c /conf/kvrocks.conf
Illegal instruction (core dumped)
/ #
command terminated with exit code 132
```

cpuinfo can be found below

```
vendor_id	: AuthenticAMD
cpu family	: 25
model		: 1
model name	: AMD EPYC
stepping	: 1
microcode	: 0x1000065
cpu MHz		: 2450.000
cache size	: 512 KB
physical id	: 0
siblings	: 2
core id		: 0
cpu cores	: 2
apicid		: 0
initial apicid	: 0
fpu		: yes
fpu_exception	: yes
cpuid level	: 16
wp		: yes
flags		: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx mmxext fxsr_opt pdpe1gb rdtscp lm constant_tsc rep_good nopl nonstop_tsc cpuid tsc_known_freq pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm cmp_legacy svm cr8_legacy abm sse4a misalignsse 3dnowprefetch osvw topoext perfctr_core invpcid_single ssbd ibrs ibpb stibp vmmcall fsgsbase tsc_adjust bmi1 avx2 smep bmi2 invpcid rdseed adx smap clflushopt clwb sha_ni xsaveopt xsavec xgetbv1 xsaves clzero xsaveerptr wbnoinvd arat npt nrip_save umip pku ospke vaes vpclmulqdq rdpid
bugs		: sysret_ss_attrs null_seg spectre_v1 spectre_v2 spec_store_bypass
bogomips	: 4900.00
TLB size	: 2560 4K pages
clflush size	: 64
cache_alignment	: 64
address sizes	: 48 bits physical, 48 bits virtual
power management:
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h1hCC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h1l65,kvrocks,1641438905,1146,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-19T05:31:10Z,2023-07-19T05:31:10Z,"Hi @ovaistariq, thanks for your feedback.

I guess it may be caused by this PR https://github.com/apache/kvrocks/pull/1516 disable the rocksdb portable option. Would you like to have a try at 2.4.0? if it works, this issue should be introduced by the previous PR.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h1l65/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h51GR,kvrocks,1642549649,1146,NA,ovaistariq,1632658,Ovais Tariq,ot@tigrisdata.com,NA,2023-07-19T18:20:34Z,2023-07-19T18:20:34Z,2.5.0 works fine. So I believe the issue is introduced after 2.5.0?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h51GR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h7csa,kvrocks,1642973978,1146,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-20T01:31:26Z,2023-07-20T01:31:26Z,"@ovaistariq Maybe, but I cannot figure out which PR may introduce this issue except #1516(included in 2.5.0). Need to dive into it later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h7csa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8Rl4,kvrocks,1643190648,1146,NA,ovaistariq,1632658,Ovais Tariq,ot@tigrisdata.com,NA,2023-07-20T05:00:39Z,2023-07-20T05:00:39Z,@git-hulk it could be related to the PORTABLE flag. So I can try building a running a binary built with `PORTABLE=1`,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8Rl4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8Ysx,kvrocks,1643219761,1146,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-20T05:18:19Z,2023-07-20T05:18:19Z,"Yes, we disable this option after #1516, but I'm still confused why 2.5.0 works well.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8Ysx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8Ze-,kvrocks,1643222974,1146,NA,ovaistariq,1632658,Ovais Tariq,ot@tigrisdata.com,NA,2023-07-20T05:20:13Z,2023-07-20T05:20:13Z,Then it could be another change introduced since 2.5.0,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8Ze-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDHqs,kvrocks,1644985004,1146,NA,ovaistariq,1632658,Ovais Tariq,ot@tigrisdata.com,NA,2023-07-21T05:02:46Z,2023-07-21T05:02:46Z,@git-hulk building the binary with `PORTABLE=1` fixes the issue and I no longer see a crash on AMD systems.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDHqs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDJD9,kvrocks,1644990717,1146,NA,ovaistariq,1632658,Ovais Tariq,ot@tigrisdata.com,NA,2023-07-21T05:10:42Z,2023-07-21T05:10:42Z,"Given the changes [here](https://github.com/facebook/rocksdb/pull/11419/files), I think it is best for the docker image build to be portable.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDJD9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDJt7,kvrocks,1644993403,1146,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-21T05:14:51Z,2023-07-21T05:14:51Z,"> Given the changes [here](https://github.com/facebook/rocksdb/pull/11419/files), I think it is best for the docker image build to be portable.

Hi @ovaistariq, huge thanks for your investigation. I think it makes a lot to enable the portable in the docker image. Would you like to submit the PR to fix this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDJt7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDbdH,kvrocks,1645066055,1146,NA,ovaistariq,1632658,Ovais Tariq,ot@tigrisdata.com,NA,2023-07-21T06:47:48Z,2023-07-21T06:47:48Z,"Sure, I would be happy to submit a PR","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDbdH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDb7u,kvrocks,1645068014,1146,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-21T06:50:05Z,2023-07-21T06:50:05Z,"Great, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDb7u/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1146,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDc8f,kvrocks,1645072159,1146,NA,ovaistariq,1632658,Ovais Tariq,ot@tigrisdata.com,NA,2023-07-21T06:54:38Z,2023-07-21T06:54:38Z,@git-hulk here you go: https://github.com/apache/kvrocks/pull/1602,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iDc8f/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1147,https://api.github.com/repos/apache/kvrocks/issues/1147,kvrocks,1470875359,1147,Move use cases to the website repo,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-12-01T08:15:10Z,2022-12-16T13:59:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Use cases and images should be moved to https://github.com/apache/incubator-kvrocks-website, and remove the `docs` folder.

Also, add a document for how to submit use cases (logos) so that we don't have to manually maintain https://github.com/apache/incubator-kvrocks/issues/414.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1147/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1147,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QwXW8,kvrocks,1354855868,1147,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-12-16T13:59:59Z,2022-12-16T13:59:59Z,"Closed as done.

* https://github.com/apache/incubator-kvrocks-website/pull/29
* https://github.com/apache/incubator-kvrocks-website/pull/30
* https://github.com/apache/incubator-kvrocks/pull/1181","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QwXW8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1148,https://api.github.com/repos/apache/kvrocks/issues/1148,kvrocks,1470876325,1148,Move VERSION file to src folder,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-12-01T08:15:55Z,2022-12-02T04:07:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Move `VERSION` file to `src` folder, so that we have a tidy root layout.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1148/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1148,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PecU1,kvrocks,1333380405,1148,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-12-01T08:16:35Z,2022-12-01T08:16:35Z,"You should correspondingly update the build logic to fulfill VERSION information, including those in `x.py` and `CMakeList.txt`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5PecU1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1148,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Pfpbv,kvrocks,1333696239,1148,NA,PragmaTwice,20042607,Twice,,NA,2022-12-01T12:29:09Z,2022-12-01T12:29:09Z,"Actually I have some doubt about this proposal. In my view, the `VERSION` file is not a source file, which seems not proper to be placed into the `src` directory.

We can see the CI failed when someone try to move this file to `src` in #1149, whose reason is quite funny: there is a header named `version` in the C++ standard, and the move cause compiler to find wrong header and fail to compile.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Pfpbv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1150,https://api.github.com/repos/apache/kvrocks/issues/1150,kvrocks,1472284935,1150,Cannot start kvrocks after rewriting config,PragmaTwice,20042607,Twice,,CLOSED,2022-12-02T04:11:14Z,2022-12-02T07:08:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

1. start kvrocks
2. rewrite
3. stop kvrocks and restart

### What did you expect to see?

success

### What did you see instead?

kvrocks failed to restart due to error in parsing configuration: unixsocketperm

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1150/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1157,https://api.github.com/repos/apache/kvrocks/issues/1157,kvrocks,1474623659,1157,Add the compatible Redis version to the info command,xiaobiaozhao,52393536,xiaobiaozhao,,CLOSED,2022-12-04T09:06:23Z,2022-12-06T16:48:37Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Hello! we are trying to use the Redis spark connector and found this possible issue:
Here, the Redis version is reported as version:
[incubator-kvrocks/src/server.cc](https://github.com/apache/incubator-kvrocks/blob/81d37927dfb2798138c8569af7c6a44dd376c3f4/src/server.cc#L783)

Line 783 in [81d3792](https://github.com/apache/incubator-kvrocks/commit/81d37927dfb2798138c8569af7c6a44dd376c3f4)

 string_stream << ""version:"" << VERSION << ""\r\n""; 

But the Redis client expects a redis_version instead
https://github.com/RedisLabs/spark-redis/blob/master/src/main/scala/com/redislabs/provider/redis/RedisConfig.scala#L229
Apparently, for that reason, it is not able to connect.

### Solution

```c++
string_stream << ""version:"" << VERSION << ""\r\n""; 
string_stream << ""redis_version:"" << REDIS_VERSION << ""\r\n"";  // 4.0
string_stream << ""kvrocks_version:"" << VERSION << ""\r\n""; 
```

Keep the original `version` for compatible with the old kvrocks versions
New `redis_version` for other drivers to recognize redis version
New `kvrocks_version` for new directives of kvrocks that redis does not have


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1157/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1161,https://api.github.com/repos/apache/kvrocks/issues/1161,kvrocks,1476865603,1161,Inconsistent NOSCRIPT error reply in the eval command ,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-12-05T15:53:57Z,2022-12-06T01:53:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

As mentioned in https://github.com/apache/incubator-kvrocks/issues/485#issuecomment-1145563442, Redis will reply `NOSCRIPT No matching script. Please use EVAL` error, but Kvrocks will append an `ERR` as its prefix. And it will cause a compatible issue in some cases like go-redis will use this error message to determine the next step. 

### Minimal reproduce step

```
redis-cli > evalsha 123 0
```


### What did you expect to see?

got an error `NOSCRIPT No matching script. Please use EVAL`

### What did you see instead?

got an error `ERR NOSCRIPT No matching script. Please use EVAL`

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1161/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1163,https://api.github.com/repos/apache/kvrocks/issues/1163,kvrocks,1478135418,1163,kvrocks 是否有支持json计划,simplechen,54672,simplechen,3gwind@gmail.com,CLOSED,2022-12-06T04:10:42Z,2022-12-06T04:15:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

打扰一下，kvrocks是否有类似rejson的功能 支持计划，打扰了

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1163/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1165,https://api.github.com/repos/apache/kvrocks/issues/1165,kvrocks,1479110757,1165,Flaky test TestReplicationWithLimitSpeed,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2022-12-06T13:26:57Z,2022-12-06T13:27:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


TestReplicationWithLimitSpeed failed with https://github.com/apache/incubator-kvrocks/actions/runs/3629440428/jobs/6121764256#step:12:152

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1165/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1168,https://api.github.com/repos/apache/kvrocks/issues/1168,kvrocks,1480894795,1168,Support deleting old logs by day,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-12-07T04:21:03Z,2022-12-21T10:49:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, Kvrocks didn't have a way to auto-delete old logs which may occupy the disk capacity, so it'd be better to offer a way to keep recent logs only. 


related discussion: https://github.com/apache/incubator-kvrocks/discussions/1167

### Solution

We can do it by simply adding a configuration to enable or disable it since the glog has already supported removing old logs.

https://github.com/google/glog/blob/c18db3903b9f0abd80ae740fde94f7e32aa40b92/README.rst#automatically-remove-old-logs

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1168/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1168,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5P-r-a,kvrocks,1341833114,1168,NA,IoCing,39056297,IoCing,,NA,2022-12-08T01:12:12Z,2022-12-08T01:12:12Z,I would like to work on it !,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5P-r-a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1168,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5P-0BY,kvrocks,1341866072,1168,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-08T01:59:57Z,2022-12-08T01:59:57Z,"Thanks @IoCing, assigned","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5P-0BY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1170,https://api.github.com/repos/apache/kvrocks/issues/1170,kvrocks,1484035465,1170,SLAVEOF command may block a long time,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2022-12-08T08:26:38Z,2022-12-12T14:30:14Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.2.0

### Minimal reproduce step

1. `echo 6 > /proc/sys/net/ipv4/tcp_syn_retries`
2. `SLAVEOF` a non-routable IP address(such as `10.255.255.1`)
3. `SLAVEOF new_master_ip port`

### What did you expect to see?

Step 3 should not block for a long time because we are switching to the new master, which should be a quick operation.

### What did you see instead?

Step 3 will block a long time(**> 2min** based on above reproduced scenario)

### Anything Else?

This is because we use blocking IO when use socket [connect(2)](https://man7.org/linux/man-pages/man2/connect.2.html). In some cases, `connect(2)` will be blocked for a long time.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1170/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1170,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBlF2,kvrocks,1342591350,1170,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-08T11:44:06Z,2022-12-08T11:44:06Z,"@caipengbo I think the root cause is we didn't set a timeout for the connect operation, so it will backoff retransmit the syn packet(1s,2s,4s,8s,16s,32s,64s) until reaching the `tcp_syn_retries`(default is 6 for most Linux distro).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBlF2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1170,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBmiL,kvrocks,1342597259,1170,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-12-08T11:46:43Z,2022-12-08T11:46:43Z,"> @caipengbo I think the root cause is we didn't set a timeout for the connect operation, so it will backoff retransmit the sync packet(1s,2s,4s,8s,16s,32s,64s) until reaching the tcp_syn_retries(default is 6 for most Linux distro). 

Yes, we should add a timeout.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBmiL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1170,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBm3Y,kvrocks,1342598616,1170,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-08T11:47:20Z,2022-12-08T11:47:20Z,"Cool, got it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBm3Y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1170,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBtOW,kvrocks,1342624662,1170,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2022-12-08T12:03:20Z,2022-12-08T12:03:20Z,"Let's set it a little longer than 3 seconds, so we can tolerate 2 times lost sync packages? @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBtOW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1170,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBto4,kvrocks,1342626360,1170,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-08T12:04:28Z,2022-12-08T12:04:28Z,"Yes, sounds good to me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QBto4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1180,https://api.github.com/repos/apache/kvrocks/issues/1180,kvrocks,1496100896,1180,Kvrocks sets record in all open DB instances instead of only in one,vhrtanek,3843071,,,CLOSED,2022-12-14T08:55:11Z,2022-12-18T06:14:11Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

kvrocks:
  Kvrocks 2.2.0

OS:
  macOS Monterey 12.5.1

Python: 
  Python 3.7

Python modules:
  apache-beam==2.42.0
  confluent-kafka==1.9.2
  redis==4.3.4

Flink cluster:
  Flink 1.14.0


### Minimal reproduce step

I am utilizing apache beam pipeline, which reads data from kafka, does simple transformations, and writes data into kvrocks via redis module. The problem is that the same record is written to all defined connections regardless of different message formats or that some kvrocks connection is commented out e.g. `r_db_hub` like in the example below

Here is simplified py script, reproducibility won't be really possible, but i hope you will get an idea

```
import apache_beam as beam
import redis
import confluent_kafka

#r_db_hub = redis.Redis(host='localhost', port=6666, db=0)
r_db_sat = redis.Redis(host='localhost', port=6666, db=1)
r_db_lnk = redis.Redis(host='localhost', port=6666, db=2)

link_topic = p | 'Read link topic' >> ReadFromKafka(
    consumer_config=config_read,
    max_num_records=2,
    topics=['TEST_TOPIC'])

des_msg_link = link_topic | 'Deserialize link' >> beam.ParDo(
    BeamDeSerializeAvro('TEST_TOPIC-value', schema_registry_read_client)) | 'Add key to link' >> beam.ParDo(
    CreateLinkKey())

des_msg_link | 'Transform and save link satellite' >> beam.ParDo(
    WriteLinkSatToRedis()) 
    
des_msg_link | 'Transform and save link' >> beam.ParDo(
  WriteLinkToRedis()) 
  
```

### What did you expect to see?

I expect to see two different records saved in two different DB based on these connection settings:

```
r_db_sat = redis.Redis(host='localhost', port=6666, db=1)
r_db_lnk = redis.Redis(host='localhost', port=6666, db=2)
```

also, no record save in `r_db_hub` since it's commented out.

### What did you see instead?

I see the same record in all the databases. Like this

```
------------------------------------------------------------
LINKS
------------------------------------------------------------
b'{""HKEY"": ""6512bd43d9caa6e02c990b0a82652dca"", ""LAST_MODIFIED_TIMESTAMP"": ""2022-09-13 08:15:25.410000+00:00"", ""SAT_COLUMN_7"": ""1"", ""SAT_COLUMN_6"": ""1"", ""SAT_COLUMN_5"": ""1"", ""SAT_COLUMN_4"": ""1"", ""SAT_COLUMN_3"": ""1"", ""SAT_COLUMN_2"": ""1"", ""SAT_COLUMN_1"": ""1"", ""SOURCE"": ""SYN_S2V_SOURCE_LINK_TEST"", ""HASHDIFF"": ""7fa8282ad93047a4d6fe6111c93b308a""}'
b'{""HKEY"": ""b6d767d2f8ed5d21a44b0e5886680cb9"", ""LAST_MODIFIED_TIMESTAMP"": ""2022-09-14 13:27:49.518000+00:00"", ""SAT_COLUMN_7"": ""2"", ""SAT_COLUMN_6"": ""2"", ""SAT_COLUMN_5"": ""2"", ""SAT_COLUMN_4"": ""2"", ""SAT_COLUMN_3"": ""2"", ""SAT_COLUMN_2"": ""2"", ""SAT_COLUMN_1"": ""2"", ""SOURCE"": ""SYN_S2V_SOURCE_LINK_TEST"", ""HASHDIFF"": ""79d886010186eb60e3611cd4a5d0bcae""}'
------------------------------------------------------------
HUBS
------------------------------------------------------------
b'{""HKEY"": ""6512bd43d9caa6e02c990b0a82652dca"", ""LAST_MODIFIED_TIMESTAMP"": ""2022-09-13 08:15:25.410000+00:00"", ""SAT_COLUMN_7"": ""1"", ""SAT_COLUMN_6"": ""1"", ""SAT_COLUMN_5"": ""1"", ""SAT_COLUMN_4"": ""1"", ""SAT_COLUMN_3"": ""1"", ""SAT_COLUMN_2"": ""1"", ""SAT_COLUMN_1"": ""1"", ""SOURCE"": ""SYN_S2V_SOURCE_LINK_TEST"", ""HASHDIFF"": ""7fa8282ad93047a4d6fe6111c93b308a""}'
b'{""HKEY"": ""b6d767d2f8ed5d21a44b0e5886680cb9"", ""LAST_MODIFIED_TIMESTAMP"": ""2022-09-14 13:27:49.518000+00:00"", ""SAT_COLUMN_7"": ""2"", ""SAT_COLUMN_6"": ""2"", ""SAT_COLUMN_5"": ""2"", ""SAT_COLUMN_4"": ""2"", ""SAT_COLUMN_3"": ""2"", ""SAT_COLUMN_2"": ""2"", ""SAT_COLUMN_1"": ""2"", ""SOURCE"": ""SYN_S2V_SOURCE_LINK_TEST"", ""HASHDIFF"": ""79d886010186eb60e3611cd4a5d0bcae""}'
------------------------------------------------------------
SAT
------------------------------------------------------------
b'{""HKEY"": ""6512bd43d9caa6e02c990b0a82652dca"", ""LAST_MODIFIED_TIMESTAMP"": ""2022-09-13 08:15:25.410000+00:00"", ""SAT_COLUMN_7"": ""1"", ""SAT_COLUMN_6"": ""1"", ""SAT_COLUMN_5"": ""1"", ""SAT_COLUMN_4"": ""1"", ""SAT_COLUMN_3"": ""1"", ""SAT_COLUMN_2"": ""1"", ""SAT_COLUMN_1"": ""1"", ""SOURCE"": ""SYN_S2V_SOURCE_LINK_TEST"", ""HASHDIFF"": ""7fa8282ad93047a4d6fe6111c93b308a""}'
b'{""HKEY"": ""b6d767d2f8ed5d21a44b0e5886680cb9"", ""LAST_MODIFIED_TIMESTAMP"": ""2022-09-14 13:27:49.518000+00:00"", ""SAT_COLUMN_7"": ""2"", ""SAT_COLUMN_6"": ""2"", ""SAT_COLUMN_5"": ""2"", ""SAT_COLUMN_4"": ""2"", ""SAT_COLUMN_3"": ""2"", ""SAT_COLUMN_2"": ""2"", ""SAT_COLUMN_1"": ""2"", ""SOURCE"": ""SYN_S2V_SOURCE_LINK_TEST"", ""HASHDIFF"": ""79d886010186eb60e3611cd4a5d0bcae""}'
------------------------------------------------------------
```


### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1180/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1180,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QgbXd,kvrocks,1350677981,1180,NA,PragmaTwice,20042607,Twice,,NA,2022-12-14T09:05:02Z,2022-12-14T09:05:02Z,"Hi, thanks for your issue.

Kvrocks does not support Redis logical database selection.

Instead, Kvrocks provides a similiar feature named `namespace`, where you can check out the document to learn how to use it: https://kvrocks.apache.org/docs/namespace

It performs more functional selection and isolation rather than Redis `SELECT`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QgbXd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1180,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Qgd_7,kvrocks,1350688763,1180,NA,PragmaTwice,20042607,Twice,,NA,2022-12-14T09:11:52Z,2022-12-14T09:11:52Z,"Same as #492. 

Feel free to ask if you have more questions, otherwise I will close this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Qgd_7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1180,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QgkKH,kvrocks,1350713991,1180,NA,vhrtanek,3843071,,,NA,2022-12-14T09:26:10Z,2022-12-14T09:26:10Z,"Thanks for a quick reply, I'll check it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QgkKH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1180,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QgywU,kvrocks,1350773780,1180,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-14T10:02:31Z,2022-12-14T10:02:31Z,"@vhrtanek As twice mentioned, the select DB command has no effect in Kvrocks, just for compatibility with Redis clients. Can use the namespace instead if you want to use multi databases, it's totally the same as the Redis DB except for each namespace has its password.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QgywU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1180,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QhL7j,kvrocks,1350876899,1180,NA,vhrtanek,3843071,,,NA,2022-12-14T10:43:27Z,2022-12-14T10:43:27Z,"Thanks again for navigating me in the right direction. I need to interact with kvrocks via python and `redis` module, therefor I don't know if cli implementation would be sufficient for me, but if I understood correctly `redis-namespace` module does exactly the same as what kvrocks namespaces.
  


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QhL7j/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1180,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Qhanp,kvrocks,1350937065,1180,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-14T11:00:01Z,2022-12-14T11:00:01Z,"> I need to interact with kvrocks via python and redis module, therefor I don't know if cli implementation would be sufficient for me

Yes, using any python client is ok

> if I understood correctly redis-namespace module does exactly the same as what kvrocks namespaces

Yes, Kvrocks also uses the namespace prefix to isolate data between namespaces, some difference is Kvrocks can have its password/stats for each namespace.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Qhanp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1180,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QiFlG,kvrocks,1351113030,1180,NA,PragmaTwice,20042607,Twice,,NA,2022-12-14T11:42:23Z,2022-12-14T11:42:23Z,"> Thanks again for navigating me in the right direction. I need to interact with kvrocks via python and `redis` module, therefor I don't know if cli implementation would be sufficient for me

I think you can use some general command executing API in the client library if it has no direct API to do so, e.g. `redis.execute_command(""namespace"", ...)` rather than `redis.namespace_XXX(...)`

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5QiFlG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1182,https://api.github.com/repos/apache/kvrocks/issues/1182,kvrocks,1500441629,1182,SockConnect with timeout doesn't support resolve domain,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-12-16T15:35:49Z,2022-12-17T10:27:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

1. Start Kvrocks serverA and serverB on the same machine
2. Server A becomes the slave of serverB with localhost domain


### What did you expect to see?

It's ok to use the domain(local) to connect the master

### What did you see instead?

Cannot connect to the master, related issue also can see： https://github.com/apache/incubator-kvrocks/discussions/1178

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1182/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1182,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Qxe6b,kvrocks,1355148955,1182,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-16T16:07:13Z,2022-12-16T16:07:13Z,Many thanks for @juancrescente reporting this issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Qxe6b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1185,https://api.github.com/repos/apache/kvrocks/issues/1185,kvrocks,1501144230,1185,Tracking issue for releasing convenient binary,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-12-17T03:31:16Z,2023-02-14T14:25:11Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Kvrocks previously released DEB and RPM installers. But as we gradually learn how to do Apache release, we skip this step for 2.1.0 and 2.2.0. Now it's time to bring these convenient binary artifacts back.

Also, we release Docker images for each release, but it's not automated or documented. To enable every RM to perform the same releases, we should update it.

### Solution

* [x] #1186
* [x] #1187
* [x] #1188

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1185/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1185,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VOXnq,kvrocks,1429830122,1185,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-02-14T14:25:11Z,2023-02-14T14:25:11Z,Closed as all subtasks done.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VOXnq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1186,https://api.github.com/repos/apache/kvrocks/issues/1186,kvrocks,1501144356,1186,Document how to release Docker images and add automation,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-12-17T03:31:20Z,2023-02-14T14:24:59Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1186/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1186,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VOXi8,kvrocks,1429829820,1186,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-02-14T14:24:58Z,2023-02-14T14:24:58Z,Closed by https://github.com/apache/incubator-kvrocks-website/pull/50,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VOXi8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1187,https://api.github.com/repos/apache/kvrocks/issues/1187,kvrocks,1501144439,1187,Document how to release the RPM installer,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-12-17T03:31:22Z,2022-12-26T15:57:30Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1187/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1187,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Q0yar,kvrocks,1356015275,1187,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-12-17T03:57:26Z,2022-12-17T03:57:26Z,"https://github.com/apache/incubator-kvrocks/discussions/1152#discussioncomment-4297513

@PragmaTwice I read this sentence. If we don't release it, we may remove the related code from `x.py`. But we may try to find a (lazy) consensus first. Give me some time to think of it, lol.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Q0yar/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1187,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RYDYF,kvrocks,1365259781,1187,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-12-26T15:57:30Z,2022-12-26T15:57:30Z,"Closed. We don't support installer binary release. It causes more issues than benefits.

See https://github.com/apache/incubator-kvrocks/issues/1187#issuecomment-1356015275 and https://gist.github.com/tiran/2dec9e03c6f901814f6d1e8dad09528e.

Pending to create a patch to remove the rpm packaging logic in `x.py`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RYDYF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1188,https://api.github.com/repos/apache/kvrocks/issues/1188,kvrocks,1501144524,1188,Document how to release the DEB installer and add automation,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2022-12-17T03:31:25Z,2022-12-26T15:57:04Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1188/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1188,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RYDV5,kvrocks,1365259641,1188,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2022-12-26T15:57:03Z,2022-12-26T15:57:03Z,"Closed. We don't support installer binary release. It causes more issues than benefits.

See https://github.com/apache/incubator-kvrocks/issues/1187#issuecomment-1356015275 and https://gist.github.com/tiran/2dec9e03c6f901814f6d1e8dad09528e.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RYDV5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1194,https://api.github.com/repos/apache/kvrocks/issues/1194,kvrocks,1501757304,1194,The replication thread core dump when stopping the thread,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2022-12-18T05:33:47Z,2022-12-18T12:55:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/incubator-kvrocks/actions/runs/3719371631/jobs/6308230988#step:12:138

### What did you expect to see?

CI runs with green status

### What did you see instead?

Core dump when stopping the server

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1194/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1196,https://api.github.com/repos/apache/kvrocks/issues/1196,kvrocks,1501943524,1196,Fix all unused-return-value warnings for Status,PragmaTwice,20042607,Twice,,CLOSED,2022-12-18T15:31:46Z,2023-01-02T18:43:15Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

After #1193, we have lots of warnings in building kvrocks, since some of code discard the return value of Status or StatusOr.

We need fix them all, and then make it a compile error instead of a warning.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1196/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1202,https://api.github.com/repos/apache/kvrocks/issues/1202,kvrocks,1507343440,1202,Failed test case in CI: TestSlotMigrateThreeNodes,PragmaTwice,20042607,Twice,,OPEN,2022-12-22T06:33:12Z,2022-12-22T06:33:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/incubator-kvrocks/actions/runs/3749755928/jobs/6368682143#step:12:158

### What did you expect to see?

pass

### What did you see instead?

fail

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1202/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1204,https://api.github.com/repos/apache/kvrocks/issues/1204,kvrocks,1508055365,1204,Add disablelogclean command to close ,IoCing,39056297,IoCing,,CLOSED,2022-12-22T15:10:47Z,2022-12-22T16:03:24Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

At present, we can enable logclean by configuring log-retention-days. but we can't disable logclean except reboot with  set log-retention-days to -1

### Solution

we can add a new command to disable logclean by calling `google::DisableLogCleaner()`.
we also can add more options to dynamically configure log-retention-day.


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1204/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1204,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RPY9b,kvrocks,1362988891,1204,NA,PragmaTwice,20042607,Twice,,NA,2022-12-22T15:43:23Z,2022-12-22T15:43:23Z,"Maybe I made an oversight during the code review of #1171, since I thought that the previous PR was able to do this by sending `config set log-retention-days -1` from a kvrocks client.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RPY9b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1204,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RPdxN,kvrocks,1363008589,1204,NA,IoCing,39056297,IoCing,,NA,2022-12-22T16:02:59Z,2022-12-22T16:02:59Z,"> config set log-retention-days -1

oh , i get it  ,We have implemented it in the callback.

I forgot the config command.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RPdxN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1210,https://api.github.com/repos/apache/kvrocks/issues/1210,kvrocks,1512691087,1210,tip bug for: zrangebylex,lt1946,369361,,lt1946@163.com,CLOSED,2022-12-28T11:15:56Z,2023-01-03T02:02:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

latest

### Minimal reproduce step

latest

### What did you expect to see?

value1 , value2 , value3

### What did you see instead?

zadd(key, 1f, ""value1"");
zadd(key, 2f, ""value2"");
zadd(key, 3f, ""value3"");
zadd(key, 4f, ""value4"");
zadd(key, 5f, ""value5"");
zadd(key, 6f, ""value6"");
zadd(key, 7f, ""value7"");
zadd(key, 8f, ""value8"");
zadd(key, 9f, ""value9"");
zadd(key, 10f, ""value10"");

zrangebylex(key, ""-"", ""[value3"");

will get result: value1 , value2 , value3 , value10

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1210/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1210,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RdNDB,kvrocks,1366610113,1210,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2022-12-28T12:17:32Z,2022-12-28T12:17:32Z,"it should not be a bug.
i think the result is `value1 , value10, value2 , value3 `, the Lexicographic order of `value10` is less than `value2`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RdNDB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1211,https://api.github.com/repos/apache/kvrocks/issues/1211,kvrocks,1512693468,1211,new bug for: sscan,lt1946,369361,,lt1946@163.com,CLOSED,2022-12-28T11:18:58Z,2023-01-03T14:43:46Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

latest

### Minimal reproduce step

check redis command.

### What did you expect to see?

if count==0 ,return ok! and for count!=0.

### What did you see instead?

SSCAN with COUNT >0 , retrun error.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1211/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1211,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RdIwZ,kvrocks,1366592537,1211,NA,torwig,8588372,Yaroslav,,NA,2022-12-28T11:48:42Z,2022-12-28T11:48:42Z,"Hi @lt1946 , could you provide more info about your case? What is the error message?
I just executed the following:
```
127.0.0.1:6666> sadd set1 10 20 30 40 50 60 80 80 40 50 20
(integer) 11
127.0.0.1:6666> sscan set1 0 count 10
1) ""0""
2) 1) ""10""
   2) ""20""
   3) ""30""
   4) ""40""
   5) ""50""
   6) ""60""
   7) ""80""
```
In this case, `count` is greater than 0 and there is no error.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RdIwZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1211,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RpjgJ,kvrocks,1369847817,1211,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-03T14:43:45Z,2023-01-03T14:43:45Z,Close this issue since it has no further feedback. Feel free to reopen if you have any questions or feedback.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RpjgJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/1212,kvrocks,1512828109,1212,BITPOS doesn't support BIT option,lt1946,369361,,lt1946@163.com,CLOSED,2022-12-28T14:02:50Z,2024-03-20T14:04:48Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

latest

### Minimal reproduce step

from redis command : [https://redis.io/commands/bitpos/](url)
redis> SET mykey ""\x00\xff\xf0""
""OK""
 


### What did you expect to see?

redis> BITPOS mykey 1 7 15 BIT
(integer) 9

### What did you see instead?

redis> BITPOS mykey 1 7 15 BIT
(integer) 57

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1212/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Rd6rt,kvrocks,1366797037,1212,NA,torwig,8588372,Yaroslav,,NA,2022-12-28T17:04:36Z,2022-12-28T17:04:36Z,"Hi @lt1946, thank you for your report. 
On my machine, with Redis I have the following:
```
[yaroslav@localhost ~]$ redis-cli
127.0.0.1:6379> SET mykey1 ""\x00\xff\xf0""
OK
127.0.0.1:6379> BITPOS mykey1 1 7 15 BIT
(integer) 8
```
However, you said that you expect to see `9`.

Kvrocks behaves in the following way:
```
127.0.0.1:6666> SET mykey ""\x00\xff\xf0""
OK
127.0.0.1:6666> BITPOS mykey 1 7 15 BIT
(integer) -1
```
And it needs an investigation.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Rd6rt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Rd7y0,kvrocks,1366801588,1212,NA,torwig,8588372,Yaroslav,,NA,2022-12-28T17:11:53Z,2022-12-28T17:11:53Z,"@lt1946 I got the reason why the result is `-1`. Currently, the `BITPOS` command doesn't support `BIT` flag, so it considers `start` and `end` values as **bytes**.
```
127.0.0.1:6379> BITPOS mykey1 1 1 2
(integer) 8
127.0.0.1:6379> BITPOS mykey1 1 2 3
(integer) 16
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Rd7y0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RsWpS,kvrocks,1370581586,1212,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-01-04T07:48:38Z,2023-01-04T07:48:38Z,I'd suggest adding a comment/description in the document https://kvrocks.apache.org/docs/supported-commands#bit-commands and closing this issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RsWpS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52geid,kvrocks,1988225181,1212,NA,sheharyaar,34273345,Shehar Yaar,sheharyaar48@gmail.com,NA,2024-03-11T11:28:27Z,2024-03-11T11:28:27Z,"@jihuayu , I would like to take up this issue, please assign me this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52geid/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gnox,kvrocks,1988262449,1212,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-11T11:51:05Z,2024-03-11T11:51:05Z,@sheharyaar Assign! You can refer to https://github.com/apache/kvrocks/pull/2087,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gnox/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52jQDq,kvrocks,1988952298,1212,NA,sheharyaar,34273345,Shehar Yaar,sheharyaar48@gmail.com,NA,2024-03-11T16:56:43Z,2024-03-11T16:56:43Z,"@jihuayu , I think of two approaches :

1. We can convert the bits to bytes and when the bit position is retrieved we can check if it falls with [start,end) bits.
- This would allow us not to change the semantics of `BitmapString::BitPos` (https://github.com/apache/kvrocks/blob/unstable/src/types/redis_bitmap_string.cc#L102-L129) which is called by `BitMap::BitPos` (https://github.com/apache/kvrocks/blob/unstable/src/types/redis_bitmap.cc#L318-L321).

Before that call we can store the original start and stop and then later compare them with the answer, like this :
File : redis_bitmap.cc
![image](https://github.com/apache/kvrocks/assets/34273345/044b6e7e-8607-49fa-98ec-f0b6759ee4c4)

2. We can change the semantics of  `BitmapString::BitPos`,  `Bitmap::BitPos` and `utl::msb::RawBitPos` https://github.com/apache/kvrocks/blob/1f3913f7942e370581a6c7ca7f9c99cdb7f58479/src/common/bit_util.h#L105-L145 We can overload BitPos to make it backward compatible too.


So which should I go with ?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52jQDq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52mEPi,kvrocks,1989690338,1212,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-12T00:26:52Z,2024-03-12T00:26:52Z,"@sheharyaar Great! Thank you for the detailed plan. I prefer method 2.
I want to hear @mapleFU's opinion, he has more experience in this area.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52mEPi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52nD25,kvrocks,1989950905,1212,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-12T03:03:50Z,2024-03-12T03:03:50Z,"Redis itself uses a ""bitmask"" to mask the implementation: https://github.com/redis/redis/blob/unstable/src/bitops.c#L888

E.g. if bit 1 100, it will change to ""byte"", and mask the first / last byte with the bitmask. I think it might be ok to do like this. However, you can finish in any way you like if you think that's convient. Personally, I think support ""bit"" in `RawBitpos` maybe a better way","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52nD25/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52rIpg,kvrocks,1991019104,1212,NA,sheharyaar,34273345,Shehar Yaar,sheharyaar48@gmail.com,NA,2024-03-12T08:22:52Z,2024-03-12T08:22:52Z,"Ok, I will move on with support for bit in `RawBitPos` and I will accordingly overload the functions to keep them backwards compatible.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52rIpg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53HUxr,kvrocks,1998408811,1212,NA,sheharyaar,34273345,Shehar Yaar,sheharyaar48@gmail.com,NA,2024-03-14T20:28:35Z,2024-03-14T20:28:35Z,"@jihuayu, I have created a draft PR for this issue, I need to add new test cases. In the tests, the `use_bitmap` variable is present, if it is false then `value` type is string, else bitmap. I want to know how can I use bitmap instead of string to test my input in `kvrocks cli` (not in the tests) ?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53HUxr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53Iaz1,kvrocks,1998695669,1212,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-15T00:34:12Z,2024-03-15T00:34:12Z,"@sheharyaar Good job!
Bitmap commands can both work on string & bitmap type keys.
If you use `set key bitmap_value` to create keys, it is a string type key.
If you use `setbit key 0 1` to create keys, it is a bitmap type key.

Other, if ""[go test](https://github.com/apache/kvrocks/blob/815d11f205105f845b3718e7081bca703d163cf3/tests/gocase/unit/type/bitmap/bitmap_test.go)"" can cover all cases, you don't need to add C++ tests. We prioritize using go test.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53Iaz1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53PG9V,kvrocks,2000449365,1212,NA,sheharyaar,34273345,Shehar Yaar,sheharyaar48@gmail.com,NA,2024-03-15T21:15:39Z,2024-03-15T21:15:39Z,"@jihuayu  @mapleFU , the PR is almost complete and I have added the test cases. However there is a small issue. 
Currently RawBitPos returns `count_bytes * 8 (i.e. the number of bits)` if the test bit is '0' and no such bits are found in the range. It is so that, in the function `BitmapStriing::BitPos` we can return -1 if `stop_given` is true and `count_bytes * 8` if `stop_given` is false. But if we directly add support for bits directly to this function, then in that case it causes a bug.

Example if stored string is ""\x00\x00\x00""
Query > BITPOS mykey 0 2 3 BIT

This should return 2. But if we calculate total count (stop-start+1) that comes out to be 2 and also the value returned from BitRawPos is 2 (valid).

Then this relation evalutes to true and returns -1 instead of 2.
![image](https://github.com/apache/kvrocks/assets/34273345/4a0d4cf1-7f6e-4113-b439-92ab923f8324)
https://github.com/apache/kvrocks/blob/unstable/src/types/redis_bitmap_string.cc#L122-L125


*Possible solutions* :
1. If we fix this in RawBitPos, it will deviate from redis' implementation. Redis' RawBitPos returns `bytes*8`, but the bit is handled in the caller function (BitmapString::BitPos) in this case.
2. We handle bits in BitmapString::BitPos and let RawBitPos be the same

This bug doesn't affect Bitmaps as they return -1 even if test bit is 0.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53PG9V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53Vvre,kvrocks,2002189022,1212,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-16T23:46:16Z,2024-03-16T23:46:16Z,"@sheharyaar Thanks, those 2 ways both are LGTM. 

We only need to be compatible with the Redis protocol; the internal implementation does not need to be identical.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53Vvre/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53VwFn,kvrocks,2002190695,1212,NA,sheharyaar,34273345,Shehar Yaar,sheharyaar48@gmail.com,NA,2024-03-16T23:50:59Z,2024-03-16T23:50:59Z,"Ok, I will add a fix soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53VwFn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53VyOf,kvrocks,2002199455,1212,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-17T00:15:05Z,2024-03-17T00:15:05Z,"1. Redis' impl uses code below: https://github.com/redis/redis/blob/unstable/src/bitops.c#L984-L997
2. bitpos util syntax would be clear: returning the ""kth"" bit in the input. 

I think we'd better keep RawBitpos clean and clear, and handling the dirty logic in `BitmapString::BitPos`.

( besides, I think `stop_given` and `bit` is really tricky in redis, sigh)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53VyOf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53WRQe,kvrocks,2002326558,1212,NA,sheharyaar,34273345,Shehar Yaar,sheharyaar48@gmail.com,NA,2024-03-17T06:15:30Z,2024-03-17T06:15:30Z,"> ( besides, I think stop_given and bit is really tricky in redis, sigh)

Yes, I agree too.
I will make changes to handle the bit logic in BitPos instead of RawBitPos
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53WRQe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1213,https://api.github.com/repos/apache/kvrocks/issues/1213,kvrocks,1512864489,1213,error command for:   georadius,lt1946,369361,,lt1946@163.com,CLOSED,2022-12-28T14:43:30Z,2023-01-03T02:03:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

latest

### Minimal reproduce step

example at : [https://redis.io/commands/georadius/](url)
redis> GEOADD Sicily 13.361389 38.115556 ""Palermo"" 15.087269 37.502669 ""Catania""
(integer) 2

### What did you expect to see?

redis> GEORADIUS Sicily 15 37 200 km WITHDIST WITHCOORD
 
2) 1) ""Catania""
   2) ""56.4413""

### What did you see instead?

Expected :56.4413
Actual   :3.479447370796909E15

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1213/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1213,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ReyT2,kvrocks,1367024886,1213,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2022-12-29T02:04:53Z,2022-12-29T02:04:53Z,"@lt1946 Thanks for your report, but I can't reproduce the bug with your steps.

<img width=""857"" alt=""image"" src=""https://user-images.githubusercontent.com/4987594/209893891-e89d3a5c-4056-4d56-8d1c-66fbf4b647ab.png"">
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ReyT2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1216,https://api.github.com/repos/apache/kvrocks/issues/1216,kvrocks,1517502082,1216,Persist the cluster nodes info in cluster mode,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-01-03T14:54:35Z,2023-01-04T05:33:37Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, the cluster nodes' topology is stored in memory and we need to re-sync the cluster topology to every node after restarting. There are a bit inconvenient and confusing for many users even though it's the design intention. So I think we can persist the cluster topology info in the local file to avoid re-syncing if it's unchanged.

### Solution

Dump the nodes' info into the local file, then load this file if exists.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1216/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1216,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Rr_h3,kvrocks,1370486903,1216,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-01-04T04:54:59Z,2023-01-04T04:54:59Z,What's the different between this issue and https://github.com/apache/incubator-kvrocks/issues/1021 ?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Rr_h3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1216,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RsERg,kvrocks,1370506336,1216,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-04T05:33:36Z,2023-01-04T05:33:36Z,"@mapleFU Thanks for your reminder! I forgot we already have this issue, let's close it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5RsERg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1220,https://api.github.com/repos/apache/kvrocks/issues/1220,kvrocks,1524876149,1220,Wrong substring in kvrocks2redis config,PragmaTwice,20042607,Twice,,CLOSED,2023-01-09T03:35:04Z,2023-01-12T04:17:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/incubator-kvrocks/blob/44ffb9a742792fd559b4147678fd1dbb1e5bc9d4/utils/kvrocks2redis/config.cc#L109

### What did you expect to see?

--

### What did you see instead?

--

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1220/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/1223,kvrocks,1528332851,1223,Improve slot migration speed and resource consumption using raw key values,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2023-01-11T02:54:35Z,2024-11-09T04:59:25Z,"### Motivation

Currently, kvrocks performs slot migration by converting the data into RESP and then sending it to the destination(#430).
We made a little optimizations in #904 to speed up migration.

However, there are still some problems with command-based slot migration:
- we will determine the expire time during the data migration, which makes the data inconsistent (mentioned in the comments of #906)
- for data with an expiration time, if the expiration occurs during the migration process, then we cannot migrate the data and the entire migration process will fail.

### Solution

We can use **rawkv-based** data migration, where we directly send rocksdb's key values data to the target.

With rawkv-based migration, neither the source nor the destination need to judge expire time, which completely solves the data inconsistency problem. It is equivalent to translating the raw key values data from one instance to another. 

It can save a lot of CPU by eliminating the need to convert Key-Value to the RESP. 

In my tests, it can:
- save up to **2x** CPU on the target side
- for small values(100byte), the rawkv-based migration is 2.75 times faster than the command-based migration

### Plan

I decomposed this issues into those tasks:

- [x] #1982
- [x] #1989
- [x] #2007
- [x] #2008
- [x] #2009","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1223/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SJVl1,kvrocks,1378179445,1223,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-11T02:58:13Z,2023-01-11T02:58:13Z,@caipengbo Do you mean that we can send the write batch directly instead of the RESP format？,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SJVl1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SJV58,kvrocks,1378180732,1223,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-01-11T03:00:28Z,2023-01-11T03:00:28Z,"> Do you mean that we can send the write batch directly instead of the RESP format？

@git-hulk Yup, we send the write batch directly, and the target calls the `rocksdb::Write()` interface directly","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SJV58/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SJZIA,kvrocks,1378193920,1223,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-11T03:22:05Z,2023-01-11T03:22:05Z,"> > Do you mean that we can send the write batch directly instead of the RESP format？
> 
> @git-hulk Yup, we send the write batch directly, and the target calls the `rocksdb::Write()` interface directly

Got it, thanks a lot","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5SJZIA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bC7z8,kvrocks,1527495932,1223,NA,ZENOTME,43447882,ZENOTME,,NA,2023-04-28T12:31:43Z,2023-04-28T12:31:43Z,"I'm interested in this issue, but I'm confused about 

> With rawkv-based migration, neither the source nor the destination need to judge expire time
>> Do you mean that we can send the write batch directly instead of the RESP format？

Does it means that: for a key-value pair with expire (k,v,expire), just send the (k,v) and ignore the expire?


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bC7z8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bC8m8,kvrocks,1527499196,1223,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-04-28T12:34:48Z,2023-04-28T12:34:48Z,"> Does it means that: for a key-value pair with expire (k,v,expire), just send the (k,v) and ignore the expire?

Yes, it ignore the expire. Let the target determine the expire.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bC8m8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bC-pE,kvrocks,1527507524,1223,NA,ZENOTME,43447882,ZENOTME,,NA,2023-04-28T12:42:28Z,2023-04-28T12:42:28Z,"> Let the target determine the expire.

Do you means the case like:
1. migrate (k,v) to target, and now (k,v) don't have expire
2. And then target get a command like 'EXPIRE k 10', now (k,v) have a new expire.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bC-pE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bv6f5,kvrocks,1539287033,1223,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-05-09T02:06:08Z,2023-05-09T02:06:08Z,"> Do you means the case like:

Yes","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bv6f5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bxmWH,kvrocks,1539728775,1223,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-09T08:57:26Z,2023-05-09T08:57:26Z,@caipengbo Can you submit an issue to track this?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bxmWH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5byA0b,kvrocks,1539837211,1223,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-05-09T10:03:28Z,2023-05-09T10:03:28Z,"> @caipengbo Can you submit an issue to track this?

Yeah, I plan to solve this issue after slot batch PR merged @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5byA0b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bzAkx,kvrocks,1540098353,1223,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-09T13:10:53Z,2023-05-09T13:10:53Z,@caipengbo Thanks a lot,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bzAkx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vxyfD,kvrocks,1875322819,1223,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-03T12:49:00Z,2024-01-03T12:49:00Z,"@caipengbo PR #1534 has been pending for a while. This feature is valuable since it can help the cluster migration avoid depending on the log data of the write batch except for the performance benefit. I'm very eager to see this feature done, but #1534 has too many conflicts and it's a bit hard to review for now.

So I'm not sure if you're willing to continue working on this feature. If yes, I think we can
break down this feature into a few PRs and add more tests like:

- [ ] Add the `ApplyBatch` command
- [ ] Implement the merge iterator for iterating SST keys
- [ ] Implement WAL iterator for migrating by WAL logs
- [ ] Implement the migration by applying raw batch
- [ ] Make the raw batch migration parameters configurable

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vxyfD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vxzoG,kvrocks,1875327494,1223,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-01-03T12:52:49Z,2024-01-03T12:52:49Z,"> So I'm not sure if you're willing to continue working on this feature. If yes, I think we can break down this feature into a few PRs and add more tests.

Indeed, the previous code was too much for CR, and I was happy to go ahead and split it up into multiple PRs. @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vxzoG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vx1H6,kvrocks,1875333626,1223,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-03T12:58:01Z,2024-01-03T12:58:01Z,"> Indeed, the previous code was too much for CR, and I was happy to go ahead and split it up into multiple PRs. @git-hulk

@caipengbo Thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vx1H6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vx5JY,kvrocks,1875350104,1223,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-01-03T13:09:11Z,2024-01-03T13:09:11Z,"I'm going to restart this work. I tracked some tasks in this issue, and I may change the task names in the future PRs.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vx5JY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1223,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vx7uc,kvrocks,1875360668,1223,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-03T13:17:57Z,2024-01-03T13:17:57Z,"> I'm going to restart this work. I tracked some tasks in this issue, and I may change the task names in the future PRs.

cool, can also convert those sub-tasks into tracking issues.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vx7uc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1224,https://api.github.com/repos/apache/kvrocks/issues/1224,kvrocks,1530615148,1224,Check if the replication is correct by the topology in cluster mode,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-01-12T12:17:11Z,2024-03-16T13:38:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As mentioned in https://github.com/apache/incubator-kvrocks/pull/1219#issuecomment-1376628201, the master can check if the cluster topology is matched by the host and port when receiving the replicate request. It can reduce the risk of the replica connecting to the stale master.

BTW, we can also have a mechanism(configuration) to let users disable this feature.

### Solution

For the replication check, check if the replica's IP and port are in the master replica nodes. And add a configuration to allow users to enable and disable it in flight.

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1224/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1234,https://api.github.com/repos/apache/kvrocks/issues/1234,kvrocks,1560696707,1234,Segment fault in CI test: TestMultiServerIntrospection,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-01-28T05:16:24Z,2023-01-28T05:20:51Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/incubator-kvrocks/actions/runs/4030144063/jobs/6928653030

### What did you expect to see?

passed

### What did you see instead?

CI failure

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1234/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1234,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T4aXF,kvrocks,1407296965,1234,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-28T05:20:51Z,2023-01-28T05:20:51Z,It's caused by the `client kill type slave` command in line: https://github.com/apache/incubator-kvrocks/blob/unstable/tests/gocase/unit/introspection/introspection_test.go#LL202C52-L202C52,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T4aXF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1235,https://api.github.com/repos/apache/kvrocks/issues/1235,kvrocks,1561960766,1235,"Inconsistent error ""-Can't write to slot being migrated which is in write forbidden phase""",moonsphere,43288455,,,CLOSED,2023-01-30T08:22:26Z,2023-04-01T13:52:41Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

c41bec89045c0c0c800296c6b1bcec48bf2a4461

### Minimal reproduce step

```
memtier_benchmark -p 6666 --cluster-mode -n allkeys --threads 1
```

and 

```
CLUSTERX MIGRATE
CLUSTERX SETSLOT
```

as the same time.

### What did you expect to see?

no error in client side

### What did you see instead?

client report:

```
server 0.0.0.0:6666 handle error response: -Can't write to slot being migrated which is in write forbidden phase
```

https://github.com/apache/incubator-kvrocks/blob/36b19ec9175c54237895352f11018346bb98d6be/src/cluster.cc#L629

return the error message inconsistent with the standard Redis Protocol and redis-client cannot handle it, but how can the final user handle this error~?

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1235/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1235,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T783p,kvrocks,1408224745,1235,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-30T09:06:10Z,2023-01-30T09:06:10Z,"Hi, thanks for your feedback.

Do you mean it missing the ERR prefix before the error message? It should be in compliance with RESP since it only requires the error reply starting with '-' as its first byte. 

https://redis.io/docs/reference/protocol-spec/

> For Errors, the first byte of the reply is ""-""

Correct me if I missed something.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T783p/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1235,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T9qfL,kvrocks,1408673739,1235,NA,moonsphere,43288455,,,NA,2023-01-30T13:58:34Z,2023-01-30T13:58:34Z,"Hi, @git-hulk  thanks for the reply.

From the log, we can see it already has `-` prefix 

```
server 0.0.0.0:6666 handle error response: -Can't write to slot being migrated which is in write forbidden phase
```

My question for this issue is ""This error  make a different user experience when the user switches their application from redis-cluster to kvrocks-cluster"".

We can imagine that :

1. There are two nodes: `nodeA` and `nodeB`,  `slot1` is on `nodeA`
2. Admin execute `clusterx migrate` in kvrocks-cluster and `set slots migrating/importing + migrate` in redis-cluster
3. User's application set a `key1` to nodeA at the same time(`key1` belong to `slot1`)

For redis cluster:

Due to the single thread execution model, `set key1` will wait `migrate` finished, after that it will find key1 not exist in nodeA then `-ASK + ASKING` to redirect `set key1` to nodeB,  `-ASK` can be right handle by mainstream redis sdk.

But for kvrocks cluster:

`set key1` will meet `forbidden_slot_` mark (after it finish send snapshot) and return a error with `-Can't ...`, all redis sdk could not handle it, the error will throw to application directly.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T9qfL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1235,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T9tsG,kvrocks,1408686854,1235,NA,moonsphere,43288455,,,NA,2023-01-30T14:07:02Z,2023-01-30T14:07:02Z,"`forbidden_slot_`  looks like an ""optimism lock"", I guess some existed proxy(for example PegaDB proxy？) maybe can right handle this error (pending the request and wakeup when migrate command finished?)

But for opensource user like me that directly connect kvrocks, it's very unfriendly to force business applications to try-catch-match_str and retry this error.

At first glance, `-TRYAGAIN` seems be a good candidate for this error, but it seems no existed redis sdk handle `-TRYAGAIN` in write path :sob:","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T9tsG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1235,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T-S2c,kvrocks,1408839068,1235,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-30T15:34:30Z,2023-01-30T15:34:30Z,"@moonsphere Thanks for your detailed explanation, I can get your point now.

> forbidden_slot_ looks like an ""optimism lock""

Yes, you're right. We thought it was acceptable to forbid writing in a short time which mainly depends on `migrate-sequence-gap`(default is 10000 sequences). I'm not sure how long this error happens in your test case. Generally, we expected it should be <= 1s.

> I guess some existed proxy(for example PegaDB proxy？) maybe can right handle this error (pending the request and wakeup when migrate command finished?)

AFAIK, PegaDB didn't have the proxy to handle this error. Is that right? @ShooterIT @caipengbo @shangxiaoxiong 

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T-S2c/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1235,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T-p_k,kvrocks,1408933860,1235,NA,PragmaTwice,20042607,Twice,,NA,2023-01-30T16:23:52Z,2023-01-30T16:23:52Z,"If there is no solution for this incompatibility, I think at least we can make it more simple to match and process for users, e.g. change the error msg to ""-TRYAGAIN Can't write ..."", so users do not need to care about the specific error sentence.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T-p_k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1235,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UBIbb,kvrocks,1409582811,1235,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-01-31T00:48:22Z,2023-01-31T00:48:22Z,"> AFAIK, PegaDB didn't have the proxy to handle this error. Is that right?

Indeed, there is no SDK to handle this error, so the user has to retry.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UBIbb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1236,https://api.github.com/repos/apache/kvrocks/issues/1236,kvrocks,1562192310,1236,Add an option to disable the persist the cluster nodes feature,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-01-30T10:48:39Z,2023-01-31T01:56:05Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We implemented the persistent cluster nodes in PR #1021, and it may bring the stale cluster topology issue in a short time. So it would be better to give users a way to disable it if they don't want this feature.

### Solution

Add a new option to turn on/off the feature.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1236/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1236,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T8m-q,kvrocks,1408397226,1236,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-01-30T10:49:11Z,2023-01-30T10:49:11Z,Great thanks for @mapleFU suggestions.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5T8m-q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1242,https://api.github.com/repos/apache/kvrocks/issues/1242,kvrocks,1567547838,1242,The kvrocks cluster information cannot be reset,QQxiaoyuyu,34185590,,,OPEN,2023-02-02T08:18:10Z,2023-02-13T12:29:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

kvrocks cluster information cannot be reset

### Solution

kvrocks cluster information cannot be reset，please support reset

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1242/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1242,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UQfM-,kvrocks,1413608254,1242,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-02T11:45:47Z,2023-02-02T11:45:47Z,"@QQxiaoyuyu Thanks for your feedback, it makes sense to allow resetting the cluster nodes in flight. The kvrocks controller also needs this feature to reset the cluster after destroying the cluster.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5UQfM-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1242,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VG3W1,kvrocks,1427862965,1242,NA,segment11,4350112,Kerry,dingyong87@163.com,NA,2023-02-13T12:29:54Z,2023-02-13T12:29:54Z,"You can delete all shard nodes one by one.
Use this may help.
https://github.com/segment11/segment_kvrocks_controller","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VG3W1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1246,https://api.github.com/repos/apache/kvrocks/issues/1246,kvrocks,1571687867,1246,Use the release CI to build and publish the docker image,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-02-06T00:29:18Z,2023-02-06T04:09:31Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, we expect to release the docker image when calling a new vote process. It's a bit trivial to request the docker image registry permission for all release managers.

### Solution

Automatically build and push the docker image if the new tag was created.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1246/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1254,https://api.github.com/repos/apache/kvrocks/issues/1254,kvrocks,1579287583,1254,ASan/TSan does not work well with JeMalloc,xiaobiaozhao,52393536,xiaobiaozhao,,CLOSED,2023-02-10T08:59:39Z,2023-03-09T09:30:14Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

Mac  & Ubuntu all versions

### Minimal reproduce step

`./x.py build --unittest --compiler gcc -DDISABLE_JEMALLOC=ON -DENABLE_TSAN=ON`
`./x.py build --unittest --compiler gcc -DDISABLE_JEMALLOC=ON -DENABLE_ASAN=ON`

### What did you expect to see?

build succeed

### What did you see instead?

./x.py build --unittest --compiler gcc -DDISABLE_JEMALLOC=ON -DENABLE_TSAN=ON
$ /usr/bin/cmake /root/work/incubator-kvrocks -DCMAKE_BUILD_TYPE=RelWithDebInfo -DCMAKE_C_COMPILER=gcc -DCMAKE_CXX_COMPILER=g++ -DENABLE_TSAN=ON
-- The CXX compiler identification is GNU 11.3.0
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /usr/bin/g++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
CMake Error at CMakeLists.txt:67 (message):
  **### ASan/TSan does not work well with JeMalloc**

-- Configuring incomplete, errors occurred!
See also ""/root/work/incubator-kvrocks/build/CMakeFiles/CMakeOutput.log"".
Traceback (most recent call last):
  File ""/root/work/incubator-kvrocks/./x.py"", line 397, in <module>
    args.func(**arg_dict)
  File ""/root/work/incubator-kvrocks/./x.py"", line 122, in build
    run(cmake, str(basedir), *cmake_options, verbose=True, cwd=dir)
  File ""/root/work/incubator-kvrocks/./x.py"", line 68, in run
    raise RuntimeError(err)
RuntimeError: 
failed to run: ('/usr/bin/cmake', '/root/work/incubator-kvrocks', '-DCMAKE_BUILD_TYPE=RelWithDebInfo', '-DCMAKE_C_COMPILER=gcc', '-DCMAKE_CXX_COMPILER=g++', '-DENABLE_TSAN=ON')
exit with code: 1

### Anything Else?

I also test  `./x.py build --unittest --compiler gcc -DDISABLE_JEMALLOC=ON -DENABLE_TSAN=ON -DENABLE_OPENSSL=ON` build is OK.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1254/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1254,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5U9pgt,kvrocks,1425446957,1254,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-02-10T09:00:25Z,2023-02-10T09:00:25Z,Will this be a feature?  @PragmaTwice ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5U9pgt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1254,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5U-Kcm,kvrocks,1425581862,1254,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-10T10:28:11Z,2023-02-10T10:28:11Z,"It's expected behavior, you can have a look at the CMakeList.txt.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5U-Kcm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1254,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5U-6Nz,kvrocks,1425777523,1254,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-02-10T13:00:14Z,2023-02-10T13:00:14Z,"> 

OK, Thx","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5U-6Nz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1254,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDfjC,kvrocks,1426979010,1254,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-02-12T09:00:29Z,2023-02-12T09:00:29Z,reopen the issue,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDfjC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1257,https://api.github.com/repos/apache/kvrocks/issues/1257,kvrocks,1581154757,1257,Improve the homepage of Kvrocks website,ColinChamber,95634254,ColinChamber,,CLOSED,2023-02-12T07:23:45Z,2023-05-28T13:34:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

The Designer has already pushed the UI design blueprint to [Lanhu](https://lanhuapp.com/link/#/invite?sid=lX0DR86F). Let's move on to the next stage of coding, which will be implemented by Yuqiu Song.

### Solution

I suppose it can be divided to the following tasks.
* [x] Modify the colors of Header and Footer, and update the banner.
* [ ] Refactor introduction of the Redis Compatible feature.
	* [ ] Include a text editor with demo.
	* [ ] Include a pie chart displaying the proportion of implemented Redis commands.
* [x] Add icons and descriptions for four features.
* [ ] Add a list of logos.
* [x] Make the homepage mobile-friendly (optional).
* [ ] Add some animations (optional).

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1257/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1257,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDbhU,kvrocks,1426962516,1257,NA,sendRainAutumn,46080479,Just for Star,,NA,2023-02-12T07:32:10Z,2023-02-12T07:32:10Z,I'm willing to submit a PR,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDbhU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1257,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDbnk,kvrocks,1426962916,1257,NA,ColinChamber,95634254,ColinChamber,,NA,2023-02-12T07:34:47Z,2023-02-12T07:34:47Z,FYI @git-hulk @PragmaTwice ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDbnk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1257,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDd8B,kvrocks,1426972417,1257,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-02-12T08:35:54Z,2023-02-12T08:35:54Z,"> I'm willing to submit a PR

Can you elaborate a bit on what exactly you're going to implement? I think we can create some subtasks and assign to you.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDd8B/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1257,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDeUK,kvrocks,1426973962,1257,NA,PragmaTwice,20042607,Twice,,NA,2023-02-12T08:45:17Z,2023-02-12T08:45:17Z,"Hi @SongYuQiu, very much looking forward to your PR! ❤️ 

However, I would like to make a few suggestions:
- As Lanhu is a private collaboration platform, I thought it would be a good idea to post the design (like, in `png` or `jpeg` format) directly in this thread to make it easier for wider community members to view.
- You do not need to do everything in one PR (of course you can if you want), instead, you could try splitting the task into a series of PRs, which would allow the task to be done incrementally and also facilitate the review process.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDeUK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1257,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDey_,kvrocks,1426975935,1257,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-02-12T08:50:54Z,2023-02-12T08:50:54Z,"![Web 1920 – 9](https://user-images.githubusercontent.com/18818196/218301534-c5a553cb-03c9-4d75-bf36-0f9f129e8d1e.png)

I get a copy of the design from the link. It looks cool and it seems a one-for-all contribution so we may not need subtasks.

Assigned to @SongYuQiu. Feel free to ping me if you need any help.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VDey_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1257,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZHzZ5,kvrocks,1495217785,1257,NA,ColinChamber,95634254,ColinChamber,,NA,2023-04-04T01:37:59Z,2023-04-04T01:37:59Z,"I'm glad to see that the community homepage has been completely refreshed. 

There are still some tasks to be carried out, such as deciding which languages to use for the demo in the text box and what content to demonstrate. We also need to establish a statistical standard and provide the proportion of implemented Redis commands for using in a pie chart. @git-hulk @PragmaTwice 

BTW, I hope that in the next PR, you can swap the icons for Replication and Cluster. This is because the icon with three ""K""s is more suitable for introducing the cluster feature. Thank you. @SongYuQiu","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZHzZ5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1257,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZH0BD,kvrocks,1495220291,1257,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-04T01:42:24Z,2023-04-04T01:42:24Z,"Thanks for @ColinChamber driving this great improvement.

It would be nice if can also fix the layout on the mobile web.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZH0BD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1257,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dWXIx,kvrocks,1566143025,1257,NA,ColinChamber,95634254,ColinChamber,,NA,2023-05-28T13:34:25Z,2023-05-28T13:34:25Z,"The homepage has been updated, thanks to everyone.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dWXIx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1260,https://api.github.com/repos/apache/kvrocks/issues/1260,kvrocks,1583679211,1260,when setslot set cluster version just bigger than last version,segment11,4350112,Kerry,dingyong87@163.com,CLOSED,2023-02-14T07:58:52Z,2023-02-14T11:36:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

It is easier for controller, the controller can only use one increase bigint sequence for one kvrocks cluster.

### Solution

Change cluster version step+1 check to just bigger than check.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1260/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1260,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VNF72,kvrocks,1429495542,1260,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-14T10:32:17Z,2023-02-14T10:32:17Z,"For `CLUSTERX  setnodes` command, it's right that we don't require to check if the version is continuous since it will fully update the cluster topology. But for the `CLUSTERX setslots`, it's a partial update behavior, so we need to check if the version is +1 to prevent missing some updates.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VNF72/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1260,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VNdkE,kvrocks,1429592324,1260,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-14T11:36:28Z,2023-02-14T11:36:28Z,@segment11 It's fine to keep this issue since we can allow the `CLUSTERX SETNODES` just check if it's bigger than before.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VNdkE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1261,https://api.github.com/repos/apache/kvrocks/issues/1261,kvrocks,1583684714,1261,Support batch fetch rows by key prefix,segment11,4350112,Kerry,dingyong87@163.com,CLOSED,2023-02-14T08:02:37Z,2023-02-14T13:52:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Improve performance so it can replace some cases using HBase.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1261/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1261,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VNAyA,kvrocks,1429474432,1261,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-14T10:16:34Z,2023-02-14T10:16:34Z,"Hi @segment11,

Thanks for your feedback, Kvrocks currently supports the scan command to iterate keys with prefix. Could you help to add more context if it's NOT exactly what you want?

Reference: https://redis.io/commands/scan/


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VNAyA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1261,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VNozH,kvrocks,1429638343,1261,NA,segment11,4350112,Kerry,dingyong87@163.com,NA,2023-02-14T12:06:51Z,2023-02-14T12:06:51Z,"I actually want a time series database on rocksdb, and it has replica that can failover.
Take HBase as example, query n rows scan by rowkey，it is just read some hfiles(sstable) because the rowkeys are ordered.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VNozH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1261,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VN_bx,kvrocks,1429731057,1261,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-14T13:14:25Z,2023-02-14T13:14:25Z,"Currently, the scan keys in Kvrocks are also ordered indeed, so it should be the same as HBase rows scan.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VN_bx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1263,https://api.github.com/repos/apache/kvrocks/issues/1263,kvrocks,1584438960,1263,Namespace is not persisted after pod restarted.,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-02-14T16:09:49Z,2023-02-18T15:39:32Z,"### Discussed in https://github.com/apache/incubator-kvrocks/discussions/1262

<div type='discussions-op-text'>

<sup>Originally posted by **Goutami-Gowda** February 14, 2023</sup>
hello, i created kvrocks statefulset with /var/lib/kvrocks volume. but after pod restart , all the namespace that i have added or gone. how can i persist this?</div>","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1263/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1265,https://api.github.com/repos/apache/kvrocks/issues/1265,kvrocks,1588734707,1265,Support fix a unique slot for multi keys with the same prefix,segment11,4350112,Kerry,dingyong87@163.com,CLOSED,2023-02-17T04:32:22Z,2023-02-17T04:45:02Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

So that I can specified some key/value save in the same slot, read more efficient and do transaction easy.

### Solution

For example, keys: my-prefix@@suffix1, my-prefix@@suffix2...
only use my-prefix to do hash and find a slot.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1265/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1265,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VeoQn,kvrocks,1434092583,1265,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-02-17T04:38:10Z,2023-02-17T04:38:10Z,"Can hash tag meet your needs?

https://github.com/apache/incubator-kvrocks/blob/e1cc7f68aeb6b649286157b5676631f41936bf27/src/cluster/redis_slot.cc#L67","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VeoQn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1267,https://api.github.com/repos/apache/kvrocks/issues/1267,kvrocks,1591108735,1267,some key seem to be nil when I execute 'scan 0',hlf2016,24551738,Pannio,1821299140@qq.com,CLOSED,2023-02-20T04:18:01Z,2023-02-20T15:54:21Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

v2.0.6
![image](https://user-images.githubusercontent.com/24551738/220008257-2ba500b4-cbc3-4979-b85d-c649909fd036.png)


### Minimal reproduce step

I do not know

### What did you expect to see?

the (nil) disappears


### What did you see instead?

the (nil)  exists and can not be deleted

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1267/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn28B,kvrocks,1436512001,1267,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-20T08:05:35Z,2023-02-20T08:05:35Z,"@hlf2016 I can't get the point and it'd be better to add reproduce steps, or we cannot fix this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn28B/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn4b3,kvrocks,1436518135,1267,NA,hlf2016,24551738,Pannio,1821299140@qq.com,NA,2023-02-20T08:10:06Z,2023-02-20T08:10:06Z,"> @hlf2016 I can't get the point and it'd be better to add reproduce steps, or we cannot fix this issue.

I do not know how it appeared
![image](https://user-images.githubusercontent.com/24551738/220048312-43995393-8633-4d2b-ac25-a3e9fb508789.png)

as seen in the picture above

how can I delete the  `(nil)` key

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn4b3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn8sA,kvrocks,1436535552,1267,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-20T08:24:22Z,2023-02-20T08:24:22Z,"Hi @hlf2016, thanks for your feedback, it should be related to this issue:https://github.com/apache/incubator-kvrocks/pull/930. Kvrocks will return an empty bulk string(`nil` for redis-cli), you can have a check if you have the empty key name like below:

```
127.0.0.1:6666> get """"
""1""
```
And delete if this key was not expected, then the `nil` will be disappeared.

We will fix this issue soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn8sA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn-Dx,kvrocks,1436541169,1267,NA,hlf2016,24551738,Pannio,1821299140@qq.com,NA,2023-02-20T08:29:31Z,2023-02-20T08:29:31Z,"> Hi @hlf2016, thanks for your feedback, it should be related to this issue:#930. Kvrocks will return an empty bulk string(`nil` for redis-cli), you can have a check if you have the empty key name like below:
> 
> ```
> 127.0.0.1:6666> get """"
> ""1""
> ```
> 
> And delete if this key was not expected, then the `nil` will be disappeared.
> 
> We will fix this issue soon.

Yes I once tried this  but it made no effects

![image](https://user-images.githubusercontent.com/24551738/220052372-523471e9-e9b9-415c-99d5-e0b4028b4e62.png)

So any other characters can lead to this ?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn-Dx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn-eU,kvrocks,1436542868,1267,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-20T08:31:03Z,2023-02-20T08:31:03Z,"@hlf2016 It means this key exists and it's NOT a string type, you can use `type """"` to inspect the value type.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn-eU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn__9,kvrocks,1436549117,1267,NA,hlf2016,24551738,Pannio,1821299140@qq.com,NA,2023-02-20T08:36:52Z,2023-02-20T08:36:52Z,"> type """"



> @hlf2016 It means this key exists and it's NOT a string type, you can use `type """"` to inspect the value type.

Ok thx very much    
I was totally blinded  
I'm sorry to bother you too much","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vn__9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VoAf0,kvrocks,1436551156,1267,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-20T08:38:51Z,2023-02-20T08:38:51Z,"> > type """"
> 
> > @hlf2016 It means this key exists and it's NOT a string type, you can use `type """"` to inspect the value type.
> 
> Ok thx very much I was totally blinded I'm sorry to bother you too much

No problem, welcome to join the WeChat community through: https://github.com/apache/incubator-kvrocks#social-media ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VoAf0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1273,https://api.github.com/repos/apache/kvrocks/issues/1273,kvrocks,1593834446,1273,About multi-language support,GoodManWEN,44322449,,,CLOSED,2023-02-21T17:13:03Z,2023-04-14T05:45:11Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

First of all love and thanks for your great work. As a developer I am looking for a database that will help me manage a large number of random read and write files. I came across this project about 2 weeks ago,  and kvrocks hit the bull's eye.

As a developer, I'm more concerned with production deployment related issues from a practical point of view. As this was also my first encounter with RocksDB, I'm more interested in how it behaves at the application level specifically comparing to Redis. Because while it is of great interest to reduce the cost with large data store cases, it is more important to ensure that the data is safe and secure at the behavioural level in the first place. I read all the documentation on the official website, which taught me a lot, but the relevant information didn't seem to be enough.

After reading the default configuration file I think it is also necessary to read it in the same way as the documentation. I would like to see multilingual support in the community in order to speed up my reading, but unfortunately it seems that the community has not opened the option to do so, nor has it opened a channel for multilingual translation contributions.



### Solution

Here is a tentative translated version of the profile, which I've post to gist
[kvrocks_config_file_chs_translate.conf](https://gist.github.com/GoodManWEN/47582b4890ee6298f7bd88f986bdb706)

I tried to translate the document into Chinese to speed up the reading for native Chinese speakers, The original text has also been retained in case the translation leads to misunderstandings. I'm sure there are many good contributors to the community who use Chinese, and the only reason there are no translations at the moment is that they may not have the time. And cross-referencing makes reading a little faster for native speakers, which is a bit much to learn for a newbie to be honest.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1273/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1273,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vynnh,kvrocks,1439332833,1273,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-22T02:03:10Z,2023-02-22T02:03:10Z,"@GoodManWEN Thanks for your warm proposal, I think it makes a lot of sense to have multi-language documentation. 

@tisonkun @PragmaTwice How about putting them on our official website? ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Vynnh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1273,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VzYuj,kvrocks,1439533987,1273,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-02-22T07:10:37Z,2023-02-22T07:10:37Z,No. I think it's a good supplement as a community work. We may set up a link (hint) but it would be hard to officially keet it up-to-date. We should leave such efforts third party and no promise unless we're sure it can be up-to-date and improve usability.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VzYuj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1273,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VzkMl,kvrocks,1439580965,1273,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-22T08:02:43Z,2023-02-22T08:02:43Z,"OK, it's good to maintain those third-party links in one place","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5VzkMl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1273,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V1xoF,kvrocks,1440160261,1273,NA,GoodManWEN,44322449,,,NA,2023-02-22T14:43:53Z,2023-02-22T14:43:53Z,"Glad to hear your response. Talking about the continuous update translation of the configuration file, I personally feel that it's not a work takes take much time, I'm pleased if I could help with the Chinese translation work. However considering this is a kind of work that expertise is more needed than language skills. For example, in my earlier translations I had the problem of not recognizing the abbreviation of what WAL is. Only when I searched did I understand what it meant, maybe I wasn't the right person for the work.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V1xoF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1273,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V16mF,kvrocks,1440196997,1273,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-22T14:57:52Z,2023-02-22T14:57:52Z,@GoodManWEN Thanks for your efforts. I will add a page for third-party resources on our website and then link your page here.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V16mF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1273,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V2q5J,kvrocks,1440394825,1273,NA,PragmaTwice,20042607,Twice,,NA,2023-02-22T16:41:26Z,2023-02-22T16:41:26Z,"Currently, in some cases (like performance tuning), users may be better to learn some knowledge about some concepts in (multi-leveled) LSMT and RocksDB.

I think it is indeed not friendly to new users, so we welcome all contributions towards a more user-friendly documentation.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V2q5J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1277,https://api.github.com/repos/apache/kvrocks/issues/1277,kvrocks,1596151774,1277,Enable transaction support for the mset command,siwee,70388114,,,CLOSED,2023-02-23T03:22:00Z,2023-08-16T06:56:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Hi, guys

Currently, using the mset command to write data in batches cannot ensure atomicity. We should let the system perform a rollback when the process is interrupted during data writing.

Regard

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1277/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1277,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_b2U,kvrocks,1442692500,1277,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-24T02:05:33Z,2023-02-24T02:05:33Z,Thanks for @tarvfx filing this issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_b2U/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1277,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WET__,kvrocks,1443971071,1277,NA,siwee,70388114,,,NA,2023-02-24T16:34:23Z,2023-02-24T16:34:23Z,"@git-hulk Thanks for you adding this feature to the to do list. In addition, I would like to add that other batch operation instructions other than mset, such as `msetnx`, should all be applicable to this enhanced feature.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WET__/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1277,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WEVD6,kvrocks,1443975418,1277,NA,PragmaTwice,20042607,Twice,,NA,2023-02-24T16:36:36Z,2023-02-24T16:36:36Z,"Rather than making `mset` atomic, I wonder if it is better to add a new flag to `mset` for atomicity and leave the default behavior align with Redis.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WEVD6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1277,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WIHhQ,kvrocks,1444968528,1277,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-25T02:59:56Z,2023-02-25T02:59:56Z,"@PragmaTwice Yes, we won't expect to affect the default behavior of the mset command.

@tarvfx Sure, I will consider those commands together.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WIHhQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1277,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kI79N,kvrocks,1680064333,1277,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-16T06:56:17Z,2023-08-16T06:56:17Z,This was resolved in #1634 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kI79N/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1278,https://api.github.com/repos/apache/kvrocks/issues/1278,kvrocks,1597802289,1278,"For the expired key, the TYPE command returns dirty data",jjz921024,19649281,anotherJJz,470623352@qq.com,CLOSED,2023-02-24T02:34:24Z,2023-02-28T08:25:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

kvrocks v2.3.0

### Minimal reproduce step

```
127.0.0.1:31001> set k v ex 10
OK
127.0.0.1:31001> type k
""string""
127.0.0.1:31001> ttl k
(integer) 3
127.0.0.1:31001> ttl k
(integer) -2
127.0.0.1:31001> type k
""string""
127.0.0.1:31001> get k
(nil)
127.0.0.1:31001> type k
""string""
```

### What did you expect to see?

**None** should been returned for the expired key

### What did you see instead?

For the expired key, the TYPE command returns dirty data

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1278/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1278,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_hCR,kvrocks,1442713745,1278,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-24T02:35:55Z,2023-02-24T02:35:55Z,@jjz921024 Thanks for your good catch. ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5V_hCR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1278,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WJwmv,kvrocks,1445398959,1278,NA,,,,,NA,2023-02-26T16:10:43Z,2023-02-26T16:10:43Z,"rocksdb has a feature whereby an expired key is not removed immediately but during compaction. If the size of a specific level is not large enough to trigger compaction, the old data remains. Compacting manually is one possible solution, but it may cause write stalls","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WJwmv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1278,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WJxOd,kvrocks,1445401501,1278,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-02-26T16:23:00Z,2023-02-26T16:23:00Z,"Hi @Lericaro

This bug was caused by the type command didn't check the expiry time, and it's OK to recycle those expired items later by compaction.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WJxOd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1281,https://api.github.com/repos/apache/kvrocks/issues/1281,kvrocks,1600947405,1281,Atomic commit write batches in the command EXEC,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-02-27T10:59:18Z,2023-03-04T14:19:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As mentioned in #487, the current transaction is NOT an atomic operation, some operations may be committed to DB but some are not if they crashed in the middle way of executing the command EXEC.

To fix this issue, we need to gather all write operations into one RocksDB's WriteBatch, then commit it at once.



### Solution

We can add a new function to create a shared WriteBatch for the Multi-Exec command like the below:

```C++
Status Storage::Begin() {
    is_txn_mode = true;
    txn_write_batch = make_shared<*rocksdb::WriteBatch>();
}

rocksdb::WriteBatch *Storage::GetWriteBatch() {
   if (is_txn_mode) {
      return txn_write_batch.get();
   }
   return make_shared<*rocksdb::WriteBatch>();
}

Status Storage::Commit() {
    is_txn_mode = false;
    // write txn WriteBatch to RocksDB
    txn_write_batch.reset();
}
```
For the Command Exec, we need to explicitly call the Begin() and Commit() to enter and leave the transaction mode. So that Kvrocks will create a new WriteBatch for each writes operation if it's NOT in transaction mode, and use the shared WriteBatch to collect all write operations if it's in the transaction mode.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1281/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1281,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WWiQL,kvrocks,1448748043,1281,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-02-28T19:34:06Z,2023-02-28T19:34:06Z,"Very important to me, waiting for this in upstream. Lot of thanks! ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WWiQL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1289,https://api.github.com/repos/apache/kvrocks/issues/1289,kvrocks,1604304993,1289,Cannot save the namespace in docker file system,eacdy,9031050,程序员大目,eacdy0000@126.com,OPEN,2023-03-01T06:01:58Z,2023-03-06T05:33:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.3.0; 2.2.0

### Minimal reproduce step

root@df063bf88c13:/data# redis-cli -h kvrocks -p 6666 -a workitemadmin
Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.
kvrocks:6666> namespace add ns1 my_token
(error) rename file encounter error: Device or resource busy


always  Device or resource busy

### What did you expect to see?

namespace add ok.

### What did you see instead?

Device or resource busy

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1289/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1289,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WZf79,kvrocks,1449524989,1289,NA,PragmaTwice,20042607,Twice,,NA,2023-03-01T08:07:08Z,2023-03-01T08:07:08Z,"I think it happens while another process creates a file lock upon `kvrocks.conf`.

Close the corresponding program and try again.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WZf79/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1290,https://api.github.com/repos/apache/kvrocks/issues/1290,kvrocks,1604617967,1290,maybe add a explicit [[fallthough]] is more better to the source readers,guoxiangCN,30590325,mzygdeaq@163.com,,CLOSED,2023-03-01T09:44:25Z,2023-03-02T04:27:42Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

maybe add a explicit [[fallthough]] is more better to the source readers

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1290/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1290,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WaO7J,kvrocks,1449717449,1290,NA,guoxiangCN,30590325,mzygdeaq@163.com,,NA,2023-03-01T09:44:47Z,2023-03-01T09:44:47Z,https://github.com/apache/incubator-kvrocks/blob/unstable/src/cluster/replication.cc#L201,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WaO7J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1290,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WcG2h,kvrocks,1450208673,1290,NA,PragmaTwice,20042607,Twice,,NA,2023-03-01T14:06:16Z,2023-03-01T14:06:16Z,Good catch! Would you like to do that?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WcG2h/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1290,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wcvw3,kvrocks,1450376247,1290,NA,guoxiangCN,30590325,mzygdeaq@163.com,,NA,2023-03-01T15:49:34Z,2023-03-01T15:49:34Z,i will,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wcvw3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1291,https://api.github.com/repos/apache/kvrocks/issues/1291,kvrocks,1604851583,1291,Enable quick compaction-checker,xiaobiaozhao,52393536,xiaobiaozhao,,CLOSED,2023-03-01T12:08:00Z,2023-03-25T10:26:02Z,"### Discussed in https://github.com/apache/incubator-kvrocks/discussions/1283

<div type='discussions-op-text'>

<sup>Originally posted by **xiaobiaozhao** February 27, 2023</sup>
In some case，we need save a lot of data with short ttl, eg ttl = 3600s.
In current kvrocks, it takes at least two days for compation to take place, which can cause disk space not to be released quickly. I think kvrocks needs to come up with a configuration to figure out how long compation will take.

New a conf item `compaction-checker-force-compact-seconds` https://github.com/apache/incubator-kvrocks/blob/c439f3af9d5c7ccb97ff4c7bdab088287acd73cc/src/storage/compaction_checker.cc#L58

And new a conf item `compaction-checker-interval-seconds`
https://github.com/apache/incubator-kvrocks/blob/c439f3af9d5c7ccb97ff4c7bdab088287acd73cc/src/server/server.cc#L184
</div>","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1291/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1291,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WbeTX,kvrocks,1450042583,1291,NA,ellutionist,35825540,CHENG PENG,impc53802956@163.com,NA,2023-03-01T12:12:02Z,2023-03-01T12:12:02Z,Will do this. Please assign to me.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WbeTX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1292,https://api.github.com/repos/apache/kvrocks/issues/1292,kvrocks,1604862805,1292,Enable max_background_jobs,xiaobiaozhao,52393536,xiaobiaozhao,,CLOSED,2023-03-01T12:15:38Z,2023-04-13T05:34:35Z,"### Discussed in https://github.com/apache/incubator-kvrocks/discussions/1284

<div type='discussions-op-text'>

<sup>Originally posted by **xiaobiaozhao** February 27, 2023</sup>
Use `max_background_jobs` instead of `max_background_compactions` and `max_background_flushes`

https://github.com/facebook/rocksdb/blob/main/include/rocksdb/options.h#L699</div>","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1292/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1292,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wblyi,kvrocks,1450073250,1292,NA,bruceqiwang,126678733,,,NA,2023-03-01T12:31:14Z,2023-03-01T12:31:14Z,Will do this. Please assign to me.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wblyi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1292,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wc6Kn,kvrocks,1450418855,1292,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-01T16:13:52Z,2023-03-01T16:13:52Z,"Good idea, it's much more clean to use!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wc6Kn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1292,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZdI7E,kvrocks,1500810948,1292,NA,zevin02,92536645,pt,zevin9427@gmail.com,NA,2023-04-08T07:05:18Z,2023-04-08T07:05:18Z, Please assign to me.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZdI7E/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1292,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZdN_o,kvrocks,1500831720,1292,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-08T09:09:18Z,2023-04-08T09:09:18Z,"Hi @zevin02, thanks for your attention. 

@bruceqiwang was already working on it, PR #1374 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZdN_o/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1294,https://api.github.com/repos/apache/kvrocks/issues/1294,kvrocks,1605279146,1294,"Perform HSETNX with multiple values, just like HSET",aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2023-03-01T16:23:25Z,2023-03-10T02:55:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

With HSET we can add a multiple key/field at once. But HSETNX, that's insert value only if they does not yet exist, use only one key/field pair at once. 

Could we changed HSETNX for usage with multiple values? 

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1294/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1294,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wc-Ct,kvrocks,1450434733,1294,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-01T16:24:16Z,2023-03-01T16:24:16Z,This needs for use HSET as append-only storage and optimize performance,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wc-Ct/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1294,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WeE_5,kvrocks,1450725369,1294,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-01T19:20:59Z,2023-03-01T19:20:59Z,"So, a command will return a count fields (integer replay), that are added to the hash-map or 0, if no data inserted.

@torwig could you provide a PR if this feature can be added? Lot of thanks!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WeE_5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1294,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WwNH8,kvrocks,1455477244,1294,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-06T05:25:03Z,2023-03-06T05:25:03Z,"It looks like this is a good feature, to see if @torwig or someone else would like to handle this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WwNH8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1294,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ww3zK,kvrocks,1455652042,1294,NA,torwig,8588372,Yaroslav,,NA,2023-03-06T08:01:30Z,2023-03-06T08:01:30Z,"@git-hulk Sure, I can implement this feature.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Ww3zK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1294,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WxNrH,kvrocks,1455741639,1294,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-06T09:04:03Z,2023-03-06T09:04:03Z,Thanks @torwig ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WxNrH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1295,https://api.github.com/repos/apache/kvrocks/issues/1295,kvrocks,1606270920,1295,Special symbols in the configuration of kvrocks2redis ,QQxiaoyuyu,34185590,,,CLOSED,2023-03-02T07:44:49Z,2023-03-07T02:38:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

The password configuration of kvrocks2redis does not support special symbols. My password contains (, #,). After the configuration is completed, some passwords are truncated, resulting in failure to connect to the database, 

### Minimal reproduce step

Password contains#

### What did you expect to see?

I hope that passwords containing all special characters can be configured for use

### What did you see instead?

E20230302 15:20:17.083904  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.099448  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.115800  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.132504  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.148733  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.166213  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.182044  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.206648  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.339524  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.362785  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.412103  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.474309  9563 sync.cc:78] auth got invalid response
E20230302 15:20:17.541461  9563 sync.cc:78] auth got invalid response

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1295/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1295,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wg6ds,kvrocks,1451468652,1295,NA,PragmaTwice,20042607,Twice,,NA,2023-03-02T08:18:07Z,2023-03-02T08:18:07Z,"AFAIK it is an expected behavior:

The symbol `#` stands for the start of comments, e.g.
```
pass 123 # this is a comment, password is 123
pass ""123#456"" # password is 123#456
```

So if the value contains `#`, it is expected to be quoted.

I will close this issue if no further problems.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wg6ds/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1295,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WmbyT,kvrocks,1452915859,1295,NA,QQxiaoyuyu,34185590,,,NA,2023-03-03T03:40:23Z,2023-03-03T03:40:23Z,"1. Purpose: test whether there is any bad effect after upgrading kvrocks from 2.0.6 to 2.3. Therefore, it is necessary to import data from other kvrocks to test kvrocks 2.0.6

2. Environmental preparation

target-kv centos7.9 kernel-version linux-5.4.149

src-kv centos7.9 kernel-version linux-4.4.246

kvrocks2redis cenots7.9 kernel-version linux-5.4.149

3. Procedure

1) First compile kvrocks-2.3 on target-kv

2) Copy the compiled kvrocks2redis to kvrocks2redis

3) Copy kvrocks-2.0.6 to target-kv from src-kv, set the password cceq -&$(# (KAfds) and start

4) Configure the configuration file in kvrocks2redis, and set the source database and destination database passwords to cceq -&$(# (KAfds)

5) Observe the print of the kvrocks2redis log, as follows:

E20230302 17:54:58.802428 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.802887 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.803411 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.803925 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.804463 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.804945 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.805450 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.805927 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.806439 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.806947 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.807446 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 17:54:58.807932 5467 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

6) Kill kv2redis and change the password of target-kv to tuiyi2023kvrockst

7) Restart kv2reids and observe the log printing as follows:

E20230302 18:06:49.413501 9068 sync.cc:78] auth got invalid response

E20230302 18:06:49.665562 9068 sync.cc:78] auth got invalid response

E20230302 18:06:49.809759 9068 sync.cc:78] auth got invalid response

E20230302 18:06:49.961756 9068 sync.cc:78] auth got invalid response

E20230302 18:06:50.253381 9068 sync.cc:78] auth got invalid response

E20230302 18:06:50.799962 9068 sync.cc:78] auth got invalid response

E20230302 18:06:50.817384 9068 sync.cc:78] auth got invalid response

E20230302 18:06:50.938107 9068 sync.cc:78] auth got invalid response

E20230302 18:06:50.996701 9068 sync.cc:78] auth got invalid response

E20230302 18:06:51.010406 9068 sync.cc:78] auth got invalid response

E20230302 18:06:51.021469 9068 sync.cc:78] auth got invalid response

E20230302 18:06:51.032426 9068 sync.cc:78] auth got invalid response

E20230302 18:06:51.044173 9068 sync.cc:78] auth got invalid response

8) Change the password of target-kv to x -&$(# (x)), and observe the print of kv2redis as follows

E20230302 18:08:55.798810 9871 sync.cc:78] auth got invalid response

E20230302 18:08:55.798920 9966 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 18:08:55.803305 9966 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 18:08:55.808208 9966 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 18:08:55.812773 9871 sync.cc:78] auth got invalid response

E20230302 18:08:55.816367 9966 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 18:08:55.822363 9966 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 18:08:55.827317 9966 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 18:08:55.828011 9871 sync.cc:78] auth got invalid response

E20230302 18:08:55.832218 9966 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 18:08:55.839272 9966 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

E20230302 18:08:55.844763 9966 redis_ writer.cc:112] [kvrocks2redis] redis Auth failed: -ERR invaild password

9) Close target-kv, clear the data directory and start it. Change the password to tuiyi2023kvrockstest, clear the kv2redis directory and restart it. Observe the kv2redis print as follows:

Log file created at: 2023/03/02 18:15:55

Running on machine: bj-lsy-205

Running duration (h:mm:ss): 0:00:00

Log line format: [IWEF]yyyymmdd hh:mm:ss.uuuuuu threadid file:line] msg

I20230302 18:15:55.922307 13044 storage.cc:335] [storage] Success to load the data from disk: 12 ms

I20230302 18:15:55.922664 13044 sync.cc:65] [kvrocks2redis] Start sync the data from kvrocks to redis


After printing the log, the kv2redis process exits","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WmbyT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1295,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WybF6,kvrocks,1456058746,1295,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-06T12:37:34Z,2023-03-06T12:37:34Z,"Hi @QQxiaoyuyu 

You should quote the entire config value like the below:

```
namespace.__namespace ""127.0.0.1 6379 123#456""
```

instead of

```
namespace.__namespace 127.0.0.1 6379 ""123#456""
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WybF6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1295,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wyb-W,kvrocks,1456062358,1295,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-06T12:40:37Z,2023-03-06T12:40:37Z,"I confirmed that it works as expected, welcome to reopen it if you have any questions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Wyb-W/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1295,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5W3j5D,kvrocks,1457405507,1295,NA,QQxiaoyuyu,34185590,,,NA,2023-03-07T02:28:30Z,2023-03-07T02:28:30Z,"![图片](https://user-images.githubusercontent.com/34185590/223303852-043f2cad-b3c7-4cf6-85e9-a512a6dfd3ae.png)
开始启动的时候日志报错，然后将文件删除后启动，日志没有报错，但是服务器上面没有kv2redis进程","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5W3j5D/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1295,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5W3lvJ,kvrocks,1457413065,1295,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-03-07T02:38:11Z,2023-03-07T02:38:11Z,"@QQxiaoyuyu For new issue/question, please open a ticket on:

* https://github.com/apache/incubator-kvrocks/discussions/categories/q-a
* or https://github.com/apache/incubator-kvrocks/discussions/categories/%E4%B8%AD%E6%96%87

Please don't use a single issue as a group chat.

Locking...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5W3lvJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1298,https://api.github.com/repos/apache/kvrocks/issues/1298,kvrocks,1610776702,1298,race condition between subkey compaction thread and Expire command,dongdongwcpp,85050932,Axel,,CLOSED,2023-03-06T06:49:02Z,2023-03-21T02:54:07Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

all version had the same problem.

### Minimal reproduce step

### step 1:slowdown  compacton thread@ src/storage/compact_filter.cc
```c++
bool SubKeyFilter::IsMetadataExpired(const InternalKey &ikey, const Metadata &metadata) const {
  if (metadata.Type() == kRedisString  // metadata key was overwrite by set command
      || metadata.Expired() || ikey.GetVersion() != metadata.version) {
      std::cout <<""exp:""<< metadata.expire << "",mk:""<< ikey.GetKey().ToString() << ""=>"" << ikey.GetSubKey().ToString() <<std::endl;
      cached_key_.clear(); // meta TTL will be update in another thread,so don't cache it
      usleep(100000); // slow down
    return true;
  }
  return false;
}
```


### step 2: slow down for update TTL after check expired@ src/storage/redis_db.cc
```c++
rocksdb::Status Database::Expire(const Slice &user_key, int timestamp) {
....
  if (metadata.Expired()) {
    return rocksdb::Status::NotFound(kErrMsgKeyExpired);
  }
...
sleep(2);
....
}
```

### step 3: a unit test @ tests/cppunit/t_metadata_test.cc
```c++
#include <random>
#include <thread>
using namespace std;
std::string GenRandomStr(size_t len){
  static constexpr const char* DEFAULT_CHARSET = ""0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"";

  int64_t now = rocksdb::Env::Default()->NowNanos();
  static std::default_random_engine random{static_cast<unsigned>(now)};
  static std::mt19937 random_generator(random());
  std::string rand_str_out  = std::string(DEFAULT_CHARSET);
  while(len > rand_str_out.length()) rand_str_out +=rand_str_out ;
  std::shuffle(rand_str_out.begin(), rand_str_out.end(), random_generator);
  return rand_str_out.substr(0,len);
}
TEST_F(RedisTypeTest, ExpireBug) {


  bool start_compact = false;
  bool compact_started = false;
  bool stop_running = false;

  std::thread compact_thread([&](){
    while(!stop_running){
      if(start_compact){
        rocksdb::CompactRangeOptions compact_opts;
        compact_opts.change_level = true;
        compact_started = true;
        auto s = storage_->GetDB()->CompactRange(compact_opts,nullptr,nullptr);// compaction subkey,default cf only
        ASSERT_TRUE(s.ok()) << s.ToString();
      }else{
        // waiting to start compact
        usleep(10000);
      }
    }
  });


  int uk_count = 50;  

  auto cfs = storage_->GetCFHandles();
  std::vector<FieldValue> mk_field_values;    
  std::string mk = GenRandomStr(10);
  set<string> field_no_dup ;

  for(int j=0;j<uk_count;j++){
    string field = GenRandomStr(200);
    field_no_dup.insert(field);
    mk_field_values.push_back(FieldValue{field,""0000""});
  }
  EXPECT_EQ(field_no_dup.size(),uk_count);

  int ret = 0;
  rocksdb::Status s = hash->MSet(mk, mk_field_values, false, &ret);
  EXPECT_TRUE(s.ok() && uk_count == ret);
  int64_t now;
  rocksdb::Env::Default()->GetCurrentTime(&now);
  int ttl_exp = now + 5;
  hash->Expire(mk,ttl_exp);      
  

  for(auto&item:*cfs){
    rocksdb::FlushOptions fs;
    auto s = storage_->GetDB()->Flush(fs,item);
    cout << ""flush done for:""<< item->GetName() <<"",res:"" << s.ToString()<<endl;
  }
  sleep(2);
  start_compact = true;    
  cout << ""start compact "" <<endl;

  while(!compact_started ){
    usleep(10);
  }
  
  //part field will be expired..
  bool lease_TTL_successed = false;
  rocksdb::Env::Default()->GetCurrentTime(&now);
  s = hash->Expire(mk,(int)(now+100));
  if(s.ok()){
    lease_TTL_successed = true;        
  }
    
  if(!lease_TTL_successed){
    start_compact = false;
    cout << ""try another round""<<endl;      
    return;      
  }    
  sleep(2);
  vector<FieldValue> vret;
  s = hash->GetAll(mk,&vret);
  if(s.ok()){
    EXPECT_EQ(vret.size(),uk_count);
  }else{
    cout << ""mk:""<< mk << "" is gone""<<endl;
  }
  stop_running = true;
  compact_thread.join();
}
```
### step 4 compile and run:
`make unittest && rm -rf testsdb/&& ./unittest  --gtest_filter=RedisTypeTest.ExpireBug`


### What did you expect to see?

no race condition, the key either expired or kept

### What did you see instead?

a race condition between the Expire command and the compaction thread leads to the deletion of certain fields/members from a hash/zset/set/list。
![image](https://user-images.githubusercontent.com/85050932/223037163-3dbb1d8f-8eb8-470f-8e8d-dfe5aa5716e8.png)


Specifically,this issue occurs when a key's TTL  was expiring while the Expire command's Exprire checking passed and the same time,the `SubKeyFilter(SubKeyFilter::IsMetadataExpired)` removes some subkey.
![image](https://user-images.githubusercontent.com/85050932/223036884-b53c6fce-a3d8-45f8-a57b-755edaa12cc3.png)

now the key's TTL is updated success but some field/membert were disappeared. 


### Anything Else?

a lazy delete of the subkey may by plus 1 min when a compaction thread checking meta's Expred for subkey may help.


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1298/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1298,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WweX7,kvrocks,1455547899,1298,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-06T06:52:40Z,2023-03-06T06:52:40Z,@dongdongwcpp Thanks for your feedback. Agree that lazy deletion can fix this corner case.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5WweX7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/1301,kvrocks,1615340297,1301,Add support of bulk load for the string like HBase bulkload,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-03-08T14:08:59Z,2024-04-12T02:21:58Z,"### Motivation

Many scenarios need to bulk-load mass data regularly, and it may bring heavy workload and latency spike if loads through the API interface. So it will be better if we can offer a way to mitigate this issue.

### Solution

We can use [RocksDB Ingest SST](https://github.com/EighteenZi/rocksdb_wiki/blob/master/Creating-and-Ingesting-SST-files.md) to bulk load those data and support for simple strings only.

see more discussions in https://github.com/apache/kvrocks/discussions/1628","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1301/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XGF6t,kvrocks,1461214893,1301,NA,zuston,8609142,Junfan Zhang,zuston@apache.org,NA,2023-03-09T03:30:36Z,2023-03-09T03:30:36Z,Thanks for  proposing this. +1 for this feature.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XGF6t/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZBmAN,kvrocks,1493590029,1301,NA,ColinChamber,95634254,ColinChamber,,NA,2023-04-03T03:23:00Z,2023-04-03T03:23:00Z, I'm willing to submit a PR! ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZBmAN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZBo0k,kvrocks,1493601572,1301,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-03T03:51:25Z,2023-04-03T03:51:25Z,@ColinChamber Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZBo0k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eT0Bt,kvrocks,1582252141,1301,NA,liucyao1990,135965441,,,NA,2023-06-08T09:55:41Z,2023-06-08T09:55:41Z,"@git-hulk @ColinChamber Thanks for this PR , Is there any progress？looking forward to this bulkload function","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eT0Bt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eagSc,kvrocks,1584006300,1301,NA,ColinChamber,95634254,ColinChamber,,NA,2023-06-09T05:41:46Z,2023-06-09T05:41:46Z,Recently I haven't had enough time. Looking forward to others to achieve it. Unassigned. @liucyao1990 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eagSc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eagc1,kvrocks,1584006965,1301,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T05:42:52Z,2023-06-09T05:42:52Z,Thanks @ColinChamber for your update.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eagc1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5e9S52,kvrocks,1593126518,1301,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-15T13:58:38Z,2023-06-15T13:58:38Z,"@git-hulk For this feature, we need provide a command to load data, or provide a tool?

In my opinion, there are two steps here. 
1. Create SST files with the data.
2. Ingest the SST files. 

The second step requires stopping the world.

Do we need to support online bulk load? Will there be problems with stopping the world?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5e9S52/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5e-It0,kvrocks,1593346932,1301,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-15T16:04:02Z,2023-06-15T16:04:02Z,"> In my opinion, there are two steps here.
 Create SST files with the data.
 Ingest the SST files.

@jihuayu Yes, you're right. And I think it's good to only support the string type first. 

> Do we need to support online bulk load? Will there be problems with stopping the world?

My intuitive thought is yes for the online bulk load, even though it will block the write operations when ingesting SSTs.

> For this feature, we need provide a command to load data, or provide a tool?

From my side, I would like to support loading the local SSTs via command and also provides a tool to generate SST files. For the tool input file, we can require users to put their data in a specified format like CSV or others. 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5e-It0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fGZJX,kvrocks,1595511383,1301,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-17T00:27:18Z,2023-06-17T00:27:18Z,"@git-hulk  Ok, I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fGZJX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHJnZ,kvrocks,1595709913,1301,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-17T11:06:08Z,2023-06-17T11:06:08Z,"Thanks @jihuayu, assigned.

@zuston @liucyao1990 Also welcome to provide more input about how to use the bulk load.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHJnZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fJvq9,kvrocks,1596390077,1301,NA,liucyao1990,135965441,,,NA,2023-06-19T02:24:17Z,2023-06-19T02:24:17Z,"@git-hulk @jihuayu Hi, here is the bulk load ingestion implementation of Pegasus. https://github.com/apache/incubator-pegasus/pulls?q=label%3Acomponent%2Fbulk_load+. FYI","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fJvq9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fJwGg,kvrocks,1596391840,1301,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-19T02:27:12Z,2023-06-19T02:27:12Z,"> @git-hulk @jihuayu Hi, here is the bulk load ingestion implementation of pegasus. https://github.com/apache/incubator-pegasus/pulls?q=label%3Acomponent%2Fbulk_load+. FYI

Cool, thanks for your input.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fJwGg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5frh2Z,kvrocks,1605246361,1301,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-24T03:15:13Z,2023-06-24T03:15:13Z,"I will first create the SST generation tool.
we have  `cluster` and `replication` mode, `Ingest SST` may be different. I think I can first support Ingest in standalone mode.



","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5frh2Z/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5frlNj,kvrocks,1605260131,1301,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-24T04:25:09Z,2023-06-24T04:25:09Z,"Yes, that's right. It's good to NOT support the replication for now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5frlNj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM552W28,kvrocks,2044292540,1301,NA,JackyYangPassion,13795366,YangJiaqi,yang.jiaqi.hadoop@gmail.com,NA,2024-04-09T07:10:57Z,2024-04-09T07:10:57Z,Are there any updates here?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM552W28/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM559yI7,kvrocks,2046239291,1301,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-04-10T00:22:42Z,2024-04-10T00:22:42Z,@JackyYangPassion No. Do you want to have a try?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM559yI7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56PMIT,kvrocks,2050802195,1301,NA,JackyYangPassion,13795366,YangJiaqi,yang.jiaqi.hadoop@gmail.com,NA,2024-04-12T01:23:49Z,2024-04-12T01:23:49Z,"

> @JackyYangPassion No. Do you want to have a try?

Okk,
I've been researching how to generate SST files recently.

I looked carefully discussions in https://github.com/apache/kvrocks/discussions/1628 

Initially, this function only supports String type?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56PMIT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56PTYa,kvrocks,2050831898,1301,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-12T01:59:51Z,2024-04-12T01:59:51Z,"@JackyYangPassion Yes, we would like to support the string first since it's the simplest one. And it's definitely great if can involve other data types.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56PTYa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56PXo0,kvrocks,2050849332,1301,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-04-12T02:21:57Z,2024-04-12T02:21:57Z,"@JackyYangPassion Thank you!
Supporting strings is our first step in the plan. We want to start by creating a basic version to provide to users for their use. This way, we can gather feedback from users on the functionality as early as possible. 
In the later stages, we will support more types and functionalities.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56PXo0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1305,https://api.github.com/repos/apache/kvrocks/issues/1305,kvrocks,1616717066,1305,Scan command response cursor is not a u64,mybee,8556916,,,CLOSED,2023-03-09T08:48:49Z,2023-03-09T09:07:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

I use docker to run the kvrocks image which from docker hub with latest version

### Minimal reproduce step

10.20.40.82:6666> scan 0
1) ""_FFWKCSNQDUGEYXCYAENRYPAZIYDLEPNFHSKHIKJKGKIXJUUXSJGSIXKJEHHOFFSBUPJRKBJFDRBQRZUGDLZLNDEDITICAOBCPNOVJGEJYTELZXFRTSBXOCPKBXVUXCOUKDHWFMYJBDYTHTMWQHNHGCQINMSBTANFRSKTN""
2)  1) ""AHPNTDUXLGRYJVFVNZGDWVSFNCFQXLGZKWGXQOIRUSNQCLTUAISPHVYFQTBULMWRFIOAKVVCGKSSHOBYEJGFURW""
    2) ""AYTLNVRHLWAYHNHJLCSOMO""
    3) ""AZTTNRFRUDIXFHHMOVULSMTVUOMVXTCLHVCOUWMBAESWOTHJPJCNQTFVZBL""

### What did you expect to see?

10.20.40.82:6666> scan 0
1) ""0""
2)  1) ""AHPNTDUXLGRYJVFVNZGDWVSFNCFQXLGZKWGXQOIRUSNQCLTUAISPHVYFQTBULMWRFIOAKVVCGKSSHOBYEJGFURW""
    2) ""AYTLNVRHLWAYHNHJLCSOMO""
    3) ""AZTTNRFRUDIXFHHMOVULSMTVUOMVXTCLHVCOUWMBAESWOTHJPJCNQTFVZBL""


**this is my expect as like as redis.**

### What did you see instead?

10.20.40.82:6666> scan 0
1) ""_FFWKCSNQDUGEYXCYAENRYPAZIYDLEPNFHSKHIKJKGKIXJUUXSJGSIXKJEHHOFFSBUPJRKBJFDRBQRZUGDLZLNDEDITICAOBCPNOVJGEJYTELZXFRTSBXOCPKBXVUXCOUKDHWFMYJBDYTHTMWQHNHGCQINMSBTANFRSKTN""
2)  1) ""AHPNTDUXLGRYJVFVNZGDWVSFNCFQXLGZKWGXQOIRUSNQCLTUAISPHVYFQTBULMWRFIOAKVVCGKSSHOBYEJGFURW""
    2) ""AYTLNVRHLWAYHNHJLCSOMO""
    3) ""AZTTNRFRUDIXFHHMOVULSMTVUOMVXTCLHVCOUWMBAESWOTHJPJCNQTFVZBL""

### Anything Else?

I find this problem when I use redis-rs(Rust) to call kvrocks with scan command, the redis-rs panic the err:

Error: Response was of incompatible type: ""Could not convert from string."" (response was string-data('""_IRCEGAGIOIRFVOQZJTKDLXGZWBWRMUUKLXNPCRWXFQSQEWULLVFVXLTSVLRZSLJWPZEPVZURGWLFRRFWZIIVDWWFEXBEQIWSARRVPVNDCRNBEKZSOLNVIOAIGYVFRVXHJQCPYAHHZOTTAVZHIGNHSGLQEUVWFWJBBBDJRAIETFPFBWEOFPLCLED""'))

the error means: **the cursor is not a number, so can not convert to u64**


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1305/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XHhmd,kvrocks,1461590429,1305,NA,PragmaTwice,20042607,Twice,,NA,2023-03-09T08:52:17Z,2023-03-09T08:52:17Z,Duplicated. See #534 and #417.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XHhmd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XHiDU,kvrocks,1461592276,1305,NA,PragmaTwice,20042607,Twice,,NA,2023-03-09T08:53:32Z,2023-03-09T08:53:32Z,"For redis-rs, I think you can use `cmd(..).arg(..)...` directly instead of the wrapped method `scan`, to workaround it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XHiDU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XHmM-,kvrocks,1461609278,1305,NA,mybee,8556916,,,NA,2023-03-09T09:03:55Z,2023-03-09T09:03:55Z,"Thank you for the quick response and explanation. I get it.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XHmM-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XHno7,kvrocks,1461615163,1305,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-09T09:07:50Z,2023-03-09T09:07:50Z,"Yes, the scan's cursor incompatibility problem brings a lot of confusion, but still didn't find a way to keep consistent with Redis.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XHno7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1306,https://api.github.com/repos/apache/kvrocks/issues/1306,kvrocks,1616764059,1306,Add support of the new data structure JSON (RedisJSON),PragmaTwice,20042607,Twice,,CLOSED,2023-03-09T09:15:04Z,2023-10-22T12:42:48Z,"Refer to https://github.com/apache/incubator-kvrocks/discussions/1270.

As a plan in [Kvrocks 2023 Roadmap](https://github.com/orgs/apache/projects/199), we are eager to explore the ability to implement RedisJSON-like command set for kvrocks.

Everyone is welcome to ask questions, or contribute your ideas/PRs.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1306/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1306,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YFzKI,kvrocks,1477915272,1306,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-03-21T14:14:23Z,2023-03-21T14:14:23Z,I think  https://github.com/danielaparker/jsoncons is very appropriate。,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YFzKI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1306,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YXxEj,kvrocks,1482625315,1306,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-03-24T11:04:54Z,2023-03-24T11:04:54Z,"I'd like to pickup this issue, and I'll finish it next month. You can just assign it to me","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YXxEj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1306,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YYU2P,kvrocks,1482771855,1306,NA,PragmaTwice,20042607,Twice,,NA,2023-03-24T13:09:15Z,2023-03-24T13:09:15Z,"> I'd like to pickup this issue, and I'll finish it next month. You can just assign it to me

Sure. Go ahead!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YYU2P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1306,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eaanC,kvrocks,1583983042,1306,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T05:08:58Z,2023-06-09T05:08:58Z,@mapleFU Are you still working on this?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eaanC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1306,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eab_O,kvrocks,1583988686,1306,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-06-09T05:16:27Z,2023-06-09T05:16:27Z,"Sorry for late reply, I'm a little busy these days. I'll give an RFC next week when I'm out for holidays","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eab_O/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1306,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eacht,kvrocks,1583990893,1306,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T05:19:43Z,2023-06-09T05:19:43Z,"Sure, thanks for your update. Just to confirm if you have time on this. Hope you have a good vacation.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eacht/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1306,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pvmMF,kvrocks,1774084869,1306,NA,PragmaTwice,20042607,Twice,,NA,2023-10-22T12:42:48Z,2023-10-22T12:42:48Z,See #1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pvmMF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/1307,kvrocks,1616770713,1307,Add support of the new data structure HyperLogLog,PragmaTwice,20042607,Twice,,CLOSED,2023-03-09T09:18:43Z,2025-01-28T02:25:08Z,"As a plan in [Kvrocks 2023 Roadmap](https://github.com/orgs/apache/projects/199), we are eager to explore the ability to implement HyperLogLog commands in Redis for kvrocks.

Everyone is welcome to ask questions, or contribute your ideas/PRs.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1307/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XVG4A,kvrocks,1465150976,1307,NA,dongdongwcpp,85050932,Axel,,NA,2023-03-12T10:20:33Z,2023-03-12T10:20:33Z,"I am working on this,just assign to me","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XVG4A/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XVLhj,kvrocks,1465170019,1307,NA,PragmaTwice,20042607,Twice,,NA,2023-03-12T11:36:15Z,2023-03-12T11:36:15Z,Glad to hear that. Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XVLhj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fEqhd,kvrocks,1595058269,1307,NA,PragmaTwice,20042607,Twice,,NA,2023-06-16T18:03:55Z,2023-06-16T18:03:55Z,"Hi @dongdongwcpp, how is it going now?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fEqhd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHiQM,kvrocks,1595810828,1307,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-17T17:17:15Z,2023-06-17T17:17:15Z,I'd like to design the part in kvrocks. And I'm considering the storage about hyperloglog. ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHiQM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fJHG-,kvrocks,1596223934,1307,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-18T18:01:06Z,2023-06-18T18:01:06Z,"In a few days, I will present a concrete idea.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fJHG-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gffa6,kvrocks,1618867898,1307,NA,PragmaTwice,20042607,Twice,,NA,2023-07-03T16:42:37Z,2023-07-03T16:42:37Z,@dongdongwcpp Released for long time nonresponse. Feel free to participate the community via other tasks : ),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gffa6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gffq7,kvrocks,1618868923,1307,NA,PragmaTwice,20042607,Twice,,NA,2023-07-03T16:43:05Z,2023-07-03T16:43:05Z,"> In a few days, I will present a concrete idea.

Thanks! Assigned.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gffq7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gfh5n,kvrocks,1618878055,1307,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-07-03T16:49:15Z,2023-07-03T16:49:15Z,"> > In a few days, I will present a concrete idea.
> 
> Thanks! Assigned.

Some questions I haven't thought through, and time is limited, so it's going to take some time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gfh5n/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nN7ii,kvrocks,1731704994,1307,NA,PragmaTwice,20042607,Twice,,NA,2023-09-22T16:25:54Z,2023-09-22T16:25:54Z,@infdahai How is it going now? Feel free to share your problems with us.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nN7ii/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sf7PR,kvrocks,1820308433,1307,NA,Yangsx-1,85615957,Hauru,,NA,2023-11-21T06:21:02Z,2023-11-21T06:21:02Z,I'd like to take over this task. @PragmaTwice ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sf7PR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sjXZV,kvrocks,1821210197,1307,NA,PragmaTwice,20042607,Twice,,NA,2023-11-21T16:03:00Z,2023-11-21T16:03:00Z,"> I'd like to take over this task. @PragmaTwice

Great! Assigned.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sjXZV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5x78Gk,kvrocks,1911538084,1307,NA,qujihan,43026824,,qujihan@163.com,NA,2024-01-26T06:12:38Z,2024-01-26T06:12:38Z,"Hello, I have observed that this issue has not progressed for a long time.. Are you still doing it now? If not, I want to try it. @Yangsx-1 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5x78Gk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5x79wc,kvrocks,1911544860,1307,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-26T06:21:08Z,2024-01-26T06:21:08Z,"@qujihan Sure, I have changed the assigned. Thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5x79wc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5x7-zN,kvrocks,1911549133,1307,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-26T06:26:49Z,2024-01-26T06:26:49Z,"You can first draft a format in discussion, and then move forward to implement it.

Some database uses HLL to optimize the ndv:
1. https://github.com/facebookincubator/velox/tree/main/velox/common/hyperloglog
2. https://github.com/ClickHouse/ClickHouse/blob/92e63bf45c3cd36163131e42d4bd003e543031f4/src/Common/HyperLogLogCounter.h

You can choose them or using similar like HLL in Redis","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5x7-zN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5x8BJt,kvrocks,1911558765,1307,NA,Yangsx-1,85615957,Hauru,,NA,2024-01-26T06:38:16Z,2024-01-26T06:38:16Z,"> Hello, I have observed that this issue has not progressed for a long time.. Are you still doing it now? If not, I want to try it. @Yangsx-1

Just do it! I'm very busy these days, you can take this task.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5x8BJt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1307,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52M7KS,kvrocks,1983099538,1307,NA,tutububug,40481744,,,NA,2024-03-07T09:35:31Z,2024-03-07T09:35:31Z,"@PragmaTwice I create a PR #2142 for support hyperloglog. 
The core algorithm code is transplanted from redis, and may have optimization room on disk storage.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52M7KS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/1309,kvrocks,1617338477,1309,Bump Snappy to 1.1.10,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2023-03-09T14:12:51Z,2023-04-23T15:07:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We can try to use a newest release of Google Snappy library (1.10.0+, [https://github.com/google/snappy/releases/tag/1.1.10](https://github.com/google/snappy/releases/tag/1.1.10)). 

But at now googler's broke a Clang support, so I'am  waiting to fix release. 

I remember, that we had a some bug with snappy early (e.g. https://github.com/apache/incubator-kvrocks/issues/788), maybe in this release they are fixed. Let's try to check. 

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1309/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XJs02,kvrocks,1462160694,1309,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-09T14:30:19Z,2023-03-09T14:30:19Z,"Thanks @aleksraiden, can use `redis-benchmark -p 6666 -t set -d 102400 -r 100000000 -n 10000000` to check if the bug still exists.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XJs02/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XJwrM,kvrocks,1462176460,1309,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-09T14:40:50Z,2023-03-09T14:40:50Z,"@git-hulk Lot of thanks, I check this into my private fork asap.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XJwrM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XOz0o,kvrocks,1463500072,1309,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-10T09:12:57Z,2023-03-10T09:12:57Z,A bug with corrupted  compression block have no reproduce in all my tests - Debian 11 х64 and special test unit with CentOS 7.9.2009 х64.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XOz0o/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XPfnK,kvrocks,1463679434,1309,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-10T11:37:58Z,2023-03-10T11:37:58Z,Thanks for your efforts.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XPfnK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XPhO3,kvrocks,1463686071,1309,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-10T11:44:30Z,2023-03-10T11:44:30Z,This would be a largest test platform for me - 3Tb volume dedicated for kvrocks ),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XPhO3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XVnM_,kvrocks,1465283391,1309,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-12T19:45:42Z,2023-03-12T19:45:42Z,"@torwig create a patch for Snappy with correct fix current problem (~1 LoC!!!! just see - https://github.com/google/snappy/pull/165) but we have no idea about how long a Googlers will be  thinking about it for a fix. So, could we can try a quick fix like LuaJIT - fork Google/Snappy repository into KVRocks lab, apply our fix and use a new Snappy codec right now. And in a future, when a new release of Snappy are shipped, we switch to use them. 

What you think about this? @git-hulk @tisonkun @torwig @PragmaTwice @ShooterIT","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XVnM_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XWBTn,kvrocks,1465390311,1309,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-13T01:56:39Z,2023-03-13T01:56:39Z,@aleksraiden I prefer to wait for @torwig's PR to be merged because the old version works well now. To see if others folks have any thoughts on this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XWBTn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XWmLf,kvrocks,1465541343,1309,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-03-13T05:33:37Z,2023-03-13T05:33:37Z,"1. CMake supports such simple patches during the compile stage.
2. Generally, we don't maintain too many hacks upstream, you can apply the patch and run the revision in your prod, that's how OSS stratifies customized usage.

So I'm -1 on forking a new repo, but choose either 1 or 2 above.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XWmLf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XYUDt,kvrocks,1465991405,1309,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-13T11:43:50Z,2023-03-13T11:43:50Z,"Ok, let's wait, I pinged one of the committers in snappy repo. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XYUDt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aKn0X,kvrocks,1512733975,1309,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-04-18T09:09:28Z,2023-04-18T09:09:28Z,"In a Snappy repo bug are fixed now, just waiting a new release tag.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aKn0X/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aKoOB,kvrocks,1512735617,1309,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-18T09:10:36Z,2023-04-18T09:10:36Z,"Hi @aleksraiden, great thanks for your follow-up.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aKoOB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aifSr,kvrocks,1518990507,1309,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-04-23T08:17:12Z,2023-04-23T08:17:12Z,"So, I add a new version of Snappy (based on this commit https://github.com/google/snappy/commit/f725f6766bfc62418c6491b504c8e5865ec99412), with (in addition to 1.10.0):
- Optimization of decompression in ARM platform
- Add prefetch for compression
- Fix -Wsign-compare bug

Because a Snappy have a something like 1-Year release cycle, and because this (1.10) release have a lot of performance improvements, my propose is use this version without waiting a next release of them.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aifSr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1309,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ai3U4,kvrocks,1519088952,1309,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-04-23T15:07:10Z,2023-04-23T15:07:10Z,"Done, now closing, thanks to all!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ai3U4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1311,https://api.github.com/repos/apache/kvrocks/issues/1311,kvrocks,1618528971,1311,set empty string will get null with 2.3.0 version,luger1990,2096878,Luger Smith,,CLOSED,2023-03-10T08:00:15Z,2023-03-12T05:43:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.3.0

### Minimal reproduce step

```
192.168.100.167:6389> hset luger a ''
(integer) 1
192.168.100.167:6389> hgetall luger
1) ""a""
2) (nil)
192.168.100.167:6389> 
```

### What did you expect to see?

```
192.168.100.167:6389> hset luger a ''
(integer) 1
192.168.100.167:6389> hgetall luger
1) ""a""
2) """"
192.168.100.167:6389> 

```

### What did you see instead?

```
192.168.100.167:6389> hset luger a ''
(integer) 1
192.168.100.167:6389> hgetall luger
1) ""a""
2) (nil)
192.168.100.167:6389> 
```

### Anything Else?

set empty return nil, if i use jedis i will get exception like below
```
java.lang.NullPointerException
	at java.lang.String.<init>(String.java:491)
	at redis.clients.jedis.util.SafeEncoder.encode(SafeEncoder.java:41)
	at redis.clients.jedis.BuilderFactory$20.build(BuilderFactory.java:374)
	at redis.clients.jedis.BuilderFactory$20.build(BuilderFactory.java:366)
	at redis.clients.jedis.Jedis.hgetAll(Jedis.java:1040)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:725)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:149)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:140)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:84)
	at org.junit.jupiter.engine.execution.ExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(ExecutableInvoker.java:115)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.lambda$invoke$0(ExecutableInvoker.java:105)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:104)
	at org.junit.jupiter.engine.execution.ExecutableInvoker.invoke(ExecutableInvoker.java:98)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:214)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:210)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:135)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:66)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:151)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at java.util.ArrayList.forEach(ArrayList.java:1257)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:155)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:141)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:139)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:138)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:95)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:107)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:88)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:67)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:52)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:114)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:86)
	at org.junit.platform.launcher.core.DefaultLauncherSession$DelegatingLauncher.execute(DefaultLauncherSession.java:86)
	at org.junit.platform.launcher.core.SessionPerRequestLauncher.execute(SessionPerRequestLauncher.java:53)
	at com.intellij.junit5.JUnit5IdeaTestRunner.startRunnerWithArgs(JUnit5IdeaTestRunner.java:71)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater$1.execute(IdeaTestRunner.java:38)
	at com.intellij.rt.execution.junit.TestsRepeater.repeat(TestsRepeater.java:11)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:35)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:235)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:54)

```

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1311/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1311,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XOjLX,kvrocks,1463431895,1311,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-10T08:14:26Z,2023-03-10T08:14:26Z,"@luger1990 Thanks for your feedback, will fix it soon and PR is always welcome if you're willing to do this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XOjLX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1311,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XOrI0,kvrocks,1463464500,1311,NA,luger1990,2096878,Luger Smith,,NA,2023-03-10T08:45:15Z,2023-03-10T08:45:15Z,"please fix it ASAP, thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XOrI0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1317,https://api.github.com/repos/apache/kvrocks/issues/1317,kvrocks,1620799380,1317,2.0.6 slaveof 2.3 version can not running,QQxiaoyuyu,34185590,,,CLOSED,2023-03-13T05:50:07Z,2023-03-19T12:00:37Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

2.0.6 slaveof 2.3 can not running
![图片](https://user-images.githubusercontent.com/34185590/224618143-d7f6e32c-8ac7-4f88-9074-7dfc19c0f8c1.png)


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1317/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1317,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XW4O9,kvrocks,1465615293,1317,NA,QQxiaoyuyu,34185590,,,NA,2023-03-13T07:05:08Z,2023-03-13T07:05:08Z,将2.3的storge.cc  stream column family去掉，然后用2.3的数据启动无法启动,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XW4O9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1317,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XX8tk,kvrocks,1465895780,1317,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-13T10:38:55Z,2023-03-13T10:38:55Z,@torwig Could we check this?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XX8tk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1317,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XYBGD,kvrocks,1465913731,1317,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-13T10:52:21Z,2023-03-13T10:52:21Z,"There're two problems with this issue:

- For the old version slave cannot be compatible with the newer one since it may miss some column families
- The slave instance should not crash after failing to restore from the DB","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XYBGD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1317,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Xc-TH,kvrocks,1467212999,1317,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-14T01:38:17Z,2023-03-14T01:38:17Z,"The crash line is https://github.com/apache/incubator-kvrocks/blob/2.0/src/server.cc#L496 and the root cause is that the cron thread may use the db pointer which will be null during the restore process.

Thanks for @QQxiaoyuyu information.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Xc-TH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1317,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XdbfO,kvrocks,1467332558,1317,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-14T04:18:08Z,2023-03-14T04:18:08Z,"I took a look at the implementation, this crash issue has been fixed in https://github.com/apache/incubator-kvrocks/pull/278","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XdbfO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1319,https://api.github.com/repos/apache/kvrocks/issues/1319,kvrocks,1622596995,1319,Instantly a large number of writes may cause the slave to enter an infinite loop of full sync ,guoxiangCN,30590325,mzygdeaq@163.com,,CLOSED,2023-03-14T02:10:53Z,2023-03-17T14:50:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

Linux 3.10.0-1160.42.2.el7.x86_64
Kvrocks v2.3.0

### Minimal reproduce step

1. modify config rocksdb.wal_ttl_seconds 10800  // aka 3hour
2. modify config rocksdb.wal_size_limit_mb 51200 // aka 50GiB

Accoding to the checkpoint save/resue logic, we can inspect that share_time = 3600s
```
    // Replicas can share checkpiont to replication if the checkpoint existing
    // time is less half of WAL ttl.
    int64_t can_shared_time = storage->config_->RocksDB.WAL_ttl_seconds / 2;
    if (can_shared_time > 60 * 60) can_shared_time = 60 * 60;
    if (can_shared_time < 10 * 60) can_shared_time = 10 * 60;
    auto now = static_cast<time_t>(Util::GetTimeStamp());
    if (now - storage->GetCheckpointCreateTime() > can_shared_time) {
      LOG(WARNING) << ""[storage] Can't use current checkpoint, waiting next checkpoint"";
      return Status(Status::NotOK, ""Can't use current checkpoint, waiting for next checkpoint"");
    }
    LOG(INFO) << ""[storage] Use current existing checkpoint"";
```

In order to reproduce this bug, we only need to write more than 50GiB of data in a short time, and the WAL log will be rorated. At this time, there will be a hole between MaxLsnInCheckpoint and MinLsnInWAL, which will trigger fullsync. However, due to the shared of checkpoint_ Time is set to 1 hour, so the old checkpoint will be used and sent to slave again Since then, we have fallen into a fullsyn loop until 1 hour elapsed.

### What did you expect to see?

the slave works well

### What did you see instead?

the slave was in an infinite loop of full sync, it cannot work and the master needs to waste a lot of bandwidth to re-synchronize data to slaves.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1319/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1319,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XdEr_,kvrocks,1467239167,1319,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-14T02:16:03Z,2023-03-14T02:16:03Z,"@guoxiangCN Thanks for your feedback, it's indeed a problem. I prepared the commits to resolve this issue, can help to have a try when you're free.

https://github.com/apache/incubator-kvrocks/commit/339532bc636cbd7836bd4c88dd0c14493a51331e","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5XdEr_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/1338,kvrocks,1632184430,1338,Add basic tests for kvrocks2redis,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2023-03-20T14:04:29Z,2024-04-21T03:11:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

So that we're sure that the fundamental functions of kvrocks2redis work well.

### Solution

@git-hulk I'm still counting on you to understand how to use kvrocks2redis. So that we can add some gocase to cover those usages.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1338/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5X_9aB,kvrocks,1476384385,1338,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-20T14:56:31Z,2023-03-20T14:56:31Z,It should be hard to add Go test cases for this tool but can add a fixed dataset to make sure it works well with those data types.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5X_9aB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YADT3,kvrocks,1476408567,1338,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-03-20T15:09:11Z,2023-03-20T15:09:11Z,"@git-hulk That can be the case. But before we dive into the implementation, I suggest we reach a consensus on what fundamental functions of kvrocks2redis are and how a user manually use it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YADT3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YAIgP,kvrocks,1476429839,1338,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-20T15:20:45Z,2023-03-20T15:20:45Z,"OK, let me add a how-to-use kvrocks2redis doc first.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YAIgP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5adpAW,kvrocks,1517719574,1338,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-04-21T12:04:13Z,2023-04-21T12:04:13Z,"> OK, let me add a how-to-use kvrocks2redis doc first.

@git-hulk do you have a plan or estimate on this ticket?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5adpAW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aecgk,kvrocks,1517930532,1338,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-21T14:35:34Z,2023-04-21T14:35:34Z,"@tisonkun Yes, I wonder if I should refactor this tool since it's NOT easy to maintain now. But I haven't started it yet. Plan to do that at the beginning of May, after I released the first version of the controller: https://github.com/KvrocksLabs/kvrocks_controller/issues/49","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aecgk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iSDyu,kvrocks,1648901294,1338,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-07-25T02:29:38Z,2023-07-25T02:29:38Z,"@git-hulk can you provide some basic how-to-use info here so that I can follow up?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iSDyu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iSKQb,kvrocks,1648927771,1338,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-25T02:44:46Z,2023-07-25T02:44:46Z,"> @git-hulk can you provide some basic how-to-use info here so that I can follow up?

Sure, thanks. Sorry for forgetting this, I'll add the how-to-use doc this week first.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iSKQb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jkvEZ,kvrocks,1670574361,1338,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-08-09T02:47:26Z,2023-08-09T02:47:26Z,Related to https://github.com/apache/kvrocks-website/pull/138.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jkvEZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1338,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jkz2w,kvrocks,1670593968,1338,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-09T03:20:48Z,2023-08-09T03:20:48Z,I also created another issue #1643 to track improvements of `kvrocks2redis`.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jkz2w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1344,https://api.github.com/repos/apache/kvrocks/issues/1344,kvrocks,1635401516,1344,Add BACKUP new command with options,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,OPEN,2023-03-22T09:43:16Z,2023-03-24T05:45:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

At now we have only BGSAVE command (for compatibility with original Redis semantic), and need a separate SET config options for backup_path. And, as I see, not supporting sync/async mode of backup.

### Solution

Command BGSAVE hasn't clear semantic, so I propose a new command: BACKUP <backup_path> SYNC|ASYNC

- <backup_path> are optional path to store current backup (e.g. /tmp/backup etc.) If backup are exists, it will be destroy before perform a new.
- SYNC|ASYNC is an option flag (default are ASYNC) for creating backup using sync/async method (see [BackupableDBOptions::sync](https://rocksdb.org/blog/2014/03/27/how-to-backup-rocksdb.html)

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1344/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1344,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YPBXQ,kvrocks,1480332752,1344,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-22T22:20:18Z,2023-03-22T22:20:18Z,A some internal discussion are here - https://github.com/apache/incubator-kvrocks/discussions/483,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YPBXQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1344,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YWdpO,kvrocks,1482283598,1344,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-24T05:45:09Z,2023-03-24T05:45:09Z,"Hi @aleksraiden 

I think it's a good proposal, I even think if possible to backup and restore from the remote storage directly. https://github.com/orgs/apache/projects/199?pane=issue&itemId=23218575","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YWdpO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1346,https://api.github.com/repos/apache/kvrocks/issues/1346,kvrocks,1636477332,1346,SSCAN returns a cursor that cannot be cast to a number,JohnEskimSmith,3313476,Andrey Skhomenko,,CLOSED,2023-03-22T20:49:28Z,2023-04-01T13:53:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

docker image:
apache/kvrocks:nightly
apache/kvrocks:2.3.0

checked with:
1. redis-cli
2. python3.11, package redis==4.5.3
3. go

### Minimal reproduce step

```127.0.0.1:9090> sadd set1 a b c d e f g h i j k l m n o p q r s t u v w x y z
(integer) 26
127.0.0.1:9090> smembers set1
 1) ""a""
 2) ""b""
 3) ""c""
 4) ""d""
 5) ""e""
 6) ""f""
 7) ""g""
 8) ""h""
 9) ""i""
10) ""j""
11) ""k""
12) ""l""
13) ""m""
14) ""n""
15) ""o""
16) ""p""
17) ""q""
18) ""r""
19) ""s""
20) ""t""
21) ""u""
22) ""v""
23) ""w""
24) ""x""
25) ""y""
26) ""z""
127.0.0.1:9090> sscan set1 0
1) ""t""
2)  1) ""a""
    2) ""b""
    3) ""c""
    4) ""d""
    5) ""e""
    6) ""f""
    7) ""g""
    8) ""h""
    9) ""i""
   10) ""j""
   11) ""k""
   12) ""l""
   13) ""m""
   14) ""n""
   15) ""o""
   16) ""p""
   17) ""q""
   18) ""r""
   19) ""s""
   20) ""t""
127.0.0.1:9090>
```
![1](https://user-images.githubusercontent.com/3313476/227031572-e47df71b-9bc7-4b03-a1df-c5af3b48ce95.jpg)
![2](https://user-images.githubusercontent.com/3313476/227031578-bb952ffb-63d9-4956-a3ba-2599b7ad36f8.jpg)


### What did you expect to see?

For Redis:
```
127.0.0.1:6379> sscan set1 0
1) ""1""
2)  1) ""e""
    2) ""o""
    3) ""q""
    4) ""h""
    5) ""t""
    6) ""a""
    7) ""m""
    8) ""d""
    9) ""u""
   10) ""b""
   11) ""v""
127.0.0.1:6379> sscan set1 1
1) ""7""
2)  1) ""x""
    2) ""w""
    3) ""i""
    4) ""c""
    5) ""s""
    6) ""g""
    7) ""r""
    8) ""l""
    9) ""p""
   10) ""n""
   11) ""k""
127.0.0.1:6379> sscan set1 7
1) ""0""
2) 1) ""f""
   2) ""j""
   3) ""z""
   4) ""y""
127.0.0.1:6379>
```
As we can see: cursor always is number. Moreover, the Python and Go libraries expect the cursor value to be represented as an integer. And of course code break when the cursor is not converted to a number.
![redis-good](https://user-images.githubusercontent.com/3313476/227032746-b1e33ade-ff24-4c20-8fe4-aa45efb42936.png)


### What did you see instead?

SSCAN returned cursor cannot be represented as a number

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1346/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1346,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YQGsR,kvrocks,1480616721,1346,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-23T05:18:33Z,2023-03-23T05:18:33Z,"Hi @JohnEskimSmith

It's an expected behavior, Kvrocks didn't have the hash bucket distribution, so it cannot return the cursor as a number now. To workaround, can use the fork version of redis-py: https://github.com/hashlookup/redis-py which is from @adulau.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YQGsR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1346,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YQGxp,kvrocks,1480617065,1346,NA,PragmaTwice,20042607,Twice,,NA,2023-03-23T05:19:05Z,2023-03-23T05:19:05Z,"Duplicated. See #1305, https://github.com/apache/incubator-kvrocks/issues/534 and https://github.com/apache/incubator-kvrocks/discussions/417.

To modify the client implementation, see [e9c53fb1398e636106c0ec0165ba564943564a83](https://github.com/hashlookup/redis-py/commit/e9c53fb1398e636106c0ec0165ba564943564a83).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YQGxp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1346,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YQXh6,kvrocks,1480685690,1346,NA,JohnEskimSmith,3313476,Andrey Skhomenko,,NA,2023-03-23T06:52:45Z,2023-03-23T06:52:45Z,"Hi @git-hulk
Thanks for the reply. Prior to posting the question, for myself, I quickly found how to get around this issue with change client.
The problem is of course with the compatibility of libraries and languages. And with a service with backend Kvrocks, that clients can access both with python or go(other...), you(me) have to keep this in mind, that very sad.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YQXh6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1346,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YV_3T,kvrocks,1482161619,1346,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-24T02:23:41Z,2023-03-24T02:23:41Z,"@JohnEskimSmith Yes, we have also realized and tried to work around this confusion.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YV_3T/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/1350,kvrocks,1639321548,1350,Add the support of  the blocking migration for the cluster migrate command,ellutionist,35825540,CHENG PENG,impc53802956@163.com,CLOSED,2023-03-24T12:42:46Z,2023-05-15T01:07:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

For now the command to migrate slot `clusterx migrate` works asynchronously. It will return ""OK"" right after the migration has started. If the client wants to know the result of the migration, it has to constantly use ""cluster info"" to get the state.

However, once the migration has been completed, the target slot will be forbidden, and the client (cluster manager) has to actively change the topology as soon as possible, in order to make the cluster continue to work.

In summary, the current `clusterx migrate` has two shortcuts: 
1. The client cannot get the result soon enough.
2. The ""polling"" approach to get the migration result is not efficient enough.

### Solution

I propose to leave the old `clusterx migrate` command intact, and add a new `clusterx bmirate` command, which works like other blocking commands (e.g. `blpop`). The server will block the connection and return ""OK"" (if succeed) or other error message (if failed) to the client only after the migration has completed.

The command shall be like:
```shell
clusterx bmirate ${SLOT} ${TARGET_NODEID} ${TIMEOUT}
```

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1350/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YYSYn,kvrocks,1482761767,1350,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-03-24T13:01:49Z,2023-03-24T13:01:49Z,https://github.com/apache/incubator-kvrocks/pull/529,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YYSYn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YYTlv,kvrocks,1482766703,1350,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-03-24T13:05:34Z,2023-03-24T13:05:34Z,I recommend that bmirate support bulk slot migration,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YYTlv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YYVYS,kvrocks,1482774034,1350,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-24T13:10:48Z,2023-03-24T13:10:48Z,"Hi @ellutionist @xiaobiaozhao

How about adding the optional `timeout` for the current migrate command? For example:

- timeout is missing or 0 means async migration which keep the same with the current behavior

- timeout is -1(<0) means blocking until the process was finished

- timeout is greater than 0 means the blocking time","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YYVYS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YcdvU,kvrocks,1483856852,1350,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-03-25T15:57:35Z,2023-03-25T15:57:35Z,"> 



> Hi @ellutionist @xiaobiaozhao
> 
> How about adding the optional `timeout` for the current migrate command? For example:
> 
> * timeout is missing or 0 means async migration which keep the same with the current behavior
> * timeout is -1(<0) means blocking until the process was finished
> * timeout is greater than 0 means the blocking time

I agree.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YcdvU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yc70R,kvrocks,1483980049,1350,NA,ellutionist,35825540,CHENG PENG,impc53802956@163.com,NA,2023-03-26T03:00:22Z,2023-03-26T03:00:22Z,"Thanks to @git-hulk  and @xiaobiaozhao . This is a good workaround to not create a new subcommand and to provide backward compatibility. 

However, I have to mention this: the ""OK"" returned by `migrate` without `timeout` argument means ""migration started"". It differs from the ""OK"" returned by `mirate` with `timeout` which means ""migration finished"". Such inconsistency may cause confusion to our users, especially who is new to Kvrocks.

If this is acceptable, then I am ready to implement it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yc70R/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yc9ZK,kvrocks,1483986506,1350,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-26T03:48:35Z,2023-03-26T03:48:35Z,"@ellutionist Thanks for your points. To be clear, we can also explicitly add the ASYNC|SYNC flag to identify the mode? And the timeout is only meaningful when the SYNC flag is exists.

How do you think?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yc9ZK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yc9bm,kvrocks,1483986662,1350,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-26T03:50:00Z,2023-03-26T03:50:00Z,To see other folks have any comments. @xiaobiaozhao @PragmaTwice @torwig @ShooterIT @caipengbo ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yc9bm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YdNaR,kvrocks,1484052113,1350,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-03-26T10:15:05Z,2023-03-26T10:15:05Z,"As I think, an ASYNC|SYNC flag is best choice and will be using in some other commands, like BACKUP.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YdNaR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YdjM_,kvrocks,1484141375,1350,NA,torwig,8588372,Yaroslav,,NA,2023-03-26T15:59:34Z,2023-03-26T15:59:34Z,"I respect the reasoning about introducing a separate command for a blocking version of the command: it's clearer, descriptive and consistent with some naming conventions of Redis (e. g. POP/BPOP).
On the other hand, if I use the blocking version of the MIGRATE command by specifying the proper options, it's obvious (at least for me) that it **will block** and the OK return value means ""blocking operation is completed"" (in other words, migration completed). 
And one quick note: personally, I don't like commands with a bunch of options (three and more). They are harder to implement and test. So, maybe _sometimes_ (but I'm not 100% sure that this case is the one), instead of introducing 2-3 additional options, we can create a new command. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YdjM_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YngQ7,kvrocks,1486750779,1350,NA,ellutionist,35825540,CHENG PENG,impc53802956@163.com,NA,2023-03-28T12:05:14Z,2023-03-28T12:05:14Z,"I agree with @torwig . A new subcommand is a more clear and more ""redis"" solution to me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YngQ7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yo2j1,kvrocks,1487104245,1350,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-03-28T15:24:26Z,2023-03-28T15:24:26Z,"Thanks, @ellutionist @torwig @xiaobiaozhao @aleksraiden.

So our consensus is to use `bmigrate` instead of adding the SYNC|ASYNC flag, it's also good to me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yo2j1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YyWmb,kvrocks,1489594779,1350,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2023-03-30T02:30:20Z,2023-03-30T02:30:20Z,"I prefer to use SYNC|ASYNC flag instead of another command which has similar arguments check and logic.
in new redis version, they don't want to add more commands, such as flush command, it has ASYNC option.

For `lpop` and `blpop`, they operate data space, different commands have different flags so redis can distinguish which command can execute in scripts env  easily.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YyWmb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YyYxY,kvrocks,1489603672,1350,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-03-30T02:44:28Z,2023-03-30T02:44:28Z,"> As I think, an ASYNC|SYNC flag is best choice and will be using in some other commands, like BACKUP.

Agree with it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YyYxY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YyiAm,kvrocks,1489641510,1350,NA,LykxSassinator,18441614,lucasliang,nkcs_lykx@hotmail.com,NA,2023-03-30T03:46:11Z,2023-03-30T03:46:11Z,"> I prefer to use SYNC|ASYNC flag instead of another command which has similar arguments check and logic. in new redis version, they don't want to add more commands, such as flush command, it has ASYNC option.
> 
> For `lpop` and `blpop`, they operate data space, different commands have different flags so redis can distinguish which command can execute in scripts env easily.

+1","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5YyiAm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yyi6J,kvrocks,1489645193,1350,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-03-30T03:53:35Z,2023-03-30T03:53:35Z,vote for the SYNC|ASYNC flag,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Yyi6J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Y7dCG,kvrocks,1491980422,1350,NA,ellutionist,35825540,CHENG PENG,impc53802956@163.com,NA,2023-03-31T14:06:40Z,2023-03-31T14:06:40Z,"Looks like the option of `SYNC|ASYNC` flag got more votes. If there is no further advice, I will implement the new feature as following:
```
clusterx migrate ${SLOT} ${NODE_ID} [SYNC|ASYNC] ${TIMEOUT}
```

- If the `ASYNC` is given or the flag is missing, the command will act in the old way.
- If the `SYNC` flag is given:
   - If the `timeout` is missing or ""0"", the command will block until the migration finish.
   - If the `timeout` comes as a positive integer, it means the max duration (of seconds) for which the command will block.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Y7dCG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Y-w6S,kvrocks,1492848274,1350,NA,PragmaTwice,20042607,Twice,,NA,2023-04-01T06:14:28Z,2023-04-01T06:14:28Z,"> I recommend that bmirate support bulk slot migration

I think it is unrelated to this PR. Besides, it is better to implement these two different features in two separate PRs.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Y-w6S/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1365,https://api.github.com/repos/apache/kvrocks/issues/1365,kvrocks,1651839288,1365,Support fork-based start,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2023-04-03T11:01:53Z,2023-04-23T10:27:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Need for elegant updating  etc. Like nginx, redis and so on.

### Solution

My propose is an adding new command-line startup options named ""-d"". If used, a process immediately fork himself and exit. So, after that we can update an executable file while server are running and then use a manual start/stop or use serviced reload options. 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1365/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1365,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZDnyJ,kvrocks,1494121609,1365,NA,PragmaTwice,20042607,Twice,,NA,2023-04-03T11:05:34Z,2023-04-03T11:05:34Z,Seems we already have a `daemonize` option. Does this fit your needs?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZDnyJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1365,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZFbce,kvrocks,1494595358,1365,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-04-03T16:04:37Z,2023-04-03T16:04:37Z,"As I see, no. So my point is - how we can start kvrocks and updating executable file before restart service. But maybe all my thinking is a wrong way...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZFbce/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1365,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZFcLt,kvrocks,1494598381,1365,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-04-03T16:06:17Z,2023-04-03T16:06:17Z,https://unix.stackexchange.com/questions/353457/will-overwriting-to-an-executable-file-affect-a-process-which-is-running-the-ori,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZFcLt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1371,https://api.github.com/repos/apache/kvrocks/issues/1371,kvrocks,1655405608,1371,About the performance optimization of home page image loading,sendRainAutumn,46080479,Just for Star,,CLOSED,2023-04-05T11:03:06Z,2023-05-31T04:35:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

When I open the official website for the first time, the pictures on the home page load very slowly, taking up to 35s. As shown below:
![2491680686736_ pic](https://user-images.githubusercontent.com/46080479/230061516-86ede2f0-02a8-4397-8e54-a05cb6d6f1c5.jpg)


### Solution

It may be possible to cache static resources with the help of CDN.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1371/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1371,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZPyGP,kvrocks,1497309583,1371,NA,sendRainAutumn,46080479,Just for Star,,NA,2023-04-05T11:08:35Z,2023-04-05T11:08:35Z,#1257,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZPyGP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1371,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZP2e6,kvrocks,1497327546,1371,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-05T11:24:54Z,2023-04-05T11:24:54Z,"Hi @SongYuQiu

Thanks for your feedback. We can use `https://cdn.jsdelivr.net/` which will auto-mapping the GitHub repo file path to the CDN path.

For example, the mainPic's path is static/img/, then we can use `https://cdn.jsdelivr.net/gh/apache/incubator-kvrocks-website/static/img/mainPic.png` directly.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZP2e6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1371,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZnVvS,kvrocks,1503484882,1371,NA,ColinChamber,95634254,ColinChamber,,NA,2023-04-11T14:33:28Z,2023-04-11T14:33:28Z,"![telegram-cloud-document-1-5019810286387856141](https://user-images.githubusercontent.com/95634254/231196052-4060e644-3b34-4c0c-83ac-cbdaccf415d2.jpg)
After the modifications, there was some improvement in speed. 
BTW, The DNS for cdn.jsdelivr.net and fastly.jsdelivr.net have been polluted by the GFW. For now, gcore.jsdelivr.net is still accessible, but its future availability is uncertain. FYI @SongYuQiu ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZnVvS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1372,https://api.github.com/repos/apache/kvrocks/issues/1372,kvrocks,1655926729,1372,Add test cases for the data encoding compatibility,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-04-05T16:13:00Z,2023-12-23T10:00:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

As @PragmaTwice mentioned in an offline topic(@DenizPiri also mentioned in https://github.com/apache/incubator-kvrocks/issues/414#issuecomment-1432883367.), we didn't have any test cases to ensure the data encoding is compatible with the old version, which is very important for a storage service.

### Solution

We can create a minimized dataset for all types per release(starting from 2.3.0), then load and check the dataset is ok to load.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1372/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1372,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nSCaC,kvrocks,1732781698,1372,NA,HolyLow,22865114,,,NA,2023-09-25T01:48:46Z,2023-09-25T01:48:46Z,"@git-hulk I see this issue in the roadmap, and as it seems that no one is working on it (because this issue is troublesome and dirty...?), could you assign it to me?

Currently I only have some unclear thoughts on this topic. I think to check the data encoding compatibility, we are supposed to:

1. Write the raw data in different version's encoding (use the RocksDB api directly and bypass the kvrocks api);
2. Then read the data with the current version's kvrocks api to check if the data is readable and the data semantic is correct.

But still, I am not sure of the proper workflow, or how far we should go. 
Maybe you could kindly refer me to some existing projects' ""data encoding checking"" mechanism/code to shed me some light, if you happen to know. 
I would try to find some material myself as well.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nSCaC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1372,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nSDOX,kvrocks,1732785047,1372,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-25T01:53:36Z,2023-09-25T01:53:36Z,"


> @git-hulk I see this issue in the roadmap, and as it seems that no one is working on it (because this issue is troublesome and dirty...?), could you assign it to me?
> 
> Currently I only have some unclear thoughts on this topic. I think to check the data encoding compatibility, we are supposed to:
> 
> 1. Write the raw data in different version's encoding (use the RocksDB api directly and bypass the kvrocks api);
> 2. Then read the data with the current version's kvrocks api to check if the data is readable and the data semantic is correct.
> 
> But still, I am not sure of the proper workflow, or how far we should go. Maybe you could kindly refer me to some existing projects' ""data encoding checking"" mechanism/code to shed me some light, if you happen to know. I would try to find some material myself as well.

Hi @HolyLow Assigned, thanks for your interest.

Let me think a bit about this, I will ping you back soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nSDOX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1372,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vTp2N,kvrocks,1867423117,1372,NA,HolyLow,22865114,,,NA,2023-12-22T09:01:45Z,2023-12-22T09:01:45Z,"@git-hulk Hello, do you have any thoughts yet?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vTp2N/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1372,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWvZv,kvrocks,1868232303,1372,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-23T07:40:55Z,2023-12-23T07:40:55Z,"@HolyLow Thanks for your followup, I forgot about this issue. You can continue moving on if you have any ideas to achieve this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWvZv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1372,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWwoF,kvrocks,1868237317,1372,NA,PragmaTwice,20042607,Twice,,NA,2023-12-23T08:07:57Z,2023-12-23T08:07:57Z,"I think maybe you can add a new job in the nightly CI workflow, and cache the binary of an old version of kvrocks, e.g. 2.6.0.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWwoF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1372,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWxfp,kvrocks,1868240873,1372,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-23T08:27:35Z,2023-12-23T08:27:35Z,I'm wondering if it's good to maintain a docker image for testing this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWxfp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1372,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vW1qv,kvrocks,1868257967,1372,NA,PragmaTwice,20042607,Twice,,NA,2023-12-23T10:00:43Z,2023-12-23T10:00:43Z,"> I'm wondering if it's good to maintain a docker image for testing this.

Ahh good idea, we can just fetch docker images of old version kvrocks rather than cache the binary in GitHub actions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vW1qv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1376,https://api.github.com/repos/apache/kvrocks/issues/1376,kvrocks,1659877555,1376,Is it possible to add redis-cli to the docker image so that it can be downloaded and used immediately.,KeeProMise,38941777,Jian Zhang,,OPEN,2023-04-09T13:32:27Z,2024-03-16T14:35:46Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

I downloaded docker Mirror, found that you need to install redis-cli yourself,s it possible to add redis-cli to the docker image so that it can be downloaded and used immediately.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1376/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1376,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZeZNH,kvrocks,1501139783,1376,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-09T14:18:23Z,2023-04-09T14:18:23Z,This sounds good to me. cc @torwig @PragmaTwice @ShooterIT ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZeZNH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1376,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZeZyf,kvrocks,1501142175,1376,NA,PragmaTwice,20042607,Twice,,NA,2023-04-09T14:29:33Z,2023-04-09T14:29:33Z,"I do not think it is necessary. The docker image we provide is only for starting a kvrocks service, not a redis client.

You can build a docker image only for redis-cli, find one in the docker hub, or use redis-cli in your host environment.

BTW, we do not encourage anyone to modify the entrypoint of the docker image and use other binaries in the image. It is literally only for one binary, i.e. `bin/kvrocks`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZeZyf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1376,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZfHMH,kvrocks,1501328135,1376,NA,KeeProMise,38941777,Jian Zhang,,NA,2023-04-10T02:59:56Z,2023-04-10T02:59:56Z,"> We don't need to modify the entrypoint, I think redis-cli can be added to the bin directory, so that for some people who are new to the database, it is very convenient (enter the docker container to run bin/redis-cli) to execute some redis commands to interact with the database. Moreover, the same is true for mysql, redis, iotdb, etc. that I know.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZfHMH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1376,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZfMDX,kvrocks,1501348055,1376,NA,PragmaTwice,20042607,Twice,,NA,2023-04-10T03:30:18Z,2023-04-10T03:30:18Z,"When you ""enter"" the docker container via shell (`docker exec`), you changed the entrypoint of the docker image from `bin/kvrocks` to `bash` (or the posix shell, whatever). 

We do not expect users to do this.

Another thing is that, seems there is no package in ubuntu for a single redis-cli.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZfMDX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1377,https://api.github.com/repos/apache/kvrocks/issues/1377,kvrocks,1662252059,1377,XREAD got unexpected empty response,mnizhq007,23118518,,,OPEN,2023-04-11T11:04:26Z,2023-06-09T09:15:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

OS：centos6.9
KVRocks：2.3.0
redis-cli：6.2.6/4.0.10

### Minimal reproduce step

I have a kvrocks cluster with 3 masters and 3 slaves.

Connect and blocking read the queue on master-A

```shell
redis-cli -c -h {Master A's IP} -p {Master A's Port} -a password
XREAD BLOCK 10000 STREAMS test-mq $
```

then publish a new message on master-B

```
redis-cli -c -h {Master B's IP} -p {Master B's Port} -a password
XADD test-mq * key1 value1
```

### What did you expect to see?

I would like to see normal consumption data, for example.
1) 1) ""test-mq""
   2) 1) 1) ""1681209941456-0""
         2) 1) ""key1""
            2) ""value1""
(3.51s)

### What did you see instead?

I can see that the consume command in step 1 is unable to see the data and only sees an empty message.
(nil)
(10.00s)

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1377/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1377,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZmBs3,kvrocks,1503140663,1377,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-11T11:13:38Z,2023-04-11T11:13:38Z,"> Please make sure that there is redirection happening when executing the XADD command.

Do you mean need to trigger the slot migration between step 1 and step 2?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZmBs3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1377,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZmC2V,kvrocks,1503145365,1377,NA,mnizhq007,23118518,,,NA,2023-04-11T11:17:40Z,2023-04-11T11:17:40Z,"Because the application randomly connects to a node when it connects.
Only randomly connecting to different nodes for producing and consuming data during the connection does not require slot migration","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZmC2V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1377,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZmDgj,kvrocks,1503148067,1377,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-11T11:19:57Z,2023-04-11T11:19:57Z,"OK, thanks. I got your point now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ZmDgj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1377,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ea7af,kvrocks,1584117407,1377,NA,torwig,8588372,Yaroslav,,NA,2023-06-09T07:39:37Z,2023-06-09T07:39:37Z,@git-hulk Do we need something to do in order to resolve this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ea7af/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1377,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebAjM,kvrocks,1584138444,1377,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T07:56:58Z,2023-06-09T07:56:58Z,"Hi @torwig, thanks for your reminder. I forgot to reproduce and investigate this issue, I'm not sure if the redis-cli failed to redirect the STREAM key.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebAjM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1378,https://api.github.com/repos/apache/kvrocks/issues/1378,kvrocks,1662286992,1378,Add  cluster section into the info command,mnizhq007,23118518,,,CLOSED,2023-04-11T11:29:59Z,2023-04-12T07:48:35Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

We found that when the .NET application accesses Kvrocks, it prompts that it is not a cluster. After checking the logs, we discovered that it identifies whether it is a cluster through this command：info cluster



### Solution

When I execute the command ""info cluster"" in Redis 6, I get the following results.
'#' Cluster
cluster_enabled:1

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1378/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1381,https://api.github.com/repos/apache/kvrocks/issues/1381,kvrocks,1664362034,1381,SetClusterNodes  allow to match localhost and real ip when listening on 0.0.0.0,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-04-12T11:17:05Z,2023-04-20T09:22:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, `SetClusterNodes` can't match the node if the instance is listening on 0.0.0.0 instead of the real IP. 

For example, the cluster topology is: `lohMbHeln658feDcRVKYb4tT7XClAm3Zr4awKuoK 127.0.0.1 6666 master -  0-16383`, but the listen address is 0.0.0.0, then it won't match the cluster node since the listen IP is not strictly equal to cluster's node IP 127.0.0.1(as well as not localhost IP like 172.14.1.x).

This would confuse users because the cluster didn't work as their expected.

### Solution

Check the IP address is matched by the real listening IP addresses instead of the bind address directly when using 0.0.0.0.

https://github.com/apache/incubator-kvrocks/blob/unstable/src/cluster/cluster.cc#L211

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1381/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1381,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Z0ZmG,kvrocks,1506908550,1381,NA,zevin02,92536645,pt,zevin9427@gmail.com,NA,2023-04-13T12:48:19Z,2023-04-13T12:48:19Z,please assign to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Z0ZmG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1381,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Z0fbk,kvrocks,1506932452,1381,NA,PragmaTwice,20042607,Twice,,NA,2023-04-13T13:05:03Z,2023-04-13T13:05:03Z,"> please assign to me

Great! Assigned.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5Z0fbk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1382,https://api.github.com/repos/apache/kvrocks/issues/1382,kvrocks,1664698869,1382,Supplement  Kvrocks-controller documents,ColinChamber,95634254,ColinChamber,,CLOSED,2023-04-12T14:37:53Z,2023-06-24T07:27:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Supplement  Kvrocks-controller documents

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1382/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1382,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5frt8C,kvrocks,1605295874,1382,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-06-24T07:17:59Z,2023-06-24T07:17:59Z,@git-hulk where is the associated PR or this is closed as won't do?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5frt8C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1382,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fruUd,kvrocks,1605297437,1382,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-24T07:27:11Z,2023-06-24T07:27:11Z,"> @git-hulk where is the associated PR or this is closed as won't do?

@tisonkun Sorry for didn’t mention the reason. The API doc was finished: https://github.com/RocksLabs/kvrocks_controller/blob/unstable/docs/API.md. And I think it would be more coherent to maintain the controller related issues in its repository if have any further issues.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fruUd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1389,https://api.github.com/repos/apache/kvrocks/issues/1389,kvrocks,1667714066,1389,Replace mutexes with tbb concurrent containers if proper,PragmaTwice,20042607,Twice,,OPEN,2023-04-14T07:48:29Z,2024-07-08T11:53:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

With TBB, now we can eliminate some mutexes applied on containers in our codebase with concurrent containers directly.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1389/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1389,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aJ4AN,kvrocks,1512538125,1389,NA,wanghenshui,8872493,Ted Mostly,wanghenshui@qq.com,NA,2023-04-18T06:53:56Z,2023-04-18T06:53:56Z,tbb or folly::concurrentHashMap ?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aJ4AN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1389,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aJ6P5,kvrocks,1512547321,1389,NA,PragmaTwice,20042607,Twice,,NA,2023-04-18T07:00:51Z,2023-04-18T07:00:51Z,"> tbb or folly::concurrentHashMap ?

We currently do not introduce folly as our dependency, since it is a far more large library.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aJ6P5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1389,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ephRn,kvrocks,1587942503,1389,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-12T19:23:39Z,2023-06-12T19:23:39Z,hey @PragmaTwice I want to try and investigate the tbb containter.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ephRn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1389,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fDMtJ,kvrocks,1594673993,1389,NA,PragmaTwice,20042607,Twice,,NA,2023-06-16T13:25:40Z,2023-06-16T13:25:40Z,"> hey @PragmaTwice I want to try and investigate the tbb containter.

Assigned. Good luck.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fDMtJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1389,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6D8xZg,kvrocks,2213746272,1389,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-07-08T11:20:22Z,2024-07-08T11:20:22Z,"Hi @PragmaTwice ,

This issue seems to be stale for one year.
Could this issue be assigned to me if it still needs to be resolved?
I want to research the tbb container and make some contribution.

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6D8xZg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1393,https://api.github.com/repos/apache/kvrocks/issues/1393,kvrocks,1672691854,1393,Implement a TIME command from Redis,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2023-04-18T09:12:16Z,2023-04-19T06:48:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

For more compatibility with original Redis spec and because a some other command like XADD etc. use internal time as identificatory of items. 

Redis spec are here - [https://redis.io/commands/time/](https://redis.io/commands/time/)  

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1393/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1393,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aLj8x,kvrocks,1512980273,1393,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-04-18T12:09:48Z,2023-04-18T12:09:48Z,"redis used gettimeofday in the past, should we also use gettimeofday directly? (in Redis 7.2, TIME use a cached time)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aLj8x/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1393,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aLmhx,kvrocks,1512990833,1393,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-18T12:14:03Z,2023-04-18T12:14:03Z,"Hi @enjoy-binbin 

I think it's fine to use the time function in [time_util.h](https://github.com/apache/incubator-kvrocks/blob/unstable/src/common/time_util.h).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aLmhx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1395,https://api.github.com/repos/apache/kvrocks/issues/1395,kvrocks,1674259575,1395,Introduce fallback logic if the CDN is unavailable for website,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2023-04-19T06:36:28Z,2023-05-05T13:02:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

See https://github.com/apache/incubator-kvrocks-website/pull/92#discussion_r1170749761

> This can be a follow-up to introduce some fallback logic if the CDN is unavailable.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1395/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1395,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bkQQC,kvrocks,1536230402,1395,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-05-05T13:02:34Z,2023-05-05T13:02:34Z,Won't do - see https://github.com/apache/incubator-kvrocks-website/pull/99.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bkQQC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1396,https://api.github.com/repos/apache/kvrocks/issues/1396,kvrocks,1674594587,1396,config rewrite bug,iushas,7236171,tanic.xiao,,CLOSED,2023-04-19T10:08:03Z,2023-04-20T12:58:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.3.0

### Minimal reproduce step

namespace add xxx
config rewrite

### What did you expect to see?

no extra blank lines in kvrocks.conf

### What did you see instead?

First create 1w namespace, then config rewrite.
There are 1w extra blank lines after config rewrite

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1396/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1396,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aRQZP,kvrocks,1514473039,1396,NA,iushas,7236171,tanic.xiao,,NA,2023-04-19T10:08:27Z,2023-04-19T10:08:27Z,"<img width=""569"" alt=""image"" src=""https://user-images.githubusercontent.com/7236171/233042866-db93476a-5db4-4645-b4e6-331ffbb29b79.png"">
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aRQZP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1396,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aVrAW,kvrocks,1515630614,1396,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-04-20T02:41:24Z,2023-04-20T02:41:24Z,"It seems that in addition to this problem, every time we perform a `config rewrite`, an additional newline is appended","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aVrAW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1396,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aV1Yw,kvrocks,1515673136,1396,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-04-20T03:48:23Z,2023-04-20T03:48:23Z,"so it look like `file.eof()` problem. see https://stackoverflow.com/questions/21647/reading-from-text-file-until-eof-repeats-last-line

change it to this seems work
```diff
diff --git a/src/config/config.cc b/src/config/config.cc
index 3e3c286..77825ae 100644
--- a/src/config/config.cc
+++ b/src/config/config.cc
@@ -829,8 +829,8 @@ Status Config::Rewrite() {
   std::ifstream file(path_);
   if (file.is_open()) {
     std::string raw_line;
-    while (!file.eof()) {
-      std::getline(file, raw_line);
+    while (std::getline(file, raw_line)) {
+      if (file.eof()) break;
       auto parsed = ParseConfigLine(raw_line);
       if (!parsed || parsed->first.empty()) {
         lines.emplace_back(raw_line);
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aV1Yw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1396,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aV19k,kvrocks,1515675492,1396,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-20T03:52:43Z,2023-04-20T03:52:43Z,"> It seems that in addition to this problem, every time we perform a `config rewrite`, an additional newline is appended

yes","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aV19k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1396,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aV4WQ,kvrocks,1515685264,1396,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-04-20T04:08:44Z,2023-04-20T04:08:44Z,"I tested the changes above locally, it will work (and it also can fix this issue)
should we need to change all `while (!file.eof())`, I see we still have a few places where we use this","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aV4WQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1396,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aV4yL,kvrocks,1515687051,1396,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-20T04:11:53Z,2023-04-20T04:11:53Z,"Yes, I think so. cc @PragmaTwice ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5aV4yL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/1402,kvrocks,1683088568,1402,`scan` and `scan_iter` stuck to first iteration,kinoute,623763,Yann Defretin,yann@defret.in,CLOSED,2023-04-25T12:35:13Z,2023-06-25T11:54:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.3.0

### Minimal reproduce step

1. Start Kvrocks Docker container:

`docker run -it -p 6666:6666 apache/kvrocks`

2. Populate the database with 200k keys with Python 3.9.13 and the forked version of Redis-py available here : https://github.com/hashlookup/redis-py

```bash
pip install git+https://github.com/hashlookup/redis-py@master
```

```python3
import redis

REDIS = redis.Redis(
    host='0.0.0.0',
    port=6666,
    password='',
    db=0,
    )

# Populate Kvrocks with 200k keys
pipe = REDIS.pipeline()

for i in range(200_000):
    pipe.set(f'dba_{i}', 1)

pipe.execute()

# Test ""scan_iter""
for key in scan_iter('dba_*'):
    print(key)


# Test ""scan""
cursor = '0'

while True:
    cursor, keys = REDIS.scan(
        cursor=cursor,
        match='dba_*',
    )
    for key in keys:
        print(key)

    if not keys:
        break
```

### What did you expect to see?

I expected both commands to iterate through every `dba_*` key.

### What did you see instead?

Instead, both commands are stuck on the first iteration of default size and keep printing the same batch of keys every time.

Exemple with `scan_iter`:


```
b'dba_0'
b'dba_1'
b'dba_10'
b'dba_100'
b'dba_1000'
b'dba_10000'
b'dba_100000'
b'dba_100001'
b'dba_100002'
b'dba_100003'
b'dba_100004'
b'dba_100005'
b'dba_100006'
b'dba_100007'
b'dba_100008'
b'dba_100009'
b'dba_10001'
b'dba_100010'
b'dba_100011'
b'dba_100012'
b'dba_1'
b'dba_10'
b'dba_100'
b'dba_1000'
b'dba_10000'
b'dba_100000'
b'dba_100001'
b'dba_100002'
b'dba_100003'
b'dba_100004'
b'dba_100005'
b'dba_100006'
b'dba_100007'
b'dba_100008'
b'dba_100009'
b'dba_10001'
b'dba_100010'
b'dba_100011'
b'dba_100012'
b'dba_100013'
b'dba_1'
b'dba_10'
b'dba_100'
b'dba_1000'
b'dba_10000'
b'dba_100000'
b'dba_100001'
b'dba_100002'
b'dba_100003'
b'dba_100004'
b'dba_100005'
b'dba_100006'
b'dba_100007'
b'dba_100008'
b'dba_100009'
b'dba_10001'
b'dba_100010'
b'dba_100011'
b'dba_100012'
b'dba_100013'
```

etc.

### Anything Else?

While being inefficient, `keys` doesn't suffer from this problem and return every key matching the pattern:

```python3
len(REDIS.keys('dba_*'))

200000
```

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1402/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5as8lI,kvrocks,1521731912,1402,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2023-04-25T12:47:21Z,2023-04-25T12:47:21Z,"it works when we use this ""obscure"" python package : https://pypi.org/project/kvrocks-scan/

Which does the following:

```python3
import redis

def parse_scan(response, **options):
	cursor, r = response
	if cursor == b""0"" or cursor == ""0"":
		return int(cursor),r;
	return cursor, r

redis.client.AbstractRedis.RESPONSE_CALLBACKS[""SCAN""] = parse_scan;


# Redis scan_iter etc
```

I'm not sure why this works and the forked Redis python by @hashlookup, which seems to handle this int/str cast, doesn't.

Edit: Actually, with this method, `scan_iter` is stuck in an infinite loop. `scan` seems to work correctly.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5as8lI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5atT4o,kvrocks,1521827368,1402,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-25T13:51:24Z,2023-04-25T13:51:24Z,"Hi, @kinoute 

Thanks for your feedback, we would take a look.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5atT4o/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5awuRE,kvrocks,1522721860,1402,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-26T03:27:59Z,2023-04-26T03:27:59Z,"@kinoute The root cause is right that the Kvrocks scan command would return a string cursor instead of the integer, so it's not compatible with the official Python client. Another workaround can use the raw client to send and parse the scan command.

For why the scan_iter didn't, to see if @adulau or other guys who are familiar with Python can help.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5awuRE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5axQUt,kvrocks,1522861357,1402,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2023-04-26T06:33:35Z,2023-04-26T06:33:35Z,"But it seems the forked Redis-py client the Kvrocks team recommends in many issues should handle this problem? See this commit: https://github.com/redis/redis-py/commit/e9c53fb1398e636106c0ec0165ba564943564a83

Or am I missing something here?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5axQUt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5axSvi,kvrocks,1522871266,1402,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-26T06:43:51Z,2023-04-26T06:43:51Z,"Yes, we recommend using the fork redis-py, and it should be fine to add a wrap function to work around this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5axSvi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dlzN6,kvrocks,1570190202,1402,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-05-31T13:00:07Z,2023-05-31T13:00:07Z,"The Redis documentation clearly states that the cursor is unsigned 64 bit number. Do we not need to fully compatible with Redis protocol?
[Scan commands return value section](https://redis.io/commands/scan/#:~:text=the%20first%20element%20is%20a%20string%20representing%20an%20unsigned%2064%20bit%20number)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dlzN6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dnMYs,kvrocks,1570555436,1402,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-31T16:33:59Z,2023-05-31T16:33:59Z, I approve your point.@jihuayu ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dnMYs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dpspJ,kvrocks,1571211849,1402,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-01T02:00:44Z,2023-06-01T02:00:44Z,"@jihuayu The underly storage is different between Kvrocks and Redis, so what we can do is try our best to be compatible with Redis. Welcome to submit the proposal if you have any ideas to achieve this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dpspJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d6Ibg,kvrocks,1575519968,1402,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-04T10:58:47Z,2023-06-04T10:58:47Z,"@git-hulk  SCAN commond is frequently used in Redis clients.It's important to ensure SCAN commond is correct for Redis toolchains to work with Kvrocks. 
Therefore, I believe this issue needs to be resolved.

After carefully reading the Redis documentation, I found that cursors have the following features:

1. The cursor is a 64-bit unsigned integer, with 0 meaning the end of the iteration. 
2. There is no state server side, the full state is captured by the cursor
3. During the iteration process, a given element may be returned multiple times.
4. As long as the number of elements is not constantly increasing, the iteration will eventually end.
5. Use a corrupted cursor is undefined behavior.


Therefore, I think we can use a **ring array** to store the key names for the most recently used cursors.

When SCAN end_cursor is ""keyname1"" we push {key:keyname1,cursor:1276} to cursor-ring.
Next SCAN use cursor 1276, we foreach cursor-ring from the newest item, and get the it's key ""keyname1"". I call this process cursor translation.
Then we can use ""keyname1"" to seek rocksdb iterator.

If client call many SCAN command, cursor-ring will be filled and the oldest cursor will be discarded.
Now the if client SCAN use a corrupted cursor(the cursor don't in cursor-ring), we will return element from begin.

Based on the above design, we will have the following additional costs.

1. Less than 2KB of memory is used to store the cursor ring.
2. Each SCAN request requires one cursor translation and one cursor mapping save. (Note: Ensuring thread safety is required for cursor mapping save) 

Because SCAN command is a slow command, so the additional cursor translation has a minimal impact.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d6Ibg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d6Uwc,kvrocks,1575570460,1402,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-04T13:28:42Z,2023-06-04T13:28:42Z,"@jihuayu Thanks for your solution. 

The ring buffer or LRU cache is good for me. For the HSCAN and SSCAN commands, we need to use the subkey to map the string cursor and number.

By the way, to be compatible with the older version, we should add a configuration to allow users to enable this feature. And can enable it by default in the next major version.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d6Uwc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eDfd1,kvrocks,1577973621,1402,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-06T06:09:34Z,2023-06-06T06:09:34Z,"@git-hulk Ok, I will send a PR later. You can assign this task to me.

https://github.com/apache/incubator-kvrocks/issues/877 It may be solved together.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eDfd1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eDfrV,kvrocks,1577974485,1402,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-06T06:10:35Z,2023-06-06T06:10:35Z,"Thanks @jihuayu, assigned","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eDfrV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5edfkm,kvrocks,1584789798,1402,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-06-09T15:41:53Z,2023-06-09T15:41:53Z,"Nice catch! @jihuayu

1. What if `""keyname1""` is deleted after cursor put into ring array?
2. How does the `cursor:1276` number generated?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5edfkm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1402,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5efZz2,kvrocks,1585290486,1402,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-09T23:54:13Z,2023-06-09T23:54:13Z,"Thank you! @mapleFU 
1. I'm not storing the iterator, I just made a dictionary that [converts the **number cursor** to a **begin key name**](https://github.com/jihuayu/incubator-kvrocks/blob/71358a1b6260ba6a9dd91ac2930e3f3645fa4d6d/src/commands/cmd_server.cc#L777) when receiving the command. After completing the scan, I use [the **end key name** to generate a new **number cursor**](https://github.com/jihuayu/incubator-kvrocks/blob/71358a1b6260ba6a9dd91ac2930e3f3645fa4d6d/src/commands/cmd_server.cc#L765).
2. [The cursor is a global counter that is incremented whenever a new cursor needs to be generated.](https://github.com/jihuayu/incubator-kvrocks/blob/71358a1b6260ba6a9dd91ac2930e3f3645fa4d6d/src/server/server.cc#L1768)






","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5efZz2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/1403,kvrocks,1684940811,1403,Syntax of HELLO is different from Redis,rueian,2727535,Rueian,rueiancsie@gmail.com,CLOSED,2023-04-26T12:32:22Z,2023-04-29T06:11:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

2.3.0

### Minimal reproduce step

1. Set `requirepass mypass`
2. Send command: `HELLO 2 AUTH default mypass` after connected.


### What did you expect to see?

mypass should be accepted.

### What did you see instead?

`invalid password` error.

### Anything Else?

Hi, 

According to https://redis.io/commands/hello, the syntax of `HELLO` should be 
```
HELLO [protover [AUTH username password] [SETNAME clientname]]
```
and the default username should be `default`.

However, kvrocks' syntax seems to lack the username part:
https://github.com/apache/incubator-kvrocks/blob/6889b5916ab560ecd5eed79bb9786e36342f0e17/src/commands/cmd_server.cc#L660

Not sure if this is intended? But I think it will be great if matching redis' syntax.

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1403/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5azIY2,kvrocks,1523353142,1403,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-04-26T12:40:17Z,2023-04-26T12:40:17Z,"Hi @rueian . When I implement ""hello"", kvrocks didn't support auth like that.
https://github.com/apache/incubator-kvrocks/pull/881#issuecomment-1249985088","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5azIY2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5azJJJ,kvrocks,1523356233,1403,NA,PragmaTwice,20042607,Twice,,NA,2023-04-26T12:42:37Z,2023-04-26T12:42:37Z,"Hi @rueian, it seems meaningless in kvrocks to give a username, since the AUTH command in kvrocks is used to authorize accessibility to a corresponding [namespace](https://kvrocks.apache.org/docs/namespace/).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5azJJJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5azXUC,kvrocks,1523414274,1403,NA,rueian,2727535,Rueian,rueiancsie@gmail.com,NA,2023-04-26T13:21:56Z,2023-04-26T13:21:56Z,"> Hi @rueian, it seems meaningless in kvrocks to give a username, since the AUTH command in kvrocks is used to authorize accessibility to a corresponding [namespace](https://kvrocks.apache.org/docs/namespace/).

Hi @PragmaTwice, I understand.

However, from a redis client implementation perspective, this difference in syntax means that a client implementation may need to treat Kvrocks differently to work with it. I think this may put some barriers for a client to adapt to Kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5azXUC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a6CjJ,kvrocks,1525164233,1403,NA,PragmaTwice,20042607,Twice,,NA,2023-04-27T08:50:54Z,2023-04-27T08:50:54Z,@rueian Thanks for you explaination. It make sense. I am not averse to accept an `AUTH default <pass>` form. cc @git-hulk ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a6CjJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a6GyH,kvrocks,1525181575,1403,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-27T08:58:03Z,2023-04-27T08:58:03Z,"I also prefer to allow passing the username, even though it's meaningless to Kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a6GyH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a6HEa,kvrocks,1525182746,1403,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-04-27T08:58:31Z,2023-04-27T08:58:31Z,"@rueian IIRC the goredis client handle the `AUTH` command specially for kvrocks. If you're implementing a redis client and hope it can be compatible with kvrocks, feel free to start a discussion to add (compatible) integration tests. As our gocases are written on the top of goredis.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a6HEa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a6IVp,kvrocks,1525187945,1403,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-04-27T09:00:29Z,2023-04-27T09:00:29Z,Aha. We change for being compatible with go-redis in https://github.com/apache/incubator-kvrocks/pull/830.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a6IVp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a7oqX,kvrocks,1525582487,1403,NA,rueian,2727535,Rueian,rueiancsie@gmail.com,NA,2023-04-27T12:11:47Z,2023-04-27T12:11:47Z,"Hi @tisonkun,

Yes, I am also making a go redis client, rueidis, and got a report that it doesn't work with kvrocks because of the syntax difference with redis: https://github.com/rueian/rueidis/issues/204

But I am not sure if goredis do special work for kvrocks or not, since its latest version doesn't work with kvrocks as well.

For example:
```go
package main

import (
	""context""
	""fmt""
	""github.com/redis/go-redis/v9""
)

func main() {
	client := redis.NewClient(&redis.Options{Addr: ""127.0.0.1:6666"", Password: ""mypass""})
	fmt.Println(client.Ping(context.Background()))
}
```
goredis actually send `hello 3 auth default mypass` to kvrocs. And then it returned `ping: Syntax error in HELLO option auth` error.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5a7oqX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1403,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bD1Pg,kvrocks,1527731168,1403,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-04-28T15:24:23Z,2023-04-28T15:24:23Z,@rueian Thanks for your repro! That's a good new test case we can add to the integration test suite for verifying this issue is resolved :D,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bD1Pg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1407,https://api.github.com/repos/apache/kvrocks/issues/1407,kvrocks,1689287993,1407,Support specify release candidate number in `x.py package source`,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2023-04-29T00:52:12Z,2023-05-05T07:46:01Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Otherwise, the RC always has the same tag name as the formal release name. And it's awkward to force-push for overwriting refs.

### Solution

cc @PragmaTwice @git-hulk may you check where we should use `-rcX` during the release process?

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1407/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1407,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bHG8G,kvrocks,1528590086,1407,NA,PragmaTwice,20042607,Twice,,NA,2023-04-29T03:24:43Z,2023-04-29T03:24:43Z,"Sure, we can make it push to a tag with rc suffix.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bHG8G/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1407,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bHUbY,kvrocks,1528645336,1407,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-04-29T04:13:45Z,2023-04-29T04:13:45Z,@PragmaTwice what I'm afraid of is that there is still other place we need `rc` suffix except the git tag :D,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bHUbY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1407,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bHX80,kvrocks,1528659764,1407,NA,ZENOTME,43447882,ZENOTME,,NA,2023-04-29T05:20:44Z,2023-04-29T05:20:44Z,"I can help with this.

Not sure whether my understand is correct, it's to support 
`./x.py package source -v 2.3.2 -rc 1` and then create a tag '2.3.2-rc1'. 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bHX80/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1407,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bhp9q,kvrocks,1535549290,1407,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-05-05T00:13:48Z,2023-05-05T00:13:48Z,@ZENOTME Thanks for your input! That sounds good to me. Please go ahead.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bhp9q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/1410,kvrocks,1689542443,1410,Persist the cluster-enabled status in RocksDB ,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-04-29T12:22:09Z,2024-01-14T01:51:15Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, we encode the slot id as the prefix of the key if the cluster mode was enabled according to Kvrocks's configuration. But it would go wrong if we start the Kvrocks with `cluster-enabled yes`, but change it to `cluster-enabled no` after restarting.

For the key encoding can see: https://kvrocks.apache.org/community/data-structure-on-rocksdb



### Solution

Persist the `cluster-enabled` configuration in the RocksDB(can use `propagate column family`) when starting the server, then check if the Kvrocks's cluster-enabled configuration matched the database status.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1410/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bIFQ1,kvrocks,1528845365,1410,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-04-29T18:26:36Z,2023-04-29T18:26:36Z,Let's try this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bIFQ1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bISwX,kvrocks,1528900631,1410,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-30T00:04:21Z,2023-04-30T00:04:21Z,"@infdahai Assigned, let's go ahead.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bISwX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bLs5h,kvrocks,1529794145,1410,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-01T14:51:36Z,2023-05-01T14:51:36Z,"@git-hulk  I find many go tests use the `config` map including `""cluster-enabled"": ""yes""` and the `StartServerWithCLIOptions` function writes the option to the `kvrocks.conf` file. 

```go
func TestClusterDumpAndLoadClusterNodesInfo(t *testing.T) {
	srv1 := util.StartServer(t, map[string]string{
		""bind"":            ""0.0.0.0"",
		""cluster-enabled"": ""yes"",
	})
```

in StartServerWithCLIOptions func(),
https://github.com/apache/incubator-kvrocks/blob/30e9fd788a4acb585566a008f4d5fff65ee06ce3/tests/gocase/util/server.go#L197-L207

I haven't seen a commad that changes `cluster` mode, so it means we should define the option in the initial config file if we want to use `cluster` mode. `Restart()` will read the `kvrocks.conf` and set the origin value.
https://github.com/apache/incubator-kvrocks/blob/30e9fd788a4acb585566a008f4d5fff65ee06ce3/tests/gocase/util/server.go#L116-L128

> change it to `cluster-enabled` no` after restarting.

so I don't know how this happens, could you explain it?  

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bLs5h/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cFv3X,kvrocks,1545010647,1410,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-12T02:19:33Z,2023-05-12T02:19:33Z,"Hi @infdahai 

Sorry for missing this comment.

> I haven't seen a commad that changes cluster mode, so it means we should define the option in the initial config file if we want to use cluster mode. Restart() will read the kvrocks.conf and set the origin value.

Yeah, that's right that we have no command to set the cluster mode, it must be specified in the configuration file. But the current restart function cannot change the kvrocks.conf, so you need to support overriding the configuration in the restart function first if wanna test this scenario.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cFv3X/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cbVk8,kvrocks,1550670140,1410,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-17T04:07:44Z,2023-05-17T04:07:44Z,@inf Are you still working on this?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cbVk8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ccP-b,kvrocks,1550909339,1410,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-17T07:43:22Z,2023-05-17T07:43:22Z,@git-hulk  I think I know what to do. A new pull request is on the way.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ccP-b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ccSSX,kvrocks,1550918807,1410,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-17T07:48:00Z,2023-05-17T07:48:00Z,"Cool, thanks. No hurry, just for asking if you're working on this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ccSSX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wrhMa,kvrocks,1890456346,1410,NA,chrisxu333,44099579,Nuo Xu,,NA,2024-01-13T13:19:23Z,2024-01-13T13:19:23Z,@infdahai are you still working on this? If not I'd like to take over. @git-hulk ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wrhMa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1410,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ws59N,kvrocks,1890819917,1410,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-14T01:51:13Z,2024-01-14T01:51:13Z,"@chrisxu333 Done, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ws59N/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1411,https://api.github.com/repos/apache/kvrocks/issues/1411,kvrocks,1689544664,1411,Check if the cluster mode is consistent between master and slaves when replication,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-04-29T12:31:00Z,2023-06-21T01:05:52Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, we didn't check the cluster status between the master and slaves, and the slave may crash if the master enabled the cluster node but not enabled in slaves, and vice versa.

### Solution

Check the cluster status when replication.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1411/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1411,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bH6Fm,kvrocks,1528799590,1411,NA,zevin02,92536645,pt,zevin9427@gmail.com,NA,2023-04-29T14:19:24Z,2023-04-29T14:19:24Z,please assign to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bH6Fm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1411,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bH_XL,kvrocks,1528821195,1411,NA,PragmaTwice,20042607,Twice,,NA,2023-04-29T16:11:51Z,2023-04-29T16:11:51Z,"> please assign to me

@git-hulk is self-assigned now, so it may not available for you.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bH_XL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1411,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bIS3J,kvrocks,1528901065,1411,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-04-30T00:06:13Z,2023-04-30T00:06:13Z,"Yes, it needs to add the cluster status into the replication process without breaking changes, so I assigned it to myself. Thanks for your attention. @zevin02 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bIS3J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1411,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fUQB1,kvrocks,1599144053,1411,NA,uds5501,21087061,Uddeshya Singh,singhuddeshyaofficial@gmail.com,NA,2023-06-20T16:40:15Z,2023-06-20T16:40:15Z,"What are the deliverables / check points for this task? I can think of 2 broad ones :
- When trying to toggling cluster mode on or off in master / slave, verify if both are on same mode or not, if not then maybe master can propogate the cluster mode `on` to slave as well (additional thoughts: this may break the cluster configs in other nodes of the cluster as they will be unaware of this new slave)

- When a master node is part of the cluster and a new instance is going to replicate this master, then it needs to be configured in such a way that it's part of the cluster as well.

LMK if I misunderstood these deliverables. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fUQB1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1411,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fXG_w,kvrocks,1599893488,1411,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-21T01:05:51Z,2023-06-21T01:05:51Z,"Hi @uds5501 Thanks for your attention.

Like Redis, Kvrocks can run in the master-replica or cluster mode(by enabling the cluster-enabled in kvrocks.conf), we would like to check if it configured the cluster mode consistently when setup the replication.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fXG_w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1412,https://api.github.com/repos/apache/kvrocks/issues/1412,kvrocks,1689615485,1412,Support slot batch operation for CLUSTERX SETSLOT (REVIVED),PragmaTwice,20042607,Twice,,CLOSED,2023-04-29T16:35:26Z,2023-05-14T11:53:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Since it seems important to support slot batch operation for CLUSTERX SETSLOT, we want to revive this abandoned PR #529.

From #529:
> Support for #510 
>
> It is an enhancement to the original implement of command `CLUSTERX SETSLOT`  #463 
>
> **Command formart**
>
> `CLUSTERX SETSLOT ""$slot_batch"" NODE $node_id $new_version`
>
> assign batch slots to the node if new version is current version+1. 
> It is compatible with the original command syntax.
>
> **Parameter Changes**
>
> > $slot_batch: batch slots which we want to assign. It can be given by single slotid or slot batch.  Slot batch can be given by continuous slot range or discrete slot list with spaces as separators, e.g. ""3 5 9 10-20"".
>
> **Example**
> `CLUSTERX SETSLOT 1 NODE $nodeid1 1`
> `CLUSTERX SETSLOT ""3 5 9 20-30"" NODE $nodeid1 2`


### Solution

See #529

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1412/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1413,https://api.github.com/repos/apache/kvrocks/issues/1413,kvrocks,1689815165,1413,Failed to build kvrocks due to ld error while linking libluajit.a,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-04-30T07:29:11Z,2023-05-05T05:30:51Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

```shell
$ uname -r                                                                                                    
5.15.90.1-microsoft-standard-WSL2

$ clang -v                                       
clang version 16.0.0
Target: x86_64-unknown-linux-gnu
Thread model: posix
InstalledDir: /usr/local/bin
Found candidate GCC installation: /usr/local/bin/../lib/gcc/x86_64-pc-linux-gnu/13.1.0
Selected GCC installation: /usr/local/bin/../lib/gcc/x86_64-pc-linux-gnu/13.1.0
Candidate multilib: .;@m64
Selected multilib: .;@m64

$ ld -v
LLD 16.0.0 (compatible with GNU linkers)

```
ubuntu 22(wsl)
kvrocks: the unstable branch

### Minimal reproduce step

I execute the build command.
```shell
./x.py build -DENABLE_OPENSSL=ON --ghproxy -j24
```


### What did you expect to see?

Build OK

### What did you see instead?



<details><summary>Build error</summary>
<p>


```shell
-- Configuring done (10.3s)
-- Generating done (0.2s)
-- Build files have been written to: ~/proj/finish_proj/incubator-kvrocks/build
$ /usr/local/bin/cmake --build . -j24 -t kvrocks kvrocks2redis
make[4]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.
make[4]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.
make[4]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.
make[4]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.
[  0%] Built target fmt
[  1%] Built target snappy
[  4%] Built target zlibstatic
[  6%] Built target glogbase
[ 10%] Built target event_core_static
[ 10%] Built target glog
[ 10%] Built target make_lz4
[ 10%] Built target event_pthreads_static
[ 11%] Built target event_openssl_static
[ 16%] Built target event_static
[ 22%] Built target tbb
[ 22%] Built target make_luajit
[ 22%] Built target make_zstd

ar: `u' modifier ignored since `D' is the default (see `U')
ar: `u' modifier ignored since `D' is the default (see `U')
[ 22%] Built target make_jemalloc
[ 22%] Building CXX object _deps/rocksdb-build/CMakeFiles/rocksdb.dir/db/malloc_stats.cc.o
[ 22%] Building CXX object _deps/rocksdb-build/CMakeFiles/rocksdb.dir/memory/jemalloc_nodump_allocator.cc.o
[ 22%] Building CXX object _deps/rocksdb-build/CMakeFiles/rocksdb.dir/memory/memory_allocator.cc.o
[ 22%] Linking CXX static library librocksdb.a
[ 86%] Built target rocksdb
[ 98%] Built target kvrocks_objs
[ 98%] Linking CXX executable kvrocks
/usr/bin/ld: _deps/luajit-src/src/libluajit.a(lj_err.o): relocation R_X86_64_32S against `.rodata' can not be used when making a PIE object; recompile with -fPIE
/usr/bin/ld: failed to set dynamic section sizes: bad value
clang-16: error: linker command failed with exit code 1 (use -v to see invocation)
gmake[3]: *** [CMakeFiles/kvrocks.dir/build.make:251: kvrocks] Error 1
gmake[2]: *** [CMakeFiles/Makefile2:521: CMakeFiles/kvrocks.dir/all] Error 2
gmake[1]: *** [CMakeFiles/Makefile2:528: CMakeFiles/kvrocks.dir/rule] Error 2
gmake: *** [Makefile:254: kvrocks] Error 2
Traceback (most recent call last):
  File ""~/proj/incubator-kvrocks/./x.py"", line 393, in <module>
    args.func(**arg_dict)
  File ""~/proj/incubator-kvrocks/./x.py"", line 134, in build
    run(cmake, *options, verbose=True, cwd=dir)
  File ""~/proj/incubator-kvrocks/./x.py"", line 66, in run
    raise RuntimeError(err)
RuntimeError: 
failed to run: ('/usr/local/bin/cmake', '--build', '.', '-j24', '-t', 'kvrocks', 'kvrocks2redis')
exit with code: 2
```
the error can also occur at `libjemalloc.a`

</p>
</details>

### Anything Else?

I set the `Jemalloc` and `Luajit` options off, and execute building without errors.
just like the command
`""command"": ""cd ${workspaceFolder};./x.py build -DENABLE_OPENSSL=ON -DDISABLE_JEMALLOC=ON -DUSE_LUAJIT=OFF --ghproxy -j24""
`

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1413/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1413,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bKFeQ,kvrocks,1529370512,1413,NA,PragmaTwice,20042607,Twice,,NA,2023-05-01T05:34:05Z,2023-05-01T05:34:05Z,"I will try to reproduce the issue.

BTW, it seems the lld has not been used ever (ld was used instead):
```
usr/bin/ld: _deps/luajit-src/src/libluajit.a(lj_err.o): relocation R_X86_64_32S against `.rodata' can not be used when making a PIE object; recompile with -fPIE
/usr/bin/ld: failed to set dynamic section sizes: bad value
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bKFeQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1413,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bKSoo,kvrocks,1529424424,1413,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-01T07:09:22Z,2023-05-01T07:09:22Z,"> I will try to reproduce the issue.
> 
> BTW, it seems the lld has not been used ever (ld was used instead):
> 
> ```
> usr/bin/ld: _deps/luajit-src/src/libluajit.a(lj_err.o): relocation R_X86_64_32S against `.rodata' can not be used when making a PIE object; recompile with -fPIE
> /usr/bin/ld: failed to set dynamic section sizes: bad value
> ```

I want to use the `lto` feature  so I execute the  `ln -s ld.lld /usr/bin/ld` command.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bKSoo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1413,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bWkN1,kvrocks,1532642165,1413,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-03T08:30:49Z,2023-05-03T08:30:49Z,"@PragmaTwice ~I solved this~.

https://github.com/apache/incubator-kvrocks/blob/30e9fd788a4acb585566a008f4d5fff65ee06ce3/CMakeLists.txt#L190-L195

I execute the code to line 194 and add the `-fpie` option.
gcc6 introduces `--enable-default-pie` and some same changelogs are added into `clang` baed on https://reviews.llvm.org/D113372 . It seems that I don't use `-fpie` argument.

But I don't know the cause.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bWkN1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1413,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bXm_6,kvrocks,1532915706,1413,NA,PragmaTwice,20042607,Twice,,NA,2023-05-03T12:10:14Z,2023-05-03T12:10:14Z,Good catch! Feel free to submit a PR.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bXm_6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1413,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bXwYi,kvrocks,1532954146,1413,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-03T12:34:25Z,2023-05-03T12:34:25Z,"This problem still exists👎  When I add `-fPIC -fPIE` to the 190-line and execute the command `./x.py build -DCMAKE_BUILD_TYPE=Debug -DENABLE_OPENSSL=ON -DDISABLE_JEMALLOC=ON --ghproxy -j24 `.

```sh
ld.lld: error: relocation R_X86_64_32 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_prng.o)
>>> referenced by lj_prng.c
>>>               lj_prng.o:(lj_prng_seed_secure) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32S cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_gc.o)
>>> referenced by lj_gc.c
>>>               lj_gc.o:(gc_sweep) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32S cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_gc.o)
>>> referenced by lj_gc.c
>>>               lj_gc.o:(gc_onestep) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_64 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_gc.o)
>>> referenced by lj_gc.c
>>>               lj_gc.o:(.rodata+0x0) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_64 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_gc.o)
>>> referenced by lj_gc.c
>>>               lj_gc.o:(.rodata+0x8) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_64 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_gc.o)
>>> referenced by lj_gc.c
>>>               lj_gc.o:(.rodata+0x10) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_64 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_gc.o)
>>> referenced by lj_gc.c
>>>               lj_gc.o:(.rodata+0x18) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_64 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_gc.o)
>>> referenced by lj_gc.c
>>>               lj_gc.o:(.rodata+0x20) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_64 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_gc.o)
>>> referenced by lj_gc.c
>>>               lj_gc.o:(.rodata+0x28) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_state.o)
>>> referenced by lj_state.c
>>>               lj_state.o:(lua_newstate) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_state.o)
>>> referenced by lj_state.c
>>>               lj_state.o:(lua_close) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32S cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_err.o)
>>> referenced by lj_err.c
>>>               lj_err.o:(err_unwind) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32S cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_err.o)
>>> referenced by lj_err.c
>>>               lj_err.o:(lj_err_register_mcode) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32S cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_err.o)
>>> referenced by lj_err.c
>>>               lj_err.o:(lj_err_run) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_err.o)
>>> referenced by lj_err.c
>>>               lj_err.o:(lj_err_lex) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_meta.o)
>>> referenced by lj_meta.c
>>>               lj_meta.o:(lj_meta_init) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32S cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_strfmt.o)
>>> referenced by lj_strfmt.c
>>>               lj_strfmt.o:(lj_strfmt_parse) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32S cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_strfmt.o)
>>> referenced by lj_strfmt.c
>>>               lj_strfmt.o:(lj_strfmt_parse) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32S cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_strfmt.o)
>>> referenced by lj_strfmt.c
>>>               lj_strfmt.o:(lj_strfmt_wptr) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: relocation R_X86_64_32 cannot be used against local symbol; recompile with -fPIC
>>> defined in _deps/luajit-src/src/libluajit.a(lj_strfmt.o)
>>> referenced by lj_strfmt.c
>>>               lj_strfmt.o:(lj_strfmt_putfxint) in archive _deps/luajit-src/src/libluajit.a

ld.lld: error: too many errors emitted, stopping now (use --error-limit=0 to see all errors)
clang-16: error: linker command failed with exit code 1 (use -v to see invocation)
```

I execute the command `./x.py build -DCMAKE_BUILD_TYPE=Debug -DENABLE_OPENSSL=ON -DUSE_LUAJIT=OFF --ghproxy -j24 `. It also makes a similar error.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bXwYi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1413,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bXzXA,kvrocks,1532966336,1413,NA,PragmaTwice,20042607,Twice,,NA,2023-05-03T12:43:28Z,2023-05-03T12:43:28Z,"Could you provide a full and clean (first time build) CMake log file? I am not sure which C compiler is used.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bXzXA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1413,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bX_69,kvrocks,1533017789,1413,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-03T13:18:30Z,2023-05-03T13:18:30Z,[enable_luajit_jemalloc.cmake_logs](https://github.com/infdahai/incubator-kvrocks/blob/9464020fe9c34291ebc875e40e522672211524fd/enable_lua_json.log),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bX_69/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1413,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5biTEL,kvrocks,1535717643,1413,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-05T05:30:50Z,2023-05-05T05:30:50Z,"I change the toolchain to `gcc-13` and the compile has no problem now.
Therefore I close the issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5biTEL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1416,https://api.github.com/repos/apache/kvrocks/issues/1416,kvrocks,1693502208,1416,common/ParseUtil replace erro msgs with error integers ,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-03T06:50:41Z,2023-05-03T12:07:46Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

for exmaple, one instantiation of ParseInt presents below.

https://github.com/apache/incubator-kvrocks/blob/30e9fd788a4acb585566a008f4d5fff65ee06ce3/src/common/parse_util.h#L113-L125

We can't get a more detailed information about what `v` meanings in Parse() func and just think it as an non-integer error if the parsing occurs the error.

I view the source code about calling `ParseInt`(or `ParseType`) functions and find that we use the parse  function without taking advantage of the info from error msgs.

```cpp
// in the process of pasrsing commands.
      auto parse_result = ParseInt<int64_t>(int1, 10);
      if (!parse_result) {
        return {Status::NotOK, InvalidMsgs};
      }
```

We can provide an exact error-msg actually, such as `out of range about the NodeId`, `illegal character of the 'ClusterNode' str`.

This is a issue for helpful msgs, so it is not necessary. Please add `help wanted` and `good for first` labels.


### Solution

It needs a lot of work here.

we just define different error-types in parse_util module and the concrete caller use the type to modify error-msgs.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1416/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1416,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bWMVZ,kvrocks,1532544345,1416,NA,PragmaTwice,20042607,Twice,,NA,2023-05-03T06:59:57Z,2023-05-03T06:59:57Z,"I think it seems not necessary to create status codes for every parsing error type. In kvrocks, a better and simple solution already exists:
```c++
auto version = ParseInt<VersionInteger>(version_str);
if (!version) {
  return std::move(version).Prefixed(""failed to parse version"");
}

// do something with *version ...
```

Then users will get a well-formed error message, like `failed to parse version: out of range` or `failed to parse version: encounter non-digit characters`.

And we even have a more compact form to handle this pattern:
```c++
int version = GET_OR_RET(ParseInt<int>(version_str).Prefixed(""failed to parse version""));
// use this integer, no need of if statements
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bWMVZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1416,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bWVVv,kvrocks,1532581231,1416,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-03T07:38:19Z,2023-05-03T07:38:19Z,"yes, `v.Prefixed(""failed to parse version"");` is enough.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bWVVv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1417,https://api.github.com/repos/apache/kvrocks/issues/1417,kvrocks,1695214966,1417,Add support of RocksDB auto-tune rate limiter for the background IO,wanghenshui,8872493,Ted Mostly,wanghenshui@qq.com,CLOSED,2023-05-04T03:50:23Z,2023-05-17T04:00:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation


https://rocksdb.org/blog/2017/12/18/17-auto-tuned-rate-limiter.html

### Solution
https://github.com/apache/incubator-kvrocks/blob/30e9fd788a4acb585566a008f4d5fff65ee06ce3/src/storage/storage.cc#L163

change to this
```c++
rocksdb::NewGenericRateLimiter(
        rate_limiter_bandwidth(),
        rate_limiter_refill_period_us(),
        rate_limiter_fairness(),
        rocksdb::RateLimiter::Mode::kWritesOnly,
        rate_limiter_auto_tuned()
      );
```


### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1417/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1417,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bb_ub,kvrocks,1534065563,1417,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-04T04:01:01Z,2023-05-04T04:01:01Z,"Hi @wanghenshui 

Thanks for your proposal, would you like to take this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bb_ub/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1417,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcEkV,kvrocks,1534085397,1417,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-05-04T04:36:54Z,2023-05-04T04:36:54Z,Seems that it can benefits I/O scheduling rather than using `kIORateLimitMaxMb` as fixed io limits? Should we default using that or just as a config?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcEkV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1417,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcGJB,kvrocks,1534091841,1417,NA,wanghenshui,8872493,Ted Mostly,wanghenshui@qq.com,NA,2023-05-04T04:52:37Z,2023-05-04T04:52:37Z,"> Hi @wanghenshui
> 
> Thanks for your proposal, would you like to take this?

ok","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcGJB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1417,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcOHT,kvrocks,1534124499,1417,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-04T05:44:55Z,2023-05-04T05:44:55Z,"> Seems that it can benefits I/O scheduling rather than using `kIORateLimitMaxMb` as fixed io limits? Should we default using that or just as a config?

I think it'd be better to make this as default. How do you think?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcOHT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1417,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcO8X,kvrocks,1534127895,1417,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-05-04T05:51:21Z,2023-05-04T05:51:21Z,"I guess we can, but we'd better testing it first. @xiaobiaozhao would you like to take a look or do some testing if auto tune rate limiter is supportted?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcO8X/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1417,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcbC7,kvrocks,1534177467,1417,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-05-04T06:51:29Z,2023-05-04T06:51:29Z,"1. This parameter looks very good, can promote the whole DB performance college
2. I can test the parameters of performance improvement this weekend","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bcbC7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1421,https://api.github.com/repos/apache/kvrocks/issues/1421,kvrocks,1697334320,1421,Improve build Docker image on Alpine Linux with musl libc,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2023-05-05T09:55:16Z,2023-05-08T07:18:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

If I need a build kvrocks Docker image, based on Alpine linux, I had an error:


> #0 3841.6 [ 98%] Building CXX object CMakeFiles/kvrocks.dir/src/main.cc.o
> #0 3851.1 [100%] Linking CXX executable kvrocks
> #0 3994.4 /usr/lib/gcc/x86_64-alpine-linux-musl/11.2.1/../../../../x86_64-alpine-linux-musl/bin/ld: CMakeFiles/kvrocks.dir/src/main.cc.o: in function `SegvHandler':
> #0 3995.4 /kvrocks/src/main.cc:87: undefined reference to `backtrace'
> #0 3995.4 /usr/lib/gcc/x86_64-alpine-linux-musl/11.2.1/../../../../x86_64-alpine-linux-musl/bin/ld: /kvrocks/src/main.cc:88: undefined reference to `backtrace_symbols'
> #0 4004.7 collect2: error: ld returned 1 exit status
> #0 4004.7 make[3]: *** [CMakeFiles/kvrocks.dir/build.make:249: kvrocks] Error 1
> #0 4004.7 make[2]: *** [CMakeFiles/Makefile2:521: CMakeFiles/kvrocks.dir/all] Error 2
> #0 4004.8 make[1]: *** [CMakeFiles/Makefile2:528: CMakeFiles/kvrocks.dir/rule] Error 2
> #0 4004.8 make: *** [Makefile:254: kvrocks] Error 2

It seems like musl does not provide the backtrace function.

### Solution

Some about this I fined there - https://github.com/xournalpp/xournalpp/issues/3817 and now I test some fix. 


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1421/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bjrfw,kvrocks,1536079856,1421,NA,PragmaTwice,20042607,Twice,,NA,2023-05-05T10:55:50Z,2023-05-05T10:55:50Z,"https://github.com/godotengine/godot/issues/57193
https://github.com/godotengine/godot-proposals/issues/2439

Seems you can try to install libexecinfo, or try to link it to kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bjrfw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bni_q,kvrocks,1537093610,1421,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-05-06T08:53:28Z,2023-05-06T08:53:28Z,"> [godotengine/godot#57193](https://github.com/godotengine/godot/issues/57193) [godotengine/godot-proposals#2439](https://github.com/godotengine/godot-proposals/issues/2439)
> 
> Seems you can try to install libexecinfo, or try to link it to kvrocks.

Thanks, but it's only a part of them. I have successful build but  final container not work correctly. Investigating now","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bni_q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1423,https://api.github.com/repos/apache/kvrocks/issues/1423,kvrocks,1697555246,1423,"For bitmap, there are some suggestions",KeeProMise,38941777,Jian Zhang,,CLOSED,2023-05-05T12:41:41Z,2023-05-05T14:53:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

“We break the bitmap values into fragments(1KiB, 8192 bits/fragment), and subkey is the index of the fragment. For example, when the request to set the bit of 1024 would locate in the first fragment with index 0, to set a bit of 80970 would locate in 10th fragment with index 9.”



### Solution

If we modify a bit in a certain fragment, we still need 1kb of space, can we directly save the value of the position that needs to be modified when the amount of data is small?
Assuming that we block by 1kb, the range of the position to be modified is 1~2^10-1. For a certain position x, we only need to save 10 bits, and we can go to the whole, that is, use a position data 2b (16 bits).
So 1kb, we can store up to 512 location data. So when the modified bit position in a fragment is less than 512, we can directly save its position value. Assuming that only a small number of positions in the fragment are modified at this time (for example, two positions are changed from 0 to 1), then only 4b space is needed , without taking up the full 1kb.
When a storage engine with an LSM mechanism such as rocksdb is used at the bottom layer, reducing space usage can also reduce read and write amplification.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1423/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1423,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bkPLd,kvrocks,1536226013,1423,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-05-05T12:59:13Z,2023-05-05T12:59:13Z,"For bitmap compression, there are multiple possible ways. And please notice that, for a ""dense"" bitmap, compression might be useless.

There are some mature bitmap compression methods, like Roaring Bitmap or Oracle BCC.

By the way, introducing an format change should be heavy, because we need to detect which underlying data is used and considering the backward capability.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bkPLd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1423,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bkPhA,kvrocks,1536227392,1423,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-05T13:00:18Z,2023-05-05T13:00:18Z,"Hi, @KeeProMise Thanks for your proposal.

For the current implementation, the bitmap's fragment won't always take 1KiB, it determines by the max bit position in this fragment. That's to say, if the max set position is 3, the fragment size should be 1 byte, and it will be 1KiB if the max set position is 8000.

Another question is how the new data fragment is compatible with the previous one. My sentiment is negative unless we have enough users complain about this.  ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bkPhA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1425,https://api.github.com/repos/apache/kvrocks/issues/1425,kvrocks,1698531377,1425,Failed to build kvrocks due to instruction tpause in TBB,mnizhq007,23118518,,,CLOSED,2023-05-06T08:17:10Z,2023-05-06T09:38:30Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

kvrocks：2.4.0
-- CMAKE_BINARY_DIR:         /root/incubator-kvrocks-2.4.0/build
-- CMAKE_CURRENT_BINARY_DIR: /root/incubator-kvrocks-2.4.0/build/_deps/libevent-build
-- CMAKE_SOURCE_DIR:         /root/incubator-kvrocks-2.4.0
-- CMAKE_CURRENT_SOURCE_DIR: /root/incubator-kvrocks-2.4.0/build/_deps/libevent-src
-- PROJECT_BINARY_DIR:       /root/incubator-kvrocks-2.4.0/build/_deps/libevent-build
-- PROJECT_SOURCE_DIR:       /root/incubator-kvrocks-2.4.0/build/_deps/libevent-src
-- CMAKE_MODULE_PATH:        /root/incubator-kvrocks-2.4.0/build/_deps/libevent-src/cmake/
-- CMAKE_COMMAND:            /usr/local/bin/cmake
-- CMAKE_ROOT:               /usr/local/share/cmake-3.25
-- CMAKE_SYSTEM:             Linux-3.10.0-957.el7.x86_64
-- CMAKE_SYSTEM_NAME:        Linux
-- CMAKE_SYSTEM_VERSION:     3.10.0-957.el7.x86_64
-- CMAKE_SYSTEM_PROCESSOR:   x86_64
-- CMAKE_SKIP_RPATH:         NO
-- CMAKE_VERBOSE_MAKEFILE:   FALSE
-- CMAKE_C_FLAGS:             -Wall -Wextra -Wno-unused-parameter -Wstrict-aliasing -Wstrict-prototypes -fno-strict-aliasing -Wmissing-prototypes -Winit-self -Wmissing-field-initializers -Wdeclaration-after-statement -Waddress -Wnormalized=id -Woverride-init -Wlogical-op -Wwrite-strings
-- CMAKE_BUILD_TYPE:         RelWithDebInfo
-- CMAKE_C_COMPILER:         /usr/bin/cc (id GNU, clang 0, GNUC 1)
-- CMAKE_AR:                 /usr/bin/ar
-- CMAKE_RANLIB:             /usr/bin/ranlib


### Minimal reproduce step

./x.py build

### What did you expect to see?

I hope to successfully complete the compilation of the latest version.

### What did you see instead?


[  1%] Built target make_jemalloc
[  1%] Built target make_lz4
[  1%] Built target make_zstd
[  1%] Built target make_luajit
[  2%] Built target glogbase
[  2%] Built target glog
[  3%] Built target snappy
[  6%] Built target zlibstatic
[  6%] Building CXX object _deps/tbb-build/src/tbb/CMakeFiles/tbb.dir/address_waiter.cpp.o
[  8%] Building CXX object _deps/tbb-build/src/tbb/CMakeFiles/tbb.dir/allocator.cpp.o
[  8%] Building CXX object _deps/tbb-build/src/tbb/CMakeFiles/tbb.dir/arena.cpp.o
/tmp/ccWap3gD.s: Assembler messages:
/tmp/ccWap3gD.s:23862: Error: no such instruction: `tpause %ecx'
/tmp/ccWap3gD.s:25254: Error: no such instruction: `tpause %ecx'
gmake[3]: *** [_deps/tbb-build/src/tbb/CMakeFiles/tbb.dir/arena.cpp.o] Error 1
gmake[2]: *** [_deps/tbb-build/src/tbb/CMakeFiles/tbb.dir/all] Error 2
gmake[1]: *** [CMakeFiles/kvrocks.dir/rule] Error 2
gmake: *** [kvrocks] Error 2
Traceback (most recent call last):
  File ""./x.py"", line 393, in <module>
    args.func(**arg_dict)
  File ""./x.py"", line 134, in build
    run(cmake, *options, verbose=True, cwd=dir)
  File ""./x.py"", line 66, in run
    raise RuntimeError(err)
RuntimeError: 
failed to run: ('/usr/local/bin/cmake', '--build', '.', '-t', 'kvrocks', 'kvrocks2redis')
exit with code: 2

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1425/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1425,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bnhhT,kvrocks,1537087571,1425,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-05-06T08:19:28Z,2023-05-06T08:19:28Z,"Please provide more info about your build environment: OS version, arch, compiler toolchain, ...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bnhhT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1425,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bnhps,kvrocks,1537088108,1425,NA,PragmaTwice,20042607,Twice,,NA,2023-05-06T08:22:25Z,2023-05-06T08:22:25Z,"Refer to https://github.com/oneapi-src/oneTBB/issues/859.

As they do not plan to fix this issue, you have several choices (one of them is ok):
- update your binutils version to  2.31.1 or later (it is not a pretty new version, so I think it is not too hard)
- use GCC <= 10 (but you need GCC >= 7 as a requirement of kvrocks, so the version of GCC need to be in [7, 10])","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5bnhps/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1439,https://api.github.com/repos/apache/kvrocks/issues/1439,kvrocks,1708918834,1439,support  transcation processing  for `cluster setslot` ,infdahai,30547248,clundro,infdahai@outlook.com,OPEN,2023-05-14T11:59:50Z,2023-09-07T02:49:37Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

_Originally posted by @infdahai in https://github.com/apache/incubator-kvrocks/pull/1414#discussion_r1185736226_

 `Cluster::SetSlotRanges` exists consistency issues if `slot` in the middle is down
https://github.com/apache/incubator-kvrocks/blob/d2d10f7dd220992a2c7cf9f1b44a96a6c6ac80a7/src/cluster/cluster.cc#L123-L145

### Solution

@caipengbo 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1439/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1439,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fJItA,kvrocks,1596230464,1439,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-18T18:25:18Z,2023-06-18T18:25:18Z,"BTW, two places exist in `cluster.cc`. We should find a solution to delete all the range in a write batch.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fJItA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1439,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l2mjG,kvrocks,1708812486,1439,NA,ameya-deshmukh,74180822,Ameya Deshmukh,ad@seismic.systems,NA,2023-09-06T17:31:30Z,2023-09-06T17:31:30Z,"@infdahai is this still relevant?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l2mjG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1439,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l4pQZ,kvrocks,1709347865,1439,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-07T01:52:21Z,2023-09-07T01:52:21Z,"@ameya-deshmukh Yes, would you like to take this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l4pQZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1439,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l414q,kvrocks,1709399594,1439,NA,ameya-deshmukh,74180822,Ameya Deshmukh,ad@seismic.systems,NA,2023-09-07T02:49:36Z,2023-09-07T02:49:36Z,Yep!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l414q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1441,https://api.github.com/repos/apache/kvrocks/issues/1441,kvrocks,1711512764,1441,Hash::MGet: use DB::MultiGet for hash fields,rockeet,1574991,rockeet,rockeet@163.com,CLOSED,2023-05-16T08:26:48Z,2023-05-22T05:27:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

`DB::MultiGet` pushes fields query to RocksDB, thus RocksDB can perform optimizations, such as async io by io uring.

Although this optimization is less than `mget` for strings, it is valuable because different fields may lies in different levels of the LSM Tree, thus async io can take effect.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1441/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1441,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cXunS,kvrocks,1549724114,1441,NA,zevin02,92536645,pt,zevin9427@gmail.com,NA,2023-05-16T13:55:44Z,2023-05-16T13:55:44Z,I hope to deal with it,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cXunS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1441,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cX-mA,kvrocks,1549789568,1441,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-16T14:29:13Z,2023-05-16T14:29:13Z,"Thanks @zevin02, assigned","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cX-mA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1442,https://api.github.com/repos/apache/kvrocks/issues/1442,kvrocks,1711815393,1442,"[kvrocks2redis] CRITICAL - Failed to psync , please remove last_next_seq config file",mnizhq007,23118518,,,OPEN,2023-05-16T11:21:30Z,2023-05-16T11:21:30Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

os：Centos 7.9
kvrocks2redis：2.4.0
kvrocks：2.4.0 cluster
Redis：4.0.10 cluster

### Minimal reproduce step

the config file：

log-level INFO
daemonize no
data-dir ./data
output-dir ./
kvrocks IP1 port1 kvrocks-password
kvrocks IP2 port2 kvrocks-password
kvrocks IP3 port3 kvrocks-password
cluster-enable yes
namespace. IP4 port4 rediscluser-password
namespace. IP5 port5 rediscluser-password
namespace. IP6 port6 rediscluser-password

### What did you expect to see?

I need to migrate my Kvrocks data to redis

### What did you see instead?

kvrocks2redis -c 1.conf

Version: 2.4.0 @
E20230516 19:19:48.465279 181438 sync.cc:86] [kvrocks2redis] CRITICAL - Failed to psync , please remove last_next_seq config file, and restart kvrocks2redis, redis reply: -ERR sequence out of range, please use fullsync

### Anything Else?

I also need data migration between kvrocks clusters

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1442/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/1445,kvrocks,1715850442,1445,Add the support of the `BZMPOP` command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-18T15:40:14Z,2023-06-18T16:28:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

 This issue considers to support [`bzmpop`](https://redis.io/commands/bzmpop/), `bzpopmax`, `bzpopmin` commands.

And the implementation should process a `timeout` argument. 

### Solution

- [ ] bzmpop
- [ ] bzpopmax
- [ ] bzpopmin

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1445/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cnpbl,kvrocks,1553897189,1445,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-19T01:51:52Z,2023-05-19T01:51:52Z,@infdahai Would you like to do this?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cnpbl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cojaa,kvrocks,1554134682,1445,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-19T07:14:00Z,2023-05-19T07:14:00Z,"I can accept this task for now but it needs time.

>And more specifically, I want to use bzpop<max|min|null>, <z|s>intercard, zmpop go APIs to write some go-unit tests for supporting the more commands from zset or set in kvrocks. These commands from redis(version >= 6.2) are not implemented in this project.

Because I want to implement all commands from [`zset`](https://redis.io/commands/bzmpop/). If anyone wants to get involved in this task, you can just reply under this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cojaa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dO9UF,kvrocks,1564202245,1445,NA,Yangsx-1,85615957,Hauru,,NA,2023-05-26T10:47:46Z,2023-05-26T10:47:46Z,"I want to participate in the task, can i contact you through wechat or other ways?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dO9UF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dPETo,kvrocks,1564230888,1445,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-26T11:11:36Z,2023-05-26T11:11:36Z,@git-hulk please invite him to wechat groups. Mabye you can search the TimerCB funcs in the codebase to learn how to add the event to the loop. And we can talk the impl here to help others also know the progress.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dPETo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dPGYh,kvrocks,1564239393,1445,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-26T11:18:37Z,2023-05-26T11:18:37Z,"Please follow the WeChat Official Account at the bottom of README.md, then join the WeChat group via the guidance.

But we encourage everyone to discuss the proposal or solution via GitHub Discussion instead of a private channel.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dPGYh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dPQd6,kvrocks,1564280698,1445,NA,Yangsx-1,85615957,Hauru,,NA,2023-05-26T11:57:32Z,2023-05-26T11:57:32Z,"Ok, I'm already in the group and i'll look into the code. I’m new in here, may i'll have many questions, lol.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dPQd6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eLA33,kvrocks,1579945463,1445,NA,Yangsx-1,85615957,Hauru,,NA,2023-06-07T05:50:22Z,2023-06-07T05:50:22Z,I think it's bzpopmax rather than bzmpopmax.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eLA33/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eLEUh,kvrocks,1579959585,1445,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-07T06:06:52Z,2023-06-07T06:06:52Z,"> I think it's bzpopmax rather than bzmpopmax.

Thanks, fixed","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eLEUh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eL4mv,kvrocks,1580173743,1445,NA,PragmaTwice,20042607,Twice,,NA,2023-06-07T08:16:00Z,2023-06-07T08:16:00Z,"Note: As an ASF community, we do not endorse any discussion on some private channels like wechat group. 

We prefer public available discussion like GitHub issues, discussions and ASF mailing lists. Feel free to post your questions on these platform.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eL4mv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eL8hb,kvrocks,1580189787,1445,NA,Yangsx-1,85615957,Hauru,,NA,2023-06-07T08:27:05Z,2023-06-07T08:27:05Z,"> Note: As an ASF community, we do not endorse any discussion on some private channels like wechat group.
> 
> We prefer public available discussion like GitHub issues, discussions and ASF mailing lists. Feel free to post your questions on these platform.

Ok, i'm just a little shy. I'll post my question if i cannot overcome it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eL8hb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebvGb,kvrocks,1584329115,1445,NA,Yangsx-1,85615957,Hauru,,NA,2023-06-09T10:11:59Z,2023-06-09T10:11:59Z,"I‘ve already finish the code, and have tested it manually.
I'm now trying to add some go tests but i'm not very familiar with go and go test.
I want to know how to run single test for zset, i tried several ways but it didn't work.   :(","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebvGb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebwmf,kvrocks,1584335263,1445,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T10:16:47Z,2023-06-09T10:16:47Z,"> I‘ve already finish the code, and have tested it manually. I'm now trying to add some go tests but i'm not very familiar with go and go test. I want to know how to run single test for zset, i tried several ways but it didn't work. :(

Hi @Yangsx-1, You can reach me on Slack if you need help.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebwmf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebwx4,kvrocks,1584335992,1445,NA,PragmaTwice,20042607,Twice,,NA,2023-06-09T10:17:23Z,2023-06-09T10:17:23Z,"> I‘ve already finish the code, and have tested it manually.
> I'm now trying to add some go tests but i'm not very familiar with go and go test.
> I want to know how to run single test for zset, i tried several ways but it didn't work.   :(

Try something like `./x.py test go <build-dir> -run <match-str>`.

And you can refer to `go test --help` for more information about the `-run` option.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebwx4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1445,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eb29b,kvrocks,1584361307,1445,NA,Yangsx-1,85615957,Hauru,,NA,2023-06-09T10:34:31Z,2023-06-09T10:34:31Z,"Ok, I'll try it first. I'll contact you if i have some problems later @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eb29b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1447,https://api.github.com/repos/apache/kvrocks/issues/1447,kvrocks,1715904927,1447,use clang-16 && gcc-13 to build ,infdahai,30547248,clundro,infdahai@outlook.com,OPEN,2023-05-18T16:17:29Z,2024-08-14T02:11:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue has a request to use `clang-16` and `gcc-13` to build docker images or `cmakelists.txt` in local developing environment and use `clang-tidy-16` and `clang-format-16` to correct code formattings.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1447/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1447,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5clbvX,kvrocks,1553316823,1447,NA,torwig,8588372,Yaroslav,,NA,2023-05-18T16:32:51Z,2023-05-18T16:32:51Z,@infdahai Does the Ubuntu 20.04 have clang-16 in its repository?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5clbvX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1447,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5clsVM,kvrocks,1553384780,1447,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-18T17:30:53Z,2023-05-18T17:30:53Z,"No. `clang-10` is the default version in [`ubuntu 20.04`](https://packages.ubuntu.com/focal/clang).

I see the [kvrocks.yaml](https://github.com/apache/incubator-kvrocks/blob/unstable/.github/workflows/kvrocks.yaml) file uses `ubuntu-22.04` and this distro supports `clang-15`. So I just ask this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5clsVM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1447,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fEbzp,kvrocks,1594997993,1447,NA,PragmaTwice,20042607,Twice,,NA,2023-06-16T17:11:12Z,2023-06-16T17:11:12Z,"I have been using GCC 13 to build kvrocks for a long time and haven't encountered any issues so far. 

Getting GCC 13 or Clang 16 in CI may require manual download and installation, but I don't object to adding new compiler builds in CI (currently, the default versions of GCC and Clang in both ubuntu 20 LTS and ubuntu 22 LTS are used in CI, refer to https://github.com/actions/runner-images).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fEbzp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1447,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fG8Md,kvrocks,1595654941,1447,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-17T07:18:17Z,2023-06-17T07:18:17Z,"for clang-16, we can refer to

https://github.com/MikePopoloski/slang/blob/385e8e3a666551416fe76fcd9f0d6f0ba845b9bc/.github/workflows/build.yml#L40-L46 

or execute the shell script.

```yaml
          wget https://apt.llvm.org/llvm.sh
          chmod +x llvm.sh
          sudo ./llvm.sh 16
          sudo apt-get install -y clang-tidy-16
```

But I havn't found a vaild example for gcc-13. What do you think @PragmaTwice or just pend for this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fG8Md/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1447,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fIq2P,kvrocks,1596108175,1447,NA,PragmaTwice,20042607,Twice,,NA,2023-06-18T11:18:34Z,2023-06-18T11:18:34Z,"> for clang-16, we can refer to
> 
> https://github.com/MikePopoloski/slang/blob/385e8e3a666551416fe76fcd9f0d6f0ba845b9bc/.github/workflows/build.yml#L40-L46
> 
> or execute the shell script.
> 
> ```yaml
>           wget https://apt.llvm.org/llvm.sh
>           chmod +x llvm.sh
>           sudo ./llvm.sh 16
>           sudo apt-get install -y clang-tidy-16
> ```
> 
> But I havn't found a vaild example for gcc-13. What do you think @PragmaTwice or just pend for this?

For gcc-13 we can add a PPA for ubuntu, refer to https://launchpad.net/~ubuntu-toolchain-r/+archive/ubuntu/ppa .

BTW I am not a ubuntu user : )","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fIq2P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1447,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IW4fZ,kvrocks,2287699929,1447,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-08-14T02:11:15Z,2024-08-14T02:11:15Z,"I was suggested to add a blank line at the end of the code when I submitted a PR, but now there are no rules for clang-format. I learned that the rule `InsertNewlineAtEOF` is supported in clang-format 16. Is it possible to update the clang-format version and add this rule?

https://clang.llvm.org/docs/ClangFormatStyleOptions.html#insertnewlineateof","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IW4fZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1448,https://api.github.com/repos/apache/kvrocks/issues/1448,kvrocks,1716485132,1448,Data race in TBB::concurrent_queue when running integrate tests,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-05-19T01:39:32Z,2023-06-13T08:21:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

detail logs: https://github.com/apache/incubator-kvrocks/actions/runs/5015903443/jobs/8992316856?pr=1446

### What did you expect to see?

all tests are passed

### What did you see instead?

one of them crashed when running

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1448/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1448,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvJCp,kvrocks,1555861673,1448,NA,PragmaTwice,20042607,Twice,,NA,2023-05-20T08:25:31Z,2023-05-20T08:25:31Z,"I think maybe it is a false positive. 

We can try to add it into https://github.com/apache/incubator-kvrocks/blob/unstable/tests/tsan-suppressions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvJCp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1448,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cza8b,kvrocks,1556983579,1448,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-22T10:40:01Z,2023-05-22T10:40:01Z,"> I think maybe it is a false positive.
> 
> We can try to add it into https://github.com/apache/incubator-kvrocks/blob/unstable/tests/tsan-suppressions.

OK","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cza8b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1450,https://api.github.com/repos/apache/kvrocks/issues/1450,kvrocks,1717481543,1450,How do I run a specified go unit test through x.py?,xiaobiaozhao,52393536,xiaobiaozhao,,CLOSED,2023-05-19T16:04:00Z,2023-05-21T02:14:22Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

How do I run a specified go unit test through x.py?

### Solution

I think a note could be added to the readme

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1450/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1450,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5crFjl,kvrocks,1554798821,1450,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-05-19T16:07:04Z,2023-05-19T16:07:04Z,@tisonkun Would you improve the documentation?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5crFjl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1450,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5crHiD,kvrocks,1554806915,1450,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-19T16:14:36Z,2023-05-19T16:14:36Z,"for example, I exec the followling commands.
```shell
cd ${workspaceFolder}
./x.py build --unittest -DCMAKE_BUILD_TYPE=Debug  -j24

./build/unittest --gtest_filter=RedisSetTest.InterCard

./build/unittest --gtest_filter=RedisSetTest.*
```

After this, I get the output from `RedisSetTest.InterCard` and all outputs from `RedisSetTest`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5crHiD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1450,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvAEW,kvrocks,1555824918,1450,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-20T07:52:28Z,2023-05-20T07:52:28Z,"I exec the command `./x.py test cpp rest --gtest_filter=RedisSetTest.*` and then I get an error msg like `FileNotFoundError: [Errno 2] No such file or directory: '~/incubator-kvrocks/rest'`.

https://github.com/apache/incubator-kvrocks/blob/fb0e3d42031a6e0691c7a736711d0a01d72bdb1a/x.py#L376-L379

https://github.com/apache/incubator-kvrocks/blob/fb0e3d42031a6e0691c7a736711d0a01d72bdb1a/x.py#L246-L250

The reason why the error occurs is that `basedir` is generated to the dir `~/incubator-kvrocks/rest`.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvAEW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1450,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvCJ8,kvrocks,1555833468,1450,NA,PragmaTwice,20042607,Twice,,NA,2023-05-20T07:58:10Z,2023-05-20T07:58:10Z,"`./x.py test go <build-dir> <go-test-command-args...>`.

Same as `./x.py test cpp <build-dir> <gtest-command-args...>`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvCJ8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1450,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvLxt,kvrocks,1555872877,1450,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-05-20T09:29:27Z,2023-05-20T09:29:27Z,"I take a look at https://kvrocks.apache.org/community/contributing/#submit-patches-to-kvrocks. Maybe we can add a paragraph under the one talking about running tests.

But actually it's as intuitive as `./x.py test go --help` and the command is self-explain.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvLxt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1450,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvL1X,kvrocks,1555873111,1450,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-05-20T09:31:00Z,2023-05-20T09:31:00Z,"Also, we actually print back all real command, so you can already debugging:

```
./x.py test go build -run TestInvalid
$ /opt/homebrew/bin/go test -timeout=1800s -bench=. ./... -binPath=/Users/chenzili/Brittani/kvrocks/build/kvrocks -cliPath=redis-cli -workspace=/Users/chenzili/Brittani/kvrocks/tests/gocase/workspace -run TestInvalid
```

Notice the second line is the actual execute command.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvL1X/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/1451,kvrocks,1718107000,1451,Fix all weird out parameters `int *ret` in the codebase,PragmaTwice,20042607,Twice,,CLOSED,2023-05-20T08:58:13Z,2023-06-01T16:44:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Refer to https://github.com/apache/incubator-kvrocks/pull/1444#discussion_r1199580764.
> Maybe not related to this PR, but there are two points:
>
> - `ret` is not a descriptive word
> - `int` type is not fit here: the return variable `members.size()` is typed `size_t`, not `int`

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1451/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvKme,kvrocks,1555868062,1451,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-20T09:02:08Z,2023-05-20T09:02:08Z,"@PragmaTwice I find the statement `*output = redis::Integer(ret);` is used multiple times to return the result to the client in [cmd_set.cc](https://github.com/apache/incubator-kvrocks/blob/unstable/src/commands/cmd_set.cc).
https://github.com/apache/incubator-kvrocks/blob/fb0e3d42031a6e0691c7a736711d0a01d72bdb1a/src/server/redis_reply.h#L38-L41

Add the `Integer` func checks whether compatibility with `int` is required(Of course, `size_t` is right). I see src/types/*.h and many funcs with this situation use `int`. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvKme/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvLKd,kvrocks,1555870365,1451,NA,PragmaTwice,20042607,Twice,,NA,2023-05-20T09:14:06Z,2023-05-20T09:14:06Z,"`Integer` can accept all [integral types](https://en.cppreference.com/w/cpp/types/is_integral) as its input, which includes `size_t`.

So I think it is not an obstacle.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cvLKd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dITCs,kvrocks,1562456236,1451,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-05-25T07:59:22Z,2023-05-25T07:59:22Z,"Hello, I want to try it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dITCs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dIYCi,kvrocks,1562476706,1451,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-25T08:13:14Z,2023-05-25T08:13:14Z,"> Hello, I want to try it.

Go ahead. It seems you will replace the `int` type with a more precise type, specially `size_t`. Remove the unnecessary type casting.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dIYCi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dIZE5,kvrocks,1562480953,1451,NA,torwig,8588372,Yaroslav,,NA,2023-05-25T08:16:24Z,2023-05-25T08:16:24Z,@infdahai You mean `size_t` by typing `usize`?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dIZE5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dIfgX,kvrocks,1562507287,1451,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-25T08:35:40Z,2023-05-25T08:35:40Z,"Typos. Thanks for pointing it out


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dIfgX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dNiGR,kvrocks,1563828625,1451,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-05-26T05:26:09Z,2023-05-26T05:26:09Z,This issue involves many files. Should I submit one PR with all of the changes?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dNiGR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dNivx,kvrocks,1563831281,1451,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-26T05:30:38Z,2023-05-26T05:30:38Z,"Yes, it's fine since the change is intuitive.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dNivx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dT1t-,kvrocks,1565481854,1451,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-05-27T15:10:08Z,2023-05-27T15:10:08Z,"

I have read through the relevant code and have decided to make modifications according to the following rules:

### The files match `types/redis_*.h`

- For the function similar to [`Set#IsMember`](https://github.com/apache/incubator-kvrocks/blob/unstable/src/types/redis_set.h#L36) or [`String#SetNX`](https://github.com/apache/incubator-kvrocks/blob/unstable/src/types/redis_string.h#L47) that `ret` means the flag, I will change it to `int *flag`

- For the function similar to [`Set#Remove`](https://github.com/apache/incubator-kvrocks/blob/unstable/src/types/redis_set.h#L39) that `ret` means the number of removed elements, I will change it to `uint64_t *removed_cnt`

- For the function similar to [`List#Size`](https://github.com/apache/incubator-kvrocks/blob/unstable/src/types/redis_list.h#L36) that `ret` means the size of list, I will change it to `uint64_t *size`

- For the function similar to [`List#Size`](https://github.com/apache/incubator-kvrocks/blob/unstable/src/types/redis_list.h#L36) that `ret` means the size of list, I will change it to `uint64_t *size`

- For the function similar to [`String#IncrBy`](https://github.com/apache/incubator-kvrocks/blob/unstable/src/types/redis_string.h#L50) that `ret` means the new value, I will change it to `int64_t *new_value`

- In cases where `ret` may be negative, I will set the type to `int*`.

### The files match `commands/cmd_*.cc`

I will change the type of `int ret` to the correct type, but I will **not change the variable name** because it represents the return value of the Redis command.

### The test files

I will change the type of `int ret` to the correct type, and I will decide whether to modify the variable name based on the situation.


### All files

I will remove all unnecessary `static_cast` statements.

**I will use `uint64_t`([`Metadata#size`](https://github.com/apache/incubator-kvrocks/blob/unstable/src/storage/redis_metadata.h#L121) type) as the type for length everywhere, instead of the `size_t`.**



Do you think these are acceptable? I would appreciate hearing your thoughts and opinions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dT1t-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dT3eR,kvrocks,1565489041,1451,NA,PragmaTwice,20042607,Twice,,NA,2023-05-27T15:16:27Z,2023-05-27T15:16:27Z,I think you can replace it with `bool` if the return variable is just a boolean value.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dT3eR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dT7q6,kvrocks,1565506234,1451,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-05-27T15:30:44Z,2023-05-27T15:30:44Z,"> I think you can replace it with `bool` if the return variable is just a boolean value.

Thank you for your suggestion. I will do that.



","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dT7q6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5duI66,kvrocks,1572376250,1451,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-01T16:34:50Z,2023-06-01T16:34:50Z,@git-hulk it seems the issue should be closed?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5duI66/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1451,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5duOCP,kvrocks,1572397199,1451,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-01T16:44:23Z,2023-06-01T16:44:23Z,"@infdahai Yes, thanks for your reminder.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5duOCP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1452,https://api.github.com/repos/apache/kvrocks/issues/1452,kvrocks,1718127122,1452,migrate timeout in Go Integration Cases,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-20T10:21:33Z,2023-05-24T00:08:56Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

the ref to CI jobs: https://github.com/infdahai/incubator-kvrocks/actions/runs/5032023303/jobs/9025509337

The change is on https://github.com/infdahai/incubator-kvrocks/compare/fb0e3d4...7a5a2c2. I only run 10  tests in a loop.

### What did you expect to see?

All tests pass， especially the `Migrate_sync_with_(or_without)_all_kinds_of_timeouts` test.

### What did you see instead?

  --- FAIL: TestSlotMigrateSync/MIGRATE_-_Migrate_sync_with_(or_without)_all_kinds_of_timeouts#09 (0.01s)
        slotmigrate_test.go:426: 
            	Error Trace:	/home/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:426
            	Error:      	Not equal: 
            	            	expected: string(""OK"")
            	            	actual  : <nil>(<nil>)
            	Test:       	TestSlotMigrateSync/MIGRATE_-_Migrate_sync_with_(or_without)_all_kinds_of_timeouts#09

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1452/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1452,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwftf,kvrocks,1556216671,1452,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-21T16:14:24Z,2023-05-21T16:14:24Z,"The PR #1418 introduces the test. And it often causes CI failure.
https://github.com/apache/incubator-kvrocks/blob/fb0e3d42031a6e0691c7a736711d0a01d72bdb1a/tests/gocase/integration/slotmigrate/slotmigrate_test.go#L414-L432","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwftf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1454,https://api.github.com/repos/apache/kvrocks/issues/1454,kvrocks,1718501505,1454,Tracking issues: Add supports of all commands from `ZSET`,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-21T13:19:11Z,2024-02-23T08:04:35Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Follow up on #595. More specifically, this issue throws a few tasks to support commands from `ZSET` and you can refer to [zset command](https://redis.io/commands/bzmpop/).



### Solution

We need to complete the following command currently.

- [x] #1490
- [ ] #1494 
- [ ] #1517
- [x] #1468
- [ ] #1506
- [x] #1482
- [x] #1502

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1454/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1454,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwY4F,kvrocks,1556188677,1454,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-21T14:05:01Z,2023-05-21T14:05:01Z,"cool, thanks for driving this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwY4F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1454,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM504Lbp,kvrocks,1960883945,1454,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-02-23T08:04:34Z,2024-02-23T08:04:34Z,"We support all ZSet commands now, close this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM504Lbp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1455,https://api.github.com/repos/apache/kvrocks/issues/1455,kvrocks,1718507218,1455,"If a middle field is missing in kvrocks hmget, it returns nil for all subsequent fields, regardless of their existence.",zevin02,92536645,pt,zevin9427@gmail.com,CLOSED,2023-05-21T13:37:47Z,2023-05-21T14:04:22Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


# Description
When using the hmget function in kvrocks, if a middle field does not exist, all subsequent fields returned by the function are nil

# Version
unstable


# Minimal reproduce step
in kvrocks
![Screenshot from 2023-05-21 21-01-41](https://github.com/apache/incubator-kvrocks/assets/92536645/445736c9-37f4-4fd2-b60a-975edd863798)

# What did you expect to see?
In Redis, it is possible to find subsequent fields even if the middle field is missing, unlike in kvrocks where hmget returns nil for all subsequent fields when a middle field is absent.
![Screenshot from 2023-05-21 21-02-19](https://github.com/apache/incubator-kvrocks/assets/92536645/9238ed93-d50e-4222-b837-18d625df71a2)



### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1455/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1455,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwYix,kvrocks,1556187313,1455,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-21T13:58:58Z,2023-05-21T13:58:58Z,"I can't reproduce this result. I use the unstable branch. 

![image](https://github.com/apache/incubator-kvrocks/assets/30547248/53787574-68b7-427f-911c-99b1cc066b2a)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwYix/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1455,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwY1k,kvrocks,1556188516,1455,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-21T14:04:12Z,2023-05-21T14:04:12Z,I think it may be introduced by your PR: https://github.com/apache/incubator-kvrocks/pull/1453,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwY1k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1456,https://api.github.com/repos/apache/kvrocks/issues/1456,kvrocks,1718508493,1456,"Add the support of the ZDIFF, ZDIFFSTORE commands",infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-21T13:41:04Z,2024-02-23T08:02:44Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support [zdiff](https://redis.io/commands/zdiff/), zdiffstore commands.



### Solution

- [ ] zdiff
- [ ] zdiffstore

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1456/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjujM,kvrocks,1636755660,1456,NA,zevin02,92536645,pt,zevin9427@gmail.com,NA,2023-07-15T12:39:50Z,2023-07-15T12:39:50Z,"Is this issue still ongoing, I think I can do it","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjujM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjzF8,kvrocks,1636774268,1456,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-15T13:48:12Z,2023-07-15T13:48:12Z,"@zevin02 cool, go ahead","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjzF8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1456,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM504K7H,kvrocks,1960881863,1456,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-02-23T08:02:44Z,2024-02-23T08:02:44Z,"Has been done in https://github.com/apache/kvrocks/pull/2021, close.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM504K7H/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1457,https://api.github.com/repos/apache/kvrocks/issues/1457,kvrocks,1718509093,1457,"Add the support of the ZINTER, ZINTERCARD commands",infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-21T13:43:07Z,2024-02-23T08:01:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support [zinter](https://redis.io/commands/zinter/), zintercard commands.

### Solution

- [ ] zinter
- [ ] zintercard

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1457/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1457,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d3G7g,kvrocks,1574727392,1457,NA,IoCing,39056297,IoCing,,NA,2023-06-03T06:55:22Z,2023-06-03T06:55:22Z,i want to do this,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d3G7g/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1457,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d3R-V,kvrocks,1574772629,1457,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-03T08:14:26Z,2023-06-03T08:14:26Z,"@IoCing Assigned, thanks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d3R-V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1457,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM504Knh,kvrocks,1960880609,1457,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-02-23T08:01:32Z,2024-02-23T08:01:32Z,"Has been done in https://github.com/apache/kvrocks/issues/1983, close.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM504Knh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1458,https://api.github.com/repos/apache/kvrocks/issues/1458,kvrocks,1718509450,1458,Add the support of the ZMPOP command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-21T13:44:16Z,2023-05-26T08:10:07Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [zmpop](https://redis.io/commands/zmpop/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1458/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1458,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c6iE8,kvrocks,1558847804,1458,NA,MizukiCry,44625630,Zhihua Zhao,YuukaC@outlook.com,NA,2023-05-23T08:57:30Z,2023-05-23T08:57:30Z,I want to try this:),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c6iE8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1458,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c6mHj,kvrocks,1558864355,1458,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-23T09:06:33Z,2023-05-23T09:06:33Z,"Hi @MizukiCry

Assigned, thanks!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c6mHj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1458,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c6n7Z,kvrocks,1558871769,1458,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-23T09:10:41Z,2023-05-23T09:10:41Z,"> I want to try this:)

You can refer to the simliar functions in `set` and `zpop<max|min>` in `zset`. And if you encounter some difficuities with this, you can build a draft pull request and we discuss there. 🦃 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c6n7Z/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1459,https://api.github.com/repos/apache/kvrocks/issues/1459,kvrocks,1718509914,1459,Add the support of the ZRANDMEMBER command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-21T13:45:45Z,2024-02-23T07:58:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [zrandmember](https://redis.io/commands/zrandmember/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1459/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1459,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM504J0Y,kvrocks,1960877336,1459,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-02-23T07:58:08Z,2024-02-23T07:58:08Z,Duplicate issues https://github.com/apache/kvrocks/issues/1985,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM504J0Y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1460,https://api.github.com/repos/apache/kvrocks/issues/1460,kvrocks,1718511109,1460,Add the support of the ZRANGESTORE command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-21T13:49:41Z,2023-06-05T03:58:00Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [zrangestore](https://redis.io/commands/zrangestore/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1460/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1460,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5djORl,kvrocks,1569514597,1460,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-05-31T05:20:25Z,2023-05-31T05:20:25Z,"Hello, I can do this task. Can I submit a PR!

According to my understanding, I can use `RangeByRank` function to get elements from the src zset, and then use `Add` function to add them to the dst zset.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5djORl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1460,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5djOkJ,kvrocks,1569515785,1460,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-31T05:22:21Z,2023-05-31T05:22:21Z,"@jihuayu assigned,thanks!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5djOkJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1460,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dzrF8,kvrocks,1573826940,1460,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-02T14:25:51Z,2023-06-02T14:25:51Z,"In this command. I used `ZSet#RangeByLex` get members and use `ZSet#Add` add them to new zset.
But `ZSet#Add` need MemberScore(member+score), `ZSet#RangeByLex` only return member.

So I have 3 way to solve it.
1. After I use `ZSet#RangeByLex` get members, use `ZSet#Score` to get it score. It may cost additional performance overhead.
2. Add a new `ZSet#RangeByLex` function that return `MemberScore`. 
3. Change the `ZSet#RangeByLex` function make it return MemberScore. I found we have already get the socre in `ZSet#RangeByLex` function , so return `MemberScore` will not incur additional performance overhead.

I think 3rd is best. Is it OK?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dzrF8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1460,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d3SWg,kvrocks,1574774176,1460,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-03T08:15:40Z,2023-06-03T08:15:40Z,"@jihuayu Yes, the 3rd solution sounds good.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d3SWg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1461,https://api.github.com/repos/apache/kvrocks/issues/1461,kvrocks,1718511435,1461,Add the support of the ZUNION command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-21T13:50:52Z,2023-06-22T01:50:52Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [zunion](https://redis.io/commands/zunion/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1461/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1461,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5epODA,kvrocks,1587863744,1461,NA,uds5501,21087061,Uddeshya Singh,singhuddeshyaofficial@gmail.com,NA,2023-06-12T18:29:51Z,2023-06-12T18:29:51Z,@git-hulk I want to try this,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5epODA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1461,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5epRl2,kvrocks,1587878262,1461,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-12T18:41:18Z,2023-06-12T18:41:18Z,"hi, @uds5501 could you impl the function and refactor the `UnionStore` function passingly? Just move `overwrite` to the outer space like `Set::UnionStore` and `Set::InterStore`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5epRl2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1461,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eru3X,kvrocks,1588522455,1461,NA,uds5501,21087061,Uddeshya Singh,singhuddeshyaofficial@gmail.com,NA,2023-06-13T04:31:01Z,2023-06-13T04:31:01Z,"@infdahai sure, will take a look.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eru3X/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1461,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5erzES,kvrocks,1588539666,1461,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-13T04:47:25Z,2023-06-13T04:47:25Z,"@uds5501 assigned, thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5erzES/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1462,https://api.github.com/repos/apache/kvrocks/issues/1462,kvrocks,1718545798,1462,avoid the implicit conversion from `const char *` to `string` in `Status.h`,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-21T15:37:39Z,2023-05-21T16:07:03Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/apache/incubator-kvrocks/blob/fb0e3d42031a6e0691c7a736711d0a01d72bdb1a/src/common/status.h#L75


https://github.com/apache/incubator-kvrocks/blob/fb0e3d42031a6e0691c7a736711d0a01d72bdb1a/src/common/status.h#L101-L126

Maybe we call the implicit copy currently and the implicit conversion from `const char *` to `string` in `Status.h` can confuse the compiler and the editor because we usually invoke `{NotOK, str(type: const char*)}` as the return String.

### Solution

We can use the `Slice` type to replace the string type of  `msg` and do `Slice(const char*)` funcs by referring to `leveldb`.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1462/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cweah,kvrocks,1556211361,1462,NA,PragmaTwice,20042607,Twice,,NA,2023-05-21T15:46:43Z,2023-05-21T15:46:43Z,"`Slice` is just a **view**, which has no **ownership**.
For example, if we want to concat some string dynamicly, we cannot use `Slice` since it cannot extend lifetime of the object, e.g.
```
string x = to_string(count) + "" apples"";
return Slice(x); // dangling reference!
```

BTW `Slice` is not a well-designed type, instead we have `std::string_view` since c++17.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cweah/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cweb7,kvrocks,1556211451,1462,NA,PragmaTwice,20042607,Twice,,NA,2023-05-21T15:47:10Z,2023-05-21T15:47:10Z,You can close it if no further questions :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cweb7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwetg,kvrocks,1556212576,1462,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-21T15:53:28Z,2023-05-21T15:53:28Z,">string x = to_string(count) + "" apples"";
return Slice(x); // dangling reference!

Something I'm wondering about is that I don't know what happens in kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwetg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwe2s,kvrocks,1556213164,1462,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-21T15:56:55Z,2023-05-21T15:56:55Z,OK，I get it. Should we solve the implicit conversion?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwe2s/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwfMC,kvrocks,1556214530,1462,NA,PragmaTwice,20042607,Twice,,NA,2023-05-21T16:03:54Z,2023-05-21T16:03:54Z,"I think nope. It is by design.

Refer to [the 5th constructor of std::basic_string](https://en.cppreference.com/w/cpp/string/basic_string/basic_string).

BTW `{NotOK, ""something""}` is more intuitive than `{NotOK, string(""something"")}` for me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwfMC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1462,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwfWd,kvrocks,1556215197,1462,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-21T16:06:58Z,2023-05-21T16:06:58Z,"Ok, thanks for your answer.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5cwfWd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1466,https://api.github.com/repos/apache/kvrocks/issues/1466,kvrocks,1719989538,1466,consider to replace system_clock with steady_clock,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-22T16:03:12Z,2023-05-22T17:36:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

A repetitive question about #983.

https://github.com/apache/incubator-kvrocks/blob/635dd311e5d07007826ae5338eae4cefb88ccc55/src/common/time_util.h#L27-L32

[system_clock from cpp ref](https://en.cppreference.com/w/cpp/chrono/system_clock) is a wall clock and [wall clock from cpp ref](https://en.cppreference.com/w/cpp/chrono/steady_clock) is a monotonic clock. 
I find this function is widely used in scenarios related to `ttl`. Maybe the monotonic one is better because the wall clock exists the problem of time adjustment and we only want a precise time interval.

A related discussion from [stackoverflow](https://stackoverflow.com/questions/31552193/difference-between-steady-clock-vs-system-clock).
>As opposed to the system_clock, which is not monotonic (i.e. the time can decrease if, say, the user changes the time on the host machine.)

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1466/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1466,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c1lQM,kvrocks,1557550092,1466,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-05-22T16:38:23Z,2023-05-22T16:38:23Z,"https://github.com/apache/incubator-kvrocks/pull/1038#issuecomment-1289048482

Seems we've talked about it here. I'll be ok if we can ensure `steady_clock` returns an unix epoch.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c1lQM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1466,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c15OX,kvrocks,1557631895,1466,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-22T17:36:37Z,2023-05-22T17:36:37Z,"The more specific dicussion about the clock is placed [here in redis](https://github.com/redis/redis/pull/7644#issue-676476847).

>We need to call ustime() because there is a cached timestamp which matches the wall-clock. This is set at the beginning of every command and is used to support various functions which need this recent wall-clock time.
We also need to time the execution of the current command by measuring time before/after invoking the command. Measuring duration is something that we'd normally perform using the monotonic clock (not wall-clock).
The logic is something like this:
```
set cached_ustime = ustime()   // wall clock

set command_start = getMonotonic()
execute command
set command_duration = getMonotonic() - command_start
```

from https://github.com/redis/redis/pull/10502#issuecomment-1091972167

So we don't need this issue currently in other word.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5c15OX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1469,https://api.github.com/repos/apache/kvrocks/issues/1469,kvrocks,1723178680,1469,Refine functions and add parsing tests to `Set` ,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-24T05:02:49Z,2023-05-26T10:15:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Many commands in the current [`cmd_set`](https://github.com/apache/incubator-kvrocks/blob/b9cfbead58f68aa914bb35360f82c3f8e0ec8c90/src/commands/cmd_set.cc) file miss parsing error tests(It is the same as `zset`.) and misses some necessary checks.

For example, `syntax: SPOP key [count]` from https://redis.io/commands/spop/.
https://github.com/apache/incubator-kvrocks/blob/b9cfbead58f68aa914bb35360f82c3f8e0ec8c90/src/commands/cmd_set.cc#L142-L155


### Solution

we can add the error check `""value is not an integer or out of range""`. And then we add some go tests to match parsing errors. 

You can just add some codes for one class or more classes(in `set` or `zset`).

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1469/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dAsJI,kvrocks,1560461896,1469,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-24T05:03:40Z,2023-05-24T05:03:40Z,Please add a `good first issue` label.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dAsJI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dA6gq,kvrocks,1560520746,1469,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-24T06:23:10Z,2023-05-24T06:23:10Z,"This issue just needs to add `require.ErrorContains()` in go tests. If someone is willing to do this, leave a message here.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dA6gq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dH7IZ,kvrocks,1562358297,1469,NA,zncleon,83486574,Leo,,NA,2023-05-25T06:37:06Z,2023-05-25T06:37:06Z,I'd like to try it,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dH7IZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dH8_y,kvrocks,1562365938,1469,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-25T06:45:19Z,2023-05-25T06:45:19Z,"@zncleon Assigned, go ahead. @infdahai Thanks for taking care of this PR.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dH8_y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dJPGn,kvrocks,1562702247,1469,NA,zncleon,83486574,Leo,,NA,2023-05-25T10:58:20Z,2023-05-25T10:58:20Z,"I have some questions:
1. In redis6.9, if I enter `SPOP myset 3.5` or `SPOP myset -10`, it return `value is out of range, must be positive`, but in kvrocks, it return `value is not a n integer out of range `.It seems that the return in kvrocks is clearer. Should I modify it just like redis or leave it as it is ？  

2. if I enter `SPOP myset 3 4`, the arguments more than 3, kvrocks not return error. I can modify the checks in source code. But I can't test it in go test, for the arguments num of the function `SPopN` is 3. How can I do ?  ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dJPGn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dJQN3,kvrocks,1562706807,1469,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-05-25T11:01:51Z,2023-05-25T11:01:51Z,"> In redis6.9, if I enter ""SPOP myset 3.5"" OR ""SPOP myset -10"", it return ""value is out of range, must be positive"", but in kvrocks, it return ""value is not a n integer out of range "".It seems that the return in kvrocks is clearer. Should I modify it just like redis or leave it as it is ？

Just leave it as it's.

> if I enter ""SPOP myset 3 4"", the arguments more than 3, kvrocks not return error. I can modify the checks in source code. But I can't test it in go test, for the arguments num of the function ""SPopN"" is 3. How can I do ?

You can use `client.Do` to send the raw command.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dJQN3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dJ3h9,kvrocks,1562867837,1469,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-05-25T13:00:32Z,2023-05-25T13:00:32Z,"you can add a go test if you want to compute the commands and add another tests for parsing error msgs.(usually use Do func, because go-redis gives a correct num-key argument in special commands for redis.)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dJ3h9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dJ9F-,kvrocks,1562890622,1469,NA,zncleon,83486574,Leo,,NA,2023-05-25T13:15:22Z,2023-05-25T13:15:22Z,"thx !
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dJ9F-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1472,https://api.github.com/repos/apache/kvrocks/issues/1472,kvrocks,1724388587,1472,Flaky test  TestBitmap,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-05-24T16:41:12Z,2023-05-25T01:57:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

TestBitMap fails in https://github.com/apache/incubator-kvrocks/actions/runs/5070341119/jobs/9105869084?pr=1444

### What did you expect to see?

No error.

### What did you see instead?

```
--- FAIL: TestBitmap (355.95s)
    --- FAIL: TestBitmap/SETBIT/GETBIT/BITCOUNT/BITPOS_boundary_check_(type_bitmap) (22.25s)
        bitmap_test.go:149: 
            	Error Trace:	/Users/runner/work/incubator-kvrocks/incubator-kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:149
            	Error:      	Not equal: 
            	            	expected: 4294967295
            	            	actual  : 0
            	Test:       	TestBitmap/SETBIT/GETBIT/BITCOUNT/BITPOS_boundary_check_(type_bitmap)
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1472/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/1478,kvrocks,1730976735,1478,Allow using S3 to backup the Kvrocks DB,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-05-29T15:57:25Z,2024-05-09T09:39:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Most users demand a backup of the DB dir, but we can only support backup in the local file system. And it may cause trouble if we didn't reserve enough disk space. It would be better if we can put the backup on cloud storage like S3/GCS/...


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1478/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebY7V,kvrocks,1584238293,1478,NA,torwig,8588372,Yaroslav,,NA,2023-06-09T09:11:25Z,2023-06-09T09:11:25Z,@git-hulk Let me try to implement this feature.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebY7V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebaZV,kvrocks,1584244309,1478,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T09:15:29Z,2023-06-09T09:15:29Z,"@torwig Thanks a lot. For this issue, I am not sure if it's good to compress the db into a single object and then upload it. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebaZV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebct0,kvrocks,1584253812,1478,NA,torwig,8588372,Yaroslav,,NA,2023-06-09T09:21:32Z,2023-06-09T09:21:32Z,"@git-hulk Thank you for your tip. I'm going to think about the whole process and suggest something like ""high-level design"" and ""possible implementation(s)"" before actually starting implementing so we can discuss all key things.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebct0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebfLd,kvrocks,1584263901,1478,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-09T09:27:08Z,2023-06-09T09:27:08Z,🆒 Thanks,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ebfLd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5osaqQ,kvrocks,1756474000,1478,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-10-10T23:48:54Z,2023-10-10T23:48:54Z,Hi @torwig are you still working on this issue? If not @git-hulk could I take it up?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5osaqQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5otxKL,kvrocks,1756828299,1478,NA,torwig,8588372,Yaroslav,,NA,2023-10-11T05:22:30Z,2023-10-11T05:22:30Z,"@chrisxu333 Currently, I can't dedicate my time to this issue. If you wish to run it, @git-hulk will reassign it to you.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5otxKL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ot17U,kvrocks,1756847828,1478,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-10-11T05:48:12Z,2023-10-11T05:48:12Z,"Initialize S3/GCS etc would be a bit tricky, maybe opendal C SDK would help: https://github.com/apache/incubator-opendal . It would be also ok for testing in local machine. Other tools in C++ is also welcomed. Since s3 credit config is a bit tricky, I think we'd better use thirdparty library at first.

Also, the dependency would be a bit complex for using object SDK, we'd better make clear what the config would like. You can try to investigate how other system does that:

1. https://tikv.org/docs/6.5/concepts/explore-tikv-features/backup-restore-cn/
2. https://www.cockroachlabs.com/docs/stable/backup","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ot17U/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ot23e,kvrocks,1756851678,1478,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-11T05:53:01Z,2023-10-11T05:53:01Z,"To be honest, I didn't think clearly about whether this feature should be put inside Kvrocks. Perhaps implementing a new dedicated tool for the backup like ClickHouse is a good idea.

Refer: https://github.com/Altinity/clickhouse-backup ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ot23e/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ot3Tz,kvrocks,1756853491,1478,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-10-11T05:55:21Z,2023-10-11T05:55:21Z,"🤔 ClickHouse can read from remote S3, so I think it's able to upload or backup to s3.

However, TiKV only supports a br here. (See: https://tikv.org/docs/6.5/concepts/explore-tikv-features/backup-restore-cn/ ). Maybe we can considering using the sameway. It can also not bring any size amplify to our binary and hide the risk of unmature implemention.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ot3Tz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ot3pe,kvrocks,1756854878,1478,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-11T05:57:04Z,2023-10-11T05:57:04Z,@mapleFU Thanks for your great references!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ot3pe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52eBLB,kvrocks,1987580609,1478,NA,asad-awadia,6923282,Asad Awadia,,NA,2024-03-11T03:38:20Z,2024-03-11T03:38:20Z,">if it's good to compress the db into a single object and then upload it.

Why not?

Create, then compress the backup, and then upload the single file
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52eBLB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM547Z3I,kvrocks,2028838344,1478,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2024-03-31T17:43:28Z,2024-03-31T17:43:28Z,"Encryption of the backup file(s) will be nice too. Right now we are planning to mount the PVC volume in our Kubernetes cluster as a cronjob, make an encrypted archive and upload it to S3.

But yes, the fact that the backup is first generated on the same volume can be problematic (lack of space etc).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM547Z3I/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM548gQK,kvrocks,2029126666,1478,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-01T04:13:06Z,2024-04-01T04:13:06Z,"> But yes, the fact that the backup is first generated on the same volume can be problematic (lack of space etc).

Kvrocks allows changing the backup dir via `config set backup-dir`. And it's now using the rocksdb checkpoint as the backup which will use the hard link when copying files. Perhaps you can remove the backup after syncing to S3?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM548gQK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM556uPu,kvrocks,2045436910,1478,NA,Xuanwo,5351546,Xuanwo,github@xuanwo.io,NA,2024-04-09T15:14:12Z,2024-04-09T15:14:12Z,"Hi, I'm Xuanwo from the [OpenDAL](https://github.com/apache/opendal) communiy. I'm watching on development of kvrocks for sometime and find this issue interesting.

As you may know, OpenDAL offers a unified data access layer, empowering users to seamlessly and efficiently retrieve data from diverse storage services. I feel like opendal will be a good fit for kvrocks to implement backup to/from storage services like s3/gcs/azblob/...

Since kvrocks code base is mainly cpp, there are two ways to integrate with opendal:

- Implement a rust module in kvrocks and expose FFI to exsiting code.
  - benefits: opendal rust core is mature and adopted by many projects
  - shortcome: kvrocks should have rust code inside.
- Integrate opendal-cpp in kvrocks directly.
  - benefits: work with cpp natively.
  - shortcome: opendal-cpp is still under developement
 
---

Sorry for not reading the thread carefully. I found @mapleFU already mentioned opendal.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM556uPu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59Teuf,kvrocks,2102258591,1478,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-09T09:03:56Z,2024-05-09T09:03:56Z,"@Xuanwo Here I think the performance is not the critical reason and we may not enable some advance feature about threading, I think opendal as a backend of RocksDB Env would be a goodway for solving both this and backup to hdfs","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59Teuf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59TjsA,kvrocks,2102278912,1478,NA,Xuanwo,5351546,Xuanwo,github@xuanwo.io,NA,2024-05-09T09:16:47Z,2024-05-09T09:16:47Z,"> opendal as a backend of RocksDB Env

It looks like a good idea. I don't have much understadning of RocksDB Env so I don't know if it's possible with a simple wrapper.

My friend @leiysky told me that rocksdb env requires `append` support which is not widely supported by object storage services (at least s3 doesn't). And even for services that support append, It might be not good for append many small chunks. This could be an issue.

Note: OpenDAL itself does support `append` but s3 doesn't.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59TjsA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59TsDU,kvrocks,2102313172,1478,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-09T09:39:27Z,2024-05-09T09:39:27Z,"After some discussion, maybe design some new syntax and using another thread / process to upload Backup in Local FileSystem to HDFS/S3 is also a way. This avoid the complex logic of intereact with `rocksdb::Env`, and could be done in a separate way","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59TsDU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1480,https://api.github.com/repos/apache/kvrocks/issues/1480,kvrocks,1735883465,1480,process crash when running perflog on macos,singular-seal,108578006,,,CLOSED,2023-06-01T09:33:25Z,2023-06-05T02:47:07Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

OS - macos 13.3.1 (a) 
Kvrocks - 2.4.0

### Minimal reproduce step

1.config set profiling-sample-commands set
2.config set profiling-sample-ratio 100
3.config set profiling-sample-record-threshold-ms 0
4.set a 1

Then the process crashed.

### What did you expect to see?

shows 'OK'

### What did you see instead?

process crashed

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1480/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1480,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5drsUD,kvrocks,1571734787,1480,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-01T09:59:30Z,2023-06-01T09:59:30Z,"Hi @singular-seal 

Can you paste the core stack in logs file?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5drsUD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1480,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dtB4I,kvrocks,1572085256,1480,NA,singular-seal,108578006,,,NA,2023-06-01T13:46:23Z,2023-06-01T13:46:23Z,"E20230601 21:40:46.598451 2739503 main.cc:86] ======= Ooops! kvrocks unstable (commit 4218a2b) got signal: Segmentation fault: 11 (11) =======
E20230601 21:40:46.608981 2739503 main.cc:101] 1   libsystem_platform.dylib            0x00007ff804ee35ed _sigtramp + 29                                                                                                                                                                                                      _sigtramp
E20230601 21:40:46.609074 2739503 main.cc:103] 2   ???                                 0x0000000000003f40 0x0 + 16192
E20230601 21:40:46.609315 2739503 main.cc:101] 3   kvrocks                             0x000000010e5e7cab _ZN5redis10Connection27RecordProfilingSampleIfNeedERKNSt3__112basic_stringIcNS1_11char_traitsIcEENS1_9allocatorIcEEEEy + 203                                                                                        redis::Connection::RecordProfilingSampleIfNeed()
E20230601 21:40:46.609545 2739503 main.cc:101] 4   kvrocks                             0x000000010e5e691a _ZN5redis10Connection15ExecuteCommandsEPNSt3__15dequeINS1_6vectorINS1_12basic_stringIcNS1_11char_traitsIcEENS1_9allocatorIcEEEENS7_IS9_EEEENS7_ISB_EEEE + 3930                                                      redis::Connection::ExecuteCommands()
E20230601 21:40:46.609745 2739503 main.cc:101] 5   kvrocks                             0x000000010e5e56fe _ZN5redis10Connection6OnReadEP11bufferevent + 142                                                                                                                                                                   redis::Connection::OnRead()
E20230601 21:40:46.609944 2739503 main.cc:101] 6   kvrocks                             0x000000010eae9197 bufferevent_run_deferred_callbacks_unlocked + 215                                                                                                                                                                   bufferevent_run_deferred_callbacks_unlocked
E20230601 21:40:46.610144 2739503 main.cc:101] 7   kvrocks                             0x000000010eaf3e47 event_process_active_single_queue + 887                                                                                                                                                                             event_process_active_single_queue
E20230601 21:40:46.610344 2739503 main.cc:101] 8   kvrocks                             0x000000010eaf13ae event_base_loop + 1582                                                                                                                                                                                              event_base_loop
E20230601 21:40:46.610559 2739503 main.cc:101] 9   kvrocks                             0x000000010e60f968 _ZN6Worker3RunENSt3__111__thread_idE + 24                                                                                                                                                                           Worker::Run()
E20230601 21:40:46.610762 2739503 main.cc:101] 10  kvrocks                             0x000000010e61102a _ZNSt3__114__thread_proxyB6v15006INS_5tupleIJNS_10unique_ptrINS_15__thread_structENS_14default_deleteIS3_EEEEZN4util12CreateThreadIZN12WorkerThread5StartEvE3$_1EE8StatusOrINS_6threadEEPKcT_EUlvE_EEEEEPvSJ_ + 74  _ZNSt3__114__thread_proxyB6v15006INS_5tupleIJNS_10unique_ptrINS_15__thread_structENS_14default_deleteIS3_EEEEZN4util12CreateThreadIZN12WorkerThread5StartEvE3$_1EE8StatusOrINS_6threadEEPKcT_EUlvE_EEEEEPvSJ_
E20230601 21:40:46.610807 2739503 main.cc:101] 11  libsystem_pthread.dylib             0x00007ff804eb61d3 _pthread_start + 125                                                                                                                                                                                                _pthread_start
E20230601 21:40:46.610857 2739503 main.cc:101] 12  libsystem_pthread.dylib             0x00007ff804eb1bd3 thread_start + 15                                                                                                                                                                                                   thread_start
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dtB4I/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1480,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dtKV7,kvrocks,1572119931,1480,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-01T14:04:00Z,2023-06-01T14:04:00Z,"@singular-seal Thanks for your feedback, I found the root cause, will fix it soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5dtKV7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1480,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d7zVk,kvrocks,1575957860,1480,NA,singular-seal,108578006,,,NA,2023-06-05T02:47:07Z,2023-06-05T02:47:07Z,"> @singular-seal Thanks for your feedback, I found the root cause, will fix it soon.

Thanks a lot for the quick response.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d7zVk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1483,https://api.github.com/repos/apache/kvrocks/issues/1483,kvrocks,1740421032,1483,ZRANGE with LIMIT and COUNT=0,torwig,8588372,Yaroslav,,CLOSED,2023-06-04T15:02:43Z,2023-06-15T03:13:33Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Version

The latest `unstable`.

### Minimal reproduce step

```
127.0.0.1:6666> zadd zset11 1 a 2 b 3 c 4 d 5 e 6 f 7 g
(integer) 7
127.0.0.1:6666> zrange zset11 0 6 byscore limit 0 0
```


### What did you expect to see?

Redis:

```
127.0.0.1:6379> zadd zset11 1 a 2 b 3 c 4 d 5 e 6 f 7 g
(integer) 7
127.0.0.1:6379> zrange zset11 0 6 byscore limit 0 0
(empty array)
```


### What did you see instead?

Kvrocks:

```
127.0.0.1:6666> zrange zset11 0 6 byscore limit 0 0
1) ""a""
2) ""b""
3) ""c""
4) ""d""
5) ""e""
6) ""f""
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1483/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1483,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d6iBx,kvrocks,1575624817,1483,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-04T16:08:51Z,2023-06-04T16:08:51Z,Let me take a look at this,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d6iBx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1483,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d6iW_,kvrocks,1575626175,1483,NA,torwig,8588372,Yaroslav,,NA,2023-06-04T16:12:35Z,2023-06-04T16:12:35Z,@infdahai Assigned. Thank you.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5d6iW_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1484,https://api.github.com/repos/apache/kvrocks/issues/1484,kvrocks,1742139446,1484,Don't allow to slaveof itself or its replica,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-06-05T16:32:53Z,2023-06-12T11:07:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently, we didn't check if the master is itself or in its replica set, so it may cause a replication loop like the below:

```
127.0.0.1:6666> SLAVEOF 127.0.0.1 6666
OK
127.0.0.1:6666> info replication
# Replication
role:slave
master_host:127.0.0.1
master_port:6666
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:2
slave_repl_offset:0
slave_priority:100
connected_slaves:1
slave0:ip=127.0.0.1,port=6666,offset=0,lag=0
master_repl_offset:0
```



### Solution

Check the master host/port before sending the command.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1484/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1484,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eDqeB,kvrocks,1578018689,1484,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-06-06T06:47:44Z,2023-06-06T06:47:44Z,"@git-hulk  If I use `SLAVEOF 127.0.0.2 6666`, how can it check that the master is itself? Or if I send traffic with IP address 172.20.100.2 to the server where the master is located and use `SLAVEOF 172.20.100.2 6666`, how can it check?

Judging based on the IP address and port is not accurate.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eDqeB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1484,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eDzQ0,kvrocks,1578054708,1484,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-06T07:13:47Z,2023-06-06T07:13:47Z,"@jihuayu Firstly, we don't promise it can recognize all conditions since the traffic device mapping is complex. What we can do is try our best to avoid this condition, so I think the below checks are enough:

- if Kvrocks is listening on address 0.0.0.0, we parse the IP addresses from the device and compare the master host and port
- if Kvrocks is listening on the exact IP address, just compare the IP and Port directly

Can take a look at https://github.com/apache/incubator-kvrocks/blob/7554a0dc3e0735d7968a5126cc81e060ff1a441b/src/common/io_util.cc#L317

@uds5501 has taken this issue in the Slack channel.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eDzQ0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1484,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eKePu,kvrocks,1579803630,1484,NA,zevin02,92536645,pt,zevin9427@gmail.com,NA,2023-06-07T03:08:57Z,2023-06-07T03:08:57Z,I think I can do it,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eKePu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1484,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eKe3b,kvrocks,1579806171,1484,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-07T03:12:32Z,2023-06-07T03:12:32Z,"Hi @zevin02

Thanks for your attention.

@uds5001 has already taken this in community slack channel, will ping back if he has no time to do that.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eKe3b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1484,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eKpav,kvrocks,1579849391,1484,NA,uds5501,21087061,Uddeshya Singh,singhuddeshyaofficial@gmail.com,NA,2023-06-07T04:04:59Z,2023-06-07T04:04:59Z,"I am working on it, should be able to raise an MR in a couple of days.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eKpav/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1484,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eKps-,kvrocks,1579850558,1484,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-07T04:06:48Z,2023-06-07T04:06:48Z,"> I am working on it, should be able to raise an MR in a couple of days.

Thanks for your efforts. No hurry, can do it while you're free.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5eKps-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1495,https://api.github.com/repos/apache/kvrocks/issues/1495,kvrocks,1754707596,1495,[proposal] Reduce the block cache configurations into a single one,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-06-13T11:53:31Z,2023-07-09T07:12:42Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Historically, we have three configurations to control the block cache behavior:

- [rocksdb.metadata_block_cache_size](https://github.com/apache/incubator-kvrocks/blob/unstable/kvrocks.conf#LL530C1-L530C34) which will determine the block cache size of the metadata column family
- [rocksdb.subkey_block_cache_size](https://github.com/apache/incubator-kvrocks/blob/unstable/kvrocks.conf#LL535C1-L535C32) which will determine the block cache size of other column families
- [rocksdb.share_metadata_and_subkey_block_cache](https://github.com/apache/incubator-kvrocks/blob/unstable/kvrocks.conf#L542) which is used to determine whether to share the same block cache between column families.

But most users don't understand why we need to configure two block cache sizes without investigating the implementation. And it also didn't make sense to separate them since the user data may be changed as time elapsed.

### Solution

We can reduce them into a single one like `rocksdb.block_cache_size` and deprecate old configurations, and also remove them from the kvrocks.conf.

1. If the `rocksdb.block_cache_size` was set, then use it as the block cache and ignore old configurations.

2. If the `rocksdb.block_cache_size` was NOT and `rocksdb.share_metadata_and_subkey_block_cache` was enabled, then calculate the `rocksdb.block_cache_size` from `rocksdb.metadata_block_cache_size` and `rocksdb.share_metadata_and_subkey_block_cache`

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1495/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1495,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5euIyg,kvrocks,1589152928,1495,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-13T11:54:21Z,2023-06-13T11:54:21Z,@ShooterIT @PragmaTwice @torwig @caipengbo How do you think about this proposal?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5euIyg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1495,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5euKb4,kvrocks,1589159672,1495,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-06-13T11:58:42Z,2023-06-13T11:58:42Z,I think this is a good proposal. It's more user friendly.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5euKb4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1495,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fINGJ,kvrocks,1595986313,1495,NA,Yangsx-1,85615957,Hauru,,NA,2023-06-18T06:32:21Z,2023-06-18T06:32:21Z,Can you assign this task to me? @git-hulk ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fINGJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1495,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fIULu,kvrocks,1596015342,1495,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-18T07:52:43Z,2023-06-18T07:52:43Z,"Sure, thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fIULu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1497,https://api.github.com/repos/apache/kvrocks/issues/1497,kvrocks,1760646391,1497,Print warning messages for invalid config options,PragmaTwice,20042607,Twice,,CLOSED,2023-06-16T13:30:23Z,2023-06-26T23:38:57Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

Currently kvrocks just ignore these invalid config options, like nonexistent config keys, e.g.
```
# kvrocks config file
some-config-key-do-not-exist value
```

No warning or error message is printed, which makes configration debug harder.

We want to print some warning messages (rather than a fatal error for compatibility) when facing inexistent keys.


### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1497/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1500,https://api.github.com/repos/apache/kvrocks/issues/1500,kvrocks,1761069670,1500,Add support of RedisBloom,PragmaTwice,20042607,Twice,,CLOSED,2023-06-16T17:52:52Z,2023-09-01T02:09:33Z,"This issue is part of a project from the Open Source Promotion Plan (OSPP, https://summer-ospp.ac.cn/org/prodetail/239430147), which intent to port BloomFilter and Cuckoo Filter to kvrocks, like RedisBloom(https://redis.io/docs/stack/bloom/).

Deliverables:
- The code and testing for BloomFilter and Cuckoo Filter implementions
- Performance benchmark for them

cc @mapleFU ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1500/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1500,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gWJC7,kvrocks,1616416955,1500,NA,zncleon,83486574,Leo,,NA,2023-07-02T07:12:19Z,2023-07-02T07:12:19Z,"Thanks to the mentor and community for choosing me to complete this task. I will complete this task through the following plan:

**BloomFilter**

- [x] Design and coding of `Bloomfilter_metadata` (ETC. 07/07)

Coding of Commands parse and execution:

- [x] `BF.ADD`, `BF.MADD` Command (ETC. 07/14)

- [x] `BF.EXISTS`, `BF.MEXISTS` command (ETC. 07/21)

- [x] `BF.INSERT`command (ETC. 07/28)

- [x] `BF.Reserve`, `BF.CARD` command (ETC. 07/28)

---

**CuckooFilter**

- [ ] Design and coding of `CuckooFilter_metadata` (ETC. 08/04)

Coding of Commands parse and execution:

- [ ] `CF.ADD`, `CF.ADDNX` command (ETC. 08/11)

- [ ] `CF.EXISTS`, `CF.MEXISTS` command (ETC. 08/18)

- [ ] `CF.DEL` command (ETC. 08/25)

- [ ] `CF.INSERT`, `CF.INSERTNX` command (ETC. 08/25)

- [ ] `CF.Reserve`, `CF.COUNT`, `CF.INFO` command (ETC. 08/30)

---

- [ ] Performance testing (ETC. 09/10)

Complete the coding of test cases while coding various parts of the code","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gWJC7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1500,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gsMmt,kvrocks,1622198701,1500,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-07-05T17:37:16Z,2023-07-05T17:37:16Z,Good luck for you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gsMmt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1500,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ix90d,kvrocks,1657265437,1500,NA,PragmaTwice,20042607,Twice,,NA,2023-07-30T20:59:13Z,2023-07-30T20:59:13Z,"Hello, I am very excited to see you starting work on this project!

For an open community and for better progress, we suggest that you make your current work-in-progress code public on GitHub through a draft PR or other means. 
Of course, there is no need to worry about sharing unfinished code as the review process will only begin when you are fully prepared. 
Additionally, we recommend breaking down your code into multiple PRs and gradually submitting them to the community instead of including all project code in one PR. 

If you encounter any issues, feel free to post an issue, start a discussion, ask questions on Slack, or directly contact @mapleFU.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ix90d/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1500,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lcqyS,kvrocks,1702014098,1500,NA,PragmaTwice,20042607,Twice,,NA,2023-09-01T02:09:33Z,2023-09-01T02:09:33Z,inherited by #1696,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lcqyS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1501,https://api.github.com/repos/apache/kvrocks/issues/1501,kvrocks,1761077838,1501,Add the support of TLS in replication,PragmaTwice,20042607,Twice,,CLOSED,2023-06-16T17:58:43Z,2023-09-12T04:42:29Z,"Currently we support TLS for server-client connections, but replication in kvrocks does not support TLS yet.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1501/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1503,https://api.github.com/repos/apache/kvrocks/issues/1503,kvrocks,1761676040,1503,Convert the timeout parameter from an integer to a double value,Yangsx-1,85615957,Hauru,,CLOSED,2023-06-17T06:41:38Z,2023-06-27T11:19:14Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

In redis, the timeout parameter of commands like [BLPOP](https://redis.io/commands/blpop/) is a double value, but in kvrocks, the parameter must be an integer.

### Solution

We can change `parseint` in the Parse function into `parsefloat`.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1503/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1503,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHKHC,kvrocks,1595711938,1503,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-17T11:17:35Z,2023-06-17T11:17:35Z,"Hi @Yangsx-1

Many thanks for your feedback. It should be a mistake in the Redis document, the timeout in the BLPOP is an integer indeed: https://github.com/redis/redis/blob/b00a2351865bb1d87e2d2701b77c8a68daefb054/src/t_list.c#L1218","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHKHC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1503,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHLRS,kvrocks,1595716690,1503,NA,Yangsx-1,85615957,Hauru,,NA,2023-06-17T11:25:34Z,2023-06-17T11:25:34Z,"> Hi @Yangsx-1
> 
> Many thanks for your feedback. It should be a mistake in the Redis document, the timeout in the BLPOP is an integer indeed: https://github.com/redis/redis/blob/b00a2351865bb1d87e2d2701b77c8a68daefb054/src/t_list.c#L1218

![1687001044238](https://github.com/apache/incubator-kvrocks/assets/85615957/72e11ebc-5acd-418e-bd9c-b90d811e1db4)
But i tested it locally, timeout can be floating-point number?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHLRS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1503,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHLj2,kvrocks,1595717878,1503,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-17T11:29:06Z,2023-06-17T11:29:06Z,"> > Hi @Yangsx-1
> > Many thanks for your feedback. It should be a mistake in the Redis document, the timeout in the BLPOP is an integer indeed: https://github.com/redis/redis/blob/b00a2351865bb1d87e2d2701b77c8a68daefb054/src/t_list.c#L1218
> 
> ![1687001044238](https://user-images.githubusercontent.com/85615957/246604544-72e11ebc-5acd-418e-bd9c-b90d811e1db4.png) But i tested it locally, timeout can be floating-point number?

oh, good. You're right that Redis will parse it as a double when the unit is a second:https://github.com/redis/redis/blob/b00a2351865bb1d87e2d2701b77c8a68daefb054/src/timeout.c#L171. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHLj2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1503,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHLrd,kvrocks,1595718365,1503,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-17T11:32:04Z,2023-06-17T11:32:04Z,"@Yangsx-1 assigned, thanks for your good catch.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fHLrd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1509,https://api.github.com/repos/apache/kvrocks/issues/1509,kvrocks,1768823659,1509,Transferring resources out of the Incubator after graduation,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-06-22T02:31:10Z,2023-06-23T11:58:10Z,"The vote for Kvrocks to graduate as a Top Level Project has been passed[1] and also established in the board meeting(2020-06-21). So we would like to transfer resources out of the incubator according to [Transferring Resources out of the Incubator](https://incubator.apache.org/guides/transferring.html) and this issue is used to track the checklist:

**Update the Incubator status records**
  - [x] Update the podling status page. All sections should now be filled in including EXIT. (Owner: @git-hulk)

**Source**
  - [x] Git repositories will be renamed to drop the incubator- prefix, please ensure that developers change their remotes. After you’ve created the TLP request, request the rename.(Owner: @git-hulk) - https://issues.apache.org/jira/browse/INFRA-24718
  - [x] SVN repositories will be moved from the incubator to other locations, if you need the move done please raise an infra ticket after the TLP Parent Request.(Owner: @git-hulk) - https://issues.apache.org/jira/browse/INFRA-24718
  - [x] Post an announcement to the development list telling everyone that the repository is about to be moved

**Websites**
- [x] If you have any fully qualified links to your podling.incubator.apache.org on your website change them

**Distribution mirrors**
- [x] Dist area (dist.apache.org) release/${project} and dev/${project} folders can be created by PMC members.
  - Do not forget to copy KEYS file from release/incubator/${project} location.
  - You have two major options then:
    - you can keep incubating released artifacts at release/incubator/${project} and remove artifacts once your TLP project does their first release.
    - you can move the last incubating released artifacts to your release/${project}, taking care that incubating stay in path (you will need to change website and mail for the new location)

**Final Revision of Podling Incubation Records**
- [x] Update the svn incubator/trunk/content/projects/${project}.xml file to show the project’s status. (Owner: @git-hulk)
- [x] Update the podling summary metadata file, incubator/trunk/content/podlings.xml svn file. (Owner: @git-hulk)
- [x] After your project has finished reporting to the Incubator, then remove the ""reporting"" element from that podlings.xml file.(Owner: @git-hulk)
- [x] Ensure that other svn resources for your project have moved to your new home.
- [x] Review this whole graduation guide.

[1] https://lists.apache.org/thread/hbl8fsy5pw0k2k6prx62r1v1r7n9psjr","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1509/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1509,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fe_zl,kvrocks,1601961189,1509,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-06-22T03:23:25Z,2023-06-22T03:23:25Z,@git-hulk could you link to the board resolution about the graduation so that it's transparent a resolution?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fe_zl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1509,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ffA5J,kvrocks,1601965641,1509,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-22T03:32:23Z,2023-06-22T03:32:23Z,"> @git-hulk could you link to the board resolution about the graduation so that it's transparent a resolution?

@tisonkun I only received the new role change notification: https://lists.apache.org/thread/ktlqnzl85mtvyyk8bw26f3rq0nl66pb2 for now, it contains the transfer resources guide.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ffA5J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1509,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fndVL,kvrocks,1604179275,1509,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-23T11:58:10Z,2023-06-23T11:58:10Z,"Resources are transferred out of the incubator according to the guide. Will close this issue, can help to review and correct while you’re free. @PragmaTwice @tisonkun @torwig ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fndVL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1510,https://api.github.com/repos/apache/kvrocks/issues/1510,kvrocks,1769185960,1510,Add the support of the HRANDFIELD comand,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-22T08:18:21Z,2023-09-28T08:06:45Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [hrandfield](https://redis.io/commands/hrandfield/) command.

After this, we will support all the commands in the hash type from redis.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1510/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1510,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ff-Aa,kvrocks,1602215962,1510,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-22T08:19:02Z,2023-06-22T08:19:02Z,Please add a good-first-issue label.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ff-Aa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1510,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f1jTQ,kvrocks,1607873744,1510,NA,zevin02,92536645,pt,zevin9427@gmail.com,NA,2023-06-26T17:01:47Z,2023-06-26T17:01:47Z,please assign to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f1jTQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1510,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f14Rf,kvrocks,1607959647,1510,NA,torwig,8588372,Yaroslav,,NA,2023-06-26T17:57:47Z,2023-06-26T17:57:47Z,@zevin02 Done. Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f14Rf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1511,https://api.github.com/repos/apache/kvrocks/issues/1511,kvrocks,1769190484,1511,"Add the support of the GEOSEARCH, GEOSEARCHSTORE comands ",infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-22T08:21:22Z,2023-07-24T07:12:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support [geosearch](https://redis.io/commands/geosearch/), [geosearchstore](https://redis.io/commands/geosearchstore/) commands.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1511/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1511,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fruK4,kvrocks,1605296824,1511,NA,uds5501,21087061,Uddeshya Singh,singhuddeshyaofficial@gmail.com,NA,2023-06-24T07:23:00Z,2023-06-24T07:23:00Z,I can help with this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fruK4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1511,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fru-0,kvrocks,1605300148,1511,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-24T07:43:45Z,2023-06-24T07:43:45Z,"@uds5501 assigned, thanks for your interest.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fru-0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1511,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f1YRB,kvrocks,1607828545,1511,NA,uds5501,21087061,Uddeshya Singh,singhuddeshyaofficial@gmail.com,NA,2023-06-26T16:30:43Z,2023-06-26T16:30:43Z,"@git-hulk / @infdahai does this command require a `BYBOX` as well? (Found it in the redis doc : https://redis.io/commands/geosearch/)
If yes, I wanted to understand how does the bounding box look like? Not able to visualize it just via this description:

**BYBOX: Search inside an axis-aligned rectangle, determined by <height> and <width>.**

edit : Wanted a confirmation, is the bounding box like this - https://www.memurai.com/blog/geospatial-queries-in-redis","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f1YRB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1511,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f9cKo,kvrocks,1609941672,1511,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-27T17:27:48Z,2023-06-27T17:27:48Z,"@uds5501 I think the blog is right. BTW, you can read this picture from the origin design https://github.com/redis/redis/issues/8094#issuecomment-739640315 . I think it's direct.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f9cKo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1512,https://api.github.com/repos/apache/kvrocks/issues/1512,kvrocks,1769202505,1512,Tracking issues: add the support of all missing commands in the list type,infdahai,30547248,clundro,infdahai@outlook.com,OPEN,2023-06-22T08:29:21Z,2024-01-17T07:41:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/incubator-kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the `blmove`, `blmpop`, `brpoplpush`, `lmpop`, `lpos` commands.

### Solution

- [x] #1521
- [x] #1522
- [ ] #1523
- [x] #1526
- [x] #1528


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1512/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fyKx-,kvrocks,1606986878,1512,NA,IoCing,39056297,IoCing,,NA,2023-06-26T08:42:21Z,2023-06-26T08:42:21Z,i can do this,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5fyKx-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f56_A,kvrocks,1609019328,1512,NA,PragmaTwice,20042607,Twice,,NA,2023-06-27T08:16:29Z,2023-06-27T08:16:29Z,It will be better if you can open an issue for every command you mention here.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f56_A/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f6En1,kvrocks,1609058805,1512,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-27T08:44:13Z,2023-06-27T08:44:13Z,"> It will be better if you can open an issue for every command you mention here.

OK, I will open some issues in the evening.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f6En1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8JbP,kvrocks,1609602767,1512,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-27T14:18:04Z,2023-06-27T14:18:04Z,"Hi @IoCing, you can select specific commands if you want.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8JbP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8L2f,kvrocks,1609612703,1512,NA,torwig,8588372,Yaroslav,,NA,2023-06-27T14:22:47Z,2023-06-27T14:22:47Z,"@infdahai Please have a look, I see that the `LLEN`, `LINSERT`, `LPOP`, `RPUSH` are also supported. The formatting in the file is a little weird.
![image](https://github.com/apache/kvrocks/assets/8588372/471a2bc5-4ca2-4dc1-a2c4-8416d59c159b)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8L2f/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8NN7,kvrocks,1609618299,1512,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-27T14:25:41Z,2023-06-27T14:25:41Z,"> @infdahai Please have a look, I see that the `LLEN`, `LINSERT`, `LPOP`, `RPUSH` are also supported. The formatting in the file is a little weird. ![image](https://user-images.githubusercontent.com/8588372/249183594-471a2bc5-4ca2-4dc1-a2c4-8416d59c159b.png)

OK, I'm sorry for this. My window wasn't big enough, so I didn't notice the layout. I update this issue now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8NN7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8Onb,kvrocks,1609624027,1512,NA,torwig,8588372,Yaroslav,,NA,2023-06-27T14:27:54Z,2023-06-27T14:27:54Z,"@infdahai And you can edit this source file to list each command on a separate line, introducing a small PR.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8Onb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8Wb_,kvrocks,1609656063,1512,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-27T14:46:01Z,2023-06-27T14:46:01Z,"> @infdahai And you can edit this source file to list each command on a separate line, introducing a small PR.

I get it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8Wb_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1520,https://api.github.com/repos/apache/kvrocks/issues/1520,kvrocks,1776552591,1520,add the skip points for KeyRange,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T10:05:00Z,2023-07-09T04:12:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Do we need to add a position to ignore the numkey integer because we only support a consistent range? For example, we add a wrong key currently in the `watch` command in [zdiffstore](https://redis.io/commands/zdiffstore/) and [zinterstore](https://redis.io/commands/zinterstore/).

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1520/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f6l8_,kvrocks,1609195327,1520,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-27T10:05:41Z,2023-06-27T10:05:41Z,@PragmaTwice do you think it is necessary?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f6l8_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEGed,kvrocks,1611687837,1520,NA,torwig,8588372,Yaroslav,,NA,2023-06-28T15:52:46Z,2023-06-28T15:52:46Z,@infdahai Could you please elaborate on this?  It's not clear to me from the `Motivation` part what issue you want to solve and what solution/solutions you consider/offer.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEGed/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEYwA,kvrocks,1611762688,1520,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-28T16:46:21Z,2023-06-28T16:46:21Z,I see the function iterates over `range.key_step`. And it will find the argument[i] to exec the watching.  https://github.com/apache/kvrocks/blob/8539ee50c7ed74dfd35a396d138efbc8bde65542/src/server/server.cc#L1659-L1670,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEYwA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEZ-a,kvrocks,1611767706,1520,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-28T16:50:27Z,2023-06-28T16:50:27Z,"The unnecssary numkey will be added into the finding. I think it's innocuous because the numkey shouldn't exist in watched_key_map_.

I'll turn this off if you don't think it's necessary","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEZ-a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gfTI4,kvrocks,1618817592,1520,NA,PragmaTwice,20042607,Twice,,NA,2023-07-03T16:17:35Z,2023-07-03T16:17:35Z,"The current key range design is divided to two methods:
- a *static* constant [start, end, step] if the key range can be determined without actual commands, e.g. `GET key`
- a *dynamic* [start, end, step] according to actual commands, e.g. `opname numkeys key... someflag`

To generalize the key range design to a more pervasive form, I think we can add the third method:
- a *static* constant [start, end, step] if the key range can be determined without actual commands, e.g. `GET key` -> [1,1,1]
- a *dynamic* [start, end, step] according to actual commands, e.g. `opname numkeys key... someflag` -> [2, 1+numkeys,1]
- a *dynamic* key position vector according to actual commands, e.g. `opname numkeys1 key1... someflags... numkeys2 key2... someflag` -> {2,3,...,1+numkeys1,4+numkeys1,...}

For the *skip points* idea, I think it seems not as straightforward as just a key position vector.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gfTI4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gl_Te,kvrocks,1620571358,1520,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-07-04T17:36:01Z,2023-07-04T17:36:01Z,"BTW, do we use the vector to store `CommandKeyRange`? like this `{{2,1+numkeys,1},{4+numkeys,-1,1}}`

I think it will show well.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gl_Te/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gopmV,kvrocks,1621268885,1520,NA,PragmaTwice,20042607,Twice,,NA,2023-07-05T08:19:53Z,2023-07-05T08:19:53Z,"> BTW, do we use the vector to store `CommandKeyRange`? like this `{{2,1+numkeys,1},{4+numkeys,-1,1}}`
> 
> I think it will show well.

Looks fine to me.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gopmV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1521,https://api.github.com/repos/apache/kvrocks/issues/1521,kvrocks,1777063469,1521,Add the support of the BLMOVE command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T14:04:02Z,2023-07-16T07:09:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [blmove](https://redis.io/commands/blmove/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1521/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1521,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gD5Kd,kvrocks,1611633309,1521,NA,Yangsx-1,85615957,Hauru,,NA,2023-06-28T15:16:40Z,2023-06-28T15:16:40Z,I can do this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gD5Kd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1521,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEFkn,kvrocks,1611684135,1521,NA,torwig,8588372,Yaroslav,,NA,2023-06-28T15:50:04Z,2023-06-28T15:50:04Z,@Yangsx-1 Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEFkn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1522,https://api.github.com/repos/apache/kvrocks/issues/1522,kvrocks,1777069334,1522,Add the support of the BLMPOP command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T14:06:42Z,2023-09-22T12:46:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [blmpop](https://redis.io/commands/blmpop/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1522/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1522,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gD6oq,kvrocks,1611639338,1522,NA,Yangsx-1,85615957,Hauru,,NA,2023-06-28T15:20:42Z,2023-06-28T15:20:42Z,Is it better to implement together with LMPOP？They are very similar.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gD6oq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1522,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEqd2,kvrocks,1611835254,1522,NA,xonx4l,119700621,xonx,,NA,2023-06-28T17:43:59Z,2023-06-28T17:43:59Z,"i got a pr for it . https://github.com/PointCloudLibrary/pcl/pull/5754.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gEqd2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1522,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hW72F,kvrocks,1633402245,1522,NA,zevin02,92536645,pt,zevin9427@gmail.com,NA,2023-07-13T01:24:34Z,2023-07-13T01:24:34Z,please assign to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hW72F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1522,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l5zAZ,kvrocks,1709649945,1522,NA,HolyLow,22865114,,,NA,2023-09-07T07:51:25Z,2023-09-07T07:51:25Z,"@git-hulk Hello, I've just finished the LMPOP command, and seems this BLMPOP command is quite similar (just adding the Blocking semantic), so maybe you could assign this one to me as well.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l5zAZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1522,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l5zTf,kvrocks,1709651167,1522,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-07T07:52:21Z,2023-09-07T07:52:21Z,"@HolyLow Sure, thanks for your contribution.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l5zTf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1522,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l51hC,kvrocks,1709660226,1522,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-07T07:59:04Z,2023-09-07T07:59:04Z,"@PragmaTwice @torwig We have many blocking commands, so we copy the blocking implementation codes in many places, not sure if we can simplify this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l51hC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1523,https://api.github.com/repos/apache/kvrocks/issues/1523,kvrocks,1777075957,1523,Add the support of the BRPOPLPUSH command(deprecated),infdahai,30547248,clundro,infdahai@outlook.com,OPEN,2023-06-27T14:09:43Z,2023-08-21T09:55:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [brpoplpush](https://redis.io/commands/brpoplpush/) command.

According to the doc from `redis`, the command is deprecated since version 6.2.0.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1523/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1523,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8F2J,kvrocks,1609588105,1523,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-27T14:10:04Z,2023-06-27T14:10:04Z,Maybe we don't support this command.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8F2J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1523,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gD5_L,kvrocks,1611636683,1523,NA,IoCing,39056297,IoCing,,NA,2023-06-28T15:18:54Z,2023-06-28T15:18:54Z,I want to do this,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gD5_L/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1523,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gD_KS,kvrocks,1611657874,1523,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-28T15:32:53Z,2023-06-28T15:32:53Z,"@IoCing Assigned, thanks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gD_KS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1523,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kfml0,kvrocks,1686006132,1523,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-08-21T09:47:39Z,2023-08-21T09:47:39Z,"@IoCing are you still working on it? if not, i would like to take it over","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kfml0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1523,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kfptk,kvrocks,1686018916,1523,NA,IoCing,39056297,IoCing,,NA,2023-08-21T09:55:50Z,2023-08-21T09:55:50Z,"Sorry, I'm a little busy recently, I will finish it as soon as possible @enjoy-binbin ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kfptk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1524,https://api.github.com/repos/apache/kvrocks/issues/1524,kvrocks,1777079716,1524,Add the support of the LINSERT command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T14:11:22Z,2023-06-27T14:27:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [linsert](https://redis.io/commands/linsert/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1524/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1525,https://api.github.com/repos/apache/kvrocks/issues/1525,kvrocks,1777082443,1525,Add the support of the LLEN command ,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T14:12:19Z,2023-06-27T14:27:07Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [llen](https://redis.io/commands/llen/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1525/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1526,https://api.github.com/repos/apache/kvrocks/issues/1526,kvrocks,1777084702,1526,Add the support of the LMPOP command ,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T14:13:20Z,2023-09-06T14:44:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [lmpop](https://redis.io/commands/lmpop/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1526/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gCvFB,kvrocks,1611329857,1526,NA,HolyLow,22865114,,,NA,2023-06-28T12:41:26Z,2023-06-28T12:41:26Z,"Hi, new guy here! I am willing to see how I could help on this issue. Please assign it to me if no others is working on this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gCvFB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gDFz5,kvrocks,1611422969,1526,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-06-28T13:32:50Z,2023-06-28T13:32:50Z,"Hi @HolyLow, thanks for your interests, assigned","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gDFz5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kgY9r,kvrocks,1686212459,1526,NA,JoverZhang,38241684,Jover,joverzh@gmail.com,NA,2023-08-21T12:11:15Z,2023-08-21T12:11:15Z,Hi @HolyLow. Are you working on this issue? If not can I take it over?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kgY9r/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lBbLI,kvrocks,1694872264,1526,NA,HolyLow,22865114,,,NA,2023-08-28T01:43:47Z,2023-08-28T01:43:47Z,"@JoverZhang Hi, sorry for the reply delay, I am working on this issue already, and hopefully would propose the first version this week.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lBbLI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lmN7F,kvrocks,1704517317,1526,NA,HolyLow,22865114,,,NA,2023-09-04T02:12:57Z,2023-09-04T02:12:57Z,"@git-hulk hi, I've opened a [PR](https://github.com/apache/kvrocks/pull/1737), but currently the (gocase) test cases are not added yet, as I am still trying to figure out how to launch the test case (in GoLand IDE, or from the x.py script...)

Any refer link on how to run the go test cases would be greatly appreciated.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lmN7F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lmOOi,kvrocks,1704518562,1526,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-04T02:15:01Z,2023-09-04T02:15:01Z,Thank you! Can use Goland to run and debug test cases.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lmOOi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lmToz,kvrocks,1704540723,1526,NA,PragmaTwice,20042607,Twice,,NA,2023-09-04T02:55:39Z,2023-09-04T02:55:39Z,"> Any refer link on how to run the go test cases would be greatly appreciated.

Please refer to https://kvrocks.apache.org/community/contributing .","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lmToz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1527,https://api.github.com/repos/apache/kvrocks/issues/1527,kvrocks,1777087322,1527,Add the support of the LPOP command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T14:14:32Z,2023-06-27T14:26:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [lpop](https://redis.io/commands/lpop/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1527/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1528,https://api.github.com/repos/apache/kvrocks/issues/1528,kvrocks,1777089779,1528,Add the support of the LPOS command ,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T14:15:27Z,2023-08-19T12:42:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [lpos](https://redis.io/commands/lpos/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1528/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1528,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f9JXX,kvrocks,1609864663,1528,NA,JackTan25,60096118,JackTan25,,NA,2023-06-27T16:31:33Z,2023-06-27T16:31:33Z,please assign me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f9JXX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1528,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f9JvY,kvrocks,1609866200,1528,NA,torwig,8588372,Yaroslav,,NA,2023-06-27T16:32:36Z,2023-06-27T16:32:36Z,@JackTan25 Done. Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f9JvY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1529,https://api.github.com/repos/apache/kvrocks/issues/1529,kvrocks,1777091202,1529,Add the support of the LRANGE command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T14:16:08Z,2023-06-27T14:20:35Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [lrange](https://redis.io/commands/lrange/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1529/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1529,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8KGZ,kvrocks,1609605529,1529,NA,torwig,8588372,Yaroslav,,NA,2023-06-27T14:19:13Z,2023-06-27T14:19:13Z,"@infdahai If I'm not mistaken, Kvrocks supports the `LRANGE` command.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8KGZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1529,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8KsZ,kvrocks,1609607961,1529,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-06-27T14:20:35Z,2023-06-27T14:20:35Z,You are right. I close this issue now.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5f8KsZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1530,https://api.github.com/repos/apache/kvrocks/issues/1530,kvrocks,1777092639,1530,Add the support of the RPUSH command,infdahai,30547248,clundro,infdahai@outlook.com,CLOSED,2023-06-27T14:16:50Z,2023-06-27T14:27:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [rpush](https://redis.io/commands/rpush/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1530/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1535,https://api.github.com/repos/apache/kvrocks/issues/1535,kvrocks,1783161637,1535,GetMetaData() returns wrong status,xumingbo,21134467,Bo Xu,,CLOSED,2023-06-30T20:59:31Z,2023-11-27T12:46:05Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks 2.2.0.

### Minimal reproduce step

Line 51 of storage/redis_db.cc
GetMetaData() returns ""NotFound"" when expired.

  if (metadata->Expired()) {
    metadata->Decode(old_metadata);
    return rocksdb::Status::**NotFound**(kErrMsgKeyExpired);
  }

### What did you expect to see?

  if (metadata->Expired()) {
    metadata->Decode(old_metadata);
    return rocksdb::Status::**Expired**(kErrMsgKeyExpired);
  }


### What did you see instead?

I tried to fix it by changing ""NotFound"" to ""Expired"", it caused:
  cppunit/t_hash_test.cc:69: Failure, and coredump


### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1535/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gTiDN,kvrocks,1615732941,1535,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-01T08:52:15Z,2023-07-01T08:52:15Z,"Hi @xumingbo 

Could you provide the core dump stack or where's crash location is? And for the expiration metadata, I think it's good to regard it as the not found error since we don't need to know if it's an expired key or not found key","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gTiDN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gT3pA,kvrocks,1615821376,1535,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-07-01T10:00:13Z,2023-07-01T10:00:13Z,"I wonder why it's neccessary to change it to `rocksdb::Status::Expired`, is it related to any handling logic outside?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gT3pA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gUnwO,kvrocks,1616018446,1535,NA,xumingbo,21134467,Bo Xu,,NA,2023-07-01T17:49:33Z,2023-07-01T17:49:33Z,"```
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x00007fc92c691ad3 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0
[Current thread is 1 (Thread 0x7fc92aa7f700 (LWP 3235))]
(gdb) where
#0  0x00007fc92c691ad3 in pthread_cond_wait@@GLIBC_2.3.2 () from /lib/x86_64-linux-gnu/libpthread.so.0
#1  0x00007fc92c3b292c in std::condition_variable::wait(std::unique_lock<std::mutex>&) ()
   from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#2  0x000055aae810df7d in rocksdb::ThreadPoolImpl::Impl::BGThread (this=this@entry=0x7fc92b441300, 
    thread_id=thread_id@entry=0) at util/threadpool_imp.cc:194
#3  0x000055aae810e2cd in rocksdb::ThreadPoolImpl::Impl::BGThreadWrapper (arg=0x7fc92b42f2c0)
    at util/threadpool_imp.cc:307
#4  0x00007fc92c3b874f in ?? () from /usr/lib/x86_64-linux-gnu/libstdc++.so.6
#5  0x00007fc92c68b6db in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0
#6  0x00007fc92ba7593f in clone () from /lib/x86_64-linux-gnu/libc.so.6
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gUnwO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gUnyS,kvrocks,1616018578,1535,NA,xumingbo,21134467,Bo Xu,,NA,2023-07-01T17:50:15Z,2023-07-01T17:50:15Z,"```
/tests/cppunit/t_hash_test.cc:69: Failure
Value of: s.ok() && static_cast<int>(fvs.size()) == ret
  Actual: false
Expected: true
*** Aborted at 1688233350 (unix time) try ""date -d @1688233350"" if you are using GNU date ***
PC: @                0x0 (unknown)
*** SIGSEGV (@0x8) received by PID 3234 (TID 0x7fc92d2c4a40) from PID 8; stack trace: ***
    @     0x7fc92c696980 (unknown)
    @     0x55aae7be8c94 RedisHashTest_MGetAndMSet_Test::TestBody()
    @     0x55aae8497628 testing::internal::HandleExceptionsInMethodIfSupported<>()
    @     0x55aae84837af testing::Test::Run()
    @     0x55aae8483b3e testing::TestInfo::Run()
    @     0x55aae84841e0 testing::TestSuite::Run()
    @     0x55aae848fbe5 testing::internal::UnitTestImpl::RunAllTests()
    @     0x55aae84903e6 testing::UnitTest::Run()
    @     0x55aae7b3e412 main
    @     0x7fc92b975c07 __libc_start_main
    @     0x55aae7b8322a _start
 ```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gUnyS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gUoHW,kvrocks,1616019926,1535,NA,xumingbo,21134467,Bo Xu,,NA,2023-07-01T17:56:39Z,2023-07-01T17:56:39Z,"We (Akamai) are implementing CRDT data type. It needs to handle physical NotFound and Expired (logical not found) differently. We can circumvent this bug, by overriding GetMetaData(). I think it is helpful to report it here.  
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gUoHW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gV3Yq,kvrocks,1616344618,1535,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-02T03:54:48Z,2023-07-02T03:54:48Z,"@xumingbo For test case failure, you need to modify the corresponding status check as well. But for this case, how about checking if the key was expired by the error message? 

> We (Akamai) are implementing CRDT data type. It needs to handle physical NotFound and Expired (logical not found) differently.

Also contribute back the CRDT feature if you would like.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gV3Yq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gXS2e,kvrocks,1616719262,1535,NA,PragmaTwice,20042607,Twice,,NA,2023-07-02T16:19:53Z,2023-07-02T16:19:53Z,"https://github.com/apache/kvrocks/blob/17b31e7901c8a75140e5bb2a7e42e9258792bea6/tests/cppunit/t_hash_test.cc#L68-L69

From a first glance, the abort in test case seems due to that the `Hash::MSet` function does not handle the `Expired` status well, since you changed the status from `NotFound` to `Expired`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gXS2e/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1535,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s8YgY,kvrocks,1827768344,1535,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-27T12:46:05Z,2023-11-27T12:46:05Z,"Close this PR due to lack of inactive, free feel to reopen if needed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s8YgY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1538,https://api.github.com/repos/apache/kvrocks/issues/1538,kvrocks,1788019986,1538,Running the `memory usage` command against a non-existent key resulted in an error,fosmjo,4081327,Fang Jie,imefangjie@gmail.com,CLOSED,2023-07-04T14:16:32Z,2023-07-05T04:47:11Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks 2.4.0



### Minimal reproduce step

```sh
memory usage key-not-exist
```

### What did you expect to see?

return `nil`

### What did you see instead?

```sh
(error) ERROR NotFound: Not found : key-not-exist
```

### Anything Else?

This is not compatible with redis, which return `nil` when the key does not exist, and will cause [asynqmon](https://github.com/hibiken/asynqmon) failed sometimes when using `memory usage` command.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1538/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1538,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5glU_o,kvrocks,1620398056,1538,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-04T14:52:25Z,2023-07-04T14:52:25Z,@fosmjo Thanks for your feedback.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5glU_o/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1544,https://api.github.com/repos/apache/kvrocks/issues/1544,kvrocks,1788861885,1544,Hope Kvrocks can support full commands of the stream data type,jcy1001,24226340,,,OPEN,2023-07-05T06:28:52Z,2023-07-28T02:20:21Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Same as the title

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1544/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1544,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goLo9,kvrocks,1621146173,1544,NA,torwig,8588372,Yaroslav,,NA,2023-07-05T06:59:27Z,2023-07-05T06:59:27Z,"@jcy1001 I would like to help you with your question/request/issue. But unfortunately, I don't know the language and Google Translate said `I hope to increase the stream function of redis and realize the simple mq function` which I didn't fully understand.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goLo9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1544,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goNVZ,kvrocks,1621153113,1544,NA,jcy1001,24226340,,,NA,2023-07-05T07:04:30Z,2023-07-05T07:04:30Z,"hi, redis has stream function in t_stream.c , redis7.0  has xgroupCreate like command , but  our project not implemented, i only find xadd xdel xinfo ..in cmd_stream.cc,  thanks ~","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goNVZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1544,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goPg9,kvrocks,1621162045,1544,NA,jcy1001,24226340,,,NA,2023-07-05T07:10:57Z,2023-07-05T07:10:57Z,"this is our project 

REDIS_REGISTER_COMMANDS(MakeCmdAttr<CommandXAdd>(""xadd"", -5, ""write"", 1, 1, 1),
                        MakeCmdAttr<CommandXDel>(""xdel"", -3, ""write"", 1, 1, 1),
                        MakeCmdAttr<CommandXLen>(""xlen"", -2, ""read-only"", 1, 1, 1),
                        MakeCmdAttr<CommandXInfo>(""xinfo"", -2, ""read-only"", 0, 0, 0),
                        MakeCmdAttr<CommandXRange>(""xrange"", -4, ""read-only"", 1, 1, 1),
                        MakeCmdAttr<CommandXRevRange>(""xrevrange"", -2, ""read-only"", 1, 1, 1),
                        MakeCmdAttr<CommandXRead>(""xread"", -4, ""read-only"", 0, 0, 0),
                        MakeCmdAttr<CommandXTrim>(""xtrim"", -4, ""write"", 1, 1, 1),
                        MakeCmdAttr<CommandXSetId>(""xsetid"", -3, ""write"", 1, 1, 1))

this is redis 
[XACK](http://www.redis.cn/commands/xack.html)
[XADD](http://www.redis.cn/commands/xadd.html)
[XCLAIM](http://www.redis.cn/commands/xclaim.html)
[XDEL](http://www.redis.cn/commands/xdel.html)
[XGROUP](http://www.redis.cn/commands/xgroup.html)
[XINFO](http://www.redis.cn/commands/xinfo.html)
[XLEN](http://www.redis.cn/commands/xlen.html)
[XPENDING](http://www.redis.cn/commands/xpending.html)
[XRANGE](http://www.redis.cn/commands/xrange.html)
[XREAD](http://www.redis.cn/commands/xread.html)
[XREADGROUP](http://www.redis.cn/commands/xreadgroup.html)
[XREVRANGE](http://www.redis.cn/commands/xrevrange.html)
[XTRIM](http://www.redis.cn/commands/xtrim.html)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goPg9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1544,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goZYW,kvrocks,1621202454,1544,NA,Yangsx-1,85615957,Hauru,,NA,2023-07-05T07:36:03Z,2023-07-05T07:36:03Z,"We are implementing features to be compatible with Redis 7.0, it may need some time. I can drive this task when i'm free.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goZYW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1544,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goclo,kvrocks,1621215592,1544,NA,torwig,8588372,Yaroslav,,NA,2023-07-05T07:45:06Z,2023-07-05T07:45:06Z,"@jcy1001 Yes, you are right, currently, consumer groups aren't implemented in Kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goclo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1545,https://api.github.com/repos/apache/kvrocks/issues/1545,kvrocks,1788934201,1545,"Disable ""plain"" server when using (m)TLS",kinoute,623763,Yann Defretin,yann@defret.in,OPEN,2023-07-05T07:18:31Z,2023-09-27T05:30:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Usually, when we want to enable (m)TLS connections on Redis, we first disable the `port` parameter by setting it to 0 in order to have only one ""endpoint"", the TLS one:

> The `tls-port` configuration directive enables accepting SSL/TLS connections on the specified port. This is in addition to listening on port for TCP connections, so it is possible to access Redis on different ports using TLS and non-TLS connections simultaneously.
> You may specify `port 0` to disable the non-TLS port completely.

Source : https://redis.io/docs/management/security/encryption/

On Kvrocks though, it seems impossible to do the same. When we enable TLS through the various settings such as `tls-port`,    using version 2.4.0, it is not possible to disable the non TLS endpoint. When setting `port` to 0, we get an error ""out of numeric range"".  When we set `port` to the same value as `tls-port`, we can only reach the non-TLS version etc.

### Solution

It would be nice if we could disable the non-TLS endpoint when enabling TLS.

As I can see in the code, right now the `port` must be set between 1 and PORT_MAX - 1.  We could check:

* If `tls-port` is enabled ;
* And `port` is set to 0 ;

Then disable the non-TLS endpoint.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1545/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1545,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gomJb,kvrocks,1621254747,1545,NA,PragmaTwice,20042607,Twice,,NA,2023-07-05T08:09:57Z,2023-07-05T08:09:57Z,"Thanks, I think it is a good feature request, which can be an item in kvrocks roadmap for security.

Currently, I think you can workaround it by block the non-TLS port via iptables or other firewalls.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gomJb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1545,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goy_y,kvrocks,1621307378,1545,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2023-07-05T08:44:24Z,2023-07-05T08:44:24Z,"Indeed, when using Kvrocks in a Kubernetes cluster, we don't expose the non-TLS port right now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5goy_y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1545,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gskE-,kvrocks,1622294846,1545,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-07-05T18:50:15Z,2023-07-05T18:50:15Z,I will fix this issue quickly. @kinoute ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gskE-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1545,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nhF4M,kvrocks,1736728076,1545,NA,sachinrao8312,72882692,,,NA,2023-09-27T05:29:58Z,2023-09-27T05:29:58Z,Please assign this to me I would like to work on it,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nhF4M/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1545,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nhGBq,kvrocks,1736728682,1545,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-27T05:30:48Z,2023-09-27T05:30:48Z,@sachinrao8312 Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nhGBq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1551,https://api.github.com/repos/apache/kvrocks/issues/1551,kvrocks,1790579948,1551,Evaluate Profile-Guided Optimization on kvrocks,zamazan4ik,7355383,Alexander Zaitsev,zamazan4ik@tut.by,OPEN,2023-07-06T00:45:10Z,2024-03-22T09:08:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I think Profile-Guided Optimization can improve kvrocks performance. I did a lot of PGO benchmarks on different software (all results are shown [here](https://github.com/zamazan4ik/awesome-pgo/)). The most interesting for kvrocks results probably are RocksDB [results](https://github.com/google/leveldb/issues/1133#issue-1790305434) and Redis [results](https://github.com/redis/redis/issues/12371).

Seems like could be a good thing to try on kvrocks as well.

### Solution

Try to use PGO and/or BOLT. It could be used via `-fprofile-generate`/`-fprofile-use` compiler flags. For further instructions follow GCC or Clang documentation.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1551/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1551,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gui9-,kvrocks,1622814590,1551,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-06T01:55:37Z,2023-07-06T01:55:37Z,"@zamazan4ik Thanks for suggesting it, and we definitely like to try any possible improvements. BTW, Kvrocks has applied the LTO/IPO in #764, and looking forward to seeing the result if anyone is interested in this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gui9-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1551,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ivW0L,kvrocks,1656581387,1551,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-07-29T07:08:29Z,2023-07-29T07:08:29Z,"So, for implement this feature, we build a first version, run a standard benchmark test, e.g. redis-benchmark and then, rebuild with using a generated gcda file, right? 

Or we can static generating this file for general linux and add it into repo (and periodic update)?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ivW0L/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1551,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iv1Mh,kvrocks,1656705825,1551,NA,zamazan4ik,7355383,Alexander Zaitsev,zamazan4ik@tut.by,NA,2023-07-29T11:04:46Z,2023-07-29T11:04:46Z,"> So, for implement this feature, we build a first version, run a standard benchmark test, e.g. redis-benchmark and then, rebuild with using a generated gcda file, right?

Yes. If you want to regenerate profile data per commit or per-optimized build, you can collect `.gcda` files (in GCC case. In LLVM/Clang case these files will have `.profraw` format) and then rebuild with these files the project once again.

> Or we can static generating this file for general linux and add it into repo (and periodic update)?

You can do it too! Just be careful - in general, these files (`.gcda`/`.profraw`) do not preserve compatibility between compilers or even compiler versions. So you will need to maintain these files for multiple compilers (and compiler versions). Or just support only one compiler versions for the optimized build - for other cases describe in the documentation a fallback to a ""general"" way with rebuilding with Instrumentation, running `redis-benchmark`, etc.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iv1Mh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1551,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iv2ul,kvrocks,1656712101,1551,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-07-29T11:45:49Z,2023-07-29T11:45:49Z,"Lot of thanks, I need a think about this way. You are correct - storing a static file have a bad idea for us, it need to be in CI stage or a dedicated command (or a flag) in x.py build scipt.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iv2ul/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1551,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wgF8d,kvrocks,1887461149,1551,NA,raffertyyu,104707498,,raffertyyu@tencent.com,NA,2024-01-11T15:52:06Z,2024-01-11T15:52:06Z,Is there any progress? I'm interested in it. Could I have a try to do something about pgo？,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wgF8d/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1551,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wgIjX,kvrocks,1887471831,1551,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-11T15:58:02Z,2024-01-11T15:58:02Z,"@raffertyyu Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wgIjX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1552,https://api.github.com/repos/apache/kvrocks/issues/1552,kvrocks,1790660501,1552,Flaky test TestZset ZRANGEBYSCORE_fuzzy_test,tisonkun,18818196,tison,wander4096@gmail.com,CLOSED,2023-07-06T02:07:03Z,2023-07-12T11:55:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

master

### Minimal reproduce step

```
--- FAIL: TestZset (6.77s)
    --- FAIL: TestZset/ZRANGEBYSCORE_fuzzy_test,_100_ranges_in_100_element_sorted_set_-_skiplist (1.45s)
        assertions.go:37: 
            	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/zset/assertions.go:37
            	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/zset/zset_test.go:1330
            	Error:      	""0.8835915986346754"" is not less than or equal to ""0.88359158989[119](https://github.com/apache/kvrocks/actions/runs/5465748637/jobs/9950010260#step:12:120)87""
            	Test:       	TestZset/ZRANGEBYSCORE_fuzzy_test,_100_ranges_in_100_element_sorted_set_-_skiplist
FAIL
```

### What did you expect to see?

Test passed.

### What did you see instead?

Test failed.

### Anything Else?

This seems a bug on float precision. I don't think it's about test suite precision but the server handling on precision.

cc @git-hulk @mwish

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1552/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1552,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gu9H7,kvrocks,1622921723,1552,NA,infdahai,30547248,clundro,infdahai@outlook.com,NA,2023-07-06T03:43:07Z,2023-07-06T03:43:07Z,"It may have been caused by this problem about double and float conversion from initial observations if the client executes right.

https://github.com/apache/kvrocks/blob/7e23c0bea1eb3d9c561af2dc110ebb803e0f32fe/src/types/redis_zset.cc#L517-L534

And I'm not sure the handling here either.
https://github.com/apache/kvrocks/blob/7e23c0bea1eb3d9c561af2dc110ebb803e0f32fe/tests/gocase/unit/type/zset/zset_test.go#L1309-L1321","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gu9H7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1552,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gvTIq,kvrocks,1623011882,1552,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-06T05:27:30Z,2023-07-06T05:27:30Z,"@tisonkun Yes, it's a precision issue caused by the `strtod` which parsed the string ""0.88359158989"" as ""0.88359158988999997"". But Redis also has this issue, so I think it would be good to fix the test case only.

```
❯ redis-cli
127.0.0.1:6379> zadd z 0.88359158989 k1
(integer) 1
127.0.0.1:6379> zrange z 0 1 withscores
1) ""k1""
2) ""0.88359158988999997""
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gvTIq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1554,https://api.github.com/repos/apache/kvrocks/issues/1554,kvrocks,1790818777,1554,clang: error: unsupported option '-static-libgcc' on MacOS,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2023-07-06T05:08:58Z,2023-07-06T15:58:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

On MacOS clang-13, it doesn't support `-static-libgcc`. So the code below might get:

```
clang: error: unsupported option '-static-libgcc'
```

Is this expected?

### Solution

```c++
if ((CMAKE_CXX_COMPILER_ID STREQUAL ""GNU"") OR (CMAKE_CXX_COMPILER_ID STREQUAL ""Clang""))
-    set(CMAKE_EXE_LINKER_FLAGS ""${CMAKE_EXE_LINKER_FLAGS} -static-libgcc"")
+    if (NOT APPLE)
+       set(CMAKE_EXE_LINKER_FLAGS ""${CMAKE_EXE_LINKER_FLAGS} -static-libgcc"")
+    endif()

    if(ENABLE_STATIC_LIBSTDCXX)
        try_compile(FOUND_STATIC_LIBSTDCXX ${PROJECT_BINARY_DIR} ${PROJECT_SOURCE_DIR}/cmake/checks/static_libstdcxx.cc
            LINK_OPTIONS -static-libstdc++ CXX_STANDARD 11)

        if(NOT FOUND_STATIC_LIBSTDCXX)
            message(FATAL_ERROR ""cannot find static library of libstdc++, please add ENABLE_STATIC_LIBSTDCXX=OFF to disable"")
        endif()

        set(CMAKE_EXE_LINKER_FLAGS ""${CMAKE_EXE_LINKER_FLAGS} -static-libstdc++"")
    endif()
endif()
```

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1554/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1554,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gvlwQ,kvrocks,1623088144,1554,NA,PragmaTwice,20042607,Twice,,NA,2023-07-06T06:49:37Z,2023-07-06T06:49:37Z,Looks good to me.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gvlwQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1554,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gywdr,kvrocks,1623918443,1554,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-07-06T15:54:29Z,2023-07-06T15:54:29Z,It was fixed in https://github.com/apache/kvrocks/pull/1555,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gywdr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1554,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gyyA-,kvrocks,1623924798,1554,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-07-06T15:58:53Z,2023-07-06T15:58:53Z,"Too tired today that I forgot to close it, thanks!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5gyyA-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1560,https://api.github.com/repos/apache/kvrocks/issues/1560,kvrocks,1792781962,1560,Dynamic modification of the parameter rocksdb.compression to zstd in version 2.4 may not take effect immediately on newly created files,bbqccx,133967682,,,CLOSED,2023-07-07T05:00:28Z,2023-07-16T10:29:00Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.4

### Minimal reproduce step

1.Modify the compression parameters.
2.FlushDB and compact
3.Rewrite the data, but it appears that zstd compression was not applied based on the logs. The output still shows that the compression used is lz4.
""[CompactOnExpiredCollector]"", ""compression"": ""LZ4"", ""compression_options"": ""window_bits=-14; level=32767; strategy=0; max_dict_bytes=0; zstd_max_train_bytes=0; enabled=0; max_dict_buffer_bytes=0; use_zstd_dict_trainer=1; ""

if reboot kvrocks then use zstd

2023/07/05-13:22:43.170822 1        Options.write_buffer_size: 67108864
2023/07/05-13:22:43.170824 1  Options.max_write_buffer_number: 10
2023/07/05-13:22:43.170826 1        Options.compression[0]: NoCompression
2023/07/05-13:22:43.170827 1        Options.compression[1]: NoCompression
2023/07/05-13:22:43.170829 1        Options.compression[2]: ZSTD
2023/07/05-13:22:43.170830 1        Options.compression[3]: ZSTD
2023/07/05-13:22:43.170832 1        Options.compression[4]: ZSTD
2023/07/05-13:22:43.170833 1        Options.compression[5]: ZSTD
2023/07/05-13:22:43.170835 1        Options.compression[6]: ZSTD


""[CompactOnExpiredCollector]"", ""compression"": ""ZSTD"", ""compression_options"": ""window_bits=-14; level=32767; strategy=0; max_dict_bytes=0; zstd_max_train_bytes=0; enabled=0; max_dict_buffer_bytes=0; use_zstd_dict_trainer=1; ""

### What did you expect to see?

Test passed

### What did you see instead?

The compression parameters only take effect after a restart

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1560/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1560,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5g18R2,kvrocks,1624753270,1560,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-07T05:03:41Z,2023-07-07T05:03:41Z,@bbqccx Thanks for your feedback. It's caused by the compression haven't been applied to the rocksdb after the config set command. We should add the callback to apply this option after it's changed.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5g18R2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1564,https://api.github.com/repos/apache/kvrocks/issues/1564,kvrocks,1794882030,1564,Tools: add `bugprone-use-after-move` checkings in clang-tidy,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2023-07-08T10:27:20Z,2023-07-10T05:55:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Clang-tidy support some checkings like `bugprone-use-after-move`, which can be used to detect some use-after-move cases, and helps us make less bugs. We can enable some of the checkings.

### Solution

```
def clang_tidy(dir: str, jobs: Optional[int], clang_tidy_path: str, run_clang_tidy_path: str, fix: bool) -> None:
    ...
    options.append(f'-header-filter={""|"".join(regexes)}')
+    options.append(f'-checks=bugprone-use-after-move')

    run(run_command, *options, *regexes, verbose=True, cwd=basedir)
```

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1564/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1564,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5g_jzD,kvrocks,1627274435,1564,NA,PragmaTwice,20042607,Twice,,NA,2023-07-08T13:24:30Z,2023-07-08T13:24:30Z,You need to add them to `.clang-tidy` instead of modifying `x.py`.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5g_jzD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1564,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5g_6eD,kvrocks,1627367299,1564,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-07-08T14:48:53Z,2023-07-08T14:48:53Z,"@PragmaTwice I've add one in https://github.com/apache/kvrocks/pull/1566, would you mind take a look? And is there any more checkings could be added?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5g_6eD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1564,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hDaGx,kvrocks,1628283313,1564,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-07-10T05:55:59Z,2023-07-10T05:55:59Z,Closed by https://github.com/apache/kvrocks/pull/1566,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hDaGx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1572,https://api.github.com/repos/apache/kvrocks/issues/1572,kvrocks,1796020159,1572,Style: Change `Storage::SetReadOptions` to `Storage::DefaultScanOptions`,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2023-07-10T06:01:48Z,2023-07-11T03:56:48Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

```c++
class Storage {
 public:
  explicit Storage(Config *config);
  
  void SetWriteOptions(const Config::RocksDB::WriteOptions &config);
  void SetReadOptions(rocksdb::ReadOptions &read_options);

  const rocksdb::WriteOptions &DefaultWriteOptions() { return write_opts_; }
};
```

Now kvrocks has `SetWriteOptions` and `SetReadOptions`. However, there syntax doesn't same. `SetWriteOptions` would set the `Storage` internal `rocksdb::WriteOptions` during intialize, and the detail option can be get by `DefaultWriteOptions()`.

However, `SetReadOptions` only does some fixup when called:

```c++
void Storage::SetReadOptions(rocksdb::ReadOptions &read_options) {
  read_options.fill_cache = false;
  read_options.async_io = config_->rocks_db.read_options.async_io;
}
```

Would we create a `DefaultScanOptions`, and remove `SetReadOptions` for that ?

### Solution

```c++
class Storage {
 public:
  explicit Storage(Config *config);
  
  void SetWriteOptions(const Config::RocksDB::WriteOptions &config);
-  void SetReadOptions(rocksdb::ReadOptions &read_options);

  const rocksdb::WriteOptions &DefaultWriteOptions() { return write_opts_; }
+ rocksdb::ReadOptions DefaultScanOptions();
};
```

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1572/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1572,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hD3ih,kvrocks,1628403873,1572,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-10T07:36:54Z,2023-07-10T07:36:54Z,Sounds good to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hD3ih/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1578,https://api.github.com/repos/apache/kvrocks/issues/1578,kvrocks,1799565017,1578,Add a SUSE environment for building and testing in CI,PragmaTwice,20042607,Twice,,CLOSED,2023-07-11T18:48:02Z,2023-08-07T04:29:31Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

SUSE is a main linux distro branch, as well as Debian (Ubuntu), RHEL (CentOS). So we can build and test kvrocks in a SUSE environment.

### Solution

It is a successor to https://github.com/apache/kvrocks/pull/1569. We can just implement the env based on it.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1578/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1579,https://api.github.com/repos/apache/kvrocks/issues/1579,kvrocks,1799567943,1579,Add an archlinux environment for building and testing in CI ,PragmaTwice,20042607,Twice,,CLOSED,2023-07-11T18:49:30Z,2023-07-22T15:41:05Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

ArchLinux is a main linux distro branch, as well as Debian (Ubuntu), RHEL (CentOS) and SUSE. So we can build and test kvrocks in an archlinux environment.

### Solution

It is a successor to https://github.com/apache/kvrocks/pull/1569. We can just implement the env based on it.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1579/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1579,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hROi9,kvrocks,1631905981,1579,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-07-12T06:10:24Z,2023-07-12T06:10:24Z,Maybe we can use something like this - https://github.com/zaoqi/github-actions-archlinux,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hROi9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1579,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hThGz,kvrocks,1632506291,1579,NA,Yangsx-1,85615957,Hauru,,NA,2023-07-12T13:12:29Z,2023-07-12T13:12:29Z,Let me try. :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hThGz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1579,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hTvbb,kvrocks,1632564955,1579,NA,PragmaTwice,20042607,Twice,,NA,2023-07-12T13:48:15Z,2023-07-12T13:48:15Z,"> Maybe we can use something like this - https://github.com/zaoqi/github-actions-archlinux

We can use the archlinux image directly: https://hub.docker.com/_/archlinux","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hTvbb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1580,https://api.github.com/repos/apache/kvrocks/issues/1580,kvrocks,1799578430,1580,Test the built docker image in nightly CI,PragmaTwice,20042607,Twice,,CLOSED,2023-07-11T18:55:03Z,2023-07-29T10:16:49Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/apache/kvrocks/blob/unstable/.github/workflows/nightly.yaml

In nightly CI, we have built docker images for kvrocks, but we cannot confirm the built docker image is valid, e.g. the kvrocks may just crash after starting due to some OS environment problems, like shared library missing. We want to add some simple test to confirm the built image is run-able.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1580/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/1585,kvrocks,1801469423,1585,Tracking issues: add the support of all missing commands in the stream type,Yangsx-1,85615957,Hauru,,CLOSED,2023-07-12T17:46:49Z,2025-01-28T02:24:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to implement all missing commands like redis stream.

Already implemented commands:
`XADD, XDEL, XLEN, XINFO STREAM, XRANGE, XREVRANGE, XREAD, XTRIM, XSETID`

redis 5.0.0
consumer group:
`XACK, XCLAIM, XGROUP CREATE, XGROUP DELCONSUMER, XGROUP DESTROY, XGROUP SETID, XPENDING, XREADGROUP`

info:
`XINFO CONSUMERS, XINFO GROUPS`

redis 6.2.0
`XAUTOCLAIM, XGROUP CREATECONSUMER`

We can implement these commands through 3 stages:
1.Implement create, delete and simple comsume operations: `XGROUP CREATE, XGROUP DESTROY, XREADGROUP`
2.Implement critical operations: `XACK, XPENDING, XCLAIM, XINFO CONSUMERS, XINFO GROUPS`
3.Implement other operations: `XGROUP CREATECONSUMER, XGROUP DELCONSUMER, XAUTOCLAIM, XGROUP SETID`

### Solution

- [x] #1586 
- [x] #1588 
- [x] #1730 
- [x] #1731 
- [x] #1732 
- [x] #1733 
- [x] #1734 
- [x] #1735 
- [x] #2181 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1585/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVQHH,kvrocks,1632960967,1585,NA,Yangsx-1,85615957,Hauru,,NA,2023-07-12T17:49:43Z,2023-07-12T17:49:43Z,Is there anything we should pay special attantion to? @git-hulk @PragmaTwice @mapleFU @torwig ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVQHH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVQHU,kvrocks,1632960980,1585,NA,PragmaTwice,20042607,Twice,,NA,2023-07-12T17:49:43Z,2023-07-12T17:49:43Z,"Hi @Yangsx-1, thanks for creating the tracking issue.

It would be nice if you create an issue per every command and make a list of these issues in this issue.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVQHU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVRCZ,kvrocks,1632964761,1585,NA,Yangsx-1,85615957,Hauru,,NA,2023-07-12T17:51:25Z,2023-07-12T17:51:25Z,"> Hi @Yangsx-1, thanks for creating the tracking issue.
> 
> It would be nice if you create an issue per every command and make a list of these issues in this issue.

OK! I'll create some issues for commands in stage1.  :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVRCZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVT5p,kvrocks,1632976489,1585,NA,PragmaTwice,20042607,Twice,,NA,2023-07-12T17:59:10Z,2023-07-12T17:59:10Z,"Oh, but if you think that, like, there are a group of commands whose implementation code is closely connected and is not possible to assign each part to different people for implementation, in that case, you can simply open one issue for the group of commands.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVT5p/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVWZ_,kvrocks,1632986751,1585,NA,Yangsx-1,85615957,Hauru,,NA,2023-07-12T18:06:17Z,2023-07-12T18:06:17Z,"> Oh, but if you think that, like, there are a group of commands whose implementation code is closely connected and is not possible to assign each part to different people for implementation, in that case, you can simply open one issue for the group of commands.

That would be nice.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hVWZ_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ibxxR,kvrocks,1651448913,1585,NA,ptbxzrt,89020404,,,NA,2023-07-26T10:10:40Z,2023-07-26T10:10:40Z,"@Yangsx-1 Hello, are you planning to implement these commands on your own? I am a beginner, but I am very interested in this. I'm wondering if I can participate. Thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ibxxR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ib_mR,kvrocks,1651505553,1585,NA,Yangsx-1,85615957,Hauru,,NA,2023-07-26T10:27:40Z,2023-07-26T10:27:40Z,"> @Yangsx-1 Hello, are you planning to implement these commands on your own? I am a beginner, but I am very interested in this. I'm wondering if I can participate. Thank you!

Thank you for your interest! I'm now doing issue #1586 . You can leave a comment in issue #1588 if you want to participate.
#1586 is a prerequisite for #1588 . You can research it first and implement it after i finish #1586 .
Good luck. :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ib_mR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5icEhn,kvrocks,1651525735,1585,NA,ptbxzrt,89020404,,,NA,2023-07-26T10:39:40Z,2023-07-26T10:39:40Z,"> > @Yangsx-1 Hello, are you planning to implement these commands on your own? I am a beginner, but I am very interested in this. I'm wondering if I can participate. Thank you!
> 
> Thank you for your interest! I'm now doing issue #1586 . You can leave a comment in issue #1588 if you want to participate. #1586 is a prerequisite for #1588 . You can research it first and implement it after i finish #1586 . Good luck. :)

Nice! Thank you so much!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5icEhn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mCyTu,kvrocks,1712006382,1585,NA,uds5501,21087061,Uddeshya Singh,singhuddeshyaofficial@gmail.com,NA,2023-09-08T17:29:38Z,2023-09-08T17:29:38Z,"Hi @Yangsx-1 , these issues seem interesting, Can I pick up any issue that you need a hand on / are independent of other issues?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mCyTu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1585,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mESXX,kvrocks,1712399831,1585,NA,Yangsx-1,85615957,Hauru,,NA,2023-09-09T03:22:47Z,2023-09-09T03:22:47Z,"> Hi @Yangsx-1 , these issues seem interesting, Can I pick up any issue that you need a hand on / are independent of other issues?

You can pick any issue you like, and refer to #1654 for design. @uds5501 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mESXX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1586,https://api.github.com/repos/apache/kvrocks/issues/1586,kvrocks,1801492896,1586,Add the support of the XGROUP CREATE and DESTROY command,Yangsx-1,85615957,Hauru,,CLOSED,2023-07-12T17:56:20Z,2023-09-01T16:03:46Z,"This issue intend to implement [XGROUP CREATE](https://redis.io/commands/xgroup-create/) and [XGROUP DESTROY](https://redis.io/commands/xgroup-destroy/) like redis.

see #1654 for more discusstions","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1586/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1586,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hj3nI,kvrocks,1636792776,1586,NA,Yangsx-1,85615957,Hauru,,NA,2023-07-15T14:53:49Z,2023-07-15T14:53:49Z,I'll do this when i'm free.  :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hj3nI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1586,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hj7nV,kvrocks,1636809173,1586,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-15T16:00:50Z,2023-07-15T16:00:50Z,"@Yangsx-1 assigned, thanks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hj7nV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1587,https://api.github.com/repos/apache/kvrocks/issues/1587,kvrocks,1801497856,1587,Add the support of the XGROUP DESTROY command,Yangsx-1,85615957,Hauru,,CLOSED,2023-07-12T17:58:41Z,2023-07-12T18:01:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue intend to implement [XGROUP DESTROY](https://redis.io/commands/xgroup-destroy/) like redis.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1587/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1588,https://api.github.com/repos/apache/kvrocks/issues/1588,kvrocks,1801516017,1588,Add the support of the XREADGROUP command,Yangsx-1,85615957,Hauru,,CLOSED,2023-07-12T18:10:39Z,2024-03-01T08:19:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue intend to implement [XREADGROUP](https://redis.io/commands/xreadgroup/) command like redis.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1588/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1588,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5icE0-,kvrocks,1651526974,1588,NA,ptbxzrt,89020404,,,NA,2023-07-26T10:40:31Z,2023-07-26T10:40:31Z,Hello! Can I have a try?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5icE0-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1588,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lkRd7,kvrocks,1704007547,1588,NA,Yangsx-1,85615957,Hauru,,NA,2023-09-03T05:02:43Z,2023-09-03T05:02:43Z,"Hi! @ptbxzrt You can start doing this task when available.  :)
Please refer to #1654 and #1704 for the design.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lkRd7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1594,https://api.github.com/repos/apache/kvrocks/issues/1594,kvrocks,1806019257,1594,"when i use redisbenchmark set key ,then  "" info keyspace"" cannt get right result",jcy1001,24226340,,,CLOSED,2023-07-15T11:01:05Z,2023-07-17T15:01:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.5.0

### Minimal reproduce step

when i use redisbenchmark set key ,then  "" info keyspace"" cannt get right result

### What did you expect to see?

the same ,no change

### What did you see instead?

new value

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1594/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjqZc,kvrocks,1636738652,1594,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-15T11:16:16Z,2023-07-15T11:16:16Z,"Hi @jcy1001, do you mean the key number is not correct? if yes, can take a look at: https://kvrocks.apache.org/docs/faq","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjqZc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjrr0,kvrocks,1636743924,1594,NA,jcy1001,24226340,,,NA,2023-07-15T11:43:17Z,2023-07-15T11:43:17Z," 
OK
 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjrr0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjtb_,kvrocks,1636751103,1594,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-15T12:18:29Z,2023-07-15T12:18:29Z,"I will close this issue soon, free feel to reopen it if needed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hjtb_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hppz-,kvrocks,1638309118,1594,NA,jcy1001,24226340,,,NA,2023-07-17T14:51:31Z,2023-07-17T14:51:31Z,"![image](https://github.com/apache/kvrocks/assets/24226340/114aa5c4-cf63-4ec5-b568-514a94ad72f2)

i do like that  ,but i found it occur again","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hppz-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hpqCV,kvrocks,1638310037,1594,NA,jcy1001,24226340,,,NA,2023-07-17T14:52:05Z,2023-07-17T14:52:05Z,"![image](https://github.com/apache/kvrocks/assets/24226340/d200183d-4a74-46a7-97c0-2f10eb86c7c8)
there are so many keys","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hpqCV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hpqQ7,kvrocks,1638310971,1594,NA,jcy1001,24226340,,,NA,2023-07-17T14:52:39Z,2023-07-17T14:52:39Z,@git-hulk ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hpqQ7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hpuQP,kvrocks,1638327311,1594,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-17T15:01:20Z,2023-07-17T15:01:20Z,"It's still scanning the db, please take a look later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5hpuQP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1598,https://api.github.com/repos/apache/kvrocks/issues/1598,kvrocks,1812994664,1598,Kvrocks crashed in Cluster::updateSlotsInfo(),mnizhq007,23118518,,,CLOSED,2023-07-20T01:44:47Z,2023-07-29T03:37:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

- CentOS Linux release 7.9.2009 (Core)
- kvrocks 2.4.0

```
ldd /usr/local/bin/kvrocks2.4.0 
        linux-vdso.so.1 =>  (0x00007fff09cb9000)
        librt.so.1 => /lib64/librt.so.1 (0x00007f98c9f80000)
        libdl.so.2 => /lib64/libdl.so.2 (0x00007f98c9d7c000)
        libpthread.so.0 => /lib64/libpthread.so.0 (0x00007f98c9b60000)
        libm.so.6 => /lib64/libm.so.6 (0x00007f98c985e000)
        libc.so.6 => /lib64/libc.so.6 (0x00007f98c9490000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f98ca188000)

yum list glibc
Loaded plugins: fastestmirror
Loading mirror speeds from cached hostfile
Installed Packages
glibc.x86_64                                                                                                   2.17-326.el7_9                                                                                                   @Nexus-Update
Available Packages
glibc.i686                                                                                                     2.17-326.el7_9                                                                                                   Nexus-Update
```

### Minimal reproduce step

kernel: worker[45424]: segfault at 7fbea660c1 ip 0000000000aac777 sp 00007fbe9cdf27f0 error 4 in kvrocks2.4.0[406000+8cb000]

### What did you expect to see?

```
GNU gdb (GDB) Red Hat Enterprise Linux 7.6.1-120.el7
Copyright (C) 2013 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type ""show copying""
and ""show warranty"" for details.
This GDB was configured as ""x86_64-redhat-linux-gnu"".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /usr/local/bin/kvrocks2.4.0...done.
[New LWP 45424]
[New LWP 48250]
[New LWP 45381]
[New LWP 45421]
[New LWP 45382]
[New LWP 45418]
[New LWP 45426]
[New LWP 45422]
[New LWP 45414]
[New LWP 45417]
[New LWP 45420]
[New LWP 45427]
[New LWP 45383]
[New LWP 45425]
[New LWP 45423]
[New LWP 45380]
[New LWP 45419]
[New LWP 45372]
[New LWP 45416]
[Thread debugging using libthread_db enabled]
Using host libthread_db library ""/lib64/libthread_db.so.1"".
Core was generated by `kvrocks2.4.0 -c /data/kvrocks/conf/kvrocks-cluster-6669.conf'.
Program terminated with signal 11, Segmentation fault.
#0  0x0000000000aac777 in evmap_io_active_ (base=base@entry=0x7fbeaa921200, fd=131, events=34) at /root/kvrocks-2.4.0/build/_deps/libevent-src/evmap.c:434

warning: Source file is more recent than executable.
434             LIST_FOREACH(ev, &ctx->events, ev_io_next) {
Missing separate debuginfos, use: debuginfo-install glibc-2.17-326.el7_9.x86_64
```

### What did you see instead?

I want it to run stably
But I can't solve this problem

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1598/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1598,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ioyTQ,kvrocks,1654858960,1598,NA,mnizhq007,23118518,,,NA,2023-07-28T01:51:46Z,2023-07-28T01:51:46Z,"The following are the issues encountered with the kvrocks 2.5.0 -

```
W20230727 23:30:41.603250 38680 event_listener.cc:132] [event_listener/stall_cond_changed] column family: metadata write stall condition was changed, from stop to normal
W20230727 23:30:43.232915 37553 event_listener.cc:132] [event_listener/stall_cond_changed] column family: metadata write stall condition was changed, from normal to stop
E20230727 23:30:45.543407 37663 main.cc:84] ======= Ooops! kvrocks version 2.5.0 got signal: Segmentation fault (11) =======
E20230727 23:30:45.576381 37663 main.cc:101] /lib64/libpthread.so.0(+0xf62f) [0x7f8ceedaa62f]
E20230727 23:30:45.577598 37663 main.cc:99] /lib64/libc.so.6(+0x15bbed) [0x7f8cee826bed]      __memmove_ssse3_back
E20230727 23:30:45.594018 37663 main.cc:99] kvrocks2.5.0() [0xc5dcc1]                         std::string::_M_mutate()
E20230727 23:30:45.594180 37663 main.cc:99] kvrocks2.5.0() [0x4a9025]                         Cluster::updateSlotsInfo()
E20230727 23:30:45.599767 37663 main.cc:99] kvrocks2.5.0() [0x4a99d8]                         Cluster::genNodesDescription()
E20230727 23:30:45.604859 37663 main.cc:99] kvrocks2.5.0() [0x4c53b9]                         redis::CommandCluster::Execute()
E20230727 23:30:45.609015 37663 main.cc:99] kvrocks2.5.0() [0x55990a]                         redis::Connection::ExecuteCommands()
E20230727 23:30:45.611111 37663 main.cc:99] kvrocks2.5.0() [0x4bd5e3]                         EvbufCallbackBase<>::readCB()
E20230727 23:30:45.622982 37663 main.cc:99] kvrocks2.5.0() [0xabf22d]                         bufferevent_run_deferred_callbacks_unlocked
E20230727 23:30:45.623812 37663 main.cc:99] kvrocks2.5.0() [0xac54fb]                         event_process_active_single_queue
E20230727 23:30:45.629799 37663 main.cc:99] kvrocks2.5.0() [0xac5eae]                         event_base_loop
E20230727 23:30:45.631390 37663 main.cc:99] kvrocks2.5.0() [0x5783a9]                         _ZNSt6thread11_State_implINS_8_InvokerISt5tupleIJZN4util12CreateThreadIZN12WorkerThread5StartEvEUlvE_EE8StatusOrIS_EPKcT_EUlvE_EEEEE6_M_runEv.lto_priv.0
E20230727 23:30:45.634894 37663 main.cc:99] kvrocks2.5.0() [0xcbdc83]                         execute_native_thread_routine
E20230727 23:30:45.635279 37663 main.cc:99] /lib64/libpthread.so.0(+0x7ea4) [0x7f8ceeda2ea4]  start_thread
E20230727 23:30:45.636025 37663 main.cc:99] /lib64/libc.so.6(clone+0x6c) [0x7f8cee7c9b0c]     __clone
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ioyTQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1598,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ioyUq,kvrocks,1654859050,1598,NA,mnizhq007,23118518,,,NA,2023-07-28T01:51:52Z,2023-07-28T01:51:52Z,"```
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x00007f8cee826bed in __memmove_ssse3_back () from /lib64/libc.so.6
[Current thread is 1 (Thread 0x7f8ce47f6700 (LWP 37663))]
Missing separate debuginfos, use: debuginfo-install glibc-2.17-326.el7_9.x86_64 libgcc-4.8.5-44.el7.x86_64 libunwind-1.2-2.el7.x86_64
(gdb) bt
#0  0x00007f8cee826bed in __memmove_ssse3_back () from /lib64/libc.so.6
#1  0x0000000000c5dcc2 in std::string::_M_mutate(unsigned long, unsigned long, unsigned long) ()
#2  0x00000000004a9026 in std::string::erase (__n=1, __pos=<optimized out>, this=<optimized out>) at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/basic_string.h:3424
#3  std::string::pop_back (this=<optimized out>) at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/basic_string.h:4807
#4  Cluster::updateSlotsInfo (this=0x7f8ce9e8eac0) at /root/apache-kvrocks-2.5.0-src/src/cluster/cluster.cc:539
#5  0x00000000004a99d9 in Cluster::genNodesDescription (this=0x7f8ce9e8eac0) at /root/apache-kvrocks-2.5.0-src/src/cluster/cluster.cc:475
#6  0x00000000004c53ba in Cluster::GetClusterNodes (nodes_str=0x7f8ce47ed4a0, this=<optimized out>) at /root/apache-kvrocks-2.5.0-src/src/cluster/cluster.cc:470
#7  redis::CommandCluster::Execute (this=<optimized out>, svr=<optimized out>, conn=0x7f8ce100e800, output=0x7f8ce47ed5b0) at /root/apache-kvrocks-2.5.0-src/src/commands/cmd_cluster.cc:88
#8  0x000000000055990b in redis::Connection::ExecuteCommands (this=<optimized out>, to_process_cmds=<optimized out>) at /root/apache-kvrocks-2.5.0-src/src/server/redis_connection.cc:414
#9  0x00000000004bd5e4 in redis::Connection::OnRead (bev=<optimized out>, this=0x7f8ce100e800) at /root/apache-kvrocks-2.5.0-src/src/server/redis_connection.cc:88
#10 EvbufCallbackBase<redis::Connection, true, true, true>::readCB (bev=<optimized out>, ctx=0x7f8ce100e800) at /root/apache-kvrocks-2.5.0-src/src/common/event_util.h:76
#11 0x0000000000abf22e in bufferevent_run_deferred_callbacks_unlocked (cb=<optimized out>, arg=0x7f8ce1000c80) at /root/apache-kvrocks-2.5.0-src/build/_deps/libevent-src/bufferevent.c:208
#12 0x0000000000ac54fc in event_process_active_single_queue (base=base@entry=0x7f8cee0cd400, activeq=0x7f8cee026210, max_to_process=max_to_process@entry=2147483647, endtime=endtime@entry=0x0)
    at /root/apache-kvrocks-2.5.0-src/build/_deps/libevent-src/event.c:1720
#13 0x0000000000ac5eaf in event_process_active (base=0x7f8cee0cd400) at /root/apache-kvrocks-2.5.0-src/build/_deps/libevent-src/event.c:1783
#14 event_base_loop (base=0x7f8cee0cd400, flags=0) at /root/apache-kvrocks-2.5.0-src/build/_deps/libevent-src/event.c:2006
#15 0x00000000005783aa in Worker::Run (tid=..., this=0x7f8cee08f000) at /root/apache-kvrocks-2.5.0-src/src/server/worker.cc:296
#16 operator() (__closure=<optimized out>, __closure=<optimized out>) at /root/apache-kvrocks-2.5.0-src/src/server/worker.cc:510
#17 operator() (__closure=<optimized out>) at /root/apache-kvrocks-2.5.0-src/src/common/thread_util.h:38
#18 std::__invoke_impl<void, util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > (__f=...) at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/invoke.h:61
#19 std::__invoke<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > (__fn=...) at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/invoke.h:96
#20 std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > >::_M_invoke<0> (this=<optimized out>)
    at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/std_thread.h:253
#21 std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > >::operator() (this=<optimized out>)
    at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/std_thread.h:260
#22 std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > > >::_M_run(void) (this=<optimized out>)
    at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/std_thread.h:211
#23 0x0000000000cbdc84 in execute_native_thread_routine ()
#24 0x00007f8ceeda2ea5 in start_thread () from /lib64/libpthread.so.0
#25 0x00007f8cee7c9b0d in clone () from /lib64/libc.so.6
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ioyUq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1598,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iozte,kvrocks,1654864734,1598,NA,mnizhq007,23118518,,,NA,2023-07-28T01:59:29Z,2023-07-28T01:59:29Z,"```
Program terminated with signal SIGSEGV, Segmentation fault.
#0  evmap_io_active_ (base=base@entry=0x7fee43f35600, fd=<optimized out>, events=34) at /root/apache-kvrocks-2.5.0-src/build/_deps/libevent-src/evmap.c:435
435                     if (ev->ev_events & (events & ~EV_ET))
[Current thread is 1 (Thread 0x7fee429fe700 (LWP 8463))]
Missing separate debuginfos, use: debuginfo-install glibc-2.17-326.el7_9.x86_64 libgcc-4.8.5-44.el7.x86_64 libunwind-1.2-2.el7.x86_64
(gdb) bt
#0  evmap_io_active_ (base=base@entry=0x7fee43f35600, fd=<optimized out>, events=34) at /root/apache-kvrocks-2.5.0-src/build/_deps/libevent-src/evmap.c:435
#1  0x0000000000acf508 in epoll_dispatch (base=0x7fee43f35600, tv=<optimized out>) at /root/apache-kvrocks-2.5.0-src/build/_deps/libevent-src/epoll.c:505
#2  0x0000000000ac5d49 in event_base_loop (base=0x7fee43f35600, flags=0) at /root/apache-kvrocks-2.5.0-src/build/_deps/libevent-src/event.c:1992
#3  0x00000000005783aa in Worker::Run (tid=..., this=0x7fee4848f1c0) at /root/apache-kvrocks-2.5.0-src/src/server/worker.cc:296
#4  operator() (__closure=<optimized out>, __closure=<optimized out>) at /root/apache-kvrocks-2.5.0-src/src/server/worker.cc:510
#5  operator() (__closure=<optimized out>) at /root/apache-kvrocks-2.5.0-src/src/common/thread_util.h:38
#6  std::__invoke_impl<void, util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > (__f=...) at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/invoke.h:61
#7  std::__invoke<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > (__fn=...) at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/invoke.h:96
#8  std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > >::_M_invoke<0> (this=<optimized out>)
    at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/std_thread.h:253
#9  std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > >::operator() (this=<optimized out>)
    at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/std_thread.h:260
#10 std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > > >::_M_run(void) (this=<optimized out>)
    at /opt/rh/devtoolset-11/root/usr/include/c++/11/bits/std_thread.h:211
#11 0x0000000000cbdc84 in execute_native_thread_routine ()
#12 0x00007fee4916aea5 in start_thread () from /lib64/libpthread.so.0
#13 0x00007fee48b91b0d in clone () from /lib64/libc.so.6
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iozte/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1598,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5io1YE,kvrocks,1654871556,1598,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-28T02:09:06Z,2023-07-28T02:09:06Z,@mnizhq007 Thanks for your detail stack! It looks like caused by the concurrent access to the slots_info.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5io1YE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1598,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iqa0I,kvrocks,1655287048,1598,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-28T08:42:01Z,2023-07-28T08:42:01Z,"This bug should be introduced by the PR https://github.com/apache/kvrocks/pull/1219 because some of the subcommands won't have the exclusive lock, so they may update the slot info at the same time. A lot sorry for this bug.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iqa0I/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1598,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iqh1C,kvrocks,1655315778,1598,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-07-28T08:56:56Z,2023-07-28T08:56:56Z,">  It looks like caused by the concurrent access to the slots_info.

Can we move `slots_info` out of `class ClusterNode`, I noticed that it is not shared elsewhere. In the `Cluster:: genNodesInfo()` and `Cluster::genNodesDescription()` use an external temporary vector and pass it into the `Cluster::updateSlotsInfo`? @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iqh1C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1599,https://api.github.com/repos/apache/kvrocks/issues/1599,kvrocks,1812996231,1599,redis-benchmark  --cluster  Could not fetch node CONFIG,jcy1001,24226340,,,CLOSED,2023-07-20T01:46:43Z,2023-07-28T08:44:22Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

i use redis7.0 redis-benchark  option --cluster  found  it warning 

[root@localhost ~]# /root/redis-7.0.12/src/redis-benchmark --cluster  -h 10.168.106.187 -p  3001 -n 1000000 -c 10 -d  100  -r 1000000000 -q -t set
Cluster has 12 master nodes:

Master 0: kvrockskvrockskvrockskvrockskvrocksnod19 10.168.106.187:3019
WARNING: Could not fetch node CONFIG 10.168.106.187:3019
Master 1: kvrockskvrockskvrockskvrockskvrocksnode5 10.168.106.187:3005
WARNING: Could not fetch node CONFIG 10.168.106.187:3005
Master 2: kvrockskvrockskvrockskvrockskvrocksnod21 10.168.106.187:3021
WARNING: Could not fetch node CONFIG 10.168.106.187:3021
Master 3: kvrockskvrockskvrockskvrockskvrocksnod13 10.168.106.187:3013
WARNING: Could not fetch node CONFIG 10.168.106.187:3013
.....................................
................


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1599/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1599,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8t1g,kvrocks,1643306336,1599,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-07-20T06:10:38Z,2023-07-20T06:10:38Z,"@jcy1001 It's expected due to Kvrocks don't support the config get 'save' and 'appendonly', but it won't affect the benchmark result. For more information, please refer: https://github.com/redis/redis/blob/b35e20d1defe5cb77e54de583b01d669200a3a51/src/redis-benchmark.c#L325","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8t1g/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1599,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8uhP,kvrocks,1643309135,1599,NA,jcy1001,24226340,,,NA,2023-07-20T06:13:36Z,2023-07-20T06:13:36Z,@git-hulk ok,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5h8uhP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1603,https://api.github.com/repos/apache/kvrocks/issues/1603,kvrocks,1815451476,1603,KVRocks and P2PInfect worm exploits CVE-2022-0543 in Lua,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2023-07-21T09:11:52Z,2023-07-28T08:12:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Unstable, kvrocks_git_sha1:f557255

### Minimal reproduce step

KVRocks with no-auth public port

### What did you expect to see?

Clear work

### What did you see instead?

Creating a ten of STRING key with cron string.

### Anything Else?

See article https://unit42.paloaltonetworks.com/peer-to-peer-worm-p2pinfect/ 

This is relative to Redis too, bug in Lua - [CVE-2022-0543](https://nvd.nist.gov/vuln/detail/CVE-2022-0543)

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1603/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1603,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iEM3t,kvrocks,1645268461,1603,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2023-07-21T09:16:06Z,2023-07-21T09:16:06Z,"Sorry, can't add a simple examples, deleted immediately","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5iEM3t/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1603,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5io2q2,kvrocks,1654876854,1603,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-07-28T02:16:30Z,2023-07-28T02:16:30Z,"@aleksraiden Please send an email to private@kvrocks.apache.org to discuss security issue with a PoC.

We should not discuss security issue publicly.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5io2q2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1610,https://api.github.com/repos/apache/kvrocks/issues/1610,kvrocks,1821478153,1610,Please support change log-level in runtime,unext-ops,18475820,unextops,,CLOSED,2023-07-26T02:43:54Z,2023-07-26T08:42:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

version 2.5.0
error: Unsupported CONFIG parameter: log-level

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1610/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1618,https://api.github.com/repos/apache/kvrocks/issues/1618,kvrocks,1827317643,1618,do we have plan to  support raft ?,jcy1001,24226340,,,CLOSED,2023-07-29T04:48:25Z,2023-07-29T06:20:47Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

do we have plan to  support raft ?  when read data from slave get the same data

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1618/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1635,https://api.github.com/repos/apache/kvrocks/issues/1635,kvrocks,1836058583,1635,Crash in test case when stopping the server,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-08-04T04:47:58Z,2023-08-30T08:51:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

- None

### What did you expect to see?

The server can exit normally

### What did you see instead?

https://github.com/apache/kvrocks/actions/runs/5758139420/job/15610382153?pr=1634

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1635/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1635,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jdXRF,kvrocks,1668641861,1635,NA,PragmaTwice,20042607,Twice,,NA,2023-08-07T22:10:32Z,2023-08-07T22:10:32Z,"also in https://github.com/apache/kvrocks/actions/runs/5790039825/job/15692633570

```
--- FAIL: TestSlotMigrateFromSlave (2.20s)
    server.go:106: 
        	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/slotmigrate/server.go:106
        	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/slotmigrate/server.go:112
        	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/slotmigrate/server.go:101
        	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:[59](https://github.com/apache/kvrocks/actions/runs/5790039825/job/15692633570#step:12:60)
        	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:77
        	Error:      	Received unexpected error:
        	            	signal: aborted (core dumped)
        	Test:       	TestSlotMigrateFromSlave
FAIL
exit status 1
FAIL	github.com/apache/kvrocks/tests/gocase/integration/slotmigrate	74.770s
```

```
found crashes:
tests/gocase/workspace/TestSlotMigrateFromSlave-1691445585042-2404388140/stderr:E20230807 21:59:46.098938 48151 main.cc:84] ======= Ooops! kvrocks unstable (commit 610bb40) got signal: Aborted (6) =======
detail log:
terminate called without an active exception
WARNING: Logging before InitGoogleLogging() is written to STDERR
E20230807 21:59:46.098938 48151 main.cc:84] ======= Ooops! kvrocks unstable (commit 610bb40) got signal: Aborted (6) =======
E20230807 21:59:46.100010 48151 main.cc:101] /lib/x86_64-linux-gnu/libpthread.so.0(+0x14420) [0x7f1f8caee420]
E20230807 21:59:46.100147 48151 main.cc:99] /lib/x86_64-linux-gnu/libc.so.6(gsignal+0xcb) [0x7f1f8c7dc00b]               gsignal
E20230807 21:59:46.100245 48151 main.cc:99] /lib/x86_64-linux-gnu/libc.so.6(abort+0x12b) [0x7f1f8c7bb859]                abort
E20230807 21:59:46.100530 48151 main.cc:99] /home/runner/work/kvrocks/kvrocks/build/kvrocks(+0xfb8ab) [0x557[28](https://github.com/apache/kvrocks/actions/runs/5790039825/job/15692633570#step:13:29)eb2b8ab]   _ZN9__gnu_cxx27__verbose_terminate_handlerEv.cold
E202[30](https://github.com/apache/kvrocks/actions/runs/5790039825/job/15692633570#step:13:31)807 21:59:46.101485 48151 main.cc:99] /home/runner/work/kvrocks/kvrocks/build/kvrocks(+0xa115bc) [0x55728f4415bc]  __cxxabiv1::__terminate()
E20230807 21:59:46.102550 48151 main.cc:101] /home/runner/work/kvrocks/kvrocks/build/kvrocks(+0xa11627) [0x55728f441627]
E20230807 21:59:46.103595 48151 main.cc:101] /home/runner/work/kvrocks/kvrocks/build/kvrocks(+0x2228ac) [0x55728ec528ac]
E20230807 21:59:46.103973 48151 main.cc:99] /home/runner/work/kvrocks/kvrocks/build/kvrocks(+0x22c4[32](https://github.com/apache/kvrocks/actions/runs/5790039825/job/15692633570#step:13:33)) [0x55728ec5c[43](https://github.com/apache/kvrocks/actions/runs/5790039825/job/15692633570#step:13:44)2]  Server::~Server()
E20230807 21:59:46.104454 48151 main.cc:99] /home/runner/work/kvrocks/kvrocks/build/kvrocks(+0xfebc5) [0x55728eb2ebc5]   main
E20230807 21:59:46.104611 48151 main.cc:99] /lib/x86_64-linux-gnu/libc.so.6(__libc_start_main+0xf3) [0x7f1f8c7bd083]     __libc_start_main
E20230807 21:59:46.105257 48151 main.cc:99] /home/runner/work/kvrocks/kvrocks/build/kvrocks(+0x14ee0e) [0x55728eb7ee0e]  _start
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jdXRF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1643,https://api.github.com/repos/apache/kvrocks/issues/1643,kvrocks,1838251343,1643,Track issues: improvements of the kvrocks2redis,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-08-06T15:34:31Z,2023-08-14T06:18:11Z,"Many users would like to use kvrocks2redis to migrate the data from Kvrocks to Redis or other Kvrocks instances. But kvrocks2redis is hard to set up and use, we can improve it by making configurations more clear and simple.

- [ ] Investigate if possible to read the increment change streams from the local as well after parsing the DB dir, so that we can remove the source kvrocks host:port configuration.
- [ ] Add the support for migrating data from Kvrocks to the Redis cluster
- [ ] https://github.com/apache/kvrocks/issues/1442
- [ ] Backoff retry if unable to connect the Redis target
- [ ] Add test cases for kvrocks2redis to make sure it works all the time
- [x] https://github.com/apache/kvrocks/issues/1644
- [x] Rename `cluster-enable` to `cluster-enabled` for keeping consistent with Kvrocks. Refer https://github.com/apache/kvrocks-website/pull/141#issuecomment-1676479767. #1673","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1643/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1643,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jd6Z4,kvrocks,1668785784,1643,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2023-08-08T01:41:32Z,2023-08-08T01:41:32Z,"Perhaps we could make kvrocks2redis a command-line tool.

In addition, the current single-threaded model uses files as queue, which is very inefficient. Generally, kvrocks has a large amount of data, and in practice, migration takes a very, very long time. Maybe we can provide a multi-threaded solution as an alternative?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jd6Z4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1643,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jd7Wf,kvrocks,1668789663,1643,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-08T01:46:53Z,2023-08-08T01:46:53Z,"@caipengbo Yes, that's a good idea.  #1534 introduces the hiredis, I think we can switch to hiredis to send commands as well.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jd7Wf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1644,https://api.github.com/repos/apache/kvrocks/issues/1644,kvrocks,1838257858,1644,Failed to open Kvrocks storage when running the kvrocks2redis,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-08-06T15:54:50Z,2023-08-07T06:38:24Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

1. Running the Kvrocks instances with `kvrocks -c kvrocks.conf`
2. Setup the `kvrocks2redis` to migrate the data from the previous instance

### What did you expect to see?

kvrocks2redis can migrate the data normally.

### What did you see instead?

E20230806 23:52:19.491075 18555321 main.cc:163] Failed to open Kvrocks storage: failed to create column families: IO error: While lock file: /tmp/kvrocks/db/LOCK: Resource temporarily unavailable


### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1644/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1647,https://api.github.com/repos/apache/kvrocks/issues/1647,kvrocks,1838555668,1647,Flaky test in string_test.go,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-08-07T02:15:33Z,2023-08-11T16:45:42Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

None

### What did you expect to see?

go tests passed

### What did you see instead?

https://github.com/apache/kvrocks/actions/runs/5779002383/job/15660953839#step:12:114

```
--- FAIL: TestString (45.66s)
    server.go:109: 
        	Error Trace:	/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/strings/server.go:109
        	            				/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/strings/server.go:112
        	            				/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/strings/server.go:101
        	            				/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/strings/strings_test.go:757
        	Error:      	An error is expected but got nil.
        	Test:       	TestString
FAIL
exit status 1
FAIL	github.com/apache/kvrocks/tests/gocase/unit/type/strings	45.811s
```


### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1647/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jXoz9,kvrocks,1667140861,1647,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-08-07T03:45:31Z,2023-08-07T03:45:31Z,"our test suite doesn't describe exactly which test case fails.
it only says that a failure but there is no clue for us to troubleshoot...
can we do anything to improve it?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jXoz9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jXqyi,kvrocks,1667148962,1647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-07T03:59:37Z,2023-08-07T03:59:37Z,"> our test suite doesn't describe exactly which test case fails. it only says that a failure but there is no clue for us to troubleshoot... can we do anything to improve it?

This should be an issue in the library `testify` which won't show the expected error if the actual error was empty. But from the stack trace line number, we can identify this error was happened at line: https://github.com/apache/kvrocks/blob/06b5558ca6e5401388639ef9130256367dcef9de/tests/gocase/util/server.go#L109

This line expected the signal-killed error after timed reach, but it got nil. I'm not sure if it's a data race between the kill signal and the process exit behavior.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jXqyi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jk0I5,kvrocks,1670595129,1647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-09T03:22:39Z,2023-08-09T03:22:39Z,"Another issue is related to this: https://github.com/apache/kvrocks/actions/runs/5803982834/job/15733157365

```
ok  	github.com/apache/kvrocks/tests/gocase/unit/type/stream	5.497s
panic: Log in goroutine after TestString has completed: 
	Error Trace:	/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/strings/server.go:108
	            				/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/strings/asm_amd64.s:1594
	Error:      	Received unexpected error:
	            	os: process already finished
	Test:       	TestString


goroutine 89 [running]:
testing.(*common).logDepth(0xc000083520, {0xc0003443c0, 0x130}, 0x3)
	/Users/runner/hostedtoolcache/go/1.19.10/x64/src/testing/testing.go:894 +0x4c7
testing.(*common).log(...)
	/Users/runner/hostedtoolcache/go/1.19.10/x64/src/testing/testing.go:876
testing.(*common).Errorf(0xc000083520, {0x10031a4e2?, 0xc000083520?}, {0xc000335880?, 0x100073905?, 0x10054d440?})
	/Users/runner/hostedtoolcache/go/1.19.10/x64/src/testing/testing.go:940 +0x5a
github.com/stretchr/testify/assert.Fail({0x10857da48, 0xc000083520}, {0xc000022880, 0x37}, {0x0, 0x0, 0x0})
	/Users/runner/go/pkg/mod/github.com/stretchr/testify@v1.8.0/assert/assertions.go:264 +0x384
github.com/stretchr/testify/assert.NoError({0x10857da48, 0xc000083520}, {0x10039d740, 0xc0000981a0}, {0x0, 0x0, 0x0})
	/Users/runner/go/pkg/mod/github.com/stretchr/testify@v1.8.0/assert/assertions.go:1392 +0x105
github.com/stretchr/testify/require.NoError({0x10039ec90, 0xc000083520}, {0x10039d740, 0xc0000981a0}, {0x0, 0x0, 0x0})
	/Users/runner/go/pkg/mod/github.com/stretchr/testify@v1.8.0/require/require.go:[126](https://github.com/apache/kvrocks/actions/runs/5803982834/job/15733157365#step:12:127)1 +0x96
github.com/apache/kvrocks/tests/gocase/util.(*KvrocksServer).close.func2()
	/Users/runner/work/kvrocks/kvrocks/tests/gocase/util/server.go:108 +0x8f
created by time.goFunc
	/Users/runner/hostedtoolcache/go/1.19.10/x64/src/time/sleep.go:176 +0x32
exit status 2
FAIL	github.com/apache/kvrocks/tests/gocase/unit/type/strings	45.668s
PASS
ok  	github.com/apache/kvrocks/tests/gocase/unit/type/zset	11.092s
?   	github.com/apache/kvrocks/tests/gocase/util	[no test files]
FAIL
$ /Users/runner/hostedtoolcache/go/1.19.10/x64/bin/go test -timeout=1800s -bench=. ./... -binPath=/Users/runner/work/kvrocks/kvrocks/build/kvrocks -cliPath=redis-cli -workspace=/Users/runner/work/kvrocks/kvrocks/tests/gocase/workspace
Traceback (most recent call last):
  File ""/Users/runner/work/kvrocks/kvrocks/./x.py"", line 422, in <module>
    args.func(**arg_dict)
  File ""/Users/runner/work/kvrocks/kvrocks/./x.py"", line 293, in test_go
    run(go, *args, cwd=str(basedir), verbose=True)
  File ""/Users/runner/work/kvrocks/kvrocks/./x.py"", line 68, in run
    raise RuntimeError(err)
RuntimeError: 
failed to run: ('/Users/runner/hostedtoolcache/go/1.19.10/x64/bin/go', 'test', '-timeout=1800s', '-bench=.', './...', '-binPath=/Users/runner/work/kvrocks/kvrocks/build/kvrocks', '-cliPath=redis-cli', '-workspace=/Users/runner/work/kvrocks/kvrocks/tests/gocase/workspace')
exit with code: 1
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jk0I5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jk6yO,kvrocks,1670622350,1647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-09T04:08:53Z,2023-08-09T04:08:53Z,Thanks @enjoy-binbin for helping to paste the detail information.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jk6yO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1647,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jk8CO,kvrocks,1670627470,1647,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-09T04:18:18Z,2023-08-09T04:18:18Z,"After reading the Go `timer.Stop` documentation, the second issue it's caused by timer.Stop won't wait for the timer routine if the time was expired. Let me fix them together later.
```
// For a timer created with AfterFunc(d, f), if t.Stop returns false, then the timer
// has already expired and the function f has been started in its own goroutine;
// Stop does not wait for f to complete before returning.
// If the caller needs to know whether f is completed, it must coordinate
// with f explicitly.
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jk8CO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1648,https://api.github.com/repos/apache/kvrocks/issues/1648,kvrocks,1838845352,1648,Add the support of the RESTORE command,taiheyp,141613468,,,CLOSED,2023-08-07T07:21:17Z,2023-08-28T03:21:52Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [DUMP](https://redis.io/commands/dump/) / [RESTORE](https://redis.io/commands/restore/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1648/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1648,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jYXO9,kvrocks,1667331005,1648,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-07T07:26:10Z,2023-08-07T07:26:10Z,"Hi @taiheyp, thanks for your report. Will add it to our community roadmap and update you if have any progress.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jYXO9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1651,https://api.github.com/repos/apache/kvrocks/issues/1651,kvrocks,1841256128,1651,Add/delete repeated members will result in incorrect metadata in zset/set/hash types,ChrisZMF,18628342,,,CLOSED,2023-08-08T12:51:42Z,2023-08-11T23:19:07Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

OS: macOS 12.1
kvrocks branch: unstable
commitID: 60bcc3fac32d0df45e9a06ca0616d9d8d36fa579

### Minimal reproduce step

1. Execute `sadd` with multiple members including repetition. 
`sadd skey m1 m1 m2 m3`
2. Execute `srem` on the same way. 
`srem skey m1 m1`
3. Check the result of `sadd/srem` and check metadata of key `skey` with `scard`. 
`scard skey`

### What did you expect to see?

The result that execute `sadd` on redis
![image](https://github.com/apache/kvrocks/assets/18628342/3d50a95b-4c44-41b6-9723-fceb5289734e)

The result that execute `srem` on redis
![image](https://github.com/apache/kvrocks/assets/18628342/7d38279e-c153-4a00-87cd-fc3625d584ec)


### What did you see instead?

Add members with repetition into a set key
![image](https://github.com/apache/kvrocks/assets/18628342/72e6f53d-b5b3-4108-90f5-9b88bfa077de)
![image](https://github.com/apache/kvrocks/assets/18628342/afdc7baf-2e8f-46ee-8180-5d3f661d6f79)

Remove members with repetition
![image](https://github.com/apache/kvrocks/assets/18628342/1f56bd11-eeec-4b23-b784-8cd45d96e04c)

As shown above, the repetitions members can't be filtered in `sadd/srem` commands, which will result in wrong metadata.

### Anything Else?

This bug is also existing in `zrem/hset/hmset/hdel`.
Using `zrem` as an example, if `zrem` is executed with repeated members, `zcard/zcount` will get inconsistent results.
![image](https://github.com/apache/kvrocks/assets/18628342/a98cfa9b-5108-4a36-87a5-73ee6290f3e8)


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1651/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1658,https://api.github.com/repos/apache/kvrocks/issues/1658,kvrocks,1843125520,1658,Optimize the implementation of command RANDOMKEY,PragmaTwice,20042607,Twice,,OPEN,2023-08-09T12:23:24Z,2023-09-20T04:33:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently the result key of command RANDOMKEY is not randomized enough, so we'd better do some research and optimize it.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1658/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5js_UB,kvrocks,1672738049,1658,NA,Yangsx-1,85615957,Hauru,,NA,2023-08-10T07:52:53Z,2023-08-10T07:52:53Z,I'll try this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5js_UB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jtBFa,kvrocks,1672745306,1658,NA,torwig,8588372,Yaroslav,,NA,2023-08-10T07:58:10Z,2023-08-10T07:58:10Z,@Yangsx-1 Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jtBFa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m0Oll,kvrocks,1724967269,1658,NA,Yangsx-1,85615957,Hauru,,NA,2023-09-19T07:25:30Z,2023-09-19T07:25:30Z,"Can we add a random_scan function?
This function will select the key at random intervals during the scan, after scan we can randomly select keys from the scan result. This may be more random. @PragmaTwice @git-hulk @torwig ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m0Oll/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m7jM-,kvrocks,1726886718,1658,NA,PragmaTwice,20042607,Twice,,NA,2023-09-20T03:54:26Z,2023-09-20T03:54:26Z,"Could you give more detailed design of it? I cannot get your point well.

Besides, I think one possible way is to add more random cursors, and select one of them each time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m7jM-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1658,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m7zL2,kvrocks,1726952182,1658,NA,Yangsx-1,85615957,Hauru,,NA,2023-09-20T04:33:58Z,2023-09-20T04:33:58Z,"
> Could you give more detailed design of it? I cannot get your point well.
> 
> Besides, I think one possible way is to add more random cursors, and select one of them each time.

Oh, i mean, we can add a random interval in the iteration of scaning.

For example, the scan result may be 1 2 3 4 5 6 now, after add a random interval, the result may be 1 3 6 9 10 12 rather than pure sequential scanning. And we can select a key from the result of random scan.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m7zL2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1659,https://api.github.com/repos/apache/kvrocks/issues/1659,kvrocks,1844708228,1659,SISMEMBER behaviour differs from redis,Rafiot,248875,Raphaël Vinot,,CLOSED,2023-08-10T08:45:28Z,2023-08-11T09:54:48Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Ubuntu 23.04

kvrocks 2.4 and 2.5

### Minimal reproduce step

`SISMEMBER foo bar` (if `foo` doesn't exist)

### What did you expect to see?

0 (as redis does: https://redis.io/commands/sismember/):

```
127.0.0.1:6379> SISMEMBER foo bar 
(integer) 0
```

### What did you see instead?

```
127.0.0.1:6666> SISMEMBER foo bar 
(error) ERR NotFound: 
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1659/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1659,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jtR71,kvrocks,1672814325,1659,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-10T08:47:00Z,2023-08-10T08:47:00Z,@Rafiot Thanks for your report.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jtR71/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1659,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jzp81,kvrocks,1674485557,1659,NA,Rafiot,248875,Raphaël Vinot,,NA,2023-08-11T09:54:48Z,2023-08-11T09:54:48Z,Thanks!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5jzp81/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1662,https://api.github.com/repos/apache/kvrocks/issues/1662,kvrocks,1845137149,1662,CMake compiler check random failure in GCC TSAN CI,PragmaTwice,20042607,Twice,,CLOSED,2023-08-10T12:56:39Z,2023-09-28T08:06:03Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/apache/kvrocks/actions/runs/5819255897/job/15782518129?pr=1661

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1662/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1662,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5juw4F,kvrocks,1673203205,1662,NA,PragmaTwice,20042607,Twice,,NA,2023-08-10T13:17:44Z,2023-08-10T13:17:44Z,"It is weird, since the compiler check procedure is not related to the kvrocks code.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5juw4F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1665,https://api.github.com/repos/apache/kvrocks/issues/1665,kvrocks,1845918528,1665,Make default value of config option in kvrocks.conf and config.cc identical,PragmaTwice,20042607,Twice,,OPEN,2023-08-10T21:23:38Z,2024-05-11T16:13:31Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently it is not same for some option value.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1665/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1665,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5j8F4E,kvrocks,1676697092,1665,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-14T05:23:16Z,2023-08-14T05:23:16Z,Resolved by https://github.com/apache/kvrocks/pull/1664 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5j8F4E/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1665,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59hias,kvrocks,2105943724,1665,NA,PragmaTwice,20042607,Twice,,NA,2024-05-11T16:13:30Z,2024-05-11T16:13:30Z,"> Resolved by #1664

I don't think so.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59hias/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1679,https://api.github.com/repos/apache/kvrocks/issues/1679,kvrocks,1853573293,1679,Flaky test in migration sync timeout,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-08-16T16:33:39Z,2023-08-18T15:03:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

None

### What did you expect to see?

Go tests are green

### What did you see instead?

```
--- FAIL: TestSlotMigrateSync (44.63s)
    --- FAIL: TestSlotMigrateSync/MIGRATE_-_Migrate_sync_with_(or_without)_all_kinds_of_timeouts (0.01s)
        slotmigrate_test.go:477: 
            	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/slotmigrate/slotmigrate_test.go:477
            	Error:      	Received unexpected error:
            	            	ERR There is already a migrating slot
            	Test:       	TestSlotMigrateSync/MIGRATE_-_Migrate_sync_with_(or_without)_all_kinds_of_timeouts
            	Messages:   	with timeout: 30
FAIL
exit status 1
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1679/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1692,https://api.github.com/repos/apache/kvrocks/issues/1692,kvrocks,1862977671,1692,Kvrocks can't guarantee atomicity for multiple keys commands,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,CLOSED,2023-08-23T09:49:46Z,2023-09-04T07:41:48Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

In kvrocks, for multiple keys commands, we may break atomicity.
such as `SDIFF、SUNIONSTORE、SINTERSTORE、SDIFFSTORE、ZUNIONSTORE、ZINTERSTORE`

For `SDIFFSTORE destination key1 [key2 ...]` command, kvrocks will read key1, key2 ... orderly without any lock, and then restore the diff into destination key. So maybe some keys may be changed when we read them orderly, that breaks atomicity but redis can guarantee atomicity.

Thank you @oranagra reports this.

### Solution

Now we have `MultiLockGuard`, i think it is easy to fix this.  We can lock these keys before we read or write, so it is impossible to change these keys.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1692/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1692,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ktrc_,kvrocks,1689696063,1692,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-08-23T10:19:09Z,2023-08-23T10:19:09Z,"I noticed this earlier, since i worked on #1596 and #1634, but forgot to follow up.
it is good that oran mention it again, i will work on it and check all commands.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ktrc_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1692,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kyUX7,kvrocks,1690912251,1692,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-08-24T02:52:41Z,2023-08-24T02:52:41Z,"> In kvrocks, for multiple keys commands, we may break atomicity.
such as SDIFF、SUNIONSTORE、SINTERSTORE、SDIFFSTORE、ZUNIONSTORE、ZINTERSTORE

Does SDIFF/SUNION/SINTER/SDIFF/ZUNION/ZINTER need support?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5kyUX7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1692,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lIcMI,kvrocks,1696711432,1692,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2023-08-29T03:24:39Z,2023-08-29T03:24:39Z,"does #1700 fix all multiple keys commands, do you check?

the below all are covered?

`DEL、SORT、MGET、MSET、BITOP、EXISTS、MSETNX、RENAME、 RENAMENX、BLPOP、BRPOP、RPOPLPUSH、BRPOPLPUSH、SMOVE、SUNION、SINTER、SDIFF、SUNIONSTORE、SINTERSTORE、SDIFFSTORE、ZUNIONSTORE、ZINTERSTORE、 PFMERGE、PFCOUNT`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lIcMI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1692,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lIgv4,kvrocks,1696730104,1692,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-08-29T03:59:17Z,2023-08-29T03:59:17Z,"> does https://github.com/apache/kvrocks/pull/1700 fix all multiple keys commands, do you check?

no it doesn't. i checked roughly and #1700 only handles set/zset related set multi key operations.

For these commands you mentions:
- DEL or UNLINK now is a loop that del each key, we need to change it to batch write in the future.
- These commands are not yet supported by kvrocks: SORT / RENAME / RENAMENX / BRPOPLPUSH / PFMERGE / PFCOUNT
- These commands i think are ok (or are covered): MSET / RPOPLPUSH / SMOVE / SUNION / SINTER / SDIFF / SUNIONSTORE / SINTERSTORE / SDIFFSTORE / ZUNIONSTORE / ZINTERSTORE

so for commands like MGET / EXISTS, do we also need to lock all the keys? i am not familiar with BITOP, i will check it later","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lIgv4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1692,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lIhge,kvrocks,1696733214,1692,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-29T04:04:33Z,2023-08-29T04:04:33Z,"> so for commands like MGET / EXISTS, do we also need to lock all the keys?

I think it's unnecessary since we're using the snapshot.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lIhge/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1692,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lJbNM,kvrocks,1696969548,1692,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2023-08-29T08:09:03Z,2023-08-29T08:09:03Z,"Yes, it is ok for MGET / EXISTS command.

so we just need to fix `DEL, UNLINK `?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lJbNM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1692,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lJb3t,kvrocks,1696972269,1692,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2023-08-29T08:10:59Z,2023-08-29T08:10:59Z,let's reopen it since there are some remaining things,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lJb3t/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1692,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lJgA5,kvrocks,1696989241,1692,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2023-08-29T08:22:44Z,2023-08-29T08:22:44Z,"> so we just need to fix DEL, UNLINK ?

yep, i think so, i will find some times to fix it","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lJgA5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1696,https://api.github.com/repos/apache/kvrocks/issues/1696,kvrocks,1864892822,1696,[OSPP] Tracking issues: RedisBloom support,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2023-08-24T10:47:49Z,2024-04-18T05:27:44Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently we intent to support RedisBloom. We separate the task into some subtasks:

1. [x] Support a BloomFilter ( https://github.com/apache/kvrocks/pull/1693 )
2. [x] Support basic `BF.RESERVE`, `BF.ADD`, `BF.EXISTS`.  This is a bit complex, it need to design the structure and metadata of BloomFilter. For simplicity, we can briefly implement only `NOSCALING` first ( https://github.com/apache/kvrocks/pull/1699 )
3. [x] If we only support ""EXPANSION"" in (2), we need to support ""SCALING"" ( https://github.com/apache/kvrocks/pull/1721 )
4. [ ] Support Slot migrations
5. [x] Support `BF.CARD` ( https://github.com/apache/kvrocks/pull/1756 )
6. [x] Support `BF.INFO` ( https://github.com/apache/kvrocks/pull/1710 )
7. [x] Support `BF.MADD`  ( https://github.com/apache/kvrocks/pull/1758 )
8. [x] Support `BF.INSERT`
9. [x] Support `BF.MEXIST` ( https://github.com/apache/kvrocks/pull/1756 )

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1696/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1696,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5k0XQP,kvrocks,1691448335,1696,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-08-24T10:48:06Z,2023-08-24T10:48:06Z,cc @zncleon ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5k0XQP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1696,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5k3hxe,kvrocks,1692277854,1696,NA,zncleon,83486574,Leo,,NA,2023-08-24T19:20:41Z,2023-08-24T19:20:41Z,"thx a lot, I will commit PRs later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5k3hxe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1696,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM569z7n,kvrocks,2063023847,1696,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-18T05:23:15Z,2024-04-18T05:23:15Z,@mapleFU Guess we can close this issue now.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM569z7n/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1711,https://api.github.com/repos/apache/kvrocks/issues/1711,kvrocks,1873060199,1711,Change the default value of max-io-mb to 0(unlimited),git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-08-30T07:08:50Z,2023-08-30T12:00:08Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

For now, the max-io-mb is 500MiB which may be too low for fast devices like NVMe SSD,
so it'd be better to set the io bandwidth to unlimited by default.

See: https://github.com/apache/kvrocks/blob/unstable/kvrocks.conf#L278

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1711/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1711,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lQKaK,kvrocks,1698735754,1711,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-08-30T08:36:27Z,2023-08-30T08:36:27Z,"AFAIK, this config will not only impact the IO, it also impact the CPU, because compaction might consume some CPU quota.

TiKV has a default set and doc: https://github.com/tikv/tikv/blob/fb9a40d20dcfb9ceb7cecba9d471fa8575c05913/etc/config-template.toml#L593-L611 . And it's default 10GiB ( see https://docs.pingcap.com/tidb/stable/tikv-configuration-file#rate-bytes-per-sec )

Seems that we should testing on this? ( But set to 0 is ok to me on most cases )","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lQKaK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1711,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lQN98,kvrocks,1698750332,1711,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-08-30T08:45:35Z,2023-08-30T08:45:35Z,@mapleFU Thanks for your input. I feel it's a bit hard to test since depends on the device bandwidth.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lQN98/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1711,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lQRTp,kvrocks,1698764009,1711,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-08-30T08:53:39Z,2023-08-30T08:53:39Z,"> Thanks for your input. I feel it's a bit hard to test since depends on the device bandwidth.

Since we enable auto-tune by default( https://github.com/apache/kvrocks/pull/1424/files ), I think set to 0 when auto tuning is ok to me . Otherwise, we might need to tell our users about that :-)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lQRTp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1714,https://api.github.com/repos/apache/kvrocks/issues/1714,kvrocks,1873322519,1714,Flaky test in test_bitmap,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-08-30T09:45:09Z,2023-09-02T17:20:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

None

### What did you expect to see?

CI passed

### What did you see instead?

https://github.com/apache/kvrocks/actions/runs/6022417563/job/16337618318?pr=1713#step:12:104

```
--- FAIL: TestBitmap (224.27s)
    --- FAIL: TestBitmap/BITOP_NOT_fuzzing (2.15s)
        bitmap_test.go:233: 
            	Error Trace:	/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:233
            	Error:      	Not equal: 
            	            	expected: ""<R<Y\x87\xb0<F<_=A\xc2<t=I\xf4<y\xbb<E\xc8\xff\xe6=Y\xb3\xe2<F=]\xcd\xfa<Z<A<}\xd1\xc1=Z\xf5<w\x89<|=v=j=e<^=a<G<}=]<|\xf9<X<r\x9d\x81<u\xbb\xca=n<y=_=x\xa5=U\xce<N\xdf\xc5<d=b<Z<I\xf8\x84\xac<T=@=x=J\xe7\xa5<~=c=J=|\xf8<K=A\xf4\xe1=Q<d\xe0\xca<g\xa3\x8e<Q<l\xa0=W<h=^\xa2=v=d<u\x94\xc2=H<D=[\x9c=v\xfa\xfd=Y<U\x9c<Xዹ<G\xff<X=E\xdc\xc8\xd3\xdb=X<d=b\x82\xfa=x\x8a=|\xe8\x83<`\xcc\xc7\xedˆ\x89\xdd̴<T=|\xe4ս=[=@\xb6=_=A=`<Z\x9b\xff\x94=j=J=P<z<~Л=I=T\xac<Xԝ<~\xaa<s=F=Z\xa4=b\xa2\xa9=Y=|\xc5\xd5<Z=Q<t\xf5<c\x87=g=Y<Yٓ\x8d\xbf\x94<{=]\xf9\xaf\xcd=s<x=k=y<y<x\x8f\xe1\xe4\xce=o=c<F\xae\xc7<|<T=k\xce<D<M\x8e\xa8=E\x88=c=s=p<|\xf7<H<g=wп=W\xa4\xd5<h\xb3=E\xb5\xee=M=V=}\xb2<s\xb1=f=A<Y\xb0\xea<a=i\x9c<q<G=K\xca=c<_\xf3\xe4\xd8=H<o\xa0<U\xa0\x81\x96=v=S=X\xc0<z\x86\xb6<`\x9b\xc7=L\xd7<f=@\xe6\xd3=B\xe2\xa0<N\x8f\xdb<`=]=s<h<f=V\x8e\xf3=\x7f\x9f<~=y\x81<d=g=W=P=Y<C\xe7<h<@=@\xa7<E\xc4<c<]\xb8<X\xe4\xc5<q\x87<o\xa7<N=`=|\xbc\xbe\xb8<B=C=O=tĹ\xbd=Y\xb8<w¹\xfa\xff\x82\xc3=r\xcf=w<J\xef\xf2\xc2=b<O\xc8\xe0\xfb<B<A\xe5\x96=V<P<v=K=Q=k=H\xb9=d\xa0=k=A\x90<F\x8b=\x7f=x\xf6=t\xf5=o\x9c<{<V=x=Y\x84<d\xae\x85\xab\xb3\xd0=q=E\xbc<[衡\xfa\xb7=y\x9c<z\xa0<S\xaf\xa4ĩ\x83\xdd\xf9=R=\x7f=j=[=h\xe1=O\xd0\xff\xa6\xf0\x86=\x7f\xf5<Z\xde\xf6\xd0<c=n<}=\\<E\xb5\xff\xb4\xab\xc4=r<P\xf0\xb0\xebʸ<T<@=Z<@\xef\xf6<p=C\xc9=`<L\x98=n\xa4<G\x9a<@\xe0<T\xd4=g=I\x96<{\x9b=]<f<~=r\x84\x97<y<x\xcc\xc8<R=G\xa2\xae\xad<e=s<n\xca\xda<j\xa3<U=b\xb6\xf3\xa4ɭ\xc1<d\xe0=a\xed=F\xd2\xda=T=y=R<i=m\xb2<c<l\xbf<Y=z\xa3\x87<Y=P=j=R\xa1\xca=E<q\x84=s\x9e\x9c<\\\x96<C=w\xc6<r=m\xcc=g\xb9<E=~\x9a\xc0ܹ<m\xb2<V\xa1\xb1\xc5<Gȁ=R=t=N=T\xea\xeb\xc2<T=u=N\xd8<K\xdc\xd6=p=d\x92<U<~\xa6<^װ=K\xb9=[<[\x85<E\xca<_<N\xe6\xba<g\xe7<m\xc3\xdd\xfa\xc4=x\x98=h\xfe=u\xc2<a\xb7<]<[=m\xdc<Fߐ=m\xe9=x=G\xc1\xb4<]=W=G=Q<]=r=l=f<D\xf8=^=M\x94\x88=K\x84=z=W\xe5\xd6<f<L\xfe<\x7f\xea\xf7<^=L=C<C=N=a""
            	            	actual  : ""\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00""
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1714/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1714,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ljdfo,kvrocks,1703794664,1714,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-02T10:43:19Z,2023-09-02T10:43:19Z,"This failure seems to first appear at https://github.com/apache/kvrocks/actions/runs/5934636183/job/16092138805, but it should not related to the change. I still don't have any idea why it happens.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ljdfo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1714,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ljew0,kvrocks,1703799860,1714,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-09-02T10:54:32Z,2023-09-02T10:54:32Z,"@git-hulk I didn't look it carefully, but seems that it's a fuzz test. Maybe we can record the seed first, rather than using a `rand.New(rand.NewSource(time.Now().UnixNano()))` wo reporting the seed number","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ljew0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1714,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ljgyr,kvrocks,1703808171,1714,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-09-02T11:38:04Z,2023-09-02T11:38:04Z,"I've reproduce the test in my local pc. However, test is still unstable with same random string 🤔","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ljgyr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1714,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ljhyk,kvrocks,1703812260,1714,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-09-02T11:52:29Z,2023-09-02T11:52:29Z,@git-hulk https://github.com/apache/kvrocks/pull/1727 this can stably reproduce the problem in my machine,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ljhyk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1715,https://api.github.com/repos/apache/kvrocks/issues/1715,kvrocks,1873486375,1715,We may have the deadlock in ZSet::InterStore(as well as other similar APIs),git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-08-30T11:32:35Z,2023-09-03T10:12:52Z,"We may have the deadlock in ZSet::InterStore(as well as other similar APIs) if the dst key was inside the source key list since the OverWrite function will also lock the dst key: https://github.com/apache/kvrocks/blob/unstable/src/types/redis_zset.cc#L635 

This issue was found by TSAN in CI: https://github.com/apache/kvrocks/actions/runs/6022265431/job/16338859035?pr=1712

_Originally posted by @git-hulk in https://github.com/apache/kvrocks/issues/1712#issuecomment-1698893367_
            ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1715/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1720,https://api.github.com/repos/apache/kvrocks/issues/1720,kvrocks,1875035542,1720,Allow to propagate namespace and tokens from master to slaves,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-08-31T08:25:53Z,2023-10-09T06:15:53Z,"### Discussed in https://github.com/apache/kvrocks/discussions/1719

## Background

Currently, Kvrocks won't propagate the namespace and token between master and slaves, and it may cause trouble if users add them in master but missing in slaves. So it would make this process easier if we could propagate the namespace/token as well.


## Design

To implement this feature, we need to consider the following situations:

- How to replicate namespaces between the master and slaves
- How to be compatible with old versions

**For the replication:**

We now have the propagate column family to propagate commands between the master and slaves, so we can use it to replicate namespaces as well. The steps are like below:

1. Modify namespace/token in master(forbid changing in slaves)
2. Propagate the namespace event to notify slaves like the Lua script
3. Slaves replay namespace/token changes

This works well for new instances, but what if there are different namespaces between the master and slaves in old instances?  There are three possible conditions:

1. Namespace/token exists in master but NOT in slave
2. Namespace exists in slave but NOT in master
3. Namespace exists both in master and slave, but the token is different

For condition 1, we can add the namespace/token to the slave as well. For condition 2, it makes sense to keep the namespace NOT existing in the master since data are from it, so we can remove the namespace/token. The most troublesome condition is 3 since users may have already used the token to access the data, changing the token would cause an invalid password error. **To make this simple, I prefer also overwriting the token.** And offer the configuration to allow users to enable or disable this feature, they MUST understand the risks before enabling.

To be noticed, we don't expect to propagate the default namespace since it may affect the replication part, so we won't persist the default namespace.

**For the compatible issue:**

Currently, namespaces are kept in the configuration file, so we need to read from the rocksdb first(store in propagate column like Lua script) when starting:

- If the key exists in rocksdb, load namespace/token from rocksdb and check if any namespace/token is inside the configuration file. If yes, refuse to start the server and ask users to remove them and add them via the `namespace add` command.
- If the key does NOT exist in rocksdb, read namespace/token from the configuration file and write them into rocksdb. To be noticed, we need to add an empty value for the key even though no namespace/token.

Users can only modify the namespace via command if this feature is enabled.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1720/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/1722,kvrocks,1876665429,1722,Support `Get` with `rocksdb::PinnableSlice` to decrease copy for BLOB,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2023-09-01T03:44:56Z,2023-11-26T04:04:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

RocksDB has support Get with `PinnableSlice` [1][2], and it's already used in `MultiGet` in our kvrocks[3]. For most of our objects, they're small object. So this might not get any benefits. However, as for type like Bitmap, BloomFilter. This could avoid copying memory.

[1] https://rocksdb.org/blog/2017/08/24/pinnableslice.html
[2] https://github.com/facebook/rocksdb/blob/main/include/rocksdb/db.h
[3] https://github.com/apache/kvrocks/blob/e2baeb1b2cdeb480d02b74d4eff23f2c418bc3e7/src/storage/storage.h#L109

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1722/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ldDR6,kvrocks,1702114426,1722,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-09-01T03:45:22Z,2023-09-01T03:45:22Z,"@zncleon Would you like to support this? Since this can benefit the performance of BloomFilter.

A benchmark would better also be support here to verify that it really optimize our system.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ldDR6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ldI8P,kvrocks,1702137615,1722,NA,zncleon,83486574,Leo,,NA,2023-09-01T04:24:57Z,2023-09-01T04:24:57Z,"Sure, I am willing to support this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ldI8P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ldMEb,kvrocks,1702150427,1722,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-09-01T04:45:13Z,2023-09-01T04:45:13Z,"Also cc @PragmaTwice @git-hulk , can we import google benchmark ( https://github.com/google/benchmark ) as a tool, and use it to do some micro benchmark? ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ldMEb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ldtbB,kvrocks,1702287041,1722,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-01T07:18:33Z,2023-09-01T07:18:33Z,"Yes, that's great if we can do it regularly or in CI.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ldtbB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lkOHo,kvrocks,1703993832,1722,NA,PragmaTwice,20042607,Twice,,NA,2023-09-03T03:01:05Z,2023-09-03T03:01:05Z,"> Also cc @PragmaTwice @git-hulk , can we import google benchmark ( https://github.com/google/benchmark ) as a tool, and use it to do some micro benchmark?

Sure.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lkOHo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l2kin,kvrocks,1708804263,1722,NA,ameya-deshmukh,74180822,Ameya Deshmukh,ad@seismic.systems,NA,2023-09-06T17:25:17Z,2023-09-06T17:25:17Z,@zncleon can I take this up if you don't have the bandwidth? I am a first time contributor to the repo and this seems right up my alley.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l2kin/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l5RbF,kvrocks,1709512389,1722,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-09-07T05:45:26Z,2023-09-07T05:45:26Z,Would you still want work on this @zncleon ?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l5RbF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l5yRt,kvrocks,1709646957,1722,NA,zncleon,83486574,Leo,,NA,2023-09-07T07:49:12Z,2023-09-07T07:49:12Z,"> @zncleon can I take this up if you don't have the bandwidth? I am a first time contributor to the repo and this seems right up my alley.

OK, you can take this up.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l5yRt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mEinv,kvrocks,1712466415,1722,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-09-09T09:19:11Z,2023-09-09T09:19:11Z,@ameya-deshmukh You can finish the patch and at me for review :-),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mEinv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5osaRx,kvrocks,1756472433,1722,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-10-10T23:46:26Z,2023-10-10T23:46:26Z,Hello @mapleFU is this task still available to do? If so I'd like to take this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5osaRx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5os84U,kvrocks,1756614164,1722,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-11T01:57:02Z,2023-10-11T01:57:02Z,@mapleFU Thanks for your interest! I assigned it to you since no one is working on this issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5os84U/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5otAZa,kvrocks,1756628570,1722,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-10-11T02:18:21Z,2023-10-11T02:18:21Z,"@chrisxu333 Just go ahead, finishing this need to support Get with `rocksdb::PinnableSlice` in `Storage`.

When you finish this, you can try to write a benchmark, and tell use what's the BLOB size that `Get` with `rocksdb::PinnableSlice` would be faster.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5otAZa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5otGED,kvrocks,1756651779,1722,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-10-11T02:32:55Z,2023-10-11T02:32:55Z,@mapleFU Sounds good I'll go ahead and do it.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5otGED/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5otJPT,kvrocks,1756664787,1722,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-10-11T02:46:31Z,2023-10-11T02:46:31Z,Yes you can @ me if you finished or need any help.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5otJPT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5o6s4v,kvrocks,1760218671,1722,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-10-12T19:05:53Z,2023-10-12T19:05:53Z,"@mapleFU I just finished supporting Get with PinnableSlice. Since you also mentioned writing a benchmark, do you mean using the Google benchmark mentioned previously in this thread? Or something else?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5o6s4v/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pcZwk,kvrocks,1769053220,1722,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-10-18T17:52:59Z,2023-10-18T17:52:59Z,"@chrisxu333 Sorry for late replying, I've too many mails so I forget to check this issue. T_T

You can use google benchmark to test. Though testing RocksDB(including disk io) with google-benchmark looks weird, I think the performance benifits of `rocksdb::PinnableSlice` is avoid copying in memory rather than disk io, so we can assume that all data is in memory during benchmarking. We can test the data in memtable or on sst, if the data is in memtable, just calling different `Get` is ok. And if the data is in SSTable, you can just try to Get the data first to make sure it's loaded in block cache or memtable, then calling `Get`

If introducing googlebenchmark would be heavy, you can try to write a script to testing and paste the result here. So that we can know whether the `Get` with `PinnableSlice` can benefit `BloomFilter` and `Bitmap` types in kvrocks. And you can submit the patch without the benchmark code for convenience.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pcZwk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rkqXR,kvrocks,1804772817,1722,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-11-09T22:19:07Z,2023-11-09T22:19:07Z,"@mapleFU Sorry I was also busy on other stuff :( I just submitted the patch without benchmark code for reference. 

For the benchmark part, are you saying testing on the raw rocksdb api in the storage class, or on a higher level where we manipulate bloomfilter and bitmap type? :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rkqXR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sBSs2,kvrocks,1812278070,1722,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-11-15T10:57:12Z,2023-11-15T10:57:12Z,"> For the benchmark part, are you saying testing on the raw rocksdb api in the storage class, or on a higher level where we manipulate bloomfilter and bitmap type? :)

I think raw test is ok. Because we know the pattern here:
1. BITMAP: usally one or multiple 8KiB value
2. BloomFilter: might greater than 8KiB, but will not too large

Maybe testing from 8KiB, 16KiB and 64KiB is ok.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sBSs2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sNn0g,kvrocks,1815510304,1722,NA,chrisxu333,44099579,Nuo Xu,,NA,2023-11-16T23:51:03Z,2023-11-16T23:51:03Z,"> I think raw test is ok. Because we know the pattern here:
> 
> 1. BITMAP: usally one or multiple 8KiB value
> 2. BloomFilter: might greater than 8KiB, but will not too large
> 
> Maybe testing from 8KiB, 16KiB and 64KiB is ok.

Sounds good. I just did some testing using my script on the raw storage api. Here is the result.

<img src=""https://github.com/apache/kvrocks/assets/44099579/86a61c9d-ab5c-4b93-ab34-25689793ab7a"" width=""500"">

<img src=""https://github.com/apache/kvrocks/assets/44099579/5b1346bf-c4dd-4e8e-97a3-339843e55fa5"" width=""500"">

P.S. These execution times are averaged among multiple `get()` calls. We could see the speedup is increasing as the size of value increases, which is what we want :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sNn0g/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sOJZQ,kvrocks,1815647824,1722,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-11-17T02:22:26Z,2023-11-17T02:22:26Z,Great! Also cc @git-hulk @PragmaTwice ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sOJZQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1722,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sORhH,kvrocks,1815681095,1722,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-17T03:11:54Z,2023-11-17T03:11:54Z,Looks good. Seems the pinnable slice won't bring any side effects.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sORhH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1728,https://api.github.com/repos/apache/kvrocks/issues/1728,kvrocks,1878933672,1728,Large amount of failure of TestNamespace/Concurrent_creating_namespaces in CI,PragmaTwice,20042607,Twice,,CLOSED,2023-09-03T04:46:37Z,2023-09-03T09:15:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/actions/runs/6062050794/job/16447962006?pr=1712
https://github.com/apache/kvrocks/actions/runs/6062030374/job/16447930241?pr=1630
https://github.com/apache/kvrocks/actions/runs/6062030374/job/16447930290?pr=1630
...

cc @git-hulk 

### What did you expect to see?

-

### What did you see instead?

-

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1728/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1728,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lkRNA,kvrocks,1704006464,1728,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-03T04:52:43Z,2023-09-03T04:52:43Z,It may be related to #1727 which changed the random string.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lkRNA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1728,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lkRPa,kvrocks,1704006618,1728,NA,PragmaTwice,20042607,Twice,,NA,2023-09-03T04:53:44Z,2023-09-03T04:53:44Z,"> It may be related to #1727 which changed the random string.

cc @mapleFU ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lkRPa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1730,https://api.github.com/repos/apache/kvrocks/issues/1730,kvrocks,1878937945,1730,Add support of the XGROUP CREATECONSUMER and DELCONSUMER,Yangsx-1,85615957,Hauru,,CLOSED,2023-09-03T05:10:23Z,2024-03-09T13:41:23Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue wants to implement [XGROUP CREATECONSUMER](https://redis.io/commands/xgroup-createconsumer/) and [XGROUP DELCONSUMER](https://redis.io/commands/xgroup-delconsumer/)

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1730/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1731,https://api.github.com/repos/apache/kvrocks/issues/1731,kvrocks,1878938574,1731,Add support of the XINFO GROUPS and CONSUMERS,Yangsx-1,85615957,Hauru,,CLOSED,2023-09-03T05:13:44Z,2023-11-12T08:48:01Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue wants to implement [XINFO GROUPS](https://redis.io/commands/xinfo-groups/) and [XINFO CONSUMERS](https://redis.io/commands/xinfo-consumers/)

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1731/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1732,https://api.github.com/repos/apache/kvrocks/issues/1732,kvrocks,1878939206,1732,Add support of the XACK command,Yangsx-1,85615957,Hauru,,CLOSED,2023-09-03T05:17:12Z,2024-03-15T00:45:47Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue wants to implement [XACK](https://redis.io/commands/xack/) command like redis.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1732/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1733,https://api.github.com/repos/apache/kvrocks/issues/1733,kvrocks,1878939614,1733,Add support of the XCLAIM command,Yangsx-1,85615957,Hauru,,CLOSED,2023-09-03T05:19:16Z,2024-05-13T09:53:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue wants to implement [XCLAIM](https://redis.io/commands/xclaim/) command like redis.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1733/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1733,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53e8q-,kvrocks,2004601534,1733,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2024-03-18T18:06:17Z,2024-03-18T18:06:17Z,"Hi @Yangsx-1 ! I want to work on the issue, can you please assign it to me? Thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53e8q-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1733,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53ipwq,kvrocks,2005572650,1733,NA,Yangsx-1,85615957,Hauru,,NA,2024-03-19T01:31:34Z,2024-03-19T01:31:34Z,"> Hi @Yangsx-1 ! I want to work on the issue, can you please assign it to me? Thank you!

Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53ipwq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1734,https://api.github.com/repos/apache/kvrocks/issues/1734,kvrocks,1878939937,1734,Add support of the XPENDING command,Yangsx-1,85615957,Hauru,,CLOSED,2023-09-03T05:21:12Z,2024-07-21T14:01:51Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue wants to implement [XPENDING](https://redis.io/commands/xpending/) command like redis.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1734/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1734,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53b2fH,kvrocks,2003789767,1734,NA,LiuYuHui,13926137,Yuhui Liu,,NA,2024-03-18T12:31:49Z,2024-03-18T12:31:49Z,"I will working on it, please assign it to me :D","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53b2fH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1734,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53b48o,kvrocks,2003799848,1734,NA,Yangsx-1,85615957,Hauru,,NA,2024-03-18T12:36:59Z,2024-03-18T12:36:59Z,"> I will working on it, please assign it to me :D

Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53b48o/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1735,https://api.github.com/repos/apache/kvrocks/issues/1735,kvrocks,1878940411,1735,Add support of the XGROUP SETID command,Yangsx-1,85615957,Hauru,,CLOSED,2023-09-03T05:23:29Z,2023-10-19T13:25:01Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue wants to implement [XGROUP SETID](https://redis.io/commands/xgroup-setid/) command like redis.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1735/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1736,https://api.github.com/repos/apache/kvrocks/issues/1736,kvrocks,1879135913,1736,slowlog support return more info,luger1990,2096878,Luger Smith,,CLOSED,2023-09-03T15:21:23Z,2023-09-06T16:13:33Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

from https://redis.io/commands/slowlog-get/ we can see, slowlog of redis suppprt return six values(Starting with Redis version 4.0.0: Added client IP address, port and name to the reply.):
1. A unique progressive identifier for every slow log entry.
2. The unix timestamp at which the logged command was processed.
3. The amount of time needed for its execution, in microseconds.
4. The array composing the arguments of the command.
5. Client IP address and port.
6. Client name if set via the [CLIENT SETNAME](https://redis.io/commands/client-setname) command.
but kvrocks only support first for values.

### Solution

add more info to slowlog cammand

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1736/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1736,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lmIC9,kvrocks,1704493245,1736,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-04T01:41:18Z,2023-09-04T01:41:18Z,@luger1990 Thanks for your suggestion.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lmIC9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1736,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lsCmX,kvrocks,1706043799,1736,NA,LiuYuHui,13926137,Yuhui Liu,,NA,2023-09-05T06:52:26Z,2023-09-05T06:52:26Z,"Hi @git-hulk , I want to work on it, could you please assign it to me?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lsCmX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1736,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lsDD3,kvrocks,1706045687,1736,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-05T06:54:02Z,2023-09-05T06:54:02Z,"Hi @LiuYuHui Thanks for your interest, assigned.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lsDD3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1736,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l2JMS,kvrocks,1708692242,1736,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-06T16:13:32Z,2023-09-06T16:13:32Z,Resolved by #1740 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5l2JMS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1742,https://api.github.com/repos/apache/kvrocks/issues/1742,kvrocks,1882761590,1742,Redis Trademark Violation,thallredis,103130095,Tim Hall,,CLOSED,2023-09-05T21:42:33Z,2023-09-06T07:35:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Current website and associated docs: https://kvrocks.apache.org/



### Minimal reproduce step

Have a look at the copyrights that you are currently acknowledging...all of the Apache Software Foundation related ones.


### What did you expect to see?

We would appreciate you acknowledging the Redis trademark as well as your own copyrights.

### What did you see instead?

Missing trademark attribution for the use of Redis.

### Anything Else?

Thank you in advance for addressing this in a timely manner.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1742/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1742,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lxXq-,kvrocks,1707440830,1742,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-09-05T23:32:48Z,2023-09-05T23:32:48Z,"Hi @thallredis,

Thanks for your reporting! We highly appreciate the work Redis does and https://github.com/apache/kvrocks-website/pull/153 includes a sentence to reflect Redis trademarks. Could you please check if the current status meets the related policy?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5lxXq-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1742,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ly1ZY,kvrocks,1707824728,1742,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-09-06T07:35:26Z,2023-09-06T07:35:26Z,Closed as resolved. Feel free to open a new issue if you find any other improvements.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ly1ZY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1753,https://api.github.com/repos/apache/kvrocks/issues/1753,kvrocks,1891593766,1753,Add the support of loading data from RDB file,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-09-12T03:16:22Z,2023-10-18T12:28:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

#1684 supports parsing serialized binary formats from Redis
which is also the key implementation of loading the Redis RDB file.
So after that, I think we can support loading data from the RDB file directly.

### Solution

Implement other parts of parsing the RDB file.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1753/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mW-T6,kvrocks,1717298426,1753,NA,xq2010,122602529,,,NA,2023-09-13T09:43:18Z,2023-09-13T09:43:18Z,I'm willing to submit a PR and will finish it next month.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mW-T6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mXO1L,kvrocks,1717366091,1753,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-13T10:28:36Z,2023-09-13T10:28:36Z,"@xq2010 Assigned, feel free to ask any questions if you need.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mXO1L/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ocmrg,kvrocks,1752328928,1753,NA,xq2010,122602529,,,NA,2023-10-09T04:26:10Z,2023-10-09T04:26:10Z,@git-hulk  There is a commit in this pr:https://github.com/apache/kvrocks/pull/1798,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ocmrg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1753,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5oc3FQ,kvrocks,1752396112,1753,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-09T06:11:22Z,2023-10-09T06:11:22Z,"> @git-hulk There is a commit in this pr:#1798

Thanks for your efforts!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5oc3FQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/1754,kvrocks,1891597733,1754,Allow Kvrocks to become a replica of Redis,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-09-12T03:22:17Z,2024-03-10T10:03:41Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

We would like to support parsing the RDB file in #1753
and after that, it'd be simple to support Kvrocks as a replica
of the Redis instance.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1754/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mzQol,kvrocks,1724713509,1754,NA,DMwangnima,33331974,Scout Wang,yuxuan.wang1@bytedance.com,NA,2023-09-19T01:49:58Z,2023-09-19T01:49:58Z,I am interested in this enhancement. And I'd be appreciated if I could try this assignment.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mzQol/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mzRKl,kvrocks,1724715685,1754,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-19T01:52:44Z,2023-09-19T01:52:44Z,"Hi @DMwangnima 

Thanks for your interest, assigned to you. But to be noticed, this would depend on issue #1753. But you can propose a solution if you don't mind.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mzRKl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mzRck,kvrocks,1724716836,1754,NA,DMwangnima,33331974,Scout Wang,yuxuan.wang1@bytedance.com,NA,2023-09-19T01:54:41Z,2023-09-19T01:54:41Z,Got it. I would do some preliminary preparations first.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mzRck/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mzRqk,kvrocks,1724717732,1754,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-19T01:56:14Z,2023-09-19T01:56:14Z,"> Got it. I would do some preliminary preparations first.

Thank you! Feel free to raise any discussion or question if you like.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mzRqk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pZt0h,kvrocks,1768348961,1754,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-18T12:28:54Z,2023-10-18T12:28:54Z,@DMwangnima You can go ahead since https://github.com/apache/kvrocks/issues/1753 has been merged.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pZt0h/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pwf6x,kvrocks,1774321329,1754,NA,DMwangnima,33331974,Scout Wang,yuxuan.wang1@bytedance.com,NA,2023-10-23T02:09:09Z,2023-10-23T02:09:09Z,@git-hulk I am so sorry that I can not proceed with this issue due to some emergency tasks from my supervisor. Maybe I can find another interesting issue after finishing my tasks.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pwf6x/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pwk9a,kvrocks,1774341978,1754,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-23T02:36:04Z,2023-10-23T02:36:04Z,"@DMwangnima Sure, thanks for your feedback.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pwk9a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52bzPn,kvrocks,1986999271,1754,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-03-09T22:40:32Z,2024-03-09T22:40:32Z,"Now, when we start kvrocks as replice of redis, this error we have:

```
I20240309 22:37:26.429916 72523 replication.cc:423] [replication] Check db name request was sent, waiting for response
E20240309 22:37:26.431612 72523 replication.cc:436] Failed to get the db name, -ERR unknown command '_db_name', with args beginning with:
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52bzPn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1754,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ccrK,kvrocks,1987168970,1754,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-10T10:03:40Z,2024-03-10T10:03:40Z,"@aleksraiden Yes, we don't support becoming as a Redis replica for now, so created this issue to track.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ccrK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1759,https://api.github.com/repos/apache/kvrocks/issues/1759,kvrocks,1899249068,1759,Flaky test in TLS replication,PragmaTwice,20042607,Twice,,OPEN,2023-09-16T01:35:40Z,2023-09-16T02:08:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/actions/runs/6159066781/job/16713576822
https://github.com/apache/kvrocks/actions/runs/6180335719/job/16776798127
https://github.com/apache/kvrocks/actions/runs/6155474342/job/16702713002


### What did you expect to see?

-

### What did you see instead?

-

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1759/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1759,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mpT_D,kvrocks,1722105795,1759,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-16T02:08:38Z,2023-09-16T02:08:38Z,"I'm investigating this, guess 5s may be too short for the TLS replication in CI.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5mpT_D/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1770,https://api.github.com/repos/apache/kvrocks/issues/1770,kvrocks,1904997884,1770,slices.Compact,Deleplace,13508141,Valentin Deleplace,deleplace2015@gmail.com,CLOSED,2023-09-20T13:25:53Z,2023-09-20T14:53:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Hello, while researching for [this Go proposal](https://github.com/golang/go/issues/62729) I noticed [4 occurrences](https://github.com/search?q=repo%3Aapache%2Fkvrocks%20slices.Compact&type=code) of this pattern:

```
slices.Compact(keys)
```

which doesn't do what it seems to do, and should look like this instead:

```
keys = slices.Compact(keys)
```

I have not tried to execute it.

### Minimal reproduce step

Look at https://github.com/search?q=repo%3Aapache%2Fkvrocks%20slices.Compact&type=code

### What did you expect to see?

keys = slices.Compact(keys)

### What did you see instead?

slices.Compact(keys)

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1770/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1770,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m-1c_,kvrocks,1727747903,1770,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-20T13:35:40Z,2023-09-20T13:35:40Z,"@Deleplace Thanks for your feedback, it's exactly a bug.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m-1c_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1770,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m_Y18,kvrocks,1727892860,1770,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-09-20T14:53:49Z,2023-09-20T14:53:49Z,@Deleplace Thanks for your reporting! It should be now fixed by #1771.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5m_Y18/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1778,https://api.github.com/repos/apache/kvrocks/issues/1778,kvrocks,1911180179,1778,CMake error during the build on Fedora 38,torwig,8588372,Yaroslav,,CLOSED,2023-09-25T10:31:01Z,2023-09-26T02:50:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.6.0-rc2

### Minimal reproduce step

Just run the `cmake` command.

### What did you expect to see?

Successful build.

### What did you see instead?

```
Fetching jsoncons...
CMake Deprecation Warning at /home/yaroslav/tests/kvrocks/2.6.0-rc/build/_deps/jsoncons-src/CMakeLists.txt:1 (cmake_minimum_required):
  Compatibility with CMake < 3.5 will be removed from a future version of
  CMake.

  Update the VERSION argument <min> value or use a ...<max> suffix to tell
  CMake that the project does not need compatibility with older versions.


-- jsoncons v0.171.0
CMake Error at cmake/xxhash.cmake:34 (add_subdirectory):
  add_subdirectory not given a binary directory but the given source
  directory
  ""/home/yaroslav/tests/kvrocks/2.6.0-rc/build/_deps/xxhash-src/cmake_unofficial""
  is not a subdirectory of
  ""/home/yaroslav/tests/kvrocks/2.6.0-rc/apache-kvrocks-2.6.0-src"".  When
  specifying an out-of-tree source a binary directory must be explicitly
  specified.
Call Stack (most recent call first):
  CMakeLists.txt:134 (include)


Fetching span...
-- Project 'span_lite', package 'span-lite' version: '0.10.3'
-- Configuring incomplete, errors occurred!
```


### Anything Else?

On my machine:

```
[yaroslav@localhost build]$ cmake --version
cmake version 3.27.4
```


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1778/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1783,https://api.github.com/repos/apache/kvrocks/issues/1783,kvrocks,1913153983,1783,OpenDAL's kvrocks tests failing after 2.6.0 released,Xuanwo,5351546,Xuanwo,github@xuanwo.io,CLOSED,2023-09-26T09:59:57Z,2023-09-26T12:48:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.6.0

### Minimal reproduce step

Fork https://github.com/apache/incubator-opendal and running it's kvrocks test

```yaml
  kvrocks:
    runs-on: ubuntu-latest
    services:
      redis:
        image: apache/kvrocks
        ports:
          - 6379:6666
    steps:
      - uses: actions/checkout@v3
      - name: Setup Rust toolchain
        uses: ./.github/actions/setup
        with:
          need-nextest: true
      - name: Test
        shell: bash
        working-directory: core
        run: cargo nextest run redis --features services-redis
        env:
          OPENDAL_REDIS_TEST: on
          OPENDAL_REDIS_ENDPOINT: tcp://127.0.0.1:6379
          OPENDAL_REDIS_ROOT: /
          OPENDAL_REDIS_DB: 0
```

### What did you expect to see?

Test pass (this test is stable until today)

### What did you see instead?

All operations returns `Broken Pipe`.

```shell
running 1 test
  2023-09-26T08:38:31.776841Z DEBUG opendal::services: service=redis operation=write path=bd4f0ac5-f137-43b5-a6fb-5a7f56993d1b -> started
    at core/src/layers/logging.rs:332

  2023-09-26T08:38:31.777030Z DEBUG opendal::services: service=redis operation=write path=bd4f0ac5-f137-43b5-a6fb-5a7f56993d1b -> start writing
    at core/src/layers/logging.rs:344

  2023-09-26T08:38:31.847986Z ERROR opendal::services: service=redis operation=Writer::close path=bd4f0ac5-f137-43b5-a6fb-5a7f56993d1b written=1870076B -> data close failed: Unexpected (temporary) at Writer::close => I/O error

Context:
   service: redis
   path: bd4f0ac5-f137-43b5-a6fb-5a7f56993d1b

Source:
   Broken pipe (os error 32)
```

![image](https://github.com/apache/kvrocks/assets/5351546/6e6fd386-fc3d-48f3-bbb3-c520e0dd4852)

https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618


### Anything Else?

The container itself seems healthy:

```shell
Starting redis service container
  /usr/bin/docker pull apache/kvrocks
  Using default tag: latest
  latest: Pulling from apache/kvrocks
  659d66d51139: Already exists
  71db16f278e5: Pulling fs layer
  8c9c88edd96f: Pulling fs layer
  d2d819887e11: Pulling fs layer
  ce4bbcf2858c: Pulling fs layer
  ba6086eed9cb: Pulling fs layer
  c3a89d94ffd9: Pulling fs layer
  ba6086eed9cb: Waiting
  c3a89d94ffd9: Waiting
  ce4bbcf2858c: Waiting
  8c9c88edd96f: Download complete
  71db16f278e5: Verifying Checksum
  71db16f278e5: Download complete
  d2d819887e11: Verifying Checksum
  d2d819887e11: Download complete
  71db16f278e5: Pull complete
  8c9c88edd96f: Pull complete
  ba6086eed9cb: Verifying Checksum
  ba6086eed9cb: Download complete
  ce4bbcf2858c: Verifying Checksum
  ce4bbcf2858c: Download complete
  c3a89d94ffd9: Verifying Checksum
  c3a89d94ffd9: Download complete
  d2d819887e11: Pull complete
  ce4bbcf2858c: Pull complete
  ba6086eed9cb: Pull complete
  c3a89d94ffd9: Pull complete
  Digest: sha256:2bcc9488cc8e6a52e16[15](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:18)ff8d89[16](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:19)95e88fdcca9497b312776d583bb4febcfdc
  Status: Downloaded newer image for apache/kvrocks:latest
  docker.io/apache/kvrocks:latest
  /usr/bin/docker create --name [21](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:24)0c54969[27](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:30)341f[28](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:31)510a91bb90690af_apachekvrocks_6a942f --label 94[35](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:38)1b --network github_network_b82bef89e5354c3ca5d2cd8[37](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:40)5027b59 --network-alias redis -p 6379:6666  -e GITHUB_ACTIONS=true -e CI=true apache/kvrocks
  2ca70aef[44](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:47)a82cca2fd078[48](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:51)5675144f0f1d93b9aafb87c6b6d2fd601a63a1d4
  /usr/bin/docker start 2ca70aef44a82cca2fd078485675144f0f1d93b9aafb87c6b6d2fd601a63a1d4
  2ca70aef44a82cca2fd07848567[51](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:54)44f0f1d93b9aafb87c6b6d2fd601a63a1d4
  /usr/bin/docker ps --all --filter id=2ca70aef44a82cca2fd078485675144f0f1d93b9aafb87c6b6d2fd601a63a1d4 --filter status=running --no-trunc --format ""{{.ID}} {{.Status}}""
  2ca70aef44a82cca2fd078485675144f0f1d93b9aafb87c6b6d2fd601a63a1d4 Up Less than a second (health: starting)
  /usr/bin/docker port 2ca70aef44a82cca2fd078485675144f0f1d93b9aafb87c6b6d2fd601a63a1d4
  6666/tcp -> 0.0.0.0:6379
  6666/tcp -> [::]:6379
Waiting for all services to be ready
  /usr/bin/docker inspect --format=""{{if .Config.Healthcheck}}{{print .State.Health.Status}}{{end}}"" 2ca70aef44a82cca2fd07848[56](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:59)75144f0f1d93b9aafb87c6b6d2fd601a63a1d4
  starting
  redis service is starting, waiting 2 seconds before checking again.
  /usr/bin/docker inspect --format=""{{if .Config.Healthcheck}}{{print .State.Health.Status}}{{end}}"" 2ca70aef44a82cca2fd078485675144f0f1d93b9aafb87c6b6d2fd601a63a1d4
  starting
  redis service is starting, waiting 4 seconds before checking again.
  /usr/bin/docker inspect --format=""{{if .Config.Healthcheck}}{{print .State.Health.Status}}{{end}}"" 2ca70aef44a82cca2fd078485675144f0f1d93b9aafb87c6b6d2fd[60](https://github.com/apache/incubator-opendal/actions/runs/6309725180/job/17131514618#step:2:64)1a63a1d4
  starting
  redis service is starting, waiting 8 seconds before checking again.
  /usr/bin/docker inspect --format=""{{if .Config.Healthcheck}}{{print .State.Health.Status}}{{end}}"" 2ca70aef44a82cca2fd078485675144f0f1d93b9aafb87c6b6d2fd601a63a1d4
  healthy
  redis service is healthy.
```

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1783/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nbZO-,kvrocks,1735234494,1783,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-26T10:08:42Z,2023-09-26T10:08:42Z,@Xuanwo Thank you for your feedback. ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nbZO-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nbckP,kvrocks,1735248143,1783,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-26T10:17:56Z,2023-09-26T10:17:56Z,"Guess it should be related to this PR: https://github.com/apache/kvrocks/pull/1676, we changed the default listening address to 127.0.0.1","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nbckP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nbfY5,kvrocks,1735259705,1783,NA,Xuanwo,5351546,Xuanwo,github@xuanwo.io,NA,2023-09-26T10:25:51Z,2023-09-26T10:25:51Z,"The simple re-pro:

Start container:

```shell
docker run -p 6379:6666 apache/kvrocks:2.6.0
```

Use `redis-cli`:

```shell
:( redis-cli get abc
Error: Connection reset by peer
```

It's ok on kvrocks:2.5.1:

```
:( redis-cli get abc
(nil)
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nbfY5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1783,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nbg7q,kvrocks,1735266026,1783,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-09-26T10:30:15Z,2023-09-26T10:30:15Z,@Xuanwo Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5nbg7q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1789,https://api.github.com/repos/apache/kvrocks/issues/1789,kvrocks,1920453478,1789,Data race detected when recording metrics,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-10-01T00:34:24Z,2023-10-01T10:08:46Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/actions/runs/6363892540/job/17279898076?pr=1776

### What did you expect to see?

CI passed

### What did you see instead?

CI failed

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1789/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1793,https://api.github.com/repos/apache/kvrocks/issues/1793,kvrocks,1929392486,1793,Add the sanity check for docker image,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-10-06T03:58:43Z,2023-11-09T04:54:41Z,"We'd better add some sanity checks in:

https://github.com/apache/kvrocks/blob/7f0c5156493dc3601bbc6f2157f9fa1d8462ea51/.github/workflows/kvrocks.yaml#L292-L309

_Originally posted by @tisonkun in https://github.com/apache/kvrocks/issues/1784#issuecomment-1735890155_

As mentioned in the comments, we at least check if the docker listening port can be accessed from outside.
            ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1793/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1793,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q6Q9W,kvrocks,1793658710,1793,NA,jyf111,64510284,,,NA,2023-11-05T07:14:53Z,2023-11-05T07:14:53Z,"How about using the following commands? @git-hulk 

```shell
id=""$(docker run --rm -d -p 6666:6666 kvrocks:ci)""
sleep 1m # waiting for the periodic container health check

if [ ""$(docker inspect --format='{{.State.Health.Status}}' $id)"" != ""healthy"" ]; then
  echo ""Container is not healthy.""
  exit 1
fi

if [ ""$(ss --listening --no-header --tcp '( sport = :6666 )')"" == """" ]; then
  echo ""The container listening port can not be accessed from outside.""
  exit 1
fi

docker stop $id
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q6Q9W/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1793,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q6a4_,kvrocks,1793699391,1793,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-05T10:39:22Z,2023-11-05T10:39:22Z,"@jyf111 Looks good, thank you.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q6a4_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1801,https://api.github.com/repos/apache/kvrocks/issues/1801,kvrocks,1939182435,1801,Add parameters to clean test data and build result in x.py,Yangsx-1,85615957,Hauru,,CLOSED,2023-10-12T05:03:49Z,2023-10-13T02:30:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I found the go test data in tests/gocase/workspace occupied too much disk space locally, so it may be more convenient for developers to clean the test data if we add a parameter in x.py for this task. 

May be we can also add a parameter to clean the build result for totally rebuilding.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1801/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1801,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5o3pbg,kvrocks,1759418080,1801,NA,PragmaTwice,20042607,Twice,,NA,2023-10-12T11:20:59Z,2023-10-12T11:20:59Z,"You can pass `deleteOnExit` flag to `go test` to remove files in workspace dir.

https://github.com/apache/kvrocks/blob/e38021ca509d21624957f217aae516360ff77adb/tests/gocase/util/flags.go#L26","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5o3pbg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1801,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5o8bfN,kvrocks,1760671693,1801,NA,Yangsx-1,85615957,Hauru,,NA,2023-10-13T02:30:12Z,2023-10-13T02:30:12Z,"> You can pass `deleteOnExit` flag to `go test` to remove files in workspace dir.
> 
> https://github.com/apache/kvrocks/blob/e38021ca509d21624957f217aae516360ff77adb/tests/gocase/util/flags.go#L26

Thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5o8bfN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/1802,kvrocks,1941243443,1802,Add the support of changing worker threads in-flight,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-10-13T05:04:49Z,2023-10-30T01:13:56Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

It's hard to know the application workload as the time goes,
so that's impossible to estimate the right number of worker threads
to fulfill the workload requirement. So it'd be great if we can change
the worker thread number in-flight, and we don't need to worry much about
it's suitable at the beginning.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1802/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pGO7v,kvrocks,1763241711,1802,NA,guojidan,63799833,junxiangMu,,NA,2023-10-15T02:23:45Z,2023-10-15T02:23:45Z,provide a server command to change worker thread num in-flight?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pGO7v/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pGZDI,kvrocks,1763283144,1802,NA,guojidan,63799833,junxiangMu,,NA,2023-10-15T05:49:05Z,2023-10-15T05:49:05Z,assign to me : ),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pGZDI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pGZZ1,kvrocks,1763284597,1802,NA,PragmaTwice,20042607,Twice,,NA,2023-10-15T05:57:16Z,2023-10-15T05:57:16Z,"Hi @guojidan , assigned!

BTW here we can just use `CONFIG SET ..` instead of a new command.

Refer to [config.cc](https://github.com/apache/kvrocks/blob/unstable/src/config/config.cc) for more details.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pGZZ1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pGZmz,kvrocks,1763285427,1802,NA,guojidan,63799833,junxiangMu,,NA,2023-10-15T06:02:15Z,2023-10-15T06:02:15Z,thanks,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pGZmz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pSqKH,kvrocks,1766498951,1802,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-10-17T14:09:00Z,2023-10-17T14:09:00Z,@guojidan Do you have any ideas? I'm interested in this. I think we can talk about this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pSqKH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pSxzJ,kvrocks,1766530249,1802,NA,guojidan,63799833,junxiangMu,,NA,2023-10-17T14:25:26Z,2023-10-17T14:25:26Z,I have implemented a version，but I don't think it's good，Do you have any better ideas？ https://github.com/apache/kvrocks/commit/4b627a99cbbb071f9e00d57d9e1ccfe52ead88bd,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pSxzJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pS5ax,kvrocks,1766561457,1802,NA,xiaobiaozhao,52393536,xiaobiaozhao,,NA,2023-10-17T14:41:20Z,2023-10-17T14:41:20Z,"If I look at this commit, there is nothing wrong with the big logic, what needs to be considered is how to do thread exit.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pS5ax/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pWYTK,kvrocks,1767474378,1802,NA,guojidan,63799833,junxiangMu,,NA,2023-10-18T01:43:34Z,2023-10-18T01:43:34Z,"Is it limited worker_num to greater than 1, I think 1 workers is Meaningless ,  and I think long connections can be transferred to other threads on exit","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pWYTK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pW4FY,kvrocks,1767604568,1802,NA,guojidan,63799833,junxiangMu,,NA,2023-10-18T04:08:06Z,2023-10-18T04:08:06Z,take look @xiaobiaozhao  https://github.com/guojidan/kvrocks/commit/3b0c4b7d9190c5ffc6d1f3a4658cdf48e75bfdba,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pW4FY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5p4Inx,kvrocks,1776323057,1802,NA,guojidan,63799833,junxiangMu,,NA,2023-10-24T01:33:50Z,2023-10-24T01:33:50Z,"I can't handle long connections properly, so let other people interested in it implement this issue, I will close pr and unassign to me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5p4Inx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1802,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5p4SUd,kvrocks,1776362781,1802,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-24T01:56:56Z,2023-10-24T01:56:56Z,@guojidan Thanks for your efforts. Let me take it and welcome to help review if you like.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5p4SUd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1805,https://api.github.com/repos/apache/kvrocks/issues/1805,kvrocks,1943824921,1805,Tracking issue for the Redis JSON support,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:06:20Z,2024-09-23T05:47:31Z,"### Motivation

After #1803, we have basic support of RedisJSON, but massive amount of commands remain unsupported:
- [x] #1806
- [x] #1807
- [x] #1808
- [x] #1809
- [x] #1810
- [x] #1811
- [x] #1812
- [x] #1813
- [x] #1814
- [x] #1815
- [x] #1816
- [x] #1817
- [x] #1818
- [x] #1819
- [x] #1820
- [x] #1821
- [x] #1822
- [x] #1823
- [x] #1824
- [x] #1825
- [x] #1826

We need to support all of these commands to make our JSON support more complete and powerful.

Other pull requests related to JSON:
- [x] #1803 
- [x] #1828
- [x] #1840
- [ ] #1829 
- [x] #1843

### Call for Contribution

Feel free to pick up any issue and finish it!

You can request to be assigned with any issue from this list and try to implement it.

### How to implement

1. Check [the RedisJSON document](https://redis.io/docs/data-types/json/) and the document for the specific command (e.g. [JSON.SET](https://redis.io/commands/json.set/))
2. Check the document of [Kvrocks data structures design](https://kvrocks.apache.org/community/data-structure-on-rocksdb) and #1803 to understand how Kvrocks implements Redis data types upon RocksDB. (and also the document of [jsoncons](https://github.com/danielaparker/jsoncons) which is used in kvrocks to parse/serialize JSON.)
3. Add corresponding methods to [types/json.h](https://github.com/apache/kvrocks/blob/unstable/src/types/json.h), [types.redis_json.h/cc](https://github.com/apache/kvrocks/blob/unstable/src/types/redis_json.cc), and command interface (`Parse` and `Execute` function) to [commands/cmd_json.cc](https://github.com/apache/kvrocks/blob/unstable/src/commands/cmd_json.cc). (Note: `types/json.h` is just wrapper functions of `jsoncons` library which is not related to storage, while `types/redis_json.h` is about how to encode/decode JSON from storage (IO operations))
4. Add corresponding [C++ unit test cases](https://github.com/apache/kvrocks/blob/unstable/tests/cppunit/types/json_test.cc) and [Golang unit test cases](https://github.com/apache/kvrocks/blob/unstable/tests/gocase/unit/type/json/json_test.go) for your newly implemented command.
5. Open your pull requests and we will review them promptly!

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1805/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q5sgx,kvrocks,1793509425,1805,NA,Kelvinyu1117,26522479,Kelvin Wu,kelvinyu1117@gmail.com,NA,2023-11-04T18:02:49Z,2023-11-04T18:02:49Z,"I found that some of the commands were marked as deprecated in the Redis document, do you guys still want to support it?
For example:
[JSON.RESP](https://redis.io/commands/json.resp/)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q5sgx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rKLI_,kvrocks,1797829183,1805,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-07T05:03:52Z,2023-11-07T05:03:52Z,@Kelvinyu1117 I think we can complete the active commands first and the deprecated commands are also good to support if users did have solid reasons. cc @PragmaTwice ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rKLI_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ek3Tl,kvrocks,2224256229,1805,NA,zagzhang,13993967,码农gogo,,NA,2024-07-12T01:30:03Z,2024-07-12T01:30:03Z,Can the JSON feature of KVRocks be officially used in a production environment?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ek3Tl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ek-t9,kvrocks,2224286589,1805,NA,PragmaTwice,20042607,Twice,,NA,2024-07-12T02:01:05Z,2024-07-12T02:01:05Z,"> Can the JSON feature of KVRocks be officially used in a production environment?

Sure.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ek-t9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1805,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGTtl,kvrocks,2367241061,1805,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-23T04:59:50Z,2024-09-23T04:59:50Z,@PragmaTwice All JSON commands are done and we can close this tracking issue now.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGTtl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1806,https://api.github.com/repos/apache/kvrocks/issues/1806,kvrocks,1943825229,1806,Add support for the JSON.ARRAPPEND command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:07:25Z,2023-10-20T12:57:53Z,Please refer to #1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1806/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1806,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pabjE,kvrocks,1768536260,1806,NA,lieck,44867050,Elaina,,NA,2023-10-18T14:05:03Z,2023-10-18T14:05:03Z,"I want to take this issue, thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pabjE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1806,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5paf6h,kvrocks,1768554145,1806,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-18T14:13:25Z,2023-10-18T14:13:25Z,"@lieck Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5paf6h/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1806,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5poIac,kvrocks,1772127900,1806,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-10-20T05:56:37Z,2023-10-20T05:56:37Z,"Oh I found a interesting thing in RedisJson...

```
///
/// JSON.ARRAPPEND <key> <path> <json> [json ...]
///
pub fn json_arr_append<M: Manager>(
    manager: M,
    ctx: &Context,
    args: Vec<RedisString>,
) -> RedisResult;
```

The code of it is `JSON.ARRAPPEND <key> <path> <json>`. But the document of it says the path is optional, it's so misleading...

Our current impl is right","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5poIac/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1807,https://api.github.com/repos/apache/kvrocks/issues/1807,kvrocks,1943826297,1807,Add support for the JSON.ARRINDEX command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:04Z,2023-11-10T03:39:59Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1807/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1807,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qP6r-,kvrocks,1782557438,1807,NA,skyitachi,3816806,skyitachi,skbysp@gmail.com,NA,2023-10-27T09:01:24Z,2023-10-27T09:01:24Z,"I want to pick up this issue, thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qP6r-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1807,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qQBcm,kvrocks,1782585126,1807,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-27T09:20:39Z,2023-10-27T09:20:39Z,"@skyitachi Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qQBcm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1808,https://api.github.com/repos/apache/kvrocks/issues/1808,kvrocks,1943826314,1808,Add support for the JSON.ARRINSERT command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:08Z,2023-11-17T14:23:20Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1808/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1809,https://api.github.com/repos/apache/kvrocks/issues/1809,kvrocks,1943826326,1809,Add support for the JSON.ARRLEN command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:10Z,2023-10-26T14:31:47Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1809/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1809,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qB-TK,kvrocks,1778902218,1809,NA,Ziy1-Tan,49604965,Ziyi Tan,ajb459684460@gmail.com,NA,2023-10-25T09:48:14Z,2023-10-25T09:48:14Z,I want to try it. Assign me plz :).,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qB-TK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1809,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qCDec,kvrocks,1778923420,1809,NA,PragmaTwice,20042607,Twice,,NA,2023-10-25T10:01:19Z,2023-10-25T10:01:19Z,Thank you! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qCDec/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1810,https://api.github.com/repos/apache/kvrocks/issues/1810,kvrocks,1943826339,1810,Add support for the JSON.ARRPOP command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:13Z,2023-11-05T09:43:02Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1810/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1810,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qgl1r,kvrocks,1786928491,1810,NA,jyf111,64510284,,,NA,2023-10-31T10:24:23Z,2023-10-31T10:24:23Z,"Hi, I want to try this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qgl1r/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1810,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ql5zS,kvrocks,1788320978,1810,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-01T02:51:06Z,2023-11-01T02:51:06Z,@jyf111 Thank you! assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ql5zS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1811,https://api.github.com/repos/apache/kvrocks/issues/1811,kvrocks,1943826350,1811,Add support for the JSON.ARRTRIM command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:15Z,2023-11-12T13:50:23Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1811/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1812,https://api.github.com/repos/apache/kvrocks/issues/1812,kvrocks,1943826362,1812,Add support for the JSON.CLEAR command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:18Z,2023-10-24T11:14:20Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1812/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1813,https://api.github.com/repos/apache/kvrocks/issues/1813,kvrocks,1943826383,1813,Add support for the JSON.DEL command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:21Z,2023-11-30T15:06:50Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1813/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1813,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5p_BFa,kvrocks,1778127194,1813,NA,Qiaolin-Yu,90088090,Qiaolin Yu,qy254@cornell.edu,NA,2023-10-24T22:13:23Z,2023-10-24T22:13:23Z,I want to try this. Can you assign this to me?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5p_BFa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1813,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qBnLM,kvrocks,1778807500,1813,NA,PragmaTwice,20042607,Twice,,NA,2023-10-25T08:51:37Z,2023-10-25T08:51:37Z,Sure. Please go ahead : ),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qBnLM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1813,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qBoEs,kvrocks,1778811180,1813,NA,PragmaTwice,20042607,Twice,,NA,2023-10-25T08:53:49Z,2023-10-25T08:53:49Z,"BTW I think for this command the implementation may be a bit tricky since it may be not easy to retrieve the parent object of a object located by jsonpath in jsoncons.

But of course you can do some research to solve it. Good luck!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qBoEs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1813,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qU5t5,kvrocks,1783864185,1813,NA,Qiaolin-Yu,90088090,Qiaolin Yu,qy254@cornell.edu,NA,2023-10-28T16:31:18Z,2023-10-28T16:31:18Z,"> BTW I think for this command the implementation may be a bit tricky since it may be not easy to retrieve the parent object of a object located by jsonpath in jsoncons.
> 
> But of course you can do some research to solve it. Good luck!

 I have indeed recognized this problem when attempting to retrieve the parent object of a targeted object. I've tried several methods but still face the issue. Do you have any suggestions on how to address this in `jsoncons::jsonpath`?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qU5t5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1813,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qVWW7,kvrocks,1783981499,1813,NA,PragmaTwice,20042607,Twice,,NA,2023-10-29T02:37:55Z,2023-10-29T02:37:55Z,"Hi @Qiaolin-Yu , you can refer to https://github.com/danielaparker/jsoncons/issues/467.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qVWW7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1813,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qVWZp,kvrocks,1783981673,1813,NA,Qiaolin-Yu,90088090,Qiaolin Yu,qy254@cornell.edu,NA,2023-10-29T02:39:26Z,2023-10-29T02:39:26Z,"> Hi @Qiaolin-Yu , you can refer to [danielaparker/jsoncons#467](https://github.com/danielaparker/jsoncons/issues/467).

Thank you very much. I'll try it right away.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qVWZp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1814,https://api.github.com/repos/apache/kvrocks/issues/1814,kvrocks,1943826396,1814,Add support for the JSON.FORGET command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:23Z,2023-12-03T14:37:59Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1814/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1815,https://api.github.com/repos/apache/kvrocks/issues/1815,kvrocks,1943826411,1815,Add support for the JSON.MERGE command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:27Z,2023-11-10T15:28:58Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1815/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1816,https://api.github.com/repos/apache/kvrocks/issues/1816,kvrocks,1943826419,1816,Add support for the JSON.MGET command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:29Z,2023-12-14T12:47:28Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1816/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1816,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rnFpQ,kvrocks,1805408848,1816,NA,skyitachi,3816806,skyitachi,skbysp@gmail.com,NA,2023-11-10T09:46:45Z,2023-11-10T09:46:45Z,I want to pick up this issue,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rnFpQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1816,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rnOqX,kvrocks,1805445783,1816,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-10T10:11:04Z,2023-11-10T10:11:04Z,"@skyitachi Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rnOqX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1816,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tiYWw,kvrocks,1837729200,1816,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-04T02:12:07Z,2023-12-04T02:12:07Z,@skyitachi Are you still working on this issue? ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tiYWw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1816,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tkYIr,kvrocks,1838252587,1816,NA,skyitachi,3816806,skyitachi,skbysp@gmail.com,NA,2023-12-04T10:27:46Z,2023-12-04T10:27:46Z,"yes, my computer is broken, this week maybe repaired :)

On Mon, Dec 4, 2023 at 10:12 AM hulk ***@***.***> wrote:

> @skyitachi <https://github.com/skyitachi> Are you still working on this
> issue?
>
> —
> Reply to this email directly, view it on GitHub
> <https://github.com/apache/kvrocks/issues/1816#issuecomment-1837729200>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AA5D2ZXUGODUUPRBUQDFJZLYHUWQHAVCNFSM6AAAAAA6A4YTZ6VHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMYTQMZXG4ZDSMRQGA>
> .
> You are receiving this because you were mentioned.Message ID:
> ***@***.***>
>
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tkYIr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1816,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tkcPo,kvrocks,1838269416,1816,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-04T10:38:03Z,2023-12-04T10:38:03Z,@skyitachi Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tkcPo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1817,https://api.github.com/repos/apache/kvrocks/issues/1817,kvrocks,1943826430,1817,Add support for the JSON.MSET command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:32Z,2024-04-08T12:07:08Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1817/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1817,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qzjIW,kvrocks,1791898134,1817,NA,chakkk309,60494790,Chakkk,i@chakkk.com,NA,2023-11-03T05:05:18Z,2023-11-03T05:05:18Z,"Hi, I want to try this task~","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qzjIW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1817,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qzjlS,kvrocks,1791899986,1817,NA,PragmaTwice,20042607,Twice,,NA,2023-11-03T05:08:30Z,2023-11-03T05:08:30Z,Assigned. Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qzjlS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1817,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tiYQL,kvrocks,1837728779,1817,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-04T02:11:30Z,2023-12-04T02:11:30Z,@chakkk309 Are you working on this issue? ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tiYQL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1817,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tt1OT,kvrocks,1840731027,1817,NA,chakkk309,60494790,Chakkk,i@chakkk.com,NA,2023-12-05T12:48:48Z,2023-12-05T12:48:48Z,"> @chakkk309 Are you working on this issue?

Hi, this issue still working in progress.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tt1OT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1817,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tuQ4l,kvrocks,1840844325,1817,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-05T13:57:28Z,2023-12-05T13:57:28Z,"OK, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tuQ4l/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1817,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55NvAQ,kvrocks,2033643536,1817,NA,zjregee,89204657,,zjregee@gmail.com,NA,2024-04-03T06:15:52Z,2024-04-03T06:15:52Z,Is anyone working on it? I'd like to submit a PR to close this issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55NvAQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1817,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55NxiP,kvrocks,2033653903,1817,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-03T06:24:03Z,2024-04-03T06:24:03Z,@zjregee Thank you! I have reassigned this issue to you. ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55NxiP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1818,https://api.github.com/repos/apache/kvrocks/issues/1818,kvrocks,1943826437,1818,Add support for the JSON.NUMINCRBY command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:34Z,2023-12-01T12:47:45Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1818/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1818,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qsV4C,kvrocks,1790008834,1818,NA,skyitachi,3816806,skyitachi,skbysp@gmail.com,NA,2023-11-02T03:31:26Z,2023-11-02T03:31:26Z,"I want to pick up this issue, thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qsV4C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1818,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qzjck,kvrocks,1791899428,1818,NA,PragmaTwice,20042607,Twice,,NA,2023-11-03T05:07:23Z,2023-11-03T05:07:23Z,Thank you! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qzjck/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1819,https://api.github.com/repos/apache/kvrocks/issues/1819,kvrocks,1943826451,1819,Add support for the JSON.NUMMULTBY command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:37Z,2023-12-01T12:47:45Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1819/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1819,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rooPn,kvrocks,1805812711,1819,NA,skyitachi,3816806,skyitachi,skbysp@gmail.com,NA,2023-11-10T14:11:26Z,2023-11-10T14:11:26Z,"I have implemented  with JSON.NUMINCRBY command, [pull request](https://github.com/apache/kvrocks/pull/1890)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rooPn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1820,https://api.github.com/repos/apache/kvrocks/issues/1820,kvrocks,1943826465,1820,Add support for the JSON.OBJKEYS command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:39Z,2023-11-07T05:01:12Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1820/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1821,https://api.github.com/repos/apache/kvrocks/issues/1821,kvrocks,1943826487,1821,Add support for the JSON.OBJLEN command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:42Z,2023-12-05T01:55:42Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1821/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1821,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qL3NT,kvrocks,1781494611,1821,NA,isHuangXin,57054352,Xin Huang,,NA,2023-10-26T16:54:30Z,2023-10-26T16:54:30Z,"Hi @PragmaTwice 
I want to try it. Plz, assign it to me. thanks~","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qL3NT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1821,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qL9QD,kvrocks,1781519363,1821,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-10-26T17:12:01Z,2023-10-26T17:12:01Z,@isHuangXin  Go ahead!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qL9QD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1822,https://api.github.com/repos/apache/kvrocks/issues/1822,kvrocks,1943826504,1822,Add support for the JSON.RESP command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:45Z,2024-09-23T04:58:55Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1822/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1822,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sF7xO,kvrocks,1813494862,1822,NA,venkatdatta0,150568712,,,NA,2023-11-16T00:07:30Z,2023-11-16T00:07:30Z,"Hi @PragmaTwice @git-hulk 

I am new to open source community.

Can i work on this task?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sF7xO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1822,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sF8bQ,kvrocks,1813497552,1822,NA,venkatdatta0,150568712,,,NA,2023-11-16T00:10:33Z,2023-11-16T00:10:33Z,"In Redis document, this particular method is marked as deprecated.

https://redis.io/commands/json.resp/

Do we want to add support for RESP?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sF8bQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1822,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sGJfJ,kvrocks,1813551049,1822,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-16T01:05:58Z,2023-11-16T01:05:58Z,"@venkatdatta0 Surely yes, if you're willing to support this. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sGJfJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1822,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGMIe,kvrocks,2367210014,1822,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-23T04:20:54Z,2024-09-23T04:20:54Z,@venkatdatta0 Can i assume you are not working on this anymore? I am interested in working on this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGMIe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1822,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGTho,kvrocks,2367240296,1822,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-23T04:58:55Z,2024-09-23T04:58:55Z,"@jonathanc-n Thanks for mentioning this issue. It has been supported in #2390, will close this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGTho/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1823,https://api.github.com/repos/apache/kvrocks/issues/1823,kvrocks,1943826519,1823,Add support for the JSON.STRAPPEND command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:48Z,2023-12-05T12:23:03Z,Please refer to https://github.com/apache/kvrocks/issues/1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1823/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5plLb-,kvrocks,1771353854,1823,NA,guojidan,63799833,junxiangMu,,NA,2023-10-19T16:40:51Z,2023-10-19T16:40:51Z,"assign to me, I have already implement","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5plLb-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1823,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5plMKO,kvrocks,1771356814,1823,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-10-19T16:42:44Z,2023-10-19T16:42:44Z,@guojidan You can just create a pull request and @ me to review it.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5plMKO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1824,https://api.github.com/repos/apache/kvrocks/issues/1824,kvrocks,1943826538,1824,Add support for the JSON.STRLEN command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:11:52Z,2023-12-05T12:23:42Z,Please refer to #1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1824/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1825,https://api.github.com/repos/apache/kvrocks/issues/1825,kvrocks,1943826680,1825,Add support for the JSON.TOGGLE command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:12:19Z,2023-11-09T06:46:33Z,Please refer to #1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1825/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1826,https://api.github.com/repos/apache/kvrocks/issues/1826,kvrocks,1943826700,1826,Add support for the JSON.TYPE command,PragmaTwice,20042607,Twice,,CLOSED,2023-10-15T10:12:22Z,2023-10-21T14:01:30Z,Please refer to #1805.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1826/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1832,https://api.github.com/repos/apache/kvrocks/issues/1832,kvrocks,1949327284,1832,Refactor kvrocks2redis via rocksdb secondary instance,PragmaTwice,20042607,Twice,,CLOSED,2023-10-18T09:48:51Z,2024-01-03T01:55:24Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently kvrocks2redis using network connections to catch up with incremental data. We can use [Read only and Secondary instances](https://github.com/facebook/rocksdb/wiki/Read-only-and-Secondary-instances) in RocksDB to remove such network connections.

cc @git-hulk 

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1832/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1832,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sHkNq,kvrocks,1813922666,1832,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2023-11-16T07:30:55Z,2023-11-16T07:30:55Z,"Hi @PragmaTwice , I'm interested in this issue. Can I give it a try?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sHkNq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1832,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sIK64,kvrocks,1814081208,1832,NA,PragmaTwice,20042607,Twice,,NA,2023-11-16T09:30:37Z,2023-11-16T09:30:37Z,"> Hi @PragmaTwice , I'm interested in this issue. Can I give it a try?

Sure! Assigned.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sIK64/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1835,https://api.github.com/repos/apache/kvrocks/issues/1835,kvrocks,1951083123,1835,JSON.SET supports `NX` and `XX`,mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2023-10-19T02:42:33Z,2024-09-23T04:14:33Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

From the https://github.com/RedisJSON/RedisJSON/blob/master/docs/commands/json.set.md

We only support `JSON.SET` without `NX` and `XX`.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1835/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1835,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGK-k,kvrocks,2367205284,1835,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-23T04:14:32Z,2024-09-23T04:14:32Z,"@mapleFU is this finished? If you are not working on it, can I take over on it?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGK-k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1836,https://api.github.com/repos/apache/kvrocks/issues/1836,kvrocks,1951190093,1836,Prefix scan didn't work well when enabling the cluster mode,EasyProgramming,16394461,,,OPEN,2023-10-19T04:40:35Z,2023-10-21T01:31:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

centos 7.9

Kvrocks was running with two cluster nodes and slot distributions are 0-8191 and 8192-16383
(kvrocks 2.6.0 内含两个节点的集群，slot分别为0-8191、8192-16383)

### Minimal reproduce step

![8d1f97b4c485dbad7b462b4c0b0022f](https://github.com/apache/kvrocks/assets/16394461/c65119be-5776-44fb-8adc-651c414576f6)


### What did you expect to see?

return keys should start with f character.

返回以f开头的key

### What did you see instead?

- 

### Anything Else?
1.触发场景可能与大量的key被删除有关，因为当时的场景就是删除大量的key
2.依稀记得当时执行scan的时候，在程序里面超时了；然后我手动在redis-cli里面执行，响应速度也很慢

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1836/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pgSyN,kvrocks,1770073229,1836,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-10-19T05:38:06Z,2023-10-19T05:38:06Z,@EasyProgramming could you provide a complete list of commands execute after a FLUSHDB so that we can reproduce locally?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pgSyN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pjvu1,kvrocks,1770978229,1836,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-19T13:21:09Z,2023-10-19T13:21:09Z,"@EasyProgramming It's a limitation in the scan command when enabling the cluster mode. It'll only look forward N(50) slots when scanning keys, for example:

If we have keys: `aaaa`(slot 0), `bbbb`(slot 10), `cccc`(slot 100), `dddd`(slot 200) and we scan with:

```
SCAN ""0"" MATCH ""bb*""
```
it works well since `bbbb` is located at slot 10, and Kvrocks try to look forward next 50 slots. But if you scan with `cc*`:

```
SCAN ""0"" MATCH ""cc*""
```
it will return empty array with cursor(`_bbbb`) since `cccc` is located at slot 100.

For the implementation, please refer: https://github.com/apache/kvrocks/blob/unstable/src/storage/redis_db.cc#L365


Of course, for this limitation will make the scan command very hard to use. We will try our best to improve this if possible. cc @tisonkun @PragmaTwice ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pjvu1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pj-w1,kvrocks,1771039797,1836,NA,PragmaTwice,20042607,Twice,,NA,2023-10-19T13:53:56Z,2023-10-19T13:53:56Z,Could we make `HASH_SLOTS_MAX_ITERATIONS` a configurable constant?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pj-w1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pngFr,kvrocks,1771962731,1836,NA,EasyProgramming,16394461,,,NA,2023-10-20T02:07:24Z,2023-10-20T02:07:24Z,@git-hulk 我这边使用Java的lettuce连接的kvrocks，看了lettuce对scan、hscan、sscan的实现方式，lettuce是以游标返回的是否为字符0来判断是否扫描完成的，所以想问一下，kvrocks这块关于scan、hscan、sscan扫描完成的标志为是否也是字符0呢，这样的话，对于我这边的程序来讲还是可以接受的,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pngFr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pniJ7,kvrocks,1771971195,1836,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-20T02:18:55Z,2023-10-20T02:18:55Z,"> Could we make `HASH_SLOTS_MAX_ITERATIONS` a configurable constant?

Yes, but this cannot resolve this problem unless they set it to MAX_HASH_SLOTS.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pniJ7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pniT0,kvrocks,1771971828,1836,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-20T02:19:54Z,2023-10-20T02:19:54Z,"> @git-hulk 我这边使用Java的lettuce连接的kvrocks，看了lettuce对scan、hscan、sscan的实现方式，lettuce是以游标返回的是否为字符0来判断是否扫描完成的，所以想问一下，kvrocks这块关于scan、hscan、sscan扫描完成的标志为是否也是字符0呢，这样的话，对于我这边的程序来讲还是可以接受的

Yes, you can continue iterating if the cursor is NOT ""0"".","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pniT0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5prtFY,kvrocks,1773064536,1836,NA,PragmaTwice,20042607,Twice,,NA,2023-10-20T16:44:58Z,2023-10-20T16:44:58Z,"> Yes, but this cannot resolve this problem unless they set it to MAX_HASH_SLOTS.

But it is the only workaround I can come up with now, for both being compatible with currently behavior and solving the issue by manually setting the option.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5prtFY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1836,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pttOS,kvrocks,1773589394,1836,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-10-21T01:31:54Z,2023-10-21T01:31:54Z,"The user can work around this by continuing the scan if the cursor is not ""0"", it will start with the new slot id instead of 0.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5pttOS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1838,https://api.github.com/repos/apache/kvrocks/issues/1838,kvrocks,1951662870,1838,Workaround GitHub Actions time limit,PragmaTwice,20042607,Twice,,OPEN,2023-10-19T09:01:07Z,2023-10-31T13:15:30Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Currently our nightly docker release CI has failed frequently due to reaching to Actions time limit (6 hours).

We need to figure out a workaround to make the CI always success.

### Minimal reproduce step

-

### What did you expect to see?

-

### What did you see instead?

-

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1838/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1838,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qhnhk,kvrocks,1787197540,1838,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-10-31T13:15:09Z,2023-10-31T13:15:09Z,Ref - https://cwiki.apache.org/confluence/display/INFRA/ASF+Infra+provided+self-hosted+runners,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qhnhk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1851,https://api.github.com/repos/apache/kvrocks/issues/1851,kvrocks,1957855067,1851,Wrong bind 127.0.0.1 for docker image,rnz,851927,RNZ,,CLOSED,2023-10-23T19:11:46Z,2023-10-25T13:01:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Bind to 127.0.0.1 in the configuration is not suitable for the docker image

### Minimal reproduce step

```
$ docker run -d -p 6666:6666 apache/kvrocks:latest
67a4d65e172a67ce9d3c32a159fbdd1c9fd137294f9ca91a97a5728965558631

$ docker ps
CONTAINER ID  IMAGE                            COMMAND               CREATED         STATUS         PORTS                     NAMES
67a4d65e172a  docker.io/apache/kvrocks:latest                        4 minutes ago   Up 4 minutes   0.0.0.0:6666->6666/tcp  focused_grothendieck

$ docker exec -it 67 sh 
Emulate Docker CLI using podman. Create /etc/containers/nodocker to quiet msg.
/ # netstat -tlnp
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
tcp        0      0 127.0.0.1:6666          0.0.0.0:*               LISTEN      1/kvrocks
tcp        0      0 127.0.0.1:6666          0.0.0.0:*               LISTEN      1/kvrocks
tcp        0      0 127.0.0.1:6666          0.0.0.0:*               LISTEN      1/kvrocks
tcp        0      0 127.0.0.1:6666          0.0.0.0:*               LISTEN      1/kvrocks
tcp        0      0 127.0.0.1:6666          0.0.0.0:*               LISTEN      1/kvrocks
tcp        0      0 127.0.0.1:6666          0.0.0.0:*               LISTEN      1/kvrocks
tcp        0      0 127.0.0.1:6666          0.0.0.0:*               LISTEN      1/kvrocks
tcp        0      0 127.0.0.1:6666          0.0.0.0:*               LISTEN      1/kvrocks

/ # exit
```
```
$ redis-cli -p 6666 info | wc -l
Error: Connection reset by peer
```

### What did you expect to see?

Connecting by redis-cli to kvrocks instance which was run in docker, such for example as it make with redis images:

```
$ docker ps
CONTAINER ID  IMAGE                            COMMAND               CREATED         STATUS         PORTS                     NAMES
55a62aa0c896  docker.io/library/redis:latest   redis-server          29 minutes ago  Up 29 minutes  0.0.0.0:6379->6379/tcp    gifted_kare
$ redis-cli -p 6379 info | wc -l
214
```

### What did you see instead?

```
Error: Connection reset by peer
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1851/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1851,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5p3y5V,kvrocks,1776234069,1851,NA,PragmaTwice,20042607,Twice,,NA,2023-10-23T23:52:26Z,2023-10-23T23:52:26Z,"Hi @rnz, thanks for your report.

We have fixed it in https://github.com/apache/kvrocks/pull/1784, although there is currently no release including this commit.

To workaround it in `2.6.0`, you can overwrite the configuration option like:
```
docker run -it -p 6666:6666 apache/kvrocks:2.6.0 --bind 0.0.0.0
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5p3y5V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1851,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qDNod,kvrocks,1779227165,1851,NA,PragmaTwice,20042607,Twice,,NA,2023-10-25T13:01:55Z,2023-10-25T13:01:55Z,"I will close this issue since it is fixed. 

Feel free to open it again if you have further problem about it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qDNod/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1864,https://api.github.com/repos/apache/kvrocks/issues/1864,kvrocks,1971964101,1864,Compact on all cf with same range?,raffertyyu,104707498,,raffertyyu@tencent.com,CLOSED,2023-11-01T08:55:10Z,2023-11-06T10:03:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

1142a9d87ac6c404dcf4e0d06778af9ae738539b

### Minimal reproduce step

none

### What did you expect to see?

call compact on specific cf

### What did you see instead?

call compact on all cf

### Anything Else?

In method `CompactionChecker::PickCompactionFiles`, kvrocks will search all sst files in cf specified by `cf_name`. If a sst file should be compacted, kvrocks will call 
```
storage_->Compact(&start_key, &stop_key)
```
But, `Compact` method will CompactRange on all cfs.

Expected:
`Compact` method needs a `cf_name` parameter to do compact on right cf not all cfs.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1864/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1864,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qnKEF,kvrocks,1788649733,1864,NA,PragmaTwice,20042607,Twice,,NA,2023-11-01T09:21:13Z,2023-11-01T09:21:13Z,Good catch! Feel free to submit a PR if you are willing to fix it.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qnKEF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1864,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qnQYq,kvrocks,1788675626,1864,NA,raffertyyu,104707498,,raffertyyu@tencent.com,NA,2023-11-01T09:42:25Z,2023-11-01T09:42:25Z,"OK, I will fix it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5qnQYq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1866,https://api.github.com/repos/apache/kvrocks/issues/1866,kvrocks,1973300524,1866,Sonar linter should only take effect on the new code,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-11-02T00:29:10Z,2023-11-04T14:24:42Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

https://github.com/apache/kvrocks/pull/1863/checks?check_run_id=18276090339


The duplicate code error is not related to the PR, guess we should enable the option that only checks the new code.

### Minimal reproduce step

None

### What did you expect to see?

Sonar lint only takes effect on the new code.

### What did you see instead?

Scanned the full repo.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1866/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1873,https://api.github.com/repos/apache/kvrocks/issues/1873,kvrocks,1976213039,1873,Data race in namespace get,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-11-03T13:31:13Z,2024-06-04T04:07:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/actions/runs/6744677291/job/18335331806?pr=1871#step:12:81

### What did you expect to see?

CI passed

### What did you see instead?

CI failed

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1873/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1873,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_pBtf,kvrocks,2141461343,1873,NA,baobaomaomeng,83003261,,,NA,2024-05-31T08:19:53Z,2024-05-31T08:19:53Z,The logs for this run have expired and are no longer available.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_pBtf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1873,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_8bEy,kvrocks,2146545970,1873,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-04T04:07:13Z,2024-06-04T04:07:13Z,@baobaomaomeng This should be fixed in #2347 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_8bEy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1879,https://api.github.com/repos/apache/kvrocks/issues/1879,kvrocks,1978453333,1879,Character missing of token in namespace configuration,iushas,7236171,tanic.xiao,,CLOSED,2023-11-06T07:16:37Z,2023-11-06T11:15:52Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

所有版本

### Minimal reproduce step

问题一：当密码或者namespace token 有特殊字符时，比如@ # ，在配置文件里需要将密码用双引号引起来，否则kvrocks重启后就无法认证了
1、添加密码
2、修改密码后configrewrite
或者
1、添加namespace
问题2: 当手动将namespace token用双引号引起来以后，如果添加namespace，那么会将老的配置刷掉
比如：
namespace.ns_1  ""1234#""
新加一个以后变成了这样
namespace.ns_1  1234#
namespace.ns_2  1234#
这个格式，是无法认证的。 或者kvrocks对特殊字符的认证有问题

### What did you expect to see?

认证通过

### What did you see instead?

认证不通过

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1879/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1879,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q8uKP,kvrocks,1794302607,1879,NA,PragmaTwice,20042607,Twice,,NA,2023-11-06T08:27:56Z,2023-11-06T08:27:56Z,"Hi @iushas , thanks for your reporting!

It is not a bug. It is expected.

In any line of configuration file, any character after `#` (including `#` itself) will be treated as comments, e.g.
```
config-key config-value # my comments
```

If you want `#` in configuration values, you need to quote them.

And for `@`, I think it works normally.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q8uKP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1879,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q80T9,kvrocks,1794327805,1879,NA,iushas,7236171,tanic.xiao,,NA,2023-11-06T08:44:55Z,2023-11-06T08:44:55Z,"> Hi @iushas , thanks for your reporting!
> 
> It is not a bug. It is expected.
> 
> In any line of configuration file, any character after `#` (including `#` itself) will be treated as comments, e.g.
> 
> ```
> config-key config-value # my comments
> ```
> 
> If you want `#` in configuration values, you need to quote them.
> 
> And for `@`, I think it works normally.

既然客户端可以设置，比如namespace add ns   tokenxx#x@, 那么配置文件就应该要兼容吧","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q80T9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1879,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q80Xr,kvrocks,1794328043,1879,NA,PragmaTwice,20042607,Twice,,NA,2023-11-06T08:45:05Z,2023-11-06T08:45:05Z,"Oh sorry, I got your point now.

Do you mean your token is corrupted due to configuration rewriting?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q80Xr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1879,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q86Om,kvrocks,1794352038,1879,NA,iushas,7236171,tanic.xiao,,NA,2023-11-06T08:58:29Z,2023-11-06T08:58:29Z,"没有截断，比如我通过namespace add ns_1 1234#56 ，
配置文件里的namespace.ns_1 1234#56

我通过密码1234#56 就是无法认证的。

然后我手动修改配置文件里的配置 namespace.ns_1  ""1234#56""，就可以认证了。

但是当再次增加namespace的时候， 我修改的配置又被改回了namespace.ns_1 1234#56","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q86Om/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1879,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q9K0p,kvrocks,1794420009,1879,NA,PragmaTwice,20042607,Twice,,NA,2023-11-06T09:37:52Z,2023-11-06T09:37:52Z,"Thank you for reporting.

It will be fixed in #1880.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5q9K0p/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1883,https://api.github.com/repos/apache/kvrocks/issues/1883,kvrocks,1980435368,1883,redis.log not flush in docker on mac OrbStack,3tieto,147470591,,,CLOSED,2023-11-07T02:47:27Z,2024-03-02T09:09:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://lusun.com/v/5tn1fBHzmDO

> EVAL 'redis.log(redis.LOG_WARNING, ""test"")' 0

I recorded the videos, all in docker, and the first redis shown was output in real time. Then I turned off redis and used kvrocks. I can see that it needs to cache more than a dozen items before outputting them at once.

我录了下视频，都是docker，第一个展示的redis，是实时输出的。然后我关了redis，用kvrocks，可以看到要缓存十几条才一次输出

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1883/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1883,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rIYTe,kvrocks,1797358814,1883,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-07T02:48:01Z,2023-11-07T02:48:01Z,@3tieto Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rIYTe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1883,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sWGhL,kvrocks,1817733195,1883,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-19T03:29:29Z,2023-11-19T03:29:29Z,I cannot reproduce it on my side. To see if other folks have any clues.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sWGhL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1883,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51q8KC,kvrocks,1974190722,1883,NA,i18nsite,145643935,i18n.site,i18n.site@gmail.com,NA,2024-03-02T01:58:42Z,2024-03-02T01:58:42Z,"<img width=""842"" alt=""image"" src=""https://github.com/apache/kvrocks/assets/145643935/06c278bb-a7e0-4ff5-929a-21e114984887"">
如上图，加上FLAGS_logbuflevel = -1;   可以只延时一个输出了（我也不知道为什么还是要延时一个，也就是
stdout会实时输出， LOG(WARNING)要打印下一个的时候会输出上一个
）
<img width=""1728"" alt=""image"" src=""https://github.com/apache/kvrocks/assets/145643935/96308c45-c1cf-4e22-afb9-1e616190809a"">
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51q8KC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1884,https://api.github.com/repos/apache/kvrocks/issues/1884,kvrocks,1980584618,1884,add support for allow-cross-slot-keys for lua function,3tieto,147470591,,,CLOSED,2023-11-07T05:37:55Z,2024-08-14T11:49:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

lua function can read/write cross slot keys 

### Solution

https://developer.redis.com/create/redis-functions/
like redis
![image](https://github.com/apache/kvrocks/assets/147470591/6f1680ef-a73d-4998-88ca-be987b9a3caa)


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1884/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1884,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FEtIf,kvrocks,2232603167,1884,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-07-17T07:18:43Z,2024-07-17T07:18:43Z,"Hi @git-hulk @3tieto, I discovered this while creating a new https://github.com/apache/kvrocks/issues/2414. I'd like to know the status of this issue, if it's still unresolved and no one is responsible, maybe I can give it a try.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FEtIf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1884,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FE0xx,kvrocks,2232634481,1884,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-07-17T07:36:55Z,2024-07-17T07:36:55Z,"@PokIsemaine Thanks for your interest and it's good to go ahead. But be careful that this flag only takes effect in cluster mode and script's generated keys, for the predeclared keys should also forbid crossing slots if my memory serves.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FE0xx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1885,https://api.github.com/repos/apache/kvrocks/issues/1885,kvrocks,1982963418,1885,Build Failed /usr/include/features.h:330:4: error: #warning _FORTIFY_SOURCE requires compiling with optimization,jiangyunpeng,1752994,,,CLOSED,2023-11-08T07:52:39Z,2023-11-09T11:25:00Z,"
### Version

OS: CentOS Linux release 7.9.2009
kvrocks: 2.6.0

### Minimal reproduce step

./x.py build

### What did you expect to see?

Build success

### What did you see instead?

```
[  5%] Building CXX object _deps/tbb-build/src/tbb/CMakeFiles/tbb.dir/address_waiter.cpp.o
In file included from /opt/rh/devtoolset-11/root/usr/include/c++/11/x86_64-redhat-linux/bits/os_defines.h:39,
                 from /opt/rh/devtoolset-11/root/usr/include/c++/11/x86_64-redhat-linux/bits/c++config.h:2732,
                 from /opt/rh/devtoolset-11/root/usr/include/c++/11/type_traits:38,
                 from /root/kvrocks-2.6.0/build/_deps/tbb-src/src/tbb/../../include/oneapi/tbb/detail/_utils.h:20,
                 from /root/kvrocks-2.6.0/build/_deps/tbb-src/src/tbb/address_waiter.cpp:17:
/usr/include/features.h:330:4: error: #warning _FORTIFY_SOURCE requires compiling with optimization (-O) [-Werror=cpp]
  330 | #  warning _FORTIFY_SOURCE requires compiling with optimization (-O)
      |    ^~~~~~~
compilation terminated due to -Wfatal-errors.
cc1plus: all warnings being treated as errors
gmake[3]: *** [_deps/tbb-build/src/tbb/CMakeFiles/tbb.dir/address_waiter.cpp.o] Error 1
gmake[2]: *** [_deps/tbb-build/src/tbb/CMakeFiles/tbb.dir/all] Error 2
gmake[1]: *** [CMakeFiles/kvrocks.dir/rule] Error 2
gmake: *** [kvrocks] Error 2
Traceback (most recent call last):
  File ""./x.py"", line 422, in <module>
    args.func(**arg_dict)
  File ""./x.py"", line 137, in build
    run(cmake, *options, verbose=True, cwd=dir)
  File ""./x.py"", line 68, in run
    raise RuntimeError(err)
RuntimeError:
failed to run: ('/usr/bin/cmake', '--build', '.', '-t', 'kvrocks', 'kvrocks2redis')
exit with code: 2

```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1885/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1885,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rZUso,kvrocks,1801800488,1885,NA,PragmaTwice,20042607,Twice,,NA,2023-11-08T12:33:03Z,2023-11-08T12:33:03Z,"To workaround it, you can type `./x.py build -DTBB_STRICT=OFF`.

But it's a little weird to me since by default the optimization build is already enabled (hence there is no reason for this warning)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rZUso/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1885,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rgYLK,kvrocks,1803649738,1885,NA,jiangyunpeng,1752994,,,NA,2023-11-09T11:24:21Z,2023-11-09T11:24:21Z,Thanks @PragmaTwice  it works!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rgYLK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1889,https://api.github.com/repos/apache/kvrocks/issues/1889,kvrocks,1987198492,1889,The Sonar linter is too strict for test code.,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,CLOSED,2023-11-10T08:58:43Z,2023-12-16T02:07:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I noticed that many PRs fail the Sonar linter due to extensive code repetition in the TEST files. In such cases, the reviewer is required to manually inspect the results from Sonar. I believe that the Sonar linter should not be applied to test files. Moreover, the red cross on the commit message is not beautiful.

### Solution

In my opinion, it is unnecessary for the Sonar linter to take effect on test files.
Or, we could consider add additional Sonar linter rules for the test folder.


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1889/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1889,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rm6ah,kvrocks,1805362849,1889,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-10T09:18:04Z,2023-11-10T09:18:04Z,"Seems the previous exclusion rules didn't take effect and now changed, please have a try again.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rm6ah/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1889,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rnb6s,kvrocks,1805500076,1889,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-11-10T10:51:14Z,2023-11-10T10:51:14Z,"I think it would be beneficial to exempt test files from these duplicating check rules as well.
https://sonarcloud.io/project/issues?resolved=false&types=CODE_SMELL&pullRequest=1881&id=apache_kvrocks&open=AYupwdoAZ8kRMyTUsysu","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rnb6s/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1889,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rnzXr,kvrocks,1805596139,1889,NA,PragmaTwice,20042607,Twice,,NA,2023-11-10T11:46:11Z,2023-11-10T11:46:11Z,"> I think it would be beneficial to exempt test files from these duplicating check rules as well. https://sonarcloud.io/project/issues?resolved=false&types=CODE_SMELL&pullRequest=1881&id=apache_kvrocks&open=AYupwdoAZ8kRMyTUsysu

You can check the latest report, which doesn't include these test files.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rnzXr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1889,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rn2Dq,kvrocks,1805607146,1889,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-11-10T11:55:50Z,2023-11-10T11:55:50Z,"Can we also exclude Code Smells, in addition to Duplicated Lines? 

[![image](https://github.com/apache/kvrocks/assets/32858525/358d1f78-e7a3-42c9-91c7-9ceba827572e)](https://sonarcloud.io/component_measures?metric=new_technical_debt&view=list&pullRequest=1881&id=apache_kvrocks)
(You can navigate by clicking on the image)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rn2Dq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1889,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5roE1i,kvrocks,1805667682,1889,NA,PragmaTwice,20042607,Twice,,NA,2023-11-10T12:42:52Z,2023-11-10T12:42:52Z,"> Can we also exclude Code Smells, in addition to Duplicated Lines?

I believe we still need to maintain some level of code quality, even in our test code.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5roE1i/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1889,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5r4yym,kvrocks,1810050214,1889,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-11-14T11:43:25Z,2023-11-14T11:43:25Z,"> I believe we still need to maintain some level of code quality, even in our test code.

Do we need to fix code smells in the history code?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5r4yym/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1889,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sfL8N,kvrocks,1820114701,1889,NA,julic20s,97575247,,,NA,2023-11-21T02:28:47Z,2023-11-21T02:28:47Z,"Code smells is analysed in C++20(There are many C++ 20 features, such as using enum), but CMAKE_CXX_STANDARD is set to 17. Can Sonar linter change the cpp standard for checking?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sfL8N/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1889,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sfXyE,kvrocks,1820163204,1889,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-21T03:39:26Z,2023-11-21T03:39:26Z,"@julic20s We weren't aware of this, I have changed it to C++17 now.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sfXyE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1894,https://api.github.com/repos/apache/kvrocks/issues/1894,kvrocks,1990026405,1894,Restore command parse string error,iushas,7236171,tanic.xiao,,CLOSED,2023-11-13T07:20:33Z,2023-11-14T10:36:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.6.0

### Minimal reproduce step

RESTORE key:0000002597151 0 ""\x00@\xc8VXKeHogKgJ=[5V9_X^b?48OKF2jGA<f:iR@50o7dS3JV4Q6L68lC[GTA]0DaMg?_oSmcS2^N1J?ELSX@CfKQ7cM5aea\\ngY8a3LGgNVa9eRA46XS8>7ABe1>Jl9O\\Rm\\7IS:g\\U5b]=`ePo^LXhl4e:4P[DQNA3cgn<RH4UcdI6<V9S78NViC;^omK:<<Ldel:=iDmLB\t\x00\x84A\xfc\x1e\x9eg\x0bj""

this command can execute succesfully in redis, but got error in kvrocks. the error is ""(error) ERR unexpected EOF"". 


### What did you expect to see?

can execute successfully like redis

### What did you see instead?

(error) ERR unexpected EOF

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1894/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1894,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rvd5z,kvrocks,1807605363,1894,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-13T07:37:52Z,2023-11-13T07:37:52Z,"Hi @iushas 

Thanks for your feedback. Can you paste the right values of this key, so that we can add it into test cases?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rvd5z/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1894,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rvo79,kvrocks,1807650557,1894,NA,iushas,7236171,tanic.xiao,,NA,2023-11-13T08:17:01Z,2023-11-13T08:17:01Z,"@git-hulk 
## redis 
```
127.0.0.1:6379> RESTORE key:0000002597151 0 ""\x00@\xc8VXKeHogKgJ=[5V9_X^b?48OKF2jGA<f:iR@50o7dS3JV4Q6L68lC[GTA]0DaMg?_oSmcS2^N1J?ELSX@CfKQ7cM5aea\\ngY8a3LGgNVa9eRA46XS8>7ABe1>Jl9O\\Rm\\7IS:g\\U5b]=`ePo^LXhl4e:4P[DQNA3cgn<RH4UcdI6<V9S78NViC;^omK:<<Ldel:=iDmLB\t\x00\x84A\xfc\x1e\x9eg\x0bj""
OK


127.0.0.1:6379> get key:0000002597151
""VXKeHogKgJ=[5V9_X^b?48OKF2jGA<f:iR@50o7dS3JV4Q6L68lC[GTA]0DaMg?_oSmcS2^N1J?ELSX@CfKQ7cM5aea\\ngY8a3LGgNVa9eRA46XS8>7ABe1>Jl9O\\Rm\\7IS:g\\U5b]=`ePo^LXhl4e:4P[DQNA3cgn<RH4UcdI6<V9S78NViC;^omK:<<Ldel:=iDmLB""

```

## kvrocks 

```
127.0.0.1:6379> RESTORE key0000002597151 0 ""\x00@\xc8VXKeHogKgJ=[5V9_X^b?48OKF2jGA<f:iR@50o7dS3JV4Q6L68lC[GTA]0DaMg?_oSmcS2^N1J?ELSX@CfKQ7cM5aea\\ngY8a3LGgNVa9eRA46XS8>7ABe1>Jl9O\\Rm\\7IS:g\\U5b]=`ePo^LXhl4e:4P[DQNA3cgn<RH4UcdI6<V9S78NViC;^omK:<<Ldel:=iDmLB\t\x00\x84A\xfc\x1e\x9eg\x0bj""
(error) ERR unexpected EOF

```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rvo79/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1894,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rvrft,kvrocks,1807661037,1894,NA,iushas,7236171,tanic.xiao,,NA,2023-11-13T08:23:03Z,2023-11-13T08:23:03Z,"you can use redis-benchmark  to insert  some keys in redis, and   use redis-shake to migrate from redis to kvrocks。 some key value cant be support by kvrocks

redis-benchmark -a xxx -h xx -c 250 -d 200 -e -q -n 3000000 -r 1000000 -t set","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rvrft/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1894,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rwod9,kvrocks,1807910781,1894,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-13T10:42:27Z,2023-11-13T10:42:27Z,"@iushas I see, it's a bug which was fixed in #1798. You can have a try at the latest version.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5rwod9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1894,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5r4aey,kvrocks,1809950642,1894,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-14T10:36:36Z,2023-11-14T10:36:36Z,"Close this issue, and feel free to reopen if this issue is still living.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5r4aey/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1896,https://api.github.com/repos/apache/kvrocks/issues/1896,kvrocks,2000267142,1896,Add support for the BITFIELD command,julic20s,97575247,,,CLOSED,2023-11-18T06:16:32Z,2023-12-03T15:29:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue considers to support the [bitfield](https://redis.io/commands/bitfield/) command.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1896/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1905,https://api.github.com/repos/apache/kvrocks/issues/1905,kvrocks,2008090565,1905,"Quickstart ""Error: Server closed the connection"" for any command",theronic,1011676,Petrus Theron,,CLOSED,2023-11-23T12:01:45Z,2023-11-23T12:15:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks version 2.6.0 (commit c0451df0)

macOS Ventura 13.4 on Apple M2 Pro Macbook Pro 14-inch 2023
Kvrocks: 

### Minimal reproduce step

As per [the docs](https://kvrocks.apache.org/blog/go-redis-kvrocks-opentelemetry/#getting-started-with-kvrocks):

    docker run -it -p 6666:6666 apache/kvrocks

In a separate terminal:

    redis-cli -p 6666
    > GET foo

### What did you expect to see?

Return nil or key value.

### What did you see instead?

On docker terminal:

```
I20231123 11:59:40.362723     1 main.cc:334] kvrocks version 2.6.0 (commit c0451df0)
I20231123 11:59:40.410612     1 storage.cc:332] [storage] Success to load the data from disk: 16 ms
I20231123 11:59:40.413663     1 worker.cc:72] [worker] Listening on: 127.0.0.1:6666
I20231123 11:59:40.414007     1 worker.cc:72] [worker] Listening on: 127.0.0.1:6666
I20231123 11:59:40.414085     1 worker.cc:72] [worker] Listening on: 127.0.0.1:6666
I20231123 11:59:40.414157     1 worker.cc:72] [worker] Listening on: 127.0.0.1:6666
I20231123 11:59:40.414258     1 worker.cc:72] [worker] Listening on: 127.0.0.1:6666
I20231123 11:59:40.414347     1 worker.cc:72] [worker] Listening on: 127.0.0.1:6666
I20231123 11:59:40.414443     1 worker.cc:72] [worker] Listening on: 127.0.0.1:6666
I20231123 11:59:40.414533     1 worker.cc:72] [worker] Listening on: 127.0.0.1:6666
I20231123 11:59:40.414712     1 worker.cc:515] [worker] Thread #281473666143544 started
I20231123 11:59:40.414757     1 worker.cc:515] [worker] Thread #281473654420792 started
I20231123 11:59:40.414800     1 worker.cc:515] [worker] Thread #281473654244664 started
I20231123 11:59:40.414839     1 worker.cc:515] [worker] Thread #281473654068536 started
I20231123 11:59:40.414875     1 worker.cc:515] [worker] Thread #281473653892408 started
I20231123 11:59:40.414916     1 worker.cc:515] [worker] Thread #281473653716280 started
I20231123 11:59:40.414952     1 worker.cc:515] [worker] Thread #281473632924984 started
I20231123 11:59:40.414999     1 worker.cc:515] [worker] Thread #281473632748856 started
I20231123 11:59:40.415161     1 server.cc:209] [server] Ready to accept connections
```

In redis-cli terminal:

```
Error: Server closed the connection
not connected>
```

### Anything Else?

Maybe I need to do some auth first, but the Quickstart guide does not specify this.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1905/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1905,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5svPFZ,kvrocks,1824321881,1905,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-23T12:08:01Z,2023-11-23T12:08:01Z,"Hi @theronic, thanks for your report. 

It's a fixed bug in Docker image configuration file, you can workaround by overwriting the bind address:

```shell
docker run -it -p 6666:6666 apache/kvrocks:2.6.0 --bind 0.0.0.0
```

refer: https://github.com/apache/kvrocks/issues/1851","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5svPFZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1905,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5svQDe,kvrocks,1824325854,1905,NA,theronic,1011676,Petrus Theron,,NA,2023-11-23T12:10:52Z,2023-11-23T12:10:52Z,"Thanks, that works! I saw a different error though than is described in that issue, so that issue did not show up in my search. Closing.

Please update the docs :) If someone tries the Quickstart for the first-time and it doesn't work, immediately you think ""oh oh - is this maintained?"" which reduces chance of adoption in risk-averse companies.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5svQDe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1905,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5svRYV,kvrocks,1824331285,1905,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-23T12:15:12Z,2023-11-23T12:15:12Z,"> Please update the docs :) If someone tries the Quickstart for the first-time and it doesn't work, immediately you think ""oh oh - is this maintained?"" which reduces chance of adoption in risk-averse companies.

Sure, thanks for your kind suggestions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5svRYV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1907,https://api.github.com/repos/apache/kvrocks/issues/1907,kvrocks,2009003394,1907,Sperate the layer of redis kv encode from the underlay storage,tutububug,40481744,,,OPEN,2023-11-24T02:50:37Z,2023-11-27T13:49:47Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

- Making the Redis encode layer as an independent library is good for other modules to use, it can accept Redis protocol and output encoded KV pairs.
- Other modules or programs can include the library and write to an abstract storage, it seems more inflexible.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1907/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1907,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s1F_E,kvrocks,1825857476,1907,NA,torwig,8588372,Yaroslav,,NA,2023-11-24T16:00:28Z,2023-11-24T16:00:28Z,@tutububug Assigned (if I understood your intent correctly).,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s1F_E/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1907,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s8xbt,kvrocks,1827870445,1907,NA,PragmaTwice,20042607,Twice,,NA,2023-11-27T13:49:46Z,2023-11-27T13:49:46Z,"That's a great proposal, but I'm unsure about the amount of effort required to accomplish it.

Feel free to give it a try and do some research!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5s8xbt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1908,https://api.github.com/repos/apache/kvrocks/issues/1908,kvrocks,2009038651,1908,Ooops! kvrocks version 2.6.0 (commit cac0ade4) got signal: Segmentation fault (11),iushas,7236171,tanic.xiao,,CLOSED,2023-11-24T03:27:15Z,2023-11-24T14:07:44Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.6.0

### Minimal reproduce step

-

### What did you expect to see?

-

### What did you see instead?
```
root@host:/home/redis/var/log# cat kvrocks.ERROR
Log file created at: 2023/11/24 10:45:56
Running on machine: redis-kvsenior01-210027.i.nease.net
Running duration (h:mm:ss): 0:00:00
Log line format: [IWEF]yyyymmdd hh:mm:ss.uuuuuu threadid file:line] msg
E20231124 10:45:56.856230  5147 main.cc:85] ======= Ooops! kvrocks version 2.6.0 (commit cac0ade4) got signal: Segmentation fault (11) =======
E20231124 10:45:56.856793  5147 main.cc:102] /lib/x86_64-linux-gnu/libpthread.so.0(+0x14140) [0x7f45cb08d140]
E20231124 10:45:56.857265  5147 main.cc:100] /home/redis/server/2.6.0/bin/kvrocks(+0x217769) [0x560584630769]  redis::Connection::ExecuteCommands()
E20231124 10:45:56.857934  5147 main.cc:100] /home/redis/server/2.6.0/bin/kvrocks(+0x1605ac) [0x5605845795ac]  EvbufCallbackBase<>::readCB()
E20231124 10:45:56.858131  5147 main.cc:100] /home/redis/server/2.6.0/bin/kvrocks(+0x7b0dee) [0x560584bc9dee]  bufferevent_run_deferred_callbacks_unlocked
E20231124 10:45:56.858312  5147 main.cc:100] /home/redis/server/2.6.0/bin/kvrocks(+0x7b738d) [0x560584bd038d]  event_process_active_single_queue
E20231124 10:45:56.858755  5147 main.cc:100] /home/redis/server/2.6.0/bin/kvrocks(+0x7b7d4f) [0x560584bd0d4f]  event_base_loop
E20231124 10:45:56.859345  5147 main.cc:100] /home/redis/server/2.6.0/bin/kvrocks(+0x23af1d) [0x560584653f1d]  _ZNSt6thread11_State_implINS_8_InvokerISt5tupleIJZN4util12CreateThreadIZN12WorkerThread5StartEvEUlvE_EE8StatusOrIS_EPKcT_EUlvE_EEEEE6_M_runEv.lto_priv.0
E20231124 10:45:56.859525  5147 main.cc:100] /home/redis/server/2.6.0/bin/kvrocks(+0x9aa7b0) [0x560584dc37b0]  execute_native_thread_routine
E20231124 10:45:56.859648  5147 main.cc:100] /lib/x86_64-linux-gnu/libpthread.so.0(+0x8ea7) [0x7f45cb081ea7]   start_thread
E20231124 10:45:56.859750  5147 main.cc:100] /lib/x86_64-linux-gnu/libc.so.6(clone+0x3f) [0x7f45cae6ddef]      clone

```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1908/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1908,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5syOmR,kvrocks,1825106321,1908,NA,iushas,7236171,tanic.xiao,,NA,2023-11-24T03:30:07Z,2023-11-24T03:30:07Z,"-  addr2line


```
root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks +0x217769
/home/redis/kvrocks/src/server/server.cc:1505
```
![image](https://github.com/apache/kvrocks/assets/7236171/1d8d5466-192d-483e-85f4-f23583cd2d6f)

```
root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks 0x23af1d
/home/redis/kvrocks/src/server/worker.cc:292
```
![image](https://github.com/apache/kvrocks/assets/7236171/05cc8b92-289f-4f9a-a01a-08024c2184ff)


```
root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks +0x9aa7b0
thread.o:?

root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks 0x9aa7b0
thread.o:?

root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks 0x23af1d
/home/redis/kvrocks/src/server/worker.cc:292


root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks 0x7b7d4f
/home/redis/kvrocks/build/_deps/libevent-src/event.c:1790


root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks +0x217769
/home/redis/kvrocks/src/server/server.cc:1505


root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks +0x1605ac
/usr/include/c++/10/bits/atomic_base.h:426

root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks +0x7b0dee
/home/redis/kvrocks/build/_deps/libevent-src/bufferevent.c:208 (discriminator 3)

root@host:/home/redis/var/log# addr2line -e  /home/redis/server/2.6.0/bin/kvrocks +0x7b7d4f
/home/redis/kvrocks/build/_deps/libevent-src/event.c:1790

root@host:/home/redis/var/log# addr2line -e /lib/x86_64-linux-gnu/libpthread.so.0 +0x14140
??:?
```

- dmesg
```
[Fri Nov 24 10:42:27 2023] worker[3173205]: segfault at 8 ip 0000560584630769 sp 00007f45bd7ec420 error 4 in kvrocks[56058449f000+94f000]
[Fri Nov 24 10:42:27 2023] Code: 8b 54 24 68 41 8b 44 24 68 c1 e8 06 81 e2 00 01 00 00 89 95 78 fe ff ff 0f 94 c2 84 c2 0f 85 db 0e 00 00 48 8b 85 f0 fe ff ff <48> 83 78 08 00 0f 85 bc 01 00 00 4c 8d 75 b0 4c 8d 7d c0 be 08 00
```

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5syOmR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1908,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sznLj,kvrocks,1825469155,1908,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-24T10:36:36Z,2023-11-24T10:36:36Z,@iushas Thanks for your report. This will be fixed in #1909.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5sznLj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1913,https://api.github.com/repos/apache/kvrocks/issues/1913,kvrocks,2015907820,1913,output for 'level0_file_limit_stop' from ino is empty,bbqccx,133967682,,,CLOSED,2023-11-29T06:28:47Z,2023-12-03T13:05:02Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

from 2.4 to 2.6

### Minimal reproduce step

info command

### What did you expect to see?

level0_file_limit_slowdown[default]:0
level0_file_limit_stop[default]:0
pending_compaction_bytes_slowdown[default]:0
pending_compaction_bytes_stop[default]:0
memtable_count_limit_slowdown[default]:0
memtable_count_limit_stop[default]:0

### What did you see instead?

level0_file_limit_slowdown[default]:
level0_file_limit_stop[default]:
pending_compaction_bytes_slowdown[default]:
pending_compaction_bytes_stop[default]:
memtable_count_limit_slowdown[default]:
memtable_count_limit_stop[default]:

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1913/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1913,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tQpmj,kvrocks,1833081251,1913,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-11-30T04:16:09Z,2023-11-30T04:16:09Z,"@bbqccx Thanks for your feedback, will fix this in next release.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5tQpmj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1922,https://api.github.com/repos/apache/kvrocks/issues/1922,kvrocks,2029762989,1922,Got (error) ERR MOVED when use redis-cli -c,jiangyunpeng,1752994,,,CLOSED,2023-12-07T02:42:40Z,2023-12-08T13:28:23Z,"
### Version

Redis-cli version: 6.2.5
Kvrocks version: 2.6.0

### Minimal reproduce step

Run follow command:

```
redis-cli -h 172.16.49.83 -p 7383 -c

set test abc
```

### What did you expect to see?

ok

### What did you see instead?

(error) ERR MOVED 6918 172.16.49.96:7384

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1922/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1922,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5t6yaL,kvrocks,1844127371,1922,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-07T02:47:38Z,2023-12-07T02:47:38Z,"@jiangyunpeng Thanks for your report, will take a look later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5t6yaL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1923,https://api.github.com/repos/apache/kvrocks/issues/1923,kvrocks,2030577438,1923,Add more statistics into kvrocks INFO,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,CLOSED,2023-12-07T11:37:59Z,2023-12-27T01:56:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue is used to record the suggestion raised in the WeChat group.

Suggested add below statistics into kvrocks INFO:

- [x] #1936
- [x] #1937

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1923/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1925,https://api.github.com/repos/apache/kvrocks/issues/1925,kvrocks,2031137325,1925,Set command supports NX and GET options used together,siwee,70388114,,,CLOSED,2023-12-07T16:44:22Z,2023-12-18T10:13:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

New features in Redis 7.0.0.

## History
- Starting with Redis version 2.6.12: Added the EX, PX, NX and XX options.
- Starting with Redis version 6.0.0: Added the KEEPTTL option.
- Starting with Redis version 6.2.0: Added the GET, EXAT and PXAT option.
- Starting with Redis version 7.0.0: Allowed the NX and GET options to be used together.

redis docs: https://redis.io/commands/set/


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1925/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1925,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uDqvw,kvrocks,1846455280,1925,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-08T02:23:24Z,2023-12-08T02:23:24Z,"Hi @tarvfx, thanks for your proposal.

From the Kvrocks side, what we need to be supported in the SET command are:

- KEEPTTL option(EX, PX, NX and XX options are supported now)
- Allowed to use the GET option together with EXAT/PXAT/NX

Did I miss anything?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uDqvw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1925,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uOK2q,kvrocks,1849208234,1925,NA,siwee,70388114,,,NA,2023-12-11T01:59:58Z,2023-12-11T01:59:58Z,"Hi, @git-hulk 

Thanks, you filled in what I missed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uOK2q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1925,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uWUTa,kvrocks,1851344090,1925,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-12-12T05:49:51Z,2023-12-12T05:49:51Z,"Adding the `KEEPTTL` and `GET` option to the set command is difficulty in the current implementation.
I will change the [`types/redis_string#Set`](https://github.com/jihuayu/incubator-kvrocks/blob/358cc4101651cfd19f558f9e46ef377c36b70ba6/src/types/redis_string.h#L45) function impl, Make it compatible with the new format of the `Set` command. And make [`SetEX`, `SetNX`, `SetXX`](https://github.com/jihuayu/incubator-kvrocks/blob/358cc4101651cfd19f558f9e46ef377c36b70ba6/src/types/redis_string.h#L46-L48) call the new `Set` function
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uWUTa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1925,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uWXYG,kvrocks,1851356678,1925,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-12T06:04:01Z,2023-12-12T06:04:01Z,@jihuayu Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uWXYG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1926,https://api.github.com/repos/apache/kvrocks/issues/1926,kvrocks,2032164623,1926,Missing `redis_mode` field in INFO command,mnizhq007,23118518,,,CLOSED,2023-12-08T08:17:44Z,2023-12-08T09:41:30Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks：2.5.1
redis-cli：4.0


### Minimal reproduce step

The Redis manager tool can't recognize the Kvrocks when enabling the cluster mode. And I found is may be caused by missing `redis_mode` field in Kvrocks's info command.

在使用开源工具redis manger时，发现无法识别kvrocks集群，排查日志，显示为redis mode返回值为kong
![2af0bce70f1ebb38d9de002b117c7c0](https://github.com/apache/kvrocks/assets/23118518/e0514f79-5e27-4ba6-9696-8f583827b5de)
![14b6b8150535367b91cfea933680bee](https://github.com/apache/kvrocks/assets/23118518/2edd00c1-5cad-4b52-a5cb-f5d09fe3cd2e)


### What did you expect to see?

Kvrocks's INFO command should return `redis_mode` to make the Redis manager happy.

登录kvrocks执行INFO SERVER后，redis mode会返回对应信息。

### What did you see instead?

登录kvrocks，执行INFO SERVER
![a53689e824ec091dd81ac5447a48a93](https://github.com/apache/kvrocks/assets/23118518/09e398ef-169b-46f8-82b9-42522d7c6f80)
没有返回该字段，而Redis会返回
![fa29fb0a83d78b14ee8cbb8be690c7c](https://github.com/apache/kvrocks/assets/23118518/4e8ff3c8-eefd-46fa-af84-17273c06b955)

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1926/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1929,https://api.github.com/repos/apache/kvrocks/issues/1929,kvrocks,2033555244,1929,Add version information for each command to the Supported Commands page in website,PragmaTwice,20042607,Twice,,CLOSED,2023-12-09T02:49:35Z,2023-12-28T03:24:21Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://kvrocks.apache.org/docs/supported-commands

We'd better to add which version each command started to be supported, e.g.

|Command|Since Version|
|-|-|
|FCALL|2.7.0|


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1929/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1929,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uKZc3,kvrocks,1848219447,1929,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-12-09T04:11:09Z,2023-12-09T04:11:09Z,This may not be a good first issue but actually the contributor should know detail about the command impl history :D,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uKZc3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1929,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uOYXM,kvrocks,1849263564,1929,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-12-11T03:22:48Z,2023-12-11T03:22:48Z,"Contributors can write a string matching program to check if each command exists in a specific version of the source code. 
So I think the contributor don't need to know detail about the command impl history","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5uOYXM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1929,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u0TRJ,kvrocks,1859204169,1929,NA,kay011,64449652,,,NA,2023-12-17T15:36:22Z,2023-12-17T15:36:22Z,"Hello, can you assign this issue to me?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u0TRJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1929,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u1KDu,kvrocks,1859428590,1929,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-18T02:05:59Z,2023-12-18T02:05:59Z,"@kay011 Thank you! As @jihuayu mentioned, maybe a quick way is to write a program to detect the support commands in each version.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u1KDu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1929,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6Aj2,kvrocks,1860700406,1929,NA,kay011,64449652,,,NA,2023-12-18T14:49:55Z,2023-12-18T14:49:55Z,"@git-hulk Yeah！I plan to check the commands supported by each version through Python regular expressions. I will submit this script file and the final markdown file. This should be quick. Just paste the final results on the final docs.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6Aj2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1936,https://api.github.com/repos/apache/kvrocks/issues/1936,kvrocks,2045239880,1936,Add rocksdb block cache hit/miss statistics,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-12-17T14:26:43Z,2023-12-18T02:02:22Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1936/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1937,https://api.github.com/repos/apache/kvrocks/issues/1937,kvrocks,2045239993,1937,Add `keyspace_hits` and `keyspace_misses` statistics that be consistent with Redis,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2023-12-17T14:27:06Z,2023-12-27T01:45:48Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1937/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1937,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u0QZ-,kvrocks,1859192446,1937,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-17T14:46:30Z,2023-12-17T14:46:30Z,It needs to do some minor refactoring before adding this metric since now many places will read metadata directly. I will do it while I'm free before the next release.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u0QZ-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1939,https://api.github.com/repos/apache/kvrocks/issues/1939,kvrocks,2045906475,1939,Can't build unittest with gcc8.5 and clang 12,Smityz,22953824,Smilencer,smityz@qq.com,OPEN,2023-12-18T07:28:02Z,2023-12-18T08:36:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

centos8/gcc8.5/clang12
kvrocks: unstable/2ecf764d

### Minimal reproduce step

./x.py build -j 20 --unittest
```
Consolidate compiler generated dependencies of target unittest
[ 94%] Linking CXX executable unittest
CMakeFiles/unittest.dir/tests/cppunit/compact_test.cc.o: In function `Compact_Filter_Test::TestBody()':
/usr/include/c++/8/bits/fs_path.h:185: undefined reference to `std::filesystem::__cxx11::path::_M_split_cmpts()'
CMakeFiles/unittest.dir/tests/cppunit/compact_test.cc.o: In function `Compact_Filter_Test::TestBody()':
/home/yanzhao.tang/Code/kvrocks/tests/cppunit/compact_test.cc:128: undefined reference to `std::filesystem::remove_all(std::filesystem::__cxx11::path const&, std::error_code&)'
CMakeFiles/unittest.dir/tests/cppunit/disk_test.cc.o: In function `TestBase::~TestBase()':
/usr/include/c++/8/bits/fs_path.h:185: undefined reference to `std::filesystem::__cxx11::path::_M_split_cmpts()'
CMakeFiles/unittest.dir/tests/cppunit/disk_test.cc.o: In function `TestBase::~TestBase()':
```
./x.py build -j 20 --unittest --compiler clang
```
[100%] Linking CXX executable unittest
ld.lld: error: undefined symbol: std::filesystem::__cxx11::path::_M_split_cmpts()
>>> referenced by fs_path.h:185 (/usr/lib/gcc/x86_64-redhat-linux/8/../../../../include/c++/8/bits/fs_path.h:185)
>>>               CMakeFiles/unittest.dir/tests/cppunit/compact_test.cc.o:(Compact_Filter_Test::TestBody())
>>> referenced by fs_path.h:185 (/usr/lib/gcc/x86_64-redhat-linux/8/../../../../include/c++/8/bits/fs_path.h:185)
>>>               CMakeFiles/unittest.dir/tests/cppunit/disk_test.cc.o:(TestBase::~TestBase())
>>> referenced by fs_path.h:185 (/usr/lib/gcc/x86_64-redhat-linux/8/../../../../include/c++/8/bits/fs_path.h:185)
>>>               CMakeFiles/unittest.dir/tests/cppunit/rdb_test.cc.o:(std::filesystem::__cxx11::path::path<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::filesystem::__cxx11::path>(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, std::filesystem::__cxx11::path::format))
```
### What did you expect to see?

code compiled

### What did you see instead?

code not compiled

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1939/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/1941,kvrocks,2046112358,1941,CONFIG REWRITE cmd overrides my new cfg,xiaofan8421,22815750,Roy,xiaofan8421@gmail.com,CLOSED,2023-12-18T09:08:37Z,2023-12-19T08:01:06Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks v2.4.0 and v2.6.0
we fork based on Kvrocks these versions and implement new product features.

### Minimal reproduce step

1. UAT/PRE Kvrocks cluster environment, add some namespace, then auth them, add lots of KVs.
2. Deploy new cfg to old cfg path.
3. send ""CONFIG REWRITE"" to Kvrocks by Redis-cli for persisting namespace info to new cfg. 

### What did you expect to see?

new cfg should only show the namespaces info in the tail of kvrocks.cfg and should not change other fields in my cfg.


### What did you see instead?

some other cfg fields changes before ""################################ NAMESPACE #####################################"" in kvrocks.conf?

### Anything Else?

![image](https://github.com/apache/kvrocks/assets/22815750/3c9e00de-f4a1-4549-bc8f-24fba501ebb5)
1. CONFIG REWRITE not only saves namespace info into cfg, but also changes other cfg fields. Right? Why need to do it?
2. If CONFIG REWRITE will change Kvrocks.conf definitely, how do I know what fields in my cfg will change every persist cfg by CONFIG REWRITE. 
3. #1882 issue already has solved it? if done, what I need to upgrade Kvrocks to the latest v2.7.0 Right?

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1941/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u3RIc,kvrocks,1859981852,1941,NA,PragmaTwice,20042607,Twice,,NA,2023-12-18T10:00:05Z,2023-12-18T10:00:05Z,"IMHO I don't think it is a BUG.

`CONFIG REWRITE` is to rewrite all current server configuration to the config file `kvrocks.conf`, which of course does not only include namespace changes, but also all configuration changes, e.g. if the current value of `bind` in the kvrocks server is `x.x.x.x`, but in `kvrocks.conf` it's `y.y.y.y`, `CONFIG REWRITE` will overwrite it to `x.x.x.x`. By this way, kvrocks can persist configuration changes made by `CONFIG SET`. And it's same as in redis.

Please refer to https://redis.io/commands/config-rewrite/ for further understanding.

And please enable `repl-namespace-enabled` https://github.com/apache/kvrocks/blob/2ecf764db9a393a414c7239410db198079bed573/kvrocks.conf#L62 if you want to store namespace information to rocksdb instead of `kvrocks.conf`, which is encouraged.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u3RIc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u4yEf,kvrocks,1860378911,1941,NA,xiaofan8421,22815750,Roy,xiaofan8421@gmail.com,NA,2023-12-18T12:34:11Z,2023-12-18T12:34:11Z,"Thanks for your reply. But I still have a little confused about Kvrocks' persist cfg impl.
Background:
  If I need to upgrade Kvrocks(Maybe only bin or cfg,  or combine with them), what is the best practice in production？
  
At least, It seems that no official doc to talk about upgradation with Kvrocks(bin or cfg)  safely.

In another way, As we know, not all cfg is supported for reloading dynamically. 
It's common for us to restart Kvrocks to let cfg load effectively in another lifetime. 

The one: persist old Kvrocks's namespace into my new cfg by the persist way for CONFIG REWRITE to upgrade Kvrocks, then Kvrocks restart to load new cfg. (Drawbacks: override my new cfg partial fields)
The other one:  read namespace info from the tail of old cfg(old Kvrocks.conf) by scripts, then appending these namespace into my new cfg to avoid that some cfg fields are changed unexpectedly in my Kvrocks.conf
Which do you recommend?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u4yEf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u5L2u,kvrocks,1860484526,1941,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-18T13:21:00Z,2023-12-18T13:21:00Z,"@xiaofan8421 I'm not quite sure if I understand your question correctly. 

Do you mean that you edit the configuration file and don't expect it to be overridden by Kvrocks? If yes, you can use `config rewrite` to dump the live configuration first, then modify items you want and restart Kvrocks after that.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u5L2u/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u5cMh,kvrocks,1860551457,1941,NA,xiaofan8421,22815750,Roy,xiaofan8421@gmail.com,NA,2023-12-18T13:49:22Z,2023-12-18T13:49:22Z,"> @xiaofan8421 I'm not quite sure if I understand your question correctly.
> 
> Do you mean that you edit the configuration file and don't expect it to be overridden by Kvrocks? If yes, you can use `config rewrite` to dump the live configuration first, then modify items you want and restart Kvrocks after that.

Yes,  I also list the two solutions above your answer. But too manual to auto, and depends on the diff(persist cfg by CONFIG REWRITE VS new cfg by deploying) mechanism.
It sounds like that lack of elegance, but Maybe this problem is not the actual problem.

In general, we directly use persist cfg by CONFIG REWRITE and then modify them are much more better and scientific than  adopt the way of unverified  new cfg. Right? Namely, Above the former one is safer than the latter one.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u5cMh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u5ugf,kvrocks,1860626463,1941,NA,PragmaTwice,20042607,Twice,,NA,2023-12-18T14:19:49Z,2023-12-18T14:19:49Z,"As I mentioned previously, since `2.7.0`, I think you can try to set `repl-namespace-enabled` to `yes`, which can store namespace information into database directly rather than `kvrocks.conf`. And then you don't need to care about the namespace section in `kvrocks.conf` anymore. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u5ugf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u50VN,kvrocks,1860650317,1941,NA,xiaofan8421,22815750,Roy,xiaofan8421@gmail.com,NA,2023-12-18T14:29:47Z,2023-12-18T14:29:47Z,"> As I mentioned previously, since `2.7.0`, I think you can try to set `repl-namespace-enabled` to `yes`, which can store namespace information into database directly rather than `kvrocks.conf`. And then you don't need to care about the namespace section in `kvrocks.conf` anymore.

Cool. 
It sounds like much more elegant than flush namespace into kvrocks.conf. That's all I need.
I will perform PoC validation later.
Thanks again.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u50VN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6iO_,kvrocks,1860838335,1941,NA,xiaofan8421,22815750,Roy,xiaofan8421@gmail.com,NA,2023-12-18T15:37:44Z,2023-12-18T15:37:44Z,"> IMHO I don't think it is a BUG.
> 
> `CONFIG REWRITE` is to rewrite all current server configuration to the config file `kvrocks.conf`, which of course does not only include namespace changes, but also all configuration changes, e.g. if the current value of `bind` in the kvrocks server is `x.x.x.x`, but in `kvrocks.conf` it's `y.y.y.y`, `CONFIG REWRITE` will overwrite it to `x.x.x.x`. By this way, kvrocks can persist configuration changes made by `CONFIG SET`. And it's same as in redis.
> 
> Please refer to https://redis.io/commands/config-rewrite/ for further understanding.
> 
> And please enable `repl-namespace-enabled`
> 
> https://github.com/apache/kvrocks/blob/2ecf764db9a393a414c7239410db198079bed573/kvrocks.conf#L62
> 
> if you want to store namespace information to rocksdb instead of `kvrocks.conf`, which is encouraged.

Thanks for your reference to Redis's official doc about CONFIG REWRITE.
But ""# replica-announce-port 1234"" is the default in Kvrocks.conf, why here shows ""replica-announce-port 0"" the tail of kvrocks.conf. Will it conform to their principle? I think that I didn't change it explicitly in my snapshot about kvrocks.conf at that time.
if ""#"" represents default no or 0, Maybe it is much more suitable to not display it.  
![image](https://github.com/apache/kvrocks/assets/22815750/a4052998-668b-4300-b180-9c55ff614399)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6iO_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6iyL,kvrocks,1860840587,1941,NA,xiaofan8421,22815750,Roy,xiaofan8421@gmail.com,NA,2023-12-18T15:38:36Z,2023-12-18T15:38:36Z,"> > As I mentioned previously, since `2.7.0`, I think you can try to set `repl-namespace-enabled` to `yes`, which can store namespace information into database directly rather than `kvrocks.conf`. And then you don't need to care about the namespace section in `kvrocks.conf` anymore.
> 
> Cool. It sounds like much more elegant than flush namespace into kvrocks.conf. That's all I need. I will perform PoC validation later. Thanks again.

Great!
It works well.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6iyL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1941,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u_Q9J,kvrocks,1862078281,1941,NA,xiaofan8421,22815750,Roy,xiaofan8421@gmail.com,NA,2023-12-19T03:58:57Z,2023-12-19T03:58:57Z,"


> > @xiaofan8421 I'm not quite sure if I understand your question correctly.
> > Do you mean that you edit the configuration file and don't expect it to be overridden by Kvrocks? If yes, you can use `config rewrite` to dump the live configuration first, then modify items you want and restart Kvrocks after that.
> 
> Yes, I also list the two solutions above your answer. But too manual to auto, and depends on the diff(persist cfg by CONFIG REWRITE VS new cfg by deploying) mechanism. It sounds like that lack of elegance, but Maybe this problem is not the actual problem.
> 
> In general, we directly use persist cfg by CONFIG REWRITE and then modify them are much more better and scientific than adopt the way of unverified new cfg. Right? Namely, Above the former one is safer than the latter one.

But except namespace(which elegantly stores into rocksdb now for v2.7.0), other cfg fields which are persisted into kvrocks.conf by Kvrocks still faces this problem when upgrading.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u_Q9J/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/1942,kvrocks,2046858073,1942,Tracking Issue: Towards a more redis-compatible database,PragmaTwice,20042607,Twice,,OPEN,2023-12-18T14:58:46Z,2024-10-09T05:14:01Z,"In order to be more compatible with redis, here are commands that exist in Redis (excluding Redis Stack) but are not supported in Kvrocks:

- [x] #1944
- [x] #1945
- [x] #1946
- [x] #1947
- [x] #1948
- [ ] #1949
- [x] #1950
- [x] #1951
- [x] #1952
- [x] #1954
- [x] #1955
- [x] #1958
- [x] #1959
- [x] #1983
- [x] #1984
- [x] #1985
- [x] #2166 
- [x] #2168
- [x] #2185
- [ ] ... (maybe not fully listed)

We very much welcome anyone to claim the tasks and start to contribute to Kvrocks. If you need any help during the contribution process, you can leave a message under the corresponding issue.

Also, the parts of existing commands that are incompatible with redis are worthy of attention and welcome any contribution.

- [x] #1212
- [x] #2006
- [x] #2014
- [ ] ... adding more

It succeed #595.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1942/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6JMy,kvrocks,1860735794,1942,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2023-12-18T15:01:33Z,2023-12-18T15:01:33Z,"Test suite in other client impl can help.

We writes C++ unit tests and Golang cases with redis-go. IIRC redis-go runs regression tests for Kvrocks also.

I tried Redisson but still have some troubles - https://github.com/apache/kvrocks/discussions/1912

Perhaps also other clients in https://redis.io/resources/clients/","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u6JMy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vvr2L,kvrocks,1874771339,1942,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-03T02:13:30Z,2024-01-03T02:13:30Z,"We can add support for `BITOPS` command BIT/BYTE option 
- https://github.com/apache/kvrocks/issues/1212","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vvr2L/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vvxfo,kvrocks,1874794472,1942,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-03T03:03:41Z,2024-01-03T03:03:41Z,@jihuayu done,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vvxfo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PDtbt,kvrocks,2400114413,1942,NA,judahrand,17158624,Judah Rand,,NA,2024-10-08T15:06:47Z,2024-10-08T15:06:47Z,One command which would be **_amazing_** to have would be: `CLIENT TRACKING` (https://redis.io/docs/latest/commands/client-tracking/). `redis-py` just added support for easily setting up a cache which is automatically invalidated by Redis and it would be incredible if KvRocks could do this too.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PDtbt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PEEG4,kvrocks,2400207288,1942,NA,PragmaTwice,20042607,Twice,,NA,2024-10-08T15:44:36Z,2024-10-08T15:44:36Z,"> One command which would be **_amazing_** to have would be: `CLIENT TRACKING` (https://redis.io/docs/latest/commands/client-tracking/). `redis-py` just added support for easily setting up a cache which is automatically invalidated by Redis and it would be incredible if KvRocks could do this too.

Yeah client-side caching is in our roadmap. cc @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PEEG4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PHmPL,kvrocks,2401133515,1942,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-09T02:13:02Z,2024-10-09T02:13:02Z,"Yes, one obstacle we need to overcome is knowing if a key has expired.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PHmPL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PH_C8,kvrocks,2401235132,1942,NA,PragmaTwice,20042607,Twice,,NA,2024-10-09T04:00:38Z,2024-10-09T04:00:38Z,"> Yes, one obstacle we need to overcome is knowing if a key has expired.

For me I think we can move the responsibility of expiration detection from the server to clients. i.e. clients should store the key-value cache as well as the TTL.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PH_C8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PIKmm,kvrocks,2401282470,1942,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-09T04:19:24Z,2024-10-09T04:19:24Z,"> > Yes, one obstacle we need to overcome is knowing if a key has expired.
> 
> For me I think we can move the responsibility of expiration detection from the server to clients. i.e. clients should store the key-value cache as well as the TTL.

For Redis client-side caching, it will send an invalid message notification once it's expired or evicted due to the memory policy. I'm not sure whether most SDKs will add a default TTL for keys or not. If yes, it should be fine. Or it should be a problem since the expiration needs to depend on the compaction timing.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PIKmm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PIVII,kvrocks,2401325576,1942,NA,PragmaTwice,20042607,Twice,,NA,2024-10-09T05:06:51Z,2024-10-09T05:06:51Z,"> > > Yes, one obstacle we need to overcome is knowing if a key has expired.
> > 
> > 
> > For me I think we can move the responsibility of expiration detection from the server to clients. i.e. clients should store the key-value cache as well as the TTL.
> 
> For Redis client-side caching, it will send an invalid message notification once it's expired or evicted due to the memory policy. I'm not sure whether most SDKs will add a default TTL for keys or not. If yes, it should be fine. Or it should be a problem since the expiration needs to depend on the compaction timing.

It's hard for kvrocks to send notifications on expiration, but for any other writing we can notify, of course. We need to state this point to client implementations to let them store the TTL.

It's also recommended in the Redis documentation for client implementation hints:
> Handling TTLs: make sure you also request the key TTL and set the TTL in the local cache if you want to support caching keys with a TTL.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PIVII/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1942,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PIW1D,kvrocks,2401332547,1942,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-09T05:14:01Z,2024-10-09T05:14:01Z,"> It's also recommended in the Redis documentation for client implementation hints:

Yes, that makes sense. I will go through the Redis server and its SDK implementation for client-side caching when I get time. And then propose a discussion or design. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PIW1D/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1944,https://api.github.com/repos/apache/kvrocks/issues/1944,kvrocks,2046892901,1944,Add support of the command RESET,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:15:28Z,2024-01-14T03:26:20Z,Refer to https://redis.io/commands/reset/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1944/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1944,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_CIu,kvrocks,1878794798,1944,NA,chrisxu333,44099579,Nuo Xu,,NA,2024-01-05T14:48:15Z,2024-01-05T14:48:15Z,I can help take over this issue if nobody is working on this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_CIu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1944,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_Dv3,kvrocks,1878801399,1944,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-05T14:53:03Z,2024-01-05T14:53:03Z,"@chrisxu333 assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_Dv3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1944,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wTbcI,kvrocks,1884141320,1944,NA,chrisxu333,44099579,Nuo Xu,,NA,2024-01-10T03:41:09Z,2024-01-10T03:41:09Z,"Hi all, I've submitted a pr to solve this issue. Please help review :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wTbcI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/1945,kvrocks,2046893041,1945,Add support of the command COPY,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:15:32Z,2024-04-12T13:03:12Z,Refer to https://redis.io/commands/copy/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1945/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u8mVU,kvrocks,1861379412,1945,NA,Qiaolin-Yu,90088090,Qiaolin Yu,qy254@cornell.edu,NA,2023-12-18T19:12:51Z,2023-12-18T19:12:51Z,I want to try. Can you assign this to me?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u8mVU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vB-8z,kvrocks,1862790963,1945,NA,PragmaTwice,20042607,Twice,,NA,2023-12-19T13:47:57Z,2023-12-19T13:47:57Z,Sure! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vB-8z/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFf6e,kvrocks,1863712414,1945,NA,Qiaolin-Yu,90088090,Qiaolin Yu,qy254@cornell.edu,NA,2023-12-20T01:44:50Z,2023-12-20T01:44:50Z,May I know where I should write my unit tests?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFf6e/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFkFy,kvrocks,1863729522,1945,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-20T01:57:15Z,2023-12-20T01:57:15Z,@Qiaolin-Yu It's good to add Go tests only.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFkFy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFwfa,kvrocks,1863780314,1945,NA,Qiaolin-Yu,90088090,Qiaolin Yu,qy254@cornell.edu,NA,2023-12-20T03:07:47Z,2023-12-20T03:07:47Z,"By the way, for the optional part ```[DB destination-db]```, what should I do to write the KV to the ```destination-db```? Should I use ```RedisWriter::selectDB``` to implement?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFwfa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDmBD,kvrocks,1913544771,1945,NA,MaheshMadushan,58337761,Mahesh Jayawardhana,,NA,2024-01-28T10:17:03Z,2024-01-28T10:17:03Z,"Hi @Qiaolin-Yu , according to my observation KVROCKS doesn't have DB instead you can use [namespace](https://kvrocks.apache.org/docs/namespace/) concept. Please verify with @git-hulk and @PragmaTwice ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDmBD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDwKx,kvrocks,1913586353,1945,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-28T12:51:53Z,2024-01-28T12:51:53Z,"@MaheshMadushan You're right. The RENAME command also has similar issue, so we can use the namespace in those commands.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDwKx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yEZK6,kvrocks,1913754298,1945,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-28T23:13:35Z,2024-01-28T23:13:35Z,"> @MaheshMadushan You're right. The RENAME command also has similar issue, so we can use the namespace in those commands.

@git-hulk Maybe not the RENAME command, but the MOVE command","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yEZK6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yEkQ6,kvrocks,1913799738,1945,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-29T01:08:58Z,2024-01-29T01:08:58Z,"@jihuayu Sorry for the wrong information. Yes, that's MOVE command instead of RENAME.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yEkQ6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55uQQw,kvrocks,2042168368,1945,NA,Chiro11,44946252,,,NA,2024-04-08T08:31:00Z,2024-04-08T08:31:00Z,"> By the way, for the optional part `[DB destination-db]`, what should I do to write the KV to the `destination-db`? Should I use `RedisWriter::selectDB` to implement?

@Qiaolin-Yu Hi, are you still working on this issue?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55uQQw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM555FYn,kvrocks,2045007399,1945,NA,Chiro11,44946252,,,NA,2024-04-09T12:11:17Z,2024-04-09T12:11:17Z,"@git-hulk I think you can assign it to me now 'cause he hasn't responded for two months. This cmd is similar to `MOVE` and `RENAME`, suitable for me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM555FYn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM555PDg,kvrocks,2045047008,1945,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-09T12:22:18Z,2024-04-09T12:22:18Z,@Chiro11 Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM555PDg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM555cvZ,kvrocks,2045103065,1945,NA,Chiro11,44946252,,,NA,2024-04-09T12:46:43Z,2024-04-09T12:46:43Z,"@git-hulk To adapt to kvrocks, it may need to make minor modifications.
redis ver: `COPY source destination [DB destination-db] [REPLACE]`
I think we can replace 'DB' with 'NS'/'NAMESPACE'/'TO', or keep it, and replace destination-db to token.
What do you think?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM555cvZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1945,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM555xYS,kvrocks,2045187602,1945,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-09T13:31:02Z,2024-04-09T13:31:02Z,@Chiro11 Perhaps we can support the [DB](DB must be 0) first and copy between namespaces should be implemented as COPYX. ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM555xYS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/1946,kvrocks,2046893159,1946,Add support of the command DUMP,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:15:36Z,2024-04-08T11:02:04Z,Refer to https://redis.io/commands/dump/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1946/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtlQE,kvrocks,1907774468,1946,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-01-24T09:49:04Z,2024-01-24T09:49:04Z,"I noticed that this ISSUE hasn't been assigned to anyone for resolution, but it was mentioned in another issue #1949  that it should be done. 
@maochongxin Have you started working on it?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtlQE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtm-p,kvrocks,1907781545,1946,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2024-01-24T09:53:21Z,2024-01-24T09:53:21Z,"> I noticed that this ISSUE hasn't been assigned to anyone for resolution, but it was mentioned in another issue #1949  that it should be done. 
> 
> @maochongxin Have you started working on it?

You can do it, I may not have time to do this, thanks ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtm-p/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtnYV,kvrocks,1907783189,1946,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-01-24T09:54:22Z,2024-01-24T09:54:22Z,"> > I noticed that this ISSUE hasn't been assigned to anyone for resolution, but it was mentioned in another issue #1949  that it should be done.
> > @maochongxin Have you started working on it?
> 
> You can do it, I may not have time to do this, thanks

Thanks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtnYV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtoVt,kvrocks,1907787117,1946,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-01-24T09:56:34Z,2024-01-24T09:56:34Z,"@PragmaTwice 
Can you please assign this issue to me? 
Also, I've noticed that the DUMP command is closely related to the RESTORE command. 
Perhaps I can create a new issue for RESTORE and implement both commands simultaneously?

https://redis.io/commands/restore/","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtoVt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtrye,kvrocks,1907801246,1946,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-24T10:03:33Z,2024-01-24T10:03:33Z,"@AntiTopQuark Assigned. Thanks for your interest.

@maochongxin Thanks for your reply and efforts.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtrye/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtsjA,kvrocks,1907804352,1946,NA,PragmaTwice,20042607,Twice,,NA,2024-01-24T10:05:21Z,2024-01-24T10:05:21Z,"> Also, I've noticed that the DUMP command is closely related to the RESTORE command.
Perhaps I can create a new issue for RESTORE and implement both commands simultaneously?

RESTORE is already supported in https://github.com/apache/kvrocks/pull/1684.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xtsjA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55PW_G,kvrocks,2034069446,1946,NA,Chiro11,44946252,,,NA,2024-04-03T09:41:51Z,2024-04-03T09:41:51Z,@AntiTopQuark Are you still working on it?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55PW_G/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55PqwR,kvrocks,2034150417,1946,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-04-03T10:10:37Z,2024-04-03T10:10:37Z,"> @AntiTopQuark Are you still working on it?

I sincerely apologize for the prolonged delay. I am still working on this task and will do my best to complete it within the next three days. My apologies once again.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55PqwR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1946,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55Xu7q,kvrocks,2036264682,1946,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-04-04T06:10:05Z,2024-04-04T06:10:05Z,@AntiTopQuark Thank you for your efforts. We look forward to your PR. ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55Xu7q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1947,https://api.github.com/repos/apache/kvrocks/issues/1947,kvrocks,2046893250,1947,Add support of the command EXPIRETIME,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:15:38Z,2023-12-26T13:07:30Z,Refer to https://redis.io/commands/expiretime/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1947/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1947,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vS-8F,kvrocks,1867247365,1947,NA,kay011,64449652,,,NA,2023-12-22T05:09:58Z,2023-12-22T05:09:58Z,Can you assign it to me?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vS-8F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1947,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vS_df,kvrocks,1867249503,1947,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-22T05:14:04Z,2023-12-22T05:14:04Z,"@kay011 Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vS_df/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1948,https://api.github.com/repos/apache/kvrocks/issues/1948,kvrocks,2046894123,1948,Add support of the command PEXPIRETIME,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:16:06Z,2023-12-26T13:07:15Z,Refer to https://redis.io/commands/pexpiretime/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1948/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1948,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWqoV,kvrocks,1868212757,1948,NA,kay011,64449652,,,NA,2023-12-23T05:34:43Z,2023-12-23T05:34:43Z,"I think this command can be supported together with #1947 , and assigned to me. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWqoV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1948,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWsMv,kvrocks,1868219183,1948,NA,PragmaTwice,20042607,Twice,,NA,2023-12-23T06:16:10Z,2023-12-23T06:16:10Z,Looks good to me! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vWsMv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1949,https://api.github.com/repos/apache/kvrocks/issues/1949,kvrocks,2046894244,1949,Add support of the command MIGRATE,PragmaTwice,20042607,Twice,,OPEN,2023-12-18T15:16:11Z,2023-12-28T12:58:59Z,Refer to https://redis.io/commands/migrate/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1949/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1949,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vht2W,kvrocks,1871109526,1949,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2023-12-28T12:12:19Z,2023-12-28T12:12:19Z,"I would like to take ownership of this issue because the MIGRATE command requires DUMP to be implemented, and I think it can be implemented together with DUMP #1946 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vht2W/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1949,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vh3xD,kvrocks,1871150147,1949,NA,PragmaTwice,20042607,Twice,,NA,2023-12-28T12:58:54Z,2023-12-28T12:58:54Z,Great! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vh3xD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/1950,kvrocks,2046894308,1950,Add support of the command MOVE,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:16:13Z,2024-04-07T13:31:06Z,Refer to https://redis.io/commands/move/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1950/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u_aNT,kvrocks,1862116179,1950,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-12-19T04:54:18Z,2023-12-19T04:54:18Z,"Kvrocks don't have DB, we have [namespace](https://kvrocks.apache.org/docs/namespace) instead.
So should we use namespace token in this command?
```shell
move key namespace_token
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5u_aNT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vB_24,kvrocks,1862794680,1950,NA,PragmaTwice,20042607,Twice,,NA,2023-12-19T13:50:22Z,2023-12-19T13:50:22Z,"> Kvrocks don't have DB, we have [namespace](https://kvrocks.apache.org/docs/namespace) instead. So should we use namespace token in this command?
> 
> ```shell
> move key namespace_token
> ```

Looks good to me. cc @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vB_24/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vCDCq,kvrocks,1862807722,1950,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-19T13:57:55Z,2023-12-19T13:57:55Z,"> > Kvrocks don't have DB, we have [namespace](https://kvrocks.apache.org/docs/namespace) instead. So should we use namespace token in this command?
> > ```shell
> > move key namespace_token
> > ```
> 
> Looks good to me. cc @git-hulk

Good to me +1","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vCDCq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vCGF2,kvrocks,1862820214,1950,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2023-12-19T14:05:28Z,2023-12-19T14:05:28Z,proposal is ok to me,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vCGF2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vkc-p,kvrocks,1871826857,1950,NA,kay011,64449652,,,NA,2023-12-29T08:09:07Z,2023-12-29T08:09:07Z,This command was implemented by @enjoy-binbin  in #1723  but now it is a dummy command. Are we sure  to change the actual operation of the command which is different from Redis? ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vkc-p/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_KiP,kvrocks,1878829199,1950,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2024-01-05T15:12:49Z,2024-01-05T15:12:49Z,"I think it’s better to keep the redis style `MOVE key db`.

If we specifially need such a feature, we should add a new command, or at least do it in a way that is compatible with redis style.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_KiP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wBLb4,kvrocks,1879357176,1950,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-05T22:57:47Z,2024-01-05T22:57:47Z,"@enjoy-binbin 
Add a new command looks good to me.

I provide a compatible solution:
When command args size is 3, `MOVE key db` , we treat it a dummy command.
When command args size is 4, `MOVE key ns_name ns_token` ,we move it to new namespace.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wBLb4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50rZAL,kvrocks,1957531659,1950,NA,haanhvu,75315486,Ha Anh Vu,,NA,2024-02-21T17:57:31Z,2024-02-21T17:57:31Z,"> @enjoy-binbin Add a new command looks good to me.
> 
> I provide a compatible solution: When command args size is 3, `MOVE key db` , we treat it a dummy command. When command args size is 4, `MOVE key ns_name ns_token` ,we move it to new namespace.

This has not been implemented right? I'll work on this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50rZAL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50uf-n,kvrocks,1958346663,1950,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-02-21T23:36:17Z,2024-02-21T23:36:17Z,"> > @enjoy-binbin Add a new command looks good to me.
> > I provide a compatible solution: When command args size is 3, `MOVE key db` , we treat it a dummy command. When command args size is 4, `MOVE key ns_name ns_token` ,we move it to new namespace.
> 
> This has not been implemented right? I'll work on this.

No. But let's check with @git-hulk @PragmaTwice to make sure this is the ok behavior.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50uf-n/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50vKX5,kvrocks,1958520313,1950,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-02-22T01:55:24Z,2024-02-22T01:55:24Z,"I'm fine with @enjoy-binbin solution. BTW, we must forbid using this command if the cluster mode is enabled.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50vKX5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51BLzo,kvrocks,1963244776,1950,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-02-26T03:14:29Z,2024-02-26T03:14:29Z,"Hi @haanhvu, according to @git-hulk's suggestion, we can use @enjoy-binbin's solution.
You can add a new command. 
Be bold in doing it, and feel free to continue raising questions here if any.

> I think it’s better to keep the redis style MOVE key db.
If we specifially need such a feature, we should add a new command, or at least do it in a way that is compatible with redis style.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51BLzo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55S7ip,kvrocks,2035005609,1950,NA,Chiro11,44946252,,,NA,2024-04-03T16:01:30Z,2024-04-03T16:01:30Z,"> > @enjoy-binbin Add a new command looks good to me.
> > I provide a compatible solution: When command args size is 3, `MOVE key db` , we treat it a dummy command. When command args size is 4, `MOVE key ns_name ns_token` ,we move it to new namespace.
> 
> This has not been implemented right? I'll work on this.

Are you still working on this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55S7ip/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1950,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55XuEl,kvrocks,2036261157,1950,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-04-04T06:07:55Z,2024-04-04T06:07:55Z,"Hi @Chiro11 
It seems like nobody has work now. 
If you want to do it, you can send a PR directly.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55XuEl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1951,https://api.github.com/repos/apache/kvrocks/issues/1951,kvrocks,2046894401,1951,Add support of the command RENAMENX,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:16:16Z,2024-01-23T08:09:09Z,Refer to https://redis.io/commands/renamenx/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1951/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1951,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFnM1,kvrocks,1863742261,1951,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-12-20T02:08:57Z,2023-12-20T02:08:57Z,"We also don't have `RENAME` command. It can be directly added to this issue.

Refer: https://github.com/apache/kvrocks-website/blob/main/docs/supported-commands.md?plain=1#L153","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFnM1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1951,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vF2wo,kvrocks,1863805992,1951,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-12-20T03:52:13Z,2023-12-20T03:52:13Z,I will do it.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vF2wo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1951,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vIjE-,kvrocks,1864511806,1951,NA,PragmaTwice,20042607,Twice,,NA,2023-12-20T13:51:47Z,2023-12-20T13:51:47Z,Great! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vIjE-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1951,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vTmoZ,kvrocks,1867409945,1951,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-12-22T08:47:56Z,2023-12-22T08:47:56Z,"@PragmaTwice 
Hi, I found that there are the following limitations for the `RENAME` command in the Redis doc.
> In Cluster mode, both key and newkey must be in the same hash slot


Are there any examples of how to check if kvrocks is running in cluster mode and how to get the slot ID from keyname?

Refer: https://redis.io/commands/rename/#:~:text=In%20Cluster%20mode%2C%20both%20key%20and%20newkey%20must%20be%20in%20the%20same%20hash%20slot%2C","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vTmoZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1952,https://api.github.com/repos/apache/kvrocks/issues/1952,kvrocks,2046894478,1952,Add support of the command SORT and SORT_RO,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:16:18Z,2024-05-07T07:06:17Z,Refer to https://redis.io/commands/sort/ and https://redis.io/commands/sort_ro/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1952/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vTpHP,kvrocks,1867420111,1952,NA,HolyLow,22865114,,,NA,2023-12-22T08:58:40Z,2023-12-22T08:58:40Z,"Hello, I am interested in this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vTpHP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vTzNi,kvrocks,1867461474,1952,NA,PragmaTwice,20042607,Twice,,NA,2023-12-22T09:38:22Z,2023-12-22T09:38:22Z,Great! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vTzNi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MRFy,kvrocks,2016481650,1952,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-03-23T12:37:12Z,2024-03-23T12:37:12Z,"Hello @HolyLow @PragmaTwice 
Is there any progress on this issue? If no one is working on it at the moment, I'm willing to try this question.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MRFy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MRbY,kvrocks,2016483032,1952,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-23T12:42:27Z,2024-03-23T12:42:27Z,@PokIsemaine Thanks for your interest. I think it's fine to reassign since it's inactive for a long time.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MRbY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54Oya3,kvrocks,2017142455,1952,NA,HolyLow,22865114,,,NA,2024-03-25T03:25:30Z,2024-03-25T03:25:30Z,"@PokIsemaine My progress is limited (just annotations), so feel free to take this over.
@git-hulk Sorry for the huge delay, I could spare some time on another issue https://github.com/apache/kvrocks/issues/1372 recently, so please reserve that one for me if it's ok.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54Oya3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1952,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54Oy5k,kvrocks,2017144420,1952,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-25T03:28:17Z,2024-03-25T03:28:17Z,"@HolyLow Thanks for your feedback.

> @git-hulk Sorry for the huge delay, I could spare some time on another issue https://github.com/apache/kvrocks/issues/1372 recently, so please reserve that one for me if it's ok.

Absolutely yes. No sorry and very appreciative of your efforts and contributions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54Oy5k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1953,https://api.github.com/repos/apache/kvrocks/issues/1953,kvrocks,2046894589,1953,Add support of the command SORT_RO,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:16:22Z,2023-12-19T14:02:51Z,Refer to https://redis.io/commands/sort_ro/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1953/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1953,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vCE_i,kvrocks,1862815714,1953,NA,PragmaTwice,20042607,Twice,,NA,2023-12-19T14:02:49Z,2023-12-19T14:02:49Z,Merged to https://github.com/apache/kvrocks/issues/1952.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vCE_i/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1954,https://api.github.com/repos/apache/kvrocks/issues/1954,kvrocks,2046894676,1954,Add support of the command BITFIELD_RO,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:16:24Z,2024-01-06T11:06:51Z,Refer to https://redis.io/commands/bitfield_ro/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1954/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1954,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vqScH,kvrocks,1873356551,1954,NA,jyf111,64510284,,,NA,2024-01-01T14:47:23Z,2024-01-01T14:47:23Z,"Hi, I want to do this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vqScH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1954,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vqXw5,kvrocks,1873378361,1954,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-01T15:50:42Z,2024-01-01T15:50:42Z,"@jyf111 assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vqXw5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1955,https://api.github.com/repos/apache/kvrocks/issues/1955,kvrocks,2046894759,1955,Add support of the command LCS,PragmaTwice,20042607,Twice,,CLOSED,2023-12-18T15:16:27Z,2024-03-03T12:45:54Z,Refer to https://redis.io/commands/lcs/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1955/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1955,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vd1KP,kvrocks,1870090895,1955,NA,JoverZhang,38241684,Jover,joverzh@gmail.com,NA,2023-12-27T08:57:47Z,2023-12-27T08:57:47Z,I'm very interested in this command.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vd1KP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1955,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vegY6,kvrocks,1870267962,1955,NA,PragmaTwice,20042607,Twice,,NA,2023-12-27T12:35:31Z,2023-12-27T12:35:31Z,Great! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vegY6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1958,https://api.github.com/repos/apache/kvrocks/issues/1958,kvrocks,2048723841,1958,Add support of the command SSUBSCRIBE and SUNSUBSCRIBE,PragmaTwice,20042607,Twice,,CLOSED,2023-12-19T14:02:00Z,2024-01-15T08:04:16Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1958/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1958,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFlis,kvrocks,1863735468,1958,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-12-20T02:01:20Z,2023-12-20T02:01:20Z,Refer: https://redis.io/commands/ssubscribe/ and https://redis.io/commands/sunsubscribe/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFlis/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1958,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vj5jI,kvrocks,1871681736,1958,NA,raffertyyu,104707498,,raffertyyu@tencent.com,NA,2023-12-29T02:23:56Z,2023-12-29T02:23:56Z,please assign to me.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vj5jI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1958,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vj67t,kvrocks,1871687405,1958,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-29T02:42:14Z,2023-12-29T02:42:14Z,"@raffertyyu assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vj67t/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1959,https://api.github.com/repos/apache/kvrocks/issues/1959,kvrocks,2048723942,1959,Add support of the command SMISMEMBER,PragmaTwice,20042607,Twice,,CLOSED,2023-12-19T14:02:03Z,2024-03-11T11:13:37Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1959/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1959,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFlQ9,kvrocks,1863734333,1959,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2023-12-20T02:00:33Z,2023-12-20T02:00:33Z,Refer: https://redis.io/commands/smismember/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFlQ9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1959,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFzwe,kvrocks,1863793694,1959,NA,jyizheng,2645726,Yizheng Jiao,jyizheng@gmail.com,NA,2023-12-20T03:30:35Z,2023-12-20T03:30:35Z,Please assign it to me ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vFzwe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1959,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vIixy,kvrocks,1864510578,1959,NA,PragmaTwice,20042607,Twice,,NA,2023-12-20T13:51:05Z,2023-12-20T13:51:05Z,"> Please assign it to me

Assigned. Go ahead!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vIixy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1959,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52f_GR,kvrocks,1988096401,1959,NA,sheharyaar,34273345,Shehar Yaar,sheharyaar48@gmail.com,NA,2024-03-11T10:30:32Z,2024-03-11T10:30:32Z,"Hi @PragmaTwice , it seems there has not been any update since December to this issue, can I please pick this up ?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52f_GR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1959,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gVIK,kvrocks,1988186634,1959,NA,sheharyaar,34273345,Shehar Yaar,sheharyaar48@gmail.com,NA,2024-03-11T11:09:18Z,2024-03-11T11:09:18Z,"I can see in the source, that this is already implemented. This can be closed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gVIK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1959,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gVlB,kvrocks,1988188481,1959,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-11T11:10:26Z,2024-03-11T11:10:26Z,@sheharyaar Thanks for your reminder.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gVlB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1959,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gXJu,kvrocks,1988194926,1959,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-11T11:13:35Z,2024-03-11T11:13:35Z,"@jyizheng Thank you！
Do you want to have try https://github.com/apache/kvrocks/issues/1212 ？","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gXJu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1966,https://api.github.com/repos/apache/kvrocks/issues/1966,kvrocks,2055091192,1966,The storage engine type can be awareness in Kvrocks,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2023-12-24T12:50:02Z,2023-12-29T06:11:59Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

We're now supporting the speedb and rocksdb as its storage engine
and maybe even more in the future. I believe it'd would be better
to allow each engine to have its specific configurations.

### Solution

We can export the engine type information to Kvrocks while building
the source stage. Can also take a look at how the new encoding format
is recognized: https://github.com/apache/kvrocks/blob/unstable/CMakeLists.txt#L222-L226 


 



### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1966/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1966,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vkKPt,kvrocks,1871750125,1966,NA,MaheshMadushan,58337761,Mahesh Jayawardhana,,NA,2023-12-29T05:59:29Z,2023-12-29T05:59:29Z,"Hi, is this issue available? if so, shall I try on this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vkKPt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1966,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vkLem,kvrocks,1871755174,1966,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-29T06:11:53Z,2023-12-29T06:11:53Z,"@MaheshMadushan assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vkLem/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1969,https://api.github.com/repos/apache/kvrocks/issues/1969,kvrocks,2055451078,1969,Using `GET` to get json type key will not return error.,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,CLOSED,2023-12-25T07:04:17Z,2024-01-02T06:38:05Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable 

### Minimal reproduce step

Using `GET` to get json type key will not return error.
I writed below test case.

```go
t.Run(""GET JSON type key"", func(t *testing.T) {
	require.NoError(t, rdb.Do(ctx, ""JSON.SET"", ""a"", ""$"", ` {""x"":1,""y"":2} `).Err())
	require.EqualValues(t, ""\x00{\""x\"":1,\""y\"":2}"", rdb.Get(ctx, ""a"").Val())
})
```

### What did you expect to see?

test failed

### What did you see instead?

test Passed

### Anything Else?

Maybe is this line problem.https://github.com/apache/kvrocks/blob/unstable/src/types/redis_string.cc#L86
```C++
if (metadata.Type() != kRedisString && metadata.size > 0) {
    return rocksdb::Status::InvalidArgument(kErrMsgWrongType);
  }
```
Why do we need to check `metadata.size > 0`?

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1969/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1969,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vZBUa,kvrocks,1868829978,1969,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2023-12-25T07:50:01Z,2023-12-25T07:50:01Z,"@jihuayu Good catch!

> Why do we need to check metadata.size > 0?

For example, we need to regard it as a non-existing key if all subkeys are deleted in a list(same as the hash/set/zset). But some types allow the empty subkey list like stream/bloomfilter. Can refer: [storage/redis_db.cc#L62](https://github.com/apache/kvrocks/blob/unstable/src/storage/redis_db.cc#L62)

The better way is to use `GetMetadata` to replace the decode function in `redis_string`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vZBUa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1969,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vrdRM,kvrocks,1873663052,1969,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-02T06:38:05Z,2024-01-02T06:38:05Z,Fixed after https://github.com/apache/kvrocks/pull/1971,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vrdRM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1976,https://api.github.com/repos/apache/kvrocks/issues/1976,kvrocks,2062020144,1976,Add kvrocks2redis test case runnig to CI workflow,PragmaTwice,20042607,Twice,,CLOSED,2024-01-02T07:07:23Z,2024-04-21T03:11:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Now we have some test cases for kvrocks2redis, but they cannot be triggered by CI workflow yet.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1976/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1976,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52goXK,kvrocks,1988265418,1976,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-11T11:52:43Z,2024-03-11T11:52:43Z,"Assign to @Zakelly via #2149 
Can you replay this issue? I only can assign it to participants","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52goXK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1976,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52mvKb,kvrocks,1989866139,1976,NA,Zakelly,2986149,Zakelly,zakelly.lan@gmail.com,NA,2024-03-12T02:31:47Z,2024-03-12T02:31:47Z,"> Assign to @Zakelly via #2149 Can you replay this issue? I only can assign it to participants

Sure, thanks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52mvKb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1977,https://api.github.com/repos/apache/kvrocks/issues/1977,kvrocks,2063157036,1977,Using prefix bloom filter in range queries,chrisxu333,44099579,Nuo Xu,,OPEN,2024-01-03T02:18:00Z,2024-01-05T15:35:02Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Prefix seek /  prefix bloom filter is proven to be useful when performing range queries of a collection of keys sharing the same prefix. Refer to [https://github.com/facebook/rocksdb/wiki/Prefix-Seek] for more detailed usage. I saw there're some APIs inside storage layer that performs range query logic. They could get benefits from using aforementioned prefix bloom filter.

### Solution

I haven't summarized all potential use case of prefix bloom filter, however, `FindKeyRangeWithPrefix` could definitely benefit from it by configuring the `prefix_extractor`.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1977/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v-Fzl,kvrocks,1878547685,1977,NA,chrisxu333,44099579,Nuo Xu,,NA,2024-01-05T11:52:12Z,2024-01-05T11:52:12Z,@git-hulk could you help to see if this proposal is needed / necessary? Thank you :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v-Fzl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v-NqR,kvrocks,1878579857,1977,NA,PragmaTwice,20042607,Twice,,NA,2024-01-05T12:19:29Z,2024-01-05T12:19:29Z,I believe we are willing to make such improvements if there are benchmarks that can demonstrate performance enhancements.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v-NqR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v-QB5,kvrocks,1878589561,1977,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-05T12:27:47Z,2024-01-05T12:27:47Z,"Perhaps, I don't know. IMO, Prefix filter is good for range scan, however, Range in kvrocks is not so widely used...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v-QB5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v-bZg,kvrocks,1878636128,1977,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-05T13:08:08Z,2024-01-05T13:08:08Z,"@chrisxu333 I ever tried to add the prefix bloom filter but seems didn't bring any improvements to Kvrocks, see https://github.com/apache/kvrocks/pull/1367. But as @PragmaTwice said, don't hesitate to have a try if you feel it can improve.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v-bZg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_AFm,kvrocks,1878786406,1977,NA,chrisxu333,44099579,Nuo Xu,,NA,2024-01-05T14:42:08Z,2024-01-05T14:42:08Z,"> @chrisxu333 I ever tried to add the prefix bloom filter but seems didn't bring any improvements to Kvrocks, see #1367. But as @PragmaTwice said, don't hesitate to have a try if you feel it can improve.

Sounds good I'll give it a try.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_AFm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_A9Q,kvrocks,1878789968,1977,NA,chrisxu333,44099579,Nuo Xu,,NA,2024-01-05T14:44:43Z,2024-01-05T14:44:43Z,"> Perhaps, I don't know. IMO, Prefix filter is good for range scan, however, Range in kvrocks is not so widely used...

Is that because of the lacking usage scenario or due to the missing support of such command?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_A9Q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_GYD,kvrocks,1878812163,1977,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-05T15:00:49Z,2024-01-05T15:00:49Z,"What @mapleFU means is we only used range query in a few commands like hgetall/lrange/zrange, etc...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_GYD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1977,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_SAj,kvrocks,1878859811,1977,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-05T15:35:01Z,2024-01-05T15:35:01Z,"https://github.com/tikv/tikv/blob/2472fd4d85c220b74dc889b493e70bc95dcc75c2/src/config/mod.rs#L963

TiKV uses prefix bf to remove the timestamp column. I think if we'd like to use prefix bf, maybe we need a well-defined rule for prefix. Little commands uses Scan in RocksDB, and mosts commands just uses ""Put"" and ""Get"" directly.

However, if benchmark shows it can improve our performance, any contribution is wellcome","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v_SAj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1978,https://api.github.com/repos/apache/kvrocks/issues/1978,kvrocks,2063164211,1978,`BITCOUNT` return wrong when args > 4,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,CLOSED,2024-01-03T02:32:30Z,2024-01-03T04:31:14Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

```shell
127.0.0.1:6666> SET mykey ""foobar""
OK
127.0.0.1:6666> BITCOUNT mykey 5 30
(integer) 4
127.0.0.1:6666> BITCOUNT mykey 5 30 111
(integer) 26
```

### What did you expect to see?

`BITCOUNT mykey 5 30 111` return 4

### What did you see instead?

`BITCOUNT mykey 5 30 111` return ERROR

### Anything Else?

https://github.com/apache/kvrocks/blob/574d438b9acde7b45b0666564af4450c057aceea/src/commands/cmd_bit.cc#L94-L117

We need return ERROR when `args.size() > 4`

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1978/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1978,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vvvE0,kvrocks,1874784564,1978,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2024-01-03T02:43:12Z,2024-01-03T02:43:12Z,"Below is how Redis works:

```
127.0.0.1:6379> SET mykey ""foobar""
OK
127.0.0.1:6379>  BITCOUNT mykey 5 30
(integer) 4
127.0.0.1:6379>  BITCOUNT mykey 5 30 111
(error) ERR syntax error
```

@jihuayu would you like to fix it? Or I can take a look.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vvvE0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1978,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vvv4s,kvrocks,1874787884,1978,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-03T02:50:17Z,2024-01-03T02:50:17Z,"@tisonkun Go ahead. Thank you!
I will not fix it ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5vvv4s/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1980,https://api.github.com/repos/apache/kvrocks/issues/1980,kvrocks,2064017406,1980,Tracking issue: Support RESP3 in Kvrocks,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-03T13:12:27Z,2024-03-04T02:52:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

We would like to support RESP3 even though we know RESP2 won't be abandoned in a short time.
To achieve this, we need to support new types in RESP3 and enable RESP3 in the HELLO command:

- [x] Allow to enable RESP3 in the HELLO command
- [x] #2024 
- [x] #1991
- [x] #2017 
- [x] #2028
- [x] #2034
- [x] #2053
- [x] #2088
- [x] #2102
- [x] #2119
- [x] https://github.com/apache/kvrocks/pull/2130 

Please refer [Redis RESP3](https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md)
 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1980/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1981,https://api.github.com/repos/apache/kvrocks/issues/1981,kvrocks,2064023614,1981,Add RESP3 boolean type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-03T13:16:44Z,2024-01-08T02:10:11Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1981/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1982,https://api.github.com/repos/apache/kvrocks/issues/1982,kvrocks,2064026914,1982,Add the ApplyBatch command,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2024-01-03T13:19:10Z,2024-01-14T07:59:08Z,"Write the rocksdb key values converted from redis protocol to kvrocks. This command is mainly used in data migration scenarios to avoid redis protocol conversion overhead. 

We will also provide the `low_priority` option, which uses [Low Priority Write](https://github.com/facebook/rocksdb/wiki/Low-Priority-Write) to avoid having a large impact to user writes.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1982/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1983,https://api.github.com/repos/apache/kvrocks/issues/1983,kvrocks,2064933512,1983,Add support of the command ZINTER and ZINTERCARD,PragmaTwice,20042607,Twice,,CLOSED,2024-01-04T03:25:57Z,2024-01-09T13:41:08Z,Refer to https://redis.io/commands/zinter/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1983/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wB7P1,kvrocks,1879553013,1983,NA,kay011,64449652,,,NA,2024-01-06T05:07:11Z,2024-01-06T05:07:11Z,"Hi, can you assign it to me?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wB7P1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1983,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wB813,kvrocks,1879559543,1983,NA,PragmaTwice,20042607,Twice,,NA,2024-01-06T05:28:21Z,2024-01-06T05:28:21Z,Sure! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wB813/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1984,https://api.github.com/repos/apache/kvrocks/issues/1984,kvrocks,2064933537,1984,Add support of the command ZDIFF and ZDIFFSTORE,PragmaTwice,20042607,Twice,,CLOSED,2024-01-04T03:26:00Z,2024-03-11T06:01:59Z,Refer to https://redis.io/commands/zdiff/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1984/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1984,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wDWO0,kvrocks,1879925684,1984,NA,MaheshMadushan,58337761,Mahesh Jayawardhana,,NA,2024-01-07T03:27:51Z,2024-01-07T03:27:51Z,"Hi, is this issue available? if so, shall I try on this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wDWO0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1984,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wDWq7,kvrocks,1879927483,1984,NA,PragmaTwice,20042607,Twice,,NA,2024-01-07T03:41:00Z,2024-01-07T03:41:00Z,Sure! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wDWq7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1984,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ebZn,kvrocks,1987688039,1984,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-11T06:01:59Z,2024-03-11T06:01:59Z,Close via #2021,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ebZn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1985,https://api.github.com/repos/apache/kvrocks/issues/1985,kvrocks,2064933557,1985,Add support of the command ZRANDMEMBER,PragmaTwice,20042607,Twice,,CLOSED,2024-01-04T03:26:02Z,2024-01-15T08:00:50Z,https://redis.io/commands/zrandmember/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1985/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1985,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wr3e8,kvrocks,1890547644,1985,NA,JxLi0921,53040712,jxlikar,,NA,2024-01-13T16:05:02Z,2024-01-13T16:05:02Z,"Hello! I have a question for this. I noticed that the current implementation of `SRANDMEMBER` always returns the first `count` members and it's not really random. Therefore, is it ok for the implementation of `ZRANDMEMBER` also just returns the first `count` members? ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wr3e8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1985,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ws-Fr,kvrocks,1890836843,1985,NA,PragmaTwice,20042607,Twice,,NA,2024-01-14T03:41:35Z,2024-01-14T03:41:35Z,"> Hello! I have a question for this. I noticed that the current implementation of `SRANDMEMBER` always returns the first `count` members and it's not really random. Therefore, is it ok for the implementation of `ZRANDMEMBER` also just returns the first `count` members?

You can follow the implementation of HRANDMEMBER, which is more reasonable.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ws-Fr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1985,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wtCxP,kvrocks,1890856015,1985,NA,JxLi0921,53040712,jxlikar,,NA,2024-01-14T05:46:12Z,2024-01-14T05:46:12Z,"> > Hello! I have a question for this. I noticed that the current implementation of `SRANDMEMBER` always returns the first `count` members and it's not really random. Therefore, is it ok for the implementation of `ZRANDMEMBER` also just returns the first `count` members?
> 
> You can follow the implementation of HRANDMEMBER, which is more reasonable.

thanks! could you please assign this to me? btw, maybe it's `HRANDFIELD`, but not `HRANDMEMBER`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wtCxP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1985,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wtDCf,kvrocks,1890857119,1985,NA,PragmaTwice,20042607,Twice,,NA,2024-01-14T05:54:01Z,2024-01-14T05:54:01Z,"
> thanks! could you please assign this to me? btw, maybe it's `HRANDFIELD`, but not `HRANDMEMBER`

Yeah you are right! Assigned.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wtDCf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/1988,kvrocks,2066879869,1988,kvrocks2redis run failed,iushas,7236171,tanic.xiao,,CLOSED,2024-01-05T07:43:20Z,2024-03-20T01:41:11Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

run kvrocks2redis -c kvrocks2redis.conf

### What did you expect to see?

success

### What did you see instead?

coredump

- gdb kvrocks2redis ./core
```
Core was generated by `kvrocks2redis -c kvrocks2redis.conf'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x0000557a43551a96 in engine::Storage::LatestSeqNumber (this=<optimized out>) at incubator-kvrocks/src/storage/storage.cc:529
529 incubator-kvrocks/src/storage/storage.cc: No such file or directory.
```

- there is no error in logfile

```
Log file created at: 2024/01/05 15:03:37
Log line format: [IWEF]yyyymmdd hh:mm:ss.uuuuuu threadid file:line] msg
I20240105 15:03:37.463881 3476657 main.cc:109] kvrocks2redis unstable (commit 230d9726)
I20240105 15:03:37.832939 3476657 storage.cc:343] [storage] Success to load the data from disk: 366 ms
I20240105 15:03:37.833065 3476657 sync.cc:61] [kvrocks2redis] Start sync the data from kvrocks to redis
~
```



### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1988/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9Cb3,kvrocks,1878271735,1988,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2024-01-05T08:00:53Z,2024-01-05T08:00:53Z,"Hi @iushas, can you provide the reproduction steps or more stack trace information?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9Cb3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9Ftb,kvrocks,1878285147,1988,NA,iushas,7236171,tanic.xiao,,NA,2024-01-05T08:15:05Z,2024-01-05T08:15:05Z,"- 1、compile kvrocks2redis only 
![image](https://github.com/apache/kvrocks/assets/7236171/4bf5016d-18c4-438f-bd61-99823a4a4a17)

maybe this step has something wrong?  some codes do not been compiled in program?
but version v2.7.0 is normal.

- 2、run kvrocks2redis -c kvrocks2redis.conf
```
log-level INFO
daemonize no
data-dir /home/redis/data
output-dir /home/redis

cluster-enabled no

namespace.__namespace ip 6379 1234567

```

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9Ftb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9GF4,kvrocks,1878286712,1988,NA,iushas,7236171,tanic.xiao,,NA,2024-01-05T08:16:36Z,2024-01-05T08:16:36Z,"
In addition, the old version file contains the configuration information of the source instance. Is there no need to configure it now?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9GF4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9L1V,kvrocks,1878310229,1988,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2024-01-05T08:36:44Z,2024-01-05T08:36:44Z,"> In addition, the old version file contains the configuration information of the source instance. Is there no need to configure it now?

Yes, in the new version, kvrocks2redis uses the SecondaryMode to open the RocksDB instance for synchronization instead of using network synchronization for incremental data. Therefore, in the configuration, the data-dir is set to the working directory of kvrocks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9L1V/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9Mdw,kvrocks,1878312816,1988,NA,iushas,7236171,tanic.xiao,,NA,2024-01-05T08:39:23Z,2024-01-05T08:39:23Z,"> > In addition, the old version file contains the configuration information of the source instance. Is there no need to configure it now?
> 
> Yes, in the new version, kvrocks2redis uses the SecondaryMode to open the RocksDB instance for synchronization instead of using network synchronization for incremental data. Therefore, in the configuration, the data-dir is set to the working directory of kvrocks

OK, I'm sure the working directory of kvrocks is configured correctly","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5v9Mdw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yVkPL,kvrocks,1918256075,1988,NA,iushas,7236171,tanic.xiao,,NA,2024-01-31T02:29:57Z,2024-01-31T02:29:57Z,Is this bug resolved? @maochongxin @git-hulk ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yVkPL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yWxh4,kvrocks,1918572664,1988,NA,maochongxin,24621345,🐮🐴,maochongxin@gmail.com,NA,2024-01-31T07:56:42Z,2024-01-31T07:56:42Z,"![](https://github.com/apache/kvrocks/assets/24621345/e735f512-ca39-44ea-89c9-765f1f0915c0)

Hi @iushas , I have tested and it runs smoothly without encountering your issue. Here are the steps I followed for my testing:

commit: e95e6f75b6f2eaa6568ad52bf0c12ee1329bc90e

```
# build
./x.py build

# start kvrocks
./kvrocks -c kvrocks.conf

# start redis
redis-server

# start kvrocks2redis
./kvrocks2redis -c kvrocks2redis.conf

# test
python3 populate-kvrocks.py --flushdb=true --password=''
python3 check_consistency.py --src_password=''
```


kvrocks2redis.conf , kvrocks working directory  /tmp/kvrocks
```
################################ GENERAL #####################################

# The value should be INFO, WARNING, ERROR, FATAL.
#
# Default: INFO
log-level INFO

# By default kvrocks2redis does not run as a daemon. Use 'yes' if you need it.
# Note that kvrocks2redis will write a pid file in /var/run/kvrocks2redis.pid when daemonized.
#
# Default: no
daemonize no

# The kvrocks working directory.
# Note that you must specify a directory here, not a file name.
#
# Default: ./data
data-dir /tmp/kvrocks

# Intermediate files are output to this directory when the kvrocks2redis program runs.
#
# Default: ./
output-dir ./


# Enable cluster mode.
#
# Default: no
cluster-enabled no

################################ NAMESPACE AND Sync Target Redis #####################################
# Synchronize the specified namespace data to the specified Redis DB.
# Warning: It will flush the target redis DB data.
#
# namespace.{namespace} <redis_ip> <redis_port> [<redis_auth> <redis_db_number>]
# Default redis_db_number is 0
namespace.__namespace 127.0.0.1 6379

```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yWxh4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yd_yM,kvrocks,1920466060,1988,NA,iushas,7236171,tanic.xiao,,NA,2024-02-01T04:05:31Z,2024-02-01T04:05:31Z,"> ![](https://private-user-images.githubusercontent.com/24621345/301079323-e735f512-ca39-44ea-89c9-765f1f0915c0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDY3NTU0NzQsIm5iZiI6MTcwNjc1NTE3NCwicGF0aCI6Ii8yNDYyMTM0NS8zMDEwNzkzMjMtZTczNWY1MTItY2EzOS00NGVhLTg5YzktNzY1ZjFmMDkxNWMwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAyMDElMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMjAxVDAyMzkzNFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTU3MTg0MmQ2OGM0OGY2ODc2MGIwNjlhNGJmZWU2ZjFhODMzYTZhNTYzOWQyN2EwZGRhMWU5MDVhNDFlOTJkNTImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.W6EO5_u-nga5j8iiG5XuixRPQEjUq__PvUCSqOBNcAA)
> 
> Hi @iushas , I have tested and it runs smoothly without encountering your issue. Here are the steps I followed for my testing:
> 
> commit: [e95e6f7](https://github.com/apache/kvrocks/commit/e95e6f75b6f2eaa6568ad52bf0c12ee1329bc90e)
> 
> ```
> # build
> ./x.py build
> 
> # start kvrocks
> ./kvrocks -c kvrocks.conf
> 
> # start redis
> redis-server
> 
> # start kvrocks2redis
> ./kvrocks2redis -c kvrocks2redis.conf
> 
> # test
> python3 populate-kvrocks.py --flushdb=true --password=''
> python3 check_consistency.py --src_password=''
> ```
> 
> kvrocks2redis.conf , kvrocks working directory /tmp/kvrocks
> 
> ```
> ################################ GENERAL #####################################
> 
> # The value should be INFO, WARNING, ERROR, FATAL.
> #
> # Default: INFO
> log-level INFO
> 
> # By default kvrocks2redis does not run as a daemon. Use 'yes' if you need it.
> # Note that kvrocks2redis will write a pid file in /var/run/kvrocks2redis.pid when daemonized.
> #
> # Default: no
> daemonize no
> 
> # The kvrocks working directory.
> # Note that you must specify a directory here, not a file name.
> #
> # Default: ./data
> data-dir /tmp/kvrocks
> 
> # Intermediate files are output to this directory when the kvrocks2redis program runs.
> #
> # Default: ./
> output-dir ./
> 
> 
> # Enable cluster mode.
> #
> # Default: no
> cluster-enabled no
> 
> ################################ NAMESPACE AND Sync Target Redis #####################################
> # Synchronize the specified namespace data to the specified Redis DB.
> # Warning: It will flush the target redis DB data.
> #
> # namespace.{namespace} <redis_ip> <redis_port> [<redis_auth> <redis_db_number>]
> # Default redis_db_number is 0
> namespace.__namespace 127.0.0.1 6379
> ```

![image](https://github.com/apache/kvrocks/assets/7236171/e2558e5e-0bec-4e0f-ad59-b4ff1c99f0c1)


Still having problems, can you send me your binary file to try?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yd_yM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1988,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ygwJf,kvrocks,1921188447,1988,NA,PragmaTwice,20042607,Twice,,NA,2024-02-01T12:12:31Z,2024-02-01T12:12:31Z,"@iushas  Could you attach your coredump file and kvrocks2redis binary?

And it would be very helpful if you put the crash stacktrace here. (type `bt` in gdb)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5ygwJf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1989,https://api.github.com/repos/apache/kvrocks/issues/1989,kvrocks,2067119052,1989,Implement the migrate iterator for iterating key values,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-05T10:42:28Z,2024-01-12T10:16:53Z,"Currently, we need to iterate all keys in the database in different places like the cluster migration and kvrocks2redis, but don't have an iterator for this purpose. It's very error-prone to implement this in different places since Kvrocks may add a new column family in the future, and we must be careful to iterate all keys in all column families. This would be a burden for maintenance, So I think we could add an iterator to iterate all keys in all column families.

## Proposal

For the API, we could generally comply with the rocksdb's iterator API, but we allow to add some extra functions if needed.

```C++

class Iterator {
public:
    Iterator(Storage *storage, const rocksdb::ReadOptions &options, const int slot = -1);
    ~KeyIterator();

    bool Valid() const;
    void Next();

    rocksdb::WriteBatch *Batch() const;
    Slice Key() const;
    Slice Value() const;
    RedisType Type() const;
};

```

And when implementing this iterator, it will iterate the metadata column family first and check its type, if it's not a string, then it will iterate the corresponding column family to get subkeys. That said, if we have a key `foo` with type `hash`, then the iterator will iterate `foo` and `foo:field1`, `foo:field2`, and so on.

This solution can bring those benefits:

- The codes look more intutive
- Can reuse this iterator if we want to iterate keys only","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1989/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1989,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wVvkg,kvrocks,1884748064,1989,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-10T12:22:04Z,2024-01-10T12:22:04Z,@caipengbo Would you mind taking a look while you're free.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wVvkg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1989,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wV89j,kvrocks,1884802915,1989,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-01-10T12:57:22Z,2024-01-10T12:57:22Z,"> Would you mind taking a look while you're free. 

Good job, LGTM! ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wV89j/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1993,https://api.github.com/repos/apache/kvrocks/issues/1993,kvrocks,2069596939,1993,Add RESP3 null type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-08T04:03:09Z,2024-01-15T10:40:24Z,Please refer [Redis RESP3](https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1993/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1994,https://api.github.com/repos/apache/kvrocks/issues/1994,kvrocks,2069597007,1994,Add RESP3 big number type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-08T04:03:12Z,2024-01-21T16:12:51Z,Please refer [Redis RESP3](https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1994/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1994,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOjBl,kvrocks,1899638885,1994,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-01-19T03:34:19Z,2024-01-19T03:34:19Z,"Hi i wanna solve this issue, please assign this to me. Thanks ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOjBl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1994,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xPIWm,kvrocks,1899791782,1994,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-19T05:25:13Z,2024-01-19T05:25:13Z,"Hi @wsehjk, thanks for your attention. How about finishing #2014 first? then I will assign this to you if it's still unresolved.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xPIWm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1994,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xPU8h,kvrocks,1899843361,1994,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-01-19T06:32:32Z,2024-01-19T06:32:32Z,"Ok, thanks 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xPU8h/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1995,https://api.github.com/repos/apache/kvrocks/issues/1995,kvrocks,2069597150,1995,Add RESP3 double type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-08T04:03:19Z,2024-01-26T05:09:55Z,Please refer [Redis RESP3](https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1995/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1996,https://api.github.com/repos/apache/kvrocks/issues/1996,kvrocks,2069597222,1996,Add RESP3 map type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-08T04:03:22Z,2024-01-21T08:43:11Z,Please refer [Redis RESP3](https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1996/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1997,https://api.github.com/repos/apache/kvrocks/issues/1997,kvrocks,2069597288,1997,Add RESP3 set type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-08T04:03:26Z,2024-01-17T05:38:17Z,Please refer [Redis RESP3](https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1997/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/1998,https://api.github.com/repos/apache/kvrocks/issues/1998,kvrocks,2069597365,1998,Add RESP3 bulk error type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-08T04:03:29Z,2024-01-27T12:46:38Z,Please refer [Redis RESP3](https://github.com/redis/redis-specifications/blob/master/protocol/RESP3.md),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/1998/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/1998,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yCE64,kvrocks,1913147064,1998,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-27T12:46:37Z,2024-01-27T12:46:37Z,"I cannot see anywhere using the bulk errors inside Redis, so close it now. Welcome to reopen I missed anything.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yCE64/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2006,https://api.github.com/repos/apache/kvrocks/issues/2006,kvrocks,2078331027,2006,Add BIT option support for BITCOUNT command,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,CLOSED,2024-01-12T08:32:40Z,2024-02-07T10:25:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I found that the `BITCOUNT` command doesn't have the `BIT` option supported. [Source](https://github.com/jihuayu/incubator-kvrocks/blob/588650f51c434b161c8a8de65ea80871c7d2573e/src/commands/cmd_bit.cc#L124)


### Solution

Add BIT option support for `BITCOUNT` command.

relate issues: https://github.com/apache/kvrocks/issues/1212

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2006/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2006,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wkpZk,kvrocks,1888654948,2006,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-12T08:34:56Z,2024-01-12T08:34:56Z,We can trace it by https://github.com/apache/kvrocks/issues/1942.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wkpZk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2006,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wk2ac,kvrocks,1888708252,2006,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-12T09:10:58Z,2024-01-12T09:10:58Z,"@jihuayu Added it, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5wk2ac/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2006,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDULu,kvrocks,1913471726,2006,NA,kay011,64449652,,,NA,2024-01-28T06:27:08Z,2024-01-28T06:27:08Z,"Is anyone working on this? If not, you can assign it to me","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDULu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2006,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDUmU,kvrocks,1913473428,2006,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-28T06:32:38Z,2024-01-28T06:32:38Z,"@kay011 Assigned. Thank you!
There are some doc you may need:
- https://kvrocks.apache.org/community/data-structure-on-rocksdb#bitmap
- https://redis.io/commands/bitcount/","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDUmU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2007,https://api.github.com/repos/apache/kvrocks/issues/2007,kvrocks,2078511405,2007,Implement WAL iterator for migrating by WAL logs,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-12T10:18:25Z,2024-01-26T02:05:07Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2007/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2007,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xZtrA,kvrocks,1902566080,2007,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-01-21T09:21:04Z,2024-01-21T09:21:04Z,"In https://github.com/apache/kvrocks/pull/2004, we implement the unified key-value iterators, I want to change data to provide a unified iterators. 

For incremental data, we need to call `rocksdb::WALIter` and then implement the `rocksdb::WriteBatch::Handler` interface. 

I want to provide an interface that behaves similarly to `engine::DBIterator`: 

https://github.com/apache/kvrocks/blob/c772109516a6698f8e74d50c1a43bb1c02a697c5/src/storage/iterator.h#L52-L81. 

It will wrap `rocksdb::WALIter` and can return different value types. It is possible to implement their processing logic depending on the concrete type.

HDYT @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xZtrA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2007,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xZvsE,kvrocks,1902574340,2007,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-21T09:56:14Z,2024-01-21T09:56:14Z,@caipengbo Sounds good to me.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xZvsE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2008,https://api.github.com/repos/apache/kvrocks/issues/2008,kvrocks,2078511504,2008,Implement the new migration type by applying raw batch,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-12T10:18:28Z,2024-01-31T05:18:34Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2008/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2009,https://api.github.com/repos/apache/kvrocks/issues/2009,kvrocks,2078511608,2009,Make the raw key values batch migration parameters configurable,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-12T10:18:33Z,2024-11-09T04:18:34Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2009/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2009,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6S_JkP,kvrocks,2466027791,2009,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-11-09T03:45:35Z,2024-11-09T03:45:35Z,@caipengbo I think we now can close this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6S_JkP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2012,https://api.github.com/repos/apache/kvrocks/issues/2012,kvrocks,2080550065,2012,XADD to other type key returns wrong error message,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,CLOSED,2024-01-14T02:14:06Z,2024-01-17T13:54:23Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable


### Minimal reproduce step

```shell
127.0.0.1:6666> set a test
OK
127.0.0.1:6666> lpush a xx
(error) ERR Invalid argument: WRONGTYPE Operation against a key holding the wrong kind of value
127.0.0.1:6666> XADD a * a hello
(error) ERR Invalid argument: metadata is too short
```

### What did you expect to see?

`XADD a * a hello` command return ""ERR Invalid argument: WRONGTYPE Operation against a key holding the wrong kind of value""

### What did you see instead?

`XADD a * a hello` command return ""ERR Invalid argument: metadata is too short""

### Anything Else?

Other stream commands may also have this problem.


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2012/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2014,https://api.github.com/repos/apache/kvrocks/issues/2014,kvrocks,2080567861,2014,Improve the implementation of SRANDMEMBER,PragmaTwice,20042607,Twice,,CLOSED,2024-01-14T03:44:52Z,2024-01-23T06:48:08Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently it just returns the first N members, which is not actually random.

We can improve it just like the implementation of HRANDMEMBER.
 (Or if you have better ideas for random, feel free to implement them)

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2014/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOErT,kvrocks,1899514579,2014,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-01-19T01:55:53Z,2024-01-19T01:55:53Z,hello could you please assign this to. Interested in this problem,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOErT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOE9N,kvrocks,1899515725,2014,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-19T01:57:07Z,2024-01-19T01:57:07Z,"@wsehjk assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOE9N/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOGY_,kvrocks,1899521599,2014,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-01-19T02:02:50Z,2024-01-19T02:02:50Z,"Thanks, I'm newbie to this project. Does this project have any community where developers can communicate?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOGY_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOInW,kvrocks,1899530710,2014,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-19T02:12:23Z,2024-01-19T02:12:23Z,"Yes, you can join the WeChat group via the official account at the bottom of README if you're using WeChat. Or you can join the Slack channel which is also mentioned in README.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xOInW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xP045,kvrocks,1899974201,2014,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-01-19T08:32:49Z,2024-01-19T08:32:49Z,"Hi, here is a question. If the number of member (k) is less than the **count** we want to select, under the context of **random**, does it ok to generate results less than k?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xP045/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xQVRB,kvrocks,1900106817,2014,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-19T10:04:15Z,2024-01-19T10:04:15Z,@wsehjk https://github.com/apache/kvrocks/pull/1565/files this is a example for our current impl,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xQVRB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2014,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xSeqz,kvrocks,1900669619,2014,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-01-19T15:53:13Z,2024-01-19T15:53:13Z,"> @wsehjk https://github.com/apache/kvrocks/pull/1565/files this is a example for our current impl

thanks, i will take a look at this. And i'm gonna try **Reservoir Sampling**","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xSeqz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2022,https://api.github.com/repos/apache/kvrocks/issues/2022,kvrocks,2082188088,2022,Allow to use hyper clock cache to replace the LRU cache,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-15T14:49:52Z,2024-03-09T07:25:00Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

The hyperclock cache was introduced in rocksdb in 7.7.3 and it may bring performance benefits for the block/row cache while compared to the LRU cache. This idea is mentioned by @PragmaTwice.

### Solution

Allow to enable the hyper cache via the configuration.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2022/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2022,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w4pKa,kvrocks,1893896858,2022,NA,JxLi0921,53040712,jxlikar,,NA,2024-01-16T14:47:46Z,2024-01-16T14:47:46Z,"hello! I have a question for this. Noticed that this issue has a `need benchmark` tag, is there a standard way to benchmark kvrocks? For example, does simlply running redis-benchmark on my computer is enough , or we need to do some other experiments on some platforms?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w4pKa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2022,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w4yWn,kvrocks,1893934503,2022,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-16T15:06:30Z,2024-01-16T15:06:30Z,@JxLi0921 Your local environment is enough. What we want to know is if the hyper clock cache can bring performance benefits while compared to LRU. And the benchmark result is also not a blocking item for merging PR.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w4yWn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2022,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w43YV,kvrocks,1893955093,2022,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-16T15:17:34Z,2024-01-16T15:17:34Z,"> Noticed that this issue has a need benchmark tag, is there a standard way to benchmark kvrocks?

Perhaps you can try ycsb in your local environment. This is a way we can follow: https://github.com/apache/kvrocks/pull/1424#issuecomment-1546521178","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w43YV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2022,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w46Af,kvrocks,1893965855,2022,NA,JxLi0921,53040712,jxlikar,,NA,2024-01-16T15:23:06Z,2024-01-16T15:23:06Z,"@git-hulk @mapleFU Thanks for your answers, got it! Could you please assign this to me? I would like to give it a try.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w46Af/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2022,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w8Kd5,kvrocks,1894819705,2022,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-17T02:07:34Z,2024-01-17T02:07:34Z,"@JxLi0921 assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5w8Kd5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2022,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52a01O,kvrocks,1986743630,2022,NA,LiuYuHui,13926137,Yuhui Liu,,NA,2024-03-09T06:00:20Z,2024-03-09T06:00:20Z,It seems like that this issue had been solved?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52a01O/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2022,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52a8w7,kvrocks,1986776123,2022,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-09T07:25:00Z,2024-03-09T07:25:00Z,"@LiuYuHui Sorry for forgetting to close this issue, it's done in #2031.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52a8w7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2035,https://api.github.com/repos/apache/kvrocks/issues/2035,kvrocks,2092530297,2035,Support RESP3 in Lua scripts,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-21T10:47:57Z,2024-02-29T11:00:41Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2035/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2036,https://api.github.com/repos/apache/kvrocks/issues/2036,kvrocks,2092530880,2036,Add RESP3 verbatim string type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-21T10:49:46Z,2024-02-18T07:45:25Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2036/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2036,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xdCrF,kvrocks,1903438533,2036,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-01-22T07:57:03Z,2024-01-22T07:57:03Z,hi may i apply to solve this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xdCrF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2036,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xd-SM,kvrocks,1903682700,2036,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-22T10:24:57Z,2024-01-22T10:24:57Z,"@wsehjk sure, assigned. Thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xd-SM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2036,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xfkRa,kvrocks,1904100442,2036,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-01-22T14:19:09Z,2024-01-22T14:19:09Z,Thank you for this opportunity  to learn serialization protocols. I will solve this ASAP,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xfkRa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2036,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yCML_,kvrocks,1913176831,2036,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-27T14:45:04Z,2024-01-27T14:45:04Z,@wsehjk Are you still working on this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yCML_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2036,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDpO9,kvrocks,1913557949,2036,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-01-28T11:11:48Z,2024-01-28T11:11:48Z,"yes, still work on this. This week I can make some progress","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDpO9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2036,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDwFJ,kvrocks,1913585993,2036,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-28T12:50:39Z,2024-01-28T12:50:39Z,"ok, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDwFJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2045,https://api.github.com/repos/apache/kvrocks/issues/2045,kvrocks,2096415295,2045,Using the `debug protocol int` command will report an error that the int type is not supported.,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,CLOSED,2024-01-23T15:59:31Z,2024-01-24T02:02:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable(master)

### Minimal reproduce step

```
127.0.0.1:6666> debug protocol int
```

### What did you expect to see?

```
(error) Wrong protocol type name. Please use one of the following: string|**integer**|array|set|bignum|true|false|null
```

### What did you see instead?

```
(error) Wrong protocol type name. Please use one of the following: string|int|array|set|bignum|true|false|null
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2045/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2045,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xrfca,kvrocks,1907226394,2045,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-24T02:02:54Z,2024-01-24T02:02:54Z,@AntiTopQuark Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5xrfca/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2056,https://api.github.com/repos/apache/kvrocks/issues/2056,kvrocks,2101784456,2056,Specify the proxy address of the dependency when building,qujihan,43026824,,qujihan@163.com,CLOSED,2024-01-26T08:20:28Z,2024-01-26T14:36:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

For the convenience of Chinese users, it can specify the proxy address you rely on.

### Solution

Change --ghproxy to --proxy ""proxy.site.url"", if not, default to ghproxy

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2056/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2057,https://api.github.com/repos/apache/kvrocks/issues/2057,kvrocks,2103104721,2057,Tracking issue: Fix all issues for SonarCloud analysis,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,OPEN,2024-01-27T00:46:55Z,2024-01-27T09:01:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Our SonarCloud analysis has been initially successful, but there are still some issues.
This issue will trace the SonarCloud Analysis issues.

- [x] [SonarCloud analysis upload failed](https://github.com/apache/kvrocks/actions/runs/7669473193)
- [ ] #2059
- [ ] #2058

If you have any idea about the above, please tell us. We would be grateful.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2057/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2058,https://api.github.com/repos/apache/kvrocks/issues/2058,kvrocks,2103105331,2058,SonarCloud analysis run on PR branch has wrong `coverage on New Code`,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,OPEN,2024-01-27T00:48:15Z,2024-01-27T00:59:19Z,Refer: https://github.com/apache/kvrocks/pull/2055/checks?check_run_id=20897911202,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2058/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2059,https://api.github.com/repos/apache/kvrocks/issues/2059,kvrocks,2103106506,2059,SonarCloud analysis run on unstable branch has wrong `New issues` num,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,OPEN,2024-01-27T00:50:53Z,2024-03-09T22:00:37Z,"Refer: https://github.com/apache/kvrocks/runs/20889223274
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2059/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2059,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yBELY,kvrocks,1912881880,2059,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-27T00:54:19Z,2024-01-27T00:54:19Z,"Here are some clues. 
The ""new code"" displayed on SonarCloud is based on the code from November 23rd. How can we adjust it?

[<img width=""878"" alt=""d56811384ac52f05d7c2546943d9be5"" src=""https://github.com/apache/kvrocks/assets/32858525/77973e50-075a-4ab9-afa2-edaf3fab490e"">](https://sonarcloud.io/summary/new_code?id=apache_kvrocks&branch=unstable)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yBELY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2059,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yBKgd,kvrocks,1912907805,2059,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-27T01:47:23Z,2024-01-27T01:47:23Z,"https://docs.sonarsource.com/sonarqube/latest/analyzing-source-code/analysis-parameters/
Maybe we need to set `sonar.newCode.referenceBranch`?

We can consider the code from the last release version(now 2.7) to the newest commit as the new code.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yBKgd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2059,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52bxWY,kvrocks,1986991512,2059,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-03-09T22:00:36Z,2024-03-09T22:00:36Z,Add PR #2147 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52bxWY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2061,https://api.github.com/repos/apache/kvrocks/issues/2061,kvrocks,2103578748,2061,Add RESP3 attribute type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-01-27T13:00:13Z,2024-02-05T03:36:39Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2061/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2064,https://api.github.com/repos/apache/kvrocks/issues/2064,kvrocks,2104015812,2064,Tracking Issues: Add support of RediSearch,PragmaTwice,20042607,Twice,,CLOSED,2024-01-28T07:34:34Z,2025-01-28T02:25:45Z,"[RediSearch](https://redis.io/docs/interact/search-and-query/) is a [Redis module](https://redis.io/modules) that provides querying, secondary indexing, and full-text search for Redis.

If Kvrocks supports RediSearch, it will offer users a range of powerful features with significant potential applications. This will enable Kvrocks to have query capabilities that are comparable to those of relational databases. 

Also, RediSearch is the foundation of the vector search feature. To enable vector search, Kvrocks must first possess the framework and fundamental capabilities of RediSearch.

We believe that RediSearch represents the current direction of development.

To support RediSearch, we need to:
- design the encoding of various types of indexing,
- indexing construction, indexed key monitoring,
- redis query syntax, SQL syntax supporting,
- query plan generator, optimizer, executor,
- vector indexing and querying

Index types to be supported:
- tag
- numeric
- TBD
  - vector
  - text
  - geo

Task breakdown:
- [x] #2065
- [x] #2070
- [x] #2071
- [x] #2125
- [x] #2126
- [x] #2127
- [x] IR optimization 
- [x] query plan generation
- [x] query execution 
- [x] commands

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2064/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2065,https://api.github.com/repos/apache/kvrocks/issues/2065,kvrocks,2104074249,2065,Add search metadata and tag field metadata encoding for RediSearch,PragmaTwice,20042607,Twice,,CLOSED,2024-01-28T09:44:03Z,2024-01-30T12:04:35Z,Refer to https://redis.io/docs/interact/search-and-query/advanced-concepts/tags/.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2065/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/2068,kvrocks,2104115705,2068,kvrocks' BITCOUNT result is different from Redis,kay011,64449652,,,CLOSED,2024-01-28T11:34:21Z,2024-01-30T12:02:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

1. setbit mykey1 0 1
2. bitcount mykey1 -1 -1

### What did you expect to see?

redis result: 1
kvrocks result: 1

### What did you see instead?

redis result: 1
kvrocks result: 0

### Anything Else?

In `redis_bitmap.cc` 226~229 line. The processing of logical strings here is inconsistent. I am confused whether there are special considerations or a BUG here?

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2068/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDu9W,kvrocks,1913581398,2068,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-28T12:34:22Z,2024-01-28T12:34:22Z,"```c++
  if (start < 0 || stop <= 0 || start >= stop) return rocksdb::Status::OK();
```

The point maybe the condition above...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDu9W/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDv2x,kvrocks,1913585073,2068,NA,kay011,64449652,,,NA,2024-01-28T12:47:22Z,2024-01-28T12:47:22Z,"```
if (start < 0) start += static_cast<int64_t>(metadata.size) + 1;
if (stop < 0) stop += static_cast<int64_t>(metadata.size) + 1;
if (stop > static_cast<int64_t>(metadata.size)) stop = static_cast<int64_t>(metadata.size);
if (start < 0 || stop <= 0 || start >= stop) return rocksdb::Status::OK();
```

I think the code is confused, what is the` metadata.size `means？ the used bytes of bitmap，why should +1 ？
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDv2x/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDw4w,kvrocks,1913589296,2068,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-28T13:02:15Z,2024-01-28T13:02:15Z,"> what is themetadata.sizemeans

Means the ""extended"" bit size. e.g.:

```
set bit 100 1
--> length = 100
set bit 99 1
--> length = 99
set bit 101 1
--> length = 101
```

> the used bytes of bitmap，why should +1 

You can edit it as you'd like 🤔","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDw4w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDy5K,kvrocks,1913597514,2068,NA,kay011,64449652,,,NA,2024-01-28T13:30:18Z,2024-01-28T13:30:18Z,"@mapleFU I do a test, it it not work like you said: 
set bit 100 1
--> length = 100
but: length = 13 😄","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDy5K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDzBf,kvrocks,1913598047,2068,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-28T13:32:02Z,2024-01-28T13:32:02Z,"Yeah, it's bytesize, should contain a `mod 8`:

```
  uint32_t byte_index = (offset / 8) % kBitmapSegmentBytes;
  uint64_t used_size = index + byte_index + 1;
  uint64_t bitmap_size = std::max(used_size, metadata.size);
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDzBf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDz9Q,kvrocks,1913601872,2068,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-28T13:45:03Z,2024-01-28T13:45:03Z,Maybe this is the same reason with https://github.com/apache/kvrocks/issues/1212#issuecomment-1366801588,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yDz9Q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yD1CB,kvrocks,1913606273,2068,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-28T13:59:12Z,2024-01-28T13:59:12Z,@kay011 would you like fixing this? If not I'll do a quick fixing,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yD1CB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yD1cK,kvrocks,1913607946,2068,NA,kay011,64449652,,,NA,2024-01-28T14:04:58Z,2024-01-28T14:04:58Z,"> @kay011 would you like fixing this? If not I'll do a quick fixing

you can do it, I will merge your code in my other feature","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yD1cK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yD75v,kvrocks,1913634415,2068,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-28T15:28:44Z,2024-01-28T15:28:44Z,I'm trying to fix it here: https://github.com/apache/kvrocks/pull/2069,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yD75v/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yD-kM,kvrocks,1913645324,2068,NA,kay011,64449652,,,NA,2024-01-28T16:05:55Z,2024-01-28T16:05:55Z,"@mapleFU BITPOS command may be have the same problem, please check~","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yD-kM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yEDKX,kvrocks,1913664151,2068,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-28T17:12:21Z,2024-01-28T17:12:21Z,"Sigh, I've checked and also fixed that","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yEDKX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yHwST,kvrocks,1914635411,2068,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-29T12:51:39Z,2024-01-29T12:51:39Z,closed by https://github.com/apache/kvrocks/pull/2069,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yHwST/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2068,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNpqr,kvrocks,1916181163,2068,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-30T06:47:30Z,2024-01-30T06:47:30Z,"https://github.com/apache/kvrocks/pull/2074

<del>Found BitmapString also has this problem 😅 Let me take time to fix it</del>

Oh, it's an expected behavior","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNpqr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2070,https://api.github.com/repos/apache/kvrocks/issues/2070,kvrocks,2105681581,2070,Add encoding design for numeric type index,PragmaTwice,20042607,Twice,,CLOSED,2024-01-29T14:52:59Z,2024-02-29T11:23:51Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2070/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2070,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51efIq,kvrocks,1970926122,2070,NA,PragmaTwice,20042607,Twice,,NA,2024-02-29T11:23:50Z,2024-02-29T11:23:50Z,Finished in #2086.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51efIq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2071,https://api.github.com/repos/apache/kvrocks/issues/2071,kvrocks,2105682219,2071,Proposal: A unified query intermediate representation for RediSearch and SQL,PragmaTwice,20042607,Twice,,CLOSED,2024-01-29T14:53:17Z,2024-03-26T02:31:36Z,"It is part of #2064.

RediSearch provides [a special syntax](https://redis.io/docs/interact/search-and-query/advanced-concepts/query_syntax/) for data query, while its semantics has no difference than a subset of SQL DQL.

To be comatible with RediSearch, we should support such query syntax. However, if we can also offer a SQL-like syntax simultaneously, it will greatly benefit users and minimize the learning curve. (Especially since the Redis query syntax is weird and has huge semantic gaps between different versions: v1 and v2.)

To support both syntaxes simultaneously, we can design a unified intermediate representation (called Kvrocks Query Intermediate Representation, KQIR) and transform both syntaxes into this representation when processing user input.

Hence, the frontend of KQIR will be:
- Redis query syntax (v2) and FT.SEARCH fields (for maintainance consideration, v1 will NOT be supported),
- SQL select statement (try to be compatible with MySQL)

Detailed design will be provided soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2071/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2071,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yL9dF,kvrocks,1915737925,2071,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-29T23:12:16Z,2024-01-29T23:12:16Z,"It seems like we don't need support JOIN because `FT.SEARCH` doesn't support JOIN.
It is a good news for KQIR design.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yL9dF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2072,https://api.github.com/repos/apache/kvrocks/issues/2072,kvrocks,2106863102,2072,Command SRANDMEMBER returns empty array when [count] is a negative number,sam-hn,158024595,,,CLOSED,2024-01-30T03:13:23Z,2024-02-26T15:02:45Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.7.0

### Minimal reproduce step

10.70.163.45:6666> srandmember set1 5
1) ""mem1""
2) ""mem2""
3) ""mem3""
10.70.163.45:6666> srandmember set1 -5
(empty array)
10.70.163.45:6666> srandmember set1 -2
(empty array)

### What did you expect to see?

According to https://redis.io/commands/srandmember/, If called with a negative count, the behavior changes and the command is allowed to return the same element multiple times. In this case, the number of returned elements is the absolute value of the specified count

### What did you see instead?

<empty array>

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2072/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2072,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yM9le,kvrocks,1916000606,2072,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-30T03:17:57Z,2024-01-30T03:17:57Z,"@sam-hn Thank you. 
You can find related code in [this](https://github.com/apache/kvrocks/blob/aa1de3f53252a16e43d381fec83d64ec59228869/src/commands/cmd_set.cc#L190)
And it is better if you can add a [test case](https://github.com/apache/kvrocks/blob/aa1de3f53252a16e43d381fec83d64ec59228869/tests/gocase/unit/type/set/set_test.go#L657) ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yM9le/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2072,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yM95L,kvrocks,1916001867,2072,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-30T03:19:37Z,2024-01-30T03:19:37Z,It has been resolved in https://github.com/apache/kvrocks/pull/2032?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yM95L/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2072,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yM_cW,kvrocks,1916008214,2072,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-01-30T03:27:51Z,2024-01-30T03:27:51Z,"@git-hulk It looks like no. First is Redis, second is kvrocks
![image](https://github.com/apache/kvrocks/assets/32858525/494d4cd9-6f1e-4c36-9ad4-c5af5cf091e9)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yM_cW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2072,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNARe,kvrocks,1916011614,2072,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-01-30T03:32:15Z,2024-01-30T03:32:15Z,"```c++
rocksdb::Status Set::Take(const Slice &user_key, std::vector<std::string> *members, int count, bool pop) {
  int n = 0;
  members->clear();
  if (count <= 0) return rocksdb::Status::OK();
```

The problem it's the 4th line... It would be easy to fix","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNARe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2072,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNCqp,kvrocks,1916021417,2072,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-01-30T03:46:06Z,2024-01-30T03:46:06Z,"> @git-hulk It looks like no. First is Redis, second is kvrocks ![image](https://private-user-images.githubusercontent.com/32858525/300670400-494d4cd9-6f1e-4c36-9ad4-c5af5cf091e9.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDY1ODY1NjUsIm5iZiI6MTcwNjU4NjI2NSwicGF0aCI6Ii8zMjg1ODUyNS8zMDA2NzA0MDAtNDk0ZDRjZDktNmYxZS00YzM2LTlhZDQtYzVhZjVjZjA5MWU5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAxMzAlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMTMwVDAzNDQyNVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWFjNjk1ZGQ1MGUxY2IzYWY5YTk0NzZhZWRlODI1ZWZlMTIxYWE4NDViYWUyNGFiOGRhM2ZkNDhjZWYzMzAxNWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.begJM7XSuREdnTeeujIV2vK9ZyNgOjDW5R4uMhZOzkg)

Got it, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNCqp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2072,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51FbCq,kvrocks,1964355754,2072,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-02-26T15:02:45Z,2024-02-26T15:02:45Z,I've fixed this via: https://github.com/apache/kvrocks/pull/2113,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51FbCq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2073,https://api.github.com/repos/apache/kvrocks/issues/2073,kvrocks,2106910396,2073,proposal: add the default pull request template,LykxSassinator,18441614,lucasliang,nkcs_lykx@hotmail.com,CLOSED,2024-01-30T04:06:02Z,2024-01-30T05:56:24Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I found that Kvrocks lacks of the template for building PRs. And I wanna know whether it's necessary to supply a standard template for contributors to build PRs.

IMO, it's recommended to support a PR template for developers and contributors to make the contribution with a canonicalized guiding.

### Solution

Supply the PR template.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2073/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2073,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNINk,kvrocks,1916044132,2073,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2024-01-30T04:16:08Z,2024-01-30T04:16:08Z,"Since you have an idea to propose, I'm OK to give it a review. But from my experience a longy template is simply ignored. The important part is the PR author remembers to describe their PR and sets up issue references.

Currently, I don't see an urgent necessary for setting such a template for Kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNINk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2073,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNdQP,kvrocks,1916130319,2073,NA,LykxSassinator,18441614,lucasliang,nkcs_lykx@hotmail.com,NA,2024-01-30T05:56:24Z,2024-01-30T05:56:24Z,"Yep, I agree with it. It certainly depends on the self-disciplined manners of the PR author.

Fine, maybe it can be picked up later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5yNdQP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2076,https://api.github.com/repos/apache/kvrocks/issues/2076,kvrocks,2109443741,2076,"Extract a bit_util for ""BIT*"" Commands",mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2024-01-31T07:19:06Z,2024-02-19T11:33:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, we have 2 separate implemention for BITs, including `Bitmap` and `BitmapString`. To reducing the inconsistent bug and reducing the complexity of bit-operations, we need extract some common operations including:
1. GetBit
2. SetBit
3. ...

e.g.:
1. https://github.com/apache/arrow-rs/blob/50.0.0/parquet/src/util/bit_util.rs
2. https://github.com/apache/arrow/blob/787afa1594586d2d556d21471647f9cd2c55b18f/cpp/src/arrow/util/bit_util.h

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2076/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2077,https://api.github.com/repos/apache/kvrocks/issues/2077,kvrocks,2109884169,2077,Refactor the data migration code,caipengbo,19643013,Myth,caipengbo@outlook.com,OPEN,2024-01-31T11:26:52Z,2024-02-17T16:38:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Now that we have support for `DBIterator` and `WALIterator`, we can refactor migration code based on redis-command using these two classes. Also, now that we support two different migration types, we can make the code base about migration a bit cleaner than it is now.

The unit tests could also be clearer.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2077/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2077,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50NVv0,kvrocks,1949654004,2077,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-02-17T05:18:41Z,2024-02-17T05:18:41Z,"Hi, i'm interested in this issue, could you please assign this to me? ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50NVv0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2077,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50N-Dm,kvrocks,1949819110,2077,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2024-02-17T06:40:47Z,2024-02-17T06:40:47Z,"@wsehjk Assigned. Go ahead :D

Based on my experience, you can share your opinion on this issue and how you'd like to implement it. If it's trivial, directly sending a patch is good.

Barely asking for an assignment without any thoughts or progress attempts often ends with giving up.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50N-Dm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2077,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50OVd8,kvrocks,1949915004,2077,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-02-17T09:31:01Z,2024-02-17T09:31:01Z,@caipengbo Would you mind giving some input about what you plan to improve?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50OVd8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2077,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50OWWn,kvrocks,1949918631,2077,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-02-17T09:47:41Z,2024-02-17T09:47:41Z,"@git-hulk This is my personal opinion for reference only:

1. decouple the iteration logic from the send logic: 
    - use `DBIterator` and `WALIterator` for data iteration
    - use a `Sender` helper class for sending data and rate limit
2. Make the two migration types more uniform
3. Refactor Golang unit tests about data migration to make them more concise and faster to run
4. Other minor change: 
    - `MigrationJob` stores what is really needed
    -  ...

As @tisonkun said, you can also share some of your plans and we can discuss them together @wsehjk .","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50OWWn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2077,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50OX2o,kvrocks,1949924776,2077,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-02-17T10:13:58Z,2024-02-17T10:13:58Z,@caipengbo Thanks for your input.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50OX2o/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2077,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50Pns3,kvrocks,1950251831,2077,NA,wsehjk,59788262,Leslie,Wse1714401046@gmail.com,NA,2024-02-17T16:38:17Z,2024-02-17T16:38:17Z,"> @git-hulk This is my personal opinion for reference only:
> 
> 1. decouple the iteration logic from the send logic:
>    
>    * use `DBIterator` and `WALIterator` for data iteration
>    * use a `Sender` helper class for sending data and rate limit
> 2. Make the two migration types more uniform
> 3. Refactor Golang unit tests about data migration to make them more concise and faster to run
> 4. Other minor change:
>    
>    * `MigrationJob` stores what is really needed
>    * ...
> 
> As @tisonkun said, you can also share some of your plans and we can discuss them together @wsehjk .

Thank you for the info, really helpful, and i will walk through the code and share my thought before developing ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50Pns3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2078,https://api.github.com/repos/apache/kvrocks/issues/2078,kvrocks,2109898569,2078,Use redis-command data migration type when the destination does not support ApplyBatch command,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2024-01-31T11:35:31Z,2024-02-28T15:29:45Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

In https://github.com/apache/kvrocks/pull/2010, we support the new `APPLYBATCH` command for data migration scenarios. In https://github.com/apache/kvrocks/pull/2067, we use this command, to realize the new `raw-key-value` migration type. 

But the `raw-key-value` migration won't work if the target doesn't support the `APPLYBATCH` command, so we can add a fallback mechanism. We can use the old `redis-command` migration type when the destination does not support `ApplyBatch` command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2078/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2079,https://api.github.com/repos/apache/kvrocks/issues/2079,kvrocks,2110214709,2079,Disable the slot compaction while the cluster slot is migrating,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2024-01-31T14:24:40Z,2024-01-31T14:24:40Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, we allow to run compaction even though the slot is migrating,
so it may cause data inconsistent in the corner case like below:

1. The cluster migration was started at T1 with the snapshot
2. The key 'foo' expired at T2, but it's extended between T1 and T2 to T3
3. Then the slot starts migrating the key 'foo' after T2, then it will be skipped since it's expired
4. Finally, the extended time write batch will be applied by iterating WAL items, but it will miss the subkeys since all of them are skipped.

This issue was found by @caipengbo, just record to prevent forgetting.

### Solution

Don't compact the slot if it's migrating, and also migrate them if it's expired.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2079/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2084,https://api.github.com/repos/apache/kvrocks/issues/2084,kvrocks,2111566050,2084,BITPOS command in Bitmap type didn't handle `stop_given`,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2024-02-01T05:07:10Z,2024-02-03T13:52:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Bitpos: https://redis.io/commands/bitpos/

When `stop` is given, even searching for `0`, we cannot exceeds the boundary.

This is handled in BitmapString, but Bitmap doesn't handling it.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2084/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2091,https://api.github.com/repos/apache/kvrocks/issues/2091,kvrocks,2122846349,2091,[CI] TestKeyspace.Type_a_expired_key failed,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2024-02-07T11:46:07Z,2024-02-17T13:39:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

master



### Minimal reproduce step

See: https://github.com/apache/kvrocks/actions/runs/7813343348/job/21312734346

### What did you expect to see?

CI passed

### What did you see instead?

failed

### Anything Else?

no

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2091/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2097,https://api.github.com/repos/apache/kvrocks/issues/2097,kvrocks,2128430314,2097,Support namespace in Pub/Sub commands,PragmaTwice,20042607,Twice,,OPEN,2024-02-10T13:25:24Z,2024-04-03T06:39:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently the namespace mechanism is not supported by Pub/Sub series commands.

Actually it may be not hard to support by using concurrent containers in TBB.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2097/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2097,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5zsAYM,kvrocks,1940915724,2097,NA,JxLi0921,53040712,jxlikar,,NA,2024-02-13T09:34:09Z,2024-02-13T09:34:09Z,"According to the redis docs( https://redis.io/docs/interact/pubsub/ ), the Pub/Sub command in redis is not related to the database numbers.
> Pub/Sub has no relation to the key space.
It was made to not interfere with it on any level, including database numbers.
Publishing on db 10, will be heard by a subscriber on db 1.

It seems that the namespace mechanism in kvrocks has similar purpose as the database numbers in redis, so if we want the commands to be consistent with redis, will it be better if we just keep using current implementation?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5zsAYM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2097,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55N2e3,kvrocks,2033674167,2097,NA,Chiro11,44946252,,,NA,2024-04-03T06:39:37Z,2024-04-03T06:39:37Z,"Do you still think this feat should be implemented? I think what @JxLi0921 said makes sense. But if you think this is valuable, please assign it to me. I am willing to have a try as my first issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55N2e3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2101,https://api.github.com/repos/apache/kvrocks/issues/2101,kvrocks,2131985281,2101,ci: Update CentOS 7 in stage: build-and-test-in-container,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,CLOSED,2024-02-13T10:28:46Z,2024-07-02T13:34:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

At summer 2024 we have a two deprecates - Github runner-s. based on NodeJS 16 and CentOS 7 (see: https://blog.centos.org/2023/04/end-dates-are-coming-for-centos-stream-8-and-centos-linux-7/)

### Solution

So, we can't continuous use old runners and need to switch from CentOS 7 to other OS where we can use NodeJS 20.  

Lets talk for best solution

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2101/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2101,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5zwjJe,kvrocks,1942106718,2101,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-02-13T17:57:09Z,2024-02-13T17:57:09Z,"In addition, an docker image not supported too - https://hub.docker.com/_/centos 

> This image is no longer supported/maintained (non-EOL tags last updated November 16, 2020

So, maybe we switch into Ubuntu?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5zwjJe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2101,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5zwjkx,kvrocks,1942108465,2101,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-02-13T17:58:26Z,2024-02-13T17:58:26Z,@tisonkun @PragmaTwice @git-hulk ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5zwjkx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2101,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5z_AZ3,kvrocks,1945896567,2101,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-02-15T11:22:07Z,2024-02-15T11:22:07Z,"I think we can ignore the centos7 warning.

At least in China, a large number of enterprises are still using centos7, it is necessary to keep the CI of centos7.

I've researched this issue and the reason centos7 can't use nodejs20 is because the libc version of nodejs20 is incompatible with the version that comes with centos7. However, kvrocks also depends on libc, so we can't upgrade the libc version for nodejs20. 
To summarize, there is no way to solve this problem in my opinion.

So I suggest keeping this annoying warning","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5z_AZ3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2101,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5z_J7x,kvrocks,1945935601,2101,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-02-15T11:45:34Z,2024-02-15T11:45:34Z,"@jihuayu lot of thanks about research. But, as I see, when Github are moved all runners to NodeJS 20 (see https://github.blog/changelog/2023-09-22-github-actions-transitioning-from-node-16-to-node-20/) our pipelines will not work","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5z_J7x/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2101,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6DQTKZ,kvrocks,2202088089,2101,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-07-02T06:50:56Z,2024-07-02T06:50:56Z,"So, what we can do next? From yesterday, CentOS repo has no working. Some a archive are there - http://archive.kernel.org/centos-vault/

Now all CI pipelines are broken at this stage","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6DQTKZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2101,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6DQeLg,kvrocks,2202133216,2101,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-07-02T07:12:02Z,2024-07-02T07:12:02Z,I'm in favor of removing support of CentOS7 in CI due to it has been EOL.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6DQeLg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2109,https://api.github.com/repos/apache/kvrocks/issues/2109,kvrocks,2146228738,2109,Create stream consumer group will make the xread command error,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,CLOSED,2024-02-21T09:24:08Z,2024-02-23T03:58:52Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step


```shell
XADD test * a a
XGROUP create test test 0
xread STREAMS test 0
```

### What did you expect to see?

```shell
1) 1) ""test""
   2) 1) 1) ""1708506496723-0""
         2) 1) ""a""
            2) ""a""
```

### What did you see instead?

(error) ERR Invalid argument: failed to decode stream entry value

### Anything Else?

I discovered this when developing the xreadgroup command.

The subkey of the consumer group overlapped with the subkey of the stream entry.
This causes the [range function](https://github.com/apache/kvrocks/blob/30f6bee42d4352715ce254a52c4403fe6b0ab5e7/src/types/redis_stream.cc#L686) to get the stream Entry with the group's subkey.

I think there is something wrong with the subkey design of the consumer & consumer group metadata.
https://github.com/apache/kvrocks/blob/30f6bee42d4352715ce254a52c4403fe6b0ab5e7/src/types/redis_stream.cc#L168-L176

I don't really understand why we puts the consumerGroupMetadataDelimiter at the end of the subkey. Shouldn't we put it at the start?

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2109/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2109,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50wJH2,kvrocks,1958777334,2109,NA,Yangsx-1,85615957,Hauru,,NA,2024-02-22T06:18:13Z,2024-02-22T06:18:13Z,"Good catch! I'm still working on XREADGROUP and will finish it in a few days, and this bug may caused by no subkey identification in the original stream commands.  :(","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM50wJH2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2109,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM503IWz,kvrocks,1960609203,2109,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-02-23T01:23:15Z,2024-02-23T01:23:15Z,"@Yangsx-1 Thank you. I have fixed this bug, please review it.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM503IWz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2114,https://api.github.com/repos/apache/kvrocks/issues/2114,kvrocks,2151323858,2114,BloomFilter support migration,mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2024-02-23T15:31:20Z,2024-02-24T00:41:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Support BloomFilter migration in kvrocks BF.

### Solution

Support BloomFilter migration in kvrocks BF.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2114/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2114,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM509H6B,kvrocks,1962180225,2114,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-02-24T00:41:18Z,2024-02-24T00:41:18Z,"This would be supported if `migrate-type` is `raw-key-value`, migration by sending commands way seems hard to do.

refer https://github.com/apache/kvrocks/pull/2067","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM509H6B/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2118,https://api.github.com/repos/apache/kvrocks/issues/2118,kvrocks,2154392744,2118,"""RDB LOAD"" command fails",krizald,7716750,Leon,,CLOSED,2024-02-26T15:00:28Z,2024-02-28T16:37:07Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

**OS**: Debian GNU/Linux 11 (bullseye)
**KV Rocks**: 2.7.0 

### Minimal reproduce step

* Create a LIST (Key: ABC) in Redis 6.2
* Dump the RDB file
* RDB LOAD dump.rdb

### What did you expect to see?

RDB file should be loaded without error

### What did you see instead?

Load failed with error:

redis-cli throws error: (error) ERR reach the end of ziplist
KV Rocks log: E20240223 08:55:35.669234 1006372 rdb.cc:78] Unexpected EOF reading RDB file


### Anything Else?

I tried anther tool Redis-Shake to load the same RDB, with it's default setting. Firstly I got a similar error:
ERR [writer_127.0.0.1_7619] receive reply failed. cmd=[restore ABCD], error=[ERR reach the end of ziplist]
Then I follow this(https://github.com/tair-opensource/RedisShake/blob/0cf0af07411fb85dc9c08b78fea77c37880795a9/docs/src/zh/writer/redis_writer.md?plain=1#L28) to changed the redis-shake config to avoid using ""restore"" cmd. The RDP import is successful.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2118/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2118,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51F6pQ,kvrocks,1964485200,2118,NA,tisonkun,18818196,tison,wander4096@gmail.com,NA,2024-02-26T15:55:38Z,2024-02-26T15:55:38Z,The error seems not attached.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51F6pQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2118,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51F_SD,kvrocks,1964504195,2118,NA,krizald,7716750,Leon,,NA,2024-02-26T16:01:34Z,2024-02-26T16:01:34Z,"> The error seems not attached.

Sorry, I updated my post.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51F_SD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2118,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51GIk5,kvrocks,1964542265,2118,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-02-26T16:12:26Z,2024-02-26T16:12:26Z,@krizald Thanks for your report. It will be great if you can upload you test rdb file as well.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51GIk5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2118,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51GtD_,kvrocks,1964691711,2118,NA,krizald,7716750,Leon,,NA,2024-02-26T17:19:36Z,2024-02-26T17:19:36Z,"> @krizald Thanks for your report. It will be great if you can upload you test rdb file as well.

@git-hulk here it is

[dump.zip](https://github.com/apache/kvrocks/files/14408108/dump.zip)

Dump file is generated with Redis 6.2.10","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51GtD_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2118,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51KK0G,kvrocks,1965600006,2118,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-02-27T00:55:58Z,2024-02-27T00:55:58Z,@krizald Thanks for your help. Will fix it soon.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51KK0G/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2118,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51Uetc,kvrocks,1968302940,2118,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-02-28T06:12:30Z,2024-02-28T06:12:30Z,"Hi @krizald 

I have identified the bug in the quick list encoding, will fix it today, and release it in the next version(maybe 2.8.0).
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51Uetc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2121,https://api.github.com/repos/apache/kvrocks/issues/2121,kvrocks,2158387261,2121,COMMAND INFO can get the renamed command using the original command ,caipengbo,19643013,Myth,caipengbo@outlook.com,CLOSED,2024-02-28T08:28:03Z,2024-02-28T14:05:42Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

latest

### Minimal reproduce step

Start kvrocks:
```
rename-command GET RENAMEDGET
```

### What did you expect to see?

```
127.0.0.1:6379> COMMAND INFO GET
1) (nil)

127.0.0.1:6379> COMMAND INFO RENAMEDGET
1) 1) ""get""
   2) (integer) 2
   3) 1) ""readonly""
   4) (integer) 1
   5) (integer) 1
   6) (integer) 1
```

### What did you see instead?

```
127.0.0.1:6379> COMMAND INFO GET
1) 1) ""get""
   2) (integer) 2
   3) 1) ""readonly""
   4) (integer) 1
   5) (integer) 1
   6) (integer) 1
127.0.0.1:6379> COMMAND INFO RENAMEDGET
1) (nil)
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2121/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2125,https://api.github.com/repos/apache/kvrocks/issues/2125,kvrocks,2161031150,2125,Add index updater for tag and numeric fields,PragmaTwice,20042607,Twice,,CLOSED,2024-02-29T11:26:26Z,2024-02-29T11:28:10Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2125/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2125,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51ehGF,kvrocks,1970934149,2125,NA,PragmaTwice,20042607,Twice,,NA,2024-02-29T11:27:55Z,2024-02-29T11:27:55Z,Finished in #2111 and #2115.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51ehGF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2126,https://api.github.com/repos/apache/kvrocks/issues/2126,kvrocks,2161031247,2126,Add SQL select query parser for RediSearch,PragmaTwice,20042607,Twice,,CLOSED,2024-02-29T11:26:28Z,2024-03-23T06:13:22Z,"We generally follow a subset of the MySQL SELECT statement syntax:
https://dev.mysql.com/doc/refman/8.0/en/select.html","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2126/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2127,https://api.github.com/repos/apache/kvrocks/issues/2127,kvrocks,2161031327,2127,Add redis query parser for RediSearch,PragmaTwice,20042607,Twice,,CLOSED,2024-02-29T11:26:30Z,2024-03-23T08:49:22Z,Refer to https://redis.io/docs/interact/search-and-query/advanced-concepts/query_syntax/,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2127/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2129,https://api.github.com/repos/apache/kvrocks/issues/2129,kvrocks,2161309250,2129,lua script import error,i18nsite,145643935,i18n.site,i18n.site@gmail.com,CLOSED,2024-02-29T13:47:35Z,2024-03-02T10:57:49Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

nightly

### Minimal reproduce step


```
git clone https://atomgit.com/i18n-now/tmp
cd tmp
cat redis.lua | redis-cli -h 127.0.0.1 -p 2901 -a $REDIS_PASSWORD -x FUNCTION LOAD REPLACE
```

### What did you expect to see?

ERR Error while running newfunction lib:redis.register function()requirestwo argument

### What did you see instead?

![image](https://github.com/apache/kvrocks/assets/145643935/7c18cae1-c54d-4e05-947d-a17fbeb5ed15)
https://atomgit.com/i18n-now/tmp/blob/dev/redis.lua
我尝试导入这个lua脚本，redis可以（第二行），kvrocks报错（第一行）

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2129/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2129,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51ff02,kvrocks,1971191094,2129,NA,PragmaTwice,20042607,Twice,,NA,2024-02-29T13:52:11Z,2024-02-29T13:52:11Z,"Currently `redis.register_function()` in kvrocks FUNCTION doesn't support the `flags` parameter:

https://atomgit.com/i18n-now/tmp/blob/dev/redis.lua#L83

Please remove it and try again.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51ff02/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2129,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51gE0e,kvrocks,1971342622,2129,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-02-29T15:07:50Z,2024-02-29T15:07:50Z,The lua function `redis.setresp` will be supported in https://github.com/apache/kvrocks/pull/2130,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51gE0e/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2129,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51j-KN,kvrocks,1972363917,2129,NA,i18nsite,145643935,i18n.site,i18n.site@gmail.com,NA,2024-03-01T02:42:08Z,2024-03-01T02:42:08Z,"> Currently `redis.register_function()` in kvrocks FUNCTION doesn't support the `flags` parameter:目前在 `redis.register_function()` kvrocks 中，FUNCTION 不支持以下 `flags` 参数：
> 
> https://atomgit.com/i18n-now/tmp/blob/dev/redis.lua#L83
> 
> Please remove it and try again.请将其删除，然后重试。

明白，建议加一个简单忽略","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51j-KN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2129,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51n7Qk,kvrocks,1973400612,2129,NA,PragmaTwice,20042607,Twice,,NA,2024-03-01T15:35:48Z,2024-03-01T15:35:48Z,I'll close this issue since it is not a bug. But feel free to open a feature-request issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51n7Qk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2129,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51tH9Q,kvrocks,1974763344,2129,NA,i18nsite,145643935,i18n.site,i18n.site@gmail.com,NA,2024-03-02T10:57:48Z,2024-03-02T10:57:48Z,added https://github.com/apache/kvrocks/issues/2133,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51tH9Q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2133,https://api.github.com/repos/apache/kvrocks/issues/2133,kvrocks,2164758025,2133,Add support for `flags` parameter of `redis.register_function`,i18nsite,145643935,i18n.site,i18n.site@gmail.com,OPEN,2024-03-02T10:57:35Z,2024-05-16T15:39:48Z,"### Search before asking

https://redis.io/docs/interact/programmability/functions-intro/#function-flags

<img width=""1199"" alt=""image"" src=""https://github.com/apache/kvrocks/assets/145643935/4a6def33-27e1-4e38-ac63-4922369d4290"">

### Motivation

compatibility

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2133/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2133,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-GTgY,kvrocks,2115581976,2133,NA,VasuDevrani,101383635,,,NA,2024-05-16T15:39:46Z,2024-05-16T15:39:46Z,"@PragmaTwice 
- `flags` parameter in `redis.register_function`
- will allow `no-writes` flag 
- do we need to support other flags? like `allow-oom`, `admin`

Possible implementation:
1. `RedisRegisterFunction` parses `flags` table and checks for `no-writes` [src/storage/scripting.cc](https://github.com/apache/kvrocks/blob/unstable/src/storage/scripting.cc)
2. if invalid flag, raise error, else store as constant (or something else)
3. check function flags before execution `FunctionCall` [src/storage/scripting.cc](https://github.com/apache/kvrocks/blob/unstable/src/storage/scripting.cc)

```cc
if (read_only && !(flags & redis::kFunctionNoWrites)) {
  return {Status::NotOK, ""Can not execute a function with write flag using fcall_ro.""};
}
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-GTgY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2135,https://api.github.com/repos/apache/kvrocks/issues/2135,kvrocks,2165081864,2135,set sync option to true for WriteOptions,photoszzt,1476795,Zhiting Zhu,,CLOSED,2024-03-03T02:17:06Z,2024-03-04T02:57:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

![image](https://github.com/apache/kvrocks/assets/1476795/7d4d1e62-346a-4874-862a-80e5ea1841df)
From the slack conversation, kvrocks currently doesn't set the WriteOptions's sync mode to true which might lose data upon crash. https://github.com/facebook/rocksdb/wiki/WAL-Performance 

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2135/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2135,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51t_yC,kvrocks,1974992002,2135,NA,PragmaTwice,20042607,Twice,,NA,2024-03-03T02:38:53Z,2024-03-03T02:38:53Z,"Hi @photoszzt , thank you for your suggestion!

It is important to prevent data loss, but I wonder the performance impact of this option.

And should we enable sync mode by default, or we make it a configuration option (kvrocks.conf) for users?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51t_yC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2135,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51uBu-,kvrocks,1974999998,2135,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-03T02:42:31Z,2024-03-03T02:42:31Z,"Yes, this option might heavily affect the performance, so guess it will be better to make a configuration option for users.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51uBu-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2135,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51uGk5,kvrocks,1975019833,2135,NA,photoszzt,1476795,Zhiting Zhu,,NA,2024-03-03T04:40:13Z,2024-03-03T04:40:13Z,"
![image](https://github.com/apache/kvrocks/assets/1476795/dde4626c-a4a0-45ba-8f1c-dc17c5023521)

@PragmaTwice There's an option in the conf file: rocksdb.write_options.sync. It's set to no right now. I assume it will set WriteOptions.sync=true when I change this config to yes. I'm going to see how much slower if this is set to yes. 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51uGk5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2135,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51uWyX,kvrocks,1975086231,2135,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-03T08:31:44Z,2024-03-03T08:31:44Z,"I don't think we should change our default behavior here. But you can edit yourself's config

> I assume it will set WriteOptions.sync=true when I change this config to yes.

Yes.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51uWyX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2135,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51wL2w,kvrocks,1975565744,2135,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-04T02:57:10Z,2024-03-04T02:57:10Z,"@photoszzt I'm sorry for forgetting this configuration has been supported, you can achieve this by adding `rocksdb.write_options.sync yes` to your configuration file. cc @PragmaTwice @mapleFU 

Close this issue since it has been resolved, feel free to reopen it if you have any questions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM51wL2w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2137,https://api.github.com/repos/apache/kvrocks/issues/2137,kvrocks,2169024751,2137,Failed to start server: rename file encounter error: Resource busy,kinoute,623763,Yann Defretin,yann@defret.in,CLOSED,2024-03-05T12:02:32Z,2024-03-05T15:05:44Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.7.0

### Minimal reproduce step

Kubernetes manifest:

```yaml
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: kvrocks
  namespace: ns-svc
spec:
  selector:
    matchLabels:
      run: kvrocks
  serviceName: ""kvrocks""
  replicas: 1
  template:
    metadata:
      labels:
        run: kvrocks
    spec:
      containers:
        - name: kvrocks
          image: apache/kvrocks:2.7.0
          volumeMounts:
            - name: kvrocks
              mountPath: /data
            - name: kvrocks-config
              mountPath: /var/lib/kvrocks/kvrocks.conf
              subPath: kvrocks.conf
          ports:
            - containerPort: 6379
          resources:
            requests:
              cpu: 1
              memory: 2Gi
            limits:
              memory: 2Gi
      volumes:
        - name: kvrocks
          persistentVolumeClaim:
            claimName: kvrocks
        - name: kvrocks-config
          secret:
            secretName: kvrocks-config
```

### What did you expect to see?

Something like this (here running 2.5.0):
```
WARNING: 'repl-namespace-enabled' at line 62 is not a valid configuration key.
WARNING: 'json-max-nesting-depth' at line 318 is not a valid configuration key.
WARNING: 'json-storage-format' at line 325 is not a valid configuration key.
WARNING: 'rocksdb.block_cache_size' at line 565 is not a valid configuration key.
I20240305 11:56:15.776150     1 main.cc:328] kvrocks version 2.5.0
I20240305 11:56:15.910107     1 storage.cc:322] [storage] Success to load the data from disk: 45 ms
I20240305 11:56:15.911934     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.911958     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.912247     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.912269     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.912484     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.912501     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.912691     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.912716     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.912907     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.912925     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.913108     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.913156     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.913347     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.913365     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.913568     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.913585     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:56:15.913951     1 worker.cc:519] [worker] Thread #139894731045680 started
I20240305 11:56:15.914000     1 worker.cc:519] [worker] Thread #139894730869552 started
I20240305 11:56:15.914044     1 worker.cc:519] [worker] Thread #139894730693424 started
I20240305 11:56:15.914089     1 worker.cc:519] [worker] Thread #139894730517296 started
I20240305 11:56:15.914139     1 worker.cc:519] [worker] Thread #139894730341168 started
I20240305 11:56:15.914178     1 worker.cc:519] [worker] Thread #139894730165040 started
I20240305 11:56:15.914217     1 worker.cc:519] [worker] Thread #139894729988912 started
```

### What did you see instead?

```
I20240305 11:58:19.403860     1 main.cc:141] kvrocks version 2.7.0 (commit 33b49591)
I20240305 11:58:19.553138     1 storage.cc:335] [storage] Success to load the data from disk: 44 ms
I20240305 11:58:19.555069     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.555099     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.555413     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.555435     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.555653     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.555670     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.555874     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.555892     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.556083     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.556099     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.556288     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.556304     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
E20240305 11:58:19.558729     1 main.cc:180] Failed to start server: rename file encounter error: Resource busy
I20240305 11:58:19.556530     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.556561     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.556756     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
I20240305 11:58:19.556772     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6379
Stream closed EOF for ns-svc/kvrocks-0 (kvrocks-collect)
````

### Anything Else?

We are trying to update our KvRocks instances from 2.5.0 to 2.7.0. Unfortunately, we encounter the same error over and over again, even on fresh installs.

I found issues talking about this error where it seems to be about namespaces (we didn't change that in the conf) and/or wrong lock on the conf file and a restart could be fix the problem, it doesn't.

It runs perfectly on 2.5.0. I looked at the Dockerfile and I don't see any major changes that could lead to this error. I also tried to override the entrypoint/command of the container, put the conf file elsewhere and call it with ""-c"", no chances.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2137/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2137,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM518BMV,kvrocks,1978667797,2137,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-05T12:30:38Z,2024-03-05T12:30:38Z,"Hi @kinoute

Thanks for your feedback. The root cause is the single mount file `kvrocks.conf` which is unable to be written, you can have a try at: `config rewrite` in 2.5.0 and it should return the same error.

And this start error was introduced in #1776 which would try to rewrite the configuration after loading the namespaces. Maybe we should turn this error into a warning when starting the server. 

You can workaround this issue by mounting the whole dir where kvrocks.conf exists to `/var/lib/kvrocks` without the subPath `kvrocks.conf`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM518BMV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2137,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5183JZ,kvrocks,1978888793,2137,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2024-03-05T14:23:28Z,2024-03-05T14:23:28Z,"Thanks for the quick answer @git-hulk ! I was able to fix it with your workaround. I needed to create an initContainer for this as mounting a secret as volume is now read-only since Kubernetes 1.9. 

For those who are interested, here is a working manifest:

```yaml
---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: kvrocks
  namespace: sahar-svc
spec:
  selector:
    matchLabels:
      run: kvrocks
  serviceName: ""kvrocks""
  replicas: 1
  template:
    metadata:
      labels:
        app: kvrocks
        run: kvrocks
    spec:
      initContainers:
        - name: copy-kvrocks-conf
          image: busybox
          command: [""sh"", ""-c"", ""cp /tmp/kvrocks.conf /var/lib/kvrocks/""]
          volumeMounts:
            - name: kvrocks-config
              mountPath: /tmp/kvrocks.conf
              subPath: kvrocks.conf
            - name: kvrocks-folder
              mountPath: /var/lib/kvrocks
      containers:
        - name: kvrocks
          image: apache/kvrocks:2.7.0
          volumeMounts:
            - name: kvrocks-folder
              mountPath: /var/lib/kvrocks
            - name: kvrocks
              mountPath: /data
          ports:
            - containerPort: 6379
          resources:
            requests:
              cpu: 1
              memory: 2Gi
            limits:
              memory: 2Gi
      volumes:
        - name: kvrocks-folder
          emptyDir: {}
        - name: kvrocks
          persistentVolumeClaim:
            claimName: kvrocks
        - name: kvrocks-config
          secret:
            secretName: kvrocks-config
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5183JZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2137,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM519Ohu,kvrocks,1978984558,2137,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-05T15:05:42Z,2024-03-05T15:05:42Z,@kinoute Thanks for your sharing. I would refer them here if other folks also suffer from this issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM519Ohu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2140,https://api.github.com/repos/apache/kvrocks/issues/2140,kvrocks,2172590258,2140,subkey column family name,xumingbo,21134467,Bo Xu,,CLOSED,2024-03-06T23:00:42Z,2024-03-07T18:22:48Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.7.0

### Minimal reproduce step

constexpr const char *kSubkeyColumnFamilyName = ""default"";

### What did you expect to see?

constexpr const char *kSubkeyColumnFamilyName = ""subkey"";

### What did you see instead?

constexpr const char *kSubkeyColumnFamilyName = ""default"";

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2140/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2140,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52Je4A,kvrocks,1982197248,2140,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-07T01:55:16Z,2024-03-07T01:55:16Z,"@xumingbo We expected to use the rocksdb `default` column family as the subkey column family, so it's an expected behavior NOT a bug.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52Je4A/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2140,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52Q8qQ,kvrocks,1984154256,2140,NA,xumingbo,21134467,Bo Xu,,NA,2024-03-07T18:15:32Z,2024-03-07T18:15:32Z,"If so, could you please comment on that line of code with ""use the rocksdb default column family as the subkey column family"" to have better code readability.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52Q8qQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2143,https://api.github.com/repos/apache/kvrocks/issues/2143,kvrocks,2177079497,2143,add options for set compress level,i18nsite,145643935,i18n.site,i18n.site@gmail.com,CLOSED,2024-03-09T06:37:16Z,2024-03-16T01:46:46Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/facebook/rocksdb/wiki/Space-Tuning#compression-level
Default Zstandard compression level is 3 and it is also a default in RocksDB. Zstandard allows to set compression level from 1 to 19 and it trades compression speed and ratio (https://github.com/facebook/zstd). In one typical DB, we use level 6 and in general we use “compression_opts=-14:6:0”.


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2143/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2143,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52bXOh,kvrocks,1986884513,2143,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2024-03-09T15:22:38Z,2024-03-09T15:22:38Z,Hii! Can you assign this to me? Thank you!! @i18n-now ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52bXOh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2143,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52boc0,kvrocks,1986955060,2143,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-03-09T19:23:59Z,2024-03-09T19:23:59Z,"Important options, lot of thanks about implementation","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52boc0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/2144,kvrocks,2177244252,2144,Enhance the implementation of Random Sample Keys in kvrocks,mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2024-03-09T14:23:30Z,2024-11-21T05:12:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Random sample keys is supported in kvrocks. When running commands like `spop`, scanning all data would be a bottleneck. Currently, the implementation is:
1. Get all sampled values
2. Random filtering K values
3. return

Unlike redis, it's complexity is always O(N), N is the element cardinal, which is extremly high. It's a bit hard to get ""random"" in kvrocks because we're based on rocksdb.

### Solution

There're some rules we can apply:
1. Maintaining a eq-depth histogram if random is frequently. This is the best one if random sample is frequently. However, we'll suffer from maintaining cost during write. TiKV using size based sampling to maintain the split range

So, instead, maybe we can enhance the implementation of current impl. For example:
1. Counting all ""indices"" of random values, and sorting them
2. Using iterator to get only these indices

The complexity is still O(N), but the performance might be enhanced.

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2144/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52goc1,kvrocks,1988265781,2144,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-11T11:52:56Z,2024-03-11T11:52:56Z,"I'm trying to implement this. During my impl, I found a problem that:

1. Get random set size
2. Get all indices, counting the random fetching indices
3. Traverse the set

The command 1-3 should be done in one snapshot, otherwise, the case might be:

* Get all indices, size == 10
* Random need to access 10th member
* User delete an element
* 10th cannot be fetched

So, GetMetadata and traversing the set should be done in one rocksdb snapshot. Would you think this is safe and ok? @git-hulk @PragmaTwice ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52goc1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gxg0,kvrocks,1988302900,2144,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-11T12:14:01Z,2024-03-11T12:14:01Z,"I'm wondering if it'd be better to sacrifice the scope of the candidate set to simplify the implementation like below:

1. if size <= N(e.g. 128/256), then iterate all members and randomly pick one of them.
2. if size > N, random among the first N elements if the cached random point is empty. Otherwise, seek from the cached random point and then random among the next N elements, then cache the random point again or remove the cache random point if it reaches the end.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gxg0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52g0sn,kvrocks,1988315943,2144,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-11T12:21:24Z,2024-03-11T12:21:24Z,"> if size > N, random among the first N elements if the cached random point is empty. Otherwise, seek from the cached random point and then random among the next N elements, then cache the random point again or remove the cache random point if it reaches the end.

I thought of using this previously, and this is named ""statistics"" in this issue. but where should we storing this and how do updating this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52g0sn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52g4Ns,kvrocks,1988330348,2144,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-11T12:29:24Z,2024-03-11T12:29:24Z,">  but where should we storing this and how do updating this?

We're now using a LRU to cache the iterator key while scanning the DB/hash/set, maybe we can do this in the same way.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52g4Ns/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52g5EM,kvrocks,1988333836,2144,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-11T12:31:20Z,2024-03-11T12:31:20Z,"That's a bit complex 🤔, in my current impl I may just need to iter the set with one snapshot...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52g5EM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52hDWa,kvrocks,1988375962,2144,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-11T12:54:19Z,2024-03-11T12:54:19Z,"> That's a bit complex 🤔, in my current impl I may just need to iter the set with one snapshot...

Yes, it should be more complex than the current implementation. Then I think the implementation with the same snapshot is good.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52hDWa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52qzbe,kvrocks,1990932190,2144,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-12T07:20:29Z,2024-03-12T07:20:29Z,"Yeah, another point is that support get meta by snapshot can enhance our isolation. It might slightly affect LSM-Tree Garbage collection, but I think it's ok","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52qzbe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM538Vs9,kvrocks,2012306237,2144,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-21T13:31:26Z,2024-03-21T13:31:26Z,"Aha: https://github.com/apache/kvrocks/commit/95301c5a673af83ad85e6dfb63da4db41d83afb8#diff-4bae2c37c513c915c0528134abd47edff2a52833806777feb088b6d09990a74e

@git-hulk should we sample at most 60 keys in spop?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM538Vs9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5380TQ,kvrocks,2012431568,2144,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-21T14:22:15Z,2024-03-21T14:22:15Z,"@mapleFU For Kvrocks, I feel good to only randomize part of them if there're too many keys.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5380TQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2144,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ua9bK,kvrocks,2490095306,2144,NA,sergerus,6523253,Sergei Makarov,sergerus@gmail.com,NA,2024-11-21T05:12:24Z,2024-11-21T05:12:24Z,Why do we still need a randomness guarantee for this?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ua9bK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2149,https://api.github.com/repos/apache/kvrocks/issues/2149,kvrocks,2177649400,2149,kvrocks2redis test scripts fail,Zakelly,2986149,Zakelly,zakelly.lan@gmail.com,CLOSED,2024-03-10T10:40:27Z,2024-03-12T15:28:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

MacOSX 13.5
unstable commit id: 19d7bad87c0b147c96d94b79c1b1ed1e0d894e38

### Minimal reproduce step

1. Build
2. Start kvrocks via `./build/kvrocks -c kvrocks.conf`
3. Start redis-server
4. Start kvrocks2redis via `./build/kvrocks2redis -c utils/kvrocks2redis/kvrocks2redis.conf`
5. Install dependency:
    `pip install git+https://github.com/andymccurdy/redis-py.git@2.10.3`
6. Run test via `cd utils/kvrocks2redis/tests && python3 ./populate-kvrocks.py --password="""" --flushdb=true`


### What did you expect to see?

All case passed I guess?

### What did you see instead?

```
FAIL ('set', 'foo', 1):'OK' != True
FAIL ('setex', 'foo_ex', 3600, 1):'OK' != True
******* Some case test fail *******
string
FAIL ('set', 'foo', 2):'OK' != True
FAIL ('set', 'foo2', 2):'OK' != True
FAIL ('setex', 'foo_ex', 7200, 2):'OK' != True
FAIL ('lset', 'lfoo', 0, 'a'):'OK' != 1
EXCP unsupported operand type(s) for |: 'str' and 'bool'
******* Some case test fail *******
string
list
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2149/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2149,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52cfZ3,kvrocks,1987180151,2149,NA,Zakelly,2986149,Zakelly,zakelly.lan@gmail.com,NA,2024-03-10T10:41:32Z,2024-03-10T10:41:32Z,I guess the return value `OK` should also be treat as passed.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52cfZ3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2149,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ejn3,kvrocks,1987721719,2149,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-11T06:36:25Z,2024-03-11T06:36:25Z,"Thank you! @Zakelly 
It seems like some commands return value has some wrong.
https://github.com/apache/kvrocks/blob/574d438b9acde7b45b0666564af4450c057aceea/utils/kvrocks2redis/tests/populate-kvrocks.py#L61 
It may ""OK"" not True.

These codes were introduced in #1963.

Is it possible that the issue is due to different versions of Python Redis client?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ejn3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2149,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52e0rZ,kvrocks,1987791577,2149,NA,Zakelly,2986149,Zakelly,zakelly.lan@gmail.com,NA,2024-03-11T07:38:47Z,2024-03-11T07:38:47Z,"@jihuayu 
My redis-cli and redis-server version are both `7.2.4`, when I run `setex` command in redis-cli, it returns:
```
127.0.0.1:6379> setex foo_ex 7200 2
OK
```
Redis python module version:
```
pip3 show redis   
Name: redis
Version: 2.10.3
Summary: Python client for Redis key-value store
Home-page: http://github.com/andymccurdy/redis-py
Author: Andy McCurdy
Author-email: sedrik@gmail.com
License: MIT
Location: /Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages
Requires: 
Required-by: 
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52e0rZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2149,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gYLh,kvrocks,1988199137,2149,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-11T11:16:06Z,2024-03-11T11:16:06Z,"@Zakelly 
Thank you for discovering this issue. The test for kvrocks2redis has not been run in CI, which may be a hidden bug.

After the fix it, do you want to add this test to our CI? refer: https://github.com/apache/kvrocks/issues/1976","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52gYLh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2149,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ge5k,kvrocks,1988226660,2149,NA,Zakelly,2986149,Zakelly,zakelly.lan@gmail.com,NA,2024-03-11T11:29:19Z,2024-03-11T11:29:19Z,"@jihuayu Yes I'd like to. Please assign to me, Thanks","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ge5k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2149,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ts4y,kvrocks,1991691826,2149,NA,Zakelly,2986149,Zakelly,zakelly.lan@gmail.com,NA,2024-03-12T13:46:31Z,2024-03-12T13:46:31Z,"It seems the README is providing the wrong `redis-py` version. When I changed to 5.0.3, the problem solved.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52ts4y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2154,https://api.github.com/repos/apache/kvrocks/issues/2154,kvrocks,2178441916,2154,Go test in macos-14 (M1) runner failed,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,CLOSED,2024-03-11T07:40:37Z,2024-03-11T13:23:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

https://github.com/apache/kvrocks/pull/2152

### Minimal reproduce step

run action

### What did you expect to see?

go test passed

### What did you see instead?

go test failed

### Anything Else?

This blocked PR #2152 
This issue can be consistently reproduced. You can see the log [this](https://github.com/apache/kvrocks/actions/runs/8228844893/job/22499326752?pr=2152#step:15:137)

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2154/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2156,https://api.github.com/repos/apache/kvrocks/issues/2156,kvrocks,2179300875,2156,PubSub with Lettuce not working as expected,asad-awadia,6923282,Asad Awadia,,CLOSED,2024-03-11T14:37:44Z,2024-03-13T05:10:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

KVRocks version 2.8.0 and nightly

### Minimal reproduce step

Clone : https://gitlab.com/asad-awadia/kotlin-server-app - if a project/environment is required

```
fun main() {
  val redisClient = RedisClient.create(RedisURI.builder().withHost(""0.0.0.0"").withPort(6666).build())
  val pubSub = redisClient.connectPubSub()
  pubSub.addListener { println(""received push message ${it.content}"") }
  pubSub.sync().subscribe(""channel"")
  redisClient.connect().sync().publish(""channel"", ""foo"")
  Thread.sleep(5000)
}
```

### What did you expect to see?

The message callback listener is invoked with the message [foo] sent in the publish call

### What did you see instead?

No message is received - the listener callback is not invoked

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2156/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2156,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52iNqQ,kvrocks,1988680336,2156,NA,asad-awadia,6923282,Asad Awadia,,NA,2024-03-11T15:13:56Z,2024-03-11T15:13:56Z,"are you referring to the publish call? or the subscribe call?

https://github.com/redis/redis/blob/7.2.2/src/pubsub.c#L147 - seems to do the same","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52iNqQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2156,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52iWbI,kvrocks,1988716232,2156,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-11T15:28:41Z,2024-03-11T15:28:41Z,"Thanks for your correction. It seems related to RESP3 PUSH which is not supported in Kvrocks yet, I will investigate it soon when I get time.

@asad-awadia I think you can use RESP2 instead of RESP3 for now if you have to depend on PubSub.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52iWbI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2156,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52mi2Z,kvrocks,1989815705,2156,NA,asad-awadia,6923282,Asad Awadia,,NA,2024-03-12T02:12:05Z,2024-03-12T02:12:05Z,push doesnt work with resp2 either - just tried it on 2.8.0,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52mi2Z/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2156,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52mkeg,kvrocks,1989822368,2156,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-12T02:14:40Z,2024-03-12T02:14:40Z,"@asad-awadia Yes, Kvrocks doesn't support the PUSH yet, but PubSub works in RESP2 without depending on the PUSH protocol.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52mkeg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2157,https://api.github.com/repos/apache/kvrocks/issues/2157,kvrocks,2180973085,2157,PubSub publish behaves differently with Redis in cluster mode,jcy1001,24226340,,,OPEN,2024-03-12T08:05:11Z,2024-03-19T15:10:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks2.7 pubsub测试了发现了个问题，在集群部署模式下 subscribe
后，publish
这个channel一个消息，无法消费到；这个在redis上面没有问题。我用monitor看到的现象是redis和kvrocks，sub和pub的server收到消息的node都是不一样，但kvrocks无法消费到，redis是ok的，

### Minimal reproduce step

kvrocks2.7 pubsub测试了发现了个问题，在集群部署模式下 subscribe
后，publish
这个channel一个消息，无法消费到；这个在redis上面没有问题。我用monitor看到的现象是redis和kvrocks，sub和pub的server收到消息的node都是不一样，但kvrocks无法消费到，redis是ok的，

### What did you expect to see?

the same with redis ,will consume this msg

### What did you see instead?

can consume this msg

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2157/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2157,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52rVrl,kvrocks,1991072485,2157,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-12T08:55:06Z,2024-03-12T08:55:06Z,@jcy1001 Which client you're using?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52rVrl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2157,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52y9As,kvrocks,1993068588,2157,NA,jcy1001,24226340,,,NA,2024-03-13T01:47:36Z,2024-03-13T01:47:36Z,"@git-hulk I found redis7  has this code ，but  kvrocks doesnot  propagatetocluster


/* PUBLISH <channel> <message> */
void publishCommand(client *c) {
    if (server.sentinel_mode) {
        sentinelPublishCommand(c);
        return;
    }

    int receivers = pubsubPublishMessageAndPropagateToCluster(c->argv[1],c->argv[2],0);
    if (!server.cluster_enabled)
        forceCommandPropagation(c,PROPAGATE_REPL);
    addReplyLongLong(c,receivers);
}
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52y9As/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2157,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM521PVb,kvrocks,1993667931,2157,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-13T06:38:27Z,2024-03-13T06:38:27Z,@jcy1001 Thanks for your investigation. So what you mean is PubSub behaves differently with Redis in cluster mode?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM521PVb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2157,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM521cVx,kvrocks,1993721201,2157,NA,jcy1001,24226340,,,NA,2024-03-13T07:26:37Z,2024-03-13T07:26:37Z,"> @jcy1001 Thanks for your investigation. So what you mean is PubSub behaves differently with Redis in cluster mode?

是，在redis集群下面客户端可以收到通知， kvrocks下收不到通知，分析看了是redis集群模式下，有做cluster的扩散，kvrocks只能通知本shard下的客户端","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM521cVx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2157,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM523WS6,kvrocks,1994220730,2157,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-13T12:02:15Z,2024-03-13T12:02:15Z,"@jcy1001 Got your point, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM523WS6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2158,https://api.github.com/repos/apache/kvrocks/issues/2158,kvrocks,2180976779,2158,pubsub  bug,jcy1001,24226340,,,CLOSED,2024-03-12T08:07:25Z,2024-03-12T08:09:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks2.7 pubsub测试了发现了个问题，在集群部署模式下 subscribe
后，publish
这个channel一个消息，无法消费到；这个在redis上面没有问题。我用monitor看到的现象是redis和kvrocks，sub和pub的server收到消息的node都是不一样，但kvrocks无法消费到，redis是ok的，

### Minimal reproduce step

kvrocks2.7 pubsub测试了发现了个问题，在集群部署模式下 subscribe
后，publish
这个channel一个消息，无法消费到；这个在redis上面没有问题。我用monitor看到的现象是redis和kvrocks，sub和pub的server收到消息的node都是不一样，但kvrocks无法消费到，redis是ok的，

### What did you expect to see?

the same with redis ,will consume this msg

### What did you see instead?

can consume this msg

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2158/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2162,https://api.github.com/repos/apache/kvrocks/issues/2162,kvrocks,2183231392,2162,Optimization of Lua Global Locks,i18nsite,145643935,i18n.site,i18n.site@gmail.com,CLOSED,2024-03-13T06:39:51Z,2025-01-28T02:29:14Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Kvrocks 是目前开源磁盘 Redis 里面同时支持 Lua 和事务的选型，同时在命令支持上也是比较完善。为了简化实现复杂度，Lua 和事务相关命令执行时会限制为类似 Redis 的单线程执行。实现方式是在 Lua 和事务相关执行命令加上全局锁，代码如下:

---

我这个感觉其实可以根据redis lua函数的keys来锁定，不需要做全局锁。
为了避免兼容问题，可以加一个配置选项，lua_lock_level = global / keys ，确认可以用键级锁的自己打开

---

redis 规范： https://redis.io/docs/interact/programmability/eval-intro/ 

重要提示：为了确保脚本的正确执行，无论是在独立部署还是集群部署中，脚本访问的所有键名称都必须显式提供作为输入键参数。该脚本应该只访问其名称作为输入参数给出的键。脚本永远不应访问具有以编程方式生成的名称或基于数据库中存储的数据结构内容的密钥。


---



Kvrocks is an open-source disk-based Redis that simultaneously supports Lua scripts and transactions, and is also quite comprehensive in terms of command support. To simplify the complexity of implementation, the execution of Lua scripts and transaction-related commands is restricted to single-threaded execution similar to Redis. The implementation method involves adding a global lock when executing Lua scripts and transaction-related commands.

I think this approach could potentially be modified to lock based on keys rather than a global lock. To avoid compatibility issues, a configuration option could be added, such as lua_lock_level=global / keys, allowing users to enable key-level locking if they confirm it works as expected.

https://redis.io/docs/interact/programmability/eval-intro/ 

Important: to ensure the correct execution of scripts, both in standalone and clustered deployments, all names of keys that a script accesses must be explicitly provided as input key arguments. The script should only access keys whose names are given as input arguments. Scripts should never access keys with programmatically-generated names or based on the contents of data structures stored in the database.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2162/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2162,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM521QW5,kvrocks,1993672121,2162,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-13T06:40:44Z,2024-03-13T06:40:44Z,@i18n-now Thanks for your suggestion.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM521QW5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2162,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53AiW7,kvrocks,1996629435,2162,NA,i18nsite,145643935,i18n.site,i18n.site@gmail.com,NA,2024-03-14T06:44:42Z,2024-03-14T06:44:42Z,"可以参考

https://www.dragonflydb.io/blog/leveraging-power-of-lua-scripting

Leveraging the power of Lua scripting with Dragonfly
利用 Dragonfly 的 Lua 脚本编写能力

This blog post discusses the limitations of Lua scripting in Redis and introduces Dragonfly as a drop-in replacement for Redis. Dragonfly addresses the challenges of long-running scripts and scalability, offering a vertically scalable, multi-threaded, and asynchronous architecture that improves performance and efficiency for Lua scripting in Redis.

这篇博文讨论了 Redis 中 Lua 脚本的局限性，并介绍了 Dragonfly 作为 Redis 的直接替代品。 Dragonfly 解决了长时间运行的脚本和可扩展性的挑战，提供了垂直可扩展、多线程和异步架构，提高了 Redis 中 Lua 脚本的性能和效率。


---

Dragonfly的多线程、异步架构为长时间运行和/或计算量大的脚本提供了更好的性能

Redis 以单线程方式运行，这意味着它一次处理一个操作。当执行长时间运行或计算量大的 Lua 脚本时，这会成为瓶颈，因为它们可能会阻止其他操作直到完成。

另一方面，Dragonfly 是围绕多线程、异步架构构建的。这种方法有几个优点。首先，由于并行处理，它提高了吞吐量。其次，它允许多个脚本执行单元同时运行，这对于计算密集型脚本特别有利，例如那些计算哈希值或聚合值的脚本。

此外，Dragonfly 支持异步性，这意味着只要保留脚本的原子性，常规命令就可以与已运行脚本中的命令混合。这使得 Dragonfly 即使在脚本执行时也可用于传入请求。","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53AiW7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2162,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59GL38,kvrocks,2098773500,2162,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-07T15:46:16Z,2024-05-07T15:46:16Z,"@i18n-now I'm interested in this question, but I don't know much about dragonfly's code at the moment. Do you have any reference materials that can help me quickly understand its overall framework and process?

Currently I found this: https://github.com/dragonflydb/dragonfly/blob/main/docs/transaction.md","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59GL38/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2162,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59GYDt,kvrocks,2098823405,2162,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-07T16:11:35Z,2024-05-07T16:11:35Z,@PokIsemaine You can refer to `Service::EvalInternal` for detail ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59GYDt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2162,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59gZv0,kvrocks,2105646068,2162,NA,i18nsite,145643935,i18n.site,i18n.site@gmail.com,NA,2024-05-11T09:05:22Z,2024-05-11T09:05:22Z,"大多数的 Redis 兼容服务还是采用了轻量锁的方案，这样比较容易做到兼容，Dragonfly 的实现是参考了《VLL: a lock manager redesign for main memory database systems》[[7]](https://zhuanlan.zhihu.com/p/584485562#ref_7)里的 VLL 方案。不过从支持的接口[[8]](https://zhuanlan.zhihu.com/p/584485562#ref_8)列表看，Dragonfly 尚未完全兼容 Redis 的接口。

https://zhuanlan.zhihu.com/p/584485562


为了提供对多键并发操作的原子性保证，我们使用了最近学术研究的进展。我们选择了论文 [""VLL: a lock manager redesign for main memory database systems”](https://www.cs.umd.edu/~abadi/papers/vldbj-vll.pdf) 来开发Dragonfly的事务框架。无共享式架构和VLL的选择使我们能够在不使用互斥锁或自旋锁的情况下组合原子的多键操作。这是我们 PoC 的一个重要里程碑，它的性能在商业和开源解决方案中脱颖而出。

我们面临的第二个挑战是为新存储设计更高效的数据结构。为了实现这个目标，我们基于论文[""Dash: Scalable Hashing on Persistent Memory""](https://arxiv.org/pdf/2003.07302.pdf)构建了核心哈希表结构。这篇论文本身是以持久性内存为中心的，与主存没有直接相关性。
https://github.com/dragonflydb/dragonfly/blob/main/README.zh-CN.md","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59gZv0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2162,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_FFdN,kvrocks,2132039501,2162,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-26T02:52:27Z,2024-05-26T02:52:27Z,"> 之前有提到过 Redis 的事务隔离级别是 Serializable（序列化），那么想做到完全的兼容就必须保持一致。内存数据库和传统基于磁盘的数据库在体系结构上有很大的区别。内存事务不会涉及到 IO 操作，性能瓶颈就从磁盘转移到了 CPU 上。比较成熟的并发协议有：轻量锁、时间戳、多版本、串行等方式。大多数的 Redis 兼容服务还是采用了轻量锁的方案，这样比较容易做到兼容，Dragonfly 的实现是参考了《VLL: a lock manager redesign for main memory database systems》[[7]](https://zhuanlan.zhihu.com/p/584485562#ref_7)里的 VLL 方案。不过从支持的接口[[8]](https://zhuanlan.zhihu.com/p/584485562#ref_8)列表看，Dragonfly 尚未完全兼容 Redis 的接口。

* kvrocks 现在使用了 `src/common/lock_manager.h` 中的 `LockManager`，这个现在是瓶颈所在吗？因为 kvrocks 并不是 in memory database，我们是否有必要重新设计一个轻量级锁方案？

* 同时我看到参考文献里提到并发引擎的 HashMap 应该支持 「渐进式 rehash」以及「并发修改过程中的无状态扫描」，这两点 kvrocks 现在是支持的吗？或者有必要支持吗？


> It was mentioned before that the transaction isolation level of Redis is Serializable (serialization), so it must be consistent if you want to be fully compatible. There is a big architectural difference between in-memory databases and traditional disk-based databases. Memory transactions do not involve IO operations, and the performance bottleneck is transferred from the disk to the CPU. More mature concurrency protocols include: lightweight locks, timestamps, multi-versions, serialization, etc. Most Redis compatible services still use lightweight lock solutions, which are easier to achieve compatibility. The implementation of Dragonfly refers to ""VLL: a lock manager redesign for main memory database systems"" [[7]](https://zhuanlan.zhihu.com/p/584485562#ref_7) VLL solution. However, judging from the list of supported interfaces [[8]](https://zhuanlan.zhihu.com/p/584485562#ref_8), Dragonfly is not yet fully compatible with the Redis interface.

* kvrocks now uses the `LockManager` in `src/common/lock_manager.h`. Is this the bottleneck now? Because kvrocks is not in memory database, is it necessary for us to redesign a lightweight lock scheme？

* At the same time, I saw in the reference article that the HashMap of the concurrent engine should support ""progressive rehash"" and ""stateless scanning during concurrent modifications."" Are these two points supported by kvrocks now? Or is support necessary?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_FFdN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2163,https://api.github.com/repos/apache/kvrocks/issues/2163,kvrocks,2183302531,2163,can kvrocks have a winows sln to comiple in wondows server？,jcy1001,24226340,,,CLOSED,2024-03-13T07:30:50Z,2024-03-13T12:21:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

  kvrocks   comiple in wondows server 

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2163/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2165,https://api.github.com/repos/apache/kvrocks/issues/2165,kvrocks,2183497893,2165,Add option to disable incremental sync in kvrocks2redis,QQxiaoyuyu,34185590,,,OPEN,2024-03-13T09:23:15Z,2024-04-24T13:38:00Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.8

### Minimal reproduce step

 Looking downwards

### What did you expect to see?

 Looking downwards

### What did you see instead?

 Looking downwards

### Anything Else?

Currently, `kvrocks2redis` will synchronize incremental data by default, but if the increment is too large, many data files will be written, we can consider adding a configuration that does not write incremental data, and only does full synchronization.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2165/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2165,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55wBpI,kvrocks,2042632776,2165,NA,zjregee,89204657,,zjregee@gmail.com,NA,2024-04-08T12:34:38Z,2024-04-08T12:34:38Z,I'd like to try this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55wBpI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2165,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55wEOS,kvrocks,2042643346,2165,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-08T12:39:24Z,2024-04-08T12:39:24Z,@zjregee Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55wEOS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2165,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57e7f5,kvrocks,2071705593,2165,NA,zjregee,89204657,,zjregee@gmail.com,NA,2024-04-23T08:20:19Z,2024-04-23T08:20:19Z,"Hello, @git-hulk. I'm running into some issues while trying to resolve this issue and hope to get your advice.

kvrocks2redis currently updates the data into a new Redis step by step by writing an aof file for all the data in the kvrocks, which is not reasonable when the kvrocks contains a large amount of data. In order to solve this problem, we can first create an rdb file, synchronize a large amount of data at once through the rdb file, and continue to synchronize some unsynchronized data through the original incremental synchronization method.

But I have doubts about how to pass the rdb file to the new Redis. Redis does not seem to support receiving rdb file directly through a certain command. If the new Redis is synchronized through `slaveof`, this new master-slave relationship does not seem to meet this requirement.

How should I solve this problem? In order for the Redis to receive the rdb file, I seem to need to send the rdb file to the data directory related to the new Redis and restart the Redis. I am not sure if this method is reasonable.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57e7f5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2165,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57rZiO,kvrocks,2074974350,2165,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-24T13:37:58Z,2024-04-24T13:37:58Z,"@zjregee Sorry for not getting back to you sooner.

> How should I solve this problem? In order for the Redis to receive the rdb file, I seem to need to send the rdb file to the data directory related to the new Redis and restart the Redis. I am not sure if this method is reasonable.

Redis only supports loading the RDB from the replication for now, and it should be not good to require users to restart the Redis server for syncing the RDB.


> kvrocks2redis currently updates the data into a new Redis step by step by writing an aof file for all the data in the kvrocks, which is not reasonable when the kvrocks contains a large amount of data. 

For this scenario, perhaps we can send the key value to the target node directly instead of writing AOF.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57rZiO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2166,https://api.github.com/repos/apache/kvrocks/issues/2166,kvrocks,2185310029,2166,Add support of the command READONLY & READWRITE,singular-seal,108578006,,,CLOSED,2024-03-14T03:35:12Z,2024-03-17T13:54:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

1. redis cluster utilize [readonly](https://redis.io/commands/readonly/) to support reading from slave node
2. go-redis will send a 'readonly' command to server when 'ReadOnly' option is true during initialisation which would incur an error response from kvrocks 'ERR unknown command readonly' because kvrocks doesn't support command 'readonly'
3. this is important because without reading from slave a shard  is not readable during failover which is not acceptable for some businesses

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2166/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2166,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52_aSv,kvrocks,1996334255,2166,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-14T03:39:46Z,2024-03-14T03:39:46Z,@singular-seal Thanks for your feedback.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM52_aSv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2166,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53KdlG,kvrocks,1999231302,2166,NA,LiuYuHui,13926137,Yuhui Liu,,NA,2024-03-15T09:12:16Z,2024-03-15T09:12:16Z,"Hi @git-hulk, I want to help implement this feature, could you give me some suggestions on where to start? thanks a lot!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53KdlG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2166,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53KeU4,kvrocks,1999234360,2166,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-15T09:14:00Z,2024-03-15T09:14:00Z,@LiuYuHui Thank you! Go ahead.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53KeU4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2166,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53LUfc,kvrocks,1999456220,2166,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-15T11:24:58Z,2024-03-15T11:24:58Z,"Hi @LiuYuHui.
You can add a flag in `redis::Connection` to store if this connection enables read queries.
You can add new commands in [cmd_server.cc](https://github.com/apache/kvrocks/blob/unstable/src/commands/cmd_server.cc)

The following code may be the code you need to modify.
- https://github.com/apache/kvrocks/blob/unstable/src/cluster/cluster.cc#L804-L807

If you have any other questions, feel free to ask me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53LUfc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2167,https://api.github.com/repos/apache/kvrocks/issues/2167,kvrocks,2185769415,2167,kvrocks2redis migrate kvrocks to kvrocks-cluster,QQxiaoyuyu,34185590,,,CLOSED,2024-03-14T08:46:07Z,2024-03-14T08:54:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I want to migrate data from kvrocks to kvrocks-cluster,but currently kvrocks2redis only support to single kvrocks

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2167/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2168,https://api.github.com/repos/apache/kvrocks/issues/2168,kvrocks,2186009556,2168,Add support of the command ASKING,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-03-14T10:35:56Z,2024-04-28T09:03:53Z,,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2168/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2168,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53M_re,kvrocks,1999895262,2168,NA,MaheshMadushan,58337761,Mahesh Jayawardhana,,NA,2024-03-15T15:21:10Z,2024-03-15T15:21:10Z,Hello. Shall i try this if this is available?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53M_re/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2168,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53NYGI,kvrocks,1999995272,2168,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-15T16:14:01Z,2024-03-15T16:14:01Z,"@MaheshMadushan assigned, thank you 😊 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53NYGI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2168,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55Gh_X,kvrocks,2031755223,2168,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-02T11:25:19Z,2024-04-02T11:25:19Z,"@MaheshMadushan Are you working on this issue? If not, I will take over this task.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55Gh_X/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2168,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55G3Aa,kvrocks,2031841306,2168,NA,MaheshMadushan,58337761,Mahesh Jayawardhana,,NA,2024-04-02T11:53:09Z,2024-04-02T11:53:09Z,"> @MaheshMadushan Are you working on this issue? If not, I will take over this task.

I may not be able to work on this. please continue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55G3Aa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2168,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55G5SY,kvrocks,2031850648,2168,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-02T11:57:39Z,2024-04-02T11:57:39Z,@MaheshMadushan Thanks for your feedback.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55G5SY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2168,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57Pf3Q,kvrocks,2067660240,2168,NA,jjz921024,19649281,anotherJJz,470623352@qq.com,NA,2024-04-20T12:34:49Z,2024-04-20T12:34:49Z,"@git-hulk Hi, Shall i try this if this is available?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57Pf3Q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2168,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57PhGh,kvrocks,2067665313,2168,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-20T12:56:05Z,2024-04-20T12:56:05Z,"@jjz921024 Sure, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57PhGh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2172,https://api.github.com/repos/apache/kvrocks/issues/2172,kvrocks,2188705119,2172,Introducing Get Metadata with rocksdb::Snapshot,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2024-03-15T14:44:56Z,2024-03-19T10:58:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, kvrocks' `GetMetadata` is implemented in `storage`, and don't work with snapshot. So, when we want some consistency syntax, the key-locking might be introduced.

And as part of https://github.com/apache/kvrocks/issues/2144 . I think a Snapshot based GetMetadata would be better.

### Solution

Adding a snapshot based getmetadata

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2172/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2172,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53nfud,kvrocks,2006842269,2172,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-19T10:58:50Z,2024-03-19T10:58:50Z,This is fixed by #2174 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53nfud/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2176,https://api.github.com/repos/apache/kvrocks/issues/2176,kvrocks,2191481109,2176,JSON.SET cant add a new field,superikw,30033991,,,CLOSED,2024-03-18T08:00:27Z,2024-03-18T12:09:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.7.0 & 2.8.0

### Minimal reproduce step

redis> JSON.SET doc $ '{""a"":2}'
OK
redis> JSON.SET doc $.b '8'
OK
redis> JSON.GET doc $
""[{\""a\"":2}]""

### What did you expect to see?

""[{\""a\"":2,\""b\"":8}]"" 

### What did you see instead?

""[{\""a\"":2}]""

### Anything Else?

Example comes from https://redis.io/commands/json.set/

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2176/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2176,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53ZrAS,kvrocks,2003218450,2176,NA,PragmaTwice,20042607,Twice,,NA,2024-03-18T08:46:48Z,2024-03-18T08:46:48Z,"Yeah it is an known issue. Currently Kvrocks doesn't support set value for a nonexistant path.

Current a workaround is to retrieve the full object and then set the field.

I'll try to fix it soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53ZrAS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2176,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53aT8C,kvrocks,2003386114,2176,NA,PragmaTwice,20042607,Twice,,NA,2024-03-18T09:53:44Z,2024-03-18T09:53:44Z,"It will be fixed in https://github.com/apache/kvrocks/pull/2178.

Although it's not a perfect fix since we're waiting for support in the underlying library jsoncons, it can work for most scenarios.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53aT8C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2176,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53brXx,kvrocks,2003744241,2176,NA,superikw,30033991,,,NA,2024-03-18T12:09:18Z,2024-03-18T12:09:18Z,Thanks for your work :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53brXx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2177,https://api.github.com/repos/apache/kvrocks/issues/2177,kvrocks,2191681009,2177,kvrocks2redis can't sync flush commands ,iushas,7236171,tanic.xiao,,OPEN,2024-03-18T09:33:42Z,2024-05-23T03:20:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable 70fac378e9f966f8209c5195cdd2aaa214a87a0e Fri Feb

### Minimal reproduce step

![image](https://github.com/apache/kvrocks/assets/7236171/a65da916-90ea-42d3-ae74-e57a652f887c)

master -> slave -> kvrocks2redis -> target

1、master flush
2、aof only write one del command


### What did you expect to see?

write flushcommand to aof file

### What did you see instead?

aof only write one del command

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2177/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2177,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53aHzp,kvrocks,2003336425,2177,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-18T09:36:03Z,2024-03-18T09:36:03Z,"@iushas Thanks for your report, will take a look soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53aHzp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2177,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53aQkN,kvrocks,2003372301,2177,NA,iushas,7236171,tanic.xiao,,NA,2024-03-18T09:49:14Z,2024-03-18T09:49:14Z,"> @iushas Thanks for your report, will take a look soon.

![image](https://github.com/apache/kvrocks/assets/7236171/429181e3-9054-4205-8163-ae2d0da4c75b)
if put kvrocks2redis with master node ，result is In line with expectations ，all namespace aof file generate one flushdb command","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53aQkN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2177,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53aftj,kvrocks,2003434339,2177,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-18T10:06:54Z,2024-03-18T10:06:54Z,"Got your point, that said this issue only happened while syncing from the replica node and works well in the master node.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53aftj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2177,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53ah6w,kvrocks,2003443376,2177,NA,iushas,7236171,tanic.xiao,,NA,2024-03-18T10:09:14Z,2024-03-18T10:09:14Z,"> Got your point, that said this issue only happened while syncing from the replica node and works well in the master node.

yes, Not sure if there are any other commands that would have this problem","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53ah6w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2177,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53cDRP,kvrocks,2003842127,2177,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-18T12:58:18Z,2024-03-18T12:58:18Z,"> > Got your point, that said this issue only happened while syncing from the replica node and works well in the master node.
> 
> yes, Not sure if there are any other commands that would have this problem

It's caused by the rocksdb's DeleteRange API which we didn't implement the batch extractor. And for parsing from the master node should have the same issue, guess the `FLUSHDB` you seen is the kvrocks2redis will send the FLUSHDB command first before parsing the full DB.

AFAIK, the DeleteRange API is only used in FLUSHDB/FLUSHALL command, so it should only affect those two.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53cDRP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2177,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-upCZ,kvrocks,2126155929,2177,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-23T03:18:23Z,2024-05-23T03:18:23Z,"MULTI/EXEC has the same problem
```
127.0.0.1:6666> MULTI
OK
127.0.0.1:6666> SET key 123
QUEUED
127.0.0.1:6666> FLUSHDB
QUEUED
127.0.0.1:6666> EXEC
1) OK
2) (error) ERR Not implemented: DeleteRange unsupported in WriteBatchWithIndex
```

ERR Not implemented: DeleteRange unsupported in WriteBatchWithIndex
rocksdb ref: https://github.com/facebook/rocksdb/blob/c72ee4531b288bf08b9414155fafb86cc4378fb4/include/rocksdb/utilities/write_batch_with_index.h#L165","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-upCZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2179,https://api.github.com/repos/apache/kvrocks/issues/2179,kvrocks,2191742464,2179,The slave of the kvrocks cluster failed to synchronize data from the master,QQxiaoyuyu,34185590,,,CLOSED,2024-03-18T09:56:54Z,2024-03-19T05:54:14Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks 2.8 ，kvrocks-controller unstable，kvrocks编译是采用了-DPORTABLE=1

### Minimal reproduce step

在运行了kvcontroller的情况下，使用api创建集群 /api/v1/namespaces/test-ns/clusters 

{
  ""name"":""demo-kvcluster"",
  ""nodes"":[""192.168.1.189:16660"",""192.168.1.189:16661"",""192.168.1.175:16662"",""192.168.1.175:16663"",""192.168.1.51:16664"",""192.168.1.51:16665""],
  ""replicas"":2,
  ""password"":""xxx#$()D-""
}

### What did you expect to see?

在master节点上面set ld  1111111111111111，在slave上面可以get到

### What did you see instead?

![image](https://github.com/apache/kvrocks/assets/34185590/8df485cd-d691-4605-a0c8-73f708ea7f46)
slave上未能get 到 ld

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2179/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2179,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53c3tR,kvrocks,2004056913,2179,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-18T14:23:23Z,2024-03-18T14:23:23Z,@QQxiaoyuyu Could you provide the `nodes.conf` of `192.168.1.175:16663`?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53c3tR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2179,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53iwQu,kvrocks,2005599278,2179,NA,QQxiaoyuyu,34185590,,,NA,2024-03-19T01:54:33Z,2024-03-19T01:54:33Z,"![image](https://github.com/apache/kvrocks/assets/34185590/38b62f6a-a8cd-4bbc-88c1-6c88eb0437de)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53iwQu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2179,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53jpkQ,kvrocks,2005834000,2179,NA,QQxiaoyuyu,34185590,,,NA,2024-03-19T05:53:37Z,2024-03-19T05:53:37Z,"The reson is master-use-repl-port = yes, cluster must config no ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53jpkQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2181,https://api.github.com/repos/apache/kvrocks/issues/2181,kvrocks,2194884655,2181,Add support of the XAUTOCLAIM command,Yangsx-1,85615957,Hauru,,CLOSED,2024-03-19T12:49:22Z,2024-06-27T10:41:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue wants to implement [XAUTOCLAIM](https://redis.io/commands/xautoclaim/) command like redis.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2181/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2181,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53tKpi,kvrocks,2008328802,2181,NA,nioshield,9985749,nio,,NA,2024-03-19T23:17:57Z,2024-03-19T23:17:57Z,"@Yangsx-1 I'm interested in implementing this command, can you please assign it to me? Thank you!

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53tKpi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2181,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53twX7,kvrocks,2008483323,2181,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-03-20T01:10:34Z,2024-03-20T01:10:34Z,@nioshield It's been assigned to you. Welcome to participate in it again :),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM53twX7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2181,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-plIh,kvrocks,2124829217,2181,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-05-22T13:40:15Z,2024-05-22T13:40:15Z,"Hi @Yangsx-1 ,

  This thread seems to be inactivated for two months.

  I'm new to kvrocks and want to make some contributions.

  Can this issue be assigned to me? 

Thanks very much.
  ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-plIh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2181,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-pnfC,kvrocks,2124838850,2181,NA,Yangsx-1,85615957,Hauru,,NA,2024-05-22T13:44:34Z,2024-05-22T13:44:34Z,"> Hi @Yangsx-1 ,
> 
> This thread seems to be inactivated for two months.
> 
> I'm new to kvrocks and want to make some contributions.
> 
> Can this issue be assigned to me?
> 
> Thanks very much.

Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-pnfC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2185,https://api.github.com/repos/apache/kvrocks/issues/2185,kvrocks,2197316963,2185,Add support of the command CLUSTER RESET,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-03-20T11:36:52Z,2024-04-01T03:55:38Z,"Like the Redis [CLUSTER SET](https://redis.io/commands/cluster-reset/) command, we would like to reset the Kvrocks cluster via redis-cli.

To be noticed, Redis required the master node not to contain any keys before executing the CLUSTER SET command. For Kvrocks, we don't have the living counter for the key number, but we can use the rocksdb seek API to check if any keys exist.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2185/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2188,https://api.github.com/repos/apache/kvrocks/issues/2188,kvrocks,2199068780,2188,CLUSTERX SETNODES - ERR Slot is out of range,hcymysql,19261879,贺春旸,chunyang_he@139.com,CLOSED,2024-03-21T04:02:27Z,2024-03-22T14:02:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks-2.8.0.tar.gz

### Minimal reproduce step

```
# redis-cli -h 127.0.0.1 -p 7001 -a 123456
Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.
127.0.0.1:7001> CLUSTERX SETNODES ""kvrockskvrockskvrockskvrockskvrocksnode1 127.0.0.1 7001 master - 0-5460 kvrockskvrocks
kvrockskvrockskvrocksnode2 127.0.0.1 7002 slave  \n kvrockskvrockskvrockskvrockskvrocksnode3 127.0.0.1 7003 master - 5461-10992 kvrockskvrockskvrockskvrockskvrocksnode4 127.0.0.1 7004 slave  \n kvrockskvrockskvrockskvrockskvrocksnode5 127.0.0.1 7005 master - 10993-16383 kvrockskvrockskvrockskvrockskvrocksnode6 127.0.0.1 7006 slave"" 1
(error) ERR Slot is out of range
127.0.0.1:7001> 
```

### What did you expect to see?

```
# redis-cli -h 127.0.0.1 -p 7001 -a 123456
Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.
127.0.0.1:7001> CLUSTERX SETNODES ""kvrockskvrockskvrockskvrockskvrocksnode1 127.0.0.1 7001 master - 0-5460 kvrockskvrocks
kvrockskvrockskvrocksnode2 127.0.0.1 7002 slave  \n kvrockskvrockskvrockskvrockskvrocksnode3 127.0.0.1 7003 master - 5461-10992 kvrockskvrockskvrockskvrockskvrocksnode4 127.0.0.1 7004 slave  \n kvrockskvrockskvrockskvrockskvrocksnode5 127.0.0.1 7005 master - 10993-16383 kvrockskvrockskvrockskvrockskvrocksnode6 127.0.0.1 7006 slave"" 1
(error) ERR Slot is out of range
127.0.0.1:7001> 
```

### What did you see instead?

```
# redis-cli -h 127.0.0.1 -p 7001 -a 123456
Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.
127.0.0.1:7001> CLUSTERX SETNODES ""kvrockskvrockskvrockskvrockskvrocksnode1 127.0.0.1 7001 master - 0-5460 kvrockskvrocks
kvrockskvrockskvrocksnode2 127.0.0.1 7002 slave  \n kvrockskvrockskvrockskvrockskvrocksnode3 127.0.0.1 7003 master - 5461-10992 kvrockskvrockskvrockskvrockskvrocksnode4 127.0.0.1 7004 slave  \n kvrockskvrockskvrockskvrockskvrocksnode5 127.0.0.1 7005 master - 10993-16383 kvrockskvrockskvrockskvrockskvrocksnode6 127.0.0.1 7006 slave"" 1
(error) ERR Slot is out of range
127.0.0.1:7001> 
```

### Anything Else?

```
# redis-cli -h 127.0.0.1 -p 7001 -a 123456
Warning: Using a password with '-a' or '-u' option on the command line interface may not be safe.
127.0.0.1:7001> CLUSTERX SETNODES ""kvrockskvrockskvrockskvrockskvrocksnode1 127.0.0.1 7001 master - 0-5460 kvrockskvrocks
kvrockskvrockskvrocksnode2 127.0.0.1 7002 slave  \n kvrockskvrockskvrockskvrockskvrocksnode3 127.0.0.1 7003 master - 5461-10992 kvrockskvrockskvrockskvrockskvrocksnode4 127.0.0.1 7004 slave  \n kvrockskvrockskvrockskvrockskvrocksnode5 127.0.0.1 7005 master - 10993-16383 kvrockskvrockskvrockskvrockskvrocksnode6 127.0.0.1 7006 slave"" 1
(error) ERR Slot is out of range
127.0.0.1:7001> 
127.0.0.1:7001> CLUSTERX SETNODES ""kvrockskvrockskvrockskvrockskvrocksnode1 127.0.0.1 7001 master - 0-5460 kvrockskvrocks
kvrockskvrockskvrocksnode2 127.0.0.1 7002 slave - kvrockskvrockskvrockskvrockskvrocksnode1  \n kvrockskvrockskvrockskvrockskvrocksnode3 127.0.0.1 7003 master - 5461-10992 kvrockskvrockskvrockskvrockskvrocksnode4 127.0.0.1 7004 slave - kvrockskvrockskvrockskvrockskvrocksnode3  \n kvrockskvrockskvrockskvrockskvrocksnode5 127.0.0.1 7005 master - 10993-16383 kvrockskvrockskvrockskvrockskvrocksnode6 127.0.0.1 7006 slave - kvrockskvrockskvrockskvrockskvrocksnode5 "" 1
(error) ERR Slot is out of range

```

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2188/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2188,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM534Epv,kvrocks,2011187823,2188,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-21T04:15:53Z,2024-03-21T04:15:53Z,"@hcymysql Thanks for your report. The right format should be:

```
redis-cli> CLUSTER SETNODES ""kvrockskvrockskvrockskvrockskvrocksnode1 127.0.0.1 7001 master -  0-5460 \n kvrockskvrockskvrockskvrockskvrocksnode2 127.0.0.1 7002 slave kvrockskvrockskvrockskvrockskvrocksnode1 \n kvrockskvrockskvrockskvrockskvrocksnode3 127.0.0.1 7003 master -  5461-10992 \n kvrockskvrockskvrockskvrockskvrocksnode4 127.0.0.1 7004 slave kvrockskvrockskvrockskvrockskvrocksnode3 \n kvrockskvrockskvrockskvrockskvrocksnode5 127.0.0.1 7005 master -  10993-16383 \n kvrockskvrockskvrockskvrockskvrocksnode6 127.0.0.1 7006 slave kvrockskvrockskvrockskvrockskvrocksnode5"" 1
```

you can also use the [create-cluster](https://github.com/apache/kvrocks/tree/unstable/utils/create-cluster) shell to quick setup a test cluster.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM534Epv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2188,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM534FWO,kvrocks,2011190670,2188,NA,hcymysql,19261879,贺春旸,chunyang_he@139.com,NA,2024-03-21T04:20:05Z,2024-03-21T04:20:05Z,"> @hcymysql Thanks for your report. The right format should be:
> 
> ```
> redis-cli> CLUSTER SETNODES ""kvrockskvrockskvrockskvrockskvrocksnode1 127.0.0.1 7001 master -  0-5460 \n kvrockskvrockskvrockskvrockskvrocksnode2 127.0.0.1 7002 slave kvrockskvrockskvrockskvrockskvrocksnode1 \n kvrockskvrockskvrockskvrockskvrocksnode3 127.0.0.1 7003 master -  5461-10992 \n kvrockskvrockskvrockskvrockskvrocksnode4 127.0.0.1 7004 slave kvrockskvrockskvrockskvrockskvrocksnode3 \n kvrockskvrockskvrockskvrockskvrocksnode5 127.0.0.1 7005 master -  10993-16383 \n kvrockskvrockskvrockskvrockskvrocksnode6 127.0.0.1 7006 slave kvrockskvrockskvrockskvrockskvrocksnode5"" 1
> ```
> 
> you can also use the [create-cluster](https://github.com/apache/kvrocks/tree/unstable/utils/create-cluster) shell to quick setup a test cluser.

Thank you very much!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM534FWO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2191,https://api.github.com/repos/apache/kvrocks/issues/2191,kvrocks,2201619285,2191,KVRocks cluster does not support failover.,hcymysql,19261879,贺春旸,chunyang_he@139.com,CLOSED,2024-03-22T03:24:51Z,2024-03-22T14:02:40Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks-2.8.0.tar.gz

### Minimal reproduce step

I found that the KVRocks cluster cannot achieve the cluster failover functionality of Redis cluster. I shut down a master node, but it could not fail over to a slave node.

### What did you expect to see?

I found that the KVRocks cluster cannot achieve the cluster failover functionality of Redis cluster. I shut down a master node, but it could not fail over to a slave node.

### What did you see instead?

I found that the KVRocks cluster cannot achieve the cluster failover functionality of Redis cluster. I shut down a master node, but it could not fail over to a slave node.

### Anything Else?

I found that the KVRocks cluster cannot achieve the cluster failover functionality of Redis cluster. I shut down a master node, but it could not fail over to a slave node.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2191/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2191,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54D4zU,kvrocks,2014285012,2191,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-22T03:32:22Z,2024-03-22T03:32:22Z,"@hcymysql That's right. The Kvrocks didn't integrate the gossip protocol like the Redis cluster, and it maintains the cluster topology in outside components to simplify the internal design. The community is building the [controller](https://github.com/apache/kvrocks-controller) to manage the Kvrocks cluster, the controller will offer the Web UI and failover/slot migration feature. But you can see, it's under developing status and might take some time to make it ready for users.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54D4zU/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2191,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54ETzO,kvrocks,2014395598,2191,NA,hcymysql,19261879,贺春旸,chunyang_he@139.com,NA,2024-03-22T05:41:00Z,2024-03-22T05:41:00Z,thanks,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54ETzO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/2193,kvrocks,2203818847,2193,Reduce the number of write buffers for infrequently used column families,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2024-03-23T10:44:48Z,2024-04-12T13:34:22Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, all column families are shared the same number of write buffers
which is unnecessary for infrequently used column families including `pubsub`,
`propagte`, and `zset_score`. We can keep them to a const value like 1 to reduce
the memory usage in some scenarios.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2193/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MbFT,kvrocks,2016522579,2193,NA,LiuYuHui,13926137,Yuhui Liu,,NA,2024-03-23T15:17:55Z,2024-03-23T15:17:55Z,"Please assign it to me, thanks a lot :D","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MbFT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MbQA,kvrocks,2016523264,2193,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-23T15:20:44Z,2024-03-23T15:20:44Z,@LiuYuHui Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MbQA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM551tas,kvrocks,2044122796,2193,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-09T04:20:53Z,2024-04-09T04:20:53Z,Hi @LiuYuHui Are you still working on this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM551tas/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM556nwo,kvrocks,2045410344,2193,NA,LiuYuHui,13926137,Yuhui Liu,,NA,2024-04-09T15:03:58Z,2024-04-09T15:03:58Z,"Hi @git-hulk, I have had no extra time bandwidth recently, please feel free to assign it to other people.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM556nwo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56CnHz,kvrocks,2047504883,2193,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-10T13:10:02Z,2024-04-10T13:10:02Z,@LiuYuHui Thanks for your quick response. Welcome back while you get time.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56CnHz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56EJCA,kvrocks,2047905920,2193,NA,jjz921024,19649281,anotherJJz,470623352@qq.com,NA,2024-04-10T15:48:08Z,2024-04-10T15:48:08Z,"Hi @git-hulk , May i question? How do we implement this feature? 

1. For each column family add a config, specifying its number of write buffers. eg: `pubsub.max_write_buffer_number`、`propagte.max_write_buffer_number`、`zset_score.max_write_buffer_number` ...
2. Add a `lite` mode config, When this config is set to `true`, create a new `lite_table_opts` for infrequently used column families. like:

```java
rocksdb::BlockBasedTableOptions lite_table_opts = InitTableOptions();
rocksdb::ColumnFamilyOptions lite_opts(subkey_opts);
lite_opts.write_buffer_size = 32 * MiB;
lite_opts.max_write_buffer_number = 0;

// replace subkey_opts with lite_opts 
column_families.emplace_back(kZSetScoreColumnFamilyName, lite_opts);
column_families.emplace_back(kPubSubColumnFamilyName, lite_opts);
column_families.emplace_back(kPropagateColumnFamilyName, lite_opts);
column_families.emplace_back(kStreamColumnFamilyName, lite_opts);```

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56EJCA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56Hqxy,kvrocks,2048830578,2193,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-11T02:33:27Z,2024-04-11T02:33:27Z,"@jjz921024 Yes, I'm good with this implementation. Would you like to submit a PR?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56Hqxy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56SvSs,kvrocks,2051732652,2193,NA,jjz921024,19649281,anotherJJz,470623352@qq.com,NA,2024-04-12T13:09:34Z,2024-04-12T13:09:34Z,"Yes, I want to try","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56SvSs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2193,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56S5qu,kvrocks,2051775150,2193,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-12T13:34:22Z,2024-04-12T13:34:22Z,"@jjz921024 Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56S5qu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/2195,kvrocks,2203938046,2195,Memory issue of kvrocks2redis detected by ASan/TSan,Zakelly,2986149,Zakelly,zakelly.lan@gmail.com,OPEN,2024-03-23T15:58:52Z,2024-05-10T07:20:56Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, the Kvrocks2redis CI fails with TSAN/ASAN or in macos env. An example for this: https://github.com/Zakelly/kvrocks/actions/runs/8344973371/job/22838786340
The value mismatch in destination redis server. More investigation is needed.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2195/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MxYv,kvrocks,2016613935,2195,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-23T22:02:09Z,2024-03-23T22:02:09Z,"Thank you @Zakelly ! 
The action log will be deleted by GitHub after some days. Can you download the log file and upload?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54MxYv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54NHOZ,kvrocks,2016703385,2195,NA,Zakelly,2986149,Zakelly,zakelly.lan@gmail.com,NA,2024-03-24T05:51:28Z,2024-03-24T05:51:28Z,"@jihuayu  Sure thing. Log attached. 
[logs_21881009491.zip](https://github.com/apache/kvrocks/files/14734551/logs_21881009491.zip)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54NHOZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57Pji6,kvrocks,2067675322,2195,NA,PragmaTwice,20042607,Twice,,NA,2024-04-20T13:32:06Z,2024-04-20T13:32:06Z,IMHO we should spend some time on investigating this issue and find a solution before next release. cc @git-hulk,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57Pji6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57PkJn,kvrocks,2067677799,2195,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-20T13:40:09Z,2024-04-20T13:40:09Z,"@PragmaTwice I may take some time to investigate this after resolving #2253, and it'd be great if other guys would like to dive deep into this issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57PkJn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57PkXX,kvrocks,2067678679,2195,NA,PragmaTwice,20042607,Twice,,NA,2024-04-20T13:42:51Z,2024-04-20T13:42:51Z,"> [@PragmaTwice](https://github.com/PragmaTwice) I may take some time to investigate this after resolving [#2253](https://github.com/apache/kvrocks/issues/2253), and it'd be great if other guys would like to dive deep into this issue.

I think this issue is related to https://github.com/apache/kvrocks/issues/1988 which makes kvrocks2redis crash.
It is important to keep kvrocks2redis usable, without crashing.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57PkXX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57Sa6_,kvrocks,2068426431,2195,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-04-22T03:39:45Z,2024-04-22T03:39:45Z,"> @PragmaTwice I may take some time to investigate this after resolving #2253, and it'd be great if other guys would like to dive deep into this issue.


@git-hulk 
Hi, have you started studying this core? If not I kind of want to try it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57Sa6_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SeRt,kvrocks,2068440173,2195,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-22T03:55:31Z,2024-04-22T03:55:31Z,"@AntiTopQuark Not yet, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SeRt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57fuJ2,kvrocks,2071913078,2195,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-04-23T10:04:09Z,2024-04-23T10:04:09Z,"@Zakelly Hi, I've investigated this issue and successfully reproduced it on my computer. 

I suspect it's not a memory issue, but rather that compiling with ASAN and TSAN significantly impacts the performance of `kvrocks2redis`. This leads to slower data synchronization in `kvrocks2redis`.

And a simple `sleep(0.02)`([url](https://github.com/apache/kvrocks/blob/e780939689ff1b031a44640a00a91ecbd85e7439/utils/kvrocks2redis/tests/check_consistency.py#L110))  in the `check_consistency.py` test script might not give Redis enough time to sync the corresponding results, resulting in execution errors. 

As shown in the diagram below, although the test failed, the corresponding keys and values can still be found in Redis afterward.
![image](https://github.com/apache/kvrocks/assets/32798045/b0cc00e8-de85-47d1-94f5-77204a7d65bc)

Or we can try to make the test script sleep longer?

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57fuJ2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57qn5L,kvrocks,2074771019,2195,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-04-24T11:55:46Z,2024-04-24T11:55:46Z,"> @Zakelly Hi, I've investigated this issue and successfully reproduced it on my computer.
> 
> I suspect it's not a memory issue, but rather that compiling with ASAN and TSAN significantly impacts the performance of `kvrocks2redis`. This leads to slower data synchronization in `kvrocks2redis`.
> 
> And a simple `sleep(0.02)`([url](https://github.com/apache/kvrocks/blob/e780939689ff1b031a44640a00a91ecbd85e7439/utils/kvrocks2redis/tests/check_consistency.py#L110)) in the `check_consistency.py` test script might not give Redis enough time to sync the corresponding results, resulting in execution errors.
> 
> As shown in the diagram below, although the test failed, the corresponding keys and values can still be found in Redis afterward. ![image](https://private-user-images.githubusercontent.com/32798045/324787222-b0cc00e8-de85-47d1-94f5-77204a7d65bc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTM5NjAwMjEsIm5iZiI6MTcxMzk1OTcyMSwicGF0aCI6Ii8zMjc5ODA0NS8zMjQ3ODcyMjItYjBjYzAwZTgtZGU4NS00N2QxLTk0ZjUtNzcyMDRhN2Q2NWJjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDA0MjQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwNDI0VDExNTUyMVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWVjOWFhMjg2Yjk5NjU3Yjc5NzljOTZmNTg5ZGMyOGM5ZjBmMzhmOGNiMzEzMDFmYTQ5NzNjNWU1YWRkZmE2NWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.f-nYgxb2PDVNrBlu7Rf0CQkmnq2Pj88HmWP2t4R0LF4)
> 
> Or we can try to make the test script sleep longer?

cc @git-hulk 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57qn5L/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57rehJ,kvrocks,2074994761,2195,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-24T13:47:36Z,2024-04-24T13:47:36Z,@AntiTopQuark Thanks for your great investigation. Can we relax the check condition? like check it N times with a fixed interval and return once it's passed. cc @PragmaTwice What do you think?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57rehJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM583SvG,kvrocks,2094869446,2195,NA,PragmaTwice,20042607,Twice,,NA,2024-05-05T16:31:35Z,2024-05-05T16:31:35Z,Yeah we can adjust `0.02` to see if it works.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM583SvG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2195,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59aW7S,kvrocks,2104061650,2195,NA,Zakelly,2986149,Zakelly,zakelly.lan@gmail.com,NA,2024-05-10T07:20:55Z,2024-05-10T07:20:55Z,Happy to see the great investigation! Thanks @AntiTopQuark ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59aW7S/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2197,https://api.github.com/repos/apache/kvrocks/issues/2197,kvrocks,2204858336,2197,Don't allow to import the cluster slot which belongs to itself,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-03-25T04:25:51Z,2024-03-30T14:58:11Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, the cluster importer doesn't check if the slot belongs to itself.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2197/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2198,https://api.github.com/repos/apache/kvrocks/issues/2198,kvrocks,2206723981,2198,Add support FT (Searching and querying Redis data),Spywer,22039354,Mikhail B,,CLOSED,2024-03-25T21:08:39Z,2024-04-05T08:15:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Search the index with a textual query, returning either documents or just ids

https://redis.io/docs/interact/search-and-query/
https://redis.io/commands/ft.search

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2198/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2198,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55jBHn,kvrocks,2039222759,2198,NA,PragmaTwice,20042607,Twice,,NA,2024-04-05T08:15:17Z,2024-04-05T08:15:17Z,Duplicated with #2064.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55jBHn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/2199,kvrocks,2207145920,2199,Scan command support non-prefixed string matching,iushas,7236171,tanic.xiao,,CLOSED,2024-03-26T03:10:10Z,2025-01-25T01:04:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

kvrocks currently only supports prefix matching for scan. Can it achieve the same matching method of scan 0 match \*xxx\* as redis?

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2199/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54gIkQ,kvrocks,2021689616,2199,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-27T00:10:28Z,2024-03-27T00:10:28Z,@iushas Thanks for your feedback!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54gIkQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54g0Ae,kvrocks,2021867550,2199,NA,PragmaTwice,20042607,Twice,,NA,2024-03-27T03:42:47Z,2024-03-27T03:42:47Z,"Without additional indexing, such query is quite inefficient: it will probably trigger a full namespace scanning.

I'm not sure if we should add them without any option to control the behavior.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54g0Ae/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54hm3f,kvrocks,2022075871,2199,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-27T06:51:20Z,2024-03-27T06:51:20Z,"> Without additional indexing, such query is quite inefficient: it will probably trigger a full namespace scanning.

If there are too many scans, we can return early before filling up the list. The indication of the end of a SCAN is cursor 0, not the list count matching the desired number.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54hm3f/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54jVJ9,kvrocks,2022527613,2199,NA,PragmaTwice,20042607,Twice,,NA,2024-03-27T11:22:10Z,2024-03-27T11:22:10Z,"Perhaps you misunderstood my point.

For instance, if a user inputs the pattern string `*hehehehe`, it may search through all keys in the database without finding any matches. 

Iterating through all keys in the database can be time-consuming, leading to inconsistent execution times for this command.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54jVJ9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54jqDx,kvrocks,2022613233,2199,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-03-27T12:08:55Z,2024-03-27T12:08:55Z,"I means we can do this:
```shell
redis 127.0.0.1:6379>  SCAN key 0 match *hehe
1) ""17""
2) (empty list or set)

redis 127.0.0.1:6379>  SCAN key 17 match *hehe
1) ""21""
2) (empty list or set)

redis 127.0.0.1:6379>  SCAN key 21 match *hehe
1) ""0""
2)  1) ""xxhehe""

```

We can set a max scan keys num if more than this num directly returns the empty list.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54jqDx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5469E9,kvrocks,2028720445,2199,NA,baobaomaomeng,83003261,,,NA,2024-03-31T13:14:44Z,2024-03-31T13:14:44Z,"I'm a beginner programmer and I'd like to try tackling this ""good first issue"", but I'm uncertain about how to get started with this project. Could you provide some advice on reading the source code, such as parts I might need to modify, as well as information I need to know about the Redis SCAN syntax (or any relevant resources)?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5469E9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5476pT,kvrocks,2028972627,2199,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-04-01T00:38:30Z,2024-04-01T00:38:30Z,"Hi @baobaomaomeng thank you!
You can read [Redis DOC](https://redis.io/commands/scan/) and get Redis SCAN syntax.
You can read the code from [CommandScan](https://github.com/jihuayu/incubator-kvrocks/blob/88f637b7f80b2ab0247396979f5bba0111e9e217/src/commands/cmd_server.cc#L826).

We have 4 types of scan commands: SCAN, HSCAN, SSCAN and ZSCAN, you can fix SCAN first.

If you have any other problem, please ask me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5476pT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55FyG1,kvrocks,2031559093,2199,NA,baobaomaomeng,83003261,,,NA,2024-04-02T09:50:32Z,2024-04-02T09:50:32Z,"> Hi @baobaomaomeng thank you! You can read [Redis DOC](https://redis.io/commands/scan/) and get Redis SCAN syntax. You can read the code from [CommandScan](https://github.com/jihuayu/incubator-kvrocks/blob/88f637b7f80b2ab0247396979f5bba0111e9e217/src/commands/cmd_server.cc#L826).
> 
> We have 4 types of scan commands: SCAN, HSCAN, SSCAN and ZSCAN, you can fix SCAN first.
> 
> If you have any other problem, please ask me.

I have some ideas on how to add this feature, but before getting started, I would like to seek your advice. I plan to first modify the SCAN operator, and I will modify the ParseMatchAndCountParam code in the common base class CommandScanBase. Then, I noticed that the redis::Database::scan function is called in execute, and the iter->key().starts_with used in scan is to determine whether it is a prefix match. I need to change this part, but I am not sure what would be the best way to do it. Because I need to know whether I want prefix matching, suffix matching, or (key) pattern matching. I am not sure whether I should add a parameter to this function to determine which match I need, but I feel that this is not elegant enough. Perhaps a better way is to turn it into a template function, pass the scan judgment function through the template, and add a pointer to the function in CommandScanBase, similar to template<typename Func>rocksdb::Status Database::Scan(), and then determine in ParseMatchAndCountParam which scan function needs to be used.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55FyG1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55ZDVW,kvrocks,2036610390,2199,NA,baobaomaomeng,83003261,,,NA,2024-04-04T09:07:37Z,2024-04-04T09:07:37Z,"I have added substring matching and suffix matching for the scan operation, and have done some simple self-tests. Now I want to write some test cases for it, but I don't know how to add tests for it in Go. I want to know if there are any documents or resources that can help me. In addition, I hope you can assign this good first issue to me.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55ZDVW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55bDpx,kvrocks,2037135985,2199,NA,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,NA,2024-04-04T12:54:16Z,2024-04-04T12:54:16Z,"@baobaomaomeng Thank you! 
You can add some test case in [this file].(https://github.com/apache/kvrocks/blob/unstable/tests/gocase/unit/scan/scan_test.go)
You can create a draft PR. We can talk in the PR.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55bDpx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LElSP,kvrocks,2333234319,2199,NA,muswawir,68683245,muswawir,,NA,2024-09-06T04:58:14Z,2024-09-06T04:58:14Z,"Any progress on this? I have tried scan with match but doesn't seem to work, otherwise works well with no match.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LElSP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6MIFEL,kvrocks,2350928139,2199,NA,baobaomaomeng,83003261,,,NA,2024-09-14T09:24:47Z,2024-09-14T09:24:47Z,"> Any progress on this? I have tried scan with match but doesn't seem to work, otherwise works well with no match.


There is a strange problem with the code I wrote. Manual testing shows good results but I cannot perform a go test. I am trying to troubleshoot it. However, I don't have much spare time. Maybe I can solve this problem and submit a merge request during the National Day holiday.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6MIFEL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2199,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6bwsDH,kvrocks,2613231815,2199,NA,atulagrwl,92993,Atul Aggarwal,,NA,2025-01-24T19:24:46Z,2025-01-24T19:24:46Z,https://github.com/apache/kvrocks/pull/2608 - Fixed this issue. It can be closed now.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6bwsDH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2200,https://api.github.com/repos/apache/kvrocks/issues/2200,kvrocks,2207915741,2200,Check iterator status after quit loop ,han-ian,4653075,Ian.han,,CLOSED,2024-03-26T10:57:06Z,2024-07-07T11:50:06Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

From [rocksdb doc](https://github.com/facebook/rocksdb/wiki/Iterator#error-handling), need handle error when iterating.   Like bellow:
```
for (it->Seek(""hello""); it->Valid(); it->Next()) {
  // Do something with it->key() and it->value().
}
if (!it->status().ok()) {
  // Handle error. it->status().ToString() contains error message.
}
```

However, the code in kvrocks does not do this check. 
For instance: 
https://github.com/apache/kvrocks/blob/unstable/src/types/redis_hash.cc#L344

```
rocksdb::Status Hash::GetAll(const Slice &user_key, std::vector<FieldValue> *field_values, HashFetchType type) {
  field_values->clear();

  std::string ns_key = AppendNamespacePrefix(user_key);
  HashMetadata metadata(false);
  LatestSnapShot ss(storage_);
  rocksdb::Status s = GetMetadata(GetOptions{.snapshot = ss.GetSnapShot()}, ns_key, &metadata);
  if (!s.ok()) return s.IsNotFound() ? rocksdb::Status::OK() : s;

  std::string prefix_key = InternalKey(ns_key, """", metadata.version, storage_->IsSlotIdEncoded()).Encode();
  std::string next_version_prefix_key =
      InternalKey(ns_key, """", metadata.version + 1, storage_->IsSlotIdEncoded()).Encode();

  rocksdb::ReadOptions read_options = storage_->DefaultScanOptions();
  read_options.snapshot = ss.GetSnapShot();
  rocksdb::Slice upper_bound(next_version_prefix_key);
  read_options.iterate_upper_bound = &upper_bound;

  auto iter = util::UniqueIterator(storage_, read_options);
  for (iter->Seek(prefix_key); iter->Valid() && iter->key().starts_with(prefix_key); iter->Next()) {
    if (type == HashFetchType::kOnlyKey) {
      InternalKey ikey(iter->key(), storage_->IsSlotIdEncoded());
      field_values->emplace_back(ikey.GetSubKey().ToString(), """");
    } else if (type == HashFetchType::kOnlyValue) {
      field_values->emplace_back("""", iter->value().ToString());
    } else {
      InternalKey ikey(iter->key(), storage_->IsSlotIdEncoded());
      field_values->emplace_back(ikey.GetSubKey().ToString(), iter->value().ToString());
    }
  }
  return rocksdb::Status::OK();
}
```





### Solution

check iterator status.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2200/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2200,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54aYut,kvrocks,2020182957,2200,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-26T11:33:11Z,2024-03-26T11:33:11Z,"@in-han Thanks for your feedback, would you like to submit a PR to improve this？","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54aYut/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2200,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54gWno,kvrocks,2021747176,2200,NA,han-ian,4653075,Ian.han,,NA,2024-03-27T01:16:02Z,2024-03-27T01:16:02Z,"@git-hulk Yes, I will do this next week.

> @in-han Thanks for your feedback, would you like to submit a PR to improve this？

Yeah, I will do it next week.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54gWno/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2200,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54geaA,kvrocks,2021779072,2200,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-03-27T01:54:36Z,2024-03-27T01:54:36Z,@han-ian Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54geaA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2200,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6DE6Ii,kvrocks,2199101986,2200,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-07-01T03:01:14Z,2024-07-01T03:01:14Z,"Hi @git-hulk ,

This issue seems to be inactivated for 3 months.
Can this task be assigned to be?

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6DE6Ii/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2200,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6DE_WA,kvrocks,2199123328,2200,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-07-01T03:08:42Z,2024-07-01T03:08:42Z,"@LindaSummer Surely yes, I have assigned it to you, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6DE_WA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2212,https://api.github.com/repos/apache/kvrocks/issues/2212,kvrocks,2216762431,2212,Fix GetOptions initializer to make it valid in C++17,PragmaTwice,20042607,Twice,,CLOSED,2024-03-31T03:46:40Z,2024-04-01T11:32:31Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

```
/home/runner/work/kvrocks/kvrocks/src/types/redis_zset.cc:220:46: warning: designated initializers are a C++20 extension [-Wc++20-designator]
  rocksdb::Status s = GetMetadata(GetOptions{.snapshot = ss.GetSnapShot()}, ns_key, &metadata);
```

### What did you expect to see?

no warning

### What did you see instead?

```
/home/runner/work/kvrocks/kvrocks/src/types/redis_zset.cc:220:46: warning: designated initializers are a C++20 extension [-Wc++20-designator]
  rocksdb::Status s = GetMetadata(GetOptions{.snapshot = ss.GetSnapShot()}, ns_key, &metadata);
```

### Anything Else?

cc @mapleFU 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2212/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2212,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM546htu,kvrocks,2028608366,2212,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-03-31T09:02:23Z,2024-03-31T09:02:23Z,"I just back home, will fix this tonight","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM546htu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2214,https://api.github.com/repos/apache/kvrocks/issues/2214,kvrocks,2217421438,2214,Slave does not sync key updates during downtime after restart,sam-hn,158024595,,,CLOSED,2024-04-01T03:08:59Z,2024-04-05T01:41:00Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Kvrocks 2.7.0

### Minimal reproduce step

1. shutdown slave node
2. update key `test1` and create a new key `test2` in master node
3. bring up the slave node and check the keys in slave, `test1` in slave is not updated and `test2` is created

### What did you expect to see?

after restart, slave should have the updated value of `test1`

### What did you see instead?

`test1` key in slave is not updated 

### Anything Else?

I also tried updating key `test2` in master node to see if this could trigger the sync of key `test1` between slave and master, but only to find `test2` is updated in slave

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2214/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2214,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM548dsz,kvrocks,2029116211,2214,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-01T03:57:43Z,2024-04-01T03:57:43Z,"@sam-hn Can you check if the replication is correct while restarting via the command `info replication`. Did you add the `slaveof {maseter_ip} {master_port}` to your slave configuration file? if no, it won't reconnect the master after restarting.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM548dsz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2214,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5488FG,kvrocks,2029240646,2214,NA,sam-hn,158024595,,,NA,2024-04-01T06:27:29Z,2024-04-01T06:27:29Z,"> @sam-hn Can you check if the replication is correct while restarting via the command `info replication`. Did you add the `slaveof {maseter_ip} {master_port}` to your slave configuration file? if no, it won't reconnect the master after restarting.

thanks for your feedback. 
the replication is correct, `info replication` shows slave is connected, actually slave configuration is not the problem, because slave can sync `test2`-- the new key from master, it's just `test1` key that has problem
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5488FG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2214,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54-S_t,kvrocks,2029596653,2214,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-01T11:11:13Z,2024-04-01T11:11:13Z,"@sam-hn I cannot reproduce this issue on my side, what I do is:


1. start S1 and S2, and S2 slaveof S1
2. SET a 100 to S1, then shutdown the S2
3. SET a 101 and SET b 1 to S1, then restart S2 and S2 slaveof S1
4. GET a and GET b from S2, and returns 101 and 1

Can you provide how do you reproduce this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM54-S_t/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2214,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55M2ox,kvrocks,2033412657,2214,NA,sam-hn,158024595,,,NA,2024-04-03T02:17:20Z,2024-04-03T02:17:20Z,"@git-hulk thanks for your test results. This is the exact steps I tried except I was testing with cluster mode.

Then I did another test with two new kvrocks nodes which had cluster mode disabled, and this time I could not reproduce the issue either. After that, I removed db dir and enabled cluster mode on the nodes, called controller API to create new cluster then did the test again, and the issue came back.

So I think the issue only happens with master-slave replication in a cluster. Can you please try the same and see if issue can reproduce this time?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55M2ox/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2214,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55M3p6,kvrocks,2033416826,2214,NA,sam-hn,158024595,,,NA,2024-04-03T02:23:12Z,2024-04-03T02:23:12Z,"Attached my test results for reference, below is the cluster info
```
10.70.171.222:6672> cluster nodes
qxpiIgvNeJN2DMLgwMwDmud8luIYw6uY7dIEuFtH 10.70.171.222:6673@16673 slave kcf0WSVWymTh6AjTuw1JxL2e4AMNLXgkK9XFSzm8 1712109613610 1712109613611 1 connected
kcf0WSVWymTh6AjTuw1JxL2e4AMNLXgkK9XFSzm8 10.70.171.222:6672@16672 myself,master - 1712109613610 1712109613611 1 connected 0-16383
```

during slave downtime, update a to 101 and create b
```
10.70.171.222:6672> info replication
# Replication
role:master
connected_slaves:0
master_repl_offset:3
10.70.171.222:6672> set a 101
OK
10.70.171.222:6672> set b 1
OK
```

after slave restarted, key a still keeps old value
```
10.70.171.222:6673> keys *
1) ""b""
2) ""a""
10.70.171.222:6673> get a
""100""
10.70.171.222:6673> get b
""1""

```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55M3p6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2214,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55M4c8,kvrocks,2033420092,2214,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-03T02:27:56Z,2024-04-03T02:27:56Z,"@sam-hn Thank you, I will have a try soon when I get time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55M4c8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2214,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55O5P3,kvrocks,2033947639,2214,NA,sam-hn,158024595,,,NA,2024-04-03T08:48:58Z,2024-04-03T08:48:58Z,"[slave-config.txt](https://github.com/apache/kvrocks/files/14849392/slave-config.txt)
attached slave configs which has use-rsid-psync enabled","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55O5P3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2214,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55P0lB,kvrocks,2034190657,2214,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-03T10:29:44Z,2024-04-03T10:29:44Z,"> [slave-config.txt](https://github.com/apache/kvrocks/files/14849392/slave-config.txt) attached slave configs which has use-rsid-psync enabled

@sam-hn Thanks for your input. I found the root cause now and will submit a PR to resolve this soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM55P0lB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2215,https://api.github.com/repos/apache/kvrocks/issues/2215,kvrocks,2219792194,2215,error: unused variable ‘_’ [-Werror=unused-variable],mnizhq007,23118518,,,CLOSED,2024-04-02T07:39:49Z,2024-04-22T14:11:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks：2.7.0
OS：CentOS Linux release 7.9.2009 (Core)
gcc：gcc version 11.2.1 20220127 (Red Hat 11.2.1-9) (GCC)
cmake：cmake version 3.26.0-rc6


### Minimal reproduce step

./x.py build -DDEPS_FETCH_PROXY=https://hub.nuaa.cf/

### What did you expect to see?

希望能解决兼容问题，实现正常编译

### What did you see instead?

![1](https://github.com/apache/kvrocks/assets/23118518/8df5db4c-e837-48bb-9220-6650cf202213)
[ 84%] Linking C static library lib/libevent.a
[ 84%] Built target event_static
[ 84%] Building CXX object _deps/fmt-build/CMakeFiles/fmt.dir/src/format.cc.o
[ 84%] Building CXX object _deps/fmt-build/CMakeFiles/fmt.dir/src/os.cc.o
[ 84%] Linking CXX static library libfmt.a
[ 84%] Built target fmt
[ 85%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/cluster/cluster.cc.o
/root/apache-kvrocks-2.7.0-src/src/cluster/cluster.cc: In member function ‘std::map<std::__cxx11::basic_string<char>, std::__cxx11::basic_string<char> > Cluster::getClusterNodeSlots() const’:
/root/apache-kvrocks-2.7.0-src/src/cluster/cluster.cc:537:22: error: unused variable ‘_’ [-Werror=unused-variable]
   for (auto &[_, info] : slots_infos) {
                      ^
cc1plus: some warnings being treated as errors
gmake[3]: *** [CMakeFiles/kvrocks_objs.dir/build.make:76: CMakeFiles/kvrocks_objs.dir/src/cluster/cluster.cc.o] Error 1
gmake[2]: *** [CMakeFiles/Makefile2:530: CMakeFiles/kvrocks_objs.dir/all] Error 2
gmake[1]: *** [CMakeFiles/Makefile2:577: CMakeFiles/kvrocks.dir/rule] Error 2
gmake: *** [Makefile:254: kvrocks] Error 2
Traceback (most recent call last):
  File ""./x.py"", line 422, in <module>
    args.func(**arg_dict)
  File ""./x.py"", line 137, in build
    run(cmake, *options, verbose=True, cwd=dir)
  File ""./x.py"", line 68, in run
    raise RuntimeError(err)
RuntimeError: 
failed to run: ('/usr/local/bin/cmake', '--build', '.', '-t', 'kvrocks', 'kvrocks2redis')
exit with code: 2

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2215/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2229,https://api.github.com/repos/apache/kvrocks/issues/2229,kvrocks,2229813997,2229,Commands that don't exist in Redis should have documentation page in website ,PragmaTwice,20042607,Twice,,OPEN,2024-04-07T15:14:41Z,2024-09-09T00:38:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

For any command in kvrocks, if there is no corresponding command in Redis, we should make a web page for it's documentation, including it's syntax, function, return value and notes.
It's not enough that just leave a sentence in the Supported Commands page.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2229/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2229,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRoHr,kvrocks,2336653803,2229,NA,AryanSingh1112,160637316,Aryan Singh ,,NA,2024-09-08T11:44:13Z,2024-09-08T11:44:13Z,"Hey!! Can you please give this issue to me for solving it.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRoHr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2229,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRoeF,kvrocks,2336655237,2229,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-08T11:48:24Z,2024-09-08T11:48:24Z,"@AryanSingh1112 Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRoeF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2229,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRo7C,kvrocks,2336657090,2229,NA,AryanSingh1112,160637316,Aryan Singh ,,NA,2024-09-08T11:55:09Z,2024-09-08T11:55:09Z,"@git-hulk Could you please provide an overview that what I have to do because I am beginner. If you tell, I will definitely solve it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRo7C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2229,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRpod,kvrocks,2336659997,2229,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-08T12:04:35Z,2024-09-08T12:04:35Z,"@AryanSingh1112 As described in issue motivation, we need to add a dedicated page for those commands that are not supported in Redis on the Kvrocks website. Please refer to:

- [Kvrocks Supported Commands](https://kvrocks.apache.org/docs/supported-commands)
- [Kvrocks Website Source Repo](https://github.com/apache/kvrocks-website/blob/main/docs/supported-commands.md)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRpod/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2229,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRx4B,kvrocks,2336693761,2229,NA,AryanSingh1112,160637316,Aryan Singh ,,NA,2024-09-08T13:48:21Z,2024-09-08T13:48:21Z,I have done the work but where I have to add the page means in which file of kvrocks website.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRx4B/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2229,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRx5p,kvrocks,2336693865,2229,NA,AryanSingh1112,160637316,Aryan Singh ,,NA,2024-09-08T13:48:42Z,2024-09-08T13:48:42Z,@git-hulk ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRx5p/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2229,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LSJdH,kvrocks,2336790343,2229,NA,AryanSingh1112,160637316,Aryan Singh ,,NA,2024-09-08T19:02:29Z,2024-09-08T19:02:29Z,"@git-hulk sir I have solved the issue and formed the web page, but I am confused how to upload and pull requests so that it can merge. Please guide me in this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LSJdH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2229,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LSjZl,kvrocks,2336896613,2229,NA,PragmaTwice,20042607,Twice,,NA,2024-09-09T00:38:20Z,2024-09-09T00:38:20Z,"As mentioned before, you can check the source repo of our website: https://github.com/apache/kvrocks-website.

For how to use git, sorry but we cannot provide the course, you can learn it by any tutorial e.g. https://git-scm.com/docs/gittutorial.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LSjZl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2231,https://api.github.com/repos/apache/kvrocks/issues/2231,kvrocks,2231145750,2231,Improve the output of the block cache usage in INFO command,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-04-08T12:53:45Z,2024-04-14T13:20:58Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, all column families are sharing the same block cache since 2.6,
but the info output still displays the block usage per column family which
might confuse users:

```
block_cache_usage[default]:261607392
block_cache_usage[metadata]:261607392
block_cache_usage[zset_score]:261607392
block_cache_usage[stream]:261607392
block_cache_usage[search]:261607392
```

### Solution

Reduce the output format into a single one:

```
block_cache_usage:261607392
```

It will break the old metrics exporter, we should change the kvrocks-exporter as well.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2231/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2237,https://api.github.com/repos/apache/kvrocks/issues/2237,kvrocks,2237570070,2237, Snorcloud has reported a potential leak of memory pointed,jihuayu,32858525,纪华裕,jihuayu123@gmail.com,CLOSED,2024-04-11T12:04:26Z,2024-04-12T14:19:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

----
Snorcloud has reported a potential leak of memory points. It makes our project reliability Rating to E

https://sonarcloud.io/project/issues?open=AY5rFU4fqWrU_C5xtNe-&id=apache_kvrocks
Can you check is it an issue @PragmaTwice ?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2237/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2237,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56TM3c,kvrocks,2051853788,2237,NA,PragmaTwice,20042607,Twice,,NA,2024-04-12T14:19:04Z,2024-04-12T14:19:04Z,I think it's a false positive.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56TM3c/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2243,https://api.github.com/repos/apache/kvrocks/issues/2243,kvrocks,2240220919,2243,Enable x.py to support executing specified unit tests via command line arguments,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,CLOSED,2024-04-12T14:00:03Z,2024-04-12T14:13:50Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

When modifying kvrocks, I wish to add and execute specified test methods, but the current `x.py` generated command executes all tests, which usually takes several minutes to complete.
I need to temporarily modify `x.py` or the command it generates to execute the specified method.

```
def test_go(dir: str, cli_path: str, rest: List[str]) -> None:
    go = find_command('go', msg='go is required for testing')
    find_command(cli_path, msg='redis-cli is required for testing')

    binpath = Path(dir).absolute() / 'kvrocks'
    basedir = Path(__file__).parent.absolute() / 'tests' / 'gocase'
    workspace = basedir / 'workspace'

    args = [
        'test', '-run=TestZSetSort','-timeout=1800s', '-bench=.', './...',
        # 'test','-timeout=1800s', '-bench=.', './...',
        f'-binPath={binpath}',
        f'-cliPath={cli_path}',
        f'-workspace={workspace}',
        *rest
    ]

    run(go, *args, cwd=str(basedir), verbose=True)
```

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2243/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2243,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56TKFN,kvrocks,2051842381,2243,NA,PragmaTwice,20042607,Twice,,NA,2024-04-12T14:12:32Z,2024-04-12T14:12:32Z,"Actually you don't need to modify the source code. 

You can refer to the CONTRIBUTING document here:
https://kvrocks.apache.org/community/contributing#tests

> You can use `./x.py test go <BUILD_DIR> -run <PATTERN>` to run Golang test cases whose name match the pattern. Technically, all arguments after `<BUILD_DIR>` will be appended to the go test command. Refer to the [testflag](https://pkg.go.dev/cmd/go/internal/test) page for all possible flags.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56TKFN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2243,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56TKpF,kvrocks,2051844677,2243,NA,PragmaTwice,20042607,Twice,,NA,2024-04-12T14:13:50Z,2024-04-12T14:13:50Z,Closed. Please feel free to reopen if I missed anything.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56TKpF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2248,https://api.github.com/repos/apache/kvrocks/issues/2248,kvrocks,2242035106,2248,bug: inappropriate type of `ttl_` of `CommandSet`,J0HN50N133,53596783,JohnsonLee,0xjohnsonlee@gmail.com,CLOSED,2024-04-14T08:11:24Z,2024-04-15T09:18:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Since db2860d until now.

### Minimal reproduce step

https://github.com/apache/kvrocks/blob/a2380535d5602692f3746783c48ccc7bb05cc58e/src/commands/cmd_string.cc#L307

Here determine whether `ttl_` less than `0`, if so, doing deletion. However, the type of `ttl_` if `uint64_t` which is impossible to less than 0.

https://github.com/apache/kvrocks/blob/a2380535d5602692f3746783c48ccc7bb05cc58e/src/commands/cmd_string.cc#L340

### What did you expect to see?

If `ttl_` less than `0`, doing deletion.

### What did you see instead?

The condition will never be true, thus, deletion will never be done.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2248/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2248,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56bOsx,kvrocks,2053958449,2248,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-14T08:13:34Z,2024-04-14T08:13:34Z,"@J0HN50N133 Thanks for your report.

You're right, would you submit a PR to fix this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56bOsx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2248,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56bPN7,kvrocks,2053960571,2248,NA,J0HN50N133,53596783,JohnsonLee,0xjohnsonlee@gmail.com,NA,2024-04-14T08:19:52Z,2024-04-14T08:19:52Z,"I could fix it. Although the behaviour here is correct (because of implicit cast), it's disturbing.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56bPN7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2251,https://api.github.com/repos/apache/kvrocks/issues/2251,kvrocks,2244509154,2251,"""DUMP"" command produces content not compatible with Redis",krizald,7716750,Leon,,CLOSED,2024-04-15T20:03:04Z,2024-04-16T07:24:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

OS:
 Debian 11 bullseye

KV Rock
version:unstable
git_sha1:433dcfb3


### Minimal reproduce step

I checked and compiled KV Rocks from unstable (SHA: 433dcfb39b689503b747eabaf922a8718a1d4575) and test the new ""DUMP"" command. My plan is to restore keys from KV Rocks back to Redis 6.2.10/7.2.4 using DUMP/RESTORE

1. In KV Rocks
```
set A ""ABC""`
dump A
```
Then I get the content: ""\x00\x03ABC\x0c\x00\x8a\x95H\n\x1a\xf2\x0eO""
2. In Redis 6.2.10/7.2.4
```
restore A 0 ""\x00\x03ABC\x0c\x00\x8a\x95H\n\x1a\xf2\x0eO""
```
I got message: (error) ERR DUMP payload version or checksum are wrong






### What did you expect to see?

I ran the same commands in Redis 6.2.10
```
set A ""ABC""
dump A
```
What I got is: 
""\x00\x03ABC\t\x00\x91\x11-\x06\xb4^\xf3\xb7""
And when I restore, it works

### What did you see instead?

For same string value ""ABC"", KV Rocks dumps: 
`""\x00\x03ABC\x0c\x00\x8a\x95H\n\x1a\xf2\x0eO""`
Redis 6.2.10 is 
`""\x00\x03ABC\t\x00\x91\x11-\x06\xb4^\xf3\xb7""`

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2251/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2251,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56pjlF,kvrocks,2057713989,2251,NA,krizald,7716750,Leon,,NA,2024-04-15T20:07:09Z,2024-04-15T20:07:09Z,"more over, KV Rocks is compatible with both dump content

```
127.0.0.1:7381> restore B 0 ""\x00\x03ABC\x0c\x00\x8a\x95H\n\x1a\xf2\x0eO""
OK
127.0.0.1:7381> get B
""ABC""
127.0.0.1:7381> restore C 0 ""\x00\x03ABC\t\x00\x91\x11-\x06\xb4^\xf3\xb7""
OK
127.0.0.1:7381> get C
""ABC
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56pjlF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2251,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56rAZE,kvrocks,2058094148,2251,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-16T01:52:45Z,2024-04-16T01:52:45Z,"@krizald Thanks for your report, I will take a look while I get time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56rAZE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2251,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56rnz5,kvrocks,2058255609,2251,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-16T05:26:42Z,2024-04-16T05:26:42Z,@krizald This issue would be fixed in #2252 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56rnz5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/2253,kvrocks,2246280666,2253,DUMP command error with list,krizald,7716750,Leon,,CLOSED,2024-04-16T15:00:38Z,2024-04-30T04:17:21Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

OS: Debian 11 bulleye
KV Rocks: unstable, git_sha1:4ecb35b9
Redis: 6.2.10

### Minimal reproduce step

Redis service: localhost:6381
KV Rocks: localhost:7381

1. Start Redis 6.2 with attached dump.rdb
[dump.zip](https://github.com/apache/kvrocks/files/14998662/dump.zip)

2. Dump Key ""ABCD"" , which is a list, from Redis to a local file
```
redis-cli -p 6381 --raw dump ABCD | head -c-1 > ABCD-REDIS.dump
```
3. Restore ABCD to KV rocks
```
cat ABCD-REDIS.dump | redis-cli -p 7381 -x restore ABCD 0
OK
```
4. Dump Key ""ABCD"" from KV Rocks to local file
```
redis-cli -p 7381 --raw dump ABCD | head -c-1 > ABCD-KVROCKS.dump
```
5. Restore ABCD back to Redis with a new name
```
cat ABCD-KVROCKS.dump | redis-cli -p 6381 -x restore NEW_ABCD 0
(error) ERR Bad data format
```



### What did you expect to see?

Restore to Redis with KV Rocks dump should be successful


### What did you see instead?

Restore to Redis with KV Rocks dump is failed. Error message:
(error) ERR Bad data format

### Anything Else?

I attached 2 dump files. KV Rocks dump size is way bigger than the Redis one
[ABCD_dump.zip](https://github.com/apache/kvrocks/files/14998854/ABCD_dump.zip)


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2253/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56vvvK,kvrocks,2059336650,2253,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-16T15:14:04Z,2024-04-16T15:14:04Z,"@krizald Thanks for your report, I can confirm it works well in Redis7 but didn't work in Redis 6. Will investigate the reason while I get time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56vvvK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56wVZ0,kvrocks,2059490932,2253,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-16T16:28:51Z,2024-04-16T16:28:51Z,"@krizald Kvrocks now is using `RDB_TYPE_LIST_QUICKLIST_2` to dump the list payload which is only supported in Redis7. Needs to change it to RDB_TYPE_LIST_QUICKLIST or RDB_TYPE_LIST encoding, to see if any guys would like to resolve this. If no, I will fix it this weekend.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM56wVZ0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SWsM,kvrocks,2068409100,2253,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-04-22T03:15:56Z,2024-04-22T03:15:56Z,"@krizald @git-hulk 
I believe that if the result dumped from Redis 7 is in the `RDB_TYPE_LIST_QUICKLIST_2` format, restoring it into Redis 6 would encounter the same issue. 

The dump and restore commands themselves are inherently incompatible between different RDB versions.
Due to the existence of `RDB_VERSION` being encoded into the DUMP payload, `Restore` command will check the `RDB_VERSION`. The payload dumped in Redis 7 version cannot be used in Redis 6 version. 

You can take a look at this code: https://github.com/redis/redis/blob/804110a487f048669aa9d9412e5789ec43f4fe39/src/cluster.c#L107""


The current KVRocks\`s `RDB_VERSION` is 12, referencing the latest code of Redis.


","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SWsM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SYQd,kvrocks,2068415517,2253,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-22T03:25:09Z,2024-04-22T03:25:09Z,"@AntiTopQuark Thanks for your reply. For the DUMP command, it'd be better to support more Redis versions(at least since from Redis 4.0). And I have changed the RDB version to 6 in PR https://github.com/apache/kvrocks/pull/2252, this issue should be caused by using the encoding `RDB_TYPE_LIST_QUICKLIST_2` for the list which has been supported since Redis 7.0.0. I haven't tested other types like HASH/SET/ZSET yet, but I guess those data types should work well.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SYQd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SeAb,kvrocks,2068439067,2253,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-04-22T03:53:59Z,2024-04-22T03:53:59Z,"> @krizald :""I attached 2 dump files. KV Rocks dump size is way bigger than the Redis one""

Due to the fact that kvrocks does not support some compression encodings, the result of the `dump` command will be stored in its native string format, resulting in larger sizes.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SeAb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57unjQ,kvrocks,2075818192,2253,NA,krizald,7716750,Leon,,NA,2024-04-24T20:51:01Z,2024-04-24T20:51:01Z,"@git-hulk 

I tested with the most recent unstable KVRocks and Redis 6,2. String/Hashset/Set are ok. But dumping list is failed, when restore in Redis.

KV Rocks Server Info
```
# Server
version:unstable
kvrocks_version:unstable
redis_version:4.0.0
git_sha1:51ce175d
```

Redis Server Info
```
# Server
redis_version:6.2.10
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:8dfb0984f18c7765
redis_mode:standalone
os:Linux 5.10.0-22-amd64 x86_64
```

Here is the script I use to test list

```
redisConn=""-p 6381""
kvrocksConn=""-p 7381""
keyName=""test-list""
redis-cli $redisConn del $keyName
redis-cli $kvrocksConn del $keyName
redis-cli $kvrocksConn lpush $keyName ""A""
redis-cli $kvrocksConn lpush $keyName ""B""
redis-cli $kvrocksConn lpush $keyName ""D""
redis-cli $kvrocksConn --raw dump $keyName | head -c-1 | redis-cli $redisConn -x restore $keyName 0
```
Error message: (error) ERR Bad data format

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57unjQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57vs2Y,kvrocks,2076102040,2253,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-25T00:33:45Z,2024-04-25T00:33:45Z,@krizald Thanks for your detailed report. Then I know the root cause now and will fix it when I get time. @AntiTopQuark is also welcome to contribute if you're interested.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57vs2Y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM575zqL,kvrocks,2078751371,2253,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-04-26T06:59:58Z,2024-04-26T06:59:58Z,"> @krizald Thanks for your detailed report. Then I know the root cause now and will fix it when I get time. @AntiTopQuark is also welcome to contribute if you're interested.

@git-hulk  If you haven't started yet, I can accept this task","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM575zqL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2253,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM576Dqh,kvrocks,2078816929,2253,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-26T07:43:22Z,2024-04-26T07:43:22Z,@AntiTopQuark Very much appreciate your offer. I'm still working on the controller and not start yet. Welcome to take this issue.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM576Dqh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2261,https://api.github.com/repos/apache/kvrocks/issues/2261,kvrocks,2254576801,2261,Rethink `USE_ALIGNED_ACCESS` macro in kvrocks code,mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2024-04-20T14:27:46Z,2024-04-20T14:27:47Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Redis uses `USE_ALIGNED_ACCESS` and check memory aligned in it's code:
1. For archs like ARM, memory access should be ""aligned"".
2. For arch like x86, it can use some code to do optimizations

This code leaves lots of ad-hoc optimizations in kvrocks. I think we need to check our compiler supports, does this really provides any optimizations

### Solution

1. Checks `USE_ALIGNED_ACCESS` in code with compiler versions
2. Remove them if no really optimizations

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2261/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2263,https://api.github.com/repos/apache/kvrocks/issues/2263,kvrocks,2255562665,2263,"Enable CompactionChecker for ""search"" CF",mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2024-04-22T04:41:03Z,2024-04-22T04:41:11Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/apache/kvrocks/blob/899216db7316083b5de9cef03dd0e818ededed96/src/server/server.cc#L200-L201

Should we enable compaction checker in this checking?

### Solution

```
          std::vector<std::string> cf_names = {engine::kMetadataColumnFamilyName, engine::kSubkeyColumnFamilyName,
                                               engine::kZSetScoreColumnFamilyName, engine::kStreamColumnFamilyName};
          for (const auto &cf_name : cf_names) {
            compaction_checker.PickCompactionFiles(cf_name);
          }
```

Add type in this list

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2263/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2263,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SnF7,kvrocks,2068476283,2263,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-04-22T04:41:10Z,2024-04-22T04:41:10Z,@PragmaTwice ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57SnF7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2266,https://api.github.com/repos/apache/kvrocks/issues/2266,kvrocks,2256148779,2266,Treat `unused-parameter` warnings as errors in CMake,PragmaTwice,20042607,Twice,,CLOSED,2024-04-22T10:17:15Z,2024-08-27T11:17:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

See https://gcc.gnu.org/onlinedocs/gcc-3.2/gcc/Warning-Options.html.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2266/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2266,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57fJGE,kvrocks,2071761284,2266,NA,tiny-sky,118060227,tiny-sky,,NA,2024-04-23T08:49:59Z,2024-04-23T08:49:59Z,"Recently I happened to learn about the project structure through CMakeLists.txt.
I'd be happy to try to resolve the issue. Of course, if he (#2267 ) didn't choose this issue
At the same time, I am a beginner and am happy to accept other tasks to understand the project faster.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57fJGE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2266,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM593tSi,kvrocks,2111755426,2266,NA,VasuDevrani,101383635,,,NA,2024-05-15T07:14:29Z,2024-05-15T07:14:29Z,/assign,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM593tSi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2267,https://api.github.com/repos/apache/kvrocks/issues/2267,kvrocks,2256161938,2267,Investigate the possiblity and method to replace GLOG with spdlog,PragmaTwice,20042607,Twice,,OPEN,2024-04-22T10:23:14Z,2024-06-01T06:18:00Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

spdlog (https://github.com/gabime/spdlog) is a modern logging library based on fmt library (or `std::format`).

It's better to use spdlog instead of glog because we extensively utilize the fmt library.

Note: we need to specify `SPDLOG_FMT_EXTERNAL` since we need to keep there's only one fmt library in our deps.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2267/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57VU60,kvrocks,2069188276,2267,NA,YaroslavStepanchuk,150796488,Yaroslav,,NA,2024-04-22T11:46:11Z,2024-04-22T11:46:11Z,"@PragmaTwice Good idea. However, we use this function from the glog library https://github.com/apache/kvrocks/blob/unstable/src/cli/signal_util.h#L54. 

I was looking for a way to get rid of it because in the glog-0.7.0 it's no more public. 

N.B. I tried to use the libunwind but failed to add it to the project. However, it's a different story :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57VU60/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57VthG,kvrocks,2069289030,2267,NA,133tosakarin,97331129,,,NA,2024-04-22T12:37:08Z,2024-04-22T12:37:08Z,"hello, I'm a beginer, Can I choose this issue ? ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57VthG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57eARN,kvrocks,2071462989,2267,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-04-23T05:53:00Z,2024-04-23T05:53:00Z,@133tosakarin Perhaps you can try #2266 first.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57eARN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wFhV,kvrocks,2143311957,2267,NA,letian-jiang,16740944,Letian Jiang,letian.jiang@outlook.com,NA,2024-06-01T05:59:09Z,2024-06-01T05:59:09Z,"@git-hulk @PragmaTwice Could you assign this one to me?

BTW, is there any expected performance improvement after replacing GLOG with spdlog?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wFhV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2267,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wHER,kvrocks,2143318289,2267,NA,PragmaTwice,20042607,Twice,,NA,2024-06-01T06:17:59Z,2024-06-01T06:17:59Z,"> BTW, is there any expected performance improvement after replacing GLOG with spdlog?

I think it's good if there's no noticeable performance degradation.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wHER/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2268,https://api.github.com/repos/apache/kvrocks/issues/2268,kvrocks,2256204533,2268,Data structure desgin documentation of STREAM GROUP,PragmaTwice,20042607,Twice,,OPEN,2024-04-22T10:43:44Z,2024-05-23T03:40:08Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

We should update the data structure documentation of STREAM to include the encoding of stream groups.

### Solution

@Yangsx-1 Could you help?

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2268/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2268,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57VFp6,kvrocks,2069125754,2268,NA,Yangsx-1,85615957,Hauru,,NA,2024-04-22T11:13:44Z,2024-04-22T11:13:44Z,I'll do it later.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM57VFp6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2268,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-utOS,kvrocks,2126173074,2268,NA,Yangsx-1,85615957,Hauru,,NA,2024-05-23T03:40:06Z,2024-05-23T03:40:06Z,I submitted a PR at kvrocks-website. apache/kvrocks-website#222  @PragmaTwice ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-utOS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2269,https://api.github.com/repos/apache/kvrocks/issues/2269,kvrocks,2256253392,2269,Add support of hash field expiration,PragmaTwice,20042607,Twice,,OPEN,2024-04-22T11:08:01Z,2024-07-11T14:47:49Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Refer to https://github.com/redis/redis/pull/13172, Redis has supported this feature.

### Solution

TBD

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2269/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2269,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58DfVd,kvrocks,2081289565,2269,NA,Yangsx-1,85615957,Hauru,,NA,2024-04-28T01:58:28Z,2024-04-28T01:58:28Z,"I'll do this, and will propose a solution later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58DfVd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2269,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AbJ10,kvrocks,2154601844,2269,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-06-07T11:00:03Z,2024-06-07T11:00:03Z,This feature was add in Redis 7.4 RC,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AbJ10/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2269,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ee8wF,kvrocks,2222705669,2269,NA,jjz921024,19649281,anotherJJz,470623352@qq.com,NA,2024-07-11T11:39:52Z,2024-07-11T11:39:52Z,"@git-hulk Hi, I have done some work on this feature before. May i submit a pr for this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ee8wF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2269,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Egln9,kvrocks,2223135229,2269,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-07-11T14:47:44Z,2024-07-11T14:47:44Z,@jjz921024 Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Egln9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2279,https://api.github.com/repos/apache/kvrocks/issues/2279,kvrocks,2267359495,2279,Refactor the management of rocksdb ColumnFamily,mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2024-04-28T05:49:32Z,2024-05-06T12:35:57Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, kvrocks has multiple Column Families, and some configs are written ad-hoc. So, some issues below would be tricky:
1. https://github.com/apache/kvrocks/issues/2193
2. https://github.com/apache/kvrocks/issues/2263

Now I think we need a class for owning the kvrocks cf configs.

### Solution

A unified CF manager

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2279/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2279,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58JlCf,kvrocks,2082885791,2279,NA,jjz921024,19649281,anotherJJz,470623352@qq.com,NA,2024-04-29T14:21:18Z,2024-04-29T14:21:18Z,"For setting the `write_buff_size` for each column family. There are a simple way that i can think of is to extend `config set rocksdb.write_buffer_size num` command. 

For example, the command of `config set rocksdb.write_buffer_size [cf_name] num` is used to set the buff_size of the specify cf.

More example: 
```shell
config set rocksdb.write_buffer_size ALL num  
# equivalent to `config set rocksdb.write_buffer_size num`
# settings the buff_size for all of column families

config set rocksdb.write_buffer_size MAJOR num
# for major colunm families include metadata and default

config set rocksdb.write_buffer_size MINOR num
# for minor colunm families except for metadata and default

config set rocksdb.write_buffer_size [metadate | default | zset | pubsub | ... ] num
# for specify column family
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58JlCf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2279,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58KBVK,kvrocks,2083001674,2279,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-04-29T15:10:30Z,2024-04-29T15:10:30Z,"I'm trying to add a code-level refactor on this but I'm feel sick these days, maybe I'll update in coming few days

@jjz921024 these style of config here ( https://github.com/apache/kvrocks/issues/2279#issuecomment-2082885791 ) can separate as configs and would be nice for user","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58KBVK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2279,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58Kk6b,kvrocks,2083147419,2279,NA,PragmaTwice,20042607,Twice,,NA,2024-04-29T16:16:27Z,2024-04-29T16:16:27Z,"> For setting the `write_buff_size` for each column family. There are a simple way that i can think of is to extend `config set rocksdb.write_buffer_size num` command.
> 
> For example, the command of `config set rocksdb.write_buffer_size [cf_name] num` is used to set the buff_size of the specify cf.
> 
> More example:
> 
> ```shell
> config set rocksdb.write_buffer_size ALL num  
> # equivalent to `config set rocksdb.write_buffer_size num`
> # settings the buff_size for all of column families
> 
> config set rocksdb.write_buffer_size MAJOR num
> # for major colunm families include metadata and default
> 
> config set rocksdb.write_buffer_size MINOR num
> # for minor colunm families except for metadata and default
> 
> config set rocksdb.write_buffer_size [metadate | default | zset | pubsub | ... ] num
> # for specify column family
> ```

That's a good idea. However, here are two things that need to be considered:
- how to be compatible with old config files
- previously I try to make all config keys unique, since it will make the config part more intuitive and easy to process in the code level, especially for GET and REWRITE (I spent lots of time to rewrite code of the config part). But this design will break it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58Kk6b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2279,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584pFH,kvrocks,2095223111,2279,NA,PragmaTwice,20042607,Twice,,NA,2024-05-06T05:29:25Z,2024-05-06T05:29:25Z,"About the naming of column family:

AS IS:
```
0 default
1 metadata
2 zset score
3 pubsub
4 propagate
5 stream
6 search
```

TO BE:
```
0 primary subkeys
1 key metadata
2 secondary subkeys
3 pubsub
4 propagate
5 TBD (I don't know why stream should have a seperate cf)
6 search
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584pFH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2279,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584pqr,kvrocks,2095225515,2279,NA,PragmaTwice,20042607,Twice,,NA,2024-05-06T05:32:31Z,2024-05-06T05:32:31Z,"Also, we should have a better abstraction of the management of column families.

Currently it's too hard to maintain, and these adhoc logic about column families is written randomly in everywhere.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584pqr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2279,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584qB2,kvrocks,2095226998,2279,NA,PragmaTwice,20042607,Twice,,NA,2024-05-06T05:34:35Z,2024-05-06T05:34:35Z,"Since it seems very important, I'll add it into our roadmap. cc @mapleFU @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584qB2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2279,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM587THq,kvrocks,2095919594,2279,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-06T12:35:56Z,2024-05-06T12:35:56Z,"> Also, we should have a better abstraction of the management of column families.
> 
> Currently it's too hard to maintain, and these adhoc logic about column families is written randomly in everywhere.

Agreed, adding the new column family also will break the forward compatibility, we also need to address them while releasing.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM587THq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2283,https://api.github.com/repos/apache/kvrocks/issues/2283,kvrocks,2269548577,2283,Add support for Xcode,bijanMC,152354102,Bijan,,OPEN,2024-04-29T17:15:47Z,2024-07-08T02:53:15Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

In [CMakeLists.txt](https://github.com/apache/kvrocks/blob/1834ce81823fb5fa1442c24b9d7a84f950438124/CMakeLists.txt#L60), `if(CMAKE_GENERATOR STREQUAL ""Ninja"")` is applicable to Xcode as well.


### Solution

`if(CMAKE_GENERATOR STREQUAL Ninja OR CMAKE_GENERATOR STREQUAL Xcode)`

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2283/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2283,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58nQ9l,kvrocks,2090667877,2283,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-02T14:39:34Z,2024-05-02T14:39:34Z,@bijanMC Would you like to submit a PR to resolve this?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58nQ9l/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2284,https://api.github.com/repos/apache/kvrocks/issues/2284,kvrocks,2270310283,2284,Memory limits on connections,caipengbo,19643013,Myth,caipengbo@outlook.com,OPEN,2024-04-30T01:23:55Z,2024-06-11T01:40:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

The lack of memory constraints in current Kvrocks can lead to OOM, especially when deployed in container environments. 

### Solution

We should provide mechanisms to limit memory and avoid OOM. 

In the connection dimension:
- avoid large `WriteBatch`
- limit connection output buffer, support `client-output-buffer-limit` and `maxmemory-clients`

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2284/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2284,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-YxFk,kvrocks,2120421732,2284,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-05-20T13:03:50Z,2024-05-20T13:03:50Z,I am interested in this problem. Could you assign the issue to me?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-YxFk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2284,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-YyYQ,kvrocks,2120427024,2284,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-05-20T13:07:03Z,2024-05-20T13:07:03Z,"> I am interested in this problem. Could you assign the issue to me?

@AntiTopQuark Sure, go for it!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-YyYQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2284,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AoJAp,kvrocks,2158006313,2284,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-06-10T10:45:15Z,2024-06-10T10:45:15Z,"Hello @AntiTopQuark, I am also interested in this issue. When I implemented the Sort command before, there was a need for memory restrictions.
```
/// SORT_LENGTH_LIMIT limits the number of elements to be sorted
/// to avoid using too much memory and causing system crashes.
/// TODO: Expect to expand or eliminate SORT_LENGTH_LIMIT
/// through better mechanisms such as memory restriction logic.
constexpr uint64_t SORT_LENGTH_LIMIT = 512;
```

It seems that the current memory statistics of kvrocks are still coarse-grained process-level statistics. Do we need more fine-grained tracking statistics?
I've collected some references:
https://cwiki.apache.org/confluence/display/DORIS/DSIP-002%3A+Refactor+memory+tracker+on+BE
https://doris.apache.org/blog/Say-Goodbye-to-OOM-Crashes/
https://www.modb.pro/db/1798912145290776576

They seem to utilize the memory allocator to achieve this, would you like to share and discuss your thoughts?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AoJAp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2284,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AqZ07,kvrocks,2158599483,2284,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-06-10T15:00:15Z,2024-06-10T15:00:15Z,"> Hello @AntiTopQuark, I am also interested in this issue. When I implemented the Sort command before, there was a need for memory restrictions.
> 
> ```
> /// SORT_LENGTH_LIMIT limits the number of elements to be sorted
> /// to avoid using too much memory and causing system crashes.
> /// TODO: Expect to expand or eliminate SORT_LENGTH_LIMIT
> /// through better mechanisms such as memory restriction logic.
> constexpr uint64_t SORT_LENGTH_LIMIT = 512;
> ```
> 
> It seems that the current memory statistics of kvrocks are still coarse-grained process-level statistics. Do we need more fine-grained tracking statistics? I've collected some references: https://cwiki.apache.org/confluence/display/DORIS/DSIP-002%3A+Refactor+memory+tracker+on+BE https://doris.apache.org/blog/Say-Goodbye-to-OOM-Crashes/ https://www.modb.pro/db/1798912145290776576
> 
> They seem to utilize the memory allocator to achieve this, would you like to share and discuss your thoughts?

I briefly read through the three articles and found that most methods are quite similar. They all involve tracking the type, size, and frequency of allocations, as well as the stack at the time of allocation, to avoid OOM errors and to diagnose memory leaks. I am more familiar with the OceanBase database, which mainly implements a series of ObAllocator's `alloc` functions. These functions track the size and address of allocations (with address tracking enabled via a switch), and compare them against tenant-level memory limits to prevent OOM. If memory allocation fails, an error code is returned to the client. You can find more information at the following links:

[OceanBase Official Documentation](https://www.oceanbase.com/docs/common-oceanbase-database-cn-1000000000819454)
[OceanBase GitHub Code](https://github.com/oceanbase/oceanbase/blob/c51018527616b6da76674108d20bad8a7bff6431/deps/oblib/src/lib/alloc/ob_tenant_ctx_allocator.cpp#L424)

For the issue with kvrocks, I think it’s best to keep it simple. Implementing overrides for malloc and new to record the number of allocations and the amount of memory should suffice. Additionally, you can limit memory allocation using the max-memory configuration item and set a limit on the maximum number of connections.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AqZ07/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2284,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AuPuH,kvrocks,2159606663,2284,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-06-11T01:39:42Z,2024-06-11T01:39:42Z,"I prefer a simpler approach, count the size of the output buffer each time you put something into it. Of course, it's better to use a memory allocator.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AuPuH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2291,https://api.github.com/repos/apache/kvrocks/issues/2291,kvrocks,2279606573,2291,Enable the new data type encoding by default,PragmaTwice,20042607,Twice,,CLOSED,2024-05-05T16:16:30Z,2024-05-21T07:47:46Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

After many versions, it's safe to make new version by default.

### Solution

Set `ENABLE_NEW_ENCODING` to ON by default in cmake.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2291/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2291,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5922kh,kvrocks,2111531297,2291,NA,VasuDevrani,101383635,,,NA,2024-05-15T03:53:30Z,2024-05-15T03:53:30Z,"/assign
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5922kh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2291,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59253h,kvrocks,2111544801,2291,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-15T04:10:55Z,2024-05-15T04:10:55Z,"@VasuDevrani Assigned, thank you.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59253h/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2292,https://api.github.com/repos/apache/kvrocks/issues/2292,kvrocks,2279607579,2292,Introduce the key encoding version,PragmaTwice,20042607,Twice,,OPEN,2024-05-05T16:18:49Z,2024-05-15T09:43:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

The current key encoding has some historical legacy issues, and we need to adjust it through some means while ensuring compatibility. 

To do this, first we can persist a key encoding version in storage and read it during loading.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2292/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2292,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5926Xh,kvrocks,2111546849,2292,NA,VasuDevrani,101383635,,,NA,2024-05-15T04:13:31Z,2024-05-15T04:13:31Z,"I went through the codebase, can you confirm if i got it right? 
- the key encoding logic (encoding and decoding) is implemented in the `InternalKey` class 
- can be fixed by introducing a new variable for encoding version, a function to read it from storage during loading process, update `InternalKey` class to handle different versions","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5926Xh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2292,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM593NDA,kvrocks,2111623360,2292,NA,VasuDevrani,101383635,,,NA,2024-05-15T05:36:23Z,2024-05-15T05:36:23Z,/assign,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM593NDA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2292,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5941iy,kvrocks,2112051378,2292,NA,PragmaTwice,20042607,Twice,,NA,2024-05-15T09:43:37Z,2024-05-15T09:43:37Z,"> I went through the codebase, can you confirm if i got it right?
> 
> * the key encoding logic (encoding and decoding) is implemented in the `InternalKey` class
> * can be fixed by introducing a new variable for encoding version, a function to read it from storage during loading process, update `InternalKey` class to handle different versions

Yeah you are right.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5941iy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2293,https://api.github.com/repos/apache/kvrocks/issues/2293,kvrocks,2279609222,2293,Make the default namepace name changable,PragmaTwice,20042607,Twice,,OPEN,2024-05-05T16:23:05Z,2024-05-06T06:53:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

It should be changable, as other namespaces.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2293/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2293,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584sig,kvrocks,2095237280,2293,NA,13015517713,54363053,detached,,NA,2024-05-06T05:47:30Z,2024-05-06T05:47:30Z,"I have learned kvrocks for some time. I have the will to implement that (or have a try).
There are two questions.
1. Current namespace name is not modifiable, token can be modified by function(namespace set). Does changable 'name' refer to token?
2. Default namespace is a literal value. How to make it modifiable, is it through config file ?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584sig/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2293,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584v10,kvrocks,2095250804,2293,NA,PragmaTwice,20042607,Twice,,NA,2024-05-06T06:02:48Z,2024-05-06T06:02:48Z,"Yeah, IIRC it's currently something like `__namespace`, but I think it's better to be changable.

I don't know which one is better: store in rocksdb or in the config file.

cc @mapleFU @git-hulk do you have any idea?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584v10/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2293,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584wHA,kvrocks,2095251904,2293,NA,PragmaTwice,20042607,Twice,,NA,2024-05-06T06:03:51Z,2024-05-06T06:03:51Z,"Also another big issue is to be compatible to old version: users can use new version of kvrocks with their old data, and they want these old data can work well.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584wHA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2293,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584zyc,kvrocks,2095266972,2293,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-06T06:18:30Z,2024-05-06T06:18:30Z,"@PragmaTwice I'm not quite sure why we want to make it changeable. If for the space overhead consideration, it shouldn't take much more than the shorter one since the rocksdb has internal compression for the common prefix.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM584zyc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2293,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5841t4,kvrocks,2095274872,2293,NA,PragmaTwice,20042607,Twice,,NA,2024-05-06T06:25:52Z,2024-05-06T06:25:52Z,"Because I believe the default namespace should have the same status as other namespaces.
Currently, in kvrocks, the default namespace is a very special namespace, and admins cannot switch the default namespace to another one. This has some significant drawbacks, such as certain admin operations can only be performed in the default namespace.
I think this is a **design flaw** in kvrocks, and correcting it would require some cost at present.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5841t4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2293,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58421B,kvrocks,2095279425,2293,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-06T06:30:15Z,2024-05-06T06:30:15Z,"Just curious why it should be changable? Is there any reason for that?

> Because I believe the default namespace should have the same status as other namespaces.

It's a good reason but I think we have too many legacy user and perhaps this means maintaining two parts of code?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM58421B/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2293,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5844Vx,kvrocks,2095285617,2293,NA,PragmaTwice,20042607,Twice,,NA,2024-05-06T06:35:25Z,2024-05-06T06:35:25Z,"If there is a good solution, we can avoid maintenance difficulties and correct this problem. (But TBH, design errors in the early stage will lead to unbearable costs, and everyone should understand this truth.) 

Perhaps it's time for us to reconsider the authentication and permission management in kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5844Vx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2293,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5849IR,kvrocks,2095305233,2293,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-06T06:52:00Z,2024-05-06T06:52:00Z,"> Currently, in kvrocks, the default namespace is a very special namespace, and admins cannot switch the default namespace to another one. This has some significant drawbacks, such as certain admin operations can only be performed in the default namespace.

We can achieve this by supporting the switch namespace API? The initial design didn't expect the admin to change data of other namespaces except to maintain the namespace/token pair itself. And I do agree the default namespace is very special, but it's to align with the Redis authentication way. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5849IR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2294,https://api.github.com/repos/apache/kvrocks/issues/2294,kvrocks,2280074513,2294,Move the performance benchmark to website,PragmaTwice,20042607,Twice,,CLOSED,2024-05-06T05:40:42Z,2024-05-30T05:24:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

It does not need to be shown in README. Just a link is enough.

Also, if there's no reproduce script for it, I think we can just delete them.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2294/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2294,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_ILnq,kvrocks,2132851178,2294,NA,suxb201,16659368,suxb201,suxb201@gmail.com,NA,2024-05-27T07:44:15Z,2024-05-27T07:44:15Z,"@git-hulk I couldn't find the benchmark on the website, even though you've removed it from the README.md.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_ILnq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2294,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_IR2d,kvrocks,2132876701,2294,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-27T07:58:17Z,2024-05-27T07:58:17Z,"@suxb201 Yes, the reason is the benchmark result cannot be reproduced by users, so remove it first to avoid confusing users.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_IR2d/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2294,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_egaR,kvrocks,2138703505,2294,NA,PragmaTwice,20042607,Twice,,NA,2024-05-30T05:21:12Z,2024-05-30T05:21:12Z,"It is not because the current performance is lower than the benchmark result, just we cannot find the benchmark script, so we decide to remove it.

We can add a reproducible benchmark script and also a benchmark post to our website later.

Anyway welcome to do benchmark by yourself and share with us. @suxb201 ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_egaR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2295,https://api.github.com/repos/apache/kvrocks/issues/2295,kvrocks,2280079280,2295,Optimize the implementation of IntervalSet intersection,PragmaTwice,20042607,Twice,,CLOSED,2024-05-06T05:45:04Z,2024-05-27T14:00:03Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/apache/kvrocks/blob/82f03ca5edc6640a46a8f26d63ceb9385f30f744/src/search/interval.h#L130

We can optimize this function since the implementation here uses just De Morgan's laws, not very efficient.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2295/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2295,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59AKa5,kvrocks,2097194681,2295,NA,13015517713,54363053,detached,,NA,2024-05-07T01:26:57Z,2024-05-07T01:26:57Z,"I'll do this, and will propose a solution later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59AKa5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2295,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_K1oo,kvrocks,2133547560,2295,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-27T14:00:03Z,2024-05-27T14:00:03Z,Closed by https://github.com/apache/kvrocks/pull/2300,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_K1oo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2297,https://api.github.com/repos/apache/kvrocks/issues/2297,kvrocks,2282335496,2297,[Build] Add supports for build kvrocks with UBSAN,mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2024-05-07T05:47:47Z,2024-05-07T05:47:47Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Sanitizer is widely used in systems. Currently kvrocks has ASAN and TSAN supports. And now kvrocks may has UB in https://github.com/apache/kvrocks/issues/2261 . So, I think we should add a build support for ubsan. We can enable UBSAN in CI after cleaning all the issues

### Solution

Add UBSAN support in build script

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2297/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2301,https://api.github.com/repos/apache/kvrocks/issues/2301,kvrocks,2283754134,2301,[Tools] Add a git commit hook for clang-format checking,mapleFU,24351052,mwish,maplewish117@gmail.com,CLOSED,2024-05-07T16:15:47Z,2024-06-14T08:58:03Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently our ci checks clang-format. We can add a checking in git hook for that.

### Solution

Aadd a checking in git hook for format

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2301/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59I8Sy,kvrocks,2099496114,2301,NA,JoverZhang,38241684,Jover,joverzh@gmail.com,NA,2024-05-08T00:01:10Z,2024-05-08T00:01:10Z,"I guess we could hard link `pre-push.sh` to `.git/hooks/pre-push` during `x.py build`.

For example:

https://github.com/rust-lang/rust/blob/faefc618cf48bd794cbc808448df1bf3f59f36af/src/bootstrap/src/core/build_steps/setup.rs#L511-L522

However, I'm unsure about the directory in the project where the `pre-push.sh` source code should be placed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59I8Sy/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59L1Sv,kvrocks,2100253871,2301,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-08T10:22:43Z,2024-05-08T10:22:43Z,"If convenient, you can add other checks at the same time, such as golang format, clang tidy","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59L1Sv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59hh2G,kvrocks,2105941382,2301,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-11T16:04:01Z,2024-05-11T16:04:01Z,"> However, I'm unsure about the directory in the project where the pre-push.sh source code should be placed.

At root or some build scripts might be ok

> clang tidy

clang-tidy is time-consuming, I guess puting it at ci or by-user is better
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59hh2G/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2301,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Agwmh,kvrocks,2156071329,2301,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-06-08T15:11:49Z,2024-06-08T15:11:49Z,/assign,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Agwmh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/2302,kvrocks,2284386975,2302,Add option to INFO to return a json payload,ltagliamonte-dd,51684360,Luigi Tagliamonte,,OPEN,2024-05-07T23:28:13Z,2024-07-08T02:52:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

try to monitor some specs from my service and would be better to be able to consume them in a format that's easier to consume rather than parsing strings like the kvrocks_exporter does.

### Solution

would be nice to expose somenthing like:
``` INFO `section` JSON/TXT```

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2302/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5923qo,kvrocks,2111535784,2302,NA,VasuDevrani,101383635,,,NA,2024-05-15T03:59:31Z,2024-05-15T03:59:31Z,do we want INFO command to return output in json fomat when `INFO JSON` (JSON specified in command) otherwise plain text?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5923qo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM594064,kvrocks,2112048824,2302,NA,PragmaTwice,20042607,Twice,,NA,2024-05-15T09:42:18Z,2024-05-15T09:42:18Z,"I think for compatibility, it should be `INFO [<section_name>] [FORMAT (TXT | JSON)]`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM594064/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-R_2v,kvrocks,2118647215,2302,NA,VasuDevrani,101383635,,,NA,2024-05-18T05:23:26Z,2024-05-18T05:23:26Z,"im struggling with parsing the output to json,[ this line of ](https://github.com/VasuDevrani/kvrocks/blob/unstable/src/server/server.cc?plain=1#L1188) code outputs string which looks like

`""# Clients\r\nmaxclients:10000\r\nconnected_clients:1\r\nmonitor_clients:0\r\nblocked_clients:0\r\n""`

using `jsoncons::json::parse` throws ser_error (unsupported format) and I should not directly append the string as is to the json.

should i create a custom parsing function to convert it something like?
`{""clients"":{""blocked_clients"":""0\r"",""connected_clients"":""1\r"",""maxclients"":""10000\r"",""monitor_clients"":""0\r""}}
`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-R_2v/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SDSD,kvrocks,2118661251,2302,NA,PragmaTwice,20042607,Twice,,NA,2024-05-18T06:23:43Z,2024-05-18T06:23:43Z,TBH I cannot get your point. Why do you want to parse it as JSON? It's just not JSON.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SDSD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SDtW,kvrocks,2118662998,2302,NA,VasuDevrani,101383635,,,NA,2024-05-18T06:31:15Z,2024-05-18T06:31:15Z,"> TBH I cannot get your point. Why do you want to parse it as JSON? It's just not JSON.

Maybe i misunderstood, please confirm. 

The issue wants the support of commands `INFO [<section_name>] [FORMAT (TXT | JSON)]`:

`INFO`: returns info in default plain text format.
`INFO <section>`: section info in plain text format.
`INFO all FORMAT JSON`: returns the entire info in JSON format.
`INFO <section> FORMAT JSON`: returns just section info in JSON.
`INFO <section> FORMAT TXT`: section info in plain text format.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SDtW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SFAB,kvrocks,2118668289,2302,NA,PragmaTwice,20042607,Twice,,NA,2024-05-18T06:54:52Z,2024-05-18T06:54:52Z,"Yeah, and you don't need to parse anything for implementing such behavior.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SFAB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SGSi,kvrocks,2118673570,2302,NA,VasuDevrani,101383635,,,NA,2024-05-18T07:14:23Z,2024-05-18T07:14:23Z,"> Yeah, and you don't need to parse anything for implementing such behavior.

so is this approach not desirable
https://github.com/apache/kvrocks/compare/unstable...VasuDevrani:kvrocks:init_INFO","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SGSi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SGeh,kvrocks,2118674337,2302,NA,PragmaTwice,20042607,Twice,,NA,2024-05-18T07:17:42Z,2024-05-18T07:17:42Z,"> > Yeah, and you don't need to parse anything for implementing such behavior.
> 
> so is this approach not desirable [unstable...VasuDevrani:kvrocks:init_INFO](https://github.com/apache/kvrocks/compare/unstable...VasuDevrani:kvrocks:init_INFO)

Yeah, it looks a bit ugly. We can have a more intuitive design for this feature.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SGeh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SH0Y,kvrocks,2118679832,2302,NA,VasuDevrani,101383635,,,NA,2024-05-18T07:38:44Z,2024-05-18T07:38:44Z,"> Yeah, it looks a bit ugly. We can have a more intuitive design for this feature.

i feel confused about the more intuitive design 
is this close to that https://github.com/apache/kvrocks/commit/292bdbe7d36f54ada89623006c1597cb74eed3ef?
otherwise its out of scope for me (at least for now, will have to wait for someone else's PR or if someone can guide me around the better approach).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SH0Y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SJ_k,kvrocks,2118688740,2302,NA,PragmaTwice,20042607,Twice,,NA,2024-05-18T08:12:18Z,2024-05-18T08:12:18Z,"> > Yeah, it looks a bit ugly. We can have a more intuitive design for this feature.
> 
> i feel confused about the more intuitive design is this close to that [292bdbe](https://github.com/apache/kvrocks/commit/292bdbe7d36f54ada89623006c1597cb74eed3ef)? otherwise its out of scope for me (at least for now, will have to wait for someone else's PR or if someone can guide me around the better approach).

https://github.com/apache/kvrocks/blob/292bdbe7d36f54ada89623006c1597cb74eed3ef/src/server/server.cc#L1211-L1229


I hope you can notice that there is a lot of repetition in your code between if and else, we should avoid this [copy-and-paste programming](https://en.wikipedia.org/wiki/Copy-and-paste_programming). For me, preventing such code from entering kvrocks codebase is my top priority.

In fact, we can see that the result returned by INFO is a format similar to 
```
std::map<SectionNameTy, std::map<KeyTy, ValueTy>>
(where ValueTy = something like std::variant<int, std::string>)
```
So we can return this format and transform it into JSON or TEXT at the end.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SJ_k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SKzf,kvrocks,2118692063,2302,NA,PragmaTwice,20042607,Twice,,NA,2024-05-18T08:25:14Z,2024-05-18T08:25:14Z,"In details, we can have such small functions, like:
```
auto GetPersistenceInfo() -> std::map<KeyTy, ValueTy>;
auto GetServerInfo() -> std::map<KeyTy, ValueTy>;
auto GetPWhateverInfo() -> std::map<KeyTy, ValueTy>;
```

And then at the function that can generate all info (not real C++ code):
```
std::map<..> func_map = {{""persistence"", GetPersistenceInfo}, ...}

auto all_info = func_map.filter(selected_info_sections).map(x -> x.call())

if (JSON) generateJsonOutput(all_info)
else (TXT) generateTxtOutput(all_info)
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-SKzf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-deVB,kvrocks,2121655617,2302,NA,VasuDevrani,101383635,,,NA,2024-05-21T03:29:10Z,2024-05-21T03:29:10Z,"> ```
> auto GetPersistenceInfo() -> std::map<KeyTy, ValueTy>;
> auto GetServerInfo() -> std::map<KeyTy, ValueTy>;
> auto GetPWhateverInfo() -> std::map<KeyTy, ValueTy>;
> ```
we already does have some function like [GetServerInfo](https://github.com/apache/kvrocks/blob/acddc28de42ca41d64feea78691d877a2297932c/src/server/server.cc#L939) that uses string stream and returns string, should i overwrite them to return `std::map<KeyTy, ValueTy>`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-deVB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2302,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-fQXr,kvrocks,2122122731,2302,NA,PragmaTwice,20042607,Twice,,NA,2024-05-21T08:58:08Z,2024-05-21T08:58:08Z,"> > ```
> > auto GetPersistenceInfo() -> std::map<KeyTy, ValueTy>;
> > auto GetServerInfo() -> std::map<KeyTy, ValueTy>;
> > auto GetPWhateverInfo() -> std::map<KeyTy, ValueTy>;
> > ```
> 
> we already does have some function like [GetServerInfo](https://github.com/apache/kvrocks/blob/acddc28de42ca41d64feea78691d877a2297932c/src/server/server.cc#L939) that uses string stream and returns string, should i overwrite them to return `std::map<KeyTy, ValueTy>`

Yeah you can update these methods.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-fQXr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2305,https://api.github.com/repos/apache/kvrocks/issues/2305,kvrocks,2289908994,2305,should we start the compaction_checker_range thread if it's not configed. ,13015517713,54363053,detached,,OPEN,2024-05-10T15:04:17Z,2024-05-10T15:27:00Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

When running Server.start(), kvrocks will launch a thread for compaction check. Some considerations are as follows.

-  If there is no checker configured, maybe it is no need to start the thread to check frequently. Only if it is enabled, then create the thread.

- The checker for pubsubfiles is independent of the configuration of the normal checker (the code is like this). If there is no configured checker, kvrocks also should do compression for pubsub.  (not sure I understand that correctly.)

Corresponding code block is in server.cc, Server().Start().
```
compaction_checker_thread_ = GET_OR_RET(util::CreateThread(""compact-check"", [this] {
    uint64_t counter = 0;
    int64_t last_compact_date = 0;
    CompactionChecker compaction_checker{this->storage};

    while (!stop_) {
      // Sleep first
      std::this_thread::sleep_for(std::chrono::milliseconds(100));

      // To guarantee accessing DB safely
      auto guard = storage->ReadLockGuard();
      if (storage->IsClosing()) continue;

      if (!is_loading_ && ++counter % 600 == 0  // check every minute
          && config_->compaction_checker_range.Enabled()) {
        auto now_hours = util::GetTimeStamp<std::chrono::hours>();
        if (now_hours >= config_->compaction_checker_range.start &&
            now_hours <= config_->compaction_checker_range.stop) {
          std::vector<std::string> cf_names = {engine::kMetadataColumnFamilyName, engine::kSubkeyColumnFamilyName,
                                               engine::kZSetScoreColumnFamilyName, engine::kStreamColumnFamilyName};
          for (const auto &cf_name : cf_names) {
            compaction_checker.PickCompactionFiles(cf_name);
          }
        }
        // compact once per day
        if (now_hours != 0 && last_compact_date != now_hours / 24) {
          last_compact_date = now_hours / 24;
          compaction_checker.CompactPropagateAndPubSubFiles();
        }
      }
    }
  }));
```

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2305/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59dHl7,kvrocks,2104785275,2305,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-10T15:13:26Z,2024-05-10T15:13:26Z,@13015517713 Thanks for bringing up this discussion. It's unnecessary to check if disabled since the compaction will be totally depended on the rocksdb.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59dHl7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59dLMR,kvrocks,2104800017,2305,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-10T15:23:09Z,2024-05-10T15:23:09Z,"The range isn't read-only, and the thread is not so high-cost. I think it's ok to not dynamically enable it. But if we can have a timer task system, it would also be ok to execute the check in the timer rather than a separate thread","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59dLMR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2305,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59dMmc,kvrocks,2104805788,2305,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-10T15:26:58Z,2024-05-10T15:26:58Z,"Yes, it's good to leave as it is to keep the codes simple.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59dMmc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2306,https://api.github.com/repos/apache/kvrocks/issues/2306,kvrocks,2290655121,2306,TLS test case seems broken,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-05-11T04:20:25Z,2024-05-11T05:24:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/actions/runs/9034493416/job/24827662718?pr=2300#step:16:57

### What did you expect to see?

CI passed

### What did you see instead?

It's broken now.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2306/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/2310,kvrocks,2295670753,2310,Improve consistency and isolation semantics by adding Context parameter to DB API,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,CLOSED,2024-05-14T14:38:41Z,2024-08-24T12:10:57Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

The current DB API may use multiple read operations or have nested calls. These read operations do not use fixed snapshots, which may cause different snapshot data to be read during a single operation, causing inconsistency.


### Solution

Referring to the current LatestSnapshot and GetOptions, we can add a Context parameter to each DB API, through which the API can pass a definite snapshot.

After a few simple attempts, I found that changes often have a ripple effect, requiring multiple modules to change their APIs at the same time, which can result in a huge PR that is difficult to break down into multiple smaller PRs. I'm going to try to give a draft PR in the near future to get a rough idea of what to do, and then gradually refine the changes to each module.



### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2310/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-BL9l,kvrocks,2114240357,2310,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-16T07:13:09Z,2024-05-16T07:13:09Z,"Need some help:

```
struct Context {
  explicit Context(engine::Storage *storage) : storage_(storage), snapshot_(storage->GetDB()->GetSnapshot()) {}

  engine::Storage *storage_ = nullptr;
  const rocksdb::Snapshot *snapshot_ = nullptr;
  rocksdb::WriteBatchWithIndex* batch_ = nullptr;

  Context() = default;
  rocksdb::ReadOptions GetReadOptions();
  const rocksdb::Snapshot *GetSnapShot();
};
```
This is the general idea: pass in the `Context` to the Database API, use a fixed snapshot when calling, and this snapshot **will not change during the entire calling process**. When we need to read our own data for the current operation, we use `WriteBatchWithIndex` + `GetFromBatchAndDB` to obtain the data batch=>db(snapshot=ctx.snapshot).

Most operations nowadays use WriteBatch. Is there any way to copy the operation sequence from `WriteBatch` to `ctx.WriteBatchWithIndex`? In this way, I only need to modify the last `Write` part of storage, instead of modifying `ctx.WriteBatchWithIndex` when the DB API modifies `WriteBatch`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-BL9l/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-BO7G,kvrocks,2114252486,2310,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-16T07:20:43Z,2024-05-16T07:20:43Z,"> Most operations nowadays use WriteBatch. Is there any way to copy the operation sequence from WriteBatch to ctx.WriteBatchWithIndex? In this way, I only need to modify the last Write part of storage, instead of modifying ctx.WriteBatchWithIndex when the DB API modifies WriteBatch.

`rocksdb` has the relation below:

```
WriteBatchBase
WriteBatchWithIndex : WriteBatchBase
WriteBatch : WriteBatchBase
```

Should we switch to `WriteBatchBase` in some place? Besides, `WriteBatchWithIndex` has a `WriteBatch* GetWriteBatch() override;` interface here","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-BO7G/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-BRk3,kvrocks,2114263351,2310,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-16T07:24:28Z,2024-05-16T07:24:28Z,"> Need some help:
> 
> ```
> struct Context {
>   explicit Context(engine::Storage *storage) : storage_(storage), snapshot_(storage->GetDB()->GetSnapshot()) {}
> 
>   engine::Storage *storage_ = nullptr;
>   const rocksdb::Snapshot *snapshot_ = nullptr;
>   rocksdb::WriteBatchWithIndex* batch_ = nullptr;
> 
>   Context() = default;
>   rocksdb::ReadOptions GetReadOptions();
>   const rocksdb::Snapshot *GetSnapShot();
> };
> ```
> 
> This is the general idea: pass in the `Context` to the Database API, use a fixed snapshot when calling, and this snapshot **will not change during the entire calling process**. When we need to read our own data for the current operation, we use `WriteBatchWithIndex` + `GetFromBatchAndDB` to obtain the data batch=>db(snapshot=ctx.snapshot).
> 
> Most operations nowadays use WriteBatch. Is there any way to copy the operation sequence from `WriteBatch` to `ctx.WriteBatchWithIndex`? In this way, I only need to modify the last `Write` part of storage, instead of modifying `ctx.WriteBatchWithIndex` when the DB API modifies `WriteBatch`.


Correction: Because there may be multiple Writes, they should be appended to ctx.WriteBatchWithIndex instead of simply copied","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-BRk3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-C53o,kvrocks,2114690536,2310,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-16T09:30:21Z,2024-05-16T09:30:21Z,"@PokIsemaine I've checked that most output uses `GetWriteBatch` with a `WriteBatchBase`, would that ok for the scenerio here?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-C53o/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-R6t4,kvrocks,2118626168,2310,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-18T03:52:42Z,2024-05-18T03:52:42Z,"I think there are currently two ways:
1. Keep the current WriteBatch, then use WriteBatch.Iterator(&handler) when writing, and refer to `batch_debugger.h` to write a `WriteBatch::Handler` that appends WriteBatch operations to WriteBatchWithIndex one by one.
2. Get WriteBatchWithIndex in GetWriteBatchBase, but I found that WriteBatchWithIndex cannot support all operations of WriteBatch, such as DeleteRange. Even after using WriteBatchWithIndex::GetWriteBatch after DeleteRange, we cannot index the effect of DeleteRange in Batch through GetFromBatchAndDB.

For the DeleteRange operation, maybe we need to switch to for + Delete, but I don't know if this will have a big performance impact. If it is the first type, we just add Batch but do not perform Write operation, what will happen?

我认为目前两种方式：
1. 保留现在的 WriteBatch，然后在 Write 的时候使用 WriteBatch.Iterator(&handler), 并参考 `batch_debugger.h` 的方式编写一个将 WriteBatch 操作逐个追加到 WriteBatchWithIndex 的 `WriteBatch::Handler`。
2. GetWriteBatchBase 中改为获取 WriteBatchWithIndex，但是我发现 WriteBatchWithIndex 并不能支持 WriteBatch 的所有操作，例如 DeleteRange。即使使用 WriteBatchWithIndex::GetWriteBatch 后 DeleteRange，我们并不能通过 GetFromBatchAndDB 在 Batch 中索引到 DeleteRange 的效果。

对于 DeleteRange 操作，或许我们需要转为 for + Delete 的方式，但我不清楚这样是否会有很大的性能影响。如果是第一种，我们只是加入 Batch 但不进行 Write 操作，这样又会怎么样。","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-R6t4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-R6-E,kvrocks,2118627204,2310,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-18T03:58:12Z,2024-05-18T03:58:12Z,"Some other questions:
1. What isolation level can we expect if kvrocks requests are processed by multiple threads without using transactions? Serializable, snapshot isolation, or something else?
2. What resources are specifically protected by LockGuard for write operations?

另外的一些疑问：
1. 如果不使用事务，多线程处理 kvrocks 请求，我们期望什么样的隔离级别？可串行化、快照隔离还是其他的情况？
2. 写操作的 LockGuard 具体保护的资源是什么？","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-R6-E/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-R-gw,kvrocks,2118641712,2310,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-18T05:00:16Z,2024-05-18T05:00:16Z,"(2) LockGuard protect the ""keys"" for operation. During writing, it first collects the key it tents to write, and Lock the all keys we would like to write

(1) Is a interesting problem, I think we're looking forward to a SI ( snapshot isolation ). This cannot avoid concurrency read-modify-write sequence to same key. And it would making single write or multiple write operations seeing the same snapshot ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-R-gw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vAuQ,kvrocks,2126252944,2310,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-23T05:17:39Z,2024-05-23T05:17:39Z,"> For the DeleteRange operation, maybe we need to switch to for + Delete, but I don't know if this will have a big performance impact. If it is the first type, we just add Batch but do not perform Write operation, what will happen?

This should be unacceptable for the performance consideration. For example, it might cause the Kvrocks stop to service if it runs the FLUSH[DB|ALL] command with a large number of keys in the DB. To mitigate this, it'd be better to disallow using the DeleteRange operation in the transaction if necessary.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vAuQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vBMT,kvrocks,2126254867,2310,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-23T05:19:44Z,2024-05-23T05:19:44Z,"I also think maybe we should checkout how we use `DeleteRange`. It can always be a performance hack since it's a ""hack"" in implementation","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vBMT/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vDCr,kvrocks,2126262443,2310,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-23T05:28:14Z,2024-05-23T05:28:14Z,"> > For the DeleteRange operation, maybe we need to switch to for + Delete, but I don't know if this will have a big performance impact. If it is the first type, we just add Batch but do not perform Write operation, what will happen?
> 
> This should be unacceptable for the performance consideration. For example, it might cause the Kvrocker stop to service if it runs the FLUSH[DB|ALL] command with a large number of keys in the DB. To mitigate this, it'd be better to disallow using the DeleteRange operation in the transaction if necessary.

Does this impact occur when `db_->Write` is executed? What if I just use WriteBatchWithIndex to log the operations performed but don't do a `Write` ?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vDCr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vD2j,kvrocks,2126265763,2310,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-23T05:31:23Z,2024-05-23T05:31:23Z,"https://github.com/facebook/rocksdb/wiki/DeleteRange-Implementation

To be short DeleteRange write a explicit ""range"" tombstone, and this would affect scan, read, compaction...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vD2j/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vFbV,kvrocks,2126272213,2310,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-23T05:37:38Z,2024-05-23T05:37:38Z,"> I also think maybe we should checkout how we use `DeleteRange`. It can always be a performance hack since it's a ""hack"" in implementation

Currently it mainly affects kvrocks2redis, rdb and some test cases.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vFbV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vHoo,kvrocks,2126281256,2310,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-23T05:45:13Z,2024-05-23T05:45:13Z,"Progress synchronization:
> 1. Keep the current WriteBatch, then use WriteBatch.Iterator(&handler) when writing, and refer to batch_debugger.h to write a WriteBatch::Handler that appends WriteBatch operations to WriteBatchWithIndex one by one.

I'm trying the first option but currently in a specific version of GitHub Action, the golang test times out and I'm currently troubleshooting why.
https://github.com/apache/kvrocks/compare/unstable...PokIsemaine:kvrocks:unstable

![image](https://github.com/apache/kvrocks/assets/46661603/98b76edf-9a5a-499f-86d9-7150de56eb1a)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vHoo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vIo5,kvrocks,2126285369,2310,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-23T05:48:50Z,2024-05-23T05:48:50Z,"@PokIsemaine I'm sorry for didn't quite understand why we need to care about the WriteBatch. From the issue description, what we want to solve is that may use the undetermined snapshot while reading with nested read operations? If yes, passing the snapshot via the context is a good solution.

For the write operation and transaction mode, the lock of the key should be able to protect the corresponding key won't be changed, so it should be good to leave it as it is. 

Help to correct me if I missed anything.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vIo5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vJ1w,kvrocks,2126290288,2310,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-23T05:54:00Z,2024-05-23T05:54:00Z,"> I'm sorry for didn't quite understand why we need to care about the WriteBatch. From the issue description, what we want to solve is that may use the undetermined snapshot while reading with nested read operations? If yes, passing the snapshot via the context is a good solution.

The main-issue is framework-level read-after-write. I like a command issues a write and read after it. It's hard to ensure read ""own-workspace"" after this command may writing some data","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vJ1w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vLdc,kvrocks,2126296924,2310,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-23T06:00:31Z,2024-05-23T06:00:31Z,"I see, thank you. But I can't remember if any commands will write-then-read except the Lua and transaction.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vLdc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vLw1,kvrocks,2126298165,2310,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-23T06:01:37Z,2024-05-23T06:01:37Z,"@git-hulk @PokIsemaine I think currently we can first reject ""DeleteRange"" and check out other command works?

IMO DeleteRange is mostly used in background. Maybe I can recheck the logic use ""DeleteRange"" in commands","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vLw1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vNby,kvrocks,2126305010,2310,NA,PragmaTwice,20042607,Twice,,NA,2024-05-23T06:07:33Z,2024-05-23T06:07:33Z,"Yeah the current conversation goes beyond the issue title. I think it's related to this project: https://summer-ospp.ac.cn/org/prodetail/249430512?lang=en&list=pro
We can have separate issues for it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-vNby/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_BGFH,kvrocks,2130993479,2310,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-25T07:07:11Z,2024-05-25T07:07:11Z,"> Yeah the current conversation goes beyond the issue title. I think it's related to this project: https://summer-ospp.ac.cn/org/prodetail/249430512?lang=en&list=pro We can have separate issues for it.

Yes, we are discussing this project. I tried changing the title of this issue and grouping it into a new OSPP Tracking issues.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_BGFH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Jlvdm,kvrocks,2308372326,2310,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-08-24T12:08:09Z,2024-08-24T12:08:09Z,Well done!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Jlvdm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2310,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Jlvtq,kvrocks,2308373354,2310,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-24T12:10:56Z,2024-08-24T12:10:56Z,Well done!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Jlvtq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/2312,kvrocks,2296936265,2312,Improve error handling and logging for Retryable IO Errors ,VasuDevrani,101383635,,,CLOSED,2024-05-15T06:01:02Z,2024-05-17T11:34:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

In [server.cc](https://github.com/apache/kvrocks/blob/unstable/src/server/server.cc) file, the code checks every minute if the storage is in a retryable IO error state and resumes the database if necessary.
```c
 if (counter != 0 && counter % 600 == 0 && storage->IsDBInRetryableIOError()) {
    storage->GetDB()->Resume();
    LOG(INFO) << ""[server] Schedule to resume DB after retryable IO error"";
    storage->SetDBInRetryableIOError(false);
  }
```
Concerns:
1. The code resumes the database and sets the retryable IO error state to false without checking if the resume operation itself succeeded. 
2. logs INFO message which may be ERROR or WARNING instead

### Solution

example code to resolve this:
```c
if (counter != 0 && counter % 600 == 0 && storage->IsDBInRetryableIOError()) {
  auto status = storage->GetDB()->Resume();
  if (status.ok()) {
    LOG(WARNING) << ""[server] Successfully resumed DB after retryable IO error: "" << status.ToString();
    storage->SetDBInRetryableIOError(false);
  } else {
    LOG(ERROR) << ""[server] Failed to resume DB after retryable IO error: "" << status.ToString();
    // Additional error handling, such as retrying or notifying the administrator
  }
}
```

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2312/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM593aAS,kvrocks,2111676434,2312,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-15T06:25:14Z,2024-05-15T06:25:14Z,"@VasuDevrani Looks good, you can go ahead to improve this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM593aAS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM595Qea,kvrocks,2112161690,2312,NA,VasuDevrani,101383635,,,NA,2024-05-15T10:38:32Z,2024-05-15T10:38:32Z,"> @VasuDevrani Looks good, you can go ahead to improve this.

See, the code proposed as solution just prints ERROR in else block.
How about we add a set number of retry for resuming DB operation in case of failure, and if it still fails after retries, then we log a CRITICAL error finally.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM595Qea/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM595WKL,kvrocks,2112184971,2312,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-15T10:52:07Z,2024-05-15T10:52:07Z,I'm wondering if it's a good idea to do that. I prefer letting users determine whether to terminate themself instead of by default N times retry. @PragmaTwice @caipengbo @torwig What do you think?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM595WKL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM595d2y,kvrocks,2112216498,2312,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-05-15T11:03:22Z,2024-05-15T11:03:22Z,"Yes, I also don't think it's necessary to set a number of retries. Alternatively, we could provide a `RESUME` command, which would give administrators more options.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM595d2y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5956A0,kvrocks,2112331828,2312,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-15T11:55:33Z,2024-05-15T11:55:33Z,"Out-of curiousity, do we have ability to recovery from error if `Resume()` failed for one-times? Seems we can only recover from merely case like Compaction output error or flush error?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5956A0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM596AUE,kvrocks,2112357636,2312,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-05-15T12:08:57Z,2024-05-15T12:08:57Z,"> do we have ability to recovery from error if Resume() failed for one-times?

There might be some cases (disk no space?) where it needs to be done externally for the `Resume()` to succeed.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM596AUE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM596O0D,kvrocks,2112417027,2312,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-15T12:40:37Z,2024-05-15T12:40:37Z,"Thats a good point, so we should let user decide what to do during this case...","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM596O0D/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59_mHG,kvrocks,2113823174,2312,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-16T02:04:50Z,2024-05-16T02:04:50Z,"@VasuDevrani As discussed above, improving the logging message is good, but don't expect to escalate the FATAL error after N time tries. What do you think?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59_mHG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59_qw9,kvrocks,2113842237,2312,NA,VasuDevrani,101383635,,,NA,2024-05-16T02:12:41Z,2024-05-16T02:12:41Z,"> @VasuDevrani As discussed above, improving the logging message is good, but don't expect to escalate the FATAL error after N time tries. What do you think?

Yeah I've considered above conversation. I'm learning a bit more about Kvrocks, its internals. will update here with my thoughts after a while. Thanks for following up.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59_qw9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59_1DC,kvrocks,2113884354,2312,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-16T02:21:42Z,2024-05-16T02:21:42Z,"@VasuDevrani Cool, don't hesitate to raise if you have any ideas.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM59_1DC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-E8HA,kvrocks,2115224000,2312,NA,VasuDevrani,101383635,,,NA,2024-05-16T13:17:47Z,2024-05-16T13:17:47Z,"> @VasuDevrani As discussed above, improving the logging message is good, but don't expect to escalate the FATAL error after N time tries. What do you think?

I agree with just improving the logging message for now. (should i make continue with a PR?)

> @VasuDevrani Cool, don't hesitate to raise if you have any ideas.

Later, if need arise  we can go with idea of having `RESUME` command for admins as suggested by @caipengbo 
or, we can add a configuration option for `max_number_of_retry` for this operation ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-E8HA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-E9tG,kvrocks,2115230534,2312,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-16T13:20:43Z,2024-05-16T13:20:43Z,"> I agree with just improving the logging message for now. (should i make continue with a PR?)

Sure, you can continue improving the logging message.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-E9tG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2312,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-FAo6,kvrocks,2115242554,2312,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-05-16T13:25:40Z,2024-05-16T13:25:40Z,"> I agree with just improving the logging message for now. (should i make continue with a PR?)

Yes, RESUME is not a high priority.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5-FAo6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2314,https://api.github.com/repos/apache/kvrocks/issues/2314,kvrocks,2297208687,2314,Add support for the TOUCH command,VasuDevrani,101383635,,,CLOSED,2024-05-15T08:28:11Z,2024-05-16T13:08:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

TOUCH command is useful feature in Redis, allows updating LRU time of one or more keys without modifying their values. 
Note: I have just started working around Kvrocks, so not sure if this would be needed. Although I can think of some possible solution. Needed review/guide here.

### Solution

will update

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2314/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2314,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5947Z0,kvrocks,2112075380,2314,NA,PragmaTwice,20042607,Twice,,NA,2024-05-15T09:55:28Z,2024-05-15T09:55:28Z,"Kvrocks doesn't keep the last access time of keys and doesn't support key eviction.

So it's not so meaningful to support this command.

See if other guys have any comment.

cc @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5947Z0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2314,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM595TUA,kvrocks,2112173312,2314,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-15T10:45:33Z,2024-05-15T10:45:33Z,"> Kvrocks doesn't keep the last access time of keys and doesn't support key eviction.
> 
> So it's not so meaningful to support this command.
> 
> See if other guys have any comment.
> 
> cc @git-hulk

Yes, exactly.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM595TUA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2315,https://api.github.com/repos/apache/kvrocks/issues/2315,kvrocks,2297947988,2315,Potential data inconsistency issues?,raffertyyu,104707498,,raffertyyu@tencent.com,CLOSED,2024-05-15T13:35:41Z,2024-05-15T13:59:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable branch

### Minimal reproduce step

See below

### What did you expect to see?

See below

### What did you see instead?

See below

### Anything Else?

I am getting familiar with kvrocks code. When I am reviewing the compact_filter.cc file, I found this piece of code.
```c++
bool MetadataFilter::Filter(int level, const Slice &key, const Slice &value, std::string *new_value,
                            bool *modified) const {
  Metadata metadata(kRedisNone, false);
  rocksdb::Status s = metadata.Decode(value);
  auto [ns, user_key] = ExtractNamespaceKey(key, stor_->IsSlotIdEncoded());
  if (!s.ok()) {
    LOG(WARNING) << ""[compact_filter/metadata] Failed to decode,""
                 << "", namespace: "" << ns << "", key: "" << user_key << "", err: "" << s.ToString();
    return false;
  }
  DLOG(INFO) << ""[compact_filter/metadata] ""
             << ""namespace: "" << ns << "", key: "" << user_key
             << "", result: "" << (metadata.Expired() ? ""deleted"" : ""reserved"");
  return metadata.Expired();
}
```
I am envisioning a scenario:
Now, RocksDB has four levels of SST files: L0, L4, L5, and L6. Suppose there is a key, k1, which has a value (k1, v1) in the L6 level without an expiration time, and another value (k1, v2) in the L4 level with an expiration time t1. It can be achieved by sequentially executing:
```
set k1 v1
set k1 v2 ex 1
```
After a second, k1 expired. Then the SST file containing (k1, v2) in L4 did a compaction between L4 and L5 levels. The compaction filter detect that (k1, v2) had expired and removed it from inputed sst files. At this point, if we attempt to get k1, will rocksdb directly read the value v1 from the L6 level? But if k1 expired, it should return null. So, will it return null or v1?

I am unable to design a test to verify this scenario. 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2315/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM596y_W,kvrocks,2112565206,2315,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-05-15T13:38:44Z,2024-05-15T13:38:44Z,"https://github.com/facebook/rocksdb/wiki/Compaction-Filter

> If it request to filter the key, the value is replaced by a deletion marker. Note that if the output level of the compaction is the bottom level, no deletion marker will need to be output.

Would this have no problem here?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM596y_W/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2315,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM597Ce7,kvrocks,2112628667,2315,NA,raffertyyu,104707498,,raffertyyu@tencent.com,NA,2024-05-15T13:59:42Z,2024-05-15T13:59:42Z,"> https://github.com/facebook/rocksdb/wiki/Compaction-Filter
> 
> > If it request to filter the key, the value is replaced by a deletion marker. Note that if the output level of the compaction is the bottom level, no deletion marker will need to be output.
> 
> Would this have no problem here?

Thanks! Got it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM597Ce7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2326,https://api.github.com/repos/apache/kvrocks/issues/2326,kvrocks,2311820465,2326,Transaction with FlushDB：DeleteRange unsupported in WriteBatchWithIndex,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,CLOSED,2024-05-23T02:44:40Z,2024-05-23T03:16:35Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable:commit 9b1ebcd

### Minimal reproduce step

```
127.0.0.1:6666> MULTI
OK
127.0.0.1:6666> SET key 123
QUEUED
127.0.0.1:6666> FLUSHDB
QUEUED
127.0.0.1:6666> EXEC
1) OK
2) (error) ERR Not implemented: DeleteRange unsupported in WriteBatchWithIndex
```

### What did you expect to see?

Redis:
```
# redis-cli
127.0.0.1:6379> MULTI
OK
127.0.0.1:6379(TX)> SET key 123
QUEUED
127.0.0.1:6379(TX)> FLUSHDB
QUEUED
127.0.0.1:6379(TX)> EXEC
1) OK
2) OK
127.0.0.1:6379> GET key
(nil)
127.0.0.1:6379>
```

### What did you see instead?

ERR Not implemented: DeleteRange unsupported in WriteBatchWithIndex
rocksdb ref: https://github.com/facebook/rocksdb/blob/c72ee4531b288bf08b9414155fafb86cc4378fb4/include/rocksdb/utilities/write_batch_with_index.h#L165

### Anything Else?

I discovered this issue while trying to solve https://github.com/apache/kvrocks/issues/2310. One of my solutions in issue-2310 was to imitate the current transaction implementation and use WriteBatchWithIndex
> issue-2310 
> 2. Get WriteBatchWithIndex in GetWriteBatchBase, but I found that WriteBatchWithIndex cannot support all operations of WriteBatch, such as DeleteRange. Even after using WriteBatchWithIndex::GetWriteBatch after DeleteRange, we cannot index the effect of DeleteRange in Batch through GetFromBatchAndDB.

So I'm currently trying another approach in issue-2310 

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2326/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2329,https://api.github.com/repos/apache/kvrocks/issues/2329,kvrocks,2316654558,2329,A new version of search key and metadata encoding,PragmaTwice,20042607,Twice,,CLOSED,2024-05-25T03:30:55Z,2024-05-30T15:08:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

AS IS: (InernalKey encoding)
(`key` is omitted, actually it's InternalKey `namespace | (slot num) | index name`)
```
search data type metadata:

key -> metadata flag | expire | version | size | on_data_type (HASH or JSON)

prefixes encoding:

key | version | PREFIXES -> prefix num | prefix1 prefix2 ...

tag field metadata encoding:

key | version | TAG_FIELD_META | field name -> field flag | separator | case sensitive

tag field index encoding:

key | version | TAG_FIELD | field name | tag | key -> (nil)

numeric field metadata encoding:

key | version | NUM_FIELD_META | field name -> field flag

numeric field index encoding:

key | version | NUM_FIELD | field name | ordered floating number | key -> (nil)

field flag:

|              8 bit              |
|---------------------------------|
|  noindex: 1bit | reserved: 7bit |
```

TO BE: (new encoding)
```
search data type metadata:

ns | INDEX_META | index name ->  index flag | on_data_type (HASH or JSON)

prefixes encoding:

ns | PREFIXES | index name -> prefix num | prefix1 prefix2 ...

field alias encoding:

ns | FIELD_ALIAS | index name | alias name -> field name

tag field metadata encoding:

ns | FIELD_META | index name | field name -> field flag | separator | case sensitive

numeric field metadata encoding:

ns | FIELD_META | index name | field name -> field flag

tag field index encoding:

ns | FIELD | index name | field name | tag | key -> (nil)

numeric field index encoding:

ns | FIELD | index name | field name | ordered floating number | key -> (nil)

field flag:

|              8 bit                                 |
|----------------------------------------------------|
|  noindex: 1bit | field type: 4bit | reserved: 3bit |

field type:
TAG     1
NUMERIC 2
```

benefits:
- we can iterate all index metadata via a rocksdb iterator
- remove useless fields in index metadata
- field name is unique regardless of field type
- prefix compression can work better
- field type stored in metadata instead of key

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2329/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2330,https://api.github.com/repos/apache/kvrocks/issues/2330,kvrocks,2316671739,2330,Is stream column family useful to be a seperate cf instead of merging into subkey cf?,PragmaTwice,20042607,Twice,,OPEN,2024-05-25T04:02:25Z,2024-05-28T01:41:40Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

As title, should we merge it to subkey cf while keeping compatible to old versions?

### Solution

- check the current cfs using `ListColumnFamilies()` before opening db:
  - if it's a new database or no stream cf:
    - don't create stream cf, use default as stream cf
  - if there's stream cf:
    - keep to use stream cf for compatibility

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2330/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2330,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_Kz1w,kvrocks,2133540208,2330,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-27T13:55:57Z,2024-05-27T13:55:57Z,@torwig @Yangsx-1 What do you think about this proposal?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_Kz1w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2330,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_LQsm,kvrocks,2133658406,2330,NA,torwig,8588372,Yaroslav,,NA,2024-05-27T15:02:41Z,2024-05-27T15:02:41Z,"If the only reason is compatibility, sure, we can do what @PragmaTwice offered.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_LQsm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2330,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_Lfnu,kvrocks,2133719534,2330,NA,Yangsx-1,85615957,Hauru,,NA,2024-05-27T15:41:28Z,2024-05-27T15:41:28Z,"I think the amplification of stream is not very large, it's ok to merge it to subkey cf.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_Lfnu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2330,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_NYl_,kvrocks,2134215039,2330,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-28T01:41:39Z,2024-05-28T01:41:39Z,"> I think the amplification of stream is not very large, it's ok to merge it to subkey cf.

Good point. It might affect the reading performance if there are too many tombstones.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_NYl_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2331,https://api.github.com/repos/apache/kvrocks/issues/2331,kvrocks,2316777957,2331,[OSPP 2024] Tracking issues: Enhance Kvrocks Transaction Syntax,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,OPEN,2024-05-25T07:04:49Z,2025-01-28T02:29:15Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This issue is about part of the Open Source Promotion Plan(OSPP): Enhance Kvrocks Transaction Syntax
link: https://summer-ospp.ac.cn/org/prodetail/249430512?lang=en&list=pro

This project hopes to attempt to enhance kvrocks transactions in the following areas:
1. Provide complete isolation semantics for single commands
2. Optimize transactions for Multi/Exec and Lua commands
3. Optimize blocking commands such as BLPOP
4. (Optional) Add optimistic transaction mode

Since multiple issues may be involved, we can use this issues to track them uniformly:

In the process of updating, relevant issues and plans will be gradually added.

- [x] https://github.com/apache/kvrocks/issues/2310
- [x] https://github.com/apache/kvrocks/issues/2162
- [ ] Optimize transactions for Multi/Exec commands
- [ ] Optimize blocking commands such as BLPOP
- [ ] (Optional) Add optimistic transaction mode

Anyone is welcome to provide suggestions

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2331/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2335,https://api.github.com/repos/apache/kvrocks/issues/2335,kvrocks,2319986399,2335,Improve and unify the RESP error message,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-05-28T02:02:11Z,2024-06-15T03:44:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

As mentioned in the comment: https://github.com/apache/kvrocks/blob/unstable/tests/gocase/util/server.go#L142, we should take care of different RESP error kinds to avoid introducing the protocol compatibility issues. 

### Solution

Use an unify function to return the RESP error message, like the following:

```c++
const std::string redis::Error(ErrorKind kind, const std::string &message) {
  switch(kind) {
    case ErrorKind::Loading: 
    case ErrorKind::NoProto:
    ...
    default:
  }
}
```

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2335/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2335,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_YQII,kvrocks,2137063944,2335,NA,PragmaTwice,20042607,Twice,,NA,2024-05-29T10:18:48Z,2024-05-29T10:18:48Z,"The problem is that we add ERR prefix for all msg returned by `Status`.

One solution is to add a new status code for no ERR prefix. (Or, add many status code for LOADING, NOPROTO...)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_YQII/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2335,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_YYEX,kvrocks,2137096471,2335,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-29T10:37:16Z,2024-05-29T10:37:16Z,"> The problem is that we add ERR prefix for all msg returned by Status.

Yes

> One solution is to add a new status code for no ERR prefix. (Or, add many status code for LOADING, NOPROTO...)

This also sounds good","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_YYEX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2335,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6BSaN6,kvrocks,2169086842,2335,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-15T03:44:03Z,2024-06-15T03:44:03Z,closes by #2362 ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6BSaN6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2339,https://api.github.com/repos/apache/kvrocks/issues/2339,kvrocks,2323681126,2339,Force PR titles to follow the conventional commit format,PragmaTwice,20042607,Twice,,CLOSED,2024-05-29T16:01:34Z,2024-06-05T11:24:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

By following conventional commits, PR titles can be neater and clearer, making unstable commit history more user-friendly and easier to write release notes.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2339/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2339,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_dUNS,kvrocks,2138391378,2339,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-05-29T23:02:45Z,2024-05-29T23:02:45Z,"GitHub Action is used in some projects to check PR title. Maybe we can also add related Actions

example:
https://github.com/amannn/action-semantic-pull-request

https://github.com/apache/pulsar/blob/master/.github/workflows/ci-semantic-pull-request.yml","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_dUNS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2344,https://api.github.com/repos/apache/kvrocks/issues/2344,kvrocks,2326355167,2344,Docker images with Debian or Ubuntu,thbley,941223,Thomas,,CLOSED,2024-05-30T18:57:26Z,2024-06-03T07:07:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Since many companies run their production servers on Debian or Ubuntu, it would be nice to have a Debian or Ubuntu container on docker hub as well, for local testing.

e.g. I tested with a single stage build:

```
# image size is 114M compared to alpine build with 38M uncompressed

FROM debian:bookworm-slim

# chain commands for single layer
RUN apt-get -y update \
    && DEBIAN_FRONTEND=noninteractive apt-get -y --no-install-recommends install git build-essential cmake libtool \
        python3 libssl-dev autoconf automake ninja-build redis-tools ca-certificates \
    && git clone --depth 1 --branch v2.8.0 https://github.com/apache/kvrocks.git \
    && cd kvrocks/ \
    && ./x.py build -DENABLE_OPENSSL=ON -DPORTABLE=1 -DCMAKE_BUILD_TYPE=Release -j $(nproc) \
    && cp build/kvrocks /bin/kvrocks \
    && cd / \
    && rm -rf /kvrocks \
    && apt-get purge -y --auto-remove git build-essential cmake libtool python3 libssl-dev autoconf automake ninja-build \
    && apt-get clean \
    && rm -rf /tmp/* /var/lib/apt/lists/* /var/cache/apt/archives/*

EXPOSE 6666

HEALTHCHECK ...

ENTRYPOINT [""/bin/kvrocks""...]
```

Release tags could be 2.8.0-debian, 2.8.0-alpine, etc.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2344/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2344,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_nome,kvrocks,2141096350,2344,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-05-31T01:45:25Z,2024-05-31T01:45:25Z,"@thbley Thanks for your proposal.

@apache/kvrocks-committers What do you think about this? From my perspective, it did help when users wanted to debug the kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_nome/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2344,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_n4Fu,kvrocks,2141159790,2344,NA,enjoy-binbin,22811481,Binbin,binloveplay1314@qq.com,NA,2024-05-31T03:14:14Z,2024-05-31T03:14:14Z,Sound good to me.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_n4Fu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2344,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_0Wcg,kvrocks,2144429856,2344,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-06-03T07:05:07Z,2024-06-03T07:05:07Z,"I think, we can close this issue as done","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_0Wcg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2344,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_0Xk8,kvrocks,2144434492,2344,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-03T07:07:55Z,2024-06-03T07:07:55Z,"@aleksraiden Yes, closing.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_0Xk8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2350,https://api.github.com/repos/apache/kvrocks/issues/2350,kvrocks,2329161133,2350,[Bug] XINFO overflow when deleting pending message and consumer,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,CLOSED,2024-06-01T14:00:59Z,2024-06-03T05:19:23Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

version: unstable
kvrocks_version: unstable
redis_version:4.0.0
git_sha1: d2e0feb
kvrocks_git_sha1: d2e0feb
redis_mode: standalone
kvrocks_mode: standalone
os: Linux 5.14.0-162.6.1.el9_1.0.1.x86_64 x86_64
gcc_version: 11.2.1
arch_bits: 64
process_id: 1
tcp_port: 6666
uptime_in_seconds: 1444
uptime_in_days: 0

### Minimal reproduce step

Here is the step using redis-cli:

```bash
~ redis-cli -h kvrocks-server -p 6666
kvrocks-server:6666> xgroup create overflow-test info-count-test $ MKSTREAM
OK
kvrocks-server:6666> xgroup createconsumer overflow-test info-count-test consumer-1
(integer) 1
kvrocks-server:6666> xinfo groups overflow-test
1)  1) ""name""
    2) ""info-count-test""
    3) ""consumers""
    4) (integer) 1
    5) ""pending""
    6) (integer) 0
    7) ""last-delivered-id""
    8) ""0-0""
    9) ""entries-read""
   10) (nil)
   11) ""lag""
   12) (integer) 0
kvrocks-server:6666> xadd overflow-test * testing overflow
""1717248597227-0""
kvrocks-server:6666> xinfo groups overflow-test
1)  1) ""name""
    2) ""info-count-test""
    3) ""consumers""
    4) (integer) 1
    5) ""pending""
    6) (integer) 0
    7) ""last-delivered-id""
    8) ""0-0""
    9) ""entries-read""
   10) (nil)
   11) ""lag""
   12) (integer) 1
kvrocks-server:6666> xreadgroup group info-count-test consumer-1 count 1 streams overflow-test >
1) 1) ""overflow-test""
   2) 1) 1) ""1717248597227-0""
         2) 1) ""testing""
            2) ""overflow""
kvrocks-server:6666> xinfo groups overflow-test
1)  1) ""name""
    2) ""info-count-test""
    3) ""consumers""
    4) (integer) 1
    5) ""pending""
    6) (integer) 1
    7) ""last-delivered-id""
    8) ""1717248597227-0""
    9) ""entries-read""
   10) (integer) 0
   11) ""lag""
   12) (integer) 1
kvrocks-server:6666> xack overflow-test info-count-test 1717248597227-0
(integer) 1
kvrocks-server:6666> xinfo groups overflow-test
1)  1) ""name""
    2) ""info-count-test""
    3) ""consumers""
    4) (integer) 1
    5) ""pending""
    6) (integer) 0
    7) ""last-delivered-id""
    8) ""1717248597227-0""
    9) ""entries-read""
   10) (integer) 0
   11) ""lag""
   12) (integer) 1
kvrocks-server:6666> xgroup delconsumer overflow-test info-count-test consumer-1
(integer) 1
kvrocks-server:6666> xinfo groups overflow-test
Error: Bad integer value
```

The redis-cli refuses to display the response value.

So, I use telnet to run the command and got response below.

```bash
xinfo groups overflow-test
*1
*12
$4
name
$15
info-count-test
$9
consumers
:0
$7
pending
:18446744073709551615
$17
last-delivered-id
$15
1717248597227-0
$12
entries-read
:0
$3
lag
:1
```

### What did you expect to see?

This is output from redis-cli.

```bash
redis-server:6379>xinfo groups overflow-test
1)  1) ""name""
    2) ""info-count-test""
    3) ""consumers""
    4) (integer) 0
    5) ""pending""
    6) (integer) 0
    7) ""last-delivered-id""
    8) ""1717249449175-0""
    9) ""entries-read""
   10) (integer) 1
   11) ""lag""
   12) (integer) 0
```

This output from telnet.

```bash
xinfo groups overflow-test
*1
*12
$4
name
$15
info-count-test
$9
consumers
:0
$7
pending
:0
$17
last-delivered-id
$15
1717249449175-0
$12
entries-read
:1
$3
lag
:0
```

### What did you see instead?

redis-cli refuses to display the response.

```bash
kvrocks-server:6666> xinfo groups overflow-test
Error: Bad integer value
```

telnet get the response from kvrocks-server.

```bash
xinfo groups overflow-test
*1
*12
$4
name
$15
info-count-test
$9
consumers
:0
$7
pending
:18446744073709551615
$17
last-delivered-id
$15
1717248597227-0
$12
entries-read
:0
$3
lag
:1
```

### Anything Else?

Hi kvrocks team,

  I find the way to produce the bug during reading the PR of `XPENDING` #2190 .

  In conversations of the PR, it's suggested to use a separate PR to solve this problem.

  I want to fix the bug and add related unit tests with it.

Best Regards,

Edward

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2350/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wpli,kvrocks,2143459682,2350,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-01T14:01:55Z,2024-06-01T14:01:55Z,@LindaSummer Thanks for your detailed report.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wpli/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wrHK,kvrocks,2143465930,2350,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-06-01T14:21:21Z,2024-06-01T14:21:21Z,"Hi @git-hulk ,

This should be forget to update the `pending_number` in consumer meta.
https://github.com/apache/kvrocks/blob/d2e0feb989bd5855480deee61ebf932327e5ca93/src/types/redis_stream.cc#L351-L356

When remove consumer, the group will remove the pending count from the deleted consumer, the inconsistency emerged and may lead to overflow.
https://github.com/apache/kvrocks/blob/d2e0feb989bd5855480deee61ebf932327e5ca93/src/types/redis_stream.cc#L687-L688
https://github.com/apache/kvrocks/blob/d2e0feb989bd5855480deee61ebf932327e5ca93/src/types/redis_stream.cc#L717-L720
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wrHK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wveu,kvrocks,2143483822,2350,NA,PragmaTwice,20042607,Twice,,NA,2024-06-01T15:17:37Z,2024-06-01T15:17:37Z,"Thank you for your report!

If you know how to fix it, feel free to open a PR : )","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_wveu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_x307,kvrocks,2143780155,2350,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-06-02T09:56:06Z,2024-06-02T09:56:06Z,"Hi @PragmaTwice ,

I have opened a PR for this bugfix with related test case.

Please take a look.

Thanks very much.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_x307/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2350,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_z3LP,kvrocks,2144301775,2350,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-03T05:19:22Z,2024-06-03T05:19:22Z,@LindaSummer Thanks for your nice catch and fix.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM5_z3LP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/2355,kvrocks,2340376267,2355,Support passing a slot range in CLUSTERX MIGRATE,PragmaTwice,20042607,Twice,,OPEN,2024-06-07T12:48:03Z,2024-06-24T09:09:51Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

In slot migration, many users would like to be able to pass a slot range to migrate in batches.

### Solution

--

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2355/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ao1yi,kvrocks,2158189730,2355,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-06-10T12:16:54Z,2024-06-10T12:16:54Z,"I'd like to learn kvrocks' cluster design by solving this problem, if it's suitable please arrange it for me. At the same time, if you have relevant information, please list it. Thank you very much!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ao1yi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ap3T5,kvrocks,2158458105,2355,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-10T14:00:10Z,2024-06-10T14:00:10Z,"@PokIsemaine Sure, thank you. Free feel to ping @PragmaTwice @git-hulk @caipengbo for help or confirm anything.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ap3T5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AuTRi,kvrocks,2159621218,2355,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-06-11T01:54:40Z,2024-06-11T01:54:40Z,"@PokIsemaine I suggest that before you start writing code, outline your solution and let's discuss it together.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6AuTRi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CD9zX,kvrocks,2182077655,2355,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-06-21T06:16:42Z,2024-06-21T06:16:42Z,"First of all, I would like to discuss the use of commands, and noting that `CLUSTERX SETSLOT` has similar needs, I decided to refer to the following PR and issues.
https://github.com/apache/kvrocks/issues/1412
https://github.com/apache/kvrocks/pull/1414

The current form of `CLUSTERX MIGRATE` is as follows
```
CLUSTERX MIGRATE $SLOT_ID $DEST_NODE_ID [$SYNC_FLAG] [$TIMEOUT]
```
To be compatible with the previous command, we've only modified the form of content that SLOT_ID can accept, allowing it to accept a single slot or a range of slotrange, or both.
```
CLUSTERX MIGRATE 1 $dest_node_id
CLUSTERX MIGRATE ""3 5 9 20-30"" $dest_node_id
```
Do you think this is reasonable? If it makes sense, I'll continue to think about the specific design and implementation.


> In addition, in the process of learning cluster, I found that the https://kvrocks.apache.org/docs/cluster/ documentation is not very user-friendly, for example, it does not tell CLUSTERX MIGRATE how to use it, command line arguments, etc., which may need to be improved in the future","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CD9zX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEEEv,kvrocks,2182103343,2355,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-06-21T06:38:33Z,2024-06-21T06:38:33Z,I agree with this way.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEEEv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CELIi,kvrocks,2182132258,2355,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-06-21T07:02:01Z,2024-06-21T07:02:01Z,"The next thing I'd like to discuss is a more specific design: how do we migrate when we have multiple slot ranges?
```
CLUSTERX MIGRATE ""3 5 9 20-30"" $dest_node_id
```
In the current implementation, migration-related functions, including `SlotMigrationJob`, are implemented for a single slot.

Some rough thoughts:
* **1-SlotMigrationJob,1-Slot**: Still using the existing single slot implementation, adding two layers of traversal of slot_ranges and slot_range.
  * It looks like this is how `SETSLOT` works, but does it cause too much communication for migrate? 
  * At the same time, I noticed that there is a mechanism similar to `pipeline`, but I don't know much about its design and function, do you have any relevant issues/PR descriptions? Does it alleviate these problems?
* **1-SlotMigrationJob,1-Slot Range**: Migrate at the slot range granularity, which requires a lot of modifications
* **1-SlotMigrationJob,N-Slot Range**: Migrate at the slot ranges  granularity

Which option do you think is more suitable? If you have a better plan, you can also come up with it, thank you very much!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CELIi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEQVD,kvrocks,2182153539,2355,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-06-21T07:17:15Z,2024-06-21T07:17:15Z,"I prefer 1-SlotMigrationJob,1-Slot Range. We can seek only once for a range (the same namespace), making the changes relatively small and making it easier to determine whether a slot belongs to that slot range.  HDYT @PragmaTwice @git-hulk 

Users are encouraged to migrate slots by slot range, and we can set a maximum number of ranges if the slot passed by the user is not contiguous.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEQVD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEg1E,kvrocks,2182221124,2355,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-21T08:02:27Z,2024-06-21T08:02:27Z,"@PokIsemaine @caipengbo To make it simpler, perhaps another approach is implementing a single continuous slot range migration first. That said, we allow to pass `1-N` but `2 4 5` is disallowed. How do you think?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEg1E/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEiq3,kvrocks,2182228663,2355,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-06-21T08:06:45Z,2024-06-21T08:06:45Z,"I think ok, just pass a valid slot range. We can extend it in the future to make it more diverse.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEiq3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEteZ,kvrocks,2182272921,2355,NA,PragmaTwice,20042607,Twice,,NA,2024-06-21T08:31:44Z,2024-06-21T08:31:44Z,"I'm not sure about how the current implementation is and how it handles with migration errors and rollbacks.

But from my side it should not be so difficult to implement the design by @PokIsemaine. Of course we can also concentrate on extend from one slot to a slot range.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CEteZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CS0sF,kvrocks,2185972485,2355,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-06-24T08:58:18Z,2024-06-24T08:58:18Z,"> @PokIsemaine @caipengbo To make it simpler, perhaps another approach is implementing a single continuous slot range migration first. That said, we allow to pass `1-N` but `2 4 5` is disallowed. How do you think?


I want to confirm what you mean


```
// support
CLUSTERX MIGRATE 3 $dest_node_id
CLUSTERX MIGRATE ""20-30"" $dest_node_id
 not support
CLUSTERX MIGRATE ""3 5 9"" $dest_node_id
CLUSTERX MIGRATE ""3 5 9 20-30"" $dest_node_id
CLUSTERX MIGRATE ""5-10 20-30"" $dest_node_id
```
If so, I think we can do this first, and a single slot can also be unified into a single slot range.

Another question is how do we handle failure situations? If some slots fail, how do we handle it?
It seems that status is now tracked by individual slots, such as `cluster info` information.

```
127.0.0.1:6666> cluster info
cluster_state:ok
cluster_slots_assigned:16384
cluster_slots_ok:16384
cluster_slots_pfail:0 
cluster_slots_fail:0
cluster_known_nodes:3
cluster_size:3
cluster_current_epoch:3
cluster_my_epoch:3
importing_slot: 7629  // single slot => slot range?
import_state: success // single slot => slot range?
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CS0sF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2355,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CS6dR,kvrocks,2185996113,2355,NA,caipengbo,19643013,Myth,caipengbo@outlook.com,NA,2024-06-24T09:08:53Z,2024-06-24T09:08:53Z,"> how do we handle failure situations?

The migration slot range is migrated from front to back, if  a slot fails, `[start_slot, failed_slot)` should be successful, `[failed_slot, end_slot)` should fail. If the slot is found to have failed, the migration is stopped.

I think, we can add this information to cluster info, like this:

```
successful_slot: [start_slot, failed_slot)
failed_slot: [failed_slot, end_slot)
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CS6dR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2364,https://api.github.com/repos/apache/kvrocks/issues/2364,kvrocks,2353646300,2364,kvrocks does not start when customised kvrocks.conf is used,alija83,6471608,,,CLOSED,2024-06-14T15:47:45Z,2024-06-24T13:42:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Docker Compose version v2.15.1
kvrocks version 2.8.0.

### Minimal reproduce step

when using the following docker-compose configs
```
  kvrocks:
    image: apache/kvrocks:latest
    ports:
      - ""6366:6366""
    volumes:
      - ./kvrocks/conf/kvrocks.conf:/etc/kvrocks/conf/kvrocks.conf
    entrypoint: [""kvrocks"", ""-c"", ""/etc/kvrocks/conf/kvrocks.conf""]
```
    
 and the kvrocks.conf file:
 ```
 dir /tmp/kvrocks

# General
#daemonize yes
port 6366
bind 0.0.0.0
```
   


### What did you expect to see?

I expected the service to start...normally and I am able to connect with redis-cli -p 6366

### What did you see instead?

 ⠿ Container microservices-kvrocks-1  Created                                                                                                                                                                                     0.0s
Attaching to microservices-kvrocks-1
microservices-kvrocks-1  | E20240614 15:41:22.642987     1 main.cc:180] Failed to start server: rename file encounter error: Resource busy


### Anything Else?

A quick solution is to mount the directory which contains the configuration file as follows:

```
    volumes:
      - ./kvrocks/conf:/etc/kvrocks/conf
```


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2364/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2364,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6BPgwC,kvrocks,2168327170,2364,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-14T16:01:35Z,2024-06-14T16:01:35Z,"@alija83 Thanks for your report. This issue should involve two problems:

- No need to rewrite the configuration file while starting in most scenarios. And it has been fixed in https://github.com/apache/kvrocks/pull/2347
- Must mount a writable volume if you would like to rewrite the config. And what you do is correct, another workaround is to mount the `/var/lib/kvrocks` volume, please refer to: https://github.com/apache/kvrocks/blob/unstable/Dockerfile#L35","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6BPgwC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2364,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CVRyr,kvrocks,2186615979,2364,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-24T13:42:31Z,2024-06-24T13:42:31Z,@alija83 Feel free to reopen if you have any further questions.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CVRyr/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2365,https://api.github.com/repos/apache/kvrocks/issues/2365,kvrocks,2354111045,2365,Large .sst and .log files (unsure about compression feature),alija83,6471608,,,OPEN,2024-06-14T21:04:27Z,2024-06-15T02:03:27Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I was playing with kvrocks (version 2.8.0) today and my goal was to activate compression and reduce logging.
I am not sure if I have enabled configurations correctly but here is what I have noticed.

My goal was to use kvrocks and storing large volumes of KVs while ensuring that that data (KVs) remain compressed and uses least amount of disk.

Here is my configuration:

```
dir /kvrocks/data

# General
port 6376
bind 0.0.0.0

rocksdb.compression zstd

backup-dir /kvrocks/backup
#log-dir /kvrocks
log-level error
log-dir stdout
log-retention-days 0
pidfile /kvrocks/kvrocks.pid
```


I tried also the option lz4 on rocksdb.compression but nothing, the .sst file does not look compressed and the .log files are quite large as well.
 cd db
/kvrocks/data/db # du -hs *
4.0K	000019.sst
624.0K	000605.sst
83.9M	002080.sst
70.4M	002082.log
102.6M	002083.sst
16.0G	archive

cd archive
ls -alsrht

 64544 -rw-r--r--    1 root     root       63.0M Jun 14 20:59 002162.log
 64448 -rw-r--r--    1 root     root       62.9M Jun 14 20:59 002169.log
 64696 -rw-r--r--    1 root     root       63.2M Jun 14 20:59 002165.log


127.0.0.1:6376> keys '*' pattern
16521) ....

it has 16521 records.


16GB is just too much.


### Solution

I am not sure on how it should work and be implemented, but what I expected as user is to see .sst files compressed and be able to disable logs if desired.

instead of seeing:

/kvrocks/data # du -hs *
22.5G	db

it should have been something like: 25MB

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2365/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2365,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6BSMGb,kvrocks,2169029019,2365,NA,PragmaTwice,20042607,Twice,,NA,2024-06-15T01:38:25Z,2024-06-15T01:38:25Z,"There are basically two points in this issue:
- for `.log` files, it's actually WAL (write ahead logging) in rocksdb, and you can configure it via some options like `rocksdb.wal_ttl_seconds` or `rocksdb.wal_size_limit_mb`.
- even you specify `rocksdb.compression`, these existing SST files will not be compressed immediately. And seems compaction is more important for your issue.

cc @git-hulk ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6BSMGb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2365,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6BSOew,kvrocks,2169038768,2365,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-15T02:03:26Z,2024-06-15T02:03:26Z,"> for .log files, it's actually WAL (write ahead logging) in rocksdb, and you can configure it via some options like rocksdb.wal_ttl_seconds or rocksdb.wal_size_limit_mb.

Yes, you can reduce those two if you would like to keep fewer logs.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6BSOew/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2370,https://api.github.com/repos/apache/kvrocks/issues/2370,kvrocks,2360322758,2370,Feature request: improve password hygeine / security ,ferbs,45411,Jeff Ferber,,OPEN,2024-06-18T17:05:56Z,2024-07-07T07:17:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Improve handling of cleartext passwords, keeping them out of version control in particular, and to follow industry recommended practices.

### Solution

Please add an option to configure kvrocks with a sha256 hash of the actual password, rather than using cleartext. Though similar to the Redis `#<hashedpassword>` [ACL option](https://redis.io/docs/latest/commands/acl-setuser/), it could be implemented separately from any ACL functionality, as an alternative to using the *requirepass* directive, perhaps with a kvrocks.conf *requirepass_sha256* directive, and/or by setting an environment variable, eg: KVROCKS_SECRET_SHA256=e3b0c442...etc... When a client connects and provides its pass, kvrocks would compare the sha256 of that value if enabled, rather than use the cleartext.

Related, it would helpful for kvrocks to support the file-based convention recommended for secrets used in containers. It's often hard to keep regular environment variables out of version control, and they can leak during runtime too. Instead, one environment variable (eg, KVROCKS_PASSWORD_FILE) holds a path to a file in .ini format (key=value pairs just like env vars) which the app loads and uses for its config. 


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2370/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2370,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CFjFz,kvrocks,2182492531,2370,NA,PragmaTwice,20042607,Twice,,NA,2024-06-21T10:36:52Z,2024-06-21T10:36:52Z,"I'm not sure if I understand your words correctly.

You can currently specify the master password in [kvrocks.conf](https://github.com/apache/kvrocks/blob/unstable/kvrocks.conf). And the configuration file should only be accessible to trusted individuals.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CFjFz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2370,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CHvtp,kvrocks,2183068521,2370,NA,ferbs,45411,Jeff Ferber,,NA,2024-06-21T16:29:45Z,2024-06-21T16:29:45Z,"Placing the master password in kvrocks.conf means you can't check that file into git, and that it won't work with secret managers / vaults in a containerized environment. 

Rather than place the password in that file, someone could use the `--requirepass` switch on start, but in a containerized environment using a secrets manager, this requires overriding the project's original dockerfile *entrypoint* and dealing with environment variable expansion headaches. 

What would be much better is telling kvrocks *where* to find the secret. For example, `masterpass_env KVROCKS_MASTER_PASS` tells the app to use the value of that environment variable as its password. Better yet, adding `masterpass_file /var/run/secrets/kvrocks.ini` tells kvrocks to find that value within a file, making it even easier to lock it down using a secrets manager/vault, and is more likely to keep the cleartext secret out logs/history/environment, places that might leak. 

The other suggestion is an option to use sha256 verification of the master password. Where kvrocks is only provided with the hashed password so even if it leaked, it's not in a usable form. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CHvtp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2370,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CKRHq,kvrocks,2183729642,2370,NA,PragmaTwice,20042607,Twice,,NA,2024-06-22T03:03:42Z,2024-06-22T03:03:42Z,"IMHO from my side it doesn't seem to be the logic that needs to be implemented inside Kvrocks.

e.g. if you are using helm charts, you can refer to some helm packages like https://artifacthub.io/packages/helm/bitnami/redis which support configmap construction and secret management for Redis via several ways, as Kvrocks configuration mechanism is similiar to Redis.

For stronger security, you can refer to TLS connection support in Kvrocks and provide your own client-side certificates, instead of just passwords.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CKRHq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2370,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CLtbP,kvrocks,2184107727,2370,NA,ferbs,45411,Jeff Ferber,,NA,2024-06-22T16:55:03Z,2024-06-22T16:55:03Z,"Not TLS, I'm talking about password management: how to properly provide the secret to kvrocks and to clients without it leaking into git, logs, etc.  

With Redis, I can use an ACL file. With postgres, I can use POSTGRES_PASSWORD_FILE. Systems that don't offer that simple mechanism add a burden... modifying config files during deployment with sed, or reconfiguring helm/other, or maintaining a custom entrypoint, etc. 

I'm personally overriding the entrypoint and am fine, but am suggesting modest ways you could make it easier for people to secure kvrocks with their current tooling. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CLtbP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2370,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CNVc_,kvrocks,2184533823,2370,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-06-23T04:57:19Z,2024-06-23T04:57:19Z,"Yes, perhaps we can support this in Dockerfile like PostgreSQL: https://github.com/docker-library/postgres/blob/cefde5ff6f102fcd381a03210c7734816c59aa3e/docker-entrypoint.sh#L9.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CNVc_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2370,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CQSi4,kvrocks,2185308344,2370,NA,ferbs,45411,Jeff Ferber,,NA,2024-06-23T20:01:35Z,2024-06-23T20:01:35Z,"Good idea to review theirs! Looks like their `file_env()` would work without modification, and is MIT license. I personally try to minimize time with bash, so nice to borrow from experts. 

Off the top of my head, a new *kvrocks-entrypoint.sh* might look like:

```bash
#!/usr/bin/env bash

# copy of file_env() function here

file_env 'KVROCKS_PASSWORD'

exec kvrocks ""$@""
```

If using the above entrypoint, *--requirepass* could be set using a positional [COMMAND] argument on start, but would require escaping var expansion. I think it would look something like: `docker run --env KVROCKS_PASSWORD_FILE=/var/run/secrets/kvrocks.ini apache/kvrocks --requirepass '$${KVROCKS_PASSWORD}'`

It would be possible for the entrypoint itself to conditionally include *--requirepass* when $KVROCKS_PASSWORD is present... should someone with more bash ambition come along. :) Prob involves `$([conditional -Z] printf)` stuff. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6CQSi4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2378,https://api.github.com/repos/apache/kvrocks/issues/2378,kvrocks,2380487123,2378,Support EXPIREMEMBER command,ibotty,296430,Tobias Florek,tob@butter.sh,CLOSED,2024-06-28T13:49:52Z,2024-06-28T17:31:47Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

KeyDB implements a command to expire a set's member.

See https://docs.keydb.dev/docs/commands/#expiremember

### Solution

Implement the command.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2378/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2378,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6C82O2,kvrocks,2196988854,2378,NA,ibotty,296430,Tobias Florek,tob@butter.sh,NA,2024-06-28T13:57:33Z,2024-06-28T13:57:33Z,"Just noticed, that redis did implement a similar command (finally) `HEXPIRE`: https://redis.io/docs/latest/commands/hexpire/","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6C82O2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2378,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6C-CUP,kvrocks,2197300495,2378,NA,PragmaTwice,20042607,Twice,,NA,2024-06-28T16:47:20Z,2024-06-28T16:47:20Z,"Thank you for your report!

If you mean hash field expiration, you can refer to https://github.com/apache/kvrocks/issues/2269 for its current status in Kvrocks.

It's not yet implemented but in our plan.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6C-CUP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2378,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6C-UGb,kvrocks,2197373339,2378,NA,ibotty,296430,Tobias Florek,tob@butter.sh,NA,2024-06-28T17:31:47Z,2024-06-28T17:31:47Z,"Yes, that is exactly what I had in mind.  Sorry for not finding the ticket.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6C-UGb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2381,https://api.github.com/repos/apache/kvrocks/issues/2381,kvrocks,2381657105,2381,CI failed due to i/o timeout in bitmap test cases for macOS 12/13,PragmaTwice,20042607,Twice,,OPEN,2024-06-29T10:33:58Z,2024-07-13T08:31:05Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

See https://github.com/apache/kvrocks/pull/2324.

https://github.com/apache/kvrocks/actions/runs/9722666039/job/26837091320?pr=2324

```
--- FAIL: TestBitmap (504.52s)
    --- FAIL: TestBitmap/SETBIT/GETBIT/BITCOUNT/BITPOS_boundary_check_(type_bitmap) (6.05s)
        bitmap_test.go:201: 
            	Error Trace:	/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:201
            	Error:      	Received unexpected error:
            	            	i/o timeout
            	Test:       	TestBitmap/SETBIT/GETBIT/BITCOUNT/BITPOS_boundary_check_(type_bitmap)
    --- FAIL: TestBitmap/BITCOUNT_BIT/BYTE_option_check(type_bitmap_bitmap_string) (3.02s)
        bitmap_test.go:209: 
            	Error Trace:	/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:209
            	Error:      	Received unexpected error:
            	            	i/o timeout
            	Test:       	TestBitmap/BITCOUNT_BIT/BYTE_option_check(type_bitmap_bitmap_string)
    --- FAIL: TestBitmap/BITOP_NOT_(known_string) (3.02s)
        bitmap_test.go:54: 
            	Error Trace:	/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:54
            	            				/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:263
            	Error:      	Received unexpected error:
            	            	i/o timeout
            	Test:       	TestBitmap/BITOP_NOT_(known_string)
    --- FAIL: TestBitmap/BITOP_where_dest_and_target_are_the_same_key (3.03s)
        bitmap_test.go:54: 
            	Error Trace:	/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:54
            	            				/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:269
            	Error:      	Received unexpected error:
            	            	i/o timeout
            	Test:       	TestBitmap/BITOP_where_dest_and_target_are_the_same_key
    --- FAIL: TestBitmap/BITOP_AND|OR|XOR_don't_change_the_string_with_single_input_key (3.02s)
        bitmap_test.go:54: 
            	Error Trace:	/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:54
            	            				/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:275
            	Error:      	Received unexpected error:
            	            	i/o timeout
            	Test:       	TestBitmap/BITOP_AND|OR|XOR_don't_change_the_string_with_single_input_key
    --- FAIL: TestBitmap/BITOP_missing_key_is_considered_a_stream_of_zero (3.01s)
        bitmap_test.go:54: 
            	Error Trace:	/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:54
            	            				/Users/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/bitmap/bitmap_test.go:283
            	Error:      	Received unexpected error:
            	            	i/o timeout
            	Test:       	TestBitmap/BITOP_missing_key_is_considered_a_stream_of_zero
FAIL
```

### What did you expect to see?

--

### What did you see instead?

--

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2381/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2381,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6EePf2,kvrocks,2222520310,2381,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-07-11T09:58:14Z,2024-07-11T09:58:14Z,"I think that's I find an error case, tried to test it into own repo.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6EePf2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2381,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6EupqY,kvrocks,2226821784,2381,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-07-13T08:31:04Z,2024-07-13T08:31:04Z,This PR https://github.com/apache/kvrocks/pull/2404 will close issue,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6EupqY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2398,https://api.github.com/repos/apache/kvrocks/issues/2398,kvrocks,2399164964,2398,Avoid `HnswIndex` heavy construction because of `mt19937`,Beihao-Zhou,68083940,Beihao Zhou,,OPEN,2024-07-09T20:33:29Z,2024-07-10T00:58:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

As mentioned in PR #2368 in this [comment](https://github.com/apache/kvrocks/pull/2368#discussion_r1670432215), 
`HnswIndex` is a relatively heavy class since it includes `mt19937, sizeof(mt19937) ~= 5000)`, we can try to optimize its construction. 

Thanks @PragmaTwice for pointing it out! :)

### Solution

One way I could think of to improve it is to make all instances of HnswIndex share a single `mt19937` instance. 

We can implement a `RandomGenerator` using Singleton Pattern as below:

```
class RandomGenerator {
public:
    static RandomGenerator& getInstance() {
        static RandomGenerator instance;
        return instance;
    }

    std::mt19937& getGenerator() {
        return generator_;
    }

private:
    RandomGenerator() {
        std::random_device rd;
        generator_ = std::mt19937(rd());
    }
    // delete copy & move constructor
    std::mt19937 generator_;
};

struct HnswIndex {
    HnswIndex(...) {
        generator_ = &RandomGenerator::getInstance().getGenerator();
    }
};
```
One callout is that `mt19937` is not thread-safe, so I'm not quite sure if sharing it among all `HnswIndex` instances will cause any side effects, will further investigate if we finally use the solution. 

Welcome any other ideas and thoughts! 


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2398/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2399,https://api.github.com/repos/apache/kvrocks/issues/2399,kvrocks,2399696146,2399,Extend limits of max value size to > 1Gb,wessorh,938688,Rick Wesson,,CLOSED,2024-07-10T04:04:08Z,2024-07-25T05:46:07Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I like kvrocks and I'm interested in storing values that are larger than 256M, rocks db supports larger values and I'd like to take advantage of that capability.

### Solution

I don't yet know where the limitations are and would appreciate clues so that I can investigate further.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2399/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2399,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ESxyf,kvrocks,2219515039,2399,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-07-10T04:16:29Z,2024-07-10T04:16:29Z,"Hi @wessorh Thanks for your report.

Maybe we can add a configuration `proto-max-bulk-len` for this purpose like Redis: [config.c#L3206](https://github.com/redis/redis/blob/69b480cb7a9c804b59406cc134951af5b52d8ea6/src/config.c#L3206C27-L3206C45)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ESxyf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2401,https://api.github.com/repos/apache/kvrocks/issues/2401,kvrocks,2402708823,2401,Confusing error message while failed to parse the cluster slots ,spihiker,43256384,,,CLOSED,2024-07-11T09:27:44Z,2024-09-23T00:44:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

v2.9.0

### Minimal reproduce step

 CLUSTERX SETNODES ""86f7e437faa5a7fce15d1ddcb9eaeaea377667b8 172.20.84.154 6666 master - 0-5460 3c363836cf4e16666669a25da280a1865c2d2874 172.20.84.154 6669 slave 86f7e437faa5a7fce15d1ddcb9eaeaea377667b8"" 1
(error) ERR Slot is out of range

### What did you expect to see?

normal as redis.

### What did you see instead?

no 

### Anything Else?

no

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2401/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2401,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6EeFT_,kvrocks,2222478591,2401,NA,PragmaTwice,20042607,Twice,,NA,2024-07-11T09:37:02Z,2024-07-11T09:37:02Z,"Could you try to add a `\n`?

```
CLUSTERX SETNODES ""86f7e437faa5a7fce15d1ddcb9eaeaea377667b8 172.20.84.154 6666 master - 0-5460 \n  3c363836cf4e16666669a25da280a1865c2d2874 172.20.84.154 6669 slave 86f7e437faa5a7fce15d1ddcb9eaeaea377667b8"" 1
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6EeFT_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2401,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ekvt1,kvrocks,2224225141,2401,NA,spihiker,43256384,,,NA,2024-07-12T00:47:19Z,2024-07-12T00:47:19Z,After add a \n.It can run normally.Thank you.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ekvt1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2401,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Elu9R,kvrocks,2224484177,2401,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-07-12T04:10:38Z,2024-07-12T04:10:38Z,"@PragmaTwice @spihiker This error message is very confusing for users, I have changed the issue title to track and improve it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Elu9R/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2401,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IWt-8,kvrocks,2287656892,2401,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-08-14T01:26:05Z,2024-08-14T01:26:05Z,@PragmaTwice @git-hulk Would this be more of a parser change vs. a changed error messsage? Is using '\n' the proper way to do it?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IWt-8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2401,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NE3It,kvrocks,2366861869,2401,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-22T16:28:16Z,2024-09-22T16:28:16Z,This can be closed,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NE3It/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2401,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NFoGA,kvrocks,2367062400,2401,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-23T00:44:53Z,2024-09-23T00:44:53Z,@jonathanc-n Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NFoGA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2411,https://api.github.com/repos/apache/kvrocks/issues/2411,kvrocks,2407282677,2411,Redis CLI test cases failed in Ubuntu 24.04,PragmaTwice,20042607,Twice,,OPEN,2024-07-14T06:03:53Z,2024-07-14T06:04:49Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/actions/runs/9925485209/job/27418202135?pr=2409
```
--- FAIL: TestRedisCli (6.59s)
    --- FAIL: TestRedisCli/test_interactive_cli (0.00s)
        --- FAIL: TestRedisCli/test_interactive_cli/INFO_response_should_be_printed_raw (0.00s)
            cli_test.go:167: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:167
                	Error:      	Received unexpected error:
                	            	EOF
                	Test:       	TestRedisCli/test_interactive_cli/INFO_response_should_be_printed_raw
        --- FAIL: TestRedisCli/test_interactive_cli/Status_reply (0.00s)
            cli_test.go:108: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:108
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:174
                	Error:      	Received unexpected error:
                	            	write |1: broken pipe
                	Test:       	TestRedisCli/test_interactive_cli/Status_reply
        --- FAIL: TestRedisCli/test_interactive_cli/Integer_reply (0.00s)
            cli_test.go:108: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:108
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:178
                	Error:      	Received unexpected error:
                	            	write |1: broken pipe
                	Test:       	TestRedisCli/test_interactive_cli/Integer_reply
        --- FAIL: TestRedisCli/test_interactive_cli/Bulk_reply (0.00s)
            cli_test.go:108: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:108
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:183
                	Error:      	Received unexpected error:
                	            	write |1: broken pipe
                	Test:       	TestRedisCli/test_interactive_cli/Bulk_reply
        --- FAIL: TestRedisCli/test_interactive_cli/Multi-bulk_reply (0.00s)
            cli_test.go:108: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:108
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:189
                	Error:      	Received unexpected error:
                	            	write |1: broken pipe
                	Test:       	TestRedisCli/test_interactive_cli/Multi-bulk_reply
        --- FAIL: TestRedisCli/test_interactive_cli/Parsing_quotes (0.00s)
            cli_test.go:108: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:108
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:196
                	Error:      	Received unexpected error:
                	            	write |1: broken pipe
                	Test:       	TestRedisCli/test_interactive_cli/Parsing_quotes
        cli_test.go:162: 
            	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:162
            	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:213
            	Error:      	Error message not equal:
            	            	expected: ""signal: terminated""
            	            	actual  : ""exit status 127""
            	Test:       	TestRedisCli/test_interactive_cli
    --- FAIL: TestRedisCli/test_tty_cli (0.01s)
        --- FAIL: TestRedisCli/test_tty_cli/Status_reply (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:220
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_tty_cli/Status_reply
        --- FAIL: TestRedisCli/test_tty_cli/Integer_reply (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:226
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_tty_cli/Integer_reply
        --- FAIL: TestRedisCli/test_tty_cli/Bulk_reply (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:231
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_tty_cli/Bulk_reply
        --- FAIL: TestRedisCli/test_tty_cli/Multi-bulk_reply (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:2[42](https://github.com/apache/kvrocks/actions/runs/9925485209/job/27418202135?pr=2409#step:16:43)
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_tty_cli/Multi-bulk_reply
        --- FAIL: TestRedisCli/test_tty_cli/Read_last_argument_from_pipe (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:2[51](https://github.com/apache/kvrocks/actions/runs/9925485209/job/27418202135?pr=2409#step:16:52)
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_tty_cli/Read_last_argument_from_pipe
        --- FAIL: TestRedisCli/test_tty_cli/Read_last_argument_from_file (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:264
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_tty_cli/Read_last_argument_from_file
    --- FAIL: TestRedisCli/test_notty_cli (0.01s)
        --- FAIL: TestRedisCli/test_notty_cli/Status_reply (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:271
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_notty_cli/Status_reply
        --- FAIL: TestRedisCli/test_notty_cli/Integer_reply (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:277
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_notty_cli/Integer_reply
        --- FAIL: TestRedisCli/test_notty_cli/Bulk_reply (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:282
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_notty_cli/Bulk_reply
        --- FAIL: TestRedisCli/test_notty_cli/Multi-bulk_reply (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:289
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_notty_cli/Multi-bulk_reply
        --- FAIL: TestRedisCli/test_notty_cli/Quoted_input_arguments (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:294
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_notty_cli/Quoted_input_arguments
        --- FAIL: TestRedisCli/test_notty_cli/No_accidental_unquoting_of_input_arguments (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:298
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_notty_cli/No_accidental_unquoting_of_input_arguments
        --- FAIL: TestRedisCli/test_notty_cli/Read_last_argument_from_pipe (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:316
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_notty_cli/Read_last_argument_from_pipe
        --- FAIL: TestRedisCli/test_notty_cli/Read_last_argument_from_file (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:329
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/test_notty_cli/Read_last_argument_from_file
    --- FAIL: TestRedisCli/Scan_mode (0.00s)
        cli_test.go:122: 
            	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
            	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:339
            	Error:      	Received unexpected error:
            	            	exit status 127
            	Test:       	TestRedisCli/Scan_mode
    --- FAIL: TestRedisCli/Piping_raw_protocol (5.[54](https://github.com/apache/kvrocks/actions/runs/9925485209/job/27418202135?pr=2409#step:16:55)s)
        cli_test.go:122: 
            	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
            	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:370
            	Error:      	Received unexpected error:
            	            	exit status 127
            	Test:       	TestRedisCli/Piping_raw_protocol
    --- FAIL: TestRedisCli/Test_redis-cursor-compatible_mode (0.01s)
        --- FAIL: TestRedisCli/Test_redis-cursor-compatible_mode/Use_reids-cli_--bigkeys (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:382
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/Test_redis-cursor-compatible_mode/Use_reids-cli_--bigkeys
        --- FAIL: TestRedisCli/Test_redis-cursor-compatible_mode/Use_reids-cli_--memkeys (0.00s)
            cli_test.go:122: 
                	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:122
                	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/integration/cli/cli_test.go:387
                	Error:      	Received unexpected error:
                	            	exit status 127
                	Test:       	TestRedisCli/Test_redis-cursor-compatible_mode/Use_reids-cli_--memkeys
```

### What did you expect to see?

--

### What did you see instead?

--

### Anything Else?

--

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2411/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2414,https://api.github.com/repos/apache/kvrocks/issues/2414,kvrocks,2407428914,2414,Support more script flags in lua script shebang,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,OPEN,2024-07-14T13:08:25Z,2024-08-14T08:55:08Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://redis.io/docs/latest/develop/interact/programmability/lua-api/#script_flags
https://redis.io/docs/latest/develop/interact/programmability/eval-intro/#eval-flags
https://redis.io/docs/latest/develop/interact/programmability/functions-intro/#function-flags

It seems that only the `name` flag of redis function is supported now, and we can support the parsing of some other flags. For example `no-writes`, `allow-cross-slot-keys`, etc.

On the one hand, there are already existing requirements issue: https://github.com/apache/kvrocks/issues/1884 , https://github.com/apache/kvrocks/issues/2133

On the other hand, for the optimization function of Lua script in the future, we may need to support some special flags like dragonflydb to enable optimization. Relevant information:

https://www.dragonflydb.io/docs/managing-dragonfly/scripting

https://www.dragonflydb.io/blog/leveraging-power-of-lua-scripting

https://github.com/apache/kvrocks/issues/2162

### Solution

I'm thinking about how to implement it. Generally speaking, the process of parsing and obtaining flag should be more general.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2414/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FleeL,kvrocks,2241193867,2414,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-07-20T16:06:37Z,2024-07-20T16:06:37Z,"I plan to provide support for `no-writes`, `no-cluster`, `allow-cross-slot-keys` in the next few days.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FleeL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2414,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IY2qH,kvrocks,2288216711,2414,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-08-14T08:54:51Z,2024-08-14T08:54:51Z,"Next I plan to support the `disable-atomicity` flag, which is from dragonflydb, and scripts with `disable-atomicity` are allowed to execute non-atomistically.

* The script will use a separate instance of lua, similar to the current read-only script.
* Commands in a script will collectively use a Context (waiting for the https://github.com/apache/kvrocks/pull/2332 to complete), which provides some isolation (about the snapshot isolation level).
* When this non-atomic script is executed, other non-atomic scripts and common commands (except `MULTI/EXEC`) can also be executed at the same time.

Do you have any suggestions or discussions that you would like to discuss? For example, whether the flag makes sense, and some suggestions for implementation.

As far as the examples provided by dragonfly are concerned, I think `read-only` will solve most of the requirements, and `disable-atomicity` is the more permissive version.
```
#!lua flags=disable-atomicity,allow-undeclared-keys
local cursor = ""0""
repeat
  local result = redis.call(""SCAN"", cursor, ""MATCH"", ""user:*"")
  cursor = result[1]
  for _, user in ipairs(result[2]) do
    process_stats(user)
  end
until cursor == ""0""
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IY2qH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2415,https://api.github.com/repos/apache/kvrocks/issues/2415,kvrocks,2408009597,2415,Support for Redis ACL,PragmaTwice,20042607,Twice,,OPEN,2024-07-15T07:02:08Z,2024-10-22T08:13:21Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://redis.io/docs/latest/operate/oss_and_stack/management/security/acl/

Redis supports more precise and fine-grained access control through ACL. 
We can discuss to what extent Kvrocks can support this.

### Solution

Due to unique features such as namespace in Kvrocks, we need to consider how to better ensure compatibility. 

Please propose your solution before submitting a PR.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2415/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2415,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QwA7l,kvrocks,2428505829,2415,NA,Yangsx-1,85615957,Hauru,,NA,2024-10-22T07:45:27Z,2024-10-22T07:45:27Z,I'll try to do this when available.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QwA7l/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2416,https://api.github.com/repos/apache/kvrocks/issues/2416,kvrocks,2408014535,2416,Add an alternative environment to CentOS in CI,PragmaTwice,20042607,Twice,,CLOSED,2024-07-15T07:05:07Z,2024-07-31T10:39:44Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/apache/kvrocks/blob/unstable/.github/workflows/kvrocks.yaml#L423-L428

Here we used to remove CentOS since it's officially out of support.

But we can add some alternative to CentOS (but still be RHEL-compatible) like Rocky Linux.

### Solution

--

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2416/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2416,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FO55a,kvrocks,2235276890,2416,NA,SpiffyEight77,23716846,Wayne,spiffyeight77@gmail.com,NA,2024-07-18T04:02:07Z,2024-07-18T04:02:07Z,"Hey @PragmaTwice , sorry to bother you at this moment.
I am interested in this issue and would like to contribute.
Could you please assign it to me? 🙇🏻‍♂️

Here's my plan for this task before submitting a PR:
1. Ensure successful source builds in Rocky Linux.
2. Implement the CI logic.
3. Test in GitHub Actions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FO55a/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2416,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FUANn,kvrocks,2236613479,2416,NA,PragmaTwice,20042607,Twice,,NA,2024-07-18T14:01:40Z,2024-07-18T14:01:40Z,Sure! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FUANn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2417,https://api.github.com/repos/apache/kvrocks/issues/2417,kvrocks,2408017497,2417,Add a Debian environment to CI workflow,PragmaTwice,20042607,Twice,,CLOSED,2024-07-15T07:06:43Z,2024-08-30T05:29:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Since we use debian as base image now, we should add a Debian environment to CI workflow:

https://github.com/apache/kvrocks/blob/unstable/.github/workflows/kvrocks.yaml#L423-L428


### Solution

--

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2417/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2418,https://api.github.com/repos/apache/kvrocks/issues/2418,kvrocks,2408024330,2418,Add key expiration support to KQIR,PragmaTwice,20042607,Twice,,OPEN,2024-07-15T07:10:46Z,2024-09-26T22:24:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, KQIR cannot handle expired keys or remove them from the index after they expire.

We need to add this support.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2418/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2418,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6I1lJ5,kvrocks,2295747193,2418,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-08-19T06:15:07Z,2024-08-19T06:15:07Z,Can I be assigned this?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6I1lJ5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2418,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Li0q2,kvrocks,2341161654,2418,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-10T15:01:12Z,2024-09-10T15:01:12Z,"@PragmaTwice What would be most ideal for handling expiring keys, lazy expiration, active expiration, etc.?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Li0q2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2419,https://api.github.com/repos/apache/kvrocks/issues/2419,kvrocks,2408034168,2419,Support full-text searching in Kvrocks Search,PragmaTwice,20042607,Twice,,OPEN,2024-07-15T07:16:54Z,2025-01-28T02:28:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

This includes: 
- Implementing full-text indexing algorithms, such as inverted index, etc. 
- Implementing word tokenization algorithms, which may include languages other than English, such as Chinese. 
- Adding full-text indexing support for KQIR Indexer. 
- Implementing the executor for full-text indexing and adding support in IR optimizer. 
- Supporting relevant syntax parsing in front-end languages (SQL, RediSearch query).

Refer to:
https://github.com/pisa-engine/pisa
https://clucene.sourceforge.net/
https://redis.io/docs/latest/develop/interact/search-and-query/query/full-text/

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2419/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2419,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LEisp,kvrocks,2333223721,2419,NA,lbihani9,49104508,,,NA,2024-09-06T04:44:27Z,2024-09-06T04:44:27Z,I'd like to work on this task. Can this be assigned to me?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LEisp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2419,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LEq52,kvrocks,2333257334,2419,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-06T05:24:28Z,2024-09-06T05:24:28Z,"@lbihani9 Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LEq52/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2419,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRrRY,kvrocks,2336666712,2419,NA,lbihani9,49104508,,,NA,2024-09-08T12:25:00Z,2024-09-08T12:25:00Z,"@git-hulk, I’ve been going through the codebase to better understand the execution flow and added some test commands. However, I find it quite slow to rebuild everything after every update just to check the changes. Does Kvrocks support any hot-reloading features for development?

I haven’t worked on large C++ projects before, so apologies if this is a naive question! 😅","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRrRY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2419,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRrl-,kvrocks,2336668030,2419,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-08T12:29:09Z,2024-09-08T12:29:09Z,"@lbihani9 I can run `./x.py build` for the first time building, and then use `cd build && make -j4` after that.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LRrl-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2419,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LSEaL,kvrocks,2336769675,2419,NA,lbihani9,49104508,,,NA,2024-09-08T17:52:43Z,2024-09-08T17:52:43Z,Thanks! It's much faster now.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LSEaL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2419,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LqT1W,kvrocks,2343124310,2419,NA,lbihani9,49104508,,,NA,2024-09-11T09:27:45Z,2024-09-11T09:27:45Z,"@git-hulk I have been going through the codebase from past couple of days to understand the scope of the task. I've also gone through those 3 links added in this issue's description. I want to understand if we're planning to write the indexing algorithms for full text search from scratch or use apis provided by open-source libraries like `clucene`?

Also, I noticed that for searching we currently do not support `TEXT` datatype so we'll need to integrate that as well.
Since this task's scope is big, I'm planning to create separate PRs for each subtask (this will also allow me to get better hang of the codebase):
 
 1. Supporting TEXT datatype.
 2. Implementing word tokenization.
 3. Implementing Indexing algorithm.
 4. Integrating full-text search support with KQIR.
 
If I've missed any subtask please let me know.
Also, do I need to write a doc first and get the idea approved?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LqT1W/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2419,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LqjR1,kvrocks,2343187573,2419,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-11T09:58:18Z,2024-09-11T09:58:18Z,"@lbihani9 Thanks for your efforts.

The KQIR module was created by @PragmaTwice, so I would like to hear suggestions from him.

> I want to understand if we're planning to write the indexing algorithms for full text search from scratch or use apis provided by open-source libraries like clucene?

I think we don't need to write the indexing algorithms from scratch. It's good to use open source library whose license is in compliance with ASF requirements[1].

[1] https://www.apache.org/legal/resolved.html#category-a","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LqjR1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2419,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ru1GW,kvrocks,2444972438,2419,NA,dmazzella,3988243,Damiano Mazzella,damianomazzella@gmail.com,NA,2024-10-29T17:54:19Z,2024-10-29T17:54:19Z,@PragmaTwice add as reference [Apache Lucene++](https://github.com/luceneplusplus/LucenePlusPlus.git),"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Ru1GW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2420,https://api.github.com/repos/apache/kvrocks/issues/2420,kvrocks,2408048758,2420,Improve index selection pass for ORDER BY clauses in KQIR,PragmaTwice,20042607,Twice,,OPEN,2024-07-15T07:25:10Z,2024-07-15T07:25:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, KQIR does not use the cost model when optimizing record sorting. Instead, it relies on specialized logic. This could be an area for improvement soon.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2420/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/2421,kvrocks,2408055122,2421,Support time series data structure and commands like Redis,PragmaTwice,20042607,Twice,,OPEN,2024-07-15T07:29:02Z,2025-01-30T14:39:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

RedisTimeSeries is a redis module used to operate and query time series data, giving redis basic time series database capabilities.

As Apache Kvrocks is characterized by being compatible with the Redis protocol and commands, we also hope to provide temporal data processing capabilities that are compatible with RedisTimeSeries.

This task is to implement the time series data structure and its commands on Kvrocks. Note: Since Kvrocks is an on-disk database based on RocksDB, the implementation will be quite different from Redis.

https://redis.io/docs/data-types/timeseries/
https://kvrocks.apache.org/community/data-structure-on-rocksdb

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2421/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6E4OyV,kvrocks,2229333141,2421,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2024-07-15T20:22:15Z,2024-07-15T20:22:15Z,"Since this was a GSOC project, I drafted a [TS data structure proposal](https://beihao-rebecca.notion.site/TimeSeries-Proposal-6c5d2f9bc0624a50a209cb8f517109a8) before. Hope this can help give a good starting point! ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6E4OyV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FRaHa,kvrocks,2235933146,2421,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-07-18T08:29:51Z,2024-07-18T08:29:51Z,"Hi @Beihao-Zhou ,

I have read your proposal and have one concern on `Secondary Keys & Values > Label Index`.
The key in proposal is in `[label_key]|[label_value]|[key]` format.
It may need a full iteration scan when purging a key.
Making key as the first prefix part like `[key]|[label_key]|[label_value]` may reduce the complexity on cleanup.

I'm very interested in time series topic and willing to make some contribution in this feature. 😄

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FRaHa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FYwTG,kvrocks,2237859014,2421,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2024-07-19T01:43:28Z,2024-07-19T01:43:28Z,"> Hi @Beihao-Zhou ,
> 
> I have read your proposal and have one concern on `Secondary Keys & Values > Label Index`. The key in proposal is in `[label_key]|[label_value]|[key]` format. It may need a full iteration scan when purging a key. Making key as the first prefix part like `[key]|[label_key]|[label_value]` may reduce the complexity on cleanup.
> 
> I'm very interested in time series topic and willing to make some contribution in this feature. 😄
> 
> Best Regards, Edward

The secondary indexing I proposed is mainly for`MRANGE`, which will do some filtering based on label. So for this command, the secondary index is pretty similar to tag field index in KQIR (#2329). If a key is purged, then I think constructing the corresponding secondary index key and deleting it would be enough?

Let me know if I misunderstand your question. Also feel free to use any idea from the proposal! <3
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FYwTG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FlYMo,kvrocks,2241168168,2421,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-07-20T14:26:03Z,2024-07-20T14:26:03Z,"> > Hi @Beihao-Zhou ,
> > I have read your proposal and have one concern on `Secondary Keys & Values > Label Index`. The key in proposal is in `[label_key]|[label_value]|[key]` format. It may need a full iteration scan when purging a key. Making key as the first prefix part like `[key]|[label_key]|[label_value]` may reduce the complexity on cleanup.
> > I'm very interested in time series topic and willing to make some contribution in this feature. 😄
> > Best Regards, Edward
> 
> The secondary indexing I proposed is mainly for`MRANGE`, which will do some filtering based on label. So for this command, the secondary index is pretty similar to tag field index in KQIR (#2329). If a key is purged, then I think constructing the corresponding secondary index key and deleting it would be enough?
> 
> Let me know if I misunderstand your question. Also feel free to use any idea from the proposal! <3

Hi @Beihao-Zhou ,

Thanks for your patience and response!
I have read the KQIR encoding design and get your point.
I will research more about the Redis's implementation.
Please let me know if we have any new idea on this topic. 😊

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FlYMo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OSjQd,kvrocks,2387227677,2421,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-10-01T22:58:04Z,2024-10-01T22:58:04Z,@Beihao-Zhou Would you mind if I started building the metadata layer based on your proposal?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OSjQd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OS2VQ,kvrocks,2387305808,2421,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2024-10-02T00:18:50Z,2024-10-02T00:18:50Z,"> @Beihao-Zhou Would you mind if I started building the metadata layer based on your proposal?

Ofc! go ahead and lmk if you have any questions :)","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OS2VQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OY7Hp,kvrocks,2388898281,2421,NA,PragmaTwice,20042607,Twice,,NA,2024-10-02T15:02:26Z,2024-10-02T15:02:26Z,@jonathanc-n I think you probably need to contact with @LindaSummer to see if he's currently working on this part.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OY7Hp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OZVLH,kvrocks,2389004999,2421,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-10-02T15:41:43Z,2024-10-02T15:41:43Z,@LindaSummer Have you been working on this part?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OZVLH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OeXGV,kvrocks,2390323605,2421,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-10-03T01:32:52Z,2024-10-03T01:32:52Z,"> @LindaSummer Have you been working on this part?

Hi @jonathanc-n ,

I'm now working on other issues and very happy to see any new progress in this topic. 😊

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OeXGV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ccBoa,kvrocks,2624592410,2421,NA,fukua95,24987055,,fukua95@gmail.com,NA,2025-01-30T13:58:37Z,2025-01-30T13:58:37Z,Can I be assigned this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ccBoa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ccESF,kvrocks,2624603269,2421,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2025-01-30T14:03:01Z,2025-01-30T14:03:01Z,"@fukua95 Thanks for looking into this issue! Let me double check if anyone is working on this. 
Hi @jonathanc-n, just wondering if you're still working on the issue?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ccESF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ccJLp,kvrocks,2624623337,2421,NA,fukua95,24987055,,fukua95@gmail.com,NA,2025-01-30T14:11:07Z,2025-01-30T14:11:07Z,"> [@fukua95](https://github.com/fukua95) Thanks for looking into this issue! Let me double check if anyone is working on this. Hi [@jonathanc-n](https://github.com/jonathanc-n), just wondering if you're still working on the issue?

Thanks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ccJLp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2421,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ccY1U,kvrocks,2624687444,2421,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2025-01-30T14:39:38Z,2025-01-30T14:39:38Z,"@fukua95 I am not working on this issue anymore, feel free to take it up!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ccY1U/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2422,https://api.github.com/repos/apache/kvrocks/issues/2422,kvrocks,2408061812,2422,Improve support for Redis connection management commands,PragmaTwice,20042607,Twice,,OPEN,2024-07-15T07:32:59Z,2024-08-18T05:30:24Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://redis.io/docs/latest/commands/?group=connection

There's many `CLIENT` subcommands that we can evaluate and see if we can support in Kvrocks, like `CLIENT ID/KILL/INFO/LIST/CACHING...`.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2422/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2422,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Iyrey,kvrocks,2294986674,2422,NA,furkan-bilgin,66889545,Furkan Bilgin,info@furkanbilgin.net,NA,2024-08-17T21:10:22Z,2024-08-17T21:10:22Z,Can I be assigned this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Iyrey/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2422,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IzMFv,kvrocks,2295120239,2422,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-18T05:30:23Z,2024-08-18T05:30:23Z,"@furkan-bilgin Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IzMFv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2423,https://api.github.com/repos/apache/kvrocks/issues/2423,kvrocks,2408093119,2423,Support t-digest data structure and commands,PragmaTwice,20042607,Twice,,OPEN,2024-07-15T07:51:20Z,2024-09-09T02:30:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Redis Stack already supports this probabilistic data structure, and we can support it too.

https://redis.io/docs/latest/develop/data-types/probabilistic/t-digest/
https://redis.io/blog/t-digest-in-redis-stack/
https://redis.io/docs/latest/commands/?group=tdigest


### Solution

Please share your design proposal through issue/discussion before submitting a PR.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2423/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2423,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Izw3d,kvrocks,2295270877,2423,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-08-18T13:50:07Z,2024-08-18T13:50:07Z,"Hi @PragmaTwice ,

I want to work on this issue. 😊
Can it be assigned to me?

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Izw3d/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2423,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Iz0ai,kvrocks,2295285410,2423,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-18T14:37:46Z,2024-08-18T14:37:46Z,"@LindaSummer Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Iz0ai/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2423,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LS5oC,kvrocks,2336987650,2423,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-09T02:25:41Z,2024-09-09T02:25:41Z,"@LindaSummer Hello, is this still being worked on?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LS5oC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2423,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LS6rS,kvrocks,2336991954,2423,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-09-09T02:30:38Z,2024-09-09T02:30:38Z,"> @LindaSummer Hello, is this still being worked on?

Hi @jonathanc-n ,

Sorry for delay update.
I'm still working on the issue and reading related papers and implementations.
I will make a draft proposal in recent. 😄

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LS6rS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2424,https://api.github.com/repos/apache/kvrocks/issues/2424,kvrocks,2408097334,2424,Support Top-K data structure and commands,PragmaTwice,20042607,Twice,,OPEN,2024-07-15T07:53:55Z,2024-07-27T16:25:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Redis Stack already supports this probabilistic data structure, and we can support it too.

https://redis.io/docs/latest/develop/data-types/probabilistic/top-k/
https://redis.io/docs/latest/commands/?group=topk

### Solution

Please share your design proposal through issue/discussion before submitting a PR.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2424/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2424,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FkgxB,kvrocks,2240941121,2424,NA,zweix123,74446314,zweix,,NA,2024-07-20T05:57:03Z,2024-07-20T05:57:03Z,I hope to complete this issue. Can you assign it to me.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FkgxB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2424,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FkhsR,kvrocks,2240944913,2424,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-07-20T06:09:04Z,2024-07-20T06:09:04Z,"@zweix123 Assigned, thank you! Could you please propose the design before starting implementation? So that we can discuss the design in the early stage.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FkhsR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2424,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Fkh22,kvrocks,2240945590,2424,NA,zweix123,74446314,zweix,,NA,2024-07-20T06:10:57Z,2024-07-20T06:10:57Z,"> @zweix123 Assigned, thank you! Could you please propose the design before starting implementation? So that we can discuss the design in the early stage.

Yes, I have such thoughts. Please give me some time, it won't be too long, about a day.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Fkh22/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2424,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FkiVd,kvrocks,2240947549,2424,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-07-20T06:17:34Z,2024-07-20T06:17:34Z,"@zweix123 Thank you! There's no rush, it's good to propose the design while you get time and are ready to review.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FkiVd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2424,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6GXEAC,kvrocks,2254192642,2424,NA,zweix123,74446314,zweix,,NA,2024-07-27T16:25:08Z,2024-07-27T16:25:08Z,"A considerable amount of design has been completed, but there are some difficulties that will be discussed here: [Kvrocks-Discussions-Difficulties in designing documents for Top-K data structures and commands #2449](https://github.com/apache/kvrocks/discussions/2449).","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6GXEAC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2425,https://api.github.com/repos/apache/kvrocks/issues/2425,kvrocks,2408100053,2425,Support count-min sketch data structure and commands,PragmaTwice,20042607,Twice,,OPEN,2024-07-15T07:55:27Z,2024-08-18T04:34:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Redis Stack already supports this probabilistic data structure, and we can support it too.

https://redis.io/docs/latest/develop/data-types/probabilistic/count-min-sketch/
https://redis.io/docs/latest/commands/?group=cms


### Solution

Please share your design proposal through issue/discussion before submitting a PR.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2425/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2425,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IzFAb,kvrocks,2295091227,2425,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-08-18T03:07:56Z,2024-08-18T03:07:56Z,Can I be assigned this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IzFAb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2425,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IzJV2,kvrocks,2295108982,2425,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-08-18T04:34:38Z,2024-08-18T04:34:38Z,"@jonathanc-n FYI, you can first add a proposal, like [1][2], then after discussion, you can draft the website work and in the mean time working on implementation

[1] https://github.com/apache/kvrocks/discussions/2438
[2] https://github.com/apache/kvrocks/discussions/2449
[3] https://github.com/apache/kvrocks-website/pull/207
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IzJV2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2426,https://api.github.com/repos/apache/kvrocks/issues/2426,kvrocks,2409562317,2426,Tracking Issue: Support vector search in KQIR,Beihao-Zhou,68083940,Beihao Zhou,,OPEN,2024-07-15T20:26:44Z,2024-08-08T14:33:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.

### Motivation

This includes:
- [x] Implementing vector indexing algorithm, i.e. HNSW & Adding vector indexing support for KQIR Indexer - #2368
- [x] Plan operator & executor for vector indexing - #2434 
- [x] Supporting relevant syntax parsing in front-end languages (SQL, RediSearch query) - #2450 
- [x] Add Optimization Pass, including Index Selection & KnnExpr transformation - #2466 
- [x] Add command to support Hnsw index creation - #2477  
- [x] Documentation on Kvrocks Search - https://github.com/apache/kvrocks-website/pull/241

### Further Steps
- [ ] Improvement for HNSW construction - #2398 
- [ ] Create a const version of HnswIndex that takes a const pointer to HnswVectorFieldMetadata - https://github.com/apache/kvrocks/pull/2434#discussion_r1687707134
- [ ] Support Hybrid Query
- [ ] Improve consistency


### Solution

- #2287
- #2316 

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2426/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2426,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6G4g7b,kvrocks,2262961883,2426,NA,PragmaTwice,20042607,Twice,,NA,2024-08-01T12:50:54Z,2024-08-01T12:50:54Z,Would you like to add the encoding format of vector index to https://kvrocks.apache.org/community/kvrocks-search-index-encoding/ when you have time?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6G4g7b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2427,https://api.github.com/repos/apache/kvrocks/issues/2427,kvrocks,2410049229,2427,Set default value of redis_cursor_compatible to yes,pangtujun,39116231,,,CLOSED,2024-07-16T02:25:02Z,2024-07-16T10:49:05Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

希望redis_cursor_compatible 参数默认设置成yes，支持scan命令

### Solution

希望redis_cursor_compatible 参数默认设置成yes，支持scan命令

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2427/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2427,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6E9CYg,kvrocks,2230593056,2427,NA,PragmaTwice,20042607,Twice,,NA,2024-07-16T10:48:56Z,2024-07-16T10:48:56Z,Fixed in #2429.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6E9CYg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2432,https://api.github.com/repos/apache/kvrocks/issues/2432,kvrocks,2412969181,2432,Allow usage of shared libraries during build / make Linux packaging easier,der-eismann,10406217,Philipp Trulson,,OPEN,2024-07-17T08:16:33Z,2024-07-17T09:47:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

While the primary use case of kvrocks lies in containerized environments, it would be great to make it easier to use in normal OS environments. One way would be to provide RPM & DEB files, but in https://github.com/apache/kvrocks/discussions/1152#discussioncomment-4297513 it was made clear that this won't happen, which is okay. But the only alternatives are OS packages (which are only provided by Arch AUR at this point) or building binaries yourself, which could be an obstacle for some.

My main issue with the build process is that all needed libraries are downloaded and built as static libraries, this is usually a no-go for Linux packagers. For some things like RocksDB it probably makes sense to use a pinned version, but zstd and snappy should be easy targets to use dynamically. 

### Solution

Make it possible to use locally available libraries and headers instead of downloading all dependencies during the build.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2432/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2432,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FFzrG,kvrocks,2232892102,2432,NA,PragmaTwice,20042607,Twice,,NA,2024-07-17T09:46:08Z,2024-07-17T09:46:08Z,"Refer to https://kvrocks.apache.org/download/third-party-packages.

The Apache Kvrocks PMC doesn't maintain prebuilt binaries for any Linux distro (except the official Docker image).

But out of the PMC, some contributors in the community does maintain some Linux packages for Kvrocks.

Currently it includes:
- [kvrocks-fpm](https://github.com/RocksLabs/kvrocks-fpm): currently just prebuilt DEB package for Ubuntu, but ideally can be extended to many package format like RPM in other distros... (you can download them via [Releases](https://github.com/RocksLabs/kvrocks-fpm/releases).)
- [kvrocks in AUR](https://aur.archlinux.org/packages/kvrocks): a ArchLinux package for Kvrocks

Actually, both of these projects are mainly maintained by me in my spare time. 

Currently, I don't have much time to improve kvrocks-fpm and expand it to other package formats besides DEB. But if anyone is interested and willing to help complete this task, I would be very grateful.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FFzrG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2433,https://api.github.com/repos/apache/kvrocks/issues/2433,kvrocks,2413653898,2433,Conflicting PID file locations in config comments,der-eismann,10406217,Philipp Trulson,,CLOSED,2024-07-17T13:38:42Z,2024-08-25T06:18:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.9.0

### Minimal reproduce step

-

### What did you expect to see?

Correct and precise comments

### What did you see instead?

First in the config it says
```
# By default, kvrocks does not run as a daemon. Use 'yes' if you need it.
# Note that kvrocks will write a PID file in /var/run/kvrocks.pid when daemonized
daemonize no
```

and then
```
# When running in daemonize mode, kvrocks writes a PID file in ${CONFIG_DIR}/kvrocks.pid by
# default. You can specify a custom pid file location here.
# pidfile /var/run/kvrocks.pid
```

And `/var/run` is definitely not a `${CONFIG_DIR}`. One of these two seems to be off.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2433/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2433,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FHqwa,kvrocks,2233379866,2433,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-07-17T13:50:56Z,2024-07-17T13:50:56Z,"Hi @der-eismann 

Thanks for your report. The default `pidfile` should be located in `{dir}/kvrocks.pid` instead of `{CONFIG_DIR}` or `/var/run` dir. For the implementation, please refer to https://github.com/apache/kvrocks/blob/unstable/src/config/config.cc#L415","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6FHqwa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2435,https://api.github.com/repos/apache/kvrocks/issues/2435,kvrocks,2415785412,2435,Fix compiler warnings,jjz921024,19649281,anotherJJz,470623352@qq.com,CLOSED,2024-07-18T08:59:06Z,2024-07-18T13:57:06Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

When I compile the latest code, I found the following warning:

```
kvrocks/src/commands/cmd_cluster.cc:314:11: warning: private field 'slot_' is not used [-Wunused-private-field]
int64_t slot_ = -1;
```

```
In file included from kvrocks/src/search/hnsw_indexer.cc:21:
kvrocks/src/search/hnsw_indexer.h:81:1: warning: 'HnswIndex' defined as a struct here but previously declared as a class; this is valid, but may result in linker errors under the Microsoft C++ ABI [-Wmismatched-tags]
struct HnswIndex {
^
/home/skyjiang/c-project/kvrocks/src/search/hnsw_indexer.h:34:1: note: did you mean struct here?
class HnswIndex;
^~~~~
```

### Solution

Do we need to resolve these warning? Make the compilation log clean.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2435/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2437,https://api.github.com/repos/apache/kvrocks/issues/2437,kvrocks,2418410357,2437,Prohibit the execution of cross-slot commands in MULTI,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,OPEN,2024-07-19T08:58:26Z,2024-07-19T08:59:05Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I found this issue while trying to support scirpt flag `allow-cross-slot-keys`
Related discussions in redis:
https://github.com/redis/redis/issues/10503
https://github.com/redis/redis/issues/13140

kvrocks currently does not prohibit `cross-slot` in `MULTI-EXEC`. Is there any mechanism to provide protection? If not we should ban it.

### Solution

I noticed that there is `CanExecByMySelf` to make relevant judgments, but it seems to be only suitable for checking whether the slots of multiple keys operated by a single command are the same, but does not detect the situation of multiple commands (such as MULTI-EXEC and scirpt). We may need to track multiple Commands using slots.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2437/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2445,https://api.github.com/repos/apache/kvrocks/issues/2445,kvrocks,2428822442,2445,Support parsing the configuration with unit type,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-07-25T02:32:54Z,2024-07-28T03:19:03Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, some configurations are in units of bytes which are not intuitive for human reading. So we would like to introduce a new config type like `IntWithUnitField` or `BytesField` to mitigate this issue.

For example, the following configurations are allowed:

```
rocksdb.block_size 16384
```

or

```
rocksdb.block_size 16k
```

and it will be rewritten to human readable format if possible.


### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2445/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2454,https://api.github.com/repos/apache/kvrocks/issues/2454,kvrocks,2439107511,2454,Tracking issue: HyperLogLog,mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2024-07-31T04:45:03Z,2024-08-04T06:10:02Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Add HyperLogLog for kvrocks

* [x] Dense HLL design: https://github.com/apache/kvrocks-website/pull/207
* [x] Dense HLL PFADD/PFCOUNT: https://github.com/apache/kvrocks/pull/2142
* [x] Dense HLL Merge Support: https://github.com/apache/kvrocks/pull/2457
* [ ] Sparse HLL design
* [ ] Sparse HLL all commands support
* [x] Golang script tests https://github.com/apache/kvrocks/pull/2463
* [ ] Migration tests

### Solution

See https://github.com/apache/kvrocks/discussions/2438

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2454/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2458,https://api.github.com/repos/apache/kvrocks/issues/2458,kvrocks,2440674619,2458,Kvrocks & IngestExternalFile,matan129,1483099,Matan Rosenberg,matan129@gmail.com,OPEN,2024-07-31T18:29:31Z,2025-01-22T09:27:39Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Hi folks,

First of all - I just wanted to say that this is an awesome project 🙂 

Secondly -

I wondered whether it's possible to load data to Kvrocks via RocksDB's [IngestExternalFile](https://github.com/facebook/rocksdb/wiki/creating-and-ingesting-sst-files).

The use case is real-world. 

I currently work on a system that relies on (non-distributed) RocksDB, and we'd like to possible start using Kvrocks instead.
Every once in a while, we use an offline, ""bulky"" Spark process which essentially generates a complete view of the RocksDB database.
This is done by creating SST files directly, which is pretty cool*.
The system then downloads these files locally and just points RocksDB to use them.
This way, we can leverage Spark's super-scalable compute to create a dataset (of ~20B tiny records) which would otherwise take a long, long time to write to an empty RocksDB database.

**Q:**
Since Kvrocks uses RocksDB as its backend, I wondered - how hard would it be to do something like this?

Thanks!


---

* Technically: we create a Spark dataframe with the data in two columns, and we sort the data globally by key.
Then, a custom Spark module we've written creates an SST file using the RocksJava binding.
Each dataframe partition is turned into a separate SST file.
Since the data is sorted and keys are strictly unique, the SST files are non-overlapping, and thus are ingested to the bottomest level of RocksDB.

### Solution

I assume that a solution would involve the following components:

1. An offline library to create Kvrocks-compatible SSTs (i.e. conforming to [this](https://kvrocks.apache.org/community/data-structure-on-rocksdb))
2. A server API which can be given a list of SSTs to download and create a Kvrocks set from, using RockDB's IngestExternalFile.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2458/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2458,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6G0u5F,kvrocks,2261970501,2458,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-01T04:13:05Z,2024-08-01T04:13:05Z,"Hi @matan129 Thanks for raising this discussion.

Yes, some users also proposed to support ingesting extern files: #1301, #1628. And the solution  what you have mentioned is correct to implement this feature. But AFAIK, no community volunteer is working on it for now. Welcome to contribute if you're willing to do that.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6G0u5F/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2458,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6bXzws,kvrocks,2606709804,2458,NA,fukua95,24987055,,fukua95@gmail.com,NA,2025-01-22T09:27:37Z,2025-01-22T09:27:37Z,Can I be assigned this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6bXzws/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2468,https://api.github.com/repos/apache/kvrocks/issues/2468,kvrocks,2447924524,2468,how to migrate pika to kvrocks,epubreader,8253681,Mason Yang,,CLOSED,2024-08-05T08:22:57Z,2024-08-08T07:40:12Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

how to migrate pika to kvrocks?
redis-shake doesn't work

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2468/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2468,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HOEo5,kvrocks,2268613177,2468,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-05T09:31:10Z,2024-08-05T09:31:10Z,"It needs to depend on whether Pika has any way to migrate data to other Redis targets, and I'm unsure about this. And for the redis-shake, it's used to migrate Redis server instead of Pika, but maybe we can have a try a scan mode which only requires Pika supports the scan command.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HOEo5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2468,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HnAi3,kvrocks,2275150007,2468,NA,epubreader,8253681,Mason Yang,,NA,2024-08-08T07:36:31Z,2024-08-08T07:36:31Z,"both scan mode and Sync Reader do not work,
but I wrote the scan code myself and have migrated pika to kvrocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HnAi3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2468,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HnCLF,kvrocks,2275156677,2468,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-08T07:40:11Z,2024-08-08T07:40:11Z,@epubreader Great!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HnCLF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2469,https://api.github.com/repos/apache/kvrocks/issues/2469,kvrocks,2448497871,2469,Proposal: add a new command for polling new updates by sequence,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-08-05T12:58:13Z,2024-08-09T01:56:22Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, RocksDB provides an API `GetUpdatesSince` to allow us to poll the write batched by the sequence number. And Kvrocks is now depending on this mechanism to implement the partial sync(PSYNC). Except for that, the official migration tool `kvrocks2redis` is also using it to fetch new updates after parsing the entire DB, but it requires running alongside the DB dir.  In some scenarios like CDC(Change Stream Capture) also has this requirement, but it’ll be too troublesome if it requires running an agent alongside each Kvrocks node.

As far as I know, some users also have this similar requirement[1]. So I propose to add a new command for this purpose:

```bash
POLLUPDATES <Sequence Number> [MAX <N>] [STRICT] [FORMAT <RAW>]
```

- `Sequence Number` represents the start sequence of the polling operation and it’s a required argument.
- `MAX` represents the maximum number of items that can be retrieved, it’s an optional argument and uses `16` as the default value if it’s missing
- `STRICT` is set means the update’s sequence MUST be exactly equal to the sequence number, it’s an optional argument. `GetUpdatesSince` will return the first available sequence if the sequence number is non-existent, so we allow users to specify if required to match the input sequence number.

And we also can extend more arguments like TIMEOUT/MIN, etc..


[1] https://www.revenuecat.com/blog/engineering/how-we-replicate-kvrocks-dataset/


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2469/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HQBVR,kvrocks,2269123921,2469,NA,PragmaTwice,20042607,Twice,,NA,2024-08-05T13:47:27Z,2024-08-05T13:47:27Z,"Good idea! Some comments:
- What's the output (and output format) of this command?
- How to get the sequence number (by commands)?
- `POLLING UPDATES` seems a little weird, could it be something like `POLLUPDATES`?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HQBVR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HQKia,kvrocks,2269161626,2469,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-05T14:04:21Z,2024-08-05T14:04:21Z,"> What's the output (and output format) of this command?

My initial thought is to support the raw batch(hex format) first, and then support the optional argument FORMAT in the following PR.

> How to get the sequence number (by commands)?

We now could get the sequence number from the INFO command, to see if it is necessary to add a dedicated command for this.

> POLLING UPDATES seems a little weird, could it be something like POLLUPDATES?

Sure, `POLLUPDATES` is good since I cannot foresee any other behaviors except updates for now.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HQKia/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HQMdm,kvrocks,2269169510,2469,NA,PragmaTwice,20042607,Twice,,NA,2024-08-05T14:07:41Z,2024-08-05T14:07:41Z,"> My initial thought is to support the raw batch(hex format) first, and then support the optional argument FORMAT in the following PR.

maybe we can add a RAW flag now? to make it extensible.

> We now could get the sequence number from the INFO command, to see if it is necessary to add a dedicated command for this.

I think it's hard to use since users need to parse the output of INFO manually to get it. maybe a seperate command is better.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HQMdm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2469,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HQPrf,kvrocks,2269182687,2469,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-05T14:13:21Z,2024-08-05T14:13:21Z,"> maybe we can add a RAW flag now? to make it extensible.

Sure, I have updated this.

> I think it's hard to use since users need to parse the output of INFO manually to get it. maybe a seperate command is better.

What about adding a SEQUENCE command?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HQPrf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/2473,kvrocks,2452864473,2473,Blocking commands may block permanently due to lost wakeup,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,OPEN,2024-08-07T08:16:01Z,2024-10-29T15:38:18Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

I discovered this issue while testing a PR(https://github.com/apache/kvrocks/pull/2332), even though the PR increased the likelihood of it occurring, the problem actually existed beforehand.
It is difficult to reproduce manually without modifying the code, and it almost exclusively occurs during Go's integration tests.
Here's an example with `TestRegression`:
```go
func TestRegression(t *testing.T) {
    srv := util.StartServer(t, map[string]string{})
    defer srv.Close()

    ctx := context.Background()
    rdb := srv.NewClient()
    defer func() { require.NoError(t, rdb.Close()) }()

    c := srv.NewTCPClient()
    defer func() { require.NoError(t, c.Close()) }()

    proto := ""*3\r\n$5\r\nBLPOP\r\n$6\r\nhandle\r\n$1\r\n0\r\n""
    require.NoError(t, c.Write(fmt.Sprintf(""%s%s"", proto, proto)))

    resList := []string{""*2"", ""$6"", ""handle"", ""$1"", ""a""}

    v := rdb.RPush(ctx, ""handle"", ""a"")
    require.EqualValues(t, 1, v.Val())
    for _, res := range resList {
        c.MustRead(t, res)
    }

    v = rdb.RPush(ctx, ""handle"", ""a"")
    require.EqualValues(t, 1, v.Val())

    for _, res := range resList {
        c.MustRead(t, res)
    }
}
```

By printing some information, I was able to trace the error:
```
Start Execute BPOP
TryPopFormList

CommandPush::Execute
WakeupBlockingConns: handle, n_conns: 1
CommandPush::Execute OK

BlockingCommander::StartBlocking
BlockKeys
```
The issue occurs here:
```cpp
// CommandBPop
  Status Execute(Server *srv, Connection *conn, std::string *output) override {
    srv_ = srv;
    InitConnection(conn);

    auto s = TryPopFromList();
    if (s.ok() || !s.IsNotFound()) {
      return Status::OK();  // error has already output in TryPopFromList
    }
    // <==HERE: Push is done after TryPopFromList, but not yet Blocking
    return StartBlocking(timeout_, output);
  }
```

To manually reproduce the issue consistently, you can add a sleep and complete a PUSH within 5 seconds:
```cpp
  Status Execute(Server *srv, Connection *conn, std::string *output) override {
    srv_ = srv;
    InitConnection(conn);

    auto s = TryPopFromList();
    if (s.ok() || !s.IsNotFound()) {
      return Status::OK();  // error has already output in TryPopFromList
    }
    std::cout << ""Sleep for 5 seconds"" << std::endl;
    std::this_thread::sleep_for(std::chrono::seconds(5));
    std::cout << ""Wake up"" << std::endl;
    return StartBlocking(timeout_, output);
  }
```
![image](https://github.com/user-attachments/assets/e6165178-d571-45aa-8e59-0aed4bd9abbb)


### What did you expect to see?

Blocking commands will not be blocked after new key values ​​are added.

### What did you see instead?

Blocking command blocks permanently.

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2473/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6He9hZ,kvrocks,2273040473,2473,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-07T09:33:30Z,2024-08-07T09:33:30Z,"@PokIsemaine I'm not sure if I understood your point correctly:

1. Client-A sends B[L|R]POP command to Kvrocks and no element in the list at that time
2. Client-B publishes an element but Client-A hasn't entered the blocking mode, so Client-B's message won't wake up the Client-A.
3. Client-A needs to be pending until the next publish message

Is that right?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6He9hZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HfNwQ,kvrocks,2273106960,2473,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-08-07T10:07:41Z,2024-08-07T10:07:41Z,"> @PokIsemaine I'm not sure if I understood your point correctly:
> 
> 1. Client-A sends B[L|R]POP command to Kvrocks and no element in the list at that time
> 2. Client-B publishes an element but Client-A hasn't entered the blocking mode, so Client-B's message won't wake up the Client-A.
> 3. Client-A needs to be pending until the next publish message
> 
> Is that right?

Yeah","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HfNwQ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HfYRd,kvrocks,2273150045,2473,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-07T10:31:00Z,2024-08-07T10:31:00Z,"I see. Thank you for raising this issue. I knew this issue indeed, but didn't find a proper way to solve the data race. It's nice to have an issue to track this.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HfYRd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6MIPKP,kvrocks,2350969487,2473,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-09-14T12:10:52Z,2024-09-14T12:10:52Z,/assign,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6MIPKP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RrX4T,kvrocks,2444066323,2473,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-10-29T12:24:23Z,2024-10-29T12:24:23Z,"I forgot this a bit, is this issue fixed?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RrX4T/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Rs7lk,kvrocks,2444474724,2473,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-10-29T14:43:14Z,2024-10-29T14:43:14Z,"@RiversJin tells me and I just realized that Blocking commands might need a mechenism for lock and blocking. Some commands, like bzpop, would block on multiple keys. If multiple bzpop comming with same key and different order, would this being a dead lock?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Rs7lk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RtK5c,kvrocks,2444537436,2473,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-10-29T15:05:44Z,2024-10-29T15:05:44Z,"> @RiversJin tells me and I just realized that Blocking commands might need a mechenism for lock and blocking. Some commands, like bzpop, would block on multiple keys. If multiple bzpop comming with same key and different order, would this being a dead lock?

We can try using `MultiLockGuard` to get the locks in the same order","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RtK5c/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RtNkg,kvrocks,2444548384,2473,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-10-29T15:08:28Z,2024-10-29T15:08:28Z,"> I forgot this a bit, is this issue fixed?

It's probably not fixed yet, but I think it might be resolved after https://github.com/apache/kvrocks/pull/2620. I'll test this part later.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RtNkg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RtOZl,kvrocks,2444551781,2473,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-10-29T15:09:44Z,2024-10-29T15:09:44Z,"> We can try using MultiLockGuard to get the locks in the same order

That's not lock, I think ""BlockKeys"" might following the same ordering? Or we should have a very well-defined order for ""Lock-acquire - blockOnKey - LockRelease"". The later part can be solved by https://github.com/apache/kvrocks/pull/2620 or being a different patch

The current problem is that the sequence is ""Lock-acquire - LockRelease - blockOnKey"", which between release and blockOn the whole things can be done by another thread","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RtOZl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Rti6l,kvrocks,2444635813,2473,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-10-29T15:35:20Z,2024-10-29T15:35:20Z,"The blockKeys itself might not blocking, my bad, this can(and might should) be handled by well-designed sequence","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Rti6l/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RtjwH,kvrocks,2444639239,2473,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-10-29T15:36:13Z,2024-10-29T15:36:13Z,"But after https://github.com/apache/kvrocks/pull/2620, the lock is released after the blockkey","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RtjwH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2473,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Rtle5,kvrocks,2444646329,2473,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-10-29T15:38:17Z,2024-10-29T15:38:17Z,"Aha, you're right. So this **should** be fixed after that. Maybe we can also denote that the lock should be held when `StartBlocking` and `OnWrite` called","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Rtle5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2474,https://api.github.com/repos/apache/kvrocks/issues/2474,kvrocks,2453326750,2474,Add a slow flag to commands with heavy disk IO,PragmaTwice,20042607,Twice,,CLOSED,2024-08-07T12:09:51Z,2024-09-02T10:36:26Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

We can add a new command flag e.g. `slow` and apply it to all commands that can lead to heavy disk IO (rocksdb read/write).

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2474/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2474,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IXhOP,kvrocks,2287866767,2474,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-08-14T05:08:38Z,2024-08-14T05:08:38Z,Is there any mechanism that will accompany this flag after it is added? And what is the metric for  heavy disk IO?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IXhOP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2474,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IXk1R,kvrocks,2287881553,2474,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-08-14T05:24:51Z,2024-08-14T05:24:51Z,"> Is there any mechanism that will accompany this flag after it is added?

Generally there're easier way and heavier way. Tagging can allow better techniques for scheduling, like independent io-task-pool or throttle for these tasks ( These techniques doesn't be implemented now, lol). Generally for user task ""heavy request"" might have a lower priority and avoid affect the light operations

> And what is the metric for heavy disk IO?

No, lol, I guess this should be guessed by user and a bit hard to analysis, especially on zset or other heavy structure

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IXk1R/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2474,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IYcC2,kvrocks,2288107702,2474,NA,PragmaTwice,20042607,Twice,,NA,2024-08-14T08:07:10Z,2024-08-14T08:07:10Z,"> And what is the metric for heavy disk IO?

A simple method is to check that if a command only involves a constant number of rocksdb read/writes, e.g. `LPUSH`, `SET`, `HSET`.

Otherwise it can be a time consuming operation, e.g. `HGETALL`, `LINSERT`... (the number of rocksdb read/writes is not constant, e.g. `O(n)`, where `n` is a runtime variable like size of the data structure.)
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IYcC2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2474,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IYeyF,kvrocks,2288118917,2474,NA,PragmaTwice,20042607,Twice,,NA,2024-08-14T08:13:01Z,2024-08-14T08:13:01Z,"> Is there any mechanism that will accompany this flag after it is added?

Like mentioned by @mapleFU , it has potential benefits for optimization and scheduling.

Also, we can generate some doc from it to let users know which commands are time-consuming.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IYeyF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2474,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IaLdn,kvrocks,2288564071,2474,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-08-14T12:05:46Z,2024-08-14T12:05:46Z,"Besides, the heavy disk ""write"" IO api might have higher risk on new Context api: https://github.com/apache/kvrocks/pull/2332","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IaLdn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2474,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Io8M8,kvrocks,2292433724,2474,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-08-15T23:09:59Z,2024-08-15T23:09:59Z,"Can I be assigned this issue?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Io8M8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2474,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IrS27,kvrocks,2293050811,2474,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-16T08:17:22Z,2024-08-16T08:17:22Z,"@jonathanc-n Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IrS27/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2475,https://api.github.com/repos/apache/kvrocks/issues/2475,kvrocks,2453352100,2475,Remove  speedb due to it's lack of active in the public repository,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-08-07T12:22:47Z,2024-08-07T16:10:52Z,"The speedb is no longer active in the public repository after the acquisition, maybe we can remove it. What do you think? @apache/kvrocks-committers

_Originally posted by @git-hulk in https://github.com/apache/kvrocks/issues/2332#issuecomment-2270418939_
            ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2475/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2475,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HgaIp,kvrocks,2273419817,2475,NA,torwig,8588372,Yaroslav,,NA,2024-08-07T13:01:23Z,2024-08-07T13:01:23Z,@git-hulk How long they haven't been active?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HgaIp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2475,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HgdCE,kvrocks,2273431684,2475,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-08-07T13:06:58Z,2024-08-07T13:06:58Z,"The last commit appears 5 month ago🤔

We can do a fast checking in https://github.com/apache/kvrocks/pull/2332 whether it's a bug for stream or other, if it's a not a bug, and we rely on some undefined behavior in rocksdb we need fix that. If speedb has bug then let's just remove it","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HgdCE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2475,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HgeKP,kvrocks,2273436303,2475,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-08-07T13:09:10Z,2024-08-07T13:09:10Z,Oh damn: https://www.speedb.io/ they're acquired by redis now 😅 Lets just remove that,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HgeKP/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2475,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HghSO,kvrocks,2273449102,2475,NA,PragmaTwice,20042607,Twice,,NA,2024-08-07T13:15:22Z,2024-08-07T13:15:22Z,+1.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HghSO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2475,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HgqaB,kvrocks,2273486465,2475,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-07T13:32:21Z,2024-08-07T13:32:21Z,"@torwig Yes, it's about 5 months which is the time point after acquisition.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6HgqaB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2475,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Hgu8q,kvrocks,2273505066,2475,NA,torwig,8588372,Yaroslav,,NA,2024-08-07T13:40:45Z,2024-08-07T13:40:45Z,5 months. Then +1.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Hgu8q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2478,https://api.github.com/repos/apache/kvrocks/issues/2478,kvrocks,2455908324,2478,Add more tests for stream consumer group,Yangsx-1,85615957,Hauru,,CLOSED,2024-08-08T14:07:01Z,2024-09-19T12:17:44Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

We should add more test cases for stream consumer group, especially for the time related information such as idle time and inactive time, and other information in XINFO command.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2478/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L6iEk,kvrocks,2347376932,2478,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-12T22:54:15Z,2024-09-12T22:54:15Z,@PragmaTwice @git-hulk What is the syntax for isolating go tests for testing?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L6iEk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L6uw7,kvrocks,2347428923,2478,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-12T23:57:35Z,2024-09-12T23:57:35Z,@Yangsx-1 Are there any tests you would like to add in particular? Checking certain functionality?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L6uw7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8Z6d,kvrocks,2347867805,2478,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-13T01:42:24Z,2024-09-13T01:42:24Z,"> @PragmaTwice @git-hulk What is the syntax for isolating go tests for testing?

What do you mean by isolating go tests? Are you asking how to run the specified test cases?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8Z6d/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8aws,kvrocks,2347871276,2478,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-13T01:44:17Z,2024-09-13T01:44:17Z,"@git-hulk Yes, specified test cases.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8aws/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8epf,kvrocks,2347887199,2478,NA,Yangsx-1,85615957,Hauru,,NA,2024-09-13T01:52:11Z,2024-09-13T01:52:11Z,"> @Yangsx-1 Are there any tests you would like to add in particular? Checking certain functionality?

I think we should pay attention to time related variables, such as idel time and inactive time in XINFO CONSUMERS, and some counter variables such as pending number, last_delivered_id, entries_read, lag and so on.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8epf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8fW9,kvrocks,2347890109,2478,NA,Yangsx-1,85615957,Hauru,,NA,2024-09-13T01:55:07Z,2024-09-13T01:55:07Z,"> @git-hulk Yes, specified test cases.

You can run command like this: `./x.py test go ./build -run ^TestStreamOffset$ github.com/apache/incubator-kvrocks/tests/gocase/unit/type/stream -v`, and you can change `TestStreamOffset` when you want to test other go functions.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8fW9/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8fdR,kvrocks,2347890513,2478,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-13T01:55:37Z,2024-09-13T01:55:37Z,"> @git-hulk Yes, specified test cases.

You can run with `-test.run`. For example, I want to run the test case `TestFullSyncReplication`, then you should enter the dir `tests/gocase/integration/replication` and run `go test -test.run ""TestFullSyncReplication"" -workspace /tmp -binPath {Your Kvrocks Binary Path}`.

Remember to replace `{Your Kvrocks Binary Path}` with your owner Kvrocks binary path.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8fdR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2478,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8hYa,kvrocks,2347898394,2478,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-13T02:02:47Z,2024-09-13T02:02:47Z,@Yangsx-1 @git-hulk Thank you guys,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6L8hYa/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2481,https://api.github.com/repos/apache/kvrocks/issues/2481,kvrocks,2458176525,2481,Benchmark for vector indexing and searching,PragmaTwice,20042607,Twice,,OPEN,2024-08-09T15:30:30Z,2024-08-12T04:34:30Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

We can try to use this repo: https://github.com/qdrant/vector-db-benchmark

After some simple patching:
```patch
diff --git a/engine/clients/redis/configure.py b/engine/clients/redis/configure.py
index a5e6fe8..b2b8af0 100644
--- a/engine/clients/redis/configure.py
+++ b/engine/clients/redis/configure.py
@@ -7,6 +7,7 @@ from redis.commands.search.field import (
     TextField,
     VectorField,
 )
+from redis.commands.search.indexDefinition import IndexDefinition, IndexType
 
 from benchmark.dataset import Dataset
 from engine.base_client.configure import BaseConfigurator
@@ -81,7 +82,7 @@ class RedisConfigurator(BaseConfigurator):
                 name=""vector"",
                 algorithm=""HNSW"",
                 attributes={
-                    ""TYPE"": ""FLOAT32"",
+                    ""TYPE"": ""FLOAT64"",
                     ""DIM"": dataset.config.vector_size,
                     ""DISTANCE_METRIC"": self.DISTANCE_MAPPING[dataset.config.distance],
                     **self.collection_params.get(""hnsw_config"", {}),
@@ -97,8 +98,13 @@ class RedisConfigurator(BaseConfigurator):
             ]
         for conn in conns:
             search_namespace = conn.ft()
+            idef = IndexDefinition(
+                prefix=[''],
+                index_type=IndexType.HASH
+            )
+            idef.args = idef.args[:-2]
             try:
-                search_namespace.create_index(fields=index_fields)
+                search_namespace.create_index(fields=index_fields, definition=idef)
             except redis.ResponseError as e:
                 if ""Index already exists"" not in str(e):
                     raise e
diff --git a/engine/clients/redis/upload.py b/engine/clients/redis/upload.py
index cd4b888..0e29533 100644
--- a/engine/clients/redis/upload.py
+++ b/engine/clients/redis/upload.py
@@ -57,7 +57,7 @@ class RedisUploader(BaseUploader):
             cls.client.hset(
                 str(idx),
                 mapping={
-                    ""vector"": np.array(vec).astype(np.float32).tobytes(),
+                    ""vector"": np.array(vec).astype(np.float64).tobytes(),
                     **payload,
                     **geopoints,
                 },

```

We can start a kvrocks instance and run this benchmark:
```bash
python3 run.py --engines redis-default --datasets 'glove-25-angular'
```

cc @Beihao-Zhou 

### Solution

Currently we'll get some coredumps in the vector indexing phase, e.g.:
```
E20240809 14:55:31.865105   134 signal_util.h:36] Stack trace (most recent call first):
#0  0x0000555f0502cac9 in SegvHandler at /usr/bin/kvrocks
#1  0x00007f2e599c004f in __sigaction at /lib/x86_64-linux-gnu/libc.so.6
#2  0x00007f2e59a0ee2c in pthread_key_delete at /lib/x86_64-linux-gnu/libc.so.6
#3  0x00007f2e599bffb1 in gsignal at /lib/x86_64-linux-gnu/libc.so.6
#4  0x00007f2e599aa471 in abort at /lib/x86_64-linux-gnu/libc.so.6
#5  0x0000555f04f77917 in __gnu_cxx::__verbose_terminate_handler() [clone .cold] at vterminate.o
#6  0x0000555f05b16c09 in __cxxabiv1::__terminate(void (*)()) at /usr/bin/kvrocks
#7  0x0000555f05b16c74 in std::terminate() at /usr/bin/kvrocks
#8  0x0000555f05b16dc7 in __cxa_throw at /usr/bin/kvrocks
#9  0x0000555f04f7908d in std::__throw_bad_alloc() at /usr/bin/kvrocks
#10 0x0000555f04f77509 in handleOOM(unsigned long, bool) [clone .cold] at /kvrocks/build/_deps/jemalloc-src/src/jemalloc_cpp.cpp:90
#11 0x0000555f051d6e4a in redis::VectorItem::VectorItem(redis::VectorItem const&) at /usr/bin/kvrocks
#12 0x0000555f051e561a in redis::IndexUpdater::UpdateHnswVectorIndex(std::basic_string_view<char, std::char_traits<char> >, kqir::Value const&, kqir::Value const&, redis::SearchKey const&, redis::HnswVectorFieldMetadata*) const at /usr/bin/kvrocks
#13 0x0000555f051ec7be in redis::IndexUpdater::Update(std::map<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, kqir::Value, std::less<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > >, std::allocator<std::pair<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const, kqir::Value> > > const&, std::basic_string_view<char, std::char_traits<char> >) const at /usr/bin/kvrocks
#14 0x0000555f05228549 in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) at
 /usr/bin/kvrocks
#15 0x0000555f0505db30 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) at /usr/bin/kvrocks
#16 0x0000555f05978a0d in bufferevent_run_deferred_callbacks_unlocked at bufferevent.c
#17 0x0000555f059808a3 in event_process_active_single_queue at event.c
#18 0x0000555f05980f3e in event_process_active at event.c
#19 0x0000555f05982cf8 in event_base_loop.constprop.0 at event.c
#20 0x0000555f0523d46d in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() at /usr/bin/kvrocks
#21 0x0000555f05b96312 in execute_native_thread_routine at thread.o
#22 0x00007f2e59a0d133 in pthread_condattr_setpshared at /lib/x86_64-linux-gnu/libc.so.6
#23 0x00007f2e59a8ca3f in __clone at /lib/x86_64-linux-gnu/libc.so.6
```

Maybe we can try to solve it first.

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2481/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2481,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6H1Z2e,kvrocks,2278923678,2481,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2024-08-10T01:18:12Z,2024-08-10T01:18:12Z,Thanks for helping benchmark it! I'll fix the bug ASAP,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6H1Z2e/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2481,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IE6GR,kvrocks,2282987921,2481,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2024-08-12T01:41:24Z,2024-08-12T01:41:24Z,"Hiii @PragmaTwice,

I have some updates on the issue. <3

I tried debugging using `gdb` with the following steps:
```bash
➜  kvrocks git:(unstable) ✗ gdb ./build/kvrocks
(gdb) run -c kvrocks.conf
```
After running `python3 run.py --engines redis-default --datasets 'glove-25-angular'`, I reproduced the error and obtained the following backtrace:
```
(gdb) bt
[......]
#9  0x000055555561893a in std::__throw_bad_alloc() ()
#10 0x000055555651e6be in handleOOM (size=14411505886035969, nothrow=<optimized out>)
    at /home/ubuntu/kvrocks/build/_deps/jemalloc-src/src/jemalloc_cpp.cpp:90
#11 0x00005555556c4fb4 in std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >::_M_construct<char*> (
    this=0x7ffff19f28a0, __beg=0x33010000000200 <error: Cannot access memory at address 0x33010000000200>, 
    __end=0x66343031040200 <error: Cannot access memory at address 0x66343031040200>)
    at /usr/include/c++/11/bits/basic_string.tcc:219
#12 0x000055555568925a in redis::VectorItem::VectorItem (this=<optimized out>, this=<optimized out>)
    at /home/ubuntu/kvrocks/src/search/hnsw_indexer.h:57
#13 0x00005555559bb5d3 in operator() (__closure=0x7ffff19f25f0, candidate_neighbours=..., selected_neighbours=...)
    at /home/ubuntu/kvrocks/src/search/hnsw_indexer.cc:432
#14 0x00005555559bc4c3 in redis::HnswIndex::InsertVectorEntryInternal (this=0x7ffff19f2a90, key=..., vector=..., batch=..., 
    target_level=0) at /home/ubuntu/kvrocks/src/search/hnsw_indexer.cc:436
#15 0x00005555559bd6f9 in redis::HnswIndex::InsertVectorEntry (this=0x7ffff19f2a90, key=..., vector=..., batch=...)
    at /home/ubuntu/kvrocks/src/search/hnsw_indexer.cc:498
#16 0x00005555559d3e7a in redis::IndexUpdater::UpdateHnswVectorIndex (this=0x7ffff402f000, key=..., original=..., current=..., 
    search_key=..., vector=0x7ffff5c08380) at /home/ubuntu/kvrocks/src/search/indexer.cc:287
#17 0x00005555559d4633 in redis::IndexUpdater::UpdateIndex (this=0x7ffff402f000, field=..., key=..., original=..., current=...)
    at /home/ubuntu/kvrocks/src/search/indexer.cc:314
[......]
```

From **line 13**, we can see that there is a closure attempting to access a `VectorItem` but failing, causing a memory leak. It turns out that it is trying to dereference a null iterator. The _**patch at the end**_ will temporarily fix the crash. 

However, logically, there should be no situation where `deleted_node_it` gets a null iterator. I suspect this issue is due to concurrent requests for index updating, where individual updates access inconsistent snapshots and mess up the node metadata. Currently, `HnswIndex` doesn't handle concurrency issues.

```
# Kvrocks log 
I20240812 00:40:37.942303 185593 worker.cc:111] [worker] New connection: fd=56 from port: 6666 thread #140737224099392
I20240812 00:40:37.997772 185593 worker.cc:111] [worker] New connection: fd=57 from port: 6666 thread #140737224099392
...
...
I20240812 00:40:39.056308 185592 worker.cc:111] [worker] New connection: fd=71 from port: 6666 thread #140737232492096
```

Given this, I guess addressing the consistency issue will probably in turn resolve the issue here. I saw there is a PR #2310 to solve this? And should we solve this issue after the PR is finalized and merged? Let me know if you believe there are other possibilities/solutions we should consider, as I'm not entirely certain this is the underlying cause. Thanks!

#### Patch

```
diff --git a/src/search/hnsw_indexer.cc b/src/search/hnsw_indexer.cc
index 3618ad8..e8271b8 100644
--- a/src/search/hnsw_indexer.cc
+++ b/src/search/hnsw_indexer.cc
@@ -385,7 +385,7 @@ Status HnswIndex::InsertVectorEntryInternal(std::string_view key, const kqir::Nu
 
       // Check if candidate node has room after some other nodes' are pruned in current batch
       auto has_room_after_deletions = [&](const HnswNode& candidate_node, uint16_t candidate_node_num_neighbours) {
-        auto it = deleted_edges_map.find(candidate_node.key);
+        const auto& it = deleted_edges_map.find(candidate_node.key);
         if (it != deleted_edges_map.end()) {
           auto num_deleted_edges = static_cast<uint16_t>(it->second.size());
           return (candidate_node_num_neighbours - num_deleted_edges) < m_max;
@@ -417,27 +417,30 @@ Status HnswIndex::InsertVectorEntryInternal(std::string_view key, const kqir::Nu
             std::find(sorted_neighbours_by_distance.begin(), sorted_neighbours_by_distance.end(),
                       inserted_vector_item) != sorted_neighbours_by_distance.end();
 
-        if (inserted_node_is_selected) {
-          // Add the edge between candidate and inserted node
-          GET_OR_RET(AddEdge(inserted_vector_item.key, candidate_node.key, level, batch));
-          connected_edges_set.insert(candidate_node.key);
+        if (!inserted_node_is_selected) {
+          continue;
+        }
 
-          auto find_deleted_item = [&](const std::vector<VectorItem>& candidate_neighbours,
-                                       const std::vector<VectorItem>& selected_neighbours) -> VectorItem {
-            auto it =
-                std::find_if(candidate_neighbours.begin(), candidate_neighbours.end(), [&](const VectorItem& item) {
-                  return std::find(selected_neighbours.begin(), selected_neighbours.end(), item) ==
-                         selected_neighbours.end();
-                });
-            return *it;
-          };
-
-          // Remove the edge for candidate and the pruned node
-          auto deleted_node = find_deleted_item(candidate_node_neighbour_vec_items, sorted_neighbours_by_distance);
-          GET_OR_RET(RemoveEdge(deleted_node.key, candidate_node.key, level, batch));
-          deleted_edges_map[candidate_node.key].insert(deleted_node.key);
-          deleted_edges_map[deleted_node.key].insert(candidate_node.key);
+        auto deleted_node_it =
+            std::find_if(candidate_node_neighbour_vec_items.begin(), candidate_node_neighbour_vec_items.end(),
+                         [&](const VectorItem& item) {
+                           return std::find(sorted_neighbours_by_distance.begin(), sorted_neighbours_by_distance.end(),
+                                            item) == sorted_neighbours_by_distance.end();
+                         });
+
+        if (deleted_node_it == candidate_node_neighbour_vec_items.end()) {
+          continue;
         }
+        auto deleted_node = *deleted_node_it;
+
+        // Remove the edge for candidate and the pruned node
+        GET_OR_RET(RemoveEdge(deleted_node.key, candidate_node.key, level, batch));
+        deleted_edges_map[candidate_node.key].insert(deleted_node.key);
+        deleted_edges_map[deleted_node.key].insert(candidate_node.key);
+
+        // Add the edge between candidate and inserted node
+        GET_OR_RET(AddEdge(inserted_vector_item.key, candidate_node.key, level, batch));
+        connected_edges_set.insert(candidate_node.key);
       }
+        auto deleted_node = *deleted_node_it;
+
+        // Remove the edge for candidate and the pruned node
+        GET_OR_RET(RemoveEdge(deleted_node.key, candidate_node.key, level, batch));
+        deleted_edges_map[candidate_node.key].insert(deleted_node.key);
+        deleted_edges_map[deleted_node.key].insert(candidate_node.key);
+
+        // Add the edge between candidate and inserted node
+        GET_OR_RET(AddEdge(inserted_vector_item.key, candidate_node.key, level, batch));
+        connected_edges_set.insert(candidate_node.key);
       }
 
       // Update inserted node metadata
```
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IE6GR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2481,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IFC7w,kvrocks,2283024112,2481,NA,PragmaTwice,20042607,Twice,,NA,2024-08-12T02:39:07Z,2024-08-12T02:39:07Z,"Thank you for looking into this! 

I agree that it's likely related to rocksdb concurrency and transaction management. However, besides ensuring the consistency of rocksdb snapshots, do we need to consider anything else when constructing HNSW indexes in multiple threads? Should we also introduce some locks?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IFC7w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2481,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IFUyu,kvrocks,2283097262,2481,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2024-08-12T04:34:29Z,2024-08-12T04:34:29Z,"> Thank you for looking into this!
> 
> I agree that it's likely related to rocksdb concurrency and transaction management. However, besides ensuring the consistency of rocksdb snapshots, do we need to consider anything else when constructing HNSW indexes in multiple threads? Should we also introduce some locks?

Yea introducing locks sounds good to me. Also I think this is probably a common issue for all index rather than only HNSW (including text index in the future if also using quite complicated algorithm?), so we probably want to have a lock mechanism applicable for all. I'll look into it these two days, and open a new issue to discuss my idea & ask for suggestions if needed 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IFUyu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2487,https://api.github.com/repos/apache/kvrocks/issues/2487,kvrocks,2460421743,2487,"kvrocks During a 10-minute stress test, the master node became unavailable and reported an error. E20240808 16:57:31.393215 14244 replication.cc:146] Write error while sending batch to slave: Connection reset by peer. batches: ",903174293,32761339,A卍,,CLOSED,2024-08-12T09:01:16Z,2024-09-24T12:36:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

1、kvrocks version 2.7.0
Node specifications 16C32G
10 Sharding 3Replica
worker 8
ubuntu 22.4

### Minimal reproduce step

2、Use the following command to insert data.
**nohup memtier_benchmark -s x.x.x.x -p 6666 -a xxxxxx --cluster-mode --print-percentiles 50,90,95,99,100 --random-data --randomize --distinct-client-seed --hide-histogram --key-minimum 1 --key-maximum 100000000 --key-prefix=""type_string_001"" --command=""set key data"" --command-ratio=1 --command-key-pattern=S -n 10000000 -c 1 -t 1 --data-size-range 32-4096 > logs/${currentTime}/result-${currentTime}-1.log 2>&1 &**_


3、For about 10 minutes, some master nodes in the cluster were unavailable, and the main node reported the following error:
E20240808 16:57:31.393215 14244 replication.cc:146] Write error while sending batch to slave: Connection reset by peer. batches:
E20240808 16:57:31.393215 14244 replication.cc:146] Write error while sending batch to slave: Connection reset by peer. batches:
No obvious abnormalities in the network, disk, CPU, or memory of the slave nodes.
[createData.txt](https://github.com/user-attachments/files/16579493/createData.txt)

4、Phenomenon: The client cannot connect to the main node.
20240812-163707
No response packet captured.

**_No response packet captured. root@VM-137-33-ubuntu:/data# tcpdump -i any src host x.x.x.x -v
tcpdump: data link type LINUX_SLL2
tcpdump: listening on any, link-type LINUX_SLL2 (Linux cooked v2), snapshot length 262144 bytes
16:18:10.157983 eth0 In IP (tos 0x0, ttl 58, id 38248, offset 0, flags [DF], proto TCP (6), length 60)
x.x.x.x.39876 > VM-137-33-ubuntu.6666: Flags [S], cksum 0xac7d (correct), seq 2508364785, win 29200, options [mss 1424,sackOK,TS val 3660910233 ecr 0,nop,wscale 7], length 0
16:18:11.160306 eth0 In IP (tos 0x0, ttl 58, id 38249, offset 0, flags [DF], proto TCP (6), length 60)
x.x.x.x.39876 > VM-137-33-ubuntu.6666: Flags [S], cksum 0xa892 (correct), seq 2508364785, win 29200, options [mss 1424,sackOK,TS val 3660911236 ecr 0,nop,wscale 7], length 0
16:18:13.164292 eth0 In IP (tos 0x0, ttl 58, id 38250, offset 0, flags [DF], proto TCP (6), length 60)
x.x.x.x.39876 > VM-137-33-ubuntu.6666: Flags [S], cksum 0xa0be (correct), seq 2508364785, win 29200, options [mss 1424,sackOK,TS val 3660913240 ecr 0,nop,wscale 7], length 0_**

### What did you expect to see?

Normal connection

### What did you see instead?

E20240808 16:57:31.393215 14244 [replication.cc:146](http://replication.cc:146/)] Write error while sending batch to slave: Connection reset by peer. batches:
W20240808 16:57:31.404886 14297 [replication.cc:83](http://replication.cc:83/)] Slave thread was terminated, would stop feeding the slave: [10.71.136.118:52652](http://10.71.136.118:52652/)

Phenomenon: The client cannot connect to the main node.
No response packet captured.

### Anything Else?

![20240812-163707](https://github.com/user-attachments/assets/8ad35f00-a1b8-4934-a9b3-23fef2afb27a)


### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2487/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2487,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IRGEF,kvrocks,2286182661,2487,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-13T12:47:54Z,2024-08-13T12:47:54Z,@903174293 I believe cannot ask your question with your provided information. You should investigate why the master node cannot response. Perhaps you can have a look at the CPU usage and its db logs.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IRGEF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2489,https://api.github.com/repos/apache/kvrocks/issues/2489,kvrocks,2461866935,2489,Introduce Mutex Map in IndexInfo to Ensure Thread Safety During Index Construction,Beihao-Zhou,68083940,Beihao Zhou,,CLOSED,2024-08-12T20:48:21Z,2024-11-07T13:49:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

In the context of index, the absence of a locking mechanism could lead to issues when multiple threads attempt to modify shared resources simultaneously. 

[1] Original issue raised from HNSW #2481 
[2] Marked TODO
https://github.com/apache/kvrocks/blob/3408318934cb68c0c1f2ffa937f19f02346d0672/src/server/redis_connection.cc#L522-L528

We might want to introduce locks to solve the problem. 


### Solution

### Solution 1: Mutex (Straight-forward) 
We can introduce a mutex map within each IndexInfo structure. This mutex map would contain a mutex for each field that requires protection against concurrent access. 

#### Con
- Blocking if multiple connections update the same index

### Solution 2: Queue 
We can store the `Update` task for each `IndexInfo` field in a queue, and have a background thread to schedule tasks in order asynchronously. I'm not quite sure about how many number of threads would be appropriate, but can discuss further if everyone leans towards this solution. 

cc @PragmaTwice 

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2489/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2489,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IPwTY,kvrocks,2285831384,2489,NA,PragmaTwice,20042607,Twice,,NA,2024-08-13T09:45:17Z,2024-08-13T09:45:17Z,"We can first try to implement the first method because it is simpler and does ensure correctness of indexing. 

We can then benchmark to determine its impact on performance and consider how to further optimize it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IPwTY/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2490,https://api.github.com/repos/apache/kvrocks/issues/2490,kvrocks,2462803350,2490,(m)TLS replication is broken in 2.9.0,kinoute,623763,Yann Defretin,yann@defret.in,OPEN,2024-08-13T09:02:23Z,2024-08-13T16:39:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.9.0

### Minimal reproduce step

When upgrading Kvrocks from 2.8.0 to 2.9.0, we started to get SSL/TLS errors when trying to connect a slave to the master. No problem on replication without TLS.

Both master and slave are on 2.9.0. Rolling back the master to 2.8.0 and keeping the replica on 2.9.0 is working so it is definitely on the ""server/master"" part.

When both were on 2.9.0, using `redis-cli` on the slave instance to connect to the master was working with the certificates so they are fine:

No errors (on replica instance):
```
redis-cli -h kvrocks-master \
  -p 6379 \
   --tls \
   --cacert /ca/kvrocks/ca.crt \
   --cert /tls/kvrocks/tls.crt \
   --key /tls/kvrocks/tls.key
```

Errors (replica instance, see below):

```
kvrocks -c kvrocks.conf \
      --dir /var/lib/kvrocks \
      --pidfile /var/run/kvrocks/kvrocks.pid \
      --masterauth ""xxx"" \
      --slaveof ""kvrocks-master 6379"" \
      --tls-ca-cert-file /ca/kvrocks/ca.crt \
      --tls-key-file /tls/kvrocks/tls.key \
      --tls-cert-file /tls/kvrocks/tls.crt \
      --tls-replication yes \
      --bind 0.0.0.0
```



### What did you expect to see?

A working (m)TLS replication that either does psync or full synchronization

### What did you see instead?

Server (MASTER) :

> kvrocks I20240813 08:37:26.913834   121 cmd_replication.cc:60] Slave 100.65.46.20:45098, listening port: 6379, announce ip: 100.65.46.20 asks for synchronization with next sequence: 1 replication id: not supported, and local sequence: 344837857
kvrocks E20240813 08:37:26.918999   121 redis_connection.cc:109] [connection] Going to remove the client: 100.65.46.20:45098, while encounter error: Success, SSL Error: error:0A000126:SSL routines::unexpected eof while reading                     
kvrocks I20240813 08:37:26.986922   193 cmd_replication.cc:242] [replication] Succeed sending full data file info to 100.65.46.20
kvrocks W20240813 08:37:27.038514   194 cmd_replication.cc:299] [replication] Fail to send file CURRENT to 100.65.46.20, error: Success                                                                                                                
kvrocks I20240813 08:37:37.086854   195 cmd_replication.cc:242] [replication] Succeed sending full data file info to 100.65.46.20
kvrocks W20240813 08:37:37.127951   196 cmd_replication.cc:299] [replication] Fail to send file CURRENT to 100.65.46.20, error: Success


Client (REPLICA) :

> W20240813 08:00:12.653694    50 replication.cc:935] [fetch] Fail to fetch file 005813.sst, err: fetch file err: read sst file: failed to read from SSL connection: error:00000000:lib(0)::reason(0)
W20240813 08:00:12.655525    49 replication.cc:935] [fetch] Fail to fetch file 009665.sst, err: fetch file err: read sst file: failed to read from SSL connection: error:00000000:lib(0)::reason(0)
W20240813 08:00:12.660212    51 replication.cc:935] [fetch] Fail to fetch file 008792.sst, err: fetch file err: read sst file: failed to read from SSL connection: error:00000000:lib(0)::reason(0)
W20240813 08:00:12.661721    52 replication.cc:935] [fetch] Fail to fetch file 005736.sst, err: fetch file err: read sst file: failed to read from SSL connection: error:00000000:lib(0)::reason(0)

### Anything Else?

Is it safe to downgrade to 2.8.0 on instances where I need (m)tls replication? Could it be due to the switch to Debian?

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2490/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2490,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IPqup,kvrocks,2285808553,2490,NA,PragmaTwice,20042607,Twice,,NA,2024-08-13T09:35:41Z,2024-08-13T09:35:41Z,"> Could it be due to the switch to Debian?

Have you tried to build kvrocks in your own environment and see if TLS replication works well?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IPqup/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2490,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IPtPA,kvrocks,2285818816,2490,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2024-08-13T09:39:38Z,2024-08-13T09:39:38Z,"> > Could it be due to the switch to Debian?
> 
> Have you tried to build kvrocks in your own environment and see if TLS replication works well?

We use Kvrocks in Kubernetes with the official Docker images","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IPtPA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2490,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IQCfp,kvrocks,2285905897,2490,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2024-08-13T10:24:18Z,2024-08-13T10:24:18Z,"I tried with the unstable/nightly Docker tag for the master instance: I don't have the error. I then rollbacked to 2.9.0, the error is gone and does not reappear. Really weird.

I still have some running instances (on other clusters) where I didn't upgrade to nightly so the problem is still there, do you want me to run some checks/commands in order to get some ideas about why  this is happening?

Edit: The problem is still here, nevermind","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IQCfp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2490,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IS7PN,kvrocks,2286662605,2490,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2024-08-13T16:32:31Z,2024-08-13T16:32:31Z,I built Kvrocks 2.9.0 with the Docker Alpine image from 2.8: no SSL/TLS replication errors. The image is here: https://hub.docker.com/r/hivacruz/kvrocks-alpine/tags,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IS7PN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2492,https://api.github.com/repos/apache/kvrocks/issues/2492,kvrocks,2469754040,2492,Add descriptions for commands on website documentation,jonathanc-n,86070045,Jonathan Chen,,CLOSED,2024-08-16T08:13:46Z,2024-08-24T13:24:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Create a brief description for each command that is supported on kvrocks.


### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2492/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IrSN-,kvrocks,2293048190,2492,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-08-16T08:15:33Z,2024-08-16T08:15:33Z,Can I be assigned this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IrSN-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IrSkm,kvrocks,2293049638,2492,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-16T08:16:35Z,2024-08-16T08:16:35Z,"@jonathanc-n Done, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6IrSkm/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6I-Zes,kvrocks,2298058668,2492,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-08-20T06:23:07Z,2024-08-20T06:23:07Z,This can now be closed.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6I-Zes/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2492,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Jl092,kvrocks,2308394870,2492,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-24T13:24:34Z,2024-08-24T13:24:34Z,@jonathanc-n Thank you.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Jl092/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2497,https://api.github.com/repos/apache/kvrocks/issues/2497,kvrocks,2473009761,2497,Compile error from kvrocks v2.8.0 in CentOS 7 env,903174293,32761339,A卍,,CLOSED,2024-08-19T10:25:14Z,2024-08-24T13:24:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks v2.8.0
CentOS7
git clone
git checkout v2.8.0
x.py build

### Minimal reproduce step

git clone
git checkout v2.8.0
x.py build


### What did you expect to see?

成功

### What did you see instead?

[ 84%] Building CXX object _deps/fmt-build/CMakeFiles/fmt.dir/src/os.cc.o
[ 84%] Linking CXX static library libfmt.a
gmake[3]: Leaving directory '/root/zhangwanbin/2.8.0/kvrocks/build'
[ 84%] Built target fmt
gmake[3]: Entering directory '/root/zhangwanbin/2.8.0/kvrocks/build'
Scanning dependencies of target kvrocks_objs
gmake[3]: Leaving directory '/root/zhangwanbin/2.8.0/kvrocks/build'
gmake[3]: Entering directory '/root/zhangwanbin/2.8.0/kvrocks/build'
[ 84%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/cluster/batch_sender.cc.o
[ 84%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/cluster/cluster.cc.o
[ 85%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/cluster/redis_slot.cc.o
[ 85%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/cluster/replication.cc.o
[ 85%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/cluster/slot_import.cc.o
[ 85%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/cluster/slot_migrate.cc.o
[ 85%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/cluster/sync_migrate_context.cc.o
[ 85%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/commands/cmd_bit.cc.o
[ 85%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/commands/cmd_bloom_filter.cc.o
[ 86%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/commands/cmd_cluster.cc.o
[ 86%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/commands/cmd_function.cc.o
[ 86%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/commands/cmd_geo.cc.o
[ 86%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/commands/cmd_hash.cc.o
[ 86%] Building CXX object CMakeFiles/kvrocks_objs.dir/src/commands/cmd_json.cc.o
In file included from /root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/cbor_reader.hpp:20,
                 from /root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/cbor.hpp:19,
                 from /root/zhangwanbin/2.8.0/kvrocks/src/types/json.h:28,
                 from /root/zhangwanbin/2.8.0/kvrocks/src/types/redis_json.h:27,
                 from /root/zhangwanbin/2.8.0/kvrocks/src/commands/cmd_json.cc:31:
/root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/cbor_parser.hpp: In instantiation of ‘jsoncons::cbor::basic_cbor_parser<Source, Allocator>::mapped_string::mapped_string(const string_type&, const allocator_type&) [with Source = jsoncons::bytes_source; Allocator = std::allocator<char>; jsoncons::cbor::basic_cbor_parser<Source, Allocator>::string_type = std::basic_string<char>; typename std::allocator_traits<_Alloc>::rebind_alloc<char> = std::allocator<char>; jsoncons::cbor::basic_cbor_parser<Source, Allocator>::mapped_string::allocator_type = std::allocator<char>]’:
/root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/cbor_parser.hpp:735:54:   required from ‘void jsoncons::cbor::basic_cbor_parser<Source, Allocator>::read_text_string(jsoncons::cbor::basic_cbor_parser<Source, Allocator>::string_type&, std::error_code&) [with Source = jsoncons::bytes_source; Allocator = std::allocator<char>; jsoncons::cbor::basic_cbor_parser<Source, Allocator>::string_type = std::basic_string<char>; typename std::allocator_traits<_Alloc>::rebind_alloc<char> = std::allocator<char>]’
/root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/cbor_parser.hpp:471:17:   required from ‘void jsoncons::cbor::basic_cbor_parser<Source, Allocator>::read_item(jsoncons::item_event_visitor&, std::error_code&) [with Source = jsoncons::bytes_source; Allocator = std::allocator<char>; jsoncons::item_event_visitor = jsoncons::basic_item_event_visitor<char>]’
/root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/cbor_parser.hpp:247:25:   required from ‘void jsoncons::cbor::basic_cbor_parser<Source, Allocator>::parse(jsoncons::item_event_visitor&, std::error_code&) [with Source = jsoncons::bytes_source; Allocator = std::allocator<char>; jsoncons::item_event_visitor = jsoncons::basic_item_event_visitor<char>]’
/root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/cbor_reader.hpp:87:9:   required from ‘void jsoncons::cbor::basic_cbor_reader<Source, Allocator>::read(std::error_code&) [with Source = jsoncons::bytes_source; Allocator = std::allocator<char>]’
/root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/cbor_reader.hpp:77:9:   required from ‘void jsoncons::cbor::basic_cbor_reader<Source, Allocator>::read() [with Source = jsoncons::bytes_source; Allocator = std::allocator<char>]’
/root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/decode_cbor.hpp:35:20:   required from ‘typename std::enable_if<(jsoncons::extension_traits::is_basic_json<Json>::value && jsoncons::extension_traits::is_byte_sequence<Source>::value), T>::type jsoncons::cbor::decode_cbor(const Source&, const jsoncons::cbor::cbor_decode_options&) [with T = jsoncons::basic_json<char, jsoncons::sorted_policy, std::allocator<char> >; Source = std::basic_string_view<char>; typename std::enable_if<(jsoncons::extension_traits::is_basic_json<Json>::value && jsoncons::extension_traits::is_byte_sequence<Source>::value), T>::type = jsoncons::basic_json<char, jsoncons::sorted_policy, std::allocator<char> >]’
/root/zhangwanbin/2.8.0/kvrocks/src/types/json.h:78:69:   required from here
/root/zhangwanbin/2.8.0/kvrocks/build/_deps/jsoncons-src/include/jsoncons_ext/cbor/cbor_parser.hpp:66:102: error: no matching function for call to ‘std::basic_string<char>::basic_string(const string_type&, const allocator_type&)’
             : type(jsoncons::cbor::detail::cbor_major_type::text_string), str(str,alloc), bytes(alloc)
                                                                                                      ^
In file included from /opt/rh/devtoolset-8/root/usr/include/c++/8/string:52,
                 from /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/locale_classes.h:40,
                 from /opt/rh/devtoolset-8/root/usr/include/c++/8/bits/ios_base.h:41,
                 from /opt/rh/devtoolset-8/root/usr/include/c++/8/ios:42,
                 from /opt/rh/devtoolset-8/root/usr/include/c++/8/ostream:38,
                 from /root/zhangwanbin/2.8.0/kvrocks/build/_deps/glog-build/glog/logging.h:49,
                 from /root/zhangwanbin/2.8.0/kvrocks/src/commands/commander.h:25,
                 from /root/zhangwanbin/2.8.0/kvrocks/src/commands/cmd_json.cc:23:
/opt/rh/devtoolset-8/root/usr/include/c++/8/bits/basic_string.h:3632:7: note: candidate: ‘std::basic_string<_CharT, _Traits, _Alloc>::basic_string(std::basic_string<_CharT, _Traits, _Alloc>::__sv_wrapper, c

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2497/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2497,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6I3lEe,kvrocks,2296271134,2497,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-19T10:45:23Z,2024-08-19T10:45:23Z,@903174293 Could you please have a try at devtoolset-11?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6I3lEe/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2497,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Jl08b,kvrocks,2308394779,2497,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-24T13:24:10Z,2024-08-24T13:24:10Z,@903174293 Feel free to reopen if this issue is still living on your side.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Jl08b/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2500,https://api.github.com/repos/apache/kvrocks/issues/2500,kvrocks,2476943854,2500,Inconsistent behavior with Redis in BITFIELD GET command,VIVALXH,98531764,,,OPEN,2024-08-21T03:09:53Z,2024-09-02T06:16:41Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Docker Image SHA:707f93473e7265df39593d38d83081ec1a6a36da31c97b391008858eb45a437f

kvrocks 镜像版本：sha256:707f93473e7265df39593d38d83081ec1a6a36da31c97b391008858eb45a437f


### Minimal reproduce step

1. kvrocks设置位图01011000对应字母X：
redis-cli -h 192.168.1.72 -p 6666
192.168.1.72:6666> flushdb
OK
192.168.1.72:6666> SETBIT A 0 0
(integer) 0
192.168.1.72:6666> SETBIT A 1 1
(integer) 0
192.168.1.72:6666> SETBIT A 2 0
(integer) 0
192.168.1.72:6666> SETBIT A 3 1
(integer) 0
192.168.1.72:6666> SETBIT A 4 1
(integer) 0
192.168.1.72:6666> SETBIT A 5 0
(integer) 0
192.168.1.72:6666> SETBIT A 6 0
(integer) 0
192.168.1.72:6666> SETBIT A 7 0
(integer) 0
192.168.1.72:6666> GET A
""X""
192.168.1.72:6666> bitfield A get u7 0
1) (integer) 13

2. redis设置位图01011000对应字母X：
redis-cli -h 192.168.1.72 -p 6379
192.168.1.72:6379> flushdb
OK
192.168.1.72:6379> SETBIT A 0 0
(integer) 0
192.168.1.72:6379> SETBIT A 1 1
(integer) 0
192.168.1.72:6379> SETBIT A 2 0
(integer) 0
192.168.1.72:6379> SETBIT A 3 1
(integer) 0
192.168.1.72:6379> SETBIT A 4 1
(integer) 0
192.168.1.72:6379> SETBIT A 5 0
(integer) 0
192.168.1.72:6379> SETBIT A 6 0
(integer) 0
192.168.1.72:6379> SETBIT A 7 0
(integer) 0
192.168.1.72:6379> GET A
""X""
192.168.1.72:6379> bitfield A get u7 0
1) (integer) 44

### What did you expect to see?

设置位图01011000对应字母X，通过bitfield从0偏移量获取7位，kvrocks结果是13(0001101)，redis是44(0101100)，从bitfield定义中，预期应该是redis对应的结果。

### What did you see instead?

-

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2500/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2500,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6JHorM,kvrocks,2300480204,2500,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-08-21T03:11:26Z,2024-08-21T03:11:26Z,Will check this later today,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6JHorM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2500,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6JNoe5,kvrocks,2302052281,2500,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-08-21T13:23:50Z,2024-08-21T13:23:50Z,"kvrocks bitmap uses LSB here, and MSB is used in redis...This is the root cause of this problem

I would try to fix the bitfield, but ""get"" would not gurantee to be same as redis.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6JNoe5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2504,https://api.github.com/repos/apache/kvrocks/issues/2504,kvrocks,2484590016,2504,Provide a configuration to turn off transactional Context,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,CLOSED,2024-08-24T13:21:33Z,2024-08-31T17:07:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/apache/kvrocks/pull/2332 may have a wide range of impacts.
Users may need a configuration to avoid these impacts.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2504/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2511,https://api.github.com/repos/apache/kvrocks/issues/2511,kvrocks,2494741956,2511,Potential unclear to the temporary dictionary of db while restoring,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-08-29T14:57:30Z,2024-09-21T06:09:29Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

It requires the `db.tmp` directory to be empty while restoring DB, or it will fail to rename the new db dir to the existing one. For the current implementation, the db. tmp is potentially unclear if restoring the db failed in the middle way.

So we can make the following improvements:

1. Make sure the temporary directory should be cleared before returning
2. Check if the error is not empty while renaming the new DB, if yes then remove the `db.tmp` and have a try again

### What did you expect to see?

Restoring the db normally

### What did you see instead?

![image](https://github.com/user-attachments/assets/3c56ca46-6343-4a9d-a1a2-acf7fe8e475c)


### Anything Else?

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2511/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2512,https://api.github.com/repos/apache/kvrocks/issues/2512,kvrocks,2496900305,2512,Potential dead lock if switching different master frequently,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-08-30T10:52:30Z,2024-09-02T07:10:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

None

### What did you expect to see?

Won't cause deadlock at any situation

### What did you see instead?

The worker threads are stuck after switching master frequently:

```
(gdb) thread 8

[Switching to thread 8 (Thread 0x7fbeb4bf8640 (LWP 3166409))]

#0  __futex_abstimed_wait_common (cancel=false, private=<optimized out>, abstime=0x0, clockid=0, expected=3, futex_word=0x7ffc2c7fe668) at ./nptl/futex-internal.c:103

103     in ./nptl/futex-internal.c

(gdb) bt

#0  __futex_abstimed_wait_common (cancel=false, private=<optimized out>, abstime=0x0, clockid=0, expected=3, futex_word=0x7ffc2c7fe668) at ./nptl/futex-internal.c:103

#1  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0x7ffc2c7fe668, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0,

    private=<optimized out>) at ./nptl/futex-internal.c:128

#2  0x00007fbebeb227fb in __pthread_rwlock_rdlock_full64 (abstime=0x0, clockid=0, rwlock=0x7ffc2c7fe660) at ./nptl/pthread_rwlock_common.c:460

#3  ___pthread_rwlock_rdlock (rwlock=0x7ffc2c7fe660) at ./nptl/pthread_rwlock_rdlock.c:26

#4  0x0000561e231e2028 in std::__glibcxx_rwlock_rdlock (__rwlock=<optimized out>) at /usr/include/c++/11/shared_mutex:78

#5  std::__shared_mutex_pthread::lock_shared (this=<optimized out>) at /usr/include/c++/11/shared_mutex:229

#6  std::shared_mutex::lock_shared (this=<optimized out>) at /usr/include/c++/11/shared_mutex:426

#7  std::shared_lock<std::shared_mutex>::shared_lock (__m=..., this=<optimized out>) at /usr/include/c++/11/shared_mutex:727

#8  Server::WorkConcurrencyGuard (this=<optimized out>) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/server.cc:637

#9  redis::Connection::ExecuteCommands (this=<optimized out>, to_process_cmds=<optimized out>)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/redis_connection.cc:355

#10 0x0000561e230dc2ac in redis::Connection::OnRead (bev=<optimized out>, this=0x7fbeb23cb580)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/redis_connection.cc:92

#11 EvbufCallbackBase<redis::Connection, true, true, true>::readCB (bev=<optimized out>, ctx=0x7fbeb23cb580)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/common/event_util.h:70

#12 0x0000561e2383be12 in bufferevent_run_deferred_callbacks_unlocked (cb=<optimized out>, arg=0x7fbeb23cb300)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/build/_deps/libevent-src/bufferevent.c:208

#13 0x0000561e2384271d in event_process_active_single_queue (base=base@entry=0x7fbebe64c900, activeq=0x7fbebe651060, max_to_process=max_to_process@entry=2147483647,

    endtime=endtime@entry=0x0) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/build/_deps/libevent-src/event.c:1720

#14 0x0000561e23843117 in event_process_active (base=0x7fbebe64c900) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/build/_deps/libevent-src/event.c:1783

#15 event_base_loop (base=0x7fbebe64c900, flags=0) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/build/_deps/libevent-src/event.c:2006

#16 0x0000561e231f5f3e in Worker::Run (tid=..., this=0x7fbebe6ab900) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/worker.cc:293

#17 operator() (__closure=<optimized out>, __closure=<optimized out>) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/worker.cc:546

#18 operator() (__closure=<optimized out>) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/common/thread_util.h:38

#19 std::__invoke_impl<void, util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > (__f=...)

    at /usr/include/c++/11/bits/invoke.h:61

#20 std::__invoke<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > (__fn=...)

    at /usr/include/c++/11/bits/invoke.h:96

#21 std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > >::_M_invoke<0>

    (this=<optimized out>) at /usr/include/c++/11/bits/std_thread.h:259

#22 std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > >::operator() (

    this=<optimized out>) at /usr/include/c++/11/bits/std_thread.h:266

#23 std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > > >::_M_run(void) (this=<optimized out>) at /usr/include/c++/11/bits/std_thread.h:211

#24 0x0000561e23a3ec34 in execute_native_thread_routine ()

#25 0x00007fbebeb1cac3 in start_thread (arg=<optimized out>) at ./nptl/pthread_create.c:442

#26 0x00007fbebebae850 in clone3 () at ../sysdeps/unix/sysv/linux/x86_64/clone3.S:81

(gdb) thread 10

[Switching to thread 10 (Thread 0x7fbeb6ffe640 (LWP 3166411))]

#0  __futex_abstimed_wait_common64 (private=128, cancel=true, abstime=0x0, op=265, expected=3180509, futex_word=0x7fbe574ff910) at ./nptl/futex-internal.c:57

57      in ./nptl/futex-internal.c

(gdb) bt

#0  __futex_abstimed_wait_common64 (private=128, cancel=true, abstime=0x0, op=265, expected=3180509, futex_word=0x7fbe574ff910) at ./nptl/futex-internal.c:57

#1  __futex_abstimed_wait_common (cancel=true, private=128, abstime=0x0, clockid=0, expected=3180509, futex_word=0x7fbe574ff910) at ./nptl/futex-internal.c:87

#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0x7fbe574ff910, expected=3180509, clockid=clockid@entry=0, abstime=abstime@entry=0x0,

    private=private@entry=128) at ./nptl/futex-internal.c:139

#3  0x00007fbebeb1e624 in __pthread_clockjoin_ex (threadid=140455485371968, thread_return=0x0, clockid=0, abstime=0x0, block=<optimized out>)

    at ./nptl/pthread_join_common.c:105

#4  0x0000561e23a3eca7 in std::thread::join() ()

#5  0x0000561e2328c52e in util::ThreadOperationImpl<&std::thread::join>(std::thread&, char const*) [clone .constprop.0] (t=..., op=0x561e23a94184 ""join"")

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/common/thread_util.cc:39

#6  0x0000561e230c6bd4 in util::ThreadJoin (t=...) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/common/thread_util.cc:47

#7  ReplicationThread::Stop (this=<optimized out>) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/cluster/replication.cc:367

#8  0x0000561e231e62bb in Server::AddMaster (this=0x7ffc2c7fe150, host=..., port=6379, force_reconnect=<optimized out>)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/server.cc:261

#9  0x0000561e230bfa42 in Cluster::SetMasterSlaveRepl (this=0x7fbeba875600) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/cluster/cluster.cc:245

#10 0x0000561e230c0697 in Cluster::SetClusterNodes (this=0x7fbeba875600, nodes_str=..., version=<optimized out>, force=<optimized out>)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/cluster/cluster.cc:205

#11 0x0000561e230ee13d in redis::CommandClusterX::Execute (this=0x7fbe3001e000, srv=0x7ffc2c7fe150, conn=<optimized out>, output=0x7fbeb6ff5450)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/commands/cmd_cluster.cc:224

#12 0x0000561e231e236f in redis::Connection::ExecuteCommands (this=<optimized out>, to_process_cmds=<optimized out>)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/redis_connection.cc:426

#13 0x0000561e230dc2ac in redis::Connection::OnRead (bev=<optimized out>, this=0x7fbe16db5680)

   at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/redis_connection.cc:92

#14 EvbufCallbackBase<redis::Connection, true, true, true>::readCB (bev=<optimized out>, ctx=0x7fbe16db5680)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/common/event_util.h:70

#15 0x0000561e2383be12 in bufferevent_run_deferred_callbacks_unlocked (cb=<optimized out>, arg=0x7fbe16db5400)

    at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/build/_deps/libevent-src/bufferevent.c:208

#16 0x0000561e2384271d in event_process_active_single_queue (base=base@entry=0x7fbebe64cf00, activeq=0x7fbebe6512c0, max_to_process=max_to_process@entry=2147483647,

    endtime=endtime@entry=0x0) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/build/_deps/libevent-src/event.c:1720

#17 0x0000561e23843117 in event_process_active (base=0x7fbebe64cf00) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/build/_deps/libevent-src/event.c:1783

#18 event_base_loop (base=0x7fbebe64cf00, flags=0) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/build/_deps/libevent-src/event.c:2006

#19 0x0000561e231f5f3e in Worker::Run (tid=..., this=0x7fbebe6abb00) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/worker.cc:293

#20 operator() (__closure=<optimized out>, __closure=<optimized out>) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/server/worker.cc:546

#21 operator() (__closure=<optimized out>) at /root/kvrocks-zip-build-cd/kvrocks-zip-build/kvrocks/src/common/thread_util.h:38

#22 std::__invoke_impl<void, util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > (__f=...)

    at /usr/include/c++/11/bits/invoke.h:61

#23 std::__invoke<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > (__fn=...)

    at /usr/include/c++/11/bits/invoke.h:96

#24 std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > >::_M_invoke<0>

    (this=<optimized out>) at /usr/include/c++/11/bits/std_thread.h:259

#25 std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > >::operator() (

    this=<optimized out>) at /usr/include/c++/11/bits/std_thread.h:266

#26 std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::<lambda()> >(char const*, WorkerThread::Start()::<lambda()>)::<lambda()> > > >::_M_run(void) (this=<optimized out>) at /usr/include/c++/11/bits/std_thread.h:211

#27 0x0000561e23a3ec34 in execute_native_thread_routine ()

#28 0x00007fbebeb1cac3 in start_thread (arg=<optimized out>) at ./nptl/pthread_create.c:442

#29 0x00007fbebebae850 in clone3 () at ../sysdeps/unix/sysv/linux/x86_64/clone3.S:81

(gdb)
```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2512/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2512,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KVT_q,kvrocks,2320842730,2512,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-08-30T10:56:24Z,2024-08-30T10:56:24Z,"After analyzing the gdb stack, we found one of the worker threads was pending when waiting for the `ReplicationThread::Stop`. And `ReplicationThread::Stop` is blocking on `WorkConcurrencyGuard` which should be acquired by the current worker.

That said, the ReplicationThread is waiting for `WorkExclusivityGuard` but it's acquired by the worker thread which is waiting for itself.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KVT_q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2514,https://api.github.com/repos/apache/kvrocks/issues/2514,kvrocks,2499156302,2514,Add go test cases for `txn_context_enabled` config,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,CLOSED,2024-09-01T02:06:11Z,2024-09-10T13:31:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Make sure the `txn_context_enabled` config is available

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2514/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2518,https://api.github.com/repos/apache/kvrocks/issues/2518,kvrocks,2500126836,2518,The DUMP command does not support the BITMAP type,VIVALXH,98531764,,,CLOSED,2024-09-02T06:38:20Z,2024-09-24T12:22:28Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

DUMP command is supported from version 2.9, but not support the BITMAP TYPE, will it be supported in the future?

Doc：
https://kvrocks.apache.org/docs/supported-commands/#server-commands

Partial code ：
https://github.com/apache/kvrocks/blob/0329170d60d67a5f0f62ee565a1a14f0bbfb81da/src/storage/rdb.cc#L719

Example：
![image](https://github.com/user-attachments/assets/ba496eac-4047-4ddb-be83-096da0678561)


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2518/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2520,https://api.github.com/repos/apache/kvrocks/issues/2520,kvrocks,2502469379,2520,Didn't load namespaces into memory after full syncing the db from master node,fstd2,56252962,Genji,,CLOSED,2024-09-03T10:11:14Z,2024-09-08T12:21:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.9.0

### Minimal reproduce step

The master contains 17 namespaces with around 500,000 keys in total.

1. Execute `SLAVE OF <master>` on the slave.

3. After the `master_link_status: up`, run `NAMESPACE GET *` on the slave.

### What did you expect to see?

The slave should display all namespaces, identical to the master.

### What did you see instead?

Only the default namespace is displayed.

After restarting the slave server, all namespaces are visible.

Performing any operation on the namespaces on the master (e.g., adding or deleting) causes all namespaces to become visible on the slave.

### Anything Else?

Master Log:

```
I20240903 09:49:47.686094     1 main.cc:142] kvrocks version 2.9.0
I20240903 09:49:48.516047     1 event_listener.cc:177] [event_listener/table_file_created] column family: default, file path: /var/lib/kvrocks/db/000787.sst, file size: 21418974, job_id: 1, reason: recovery, status: OK
I20240903 09:49:48.535416     1 event_listener.cc:177] [event_listener/table_file_created] column family: metadata, file path: /var/lib/kvrocks/db/000788.sst, file size: 2638811, job_id: 1, reason: recovery, status: OK
I20240903 09:49:48.537494     1 event_listener.cc:177] [event_listener/table_file_created] column family: propagate, file path: /var/lib/kvrocks/db/000789.sst, file size: 1737, job_id: 1, reason: recovery, status: OK
I20240903 09:49:48.579883     1 storage.cc:387] [storage] Success to load the data from disk: 880 ms
I20240903 09:49:48.582392     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:49:48.582553     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:49:48.582653     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:49:48.582748     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:49:48.582841     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:49:48.582938     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:49:48.583042     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:49:48.592422     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:49:48.592732     1 worker.cc:564] [worker] Thread #140582884210368 started
I20240903 09:49:48.592758     1 worker.cc:564] [worker] Thread #140582898886336 started
I20240903 09:49:48.592778     1 worker.cc:564] [worker] Thread #140582909376192 started
I20240903 09:49:48.592809     1 worker.cc:564] [worker] Thread #140582986966720 started
I20240903 09:49:48.592924     1 worker.cc:564] [worker] Thread #140582974387904 started
I20240903 09:49:48.592953     1 worker.cc:564] [worker] Thread #140582963898048 started
I20240903 09:49:48.593073     1 worker.cc:564] [worker] Thread #140582934542016 started
I20240903 09:49:48.593104     1 worker.cc:564] [worker] Thread #140582921955008 started
I20240903 09:49:48.593710     1 server.cc:228] [server] Ready to accept connections
I20240903 09:50:18.392220    31 cmd_replication.cc:60] Slave 10.0.1.182:45896, listening port: 6666, announce ip: 10.0.1.182 asks for synchronization with next sequence: 1 replication id: not supported, and local sequence: 25585719
I20240903 09:50:18.400365    61 storage.cc:975] [storage] Create checkpoint successfully
I20240903 09:50:18.400447    61 cmd_replication.cc:242] [replication] Succeed sending full data file info to 10.0.1.182
I20240903 09:50:18.556877    65 cmd_replication.cc:297] [replication] Succeed sending file 000787.sst to 10.0.1.182
I20240903 09:50:18.607342    63 cmd_replication.cc:297] [replication] Succeed sending file 000774.sst to 10.0.1.182
I20240903 09:50:18.671141    65 cmd_replication.cc:297] [replication] Succeed sending file 000647.sst to 10.0.1.182
I20240903 09:50:18.807121    63 cmd_replication.cc:297] [replication] Succeed sending file 000782.sst to 10.0.1.182
I20240903 09:50:18.870740    65 cmd_replication.cc:297] [replication] Succeed sending file 000781.sst to 10.0.1.182
I20240903 09:50:18.939994    63 cmd_replication.cc:297] [replication] Succeed sending file 000613.sst to 10.0.1.182
I20240903 09:50:19.002041    62 cmd_replication.cc:297] [replication] Succeed sending file 000780.sst to 10.0.1.182
I20240903 09:50:19.012153    65 cmd_replication.cc:297] [replication] Succeed sending file 000616.sst to 10.0.1.182
I20240903 09:50:19.118355    62 cmd_replication.cc:297] [replication] Succeed sending file 000764.sst to 10.0.1.182
I20240903 09:50:19.150846    65 cmd_replication.cc:297] [replication] Succeed sending file 000028.sst to 10.0.1.182
I20240903 09:50:19.267230    64 cmd_replication.cc:297] [replication] Succeed sending file 000784.sst to 10.0.1.182
I20240903 09:50:19.308533    62 cmd_replication.cc:297] [replication] Succeed sending file 000607.sst to 10.0.1.182
I20240903 09:50:19.420279    63 cmd_replication.cc:297] [replication] Succeed sending file 000181.sst to 10.0.1.182
I20240903 09:50:19.686789    65 cmd_replication.cc:297] [replication] Succeed sending file 000118.sst to 10.0.1.182
I20240903 09:50:20.542193    65 cmd_replication.cc:297] [replication] Succeed sending file 000650.sst to 10.0.1.182
I20240903 09:50:20.626637    62 cmd_replication.cc:297] [replication] Succeed sending file 000635.sst to 10.0.1.182
I20240903 09:50:20.643808    64 cmd_replication.cc:297] [replication] Succeed sending file 000627.sst to 10.0.1.182
I20240903 09:50:20.724064    65 cmd_replication.cc:297] [replication] Succeed sending file 000677.sst to 10.0.1.182
I20240903 09:50:20.908425    65 cmd_replication.cc:297] [replication] Succeed sending file 000697.sst to 10.0.1.182
I20240903 09:50:21.044257    64 cmd_replication.cc:297] [replication] Succeed sending file 000633.sst to 10.0.1.182
I20240903 09:50:21.064903    65 cmd_replication.cc:297] [replication] Succeed sending file 000735.sst to 10.0.1.182
I20240903 09:50:21.170583    63 cmd_replication.cc:297] [replication] Succeed sending file 000092.sst to 10.0.1.182
I20240903 09:50:21.206207    64 cmd_replication.cc:297] [replication] Succeed sending file 000634.sst to 10.0.1.182
I20240903 09:50:21.229301    65 cmd_replication.cc:297] [replication] Succeed sending file 000754.sst to 10.0.1.182
I20240903 09:50:21.636394    62 cmd_replication.cc:297] [replication] Succeed sending file 000068.sst to 10.0.1.182
I20240903 09:50:21.734787    63 cmd_replication.cc:297] [replication] Succeed sending file 000171.sst to 10.0.1.182
I20240903 09:50:21.791790    63 cmd_replication.cc:297] [replication] Succeed sending file 000676.sst to 10.0.1.182
I20240903 09:50:21.792598    64 cmd_replication.cc:297] [replication] Succeed sending file 000025.sst to 10.0.1.182
I20240903 09:50:21.826874    62 cmd_replication.cc:297] [replication] Succeed sending file 000150.sst to 10.0.1.182
I20240903 09:50:21.871572    63 cmd_replication.cc:297] [replication] Succeed sending file 000694.sst to 10.0.1.182
I20240903 09:50:22.038069    62 cmd_replication.cc:297] [replication] Succeed sending file 000675.sst to 10.0.1.182
I20240903 09:50:22.093640    63 cmd_replication.cc:297] [replication] Succeed sending file 000714.sst to 10.0.1.182
I20240903 09:50:22.106451    65 cmd_replication.cc:297] [replication] Succeed sending file 000334.sst to 10.0.1.182
I20240903 09:50:22.213804    62 cmd_replication.cc:297] [replication] Succeed sending file 000693.sst to 10.0.1.182
I20240903 09:50:22.266535    64 cmd_replication.cc:297] [replication] Succeed sending file 000180.sst to 10.0.1.182
I20240903 09:50:22.301229    63 cmd_replication.cc:297] [replication] Succeed sending file 000738.sst to 10.0.1.182
I20240903 09:50:22.418737    62 cmd_replication.cc:297] [replication] Succeed sending file 000712.sst to 10.0.1.182
I20240903 09:50:22.432060    64 cmd_replication.cc:297] [replication] Succeed sending file 000674.sst to 10.0.1.182
I20240903 09:50:22.472507    62 cmd_replication.cc:297] [replication] Succeed sending file 000736.sst to 10.0.1.182
I20240903 09:50:22.532148    64 cmd_replication.cc:297] [replication] Succeed sending file 000692.sst to 10.0.1.182
I20240903 09:50:22.618152    63 cmd_replication.cc:297] [replication] Succeed sending file 000765.sst to 10.0.1.182
I20240903 09:50:22.681921    62 cmd_replication.cc:297] [replication] Succeed sending file 000763.sst to 10.0.1.182
I20240903 09:50:22.699340    64 cmd_replication.cc:297] [replication] Succeed sending file 000713.sst to 10.0.1.182
I20240903 09:50:22.804975    64 cmd_replication.cc:297] [replication] Succeed sending file 000734.sst to 10.0.1.182
I20240903 09:50:22.831521    65 cmd_replication.cc:297] [replication] Succeed sending file 000284.sst to 10.0.1.182
I20240903 09:50:23.016659    64 cmd_replication.cc:297] [replication] Succeed sending file 000753.sst to 10.0.1.182
I20240903 09:50:23.470240    64 cmd_replication.cc:297] [replication] Succeed sending file 000335.sst to 10.0.1.182
I20240903 09:50:23.524123    65 cmd_replication.cc:297] [replication] Succeed sending file 000444.sst to 10.0.1.182
I20240903 09:50:23.630766    63 cmd_replication.cc:297] [replication] Succeed sending file 000256.sst to 10.0.1.182
I20240903 09:50:23.833221    62 cmd_replication.cc:297] [replication] Succeed sending file 000231.sst to 10.0.1.182
I20240903 09:50:24.542541    65 cmd_replication.cc:297] [replication] Succeed sending file 000599.sst to 10.0.1.182
I20240903 09:50:24.630250    64 cmd_replication.cc:297] [replication] Succeed sending file 000302.sst to 10.0.1.182
I20240903 09:50:24.730253    65 cmd_replication.cc:297] [replication] Succeed sending file 000353.sst to 10.0.1.182
I20240903 09:50:24.801339    65 cmd_replication.cc:297] [replication] Succeed sending file 000374.sst to 10.0.1.182
I20240903 09:50:24.809365    65 cmd_replication.cc:297] [replication] Succeed sending file 000788.sst to 10.0.1.182
I20240903 09:50:24.817632    65 cmd_replication.cc:297] [replication] Succeed sending file 000133.sst to 10.0.1.182
I20240903 09:50:24.862268    65 cmd_replication.cc:297] [replication] Succeed sending file 000214.sst to 10.0.1.182
I20240903 09:50:24.862474    65 cmd_replication.cc:297] [replication] Succeed sending file 000660.sst to 10.0.1.182
I20240903 09:50:24.873200    63 cmd_replication.cc:297] [replication] Succeed sending file 000411.sst to 10.0.1.182
I20240903 09:50:24.927126    62 cmd_replication.cc:297] [replication] Succeed sending file 000319.sst to 10.0.1.182
I20240903 09:50:25.391821    63 cmd_replication.cc:297] [replication] Succeed sending file 000510.sst to 10.0.1.182
I20240903 09:50:25.392629    63 cmd_replication.cc:297] [replication] Succeed sending file 000388.sst to 10.0.1.182
I20240903 09:50:25.424692    64 cmd_replication.cc:297] [replication] Succeed sending file 000460.sst to 10.0.1.182
I20240903 09:50:25.461529    63 cmd_replication.cc:297] [replication] Succeed sending file 000373.sst to 10.0.1.182
I20240903 09:50:25.463296    63 cmd_replication.cc:297] [replication] Succeed sending file 000410.sst to 10.0.1.182
I20240903 09:50:25.466998    63 cmd_replication.cc:297] [replication] Succeed sending file 000110.sst to 10.0.1.182
I20240903 09:50:25.476197    63 cmd_replication.cc:297] [replication] Succeed sending file 000196.sst to 10.0.1.182
I20240903 09:50:25.476366    63 cmd_replication.cc:297] [replication] Succeed sending file 000783.sst to 10.0.1.182
I20240903 09:50:25.476455    63 cmd_replication.cc:297] [replication] Succeed sending file OPTIONS-000793 to 10.0.1.182
I20240903 09:50:25.601061    62 cmd_replication.cc:297] [replication] Succeed sending file 000487.sst to 10.0.1.182
I20240903 09:50:26.023718    64 cmd_replication.cc:297] [replication] Succeed sending file 000603.sst to 10.0.1.182
I20240903 09:50:26.118242    64 cmd_replication.cc:297] [replication] Succeed sending file 000359.sst to 10.0.1.182
I20240903 09:50:26.121728    62 cmd_replication.cc:297] [replication] Succeed sending file 000605.sst to 10.0.1.182
I20240903 09:50:26.138623    64 cmd_replication.cc:297] [replication] Succeed sending file 000389.sst to 10.0.1.182
I20240903 09:50:26.152069    64 cmd_replication.cc:297] [replication] Succeed sending file 000769.sst to 10.0.1.182
I20240903 09:50:26.155491    64 cmd_replication.cc:297] [replication] Succeed sending file 000153.sst to 10.0.1.182
I20240903 09:50:26.175770    62 cmd_replication.cc:297] [replication] Succeed sending file 000367.sst to 10.0.1.182
I20240903 09:50:26.222126    64 cmd_replication.cc:297] [replication] Succeed sending file 000742.sst to 10.0.1.182
I20240903 09:50:26.222195    64 cmd_replication.cc:297] [replication] Succeed sending file MANIFEST-000791 to 10.0.1.182
I20240903 09:50:26.285246    62 cmd_replication.cc:297] [replication] Succeed sending file 000390.sst to 10.0.1.182
I20240903 09:50:26.337620    62 cmd_replication.cc:297] [replication] Succeed sending file 000034.sst to 10.0.1.182
I20240903 09:50:26.344663    62 cmd_replication.cc:297] [replication] Succeed sending file 000176.sst to 10.0.1.182
I20240903 09:50:26.344722    62 cmd_replication.cc:297] [replication] Succeed sending file 000789.sst to 10.0.1.182
I20240903 09:50:26.344758    62 cmd_replication.cc:297] [replication] Succeed sending file CURRENT to 10.0.1.182
I20240903 09:50:47.163534    33 cmd_replication.cc:60] Slave 10.0.1.182:45912, listening port: 6666, announce ip: 10.0.1.182 asks for synchronization with next sequence: 25585720 replication id: not supported, and local sequence: 25585719
I20240903 09:50:47.163610    33 cmd_replication.cc:113] New replica: 10.0.1.182:45912 was added, start incremental syncing
I20240903 09:50:48.675273    36 compaction_checker.cc:34] [compaction checker] Start the compact the column family: pubsub
I20240903 09:50:48.675350    36 compaction_checker.cc:37] [compaction checker] Compact the column family: pubsub finished, result: OK
I20240903 09:50:48.675361    36 compaction_checker.cc:34] [compaction checker] Start the compact the column family: propagate
I20240903 09:50:48.675710     6 event_listener.cc:79] [event_listener/compaction_begin] column family: propagate, job_id: 3, compaction reason: ManualCompaction, output compression type: no, base input level(files): 0(3), output level(files): 6(0), input bytes: 0, output bytes:0, is_manual_compaction:yes
I20240903 09:50:48.675760     6 event_listener.cc:102] [event_listener/subcompaction_begin] column family: propagate, job_id: 3, compaction reason: Unknown, output compression type: no
I20240903 09:50:48.731853     6 event_listener.cc:177] [event_listener/table_file_created] column family: propagate, file path: /var/lib/kvrocks/db/000794.sst, file size: 1760, job_id: 3, reason: compaction, status: OK
I20240903 09:50:48.731914     6 event_listener.cc:108] [event_listener/subcompaction_completed] column family: propagate, job_id: 3, compaction reason: Unknown, output compression type: no, base input level(files): 0, output level(files): 6, input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240903 09:50:48.764325     6 event_listener.cc:89] [event_listener/compaction_completed] column family: propagate, job_id: 3, compaction reason: ManualCompaction, output compression type: no, base input level(files): 0(3), output level(files): 6(1), input bytes: 4886, output bytes:1760, is_manual_compaction:yes, elapsed(micro): 56177
I20240903 09:50:48.764454     6 event_listener.cc:166] [event_listener/table_file_deleted] db: /var/lib/kvrocks/db, sst file: /var/lib/kvrocks/db/000660.sst, status: OK
I20240903 09:50:48.764484     6 event_listener.cc:166] [event_listener/table_file_deleted] db: /var/lib/kvrocks/db, sst file: /var/lib/kvrocks/db/000783.sst, status: OK
I20240903 09:50:48.764508     6 event_listener.cc:166] [event_listener/table_file_deleted] db: /var/lib/kvrocks/db, sst file: /var/lib/kvrocks/db/000789.sst, status: OK
I20240903 09:50:48.815032    36 compaction_checker.cc:37] [compaction checker] Compact the column family: propagate finished, result: OK
I20240903 09:50:48.815116     7 event_listener.cc:79] [event_listener/compaction_begin] column family: propagate, job_id: 4, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 1(1), output level(files): 2(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240903 09:50:48.815174     7 event_listener.cc:102] [event_listener/subcompaction_begin] column family: propagate, job_id: 4, compaction reason: Unknown, output compression type: no
I20240903 09:50:48.863816     7 event_listener.cc:177] [event_listener/table_file_created] column family: propagate, file path: /var/lib/kvrocks/db/000795.sst, file size: 1501, job_id: 4, reason: compaction, status: OK
I20240903 09:50:48.863858     7 event_listener.cc:108] [event_listener/subcompaction_completed] column family: propagate, job_id: 4, compaction reason: Unknown, output compression type: no, base input level(files): 1, output level(files): 2, input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240903 09:50:48.911970     7 event_listener.cc:89] [event_listener/compaction_completed] column family: propagate, job_id: 4, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 1(1), output level(files): 2(1), input bytes: 1760, output bytes:1501, is_manual_compaction:no, elapsed(micro): 48703
I20240903 09:50:48.912083     7 event_listener.cc:166] [event_listener/table_file_deleted] db: /var/lib/kvrocks/db, sst file: /var/lib/kvrocks/db/000794.sst, status: OK
I20240903 09:50:48.912132     7 event_listener.cc:79] [event_listener/compaction_begin] column family: propagate, job_id: 5, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 2(1), output level(files): 3(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240903 09:50:48.912160     7 event_listener.cc:102] [event_listener/subcompaction_begin] column family: propagate, job_id: 5, compaction reason: Unknown, output compression type: no
I20240903 09:50:48.977860     7 event_listener.cc:177] [event_listener/table_file_created] column family: propagate, file path: /var/lib/kvrocks/db/000796.sst, file size: 1501, job_id: 5, reason: compaction, status: OK
I20240903 09:50:48.977905     7 event_listener.cc:108] [event_listener/subcompaction_completed] column family: propagate, job_id: 5, compaction reason: Unknown, output compression type: no, base input level(files): 2, output level(files): 3, input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240903 09:50:49.025768     7 event_listener.cc:89] [event_listener/compaction_completed] column family: propagate, job_id: 5, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 2(1), output level(files): 3(1), input bytes: 1501, output bytes:1501, is_manual_compaction:no, elapsed(micro): 65767
I20240903 09:50:49.025885     7 event_listener.cc:166] [event_listener/table_file_deleted] db: /var/lib/kvrocks/db, sst file: /var/lib/kvrocks/db/000795.sst, status: OK
I20240903 09:50:49.025926     7 event_listener.cc:79] [event_listener/compaction_begin] column family: propagate, job_id: 6, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 3(1), output level(files): 4(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240903 09:50:49.025954     7 event_listener.cc:102] [event_listener/subcompaction_begin] column family: propagate, job_id: 6, compaction reason: Unknown, output compression type: no
I20240903 09:50:49.057718     7 event_listener.cc:177] [event_listener/table_file_created] column family: propagate, file path: /var/lib/kvrocks/db/000797.sst, file size: 1501, job_id: 6, reason: compaction, status: OK
I20240903 09:50:49.057749     7 event_listener.cc:108] [event_listener/subcompaction_completed] column family: propagate, job_id: 6, compaction reason: Unknown, output compression type: no, base input level(files): 3, output level(files): 4, input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240903 09:50:49.089035     7 event_listener.cc:89] [event_listener/compaction_completed] column family: propagate, job_id: 6, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 3(1), output level(files): 4(1), input bytes: 1501, output bytes:1501, is_manual_compaction:no, elapsed(micro): 31809
I20240903 09:50:49.089124     7 event_listener.cc:166] [event_listener/table_file_deleted] db: /var/lib/kvrocks/db, sst file: /var/lib/kvrocks/db/000796.sst, status: OK
I20240903 09:50:49.089169     7 event_listener.cc:79] [event_listener/compaction_begin] column family: propagate, job_id: 7, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240903 09:50:49.089195     7 event_listener.cc:102] [event_listener/subcompaction_begin] column family: propagate, job_id: 7, compaction reason: Unknown, output compression type: no
I20240903 09:50:49.136545     7 event_listener.cc:177] [event_listener/table_file_created] column family: propagate, file path: /var/lib/kvrocks/db/000798.sst, file size: 1501, job_id: 7, reason: compaction, status: OK
I20240903 09:50:49.136580     7 event_listener.cc:108] [event_listener/subcompaction_completed] column family: propagate, job_id: 7, compaction reason: Unknown, output compression type: no, base input level(files): 4, output level(files): 5, input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240903 09:50:49.171208     7 event_listener.cc:89] [event_listener/compaction_completed] column family: propagate, job_id: 7, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(1), input bytes: 1501, output bytes:1501, is_manual_compaction:no, elapsed(micro): 47400
I20240903 09:50:49.171315     7 event_listener.cc:166] [event_listener/table_file_deleted] db: /var/lib/kvrocks/db, sst file: /var/lib/kvrocks/db/000797.sst, status: OK
I20240903 09:50:49.171357     7 event_listener.cc:79] [event_listener/compaction_begin] column family: propagate, job_id: 8, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240903 09:50:49.171402     7 event_listener.cc:102] [event_listener/subcompaction_begin] column family: propagate, job_id: 8, compaction reason: Unknown, output compression type: no
I20240903 09:50:49.202711     7 event_listener.cc:177] [event_listener/table_file_created] column family: propagate, file path: /var/lib/kvrocks/db/000799.sst, file size: 1501, job_id: 8, reason: compaction, status: OK
I20240903 09:50:49.202746     7 event_listener.cc:108] [event_listener/subcompaction_completed] column family: propagate, job_id: 8, compaction reason: Unknown, output compression type: no, base input level(files): 5, output level(files): 6, input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240903 09:50:49.234180     7 event_listener.cc:89] [event_listener/compaction_completed] column family: propagate, job_id: 8, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(1), input bytes: 1501, output bytes:1501, is_manual_compaction:no, elapsed(micro): 31359
I20240903 09:50:49.234274     7 event_listener.cc:166] [event_listener/table_file_deleted] db: /var/lib/kvrocks/db, sst file: /var/lib/kvrocks/db/000798.sst, status: OK
I20240903 09:50:58.694487    35 server.cc:814] [server] Clean checkpoint successfully
```


Slave Log:

```
I20240903 09:50:18.853986     1 main.cc:142] kvrocks version 2.9.0
I20240903 09:50:18.901003     1 storage.cc:387] [storage] Success to load the data from disk: 13 ms
I20240903 09:50:18.903291     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:50:18.903457     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:50:18.903563     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:50:18.903661     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:50:18.903757     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:50:18.903856     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:50:18.903975     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240903 09:50:18.904074     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
W20240903 09:50:18.904390     1 replication.cc:349] Clean old synced checkpoint successfully
I20240903 09:50:18.904466     1 worker.cc:564] [worker] Thread #139711001622208 started
I20240903 09:50:18.904487     1 worker.cc:564] [worker] Thread #139711010014912 started
I20240903 09:50:18.904529     1 worker.cc:564] [worker] Thread #139711064569536 started
I20240903 09:50:18.904559     1 worker.cc:564] [worker] Thread #139711056176832 started
I20240903 09:50:18.904585     1 worker.cc:564] [worker] Thread #139711047784128 started
I20240903 09:50:18.904613     1 worker.cc:564] [worker] Thread #139711039391424 started
I20240903 09:50:18.904659     1 worker.cc:564] [worker] Thread #139711030998720 started
I20240903 09:50:18.904704     1 worker.cc:564] [worker] Thread #139711022606016 started
I20240903 09:50:18.904826     1 server.cc:228] [server] Ready to accept connections
I20240903 09:50:18.905002   133 replication.cc:401] [replication] Auth request was sent, waiting for response
I20240903 09:50:18.905215   133 replication.cc:417] [replication] Auth response was received, continue...
I20240903 09:50:18.905231   133 replication.cc:424] [replication] Check db name request was sent, waiting for response
I20240903 09:50:18.905330   133 replication.cc:444] [replication] DB name is valid, continue...
I20240903 09:50:18.905355   133 replication.cc:462] [replication] replconf request was sent, waiting for response
I20240903 09:50:18.905504   133 replication.cc:488] [replication] replconf is ok, start psync
I20240903 09:50:18.905607   133 replication.cc:518] [replication] Try to use psync, next seq: 1
I20240903 09:50:18.906639   133 replication.cc:551] [replication] Failed to psync, error: -ERR sequence out of range, please use fullsync, switch to fullsync
I20240903 09:50:18.906685   133 replication.cc:401] [replication] Auth request was sent, waiting for response
I20240903 09:50:18.906796   133 replication.cc:417] [replication] Auth response was received, continue...
I20240903 09:50:18.906812   133 replication.cc:613] [replication] Start syncing data with fullsync
I20240903 09:50:18.913395   133 replication.cc:701] [replication] Succeeded fetching full data files info, fetching files in parallel
I20240903 09:50:19.078567   145 replication.cc:805] [fetch] Fetched 000787.sst, crc32: 0, skip count: 0, fetch count: 1, progress: 1/84
I20240903 09:50:19.133827   148 replication.cc:805] [fetch] Fetched 000774.sst, crc32: 0, skip count: 0, fetch count: 2, progress: 2/84
I20240903 09:50:19.180766   145 replication.cc:805] [fetch] Fetched 000647.sst, crc32: 0, skip count: 0, fetch count: 3, progress: 3/84
I20240903 09:50:19.320425   148 replication.cc:805] [fetch] Fetched 000782.sst, crc32: 0, skip count: 0, fetch count: 4, progress: 4/84
I20240903 09:50:19.366942   145 replication.cc:805] [fetch] Fetched 000781.sst, crc32: 0, skip count: 0, fetch count: 5, progress: 5/84
I20240903 09:50:19.436174   148 replication.cc:805] [fetch] Fetched 000613.sst, crc32: 0, skip count: 0, fetch count: 6, progress: 6/84
I20240903 09:50:19.485416   147 replication.cc:805] [fetch] Fetched 000780.sst, crc32: 0, skip count: 0, fetch count: 7, progress: 7/84
I20240903 09:50:19.498481   145 replication.cc:805] [fetch] Fetched 000616.sst, crc32: 0, skip count: 0, fetch count: 8, progress: 8/84
I20240903 09:50:19.599216   147 replication.cc:805] [fetch] Fetched 000764.sst, crc32: 0, skip count: 0, fetch count: 9, progress: 9/84
I20240903 09:50:19.659133   145 replication.cc:805] [fetch] Fetched 000028.sst, crc32: 0, skip count: 0, fetch count: 10, progress: 10/84
I20240903 09:50:19.770090   147 replication.cc:805] [fetch] Fetched 000607.sst, crc32: 0, skip count: 0, fetch count: 11, progress: 11/84
I20240903 09:50:20.721870   146 replication.cc:805] [fetch] Fetched 000784.sst, crc32: 0, skip count: 0, fetch count: 12, progress: 12/84
I20240903 09:50:20.730985   148 replication.cc:805] [fetch] Fetched 000181.sst, crc32: 0, skip count: 0, fetch count: 13, progress: 13/84
I20240903 09:50:20.731966   145 replication.cc:805] [fetch] Fetched 000118.sst, crc32: 0, skip count: 0, fetch count: 14, progress: 14/84
I20240903 09:50:20.930294   145 replication.cc:805] [fetch] Fetched 000650.sst, crc32: 0, skip count: 0, fetch count: 15, progress: 15/84
I20240903 09:50:21.016780   147 replication.cc:805] [fetch] Fetched 000635.sst, crc32: 0, skip count: 0, fetch count: 16, progress: 16/84
I20240903 09:50:21.023801   146 replication.cc:805] [fetch] Fetched 000627.sst, crc32: 0, skip count: 0, fetch count: 17, progress: 17/84
I20240903 09:50:21.098882   145 replication.cc:805] [fetch] Fetched 000677.sst, crc32: 0, skip count: 0, fetch count: 18, progress: 18/84
I20240903 09:50:21.268332   145 replication.cc:805] [fetch] Fetched 000697.sst, crc32: 0, skip count: 0, fetch count: 19, progress: 19/84
I20240903 09:50:21.386924   146 replication.cc:805] [fetch] Fetched 000633.sst, crc32: 0, skip count: 0, fetch count: 20, progress: 20/84
I20240903 09:50:21.423511   145 replication.cc:805] [fetch] Fetched 000735.sst, crc32: 0, skip count: 0, fetch count: 21, progress: 21/84
I20240903 09:50:21.517524   146 replication.cc:805] [fetch] Fetched 000634.sst, crc32: 0, skip count: 0, fetch count: 22, progress: 22/84
I20240903 09:50:21.538806   148 replication.cc:805] [fetch] Fetched 000092.sst, crc32: 0, skip count: 0, fetch count: 23, progress: 23/84
I20240903 09:50:21.590159   145 replication.cc:805] [fetch] Fetched 000754.sst, crc32: 0, skip count: 0, fetch count: 24, progress: 24/84
I20240903 09:50:21.942417   147 replication.cc:805] [fetch] Fetched 000068.sst, crc32: 0, skip count: 0, fetch count: 25, progress: 25/84
I20240903 09:50:22.036463   148 replication.cc:805] [fetch] Fetched 000171.sst, crc32: 0, skip count: 0, fetch count: 26, progress: 26/84
I20240903 09:50:22.086582   148 replication.cc:805] [fetch] Fetched 000676.sst, crc32: 0, skip count: 0, fetch count: 27, progress: 27/84
I20240903 09:50:22.088688   146 replication.cc:805] [fetch] Fetched 000025.sst, crc32: 0, skip count: 0, fetch count: 28, progress: 28/84
I20240903 09:50:22.122203   147 replication.cc:805] [fetch] Fetched 000150.sst, crc32: 0, skip count: 0, fetch count: 29, progress: 29/84
I20240903 09:50:22.205904   148 replication.cc:805] [fetch] Fetched 000694.sst, crc32: 0, skip count: 0, fetch count: 30, progress: 30/84
I20240903 09:50:22.313501   147 replication.cc:805] [fetch] Fetched 000675.sst, crc32: 0, skip count: 0, fetch count: 31, progress: 31/84
I20240903 09:50:22.373884   148 replication.cc:805] [fetch] Fetched 000714.sst, crc32: 0, skip count: 0, fetch count: 32, progress: 32/84
I20240903 09:50:22.380805   145 replication.cc:805] [fetch] Fetched 000334.sst, crc32: 0, skip count: 0, fetch count: 33, progress: 33/84
I20240903 09:50:22.471745   147 replication.cc:805] [fetch] Fetched 000693.sst, crc32: 0, skip count: 0, fetch count: 34, progress: 34/84
I20240903 09:50:22.506485   146 replication.cc:805] [fetch] Fetched 000180.sst, crc32: 0, skip count: 0, fetch count: 35, progress: 35/84
I20240903 09:50:22.542912   148 replication.cc:805] [fetch] Fetched 000738.sst, crc32: 0, skip count: 0, fetch count: 36, progress: 36/84
I20240903 09:50:22.657269   147 replication.cc:805] [fetch] Fetched 000712.sst, crc32: 0, skip count: 0, fetch count: 37, progress: 37/84
I20240903 09:50:22.670325   146 replication.cc:805] [fetch] Fetched 000674.sst, crc32: 0, skip count: 0, fetch count: 38, progress: 38/84
I20240903 09:50:22.680753   147 replication.cc:805] [fetch] Fetched 000736.sst, crc32: 0, skip count: 0, fetch count: 39, progress: 39/84
I20240903 09:50:22.729039   146 replication.cc:805] [fetch] Fetched 000692.sst, crc32: 0, skip count: 0, fetch count: 40, progress: 40/84
I20240903 09:50:22.823185   148 replication.cc:805] [fetch] Fetched 000765.sst, crc32: 0, skip count: 0, fetch count: 41, progress: 41/84
I20240903 09:50:22.885578   147 replication.cc:805] [fetch] Fetched 000763.sst, crc32: 0, skip count: 0, fetch count: 42, progress: 42/84
I20240903 09:50:22.899166   146 replication.cc:805] [fetch] Fetched 000713.sst, crc32: 0, skip count: 0, fetch count: 43, progress: 43/84
I20240903 09:50:23.019675   146 replication.cc:805] [fetch] Fetched 000734.sst, crc32: 0, skip count: 0, fetch count: 44, progress: 44/84
I20240903 09:50:23.034586   145 replication.cc:805] [fetch] Fetched 000284.sst, crc32: 0, skip count: 0, fetch count: 45, progress: 45/84
I20240903 09:50:23.191298   146 replication.cc:805] [fetch] Fetched 000753.sst, crc32: 0, skip count: 0, fetch count: 46, progress: 46/84
I20240903 09:50:23.630498   146 replication.cc:805] [fetch] Fetched 000335.sst, crc32: 0, skip count: 0, fetch count: 47, progress: 47/84
I20240903 09:50:23.683187   145 replication.cc:805] [fetch] Fetched 000444.sst, crc32: 0, skip count: 0, fetch count: 48, progress: 48/84
I20240903 09:50:23.783576   148 replication.cc:805] [fetch] Fetched 000256.sst, crc32: 0, skip count: 0, fetch count: 49, progress: 49/84
I20240903 09:50:24.066447   147 replication.cc:805] [fetch] Fetched 000231.sst, crc32: 0, skip count: 0, fetch count: 50, progress: 50/84
I20240903 09:50:24.605947   145 replication.cc:805] [fetch] Fetched 000599.sst, crc32: 0, skip count: 0, fetch count: 51, progress: 51/84
I20240903 09:50:24.671267   146 replication.cc:805] [fetch] Fetched 000302.sst, crc32: 0, skip count: 0, fetch count: 52, progress: 52/84
I20240903 09:50:24.782250   145 replication.cc:805] [fetch] Fetched 000353.sst, crc32: 0, skip count: 0, fetch count: 53, progress: 53/84
I20240903 09:50:24.840951   145 replication.cc:805] [fetch] Fetched 000374.sst, crc32: 0, skip count: 0, fetch count: 54, progress: 54/84
I20240903 09:50:24.847146   145 replication.cc:805] [fetch] Fetched 000788.sst, crc32: 0, skip count: 0, fetch count: 55, progress: 55/84
I20240903 09:50:24.847613   145 replication.cc:805] [fetch] Fetched 000133.sst, crc32: 0, skip count: 0, fetch count: 56, progress: 56/84
I20240903 09:50:24.880555   145 replication.cc:805] [fetch] Fetched 000214.sst, crc32: 0, skip count: 0, fetch count: 57, progress: 57/84
I20240903 09:50:24.881171   145 replication.cc:805] [fetch] Fetched 000660.sst, crc32: 0, skip count: 0, fetch count: 58, progress: 58/84
I20240903 09:50:24.917618   148 replication.cc:805] [fetch] Fetched 000411.sst, crc32: 0, skip count: 0, fetch count: 59, progress: 59/84
I20240903 09:50:24.989461   147 replication.cc:805] [fetch] Fetched 000319.sst, crc32: 0, skip count: 0, fetch count: 60, progress: 60/84
I20240903 09:50:25.396998   148 replication.cc:805] [fetch] Fetched 000510.sst, crc32: 0, skip count: 0, fetch count: 61, progress: 61/84
I20240903 09:50:25.405366   148 replication.cc:805] [fetch] Fetched 000388.sst, crc32: 0, skip count: 0, fetch count: 62, progress: 62/84
I20240903 09:50:25.455061   146 replication.cc:805] [fetch] Fetched 000460.sst, crc32: 0, skip count: 0, fetch count: 63, progress: 63/84
I20240903 09:50:25.460081   148 replication.cc:805] [fetch] Fetched 000373.sst, crc32: 0, skip count: 0, fetch count: 64, progress: 64/84
I20240903 09:50:25.460907   148 replication.cc:805] [fetch] Fetched 000410.sst, crc32: 0, skip count: 0, fetch count: 65, progress: 65/84
I20240903 09:50:25.461334   148 replication.cc:805] [fetch] Fetched 000110.sst, crc32: 0, skip count: 0, fetch count: 66, progress: 66/84
I20240903 09:50:25.467180   148 replication.cc:805] [fetch] Fetched 000196.sst, crc32: 0, skip count: 0, fetch count: 67, progress: 67/84
I20240903 09:50:25.467353   148 replication.cc:805] [fetch] Fetched 000783.sst, crc32: 0, skip count: 0, fetch count: 68, progress: 68/84
I20240903 09:50:25.467506   148 replication.cc:805] [fetch] Fetched OPTIONS-000793, crc32: 0, skip count: 0, fetch count: 69, progress: 69/84
I20240903 09:50:25.593780   147 replication.cc:805] [fetch] Fetched 000487.sst, crc32: 0, skip count: 0, fetch count: 70, progress: 70/84
I20240903 09:50:26.014602   146 replication.cc:805] [fetch] Fetched 000603.sst, crc32: 0, skip count: 0, fetch count: 71, progress: 71/84
I20240903 09:50:26.118364   146 replication.cc:805] [fetch] Fetched 000359.sst, crc32: 0, skip count: 0, fetch count: 72, progress: 72/84
I20240903 09:50:26.121237   147 replication.cc:805] [fetch] Fetched 000605.sst, crc32: 0, skip count: 0, fetch count: 73, progress: 73/84
I20240903 09:50:26.139446   146 replication.cc:805] [fetch] Fetched 000389.sst, crc32: 0, skip count: 0, fetch count: 74, progress: 74/84
I20240903 09:50:26.146734   146 replication.cc:805] [fetch] Fetched 000769.sst, crc32: 0, skip count: 0, fetch count: 75, progress: 75/84
I20240903 09:50:26.147277   146 replication.cc:805] [fetch] Fetched 000153.sst, crc32: 0, skip count: 0, fetch count: 76, progress: 76/84
I20240903 09:50:26.181603   147 replication.cc:805] [fetch] Fetched 000367.sst, crc32: 0, skip count: 0, fetch count: 77, progress: 77/84
I20240903 09:50:26.219069   146 replication.cc:805] [fetch] Fetched 000742.sst, crc32: 0, skip count: 0, fetch count: 78, progress: 78/84
I20240903 09:50:26.219228   146 replication.cc:805] [fetch] Fetched MANIFEST-000791, crc32: 0, skip count: 0, fetch count: 79, progress: 79/84
I20240903 09:50:26.278401   147 replication.cc:805] [fetch] Fetched 000390.sst, crc32: 0, skip count: 0, fetch count: 80, progress: 80/84
I20240903 09:50:26.318702   147 replication.cc:805] [fetch] Fetched 000034.sst, crc32: 0, skip count: 0, fetch count: 81, progress: 81/84
I20240903 09:50:26.325289   147 replication.cc:805] [fetch] Fetched 000176.sst, crc32: 0, skip count: 0, fetch count: 82, progress: 82/84
I20240903 09:50:26.325376   147 replication.cc:805] [fetch] Fetched 000789.sst, crc32: 0, skip count: 0, fetch count: 83, progress: 83/84
I20240903 09:50:26.325443   147 replication.cc:805] [fetch] Fetched CURRENT, crc32: 0, skip count: 0, fetch count: 84, progress: 84/84
I20240903 09:50:26.325528   133 replication.cc:717] [replication] Succeeded fetching files in parallel, restoring the backup
I20240903 09:50:26.325563   133 server.cc:1339] [server] Disconnecting slaves...
I20240903 09:50:26.325577   133 server.cc:1343] [server] Stopping the task runner and clear task queue...
I20240903 09:50:26.325742   133 server.cc:1357] [server] Waiting workers for finishing executing commands...
I20240903 09:50:26.325755   133 server.cc:1365] [server] Waiting for closing DB...
I20240903 09:50:47.142118   133 storage.cc:387] [storage] Success to load the data from disk: 331 ms
I20240903 09:50:47.142486   133 replication.cc:732] [replication] Succeeded restoring the backup, fullsync was finish
I20240903 09:50:47.143034   133 replication.cc:401] [replication] Auth request was sent, waiting for response
I20240903 09:50:47.143190   133 replication.cc:417] [replication] Auth response was received, continue...
I20240903 09:50:47.143208   133 replication.cc:401] [replication] Auth request was sent, waiting for response
I20240903 09:50:47.143339   133 replication.cc:417] [replication] Auth response was received, continue...
I20240903 09:50:47.143358   133 replication.cc:424] [replication] Check db name request was sent, waiting for response
I20240903 09:50:47.143453   133 replication.cc:444] [replication] DB name is valid, continue...
I20240903 09:50:47.143471   133 replication.cc:462] [replication] replconf request was sent, waiting for response
I20240903 09:50:47.143574   133 replication.cc:488] [replication] replconf is ok, start psync
I20240903 09:50:47.143678   133 replication.cc:518] [replication] Try to use psync, next seq: 25585720
I20240903 09:50:47.143887   133 replication.cc:555] [replication] PSync is ok, start increment batch loop
```

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2520/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Kpkfs,kvrocks,2326153196,2520,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-03T10:21:19Z,2024-09-03T10:21:19Z,@fstd2 Did you enable `repl-namespace-enabled` configuration on the master node?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Kpkfs/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KvpPp,kvrocks,2327745513,2520,NA,fstd2,56252962,Genji,,NA,2024-09-04T01:43:06Z,2024-09-04T01:43:06Z,"> @fstd2 Did you enable `repl-namespace-enabled` configuration on the master node?

Yes, on both nodes configured as `repl-namespace-enabled yes`","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KvpPp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Kv60K,kvrocks,2327817482,2520,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-04T02:57:40Z,2024-09-04T02:57:40Z,"@fstd2 Can you also paste the output from the `config get`:

```
redis-cli> config get repl-namespace-enabled
```

I want to confirm if it took effect during runtime.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Kv60K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KwJ73,kvrocks,2327879415,2520,NA,fstd2,56252962,Genji,,NA,2024-09-04T04:16:27Z,2024-09-04T04:16:27Z,"@git-hulk Thank you for your quick response. Here is the output from the command execution:

Master:

```
10.0.1.181:6666> config get repl-namespace-enabled
repl-namespace-enabled: yes
```

Slave:

```
10.0.1.182:6666> config get repl-namespace-enabled
repl-namespace-enabled: yes
```

Does it look good?

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KwJ73/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KwK6k,kvrocks,2327883428,2520,NA,fstd2,56252962,Genji,,NA,2024-09-04T04:21:14Z,2024-09-04T04:21:14Z,"Here’s more information, including some tests:

I used the following configuration and started using Docker with most configurations set to default:



Start Command:

```
docker run -it --name kvrocks --restart always -d -v ./kvrocks:/var/lib/kvrocks -p 6666:6666 apache/kvrocks:2.9.0
```



## Master:

Only the following changes were made:

```
bind 0.0.0.0
repl-namespace-enabled yes
dir /var/lib/kvrocks
backup-dir /var/lib/kvrocks/backup
pidfile /var/run/kvrocks/kvrocks.pid
requirepass kvrocks
```

Full configuration:

```
bind 0.0.0.0
port 6666
timeout 0
workers 8
daemonize no
cluster-enabled no
repl-namespace-enabled yes
persist-cluster-nodes-enabled yes
maxclients 10000
db-name change.me.db
dir /var/lib/kvrocks
log-dir stdout
log-level info
log-retention-days -1
slave-read-only yes
slave-priority 100
tcp-backlog 511
master-use-repl-port no
use-rsid-psync no
slave-serve-stale-data yes
slave-empty-db-before-fullsync no
purge-backup-on-fullsync no
max-replication-mb 0
max-io-mb 0
max-db-size 0
max-backup-to-keep 1
max-backup-keep-hours 24
max-bitmap-to-string-mb 16
redis-cursor-compatible yes
json-max-nesting-depth 1024
json-storage-format json
slowlog-log-slower-than 100000
slowlog-max-len 128
supervised no
profiling-sample-ratio 0
profiling-sample-record-max-len 256
profiling-sample-record-threshold-ms 100
compaction-checker-cron ""* 0-7 * * *""
migrate-type redis-command
migrate-speed 4096
migrate-pipeline-size 16
migrate-sequence-gap 10000
migrate-batch-size-kb 16
migrate-batch-rate-limit-mb 16
rocksdb.block_cache_size 4096
rocksdb.block_cache_type lru
rocksdb.row_cache_size 0
rocksdb.max_open_files 8096
rocksdb.write_buffer_size 64
rocksdb.target_file_size_base 128
rocksdb.max_write_buffer_number 4
rocksdb.max_background_jobs 4
rocksdb.max_background_compactions -1
rocksdb.max_background_flushes -1
rocksdb.max_sub_compactions 2
rocksdb.max_total_wal_size 512
rocksdb.wal_ttl_seconds 10800
rocksdb.wal_size_limit_mb 16384
rocksdb.block_size 16384
rocksdb.cache_index_and_filter_blocks yes
rocksdb.compression snappy
rocksdb.compression_level 32767
rocksdb.compaction_readahead_size 2097152
rocksdb.delayed_write_rate 0
rocksdb.enable_pipelined_write no
rocksdb.level0_slowdown_writes_trigger 20
rocksdb.level0_stop_writes_trigger 40
rocksdb.level0_file_num_compaction_trigger 4
rocksdb.stats_dump_period_sec 0
rocksdb.disable_auto_compactions no
rocksdb.enable_blob_files no
rocksdb.min_blob_size 4096
rocksdb.blob_file_size 268435456
rocksdb.enable_blob_garbage_collection yes
rocksdb.blob_garbage_collection_age_cutoff 25
rocksdb.level_compaction_dynamic_level_bytes yes
rocksdb.max_bytes_for_level_base 268435456
rocksdb.max_bytes_for_level_multiplier 10
rocksdb.read_options.async_io yes
rocksdb.write_options.sync no
rocksdb.write_options.disable_wal no
rocksdb.write_options.no_slowdown no
rocksdb.write_options.low_pri no
rocksdb.write_options.memtable_insert_hint_per_batch no
rocksdb.rate_limiter_auto_tuned yes
backup-dir /var/lib/kvrocks/backup
pidfile /var/run/kvrocks/kvrocks.pid
requirepass kvrocks
```

execution output:

```
10.0.1.181:6666> config get repl-namespace-enabled
repl-namespace-enabled: yes
10.0.1.181:6666> info REPLICATION
# Replication
role:master
connected_slaves:1
slave0:ip=10.0.1.182,port=6666,offset=25585719,lag=0
master_repl_offset:25585719
10.0.1.181:6666> namespace get *
 1) ""db10""
 2) ""db10""
 3) ""db11""
 4) ""db11""
 5) ""db12""
 6) ""db12""
 7) ""db356""
 8) ""db356""
 9) ""db377""
10) ""db377""
11) ""db59""
12) ""db59""
13) ""db60""
14) ""db60""
15) ""db61""
16) ""db61""
17) ""db62""
18) ""db62""
19) ""db66""
20) ""db66""
21) ""db67""
22) ""db67""
23) ""db70""
24) ""db70""
25) ""db71""
26) ""db71""
27) ""db72""
28) ""db72""
29) ""db73""
30) ""db73""
31) ""db74""
32) ""db74""
33) ""db75""
34) ""db75""
35) ""__namespace""
36) ""kvrocks""
```

## Slave:

Only the following changes were made:

```
bind 0.0.0.0
repl-namespace-enabled yes
dir /var/lib/kvrocks
backup-dir /var/lib/kvrocks/backup
masterauth kvrocks
pidfile /var/run/kvrocks/kvrocks.pid
requirepass kvrocks
slaveof ""10.0.1.181 6666""
```

Full configuration:

```
bind 0.0.0.0
port 6666
timeout 0
workers 8
daemonize no
cluster-enabled no
repl-namespace-enabled yes
persist-cluster-nodes-enabled yes
maxclients 10000
db-name change.me.db
dir /var/lib/kvrocks
log-dir stdout
log-level info
log-retention-days -1
slave-read-only yes
slave-priority 100
tcp-backlog 511
master-use-repl-port no
use-rsid-psync no
slave-serve-stale-data yes
slave-empty-db-before-fullsync no
purge-backup-on-fullsync no
max-replication-mb 0
max-io-mb 0
max-db-size 0
max-backup-to-keep 1
max-backup-keep-hours 24
max-bitmap-to-string-mb 16
redis-cursor-compatible yes
json-max-nesting-depth 1024
json-storage-format json
slowlog-log-slower-than 100000
slowlog-max-len 128
supervised no
profiling-sample-ratio 0
profiling-sample-record-max-len 256
profiling-sample-record-threshold-ms 100
compaction-checker-cron ""* 0-7 * * *""
migrate-type redis-command
migrate-speed 4096
migrate-pipeline-size 16
migrate-sequence-gap 10000
migrate-batch-size-kb 16
migrate-batch-rate-limit-mb 16
rocksdb.block_cache_size 4096
rocksdb.block_cache_type lru
rocksdb.row_cache_size 0
rocksdb.max_open_files 8096
rocksdb.write_buffer_size 64
rocksdb.target_file_size_base 128
rocksdb.max_write_buffer_number 4
rocksdb.max_background_jobs 4
rocksdb.max_background_compactions -1
rocksdb.max_background_flushes -1
rocksdb.max_sub_compactions 2
rocksdb.max_total_wal_size 512
rocksdb.wal_ttl_seconds 10800
rocksdb.wal_size_limit_mb 16384
rocksdb.block_size 16384
rocksdb.cache_index_and_filter_blocks yes
rocksdb.compression snappy
rocksdb.compression_level 32767
rocksdb.compaction_readahead_size 2097152
rocksdb.delayed_write_rate 0
rocksdb.enable_pipelined_write no
rocksdb.level0_slowdown_writes_trigger 20
rocksdb.level0_stop_writes_trigger 40
rocksdb.level0_file_num_compaction_trigger 4
rocksdb.stats_dump_period_sec 0
rocksdb.disable_auto_compactions no
rocksdb.enable_blob_files no
rocksdb.min_blob_size 4096
rocksdb.blob_file_size 268435456
rocksdb.enable_blob_garbage_collection yes
rocksdb.blob_garbage_collection_age_cutoff 25
rocksdb.level_compaction_dynamic_level_bytes yes
rocksdb.max_bytes_for_level_base 268435456
rocksdb.max_bytes_for_level_multiplier 10
rocksdb.read_options.async_io yes
rocksdb.write_options.sync no
rocksdb.write_options.disable_wal no
rocksdb.write_options.no_slowdown no
rocksdb.write_options.low_pri no
rocksdb.write_options.memtable_insert_hint_per_batch no
rocksdb.rate_limiter_auto_tuned yes
backup-dir /var/lib/kvrocks/backup
masterauth kvrocks
pidfile /var/run/kvrocks/kvrocks.pid
requirepass kvrocks
slaveof ""10.0.1.181 6666""
```

execution output:

```
10.0.1.182:6666> config get repl-namespace-enabled
repl-namespace-enabled: yes

10.0.1.182:6666> info REPLICATION
# Replication
role:slave
master_host:10.0.1.181
master_port:6666
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:1
slave_repl_offset:25585719
slave_priority:100
connected_slaves:0
master_repl_offset:25585719

10.0.1.182:6666> namespace get *
1) ""__namespace""
2) ""kvrocks""
```



**As I mentioned above, if any operations are performed on the namespace in the master at this time, the slave can then synchronize and display all namespaces:**

Master execution output:

```
10.0.1.181:6666> namespace del db10
""OK""

10.0.1.181:6666> namespace get *
 1) ""db11""
 2) ""db11""
 3) ""db12""
 4) ""db12""
 5) ""db356""
 6) ""db356""
 7) ""db377""
 8) ""db377""
 9) ""db59""
10) ""db59""
11) ""db60""
12) ""db60""
13) ""db61""
14) ""db61""
15) ""db62""
16) ""db62""
17) ""db66""
18) ""db66""
19) ""db67""
20) ""db67""
21) ""db70""
22) ""db70""
23) ""db71""
24) ""db71""
25) ""db72""
26) ""db72""
27) ""db73""
28) ""db73""
29) ""db74""
30) ""db74""
31) ""db75""
32) ""db75""
33) ""__namespace""
34) ""kvrocks""

10.0.1.181:6666> info REPLICATION
# Replication
role:master
connected_slaves:1
slave0:ip=10.0.1.182,port=6666,offset=25585720,lag=0
master_repl_offset:25585720
```

Slave execution output:

```
10.0.1.182:6666> info REPLICATION
# Replication
role:slave
master_host:10.0.1.181
master_port:6666
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:2
slave_repl_offset:25585720
slave_priority:100
connected_slaves:0
master_repl_offset:25585720
10.0.1.182:6666> namespace get *
 1) ""db11""
 2) ""db11""
 3) ""db12""
 4) ""db12""
 5) ""db356""
 6) ""db356""
 7) ""db377""
 8) ""db377""
 9) ""db59""
10) ""db59""
11) ""db60""
12) ""db60""
13) ""db61""
14) ""db61""
15) ""db62""
16) ""db62""
17) ""db66""
18) ""db66""
19) ""db67""
20) ""db67""
21) ""db70""
22) ""db70""
23) ""db71""
24) ""db71""
25) ""db72""
26) ""db72""
27) ""db73""
28) ""db73""
29) ""db74""
30) ""db74""
31) ""db75""
32) ""db75""
33) ""__namespace""
34) ""kvrocks""
10.0.1.182:6666> config get repl-namespace-enabled
repl-namespace-enabled: yes
```


# Situation where it works correctly


I also tested by creating only 17 empty namespaces, and it seems that psync was used for master-slave replication. Everything worked fine in this case.

Master log:

```
I20240904 03:55:26.334841     1 main.cc:142] kvrocks version 2.9.0
I20240904 03:55:26.379802     1 storage.cc:387] [storage] Success to load the data from disk: 15 ms
I20240904 03:55:26.381878     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:26.382046     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:26.382148     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:26.382246     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:26.382340     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:26.382447     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:26.382544     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:26.382638     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:26.382815     1 worker.cc:564] [worker] Thread #140426241582784 started
I20240904 03:55:26.382838     1 worker.cc:564] [worker] Thread #140426283546304 started
I20240904 03:55:26.382858     1 worker.cc:564] [worker] Thread #140426291939008 started
I20240904 03:55:26.382968     1 worker.cc:564] [worker] Thread #140426350687936 started
I20240904 03:55:26.383000     1 worker.cc:564] [worker] Thread #140426342295232 started
I20240904 03:55:26.383034     1 worker.cc:564] [worker] Thread #140426333902528 started
I20240904 03:55:26.383064     1 worker.cc:564] [worker] Thread #140426325509824 started
I20240904 03:55:26.383092     1 worker.cc:564] [worker] Thread #140426317117120 started
I20240904 03:55:26.383190     1 server.cc:228] [server] Ready to accept connections
W20240904 03:55:28.844203   137 cmd_server.cc:104] New namespace: db10 with token: db10, addr: 172.17.0.1:32872, result: ok
W20240904 03:55:28.845882   140 cmd_server.cc:104] New namespace: db11 with token: db11, addr: 172.17.0.1:32876, result: ok
W20240904 03:55:28.847543   136 cmd_server.cc:104] New namespace: db12 with token: db12, addr: 172.17.0.1:32880, result: ok
W20240904 03:55:28.848882   140 cmd_server.cc:104] New namespace: db356 with token: db356, addr: 172.17.0.1:32884, result: ok
W20240904 03:55:28.850231   140 cmd_server.cc:104] New namespace: db377 with token: db377, addr: 172.17.0.1:32888, result: ok
W20240904 03:55:28.851522   140 cmd_server.cc:104] New namespace: db59 with token: db59, addr: 172.17.0.1:32892, result: ok
W20240904 03:55:28.852794   137 cmd_server.cc:104] New namespace: db60 with token: db60, addr: 172.17.0.1:32896, result: ok
W20240904 03:55:28.854898   133 cmd_server.cc:104] New namespace: db61 with token: db61, addr: 172.17.0.1:32900, result: ok
W20240904 03:55:28.856266   139 cmd_server.cc:104] New namespace: db62 with token: db62, addr: 172.17.0.1:32904, result: ok
W20240904 03:55:28.858305   138 cmd_server.cc:104] New namespace: db66 with token: db66, addr: 172.17.0.1:32908, result: ok
W20240904 03:55:28.859678   135 cmd_server.cc:104] New namespace: db67 with token: db67, addr: 172.17.0.1:32912, result: ok
W20240904 03:55:28.860860   139 cmd_server.cc:104] New namespace: db70 with token: db70, addr: 172.17.0.1:32916, result: ok
W20240904 03:55:28.862066   138 cmd_server.cc:104] New namespace: db71 with token: db71, addr: 172.17.0.1:32920, result: ok
W20240904 03:55:28.863344   139 cmd_server.cc:104] New namespace: db72 with token: db72, addr: 172.17.0.1:32924, result: ok
W20240904 03:55:28.864746   134 cmd_server.cc:104] New namespace: db73 with token: db73, addr: 172.17.0.1:32928, result: ok
W20240904 03:55:28.865957   137 cmd_server.cc:104] New namespace: db74 with token: db74, addr: 172.17.0.1:32932, result: ok
W20240904 03:55:28.867158   133 cmd_server.cc:104] New namespace: db75 with token: db75, addr: 172.17.0.1:32936, result: ok
I20240904 03:55:36.196095   137 cmd_replication.cc:60] Slave 10.0.1.182:58656, listening port: 6666, announce ip: 10.0.1.182 asks for synchronization with next sequence: 1 replication id: not supported, and local sequence: 17
I20240904 03:55:36.196384   137 cmd_replication.cc:113] New replica: 10.0.1.182:58656 was added, start incremental syncing
```

Slave log:

```
I20240904 03:55:36.145757     1 main.cc:142] kvrocks version 2.9.0
I20240904 03:55:36.191144     1 storage.cc:387] [storage] Success to load the data from disk: 14 ms
I20240904 03:55:36.193413     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:36.193589     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:36.193694     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:36.193789     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:36.193897     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:36.194031     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:36.194130     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
I20240904 03:55:36.194227     1 worker.cc:72] [worker] Listening on: 0.0.0.0:6666
W20240904 03:55:36.194535     1 replication.cc:349] Clean old synced checkpoint successfully
I20240904 03:55:36.194615     1 worker.cc:564] [worker] Thread #140647096874688 started
I20240904 03:55:36.194641     1 worker.cc:564] [worker] Thread #140647105267392 started
I20240904 03:55:36.194702     1 worker.cc:564] [worker] Thread #140647159822016 started
I20240904 03:55:36.194780     1 worker.cc:564] [worker] Thread #140647151429312 started
I20240904 03:55:36.194837     1 worker.cc:564] [worker] Thread #140647143036608 started
I20240904 03:55:36.194911     1 worker.cc:564] [worker] Thread #140647134643904 started
I20240904 03:55:36.194979     1 worker.cc:564] [worker] Thread #140647126251200 started
I20240904 03:55:36.195019     1 worker.cc:564] [worker] Thread #140647117858496 started
I20240904 03:55:36.195145     1 server.cc:228] [server] Ready to accept connections
I20240904 03:55:36.195345   132 replication.cc:401] [replication] Auth request was sent, waiting for response
I20240904 03:55:36.195552   132 replication.cc:417] [replication] Auth response was received, continue...
I20240904 03:55:36.195569   132 replication.cc:424] [replication] Check db name request was sent, waiting for response
I20240904 03:55:36.195670   132 replication.cc:444] [replication] DB name is valid, continue...
I20240904 03:55:36.195703   132 replication.cc:462] [replication] replconf request was sent, waiting for response
I20240904 03:55:36.195816   132 replication.cc:488] [replication] replconf is ok, start psync
I20240904 03:55:36.195955   132 replication.cc:518] [replication] Try to use psync, next seq: 1
I20240904 03:55:36.196385   132 replication.cc:555] [replication] PSync is ok, start increment batch loop
```

Slave execution output:

```
10.0.1.182:6666> info REPLICATION
# Replication
role:slave
master_host:10.0.1.181
master_port:6666
master_link_status:up
master_sync_unrecoverable_error:no
master_sync_in_progress:0
master_last_io_seconds_ago:1
slave_repl_offset:17
slave_priority:100
connected_slaves:0
master_repl_offset:17
10.0.1.182:6666> namespace get *
 1) ""db10""
 2) ""db10""
 3) ""db11""
 4) ""db11""
 5) ""db12""
 6) ""db12""
 7) ""db356""
 8) ""db356""
 9) ""db377""
10) ""db377""
11) ""db59""
12) ""db59""
13) ""db60""
14) ""db60""
15) ""db61""
16) ""db61""
17) ""db62""
18) ""db62""
19) ""db66""
20) ""db66""
21) ""db67""
22) ""db67""
23) ""db70""
24) ""db70""
25) ""db71""
26) ""db71""
27) ""db72""
28) ""db72""
29) ""db73""
30) ""db73""
31) ""db74""
32) ""db74""
33) ""db75""
34) ""db75""
35) ""__namespace""
36) ""kvrocks""
```



","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KwK6k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KwhtM,kvrocks,2327976780,2520,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-04T05:51:56Z,2024-09-04T05:51:56Z,"@fstd2 Thanks for your detailed information. 

I generally know the root cause based on your information. The reason is that all namespaces are stored inside the instance memory, and the replica instance will reload namespaces if it got a namespace event from the replication batch.

So for the full sync scenario, it won't get any namespace event, and then it won't reload namespaces from DB. And that's why they are visible again once you do any operation to namespaces.

The workaround is to reload namespaces after fully syncing the DB from the master.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6KwhtM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2520,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6K_URG,kvrocks,2331853894,2520,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-05T14:34:26Z,2024-09-05T14:34:26Z,I will continue fixing this PR after #2522 is merged.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6K_URG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2521,https://api.github.com/repos/apache/kvrocks/issues/2521,kvrocks,2504180502,2521,Improve the code style by introducing macros,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2024-09-04T02:50:38Z,2024-09-07T12:32:56Z,"Followup code improvements mentioned in PR #2508. Currently, we check and return error if the status is not ok in many many places, which can be improved by introducing macros.

The naming candidates can be:

- RETURN_NOT_OK
- RETURN_IF_ERROR

and for converting the rocksdb status if there is an error:

- RETURN_NOT_OK_FROM_ROCKSDB
- RETURN_IF_ERR_FROM_ROCKSDB

_Originally posted by @mapleFU in https://github.com/apache/kvrocks/pull/2508#pullrequestreview-2276461263_
            ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2521/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2521,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Kv6Y3,kvrocks,2327815735,2521,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-04T02:55:16Z,2024-09-04T02:55:16Z,@AntiTopQuark Would you like to take this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Kv6Y3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2521,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6K0u3R,kvrocks,2329079249,2521,NA,AntiTopQuark,32798045,AntiTopQuark,AntiTopQuark1350@outlook.com,NA,2024-09-04T13:35:16Z,2024-09-04T13:35:16Z,"> @AntiTopQuark Would you like to take this issue?

I’d be happy to take on this issue.  ：）","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6K0u3R/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2521,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLr9P,kvrocks,2335096655,2521,NA,PragmaTwice,20042607,Twice,,NA,2024-09-07T07:01:09Z,2024-09-07T07:01:09Z,The first macro is duplicated with the current GET_OR_RET macro.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLr9P/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2521,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLsEq,kvrocks,2335097130,2521,NA,PragmaTwice,20042607,Twice,,NA,2024-09-07T07:03:05Z,2024-09-07T07:03:05Z,"For the second I think it depends on the context, e.g. rocksdb::Status -> Status? rocksdb::Status -> rocksdb::Status?

We can extend GET_OR_RET for the latter, and the former doesn't require new macro.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLsEq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2521,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LL-tt,kvrocks,2335173485,2521,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-07T12:32:55Z,2024-09-07T12:32:55Z,"> For the second I think it depends on the context, e.g. rocksdb::Status -> Status? rocksdb::Status -> rocksdb::Status?
> 
> We can extend GET_OR_RET for the latter, and the former doesn't require new macro.

Yes, my bad. GET_OR_RET allows ignoring the return value, so the former one is unnecessary.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LL-tt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2526,https://api.github.com/repos/apache/kvrocks/issues/2526,kvrocks,2511501250,2526,why did kvrocks stopped when run for a fewer days,epubreader,8253681,Mason Yang,,CLOSED,2024-09-07T06:34:51Z,2024-09-07T14:08:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

docker 2.9.0 as a salve

### Minimal reproduce step

I20240829 07:04:55.666883     8 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 44, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 3(1), output level(files): 4(1), input bytes: 134621982, output bytes:62393026, is_manual_compaction:no, elapsed(micro): 886844
I20240829 07:04:55.674885     8 event_listener.cc:166] [event_listener/table_file_deleted] db: /data/db, sst file: /data/db/003332.sst, status: OK
I20240829 07:04:55.690603     9 event_listener.cc:177] [event_listener/table_file_created] column family: default, file path: /data/db/003355.sst, file size: 48023726, job_id: 46, reason: compaction, status: OK
I20240829 07:04:55.690665     9 event_listener.cc:108] [event_listener/subcompaction_completed] column family: default, job_id: 46, compaction reason: Unknown, output compression type: no, base input level(files): 3, output level(files): 4, input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.693023     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 46, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 3(1), output level(files): 4(1), input bytes: 96002854, output bytes:48023726, is_manual_compaction:no, elapsed(micro): 458673
I20240829 07:04:55.707248     9 event_listener.cc:166] [event_listener/table_file_deleted] db: /data/db, sst file: /data/db/003330.sst, status: OK
I20240829 07:04:55.733680     9 event_listener.cc:166] [event_listener/table_file_deleted] db: /data/db, sst file: /data/db/003348.sst, status: OK
I20240829 07:04:55.753513     9 event_listener.cc:166] [event_listener/table_file_deleted] db: /data/db, sst file: /data/db/003351.sst, status: OK
I20240829 07:04:55.753652     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 47, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.754774     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 47, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.754900     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 48, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.755821     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 48, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.755920     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 49, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.756806     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 49, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.756891     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 50, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.757870     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 50, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.757967     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 51, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.758857     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 51, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.758944     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 52, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.759829     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 52, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240830 00:00:17.913046   128 compaction_checker.cc:34] [compaction checker] Start the compact the column family: pubsub
I20240830 00:00:17.913148   128 compaction_checker.cc:37] [compaction checker] Compact the column family: pubsub finished, result: OK
I20240830 00:00:17.913177   128 compaction_checker.cc:34] [compaction checker] Start the compact the column family: propagate
I20240830 00:00:17.913203   128 compaction_checker.cc:37] [compaction checker] Compact the column family: propagate finished, result: OK
I20240831 00:00:38.788959   128 compaction_checker.cc:34] [compaction checker] Start the compact the column family: pubsub
I20240831 00:00:38.789081   128 compaction_checker.cc:37] [compaction checker] Compact the column family: pubsub finished, result: OK
I20240831 00:00:38.789122   128 compaction_checker.cc:34] [compaction checker] Start the compact the column family: propagate
I20240831 00:00:38.789162   128 compaction_checker.cc:37] [compaction checker] Compact the column family: propagate finished, result: OK
I20240831 22:35:40.682274     1 main.cc:52] Bye Bye
I20240831 22:35:40.724730   117 replication.cc:952] [replication] Stop ev loop
I20240831 22:35:40.726697     1 replication.cc:371] [replication] Stopped
""docker.log"" 1211L, 191013B

### What did you expect to see?

why did kvrocks stopped when run for a fewer days

### What did you see instead?

why did kvrocks stopped when run for a fewer days

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2526/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLr11,kvrocks,2335096181,2526,NA,PragmaTwice,20042607,Twice,,NA,2024-09-07T06:59:22Z,2024-09-07T06:59:22Z,"> I20240831 22:35:40.682274 1 main.cc:52] Bye Bye

It indicates that someone send some signal to the kvrocks process to make it stop.

IMHO it's not an issue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLr11/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLsix,kvrocks,2335099057,2526,NA,epubreader,8253681,Mason Yang,,NA,2024-09-07T07:10:21Z,2024-09-07T07:10:21Z,"> > I20240831 22:35:40.682274 1 main.cc:52] Bye Bye
> 
> It indicates that someone send some signal to the kvrocks process to make it stop.
> 
> IMHO it's not an issue.

did someone hack the server, how to check it?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLsix/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLyuj,kvrocks,2335124387,2526,NA,epubreader,8253681,Mason Yang,,NA,2024-09-07T08:59:59Z,2024-09-07T08:59:59Z,"Hi, @wanghenshui when kvrocks process down, the container should restart, I have add ""restart-condition on-failure"" parameter.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLyuj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLz2x,kvrocks,2335129009,2526,NA,epubreader,8253681,Mason Yang,,NA,2024-09-07T09:17:40Z,2024-09-07T09:17:40Z,"add master logs:

I20240829 07:04:55.478088     9 event_listener.cc:166] [event_listener/table_file_deleted] db: /data/db, sst file: /data/db/003344.sst, status: OK
I20240829 07:04:55.478173     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 3475, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.478853     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 3475, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.478917     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 3476, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.479483     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 3476, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.479527     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 3477, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.480060     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 3477, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 4(1), output level(files): 5(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.480103     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 3478, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.480641     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 3478, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.480680     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 3479, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.481225     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 3479, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240829 07:04:55.481266     9 event_listener.cc:79] [event_listener/compaction_begin] column family: default, job_id: 3480, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(0), input bytes: 0, output bytes:0, is_manual_compaction:no
I20240829 07:04:55.481810     9 event_listener.cc:89] [event_listener/compaction_completed] column family: default, job_id: 3480, compaction reason: LevelMaxLevelSize, output compression type: snappy, base input level(files): 5(1), output level(files): 6(1), input bytes: 0, output bytes:0, is_manual_compaction:no, elapsed(micro): 0
I20240830 00:00:08.965274   127 compaction_checker.cc:34] [compaction checker] Start the compact the column family: pubsub
I20240830 00:00:08.965399   127 compaction_checker.cc:37] [compaction checker] Compact the column family: pubsub finished, result: OK
I20240830 00:00:08.965422   127 compaction_checker.cc:34] [compaction checker] Start the compact the column family: propagate
I20240830 00:00:08.965442   127 compaction_checker.cc:37] [compaction checker] Compact the column family: propagate finished, result: OK
I20240831 00:00:14.683569   127 compaction_checker.cc:34] [compaction checker] Start the compact the column family: pubsub
I20240831 00:00:14.684681   127 compaction_checker.cc:37] [compaction checker] Compact the column family: pubsub finished, result: OK
I20240831 00:00:14.684916   127 compaction_checker.cc:34] [compaction checker] Start the compact the column family: propagate
I20240831 00:00:14.684942   127 compaction_checker.cc:37] [compaction checker] Compact the column family: propagate finished, result: OK
I20240831 01:10:23.821178 258118 replication.cc:115] WAL was rotated, would reopen again
W20240831 22:35:43.263211 258118 replication.cc:84] Slave thread was terminated, would stop feeding the slave: 10.0.1.253:39616","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LLz2x/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LMBrw,kvrocks,2335185648,2526,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-09-07T13:19:03Z,2024-09-07T13:19:03Z,Better dmesg -T or using other to see how signal is sent.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LMBrw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LMEuW,kvrocks,2335198102,2526,NA,wanghenshui,8872493,Ted Mostly,wanghenshui@qq.com,NA,2024-09-07T14:06:58Z,2024-09-07T14:06:58Z,"> Hi, @wanghenshui when kvrocks process down, the container should restart, I have add ""restart-condition on-failure"" parameter.


do you mean docker process exist but kvrocks process get killed？`restart-condition on-failure` works for docker ONLY, not the kvrocks process, you could use supervisor guard it

also like mapleFU said,  better dmesg -T check who killed it, maybe OOM killer or something else

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LMEuW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2526,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LME3Z,kvrocks,2335198681,2526,NA,epubreader,8253681,Mason Yang,,NA,2024-09-07T14:08:32Z,2024-09-07T14:08:32Z,"> Better dmesg -T or using other to see how signal is sent.

[Fri Aug 30 20:05:58 2024] br0: port 13(veth184) entered blocking state
[Fri Aug 30 20:05:58 2024] br0: port 13(veth184) entered forwarding state
[Fri Aug 30 20:05:58 2024] eth1: renamed from veth92a8d29
[Fri Aug 30 20:05:58 2024] br0: port 13(veth180) entered blocking state
[Fri Aug 30 20:05:58 2024] br0: port 13(veth180) entered forwarding state
[Fri Aug 30 20:05:58 2024] eth2: renamed from vethd3e7546
[Fri Aug 30 20:05:58 2024] docker_gwbridge: port 8(veth1af94e5) entered blocking state
[Fri Aug 30 20:05:58 2024] docker_gwbridge: port 8(veth1af94e5) entered forwarding state
[Sat Aug 31 22:35:14 2024] net_ratelimit: 7 callbacks suppressed
[Sat Aug 31 22:35:14 2024] IPVS: rr: FWM 776 0x00000308 - no destination available
[Sat Aug 31 22:35:14 2024] IPVS: rr: FWM 776 0x00000308 - no destination available
[Sat Aug 31 22:35:14 2024] IPVS: rr: FWM 776 0x00000308 - no destination available
[Sat Aug 31 22:35:14 2024] IPVS: rr: FWM 776 0x00000308 - no destination available
[Sat Aug 31 22:35:15 2024] br0: port 15(veth148) entered disabled state
[Sat Aug 31 22:35:15 2024] veth923586d: renamed from eth0
[Sat Aug 31 22:35:15 2024] br0: port 15(veth148) entered disabled state
[Sat Aug 31 22:35:15 2024] veth148 (unregistering): left allmulticast mode
[Sat Aug 31 22:35:15 2024] veth148 (unregistering): left promiscuous mode
[Sat Aug 31 22:35:15 2024] br0: port 15(veth148) entered disabled state
[Sat Aug 31 22:35:15 2024] br0: port 14(veth150) entered disabled state
[Sat Aug 31 22:35:15 2024] veth5d92f73: renamed from eth1
[Sat Aug 31 22:35:15 2024] docker_gwbridge: port 14(veth07cee69) entered disabled state
[Sat Aug 31 22:35:15 2024] veth4d4e731: renamed from eth2
[Sat Aug 31 22:35:15 2024] docker_gwbridge: port 14(veth07cee69) entered disabled state
[Sat Aug 31 22:35:15 2024] veth07cee69 (unregistering): left allmulticast mode
[Sat Aug 31 22:35:15 2024] veth07cee69 (unregistering): left promiscuous mode
[Sat Aug 31 22:35:15 2024] docker_gwbridge: port 14(veth07cee69) entered disabled state
[Sat Aug 31 22:35:15 2024] br0: port 14(veth150) entered disabled state
[Sat Aug 31 22:35:15 2024] veth150 (unregistering): left allmulticast mode
[Sat Aug 31 22:35:15 2024] veth150 (unregistering): left promiscuous mode
[Sat Aug 31 22:35:15 2024] br0: port 14(veth150) entered disabled state","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6LME3Z/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2528,https://api.github.com/repos/apache/kvrocks/issues/2528,kvrocks,2512352258,2528,Improve the implementation of fence between the replication and workers,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-09-08T12:00:37Z,2024-09-29T03:16:21Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

The replication thread needs to avoid using the DB pointer while restoring the DB.
It now will set `is_loading` to true to stop new commands to be executed and
wait for [WorkExclusivityGuard](https://github.com/apache/kvrocks/blob/unstable/src/server/server.cc#L1339) to confirm
existing commands have been done. But as @mapleFU mentioned in chat, it's an error-prone
way to do like that, maybe we need to improve this by introducing a better fence implementation.

### Solution

None

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2528/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2528,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6N7GQO,kvrocks,2381079566,2528,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-09-29T02:43:04Z,2024-09-29T02:43:04Z,"Hi @git-hulk ,

I'd like to follow up on this issue. Could this be assigned to me?

Could you please provide more details about the chat mentioned and I can have a more comprehensive understanding of the problem. 😊

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6N7GQO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2528,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6N7Gvf,kvrocks,2381081567,2528,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-29T02:50:50Z,2024-09-29T02:50:50Z,@LindaSummer Thanks for your interest. We can close this issue after PR https://github.com/apache/kvrocks/pull/2549 which uses the `try_lock` to avoid the long pending in replication thread. So it should be good to leave as it is for now.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6N7Gvf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2528,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6N7HD2,kvrocks,2381082870,2528,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-09-29T02:56:19Z,2024-09-29T02:56:19Z,"> @LindaSummer Thanks for your interest. We can close this issue after PR #2549 which uses the `try_lock` to avoid the long pending in replication thread. So it should be good to leave as it is for now.

Got it! Thanks very much for your detail information about the issue. 😊","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6N7HD2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2534,https://api.github.com/repos/apache/kvrocks/issues/2534,kvrocks,2525959113,2534,Support for Cuckoo filter data structure and commands,jonathanc-n,86070045,Jonathan Chen,,OPEN,2024-09-14T03:06:05Z,2024-11-30T02:54:34Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

One of the remaining data structures that are in redis that are not implemented in Kvrocks. 

Functionality: https://redis.io/docs/latest/develop/data-types/probabilistic/cuckoo-filter/ 
Commands: https://redis.io/docs/latest/commands/?group=cf 

Tracking
- [ ] CF.ADD command
- [ ] CF.ADDNX command
- [ ] CF.COUNT command
- [ ] CF.DEL command
- [ ] CF.EXISTS command
- [ ] CF.INFO command
- [ ] CF.INSERT command
- [ ] CF.INSERTNX command
- [ ] CF.LOADCHUNK command
- [ ] CF.MEXISTS command
- [ ] CF.RESERVE command 
- [ ] CF.SCANDUMP command

### Solution

I will create a design proposal through issue/discussion before submitting a PR.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2534/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2546,https://api.github.com/repos/apache/kvrocks/issues/2546,kvrocks,2537727843,2546,Inconsistent behavior when using RESTORE with dumped negative integers,fstd2,56252962,Genji,,CLOSED,2024-09-20T02:49:45Z,2024-09-21T09:05:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.9.0

### Minimal reproduce step

```
127.0.0.1:6666> set k -1
OK
127.0.0.1:6666> get k
""-1""
127.0.0.1:6666> dump k
""\x00\xc0\xff\x06\x00\x9a~\x16\xa4p]\xa1V""
127.0.0.1:6666> restore k1 0 ""\x00\xc0\xff\x06\x00\x9a~\x16\xa4p]\xa1V""
OK
127.0.0.1:6666> get k1
""255""
127.0.0.1:6666> get k
""-1""
127.0.0.1:6666> set k2 -2
OK
127.0.0.1:6666> get k2
""-2""
127.0.0.1:6666> dump k2
""\x00\xc0\xfe\x06\x00$FVjY\x0c\xb3\xa2""
127.0.0.1:6666> restore k22 0 ""\x00\xc0\xfe\x06\x00$FVjY\x0c\xb3\xa2""
OK
127.0.0.1:6666> get k2
""-2""
127.0.0.1:6666> get k22
""254""
```

### What did you expect to see?

 The value remains negative after RESTORE.

### What did you see instead?

when restoring dumped negative integers, the values are restored as positive numbers (255 for -1 and 254 for -2). 

### Anything Else?

Possibly a problem with the following code?

https://github.com/apache/kvrocks/blob/2a0c57ac7fc4499a210bc452884025a0010cb470/src/storage/rdb.cc#L158-L160

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2546/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2546,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6M09ju,kvrocks,2362693870,2546,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-20T03:38:41Z,2024-09-20T03:38:41Z,@fstd2 Good catch. Would you like to fix this?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6M09ju/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2546,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6M2Zid,kvrocks,2363070621,2546,NA,fstd2,56252962,Genji,,NA,2024-09-20T07:54:41Z,2024-09-20T07:54:41Z,"@git-hulk I'll try.

https://github.com/apache/kvrocks/pull/2547","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6M2Zid/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2550,https://api.github.com/repos/apache/kvrocks/issues/2550,kvrocks,2540197942,2550,Flaky test in HNSW index unit test,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-09-21T11:28:59Z,2024-09-27T10:35:32Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

See https://github.com/apache/kvrocks/actions/runs/10971334789/job/30466698610?pr=2538#step:15:173

### What did you expect to see?

CI passed

### What did you see instead?

CI failure

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2550/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2550,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NEYt-,kvrocks,2366737278,2550,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-09-22T11:29:38Z,2024-09-22T11:29:38Z,"Hi @git-hulk ,

I want to follow up this issue. 😊
Can it be assigned to me?

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NEYt-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2550,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NEaY_,kvrocks,2366744127,2550,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-22T11:43:43Z,2024-09-22T11:43:43Z,"@LindaSummer Sure, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NEaY_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2550,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Npaxv,kvrocks,2376445039,2550,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-09-26T09:35:28Z,2024-09-26T09:35:28Z,"Hi @Beihao-Zhou ,

Sorry to bother you.
Please correct me if my analysis is incorrect. 😊

The GitHub Action's log is `Layer: 4 Frequency: 458 Expected: 411.52266242457773`.
If I understand correctly, this expected value should be $(3{^-4}-3{^-5})*50000=411.5226337448559$.

Since we use a random seed from `random_device`.
https://github.com/apache/kvrocks/blob/f2bc224bc342f7e2b679cb2dc79d7a31067643ca/src/search/hnsw_indexer.cc#L180-L181

We can't reproduce the same generation sequence and in my knowledge the generation result may not be same as expected.

Could I use a fixed rand seed for unit test startup initialization to solve this issue?

I think it will improve the reproducing ability for test cases.

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Npaxv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2550,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Nqmpn,kvrocks,2376755815,2550,NA,Beihao-Zhou,68083940,Beihao Zhou,,NA,2024-09-26T12:07:35Z,2024-09-26T12:07:35Z,"Thanks for looking into the issue! @LindaSummer 
Yes sure, I think you can change the interface a bit to pass in the fixed seed. For the current unit tests, I just set a relatively low threshold so that in majority times it can pass even if it's randomized. 
Thanks again for fixing it!
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Nqmpn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2552,https://api.github.com/repos/apache/kvrocks/issues/2552,kvrocks,2541369975,2552,Inconsistent behavior with Redis in JSON.MSET command,VIVALXH,98531764,,,CLOSED,2024-09-23T00:58:42Z,2024-10-05T15:20:20Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

redis:
image: redislabs/rejson:latest

kvrocks:
image: apache/kvrocks:latest


### Minimal reproduce step

redis:
image: redislabs/rejson:latest
``` 
❯ redis-cli -h 192.168.1.72 -p 6369
192.168.1.72:6369> flushdb
OK
192.168.1.72:6369> JSON.SET doc $ '{""f1"":{""a1"":0},""f2"":{""a2"":0}}'
OK
192.168.1.72:6369> JSON.GET doc
""{\""f1\"":{\""a1\"":0},\""f2\"":{\""a2\"":0}}""
192.168.1.72:6369> JSON.MSET doc $.f1.a1 1 doc $.f2.a2 2
OK
192.168.1.72:6369> JSON.GET doc
""{\""f1\"":{\""a1\"":1},\""f2\"":{\""a2\"":2}}""
```

kvrocks:
image: apache/kvrocks:latest
``` 
❯ redis-cli -h 192.168.1.72 -p 6666
192.168.1.72:6666> flushdb
OK
192.168.1.72:6666> JSON.SET doc $ '{""f1"":{""a1"":0},""f2"":{""a2"":0}}'
OK
192.168.1.72:6666> JSON.GET doc
""{\""f1\"":{\""a1\"":0},\""f2\"":{\""a2\"":0}}""
192.168.1.72:6666> JSON.MSET doc $.f1.a1 1 doc $.f2.a2 2
OK
192.168.1.72:6666> JSON.GET doc
""{\""f1\"":{\""a1\"":0},\""f2\"":{\""a2\"":2}}""
``` 

### What did you expect to see?

 I hope that the behavior of JSON.MSET in KVROCKS is consistent with Redis.

### What did you see instead?

For Redis, the JSON.MSET command can modify multiple fields of the same key simultaneously, but for KVROCKS, only one field is successfully modified.

### Anything Else?
I found that in the code, JSON.MSET performs a query for each sub-command, resulting in a separate result in memory for each key if the keys are the same. Can it be modified so that there is only one copy of the key in memory and no repeated reads?
https://github.com/apache/kvrocks/blob/f2bc224bc342f7e2b679cb2dc79d7a31067643ca/src/types/redis_json.cc#L579C15-L579C17

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2552/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2552,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NFy5s,kvrocks,2367106668,2552,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-23T01:52:50Z,2024-09-23T01:52:50Z,"@VIVALXH Good catch, would you like to fix this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NFy5s/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2552,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NQWfi,kvrocks,2369873890,2552,NA,VIVALXH,98531764,,,NA,2024-09-24T00:44:55Z,2024-09-24T00:44:55Z,"Thank you for your response and for recognizing the issue. I'd be happy to try and fix this issue, and I plan to start working after my workday.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NQWfi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2552,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NQvnC,kvrocks,2369976770,2552,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-09-24T02:20:03Z,2024-09-24T02:20:03Z,@VIVALXH Thank you!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NQvnC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2552,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OwgJ1,kvrocks,2395079285,2552,NA,PragmaTwice,20042607,Twice,,NA,2024-10-05T14:38:19Z,2024-10-05T14:38:19Z,Fixed in #2579.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OwgJ1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2554,https://api.github.com/repos/apache/kvrocks/issues/2554,kvrocks,2541572475,2554,Optimize transactions for Multi/Exec commands,jonathanc-n,86070045,Jonathan Chen,,OPEN,2024-09-23T04:54:46Z,2024-09-23T05:22:30Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Issue referencing #2331 
Want to optimize concurrency when executing transactions with multiple commands.

### Solution

Possibly implement OCC or some other concurrency while not introducing too much complexity to the codebase.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2554/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2554,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGTCu,kvrocks,2367238318,2554,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-23T04:56:14Z,2024-09-23T04:56:14Z,@PokIsemaine You can mark this in your issue you posted,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGTCu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2554,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGYb1,kvrocks,2367260405,2554,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-09-23T05:22:29Z,2024-09-23T05:22:29Z,"Thanks for the reminder, I'm sorry for the slow progress due to my busy work lately.

My initial idea was to provide a snapshot-like mechanism based on the recently added `engine::Context` and apply it to Multi/Exec.
A single `engine::Context` will manage multiple commands and replace exclusive locks compared to normal commands.

![image](https://github.com/user-attachments/assets/fdd638aa-3e77-4ae1-8ab9-f25ed77fad4f)

Now to consider:
1. `engine::Context` is still experimental and unstable, do we want to support the new Multi/Exec pattern based on it now?
2. An implementation based on `engine::Context` may improve concurrency, but at the cost of not achieving a serializable level of isolation, which I'm not sure fits into Multi/Exec's semantics

The above is my current thoughts, if you have other better suggestions, please also welcome to discuss.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGYb1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2555,https://api.github.com/repos/apache/kvrocks/issues/2555,kvrocks,2541584019,2555,Tracking Issues: Add support for RediSearch Commands,jonathanc-n,86070045,Jonathan Chen,,OPEN,2024-09-23T05:05:52Z,2024-10-04T18:14:16Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

references the tracker issue: #2064 

### FT Commands Implementation Progress

- [x] **FT._LIST**: Returns a list of all existing indexes
- [ ] **FT.AGGREGATE**: Run a search query on an index and perform aggregate transformations on the results
- [ ] **FT.ALIASADD**: Adds an alias to the index
- [ ] **FT.ALIASDEL**: Deletes an alias from the index
- [ ] **FT.ALIASUPDATE**: Adds or updates an alias to the index
#2577 
- [ ] **FT.ALTER**: Adds a new field to the index
- [ ] **FT.CONFIG GET**: Retrieves runtime configuration options
- [ ] **FT.CONFIG SET**: Sets runtime configuration options
- [x] **FT.CREATE**: Creates an index with the given spec
- [ ] **FT.CURSOR DEL**: Deletes a cursor
- [ ] **FT.CURSOR READ**: Reads from a cursor
- [ ] **FT.DICTADD**: Adds terms to a dictionary
- [ ] **FT.DICTDEL**: Deletes terms from a dictionary
- [ ] **FT.DICTDUMP**: Dumps all terms in the given dictionary
- [x] **FT.DROPINDEX**: Deletes the index
- [x] **FT.EXPLAIN**: Returns the execution plan for a complex query
- [ ] **FT.EXPLAINCLI**: Returns the execution plan for a complex query
- [x] **FT.INFO**: Returns information and statistics on the index
- [ ] **FT.PROFILE**: Performs a `FT.SEARCH` or `FT.AGGREGATE` command and collects performance information
- [x] **FT.SEARCH**: Searches the index with a textual query, returning either documents or just ids
- [ ] **FT.SPELLCHECK**: Performs spelling correction on a query, returning suggestions for misspelled terms
- [ ] **FT.SYNDUMP**: Dumps the contents of a synonym group
- [ ] **FT.SYNUPDATE**: Creates or updates a synonym group with additional terms
- [x] **FT.TAGVALS**: Returns the distinct tags indexed in a Tag field
#2564 

FT.SEARCHSQL and FT.EXPLAINSQL has also been additionally implemented in Kvrocks


### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2555/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2555,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGeyt,kvrocks,2367286445,2555,NA,PragmaTwice,20042607,Twice,,NA,2024-09-23T05:52:12Z,2024-09-23T05:52:12Z,"Thank you for the tracking issue.

However, Kvrocks Search is a relatively large feature and there are so many underlying design and components behind just these commands.

So it's hard to say if a command-level tracking is useful.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGeyt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2555,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGfbo,kvrocks,2367289064,2555,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-09-23T05:55:06Z,2024-09-23T05:55:06Z,@PragmaTwice I guess when proposals/prs come up we can list the issues opened under the commands here. This can act as a tracker for people to know what has been done and is being worked on for Redisearch commands.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6NGfbo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2558,https://api.github.com/repos/apache/kvrocks/issues/2558,kvrocks,2553091922,2558,Tracking Issues: support t-digest data structure and commands,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,OPEN,2024-09-27T14:31:46Z,2025-01-20T00:28:31Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Redis Stack already supports this probabilistic data structure, and we can support it too.

- #2423 

This includes:

- [ ] Implementing t-digest algorithm interface with encoding and decoding
- [ ] Implementing command `TDIGEST.CREATE`
- [ ] Implementing command `TDIGEST.RESET`
- [ ] Implementing command `TDIGEST.ADD`
- [ ] Implementing command `TDIGEST.MERGE`
- [ ] Implementing command `TDIGEST.QUANTILE`
- [ ] Implementing command `TDIGEST.CDF`
- [ ] Implementing command `TDIGEST.RANK`
- [ ] Implementing command `TDIGEST.REVRANK`
- [ ] Implementing command `TDIGEST.BYRANK`
- [ ] Implementing command `TDIGEST.BYREVRANK`
- [ ] Implementing command `TDIGEST.TRIMMED_MEAN`
- [ ] Implementing command `TDIGEST.INFO`
- [ ] Implementing command `TDIGEST.MAX`
- [ ] Implementing command `TDIGEST.MIN`
- [ ] Documentation to website

### Solution

- #2542 

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2558/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2558,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6YO3fz,kvrocks,2554034163,2558,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-12-19T13:38:56Z,2024-12-19T13:38:56Z,"Hi @PragmaTwice ,

Sorry for delay. 

This issue's implementation is still in progress. 😊

I will try my best to implement and test the first fundamental commands in one month.

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6YO3fz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2558,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6bBldF,kvrocks,2600884037,2558,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2025-01-19T14:26:34Z,2025-01-19T14:26:34Z,"Hi @PragmaTwice ,

  Sorry that I may need some more time to finish the first PR of t-digest feature. 

  Major part of `create`, `add` and `quantile` are nearly finished and I'm now trying to do self-testing and add unit tests. 😊

  Here is my draft PR https://github.com/LindaSummer/kvrocks/pull/1 in my own repo.
  I'll try my best to add more tests and make it ready to be reviewed. 😊

Best Regards,
Edward
  
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6bBldF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2561,https://api.github.com/repos/apache/kvrocks/issues/2561,kvrocks,2557071015,2561,Add an experimental e-graph equality saturation framework for KQIR optimizer,PragmaTwice,20042607,Twice,,OPEN,2024-09-30T15:55:23Z,2024-11-30T02:54:35Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

As e-graphes are great tool for equality saturation in program optimizer to perform term rewriting, we can build them as a builtin framework for KQIR optimizer to generate better query plans.

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2561/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2562,https://api.github.com/repos/apache/kvrocks/issues/2562,kvrocks,2557153644,2562,Index Structure Transaction Supports,mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2024-09-30T16:34:46Z,2024-10-24T05:12:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

In databases, transactions is both for external and internal usages. External usages like explicit transactions ""BEGIN"" ""END"" with multiple operations. Internal usage is also a large part of transactions, basically, the usage would like:
1. Index creation. The index build might base on a ""data snapshot"", and after index is first build, the system might catch up incoming logs to build the index
2. Index maintainance. When insertion to data, the correspond index should being updated. This is also a ""internal transaction""
3. And internal structure change, syncing might all related to index etc...

### Solution

in Kvrocks, we also need Transaction for secondary index:
* `IndexUpdater`, `GlobalIndexer`, `IndexManager` might need gurantee transaction syntax
* Follow or force transaction in Index related module

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2562/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OE_i_,kvrocks,2383673535,2562,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-09-30T16:34:56Z,2024-09-30T16:34:56Z,cc @PragmaTwice @PokIsemaine ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OE_i_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6O2Tkb,kvrocks,2396600603,2562,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-10-07T11:00:34Z,2024-10-07T11:00:34Z,"I think the `engine::Context` for each command needs to be promoted to `Connection::ExecuteCommand`, and `ExecuteCommand` also accepts an `engine::Context` parameter. This allows multiple commands (or internal procedures) to use the same `engine::Context` while facilitating unified management","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6O2Tkb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2562,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6O2a3i,kvrocks,2396630498,2562,NA,PragmaTwice,20042607,Twice,,NA,2024-10-07T11:14:05Z,2024-10-07T11:14:05Z,"Refer to #2563.

Also same for scripting transaction optimization.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6O2a3i/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2563,https://api.github.com/repos/apache/kvrocks/issues/2563,kvrocks,2557190996,2563,Hoist key mutexes from every command impls to Connection::ExecuteCommand,PragmaTwice,20042607,Twice,,CLOSED,2024-09-30T16:54:34Z,2025-01-23T14:26:14Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

We can remove all key-level mutex locking operations in command implementation and handle them uniformly in `Connection::ExecuteCommand`. 

In this way, we can handle transaction support of scripts, index, etc. more easily.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2563/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2563,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QFHnd,kvrocks,2417261021,2563,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-10-16T15:59:33Z,2024-10-16T15:59:33Z,"I am trying to move the operation of the lock key to `ExecuteCommands`(not `ExecuteCommand`), because I realized that the index might also need to be locked. 

If `cmd_flags` contains the `kCmdWrite` flag, I will use `attributes->ForEachKeyRange` to get all the keys that need to be locked and lock these keys together with `MultiLockGuard`.

What I want to confirm is whether the keys obtained in this way do indeed correspond to those that need to be locked, and if there are any redundancies or omissions?

Furthermore, after some attempts, I found that the locking for certain methods depends on the method's parameters. Since the locks are now uniformly applied within `ExecuteCommands`, we may need to unlock them based on the inverse conditions.
```
rocksdb::Status String::MSet(engine::Context &ctx, const std::vector<StringPair> &pairs, uint64_t expire_ms,
                             bool lock) {
  // Data race, key string maybe overwrite by other key while didn't lock the keys here,
  // to improve the set performance
  std::optional<MultiLockGuard> guard;
  if (lock) {
    std::vector<std::string> lock_keys;
    lock_keys.reserve(pairs.size());
    for (const StringPair &pair : pairs) {
      std::string ns_key = AppendNamespacePrefix(pair.key);
      lock_keys.emplace_back(std::move(ns_key));
    }
    guard.emplace(storage_->GetLockManager(), lock_keys);
  }
  

rocksdb::Status ZSet::RangeByRank(engine::Context &ctx, const Slice &user_key, const RangeRankSpec &spec,
                                  MemberScores *mscores, uint64_t *removed_cnt) {
  if (mscores) mscores->clear();

  uint64_t cnt = 0;
  if (!removed_cnt) removed_cnt = &cnt;
  *removed_cnt = 0;

  std::string ns_key = AppendNamespacePrefix(user_key);

  std::optional<LockGuard> lock_guard;
  if (spec.with_deletion) lock_guard.emplace(storage_->GetLockManager(), ns_key);
```

This has raised a few questions that need to be considered:
* We do not pass the `LockGuard` object but instead unlock through the `LockManager`. When unlocking, there is no association between the two, which could lead to the `LockGuard` being unlocked multiple times due to repeated calls. Should we pass the `LockGuard` or establish some kind of association mechanism?
* Would directly unlocking individual or partial keys via the `LockManager` violate the requirements for the order of unlocking? I noticed that `MultiLockGuard` has a specific requirement for the order of unlocking
```
  ~MultiLockGuard() {
    // Lock with order `A B C` and unlock should be `C B A`
    for (auto iter = locks_.rbegin(); iter != locks_.rend(); ++iter) {
      (*iter)->unlock();
    }
  }
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QFHnd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2563,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QdPTM,kvrocks,2423583948,2563,NA,PragmaTwice,20042607,Twice,,NA,2024-10-19T05:42:41Z,2024-10-19T05:42:41Z,"For MSet, it's quite easy, the `lock` parameter is just for reuse MSet in other functions (e.g. maybe it's already locked in other methods so it shouldn't lock again while calling MSet), if we move them to ExecuteCommands we can just remove these parameters.

For RangeByRank, you can see that for commands like ZREMRANGEBYRANK, `with_deletion` is true, and for commands like ZRANGE, it's false. So it doesn't affect this part, we can just check if the command is with a ""write"" flag.

For some more complicated commands which is an ""optionally-write"" command, e.g. it can be ""write"" in some cases (when some arguments are provided by users), we should model it via a runtime flag generator mechanism [here](https://github.com/apache/kvrocks/blob/unstable/src/commands/commander.h#L171).
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QdPTM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2568,https://api.github.com/repos/apache/kvrocks/issues/2568,kvrocks,2560250666,2568,XINFO GROUPS fails to deduplicate; returns invalid `pending` ,nathanlo-hrt,151768548,Nathan,,CLOSED,2024-10-01T21:32:04Z,2024-10-04T16:13:37Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable commit b8cf118bbe56984c7112c0929402f79d81d8a0d7

### Minimal reproduce step

```
127.0.0.1:3847> FLUSHALL
OK
127.0.0.1:3847> XGROUP CREATE stream1 group 0 MKSTREAM
OK
127.0.0.1:3847> XGROUP CREATE stream2 group 0 MKSTREAM
OK
127.0.0.1:3847> XREADGROUP GROUP group consumer STREAMS stream1 stream2 0 0
(nil)
127.0.0.1:3847> XINFO GROUPS stream2
1)  1) ""name""
    2) ""group""
    3) ""consumers""
    4) (integer) 1
    5) ""pending""
    6) (integer) 0
    7) ""last-delivered-id""
    8) ""0-0""
    9) ""entries-read""
   10) (nil)
   11) ""lag""
   12) (integer) 0
2)  1) ""name""
    2) ""group""
    3) ""consumers""
    4) (integer) 0
    5) ""pending""
    6) (integer) 1727818077688
    7) ""last-delivered-id""
    8) ""1727818077688-0""
    9) ""entries-read""
   10) (integer) 0
   11) ""lag""
   12) (integer) 0
```

### What did you expect to see?

The following output comes from Redis:
```
127.0.0.1:6379> FLUSHALL
OK
127.0.0.1:6379> XGROUP CREATE stream1 group 0 MKSTREAM
OK
127.0.0.1:6379> XGROUP CREATE stream2 group 0 MKSTREAM
OK
127.0.0.1:6379> XREADGROUP GROUP group consumer STREAMS stream1 stream2 0 0
1) 1) ""stream1""
   2) (empty array)
2) 1) ""stream2""
   2) (empty array)
127.0.0.1:6379> XINFO GROUPS stream2
1) 1) ""name""
   2) ""group""
   3) ""consumers""
   4) (integer) 1
   5) ""pending""
   6) (integer) 0
   7) ""last-delivered-id""
   8) ""0-0""
```

There are a few notable differences here:
1. `XREADGROUP GROUP` returns `stream1` and `stream2` as empty arrays instead of returning `nil` for the entire request
2. `XINFO GROUPS stream2` doesn't return a duplicated consumer group
3. `XINFO GROUPS stream2` correctly returns `pending = 0`

### What did you see instead?

`XINFO GROUPS` returns duplicated consumer groups, and returns an incorrect value for `pending`. 

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2568/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2568,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OS1zH,kvrocks,2387303623,2568,NA,jonathanc-n,86070045,Jonathan Chen,,NA,2024-10-02T00:16:33Z,2024-10-02T00:16:33Z,"@Yangsx-1 I didn't deal with the second part of that bug, as it was a logical error in the code and I wasn't too familiar with the implementation of the stream functions. As for directions, I believe the conflict arises due to how consumer groups are managed for different streams. The problem persists when more streams are added.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OS1zH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2568,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OeX2m,kvrocks,2390326694,2568,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-10-03T01:36:40Z,2024-10-03T01:36:40Z,"> @Yangsx-1 I didn't deal with the second part of that bug, as it was a logical error in the code and I wasn't too familiar with the implementation of the stream functions. As for directions, I believe the conflict arises due to how consumer groups are managed for different streams. The problem persists when more streams are added.

Hi @jonathanc-n ,

I'd like to try to solve the rest part of this issue if you don't mind. 😊

Best Regards,
Edward
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6OeX2m/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2574,https://api.github.com/repos/apache/kvrocks/issues/2574,kvrocks,2563065242,2574,kvrocks2redis test keep failing in ArchLinux CI,PragmaTwice,20042607,Twice,,OPEN,2024-10-03T03:56:40Z,2024-10-03T03:59:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/actions/runs/11145141492/job/31005011435

### What did you expect to see?

-

### What did you see instead?

-

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2574/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2574,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Oe6iC,kvrocks,2390468738,2574,NA,PragmaTwice,20042607,Twice,,NA,2024-10-03T03:59:37Z,2024-10-03T03:59:37Z,"```
AssertionError: Data mismatch for key 'set_key_0': source data: '['set_value_0_1', 'set_value_0_2', 'set_value_0_3']' destination data: '['set_value_0_3', 'set_value_0_2', 'set_value_0_1']'
```
I think it is possible that a behavior change in a new version of Redis caused this reordering.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Oe6iC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2580,https://api.github.com/repos/apache/kvrocks/issues/2580,kvrocks,2567832311,2580,Kvrocks2redis support json type,Genuineh,38518057,Jerry,,OPEN,2024-10-05T10:30:09Z,2024-10-05T10:30:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Need sync json data from kvrocks to redis, and the kvrocks2redis seems to be similar to the master-slave replication data scheme. Does it also not support the synchronization of json data?

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2580/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2582,https://api.github.com/repos/apache/kvrocks/issues/2582,kvrocks,2568459011,2582,Move the rdb source files to a separate directory,PragmaTwice,20042607,Twice,,CLOSED,2024-10-06T04:39:20Z,2024-10-13T13:14:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

It's not so related to other source files of `src/storage`, maybe it can be `src/storage/rdb`.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2582/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2582,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PAMtj,kvrocks,2399193955,2582,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-10-08T08:27:47Z,2024-10-08T08:27:47Z,"Hi @PragmaTwice ,

I want to follow up on this issue.

Could it be assigned to me?😊

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PAMtj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2582,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PAQ0Y,kvrocks,2399210776,2582,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-08T08:34:44Z,2024-10-08T08:34:44Z,"@LindaSummer Assigned, thank you!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PAQ0Y/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2583,https://api.github.com/repos/apache/kvrocks/issues/2583,kvrocks,2568471520,2583,slot migrate not support json type,Genuineh,38518057,Jerry,,CLOSED,2024-10-06T05:24:53Z,2024-11-12T01:56:35Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

v2.9.0

### Minimal reproduce step

1、start slot migrate with json type data

### What did you expect to see?

slot migrate work well on json data type


### What did you see instead?

not working


### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2583/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2583,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PB32k,kvrocks,2399632804,2583,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-08T11:52:24Z,2024-10-08T11:52:24Z,@Genuineh will support this at the next release.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PB32k/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2583,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PEZnJ,kvrocks,2400295369,2583,NA,Genuineh,38518057,Jerry,,NA,2024-10-08T16:14:06Z,2024-10-08T16:14:06Z,"Thanks, #2580 seems can be completed together and when is the next release version expected to be launched? @git-hulk","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PEZnJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2583,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PEeLj,kvrocks,2400314083,2583,NA,PragmaTwice,20042607,Twice,,NA,2024-10-08T16:20:39Z,2024-10-08T16:20:39Z,"For slot migration, maybe you can try to set migrate-type to raw-key-value to make it work on any datatype.

https://github.com/apache/kvrocks/blob/f2c423348d7bb3b475d988559068ba8e2697d497/kvrocks.conf#L582

Although for kvrocks2redis we still need to do the supporting work.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PEeLj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2583,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PKMT-,kvrocks,2401813758,2583,NA,Genuineh,38518057,Jerry,,NA,2024-10-09T09:29:37Z,2024-10-09T09:29:37Z,"@PragmaTwice @git-hulk  Thanks, slot migration work well on raw-key-value mode. By the way, the company I am in has a strong intention to use a database with a kv structure based on rocksdb to replace databases such as mongodb to store a large amount of business data. However, formal businesses often have various analysis or other needs, and these needs are usually handled by some specialized databases. At present, kvrocks may only temporarily provide migration to redis, which is not very friendly for those with such business needs. The current structure has a not-low learning cost for expansion. If the community needs to do a large amount of adaptation for different databases, it is a huge project. If a standard scheme that users can quickly expand can be provided, these tasks don't need to be done and users' different needs can be met. For a simple scheme, for example, it can directly connect to raw-key-value. Users only need to rewrite a writer and a checker.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PKMT-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2583,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PMjhF,kvrocks,2402433093,2583,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-09T13:59:57Z,2024-10-09T13:59:57Z,@Genuineh I got your point. It would be great to add a layer to separate the change event and from the target writer.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PMjhF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2587,https://api.github.com/repos/apache/kvrocks/issues/2587,kvrocks,2573574710,2587,Add the supporting status of subcommands in the website,PragmaTwice,20042607,Twice,,OPEN,2024-10-08T15:41:39Z,2024-10-11T05:24:04Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://kvrocks.apache.org/docs/supported-commands

In this page users can check if a command is supported or not.

For CLUSTER and CLUSTERX we have a list to state the supporting status of every subcommands of these command,
but for many other commands we don't, e.g. CLIENT, SCRIPT...

We need to add subcommand supporting list for every command that have subcommands.

### Solution

For source code of the website, refer to https://github.com/apache/kvrocks-website.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2587/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PcKC-,kvrocks,2406523070,2587,NA,beingPro007,120173992,Gautam Rana,,NA,2024-10-11T04:16:13Z,2024-10-11T04:16:13Z,@PragmaTwice i would be happy if you assign this to me!!!,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PcKC-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PcPdE,kvrocks,2406545220,2587,NA,beingPro007,120173992,Gautam Rana,,NA,2024-10-11T04:44:14Z,2024-10-11T04:44:14Z,"@PragmaTwice 
**Could you clarify which specific commands currently lack subcommand listings?**

I've noticed that commands like CLUSTER and CLUSTERX have detailed subcommand lists, but other commands such as CLIENT and SCRIPT don't. To improve the consistency of the documentation, it would be helpful to know which commands require subcommand listings to be added. Could you provide a list of such commands so we can address this gap?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PcPdE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PcUKn,kvrocks,2406564519,2587,NA,PragmaTwice,20042607,Twice,,NA,2024-10-11T05:08:40Z,2024-10-11T05:08:40Z,"> @PragmaTwice **Could you clarify which specific commands currently lack subcommand listings?**
> 
> I've noticed that commands like CLUSTER and CLUSTERX have detailed subcommand lists, but other commands such as CLIENT and SCRIPT don't. To improve the consistency of the documentation, it would be helpful to know which commands require subcommand listings to be added. Could you provide a list of such commands so we can address this gap?

Hi, thank you for your interest and question.

You can check Redis documentation to know if a command has subcommands. All commands that have subcommands need to be listed.

BTW I recommend to be familiar with Redis before taking this task. Then you can easily identify what kind of commands are likely to have subcommands.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PcUKn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2587,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PcXM6,kvrocks,2406576954,2587,NA,beingPro007,120173992,Gautam Rana,,NA,2024-10-11T05:24:02Z,2024-10-11T05:24:02Z,"> > @PragmaTwice **Could you clarify which specific commands currently lack subcommand listings?**
> > 
> > I've noticed that commands like CLUSTER and CLUSTERX have detailed subcommand lists, but other commands such as CLIENT and SCRIPT don't. To improve the consistency of the documentation, it would be helpful to know which commands require subcommand listings to be added. Could you provide a list of such commands so we can address this gap?
> 
> Hi, thank you for your interest and question.
> 
> You can check Redis documentation to know if a command has subcommands. All commands that have subcommands need to be listed.
> 
> BTW I recommend to be familiar with Redis before taking this task. Then you can easily identify what kind of commands are likely to have subcommands.
> 

Ok let me first be familiar with redis. Thank you for your consideration ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PcXM6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/2594,kvrocks,2583700977,2594,proposal: refactor and enhance the write batch extractor,git-hulk,4987594,hulk,hulk.website@gmail.com,OPEN,2024-10-13T06:31:29Z,2024-10-14T01:24:09Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, the write batch extractor plays a key role in cluster migration and sync tool, and we would also like to introduce it to our change stream mechanism.

But it now might have those (potential)issues:

- missing enough test cases to
- unable to extend due to it bindings to the RESP format
- hard to maintenance due to implement all data types inside one function

This was also mentioned in issue #2583. To improve this situation, I would like to propose a new design for the write batch extractor.

### Solution

Introduce an intermediate representation format for the parsed format like `ChangeStreamEvent` and it will contain the following fields:


```cpp
struct ChangeStreamEvent {
        int16_t event_type;
	int16_t event;
	int16_t data_type;	
	std::string key;
        std::varint<std::string, double, std::vector<std::string>> payload;
};
```

- event_type: required, the type of this event and it will affect how we interpret the payload. Can be one of `VALUE | COMMADNS`
- event: required, it should be `ADD|DELETE|SET` if the event type is VALUE
- data_type: required, should be one of [STRING|HASH|SET|ZSET|LIST|STREAM|BITMAP|JSON]
- key: required, the key which was affected
- payload: arguments for the event

For example, it will emit an event after receiving the command `HSET my_hash f0 v0`} :

```C++
{       
        .event_type = ""VALUE""
	.event = ""SET""
	.data_type = ""HASH""
	.key = ""my_hash""
	.payload = [""f0"", ""v0""]
}
```

Then, the cluster migration/sync tool/poll updates can generate their own format based on the change stream event.

### TODOs

- Add support of `WriteBatchExtractor` to allow to transform into `ChangeStreamEvent`
- Add support RESP as the default output format  for `ChangeStreamEvent`
- Replace the `WriteBatchExtractor` output with the `ChangeStreamEvent`
- Add test cases for all data types.

What do you think? please don’t hesitate to leave comments if you have any thoughts or suggestions.

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2594/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlBj-,kvrocks,2408847614,2594,NA,PragmaTwice,20042607,Twice,,NA,2024-10-13T06:37:25Z,2024-10-13T06:37:25Z,"It seems related to the logical logging cc @mapleFU .

Could you elabrate the detailed design of the ""event"" field?

How to define a new event? e.g. for ZSET data type, could you list all event, for every write commands [here](https://kvrocks.apache.org/docs/supported-commands#zset-commands)?

Also the ""subkey"" is related to different encoding for each data type. If we store ""subkey"" here, it's too ""low level"" to be a recorder for structured semantics. Also could you list all ""subkey""s for all ZSET commands?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlBj-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlCaj,kvrocks,2408851107,2594,NA,PragmaTwice,20042607,Twice,,NA,2024-10-13T06:51:57Z,2024-10-13T06:51:57Z,"IMHO we should have a quite clear mind about the layered (or, leveled) semantics of execution of Kvrocks:

- High level: Redis commands
- Middle level: An **orthogonal**, but **structured** operations.
- Low level: RocksDB key-value read/writes

Today we talk about the middle level operations.

This middle layer needs to have a clear design to meet three goals:
- Orthogonal: Redis commands are obviously not orthogonal, but the middle layer must be orthogonal and can be ""lower"" from each Redis command to the middle layer.
- Structured: The middle layer operators must have clear semantics, retaining high-level data structure information, rather than fragmenting into rocksdb reads and writes.
- Integrated: The middle layer must have complete context information to avoid irreproducibility due to execution order changes.

As you can see, this is a complex task. I hope we can have a clearer design: for example, for each redis data type, what is the detailed design of its middle-layer operator?

Then, we can talk about implementations.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlCaj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlCpi,kvrocks,2408852066,2594,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-10-13T06:56:03Z,2024-10-13T06:56:03Z,"By the way, would it better to making rdb have the same structure? Or they're totally different?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlCpi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlJIV,kvrocks,2408878613,2594,NA,PragmaTwice,20042607,Twice,,NA,2024-10-13T08:17:43Z,2024-10-13T08:17:43Z,"> By the way, would it better to making rdb have the same structure? Or they're totally different?

rdb is for serialization of **data**, not for serialization of **execution**. so I don't think it's so suitable.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlJIV/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlODB,kvrocks,2408898753,2594,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-13T09:20:08Z,2024-10-13T09:20:08Z,"> How to define a new event? e.g. for ZSET data type, could you list all event, for every write commands [here](https://kvrocks.apache.org/docs/supported-commands#zset-commands)?

It generally contains: `ADD|DELETE|SET`. For example, the ZPOP command should generate a DELETE event.

> If we store ""subkey"" here, it's too ""low level"" to be a recorder for structured semantics. Also could you list all ""subkey""s for all ZSET commands?

What I mean by subkey here depends on the data type. For the Hash type, which we can see in the example, its subkey is the field `f0`. And for the ZSet type, its subkey should be its member.

I don't quite understand the meaning of `low level` here. Could you elaborate a bit about what you think?

> Structured: The middle layer operators must have clear semantics, retaining high-level data structure information, rather than fragmenting into rocksdb reads and writes.

For the change stream event is now mapping to what's command changed instead of rocksdb read/writes. So that's why we have `key` and `subkey`. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlODB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlOP8,kvrocks,2408899580,2594,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-13T09:22:22Z,2024-10-13T09:22:22Z,"> As you can see, this is a complex task. I hope we can have a clearer design: for example, for each redis data type, what is the detailed design of its middle-layer operator?

Yes, I agree we should take care of the design before starting the implementation. We can reach a consensus about the high-level proposal, and then go into the details if all of us feel good about the proposal.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlOP8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlSjE,kvrocks,2408917188,2594,NA,PragmaTwice,20042607,Twice,,NA,2024-10-13T10:15:48Z,2024-10-13T10:15:48Z,"> It generally contains: ADD|DELETE|SET. For example, the ZPOP command should generate a DELETE event.

How about commands like ZINTERSTORE, ZMPOP, ZPOPMIN? I'm still not sure if the current design is general enough. From my view it can easily become hard to model some complex scenarios.

e.g. for ZADD, the value should be member and score, but here you use just one `std::string value`, how to encode? and we need to decode to retrieve the score. IMHO it sounds a weird design. 

Also I think it's better to generalize it to logical logging instead of just for migrate/sync.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlSjE/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlbpS,kvrocks,2408954450,2594,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-13T12:10:18Z,2024-10-13T12:10:18Z,@PragmaTwice I have changed to value to the payload which is a union type.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlbpS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlgqJ,kvrocks,2408974985,2594,NA,PragmaTwice,20042607,Twice,,NA,2024-10-13T13:11:44Z,2024-10-13T13:11:44Z,"My current point is, if we cannot use it to model all operations, e.g. ZREMRANGE..., we'd better to keep the current (redis commands) form to make the impl unified and let user easily to understand.

But we can continuely focus and figure out a better design.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PlgqJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Plhy0,kvrocks,2408979636,2594,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-13T13:25:38Z,2024-10-13T13:25:38Z,"Got your point. I agree that using the commands would make it easy to have a unified way to implement the change logs. My concern is that need to rewrite many commands like HINCR/HINCRY to  HSET to simplify the downstream implementation.

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Plhy0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2594,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Pn7Zq,kvrocks,2409608810,2594,NA,Genuineh,38518057,Jerry,,NA,2024-10-14T01:24:08Z,2024-10-14T01:24:08Z,"I am not very familiar with the internal structure of kvrocks, nor am I very familiar with C++. However, I personally think that it is only necessary to connect to rocksdb itself. As for the need for RESP or which data structure in https://kvrocks.apache.org/community/data-structure-on-rocksdb needs to be connected may be related to the user's needs (simply put, when considering performance, one will be more inclined to directly connect to the data-structure-on-rocksdb or kv of rocksdb). Only the parsing method of business-class data structures needs to be provided for users to use. In addition, maybe kvrocks will have its own business protocol and data structures that redis does not have in the future. Directly connecting to the structure on rocksdb can avoid this risk. And even if one only wants to use it as redis, if this structure is fully compatible with redis, it can be freely converted through the RESP parser.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Pn7Zq/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2596,https://api.github.com/repos/apache/kvrocks/issues/2596,kvrocks,2584663993,2596,Using ReadLockGuard/WriteLockGuard in Context might block user requests,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-10-14T03:55:01Z,2024-10-14T16:48:14Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

take backup from production (bgsave), rsync to test server, rut it and wait with ugly script:

```
while true; do timeout 1 redis-cli -p 6666 info > /dev/null || date; sleep 0.5; printf . ; done
```


### What did you expect to see?

Compaction won't block user requests

### What did you see instead?

User requests are blocked due to waiting for DB lock.

### Anything Else?

```
root@kvrocks-novikov-0:/# gdb -batch -p 1 -ex ""thread apply all bt""
[New LWP 7]
[New LWP 8]
[New LWP 9]
[New LWP 10]
[New LWP 26]
[New LWP 27]
[New LWP 28]
[New LWP 29]
[New LWP 30]
[New LWP 31]
[New LWP 32]
[New LWP 33]
[New LWP 34]
[New LWP 35]
[New LWP 36]
[New LWP 37]
[New LWP 38]
[New LWP 39]
[New LWP 40]
[New LWP 41]
[New LWP 42]
[New LWP 43]
[New LWP 44]
[New LWP 45]
[New LWP 1172]
[Thread debugging using libthread_db enabled]
Using host libthread_db library ""/lib/aarch64-linux-gnu/libthread_db.so.1"".
0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=128, cancel=true, abstime=0x0, op=265, expected=44, futex_word=0xffff7ed36c90) at ./nptl/futex-internal.c:57
57	./nptl/futex-internal.c: No such file or directory.

Thread 26 (Thread 0xffff5e3f6bc0 (LWP 1172) ""rocksdb:low""):
#0  0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=0, cancel=true, abstime=0x0, op=393, expected=0, futex_word=0xffff5e3f5470) at ./nptl/futex-internal.c:57
#1  __futex_abstimed_wait_common (cancel=true, private=0, abstime=0x0, clockid=0, expected=0, futex_word=0xffff5e3f5470) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0xffff5e3f5470, expected=expected@entry=0, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:139
#3  0x0000ffffa7dae1d0 in __pthread_cond_wait_common (abstime=0x0, clockid=0, mutex=0xffffa7834f10, cond=0xffff5e3f5448) at ./nptl/pthread_cond_wait.c:503
#4  ___pthread_cond_wait (cond=0xffff5e3f5448, mutex=0xffffa7834f10) at ./nptl/pthread_cond_wait.c:618
#5  0x0000aaaad6580b80 in rocksdb::port::CondVar::Wait() ()
#6  0x0000aaaad6502e4c in rocksdb::GenericRateLimiter::Request(long, rocksdb::Env::IOPriority, rocksdb::Statistics*) ()
#7  0x0000aaaad6502168 in rocksdb::RateLimiter::RequestToken(unsigned long, unsigned long, rocksdb::Env::IOPriority, rocksdb::Statistics*, rocksdb::RateLimiter::OpType) ()
#8  0x0000aaaad63f9360 in rocksdb::WritableFileWriter::WriteBuffered(rocksdb::IOOptions const&, char const*, unsigned long) ()
#9  0x0000aaaad63fc144 in rocksdb::WritableFileWriter::Flush(rocksdb::IOOptions const&) ()
#10 0x0000aaaad63fe48c in rocksdb::WritableFileWriter::Append(rocksdb::IOOptions const&, rocksdb::Slice const&, unsigned int) ()
#11 0x0000aaaad663071c in rocksdb::BlockBasedTableBuilder::WriteMaybeCompressedBlock(rocksdb::Slice const&, rocksdb::CompressionType, rocksdb::BlockHandle*, rocksdb::BlockType, rocksdb::Slice const*) ()
#12 0x0000aaaad6631258 in rocksdb::BlockBasedTableBuilder::WriteBlock(rocksdb::Slice const&, rocksdb::BlockHandle*, rocksdb::BlockType) ()
#13 0x0000aaaad6632200 in rocksdb::BlockBasedTableBuilder::WriteBlock(rocksdb::BlockBuilder*, rocksdb::BlockHandle*, rocksdb::BlockType) ()
#14 0x0000aaaad6634548 in rocksdb::BlockBasedTableBuilder::Add(rocksdb::Slice const&, rocksdb::Slice const&) ()
#15 0x0000aaaad6206fec in rocksdb::CompactionOutputs::AddToOutput(rocksdb::CompactionIterator const&, std::function<rocksdb::Status (rocksdb::CompactionOutputs&)> const&, std::function<rocksdb::Status (rocksdb::CompactionOutputs&, rocksdb::Status const&, rocksdb::Slice const&)> const&) ()
#16 0x0000aaaad620a468 in rocksdb::SubcompactionState::AddToOutput(rocksdb::CompactionIterator const&, std::function<rocksdb::Status (rocksdb::CompactionOutputs&)> const&, std::function<rocksdb::Status (rocksdb::CompactionOutputs&, rocksdb::Status const&, rocksdb::Slice const&)> const&) ()
#17 0x0000aaaad61e1584 in rocksdb::CompactionJob::ProcessKeyValueCompaction(rocksdb::SubcompactionState*) ()
#18 0x0000aaaad69052dc in execute_native_thread_routine ()
#19 0x0000ffffa7daee30 in start_thread (arg=0xffffa7073f27) at ./nptl/pthread_create.c:442
#20 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 25 (Thread 0xffff7e326bc0 (LWP 45) ""compact-check""):
#0  0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=0, cancel=true, abstime=0x0, op=393, expected=0, futex_word=0xffffa79ad7a8) at ./nptl/futex-internal.c:57
#1  __futex_abstimed_wait_common (cancel=true, private=0, abstime=0x0, clockid=0, expected=0, futex_word=0xffffa79ad7a8) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0xffffa79ad7a8, expected=expected@entry=0, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:139
#3  0x0000ffffa7dae1d0 in __pthread_cond_wait_common (abstime=0x0, clockid=0, mutex=0xffffa79ad380, cond=0xffffa79ad780) at ./nptl/pthread_cond_wait.c:503
#4  ___pthread_cond_wait (cond=0xffffa79ad780, mutex=0xffffa79ad380) at ./nptl/pthread_cond_wait.c:618
#5  0x0000aaaad6580b80 in rocksdb::port::CondVar::Wait() ()
#6  0x0000aaaad640d38c in rocksdb::InstrumentedCondVar::Wait() ()
#7  0x0000aaaad6273b8c in rocksdb::DBImpl::RunManualCompaction(rocksdb::ColumnFamilyData*, int, int, rocksdb::CompactRangeOptions const&, rocksdb::Slice const*, rocksdb::Slice const*, bool, bool, unsigned long, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int*) ()
#8  0x0000aaaad6274628 in rocksdb::DBImpl::CompactRangeInternal(rocksdb::CompactRangeOptions const&, rocksdb::ColumnFamilyHandle*, rocksdb::Slice const*, rocksdb::Slice const*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) ()
#9  0x0000aaaad627519c in rocksdb::DBImpl::CompactRange(rocksdb::CompactRangeOptions const&, rocksdb::ColumnFamilyHandle*, rocksdb::Slice const*, rocksdb::Slice const*) ()
#10 0x0000aaaad60e4ccc in engine::Storage::Compact(rocksdb::ColumnFamilyHandle*, rocksdb::Slice const*, rocksdb::Slice const*) ()
#11 0x0000aaaad615f1b4 in CompactionChecker::PickCompactionFilesForCf(engine::ColumnFamilyConfig const&) [clone .isra.0] ()
#12 0x0000aaaad60bc730 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<Server::Start()::{lambda()#2}>(char const*, Server::Start()::{lambda()#2})::{lambda()#1}> > >::_M_run() [clone .lto_priv.0] ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fbe7) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 24 (Thread 0xffff7ed36bc0 (LWP 44) ""server-cron""):
#0  0x0000ffffa7de36b0 in __GI___clock_nanosleep (clock_id=<optimized out>, clock_id@entry=0, flags=flags@entry=0, req=0xffff7ed35d30, rem=0xffff7ed35d30) at ../sysdeps/unix/sysv/linux/clock_nanosleep.c:48
#1  0x0000ffffa7de861c in __GI___nanosleep (req=<optimized out>, rem=<optimized out>) at ../sysdeps/unix/sysv/linux/nanosleep.c:25
#2  0x0000aaaad60b2c04 in Server::cron() ()
#3  0x0000aaaad69052dc in execute_native_thread_routine ()
#4  0x0000ffffa7daee30 in start_thread (arg=0xffffe904fbe7) at ./nptl/pthread_create.c:442
#5  0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 23 (Thread 0xffff7f746bc0 (LWP 43) ""task-runner""):
#0  syscall () at ../sysdeps/unix/sysv/linux/aarch64/syscall.S:38
#1  0x0000aaaad618fab8 in tbb::detail::r1::wait_bounded_queue_monitor(tbb::detail::r1::concurrent_monitor*, unsigned long, long, tbb::detail::d1::delegate_base&) ()
#2  0x0000aaaad603ccd4 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<TaskRunner::Start()::{lambda()#1}>(char const*, TaskRunner::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#3  0x0000aaaad69052dc in execute_native_thread_routine ()
#4  0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb47) at ./nptl/pthread_create.c:442
#5  0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 22 (Thread 0xffff80156bc0 (LWP 42) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 21 (Thread 0xffff80b66bc0 (LWP 41) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 20 (Thread 0xffff81576bc0 (LWP 40) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 19 (Thread 0xffff81f86bc0 (LWP 39) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 18 (Thread 0xffff82996bc0 (LWP 38) ""worker""):
#0  0x0000ffffa7e17c74 in __GI_epoll_pwait (epfd=83, events=0xffffa79b6200, maxevents=32, timeout=9311, set=0x0) at ../sysdeps/unix/sysv/linux/epoll_pwait.c:40
#1  0x0000aaaad67344f8 in epoll_dispatch ()
#2  0x0000aaaad6728938 in event_base_loop.constprop ()
#3  0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#4  0x0000aaaad69052dc in execute_native_thread_routine ()
#5  0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#6  0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 17 (Thread 0xffff833a6bc0 (LWP 37) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 16 (Thread 0xffff83db6bc0 (LWP 36) ""worker""):
#0  0x0000ffffa7e17c74 in __GI_epoll_pwait (epfd=73, events=0xffffa79a4a00, maxevents=32, timeout=9311, set=0x0) at ../sysdeps/unix/sysv/linux/epoll_pwait.c:40
#1  0x0000aaaad67344f8 in epoll_dispatch ()
#2  0x0000aaaad6728938 in event_base_loop.constprop ()
#3  0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#4  0x0000aaaad69052dc in execute_native_thread_routine ()
#5  0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#6  0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 15 (Thread 0xffff847c6bc0 (LWP 35) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 14 (Thread 0xffff851d6bc0 (LWP 34) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 13 (Thread 0xffff85be6bc0 (LWP 33) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 12 (Thread 0xffff865f6bc0 (LWP 32) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 11 (Thread 0xffff9c7f6bc0 (LWP 31) ""worker""):
#0  0x0000ffffa7e17c74 in __GI_epoll_pwait (epfd=47, events=0xffffa789bc00, maxevents=32, timeout=9311, set=0x0) at ../sysdeps/unix/sysv/linux/epoll_pwait.c:40
#1  0x0000aaaad67344f8 in epoll_dispatch ()
#2  0x0000aaaad6728938 in event_base_loop.constprop ()
#3  0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#4  0x0000aaaad69052dc in execute_native_thread_routine ()
#5  0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#6  0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 10 (Thread 0xffff9d7f6bc0 (LWP 30) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 9 (Thread 0xffffa01f6bc0 (LWP 29) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=3, futex_word=0xffffe90502fc) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=3, futex_word=futex_word@entry=0xffffe90502fc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502fc, expected=expected@entry=3, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db5610 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:730
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 8 (Thread 0xffff983f6bc0 (LWP 28) ""worker""):
#0  __futex_abstimed_wait_common64 (private=0, cancel=false, abstime=0x0, op=393, expected=2, futex_word=0xffffe90502f8) at ./nptl/futex-internal.c:61
#1  __futex_abstimed_wait_common (cancel=false, private=private@entry=0, abstime=abstime@entry=0x0, clockid=clockid@entry=0, expected=expected@entry=2, futex_word=futex_word@entry=0xffffe90502f8) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait64 (futex_word=futex_word@entry=0xffffe90502f8, expected=expected@entry=2, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:128
#3  0x0000ffffa7db56e0 in __pthread_rwlock_wrlock_full64 (abstime=0x0, clockid=0, rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_common.c:829
#4  ___pthread_rwlock_wrlock (rwlock=0xffffe90502f0) at ./nptl/pthread_rwlock_wrlock.c:26
#5  0x0000aaaad5ef8b04 in engine::Context::~Context() [clone .lto_priv.0] ()
#6  0x0000aaaad60a388c in redis::Connection::ExecuteCommands(std::deque<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > >, std::allocator<std::vector<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >, std::allocator<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > > > > >*) ()
#7  0x0000aaaad5f33424 in EvbufCallbackBase<redis::Connection, true, true, true>::readCB(bufferevent*, void*) ()
#8  0x0000aaaad671d5d8 in bufferevent_run_deferred_callbacks_unlocked ()
#9  0x0000aaaad67269e0 in event_process_active_single_queue ()
#10 0x0000aaaad6726e80 in event_process_active ()
#11 0x0000aaaad67289bc in event_base_loop.constprop ()
#12 0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 7 (Thread 0xffff973f6bc0 (LWP 27) ""worker""):
#0  0x0000ffffa7e17c74 in __GI_epoll_pwait (epfd=27, events=0xffffa78e8600, maxevents=32, timeout=9311, set=0x0) at ../sysdeps/unix/sysv/linux/epoll_pwait.c:40
#1  0x0000aaaad67344f8 in epoll_dispatch ()
#2  0x0000aaaad6728938 in event_base_loop.constprop ()
#3  0x0000aaaad60bcb34 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<WorkerThread::Start()::{lambda()#1}>(char const*, WorkerThread::Start()::{lambda()#1})::{lambda()#1}> > >::_M_run() ()
#4  0x0000aaaad69052dc in execute_native_thread_routine ()
#5  0x0000ffffa7daee30 in start_thread (arg=0xffffe904fb17) at ./nptl/pthread_create.c:442
#6  0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 6 (Thread 0xffff963f6bc0 (LWP 26) ""kvrocks""):
#0  0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=0, cancel=true, abstime=0xffff963f6220, op=393, expected=0, futex_word=0xffffa782c578) at ./nptl/futex-internal.c:57
#1  __futex_abstimed_wait_common (cancel=true, private=0, abstime=0xffff963f6220, clockid=-1478838668, expected=0, futex_word=0xffffa782c578) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0xffffa782c578, expected=expected@entry=0, clockid=clockid@entry=0, abstime=abstime@entry=0xffff963f6220, private=private@entry=0) at ./nptl/futex-internal.c:139
#3  0x0000ffffa7dae4c0 in __pthread_cond_wait_common (abstime=0xffff963f6220, clockid=0, mutex=0xffffa782c508, cond=0xffffa782c550) at ./nptl/pthread_cond_wait.c:503
#4  ___pthread_cond_timedwait64 (cond=0xffffa782c550, mutex=0xffffa782c508, abstime=0xffff963f6220) at ./nptl/pthread_cond_wait.c:643
#5  0x0000aaaad6580c74 in rocksdb::port::CondVar::TimedWait(unsigned long) ()
#6  0x0000aaaad640d4e4 in rocksdb::InstrumentedCondVar::TimedWait(unsigned long) ()
#7  0x0000aaaad6326ac4 in rocksdb::Timer::Run() ()
#8  0x0000aaaad69052dc in execute_native_thread_routine ()
#9  0x0000ffffa7daee30 in start_thread (arg=0xffffe904d837) at ./nptl/pthread_create.c:442
#10 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 5 (Thread 0xffffa49f6bc0 (LWP 10) ""rocksdb:high""):
#0  0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=0, cancel=true, abstime=0x0, op=393, expected=0, futex_word=0xffffa78f93d8) at ./nptl/futex-internal.c:57
#1  __futex_abstimed_wait_common (cancel=true, private=0, abstime=0x0, clockid=0, expected=0, futex_word=0xffffa78f93d8) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0xffffa78f93d8, expected=expected@entry=0, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:139
#3  0x0000ffffa7dae1d0 in __pthread_cond_wait_common (abstime=0x0, clockid=0, mutex=0xffffa78f9380, cond=0xffffa78f93b0) at ./nptl/pthread_cond_wait.c:503
#4  ___pthread_cond_wait (cond=0xffffa78f93b0, mutex=0xffffa78f9380) at ./nptl/pthread_cond_wait.c:618
#5  0x0000aaaad665efd4 in rocksdb::ThreadPoolImpl::Impl::BGThread(unsigned long) ()
#6  0x0000aaaad665f36c in rocksdb::ThreadPoolImpl::Impl::BGThreadWrapper(void*) ()
#7  0x0000aaaad69052dc in execute_native_thread_routine ()
#8  0x0000ffffa7daee30 in start_thread (arg=0xffffe904c787) at ./nptl/pthread_create.c:442
#9  0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 4 (Thread 0xffffa59f6bc0 (LWP 9) ""rocksdb:high""):
#0  0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=0, cancel=true, abstime=0x0, op=393, expected=0, futex_word=0xffffa78f93d8) at ./nptl/futex-internal.c:57
#1  __futex_abstimed_wait_common (cancel=true, private=0, abstime=0x0, clockid=0, expected=0, futex_word=0xffffa78f93d8) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0xffffa78f93d8, expected=expected@entry=0, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:139
#3  0x0000ffffa7dae1d0 in __pthread_cond_wait_common (abstime=0x0, clockid=0, mutex=0xffffa78f9380, cond=0xffffa78f93b0) at ./nptl/pthread_cond_wait.c:503
#4  ___pthread_cond_wait (cond=0xffffa78f93b0, mutex=0xffffa78f9380) at ./nptl/pthread_cond_wait.c:618
#5  0x0000aaaad665efd4 in rocksdb::ThreadPoolImpl::Impl::BGThread(unsigned long) ()
#6  0x0000aaaad665f36c in rocksdb::ThreadPoolImpl::Impl::BGThreadWrapper(void*) ()
#7  0x0000aaaad69052dc in execute_native_thread_routine ()
#8  0x0000ffffa7daee30 in start_thread (arg=0xffffe904c787) at ./nptl/pthread_create.c:442
#9  0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 3 (Thread 0xffffa6666bc0 (LWP 8) ""rocksdb:high""):
#0  0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=0, cancel=true, abstime=0x0, op=393, expected=0, futex_word=0xffffa78f93dc) at ./nptl/futex-internal.c:57
#1  __futex_abstimed_wait_common (cancel=true, private=0, abstime=0x0, clockid=0, expected=0, futex_word=0xffffa78f93dc) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0xffffa78f93dc, expected=expected@entry=0, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:139
#3  0x0000ffffa7dae1d0 in __pthread_cond_wait_common (abstime=0x0, clockid=0, mutex=0xffffa78f9380, cond=0xffffa78f93b0) at ./nptl/pthread_cond_wait.c:503
#4  ___pthread_cond_wait (cond=0xffffa78f93b0, mutex=0xffffa78f9380) at ./nptl/pthread_cond_wait.c:618
#5  0x0000aaaad665efd4 in rocksdb::ThreadPoolImpl::Impl::BGThread(unsigned long) ()
#6  0x0000aaaad665f36c in rocksdb::ThreadPoolImpl::Impl::BGThreadWrapper(void*) ()
#7  0x0000aaaad69052dc in execute_native_thread_routine ()
#8  0x0000ffffa7daee30 in start_thread (arg=0xffffe904c787) at ./nptl/pthread_create.c:442
#9  0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 2 (Thread 0xffffa7076bc0 (LWP 7) ""rocksdb:low""):
#0  0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=0, cancel=true, abstime=0xffffa7073070, op=393, expected=0, futex_word=0xffffa7073120) at ./nptl/futex-internal.c:57
#1  __futex_abstimed_wait_common (cancel=true, private=0, abstime=0xffffa7073070, clockid=-1478838668, expected=0, futex_word=0xffffa7073120) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0xffffa7073120, expected=expected@entry=0, clockid=clockid@entry=0, abstime=abstime@entry=0xffffa7073070, private=private@entry=0) at ./nptl/futex-internal.c:139
#3  0x0000ffffa7dae4c0 in __pthread_cond_wait_common (abstime=0xffffa7073070, clockid=0, mutex=0xffffa7834f10, cond=0xffffa70730f8) at ./nptl/pthread_cond_wait.c:503
#4  ___pthread_cond_timedwait64 (cond=0xffffa70730f8, mutex=0xffffa7834f10, abstime=0xffffa7073070) at ./nptl/pthread_cond_wait.c:643
#5  0x0000aaaad6580c74 in rocksdb::port::CondVar::TimedWait(unsigned long) ()
#6  0x0000aaaad6502d90 in rocksdb::GenericRateLimiter::Request(long, rocksdb::Env::IOPriority, rocksdb::Statistics*) ()
#7  0x0000aaaad6502168 in rocksdb::RateLimiter::RequestToken(unsigned long, unsigned long, rocksdb::Env::IOPriority, rocksdb::Statistics*, rocksdb::RateLimiter::OpType) ()
#8  0x0000aaaad63f9360 in rocksdb::WritableFileWriter::WriteBuffered(rocksdb::IOOptions const&, char const*, unsigned long) ()
#9  0x0000aaaad63fc144 in rocksdb::WritableFileWriter::Flush(rocksdb::IOOptions const&) ()
#10 0x0000aaaad63fe48c in rocksdb::WritableFileWriter::Append(rocksdb::IOOptions const&, rocksdb::Slice const&, unsigned int) ()
#11 0x0000aaaad663071c in rocksdb::BlockBasedTableBuilder::WriteMaybeCompressedBlock(rocksdb::Slice const&, rocksdb::CompressionType, rocksdb::BlockHandle*, rocksdb::BlockType, rocksdb::Slice const*) ()
#12 0x0000aaaad6631258 in rocksdb::BlockBasedTableBuilder::WriteBlock(rocksdb::Slice const&, rocksdb::BlockHandle*, rocksdb::BlockType) ()
#13 0x0000aaaad6632200 in rocksdb::BlockBasedTableBuilder::WriteBlock(rocksdb::BlockBuilder*, rocksdb::BlockHandle*, rocksdb::BlockType) ()
#14 0x0000aaaad6634548 in rocksdb::BlockBasedTableBuilder::Add(rocksdb::Slice const&, rocksdb::Slice const&) ()
#15 0x0000aaaad6206fec in rocksdb::CompactionOutputs::AddToOutput(rocksdb::CompactionIterator const&, std::function<rocksdb::Status (rocksdb::CompactionOutputs&)> const&, std::function<rocksdb::Status (rocksdb::CompactionOutputs&, rocksdb::Status const&, rocksdb::Slice const&)> const&) ()
#16 0x0000aaaad620a468 in rocksdb::SubcompactionState::AddToOutput(rocksdb::CompactionIterator const&, std::function<rocksdb::Status (rocksdb::CompactionOutputs&)> const&, std::function<rocksdb::Status (rocksdb::CompactionOutputs&, rocksdb::Status const&, rocksdb::Slice const&)> const&) ()
#17 0x0000aaaad61e1584 in rocksdb::CompactionJob::ProcessKeyValueCompaction(rocksdb::SubcompactionState*) ()
#18 0x0000aaaad61e4558 in rocksdb::CompactionJob::Run() ()
#19 0x0000aaaad6278400 in rocksdb::DBImpl::BackgroundCompaction(bool*, rocksdb::JobContext*, rocksdb::LogBuffer*, rocksdb::DBImpl::PrepickedCompaction*, rocksdb::Env::Priority) ()
#20 0x0000aaaad62799f8 in rocksdb::DBImpl::BackgroundCallCompaction(rocksdb::DBImpl::PrepickedCompaction*, rocksdb::Env::Priority) ()
#21 0x0000aaaad627a3b0 in rocksdb::DBImpl::BGWorkCompaction(void*) ()
#22 0x0000aaaad665f178 in rocksdb::ThreadPoolImpl::Impl::BGThread(unsigned long) ()
#23 0x0000aaaad665f36c in rocksdb::ThreadPoolImpl::Impl::BGThreadWrapper(void*) ()
#24 0x0000aaaad69052dc in execute_native_thread_routine ()
#25 0x0000ffffa7daee30 in start_thread (arg=0xffffe904c787) at ./nptl/pthread_create.c:442
#26 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79

Thread 1 (Thread 0xffffa84c1020 (LWP 1) ""kvrocks""):
#0  0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=128, cancel=true, abstime=0x0, op=265, expected=44, futex_word=0xffff7ed36c90) at ./nptl/futex-internal.c:57
#1  __futex_abstimed_wait_common (cancel=true, private=128, abstime=0x0, clockid=0, expected=44, futex_word=0xffff7ed36c90) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0xffff7ed36c90, expected=44, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=128) at ./nptl/futex-internal.c:139
#3  0x0000ffffa7db0738 in __pthread_clockjoin_ex (threadid=281472809528256, thread_return=0x0, clockid=0, abstime=0x0, block=<optimized out>) at ./nptl/pthread_join_common.c:102
#4  0x0000aaaad6905380 in std::thread::join() ()
#5  0x0000aaaad614b4c8 in Status util::ThreadOperationImpl<&std::thread::join>(std::thread&, char const*) [clone .constprop.0] ()
#6  0x0000aaaad60a4c98 in Server::Join() ()
#7  0x0000aaaad5e3c8ac in main ()
[Inferior 1 (process 1) detached]
```

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2596/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2596,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PpBjh,kvrocks,2409896161,2596,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-14T03:58:34Z,2024-10-14T03:58:34Z,"The DB lock was used to protect the db pointer from being freed while using. All threads currently can guarantee that, so I think we should not use the db lock in Context construction and destruction. cc @PokIsemaine 

Can refer to the stack:

```
Thread 25 (Thread 0xffff7e326bc0 (LWP 45) ""compact-check""):
#0  0x0000ffffa7dab694 in __futex_abstimed_wait_common64 (private=0, cancel=true, abstime=0x0, op=393, expected=0, futex_word=0xffffa79ad7a8) at ./nptl/futex-internal.c:57
#1  __futex_abstimed_wait_common (cancel=true, private=0, abstime=0x0, clockid=0, expected=0, futex_word=0xffffa79ad7a8) at ./nptl/futex-internal.c:87
#2  __GI___futex_abstimed_wait_cancelable64 (futex_word=futex_word@entry=0xffffa79ad7a8, expected=expected@entry=0, clockid=clockid@entry=0, abstime=abstime@entry=0x0, private=private@entry=0) at ./nptl/futex-internal.c:139
#3  0x0000ffffa7dae1d0 in __pthread_cond_wait_common (abstime=0x0, clockid=0, mutex=0xffffa79ad380, cond=0xffffa79ad780) at ./nptl/pthread_cond_wait.c:503
#4  ___pthread_cond_wait (cond=0xffffa79ad780, mutex=0xffffa79ad380) at ./nptl/pthread_cond_wait.c:618
#5  0x0000aaaad6580b80 in rocksdb::port::CondVar::Wait() ()
#6  0x0000aaaad640d38c in rocksdb::InstrumentedCondVar::Wait() ()
#7  0x0000aaaad6273b8c in rocksdb::DBImpl::RunManualCompaction(rocksdb::ColumnFamilyData*, int, int, rocksdb::CompactRangeOptions const&, rocksdb::Slice const*, rocksdb::Slice const*, bool, bool, unsigned long, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, int*) ()
#8  0x0000aaaad6274628 in rocksdb::DBImpl::CompactRangeInternal(rocksdb::CompactRangeOptions const&, rocksdb::ColumnFamilyHandle*, rocksdb::Slice const*, rocksdb::Slice const*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) ()
#9  0x0000aaaad627519c in rocksdb::DBImpl::CompactRange(rocksdb::CompactRangeOptions const&, rocksdb::ColumnFamilyHandle*, rocksdb::Slice const*, rocksdb::Slice const*) ()
#10 0x0000aaaad60e4ccc in engine::Storage::Compact(rocksdb::ColumnFamilyHandle*, rocksdb::Slice const*, rocksdb::Slice const*) ()
#11 0x0000aaaad615f1b4 in CompactionChecker::PickCompactionFilesForCf(engine::ColumnFamilyConfig const&) [clone .isra.0] ()
#12 0x0000aaaad60bc730 in std::thread::_State_impl<std::thread::_Invoker<std::tuple<util::CreateThread<Server::Start()::{lambda()#2}>(char const*, Server::Start()::{lambda()#2})::{lambda()#1}> > >::_M_run() [clone .lto_priv.0] ()
#13 0x0000aaaad69052dc in execute_native_thread_routine ()
#14 0x0000ffffa7daee30 in start_thread (arg=0xffffe904fbe7) at ./nptl/pthread_create.c:442
#15 0x0000ffffa7e17adc in thread_start () at ../sysdeps/unix/sysv/linux/aarch64/clone.S:79
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PpBjh/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2596,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PpB0w,kvrocks,2409897264,2596,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-14T04:00:09Z,2024-10-14T04:00:09Z,"Related PR: https://github.com/apache/kvrocks/pull/2332
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PpB0w/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2596,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PpRco,kvrocks,2409961256,2596,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-10-14T05:14:07Z,2024-10-14T05:14:07Z,"Was it permanently blocked, or was it just a long blocking time? 

I added the two locks because there was data race on the storage during testing.

Since it has been quite a while, I have forgotten the exact location. If it's convenient for you, could you try removing them and running the tests with data race checks(TSAN)?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PpRco/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2596,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PpVfR,kvrocks,2409977809,2596,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-14T05:29:56Z,2024-10-14T05:29:56Z,"@PokIsemaine Sure, you can take a look at #2597.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6PpVfR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2601,https://api.github.com/repos/apache/kvrocks/issues/2601,kvrocks,2587504900,2601,rocksdb::CompactRangeOptions.change_level is not compatible with level_compaction_dynamic_level_bytes,hotpxl,2174815,Yutian Li,hotpxless@gmail.com,OPEN,2024-10-15T03:11:31Z,2024-11-30T02:53:47Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

6b23c5ac2cf17558d167a3305c8f10ecb944637f

### Minimal reproduce step

Default configuration but with `stats_dump_period_sec` set (so you can see compaction stats) , `redis-cli set a b`, `redis-cli compact`.

### What did you expect to see?

Because of how `level_compaction_dynamic_level_bytes` works, there should be only 1 compaction to L6 (the default bottom-most layer)

### What did you see instead?

1 compaction on each layer and 2 compactions to L6

### Anything Else?

I instrumented rocksdb code and this is because `rocksdb::CompactRangeOptions.change_level` is not compatible with `level_compaction_dynamic_level_bytes`.

When `level_compaction_dynamic_level_bytes` is set, `set a b` and `compact` will not compact to L1, it'll jump directly to the last layer (L6). And when `change_level` is set, it then moves this SST file from L6 back to L1.

Now when another periodic compaction comes along, it tries to move this file from L1->L2, L2->L3, ... This is why every layer has 1 compaction and the last layer has 2 compactions.

If you run a manual compaction at this time, since `change_level` is set, it'll move the SST file to L1 again, resulting in the same churn happening.

Obviously this is quite efficiently since these 2 options are trying to undo each other's work..

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2601/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2602,https://api.github.com/repos/apache/kvrocks/issues/2602,kvrocks,2591058777,2602,Make configurable compression for L0-L1,paragor,31911894,Egor,,CLOSED,2024-10-16T08:21:18Z,2024-10-21T16:41:13Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I have high write rate, and data have good compression (coef 8-10). But in kvrocks - L0 and L1 dont compress data. And i have a very big write/read rate for compaction L0-L1.
may be move to config this logic?

```
    // For the first two levels, it may contain the frequently accessed data,
    // so it'd be better to use uncompressed data to save the CPU.
    std::string compression_levels = ""kNoCompression:kNoCompression"";
    auto db = srv->storage->GetDB();
    for (size_t i = 2; i < db->GetOptions().compression_per_level.size(); i++) {
      compression_levels += "":"";
      compression_levels += compression_option;
    }
    return srv->storage->SetOptionForAllColumnFamilies(""compression_per_level"", compression_levels);
  };
```

### Solution

add setting in config
```
 rocksdb.enable_compression_for_l0_and_l1 yes/NO
 ``` 

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2602/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2602,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QAw8t,kvrocks,2416119597,2602,NA,PragmaTwice,20042607,Twice,,NA,2024-10-16T08:42:53Z,2024-10-16T08:42:53Z,"Maybe we can have an option called `rocksdb.nocompression_level`, 
and `rocksdb.nocompression_level n` means that the first `n` levels don't need to compress.

The default value can be 2.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QAw8t/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2602,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QA0nt,kvrocks,2416134637,2602,NA,paragor,31911894,Egor,,NA,2024-10-16T08:49:27Z,2024-10-16T08:49:27Z,"```
    int compression_level;
    int nocompression_level;
```
funny naming :)

i think about something more verbose like
```
nocompression_for_first_levels
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QA0nt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2602,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QBARL,kvrocks,2416182347,2602,NA,PragmaTwice,20042607,Twice,,NA,2024-10-16T09:07:20Z,2024-10-16T09:07:20Z,"Good to me.

Also we can/should explain to users in comments.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QBARL/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2602,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QBD4C,kvrocks,2416197122,2602,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2024-10-16T09:10:55Z,2024-10-16T09:10:55Z,"Good to me too, we also have an heavy write rate system","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QBD4C/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/2604,kvrocks,2593404294,2604,Enable rocksdb.enable_blob_files will cause blob files leak,sryanyuan,6258142,sryan yuan,sryanyuan@gmail.com,CLOSED,2024-10-17T01:57:23Z,2024-10-21T02:53:54Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

centos 7.9/5.10.109-1.el7.x86_64，kvrocks 2.10.0

### Minimal reproduce step

Enabling rocksdb.enable_blob_files and continuing writing data with ttl will cause disk full finally. By checking the file descriptors of the kvrocks process, we can determine that many blob files have been deleted but are still open by kvrocks.

### What did you expect to see?

disk usage stable

### What did you see instead?

disk full finally

### Anything Else?

We checked the issue list of rocksdb, the [issue](https://github.com/facebook/rocksdb/issues/13066) may be related to this. The recent release version 2.10.0, which upgraded rocksdb to 9.6.1, may pose a potential risk for users of old versions who have the option rocksdb.enable_blob_files enabled.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2604/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QJskN,kvrocks,2418460941,2604,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-17T04:13:56Z,2024-10-17T04:13:56Z,@sryanyuan Thanks for your information. Will keep an eye on this issue and apply it in Kvrocks ASAP.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QJskN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QfsaA,kvrocks,2424227456,2604,NA,ilyaevseev,3008348,Ilya Evseev,ilya.evseev@gmail.com,NA,2024-10-19T21:44:03Z,2024-10-19T21:44:03Z,"The same problem with kvrocks 2.10.0 and rocksdb.enable_blob_files=yes:

```
# lsof -n > /run/lsof.log 2>/dev/null
# egrep -c 'kvrocks.*deleted' /run/lsof.log 
3060

# egrep '^(COMMAND|kvrocks.*deleted)' /run/lsof.log | less
COMMAND       PID     TID TASKCMD              USER   FD      TYPE             DEVICE  SIZE/OFF       NODE NAME
kvrocks    415416                               999    7r      REG              259,1 123878620    2627813 /var/lib/kvrocks/db/000065.blob (deleted)
kvrocks    415416                               999    8r      REG              259,1 123878620    2627787 /var/lib/kvrocks/db/000051.blob (deleted)
kvrocks    415416                               999   50r      REG              259,1 235657931    2627945 /var/lib/kvrocks/db/000189.blob (deleted)
kvrocks    415416                               999   57r      REG              259,1 181792793    2627901 /var/lib/kvrocks/db/000738.blob (deleted)
...

# df -h .
Filesystem      Size  Used Avail Use% Mounted on
/dev/sdb        33G   33G   55M 100% /mnt/data

# docker restart kvrocks
kvrocks

# df -h .
Filesystem      Size  Used Avail Use% Mounted on
/dev/sdb        33G   13G   21G  38% /mnt/data
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QfsaA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Qge5T,kvrocks,2424434259,2604,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-20T02:31:50Z,2024-10-20T02:31:50Z,@ilyaevseev Thanks for your investigation. We would like to have a patch release in a few days. Should we revert the RocksDB to 8.11.4 in this patch release as well? @apache/kvrocks-committers ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Qge5T/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QgrY-,kvrocks,2424485438,2604,NA,PragmaTwice,20042607,Twice,,NA,2024-10-20T03:12:51Z,2024-10-20T03:12:51Z,Yeah I think we can use rocksdb 8.11 in 2.10.1.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QgrY-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QgrcW,kvrocks,2424485654,2604,NA,PragmaTwice,20042607,Twice,,NA,2024-10-20T03:13:43Z,2024-10-20T03:13:43Z,"Also in the future maybe we can expose `uncache_aggressiveness` to users, according to https://github.com/facebook/rocksdb/commit/b34cef57b798520791312f2f40681c4d12d5d33c.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QgrcW/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QguIH,kvrocks,2424496647,2604,NA,ilyaevseev,3008348,Ilya Evseev,ilya.evseev@gmail.com,NA,2024-10-20T03:28:00Z,2024-10-20T03:28:00Z,"> Yeah I think we can use rocksdb 8.11 in 2.10.1.

Is RocksDB 8.11 compatible with 9.x by data formats?    
I.e., should we recreate our databases from scratch after Kvrocks upgrade from 2.10 to 2.10.1 ?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QguIH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QhFxC,kvrocks,2424593474,2604,NA,PragmaTwice,20042607,Twice,,NA,2024-10-20T04:53:10Z,2024-10-20T04:53:10Z,"> > Yeah I think we can use rocksdb 8.11 in 2.10.1.
> 
> Is RocksDB 8.11 compatible with 9.x by data formats? I.e., should we recreate our databases from scratch after Kvrocks upgrade from 2.10 to 2.10.1 ?

From [here](https://github.com/facebook/rocksdb/wiki/RocksDB-Compatibility-Between-Different-Releases#format-compatibility) for forward compatibility it said that:
> an older release of RocksDB should be able to open DB generated by releases at least several minor versions higher, if no new features are explicitly enabled by users which are not supported in older versions

So I think we can do some experiments before we do the downgrade. cc @git-hulk 
Also, we can choose v9.3.1 which didn't introduce this issue.

I prefer v9.3.1 than v8.11 since v8 seems a far big downgrade.

cc @mapleFU ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QhFxC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QhS6K,kvrocks,2424647306,2604,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-20T06:30:25Z,2024-10-20T06:30:25Z,@PragmaTwice Downgrade to 9.3.1 is also good to me since this issue was first introduced in RocksDB 9.4.0,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QhS6K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2604,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QkXpK,kvrocks,2425453130,2604,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-10-21T02:53:53Z,2024-10-21T02:53:53Z,"> I prefer v9.3.1 than v8.11 since v8 seems a far big downgrade.

I agree downgrade to 9.3.1","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QkXpK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2606,https://api.github.com/repos/apache/kvrocks/issues/2606,kvrocks,2594044987,2606,Add abilty to compress WAL,paragor,31911894,Egor,,CLOSED,2024-10-17T08:43:16Z,2024-10-18T06:06:37Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

I have heavy write, and instance have a lot of free cpu, but have not enough disk throughput. So i think i need able to configure WAL compression. 

### Solution

https://github.com/facebook/rocksdb/wiki/Write-Ahead-Log-(WAL)
https://github.com/facebook/rocksdb/wiki/WAL-Compression
https://github.com/facebook/rocksdb/blob/787730c859d83fd82b3087ae2edf189f8f2e698f/include/rocksdb/options.h#L1365

Currently supported only ZSTD.
It is not dynamic option - can be set only on open DB.

rocksdb already supported wal compression, just need to add option `rocksdb.wal_compression` Yes/No.

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2606/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2610,https://api.github.com/repos/apache/kvrocks/issues/2610,kvrocks,2598217502,2610,SRANDMEMBER returns a list from kvrocks when it returns a string on redis,Rafiot,248875,Raphaël Vinot,,OPEN,2024-10-18T19:14:43Z,2024-10-20T02:48:06Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

Ubuntu 24.04 / kvrocks 2.10 / valkey 8.0

### Minimal reproduce step

```python

from redis import Redis
r.sadd('foo', 'bar')
r.srandmember('foo')

# returns [b'bar'] from kvrocks, b'bar' from valkey
```

### What did you expect to see?

The same output against both backends.

### What did you see instead?

`[b'bar']` from kvrocks, `b'bar'` from valkey

### Anything Else?

I cannot say who's wrong, it's just super confusing to have two different responses.

The solution I'll go for to have a consistent output is to pass `r.srandmember('foo', 1)` which returns a list against both backends.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2610/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2610,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QcnzF,kvrocks,2423422149,2610,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-19T01:10:10Z,2024-10-19T01:10:10Z,@Rafiot Thanks for your report. Redis did have a different reply behavior when count is 1.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QcnzF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2610,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QeBOf,kvrocks,2423788447,2610,NA,Rafiot,248875,Raphaël Vinot,,NA,2024-10-19T11:56:48Z,2024-10-19T11:56:48Z,"yep. I don't know if it is something to change or not, I don't see a good solution to that, as you will either break existing kvrocks-only tools in a very weird way, or keep the difference. 

It would probably make sense to document the difference somewhere so people don't spend hours debugging it, and make sure to always pass the count parameter.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QeBOf/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2610,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QeBb3,kvrocks,2423789303,2610,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-10-19T12:00:31Z,2024-10-19T12:00:31Z,I'm ok with changing this to same as redis 🤔,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QeBb3/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2610,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QetDo,kvrocks,2423967976,2610,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-19T15:30:26Z,2024-10-19T15:30:26Z,"Yes, we can fix it to align with Redis.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6QetDo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2610,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Qewx6,kvrocks,2423983226,2610,NA,Rafiot,248875,Raphaël Vinot,,NA,2024-10-19T15:36:41Z,2024-10-19T15:36:41Z,"That's an option, but it will break existing codebases:

```python
from redis import Redis
r.sadd('foo', 'bar')
if member := r.srandmember('foo'):
    print(member[0])
    # do something with member[0]
```

That call was getting the one element from the list and will now get the first char of the response, and it won't even fail.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Qewx6/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2610,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Qglsk,kvrocks,2424462116,2610,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-20T02:48:05Z,2024-10-20T02:48:05Z,@Rafiot Good point. It'd be better to document explicitly instead of silently breaking old behaviors in some programming languages. And always return the array format makes sense whether the count is bigger than 1 or not.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Qglsk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2612,https://api.github.com/repos/apache/kvrocks/issues/2612,kvrocks,2598792886,2612,Transaction support for scripting,PragmaTwice,20042607,Twice,,CLOSED,2024-10-19T06:06:34Z,2025-01-25T02:01:19Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

- Pass context into scripting and use one context for all commands in one script
- Key locking improvement (#2563)
- Remove global lock for EVAL command


### Solution

--

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2612/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2612,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RGK7d,kvrocks,2434313949,2612,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-10-24T05:10:44Z,2024-10-24T05:10:44Z,"We might be able to use a script flag like `no-atomic` (or maybe the flag name isn't appropriate, we can discuss it further) to allow the user to choose to execute the script completely exclusively or allow the script using `Context + Key Lock`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RGK7d/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2612,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SPHQZ,kvrocks,2453435417,2612,NA,PragmaTwice,20042607,Twice,,NA,2024-11-03T13:51:11Z,2024-11-03T13:51:11Z,"Ahhh since the lua runtime is not thread-safe, we should remove the global lua context (inside Server) and utilize the worker-local lua runtimes (inside every Worker) to execute lua functions.

AS IS:
```
global lua runtime: EVAL, FCALL

worker-local lua runtimes: EVAL_RO, FCALL_RO
```

TO BE:
```
worker-local lua runtimes: EVAL, EVAL_RO, FCALL, FCALL_RO
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SPHQZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2613,https://api.github.com/repos/apache/kvrocks/issues/2613,kvrocks,2600122660,2613,Add devcontainer config for Kvrocks,PragmaTwice,20042607,Twice,,CLOSED,2024-10-20T07:25:46Z,2024-11-02T14:30:11Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

[Development Containers](https://containers.dev/) allows developers to use a container as a full-featured development environment. We can add a default container config for Kvrocks so that developers don't need to worry about enviornment problems.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2613/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2613,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SApdg,kvrocks,2449643360,2613,NA,what-is-me,70659394,Leo.Cai,whatisme@outlook.jp,NA,2024-10-31T11:37:19Z,2024-10-31T11:37:19Z,Can I have a try?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SApdg/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2613,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SBDoZ,kvrocks,2449750553,2613,NA,what-is-me,70659394,Leo.Cai,whatisme@outlook.jp,NA,2024-10-31T12:39:51Z,2024-10-31T12:39:51Z,Which base image should the devcontainer base on? debian:bookworm-slim or ubuntu:latest or any other version?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SBDoZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2613,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SBJc1,kvrocks,2449774389,2613,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-31T12:52:58Z,2024-10-31T12:52:58Z,"@what-is-me Assigned, thank you!

> Which base image should the devcontainer base on? debian:bookworm-slim or ubuntu:latest or any other version?

I prefer using `ubuntu:latest`. @PragmaTwice What do you think?

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SBJc1/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2617,https://api.github.com/repos/apache/kvrocks/issues/2617,kvrocks,2604450647,2617,[CI][Flacky] TestList/BLMPOP_test_blocked_served_bothKey_FIFO_countOver_LEFT failed,mapleFU,24351052,mwish,maplewish117@gmail.com,OPEN,2024-10-22T06:53:32Z,2024-10-31T10:10:53Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

```
--- FAIL: TestList (90.51s)
    --- FAIL: TestList/BLMPOP_test_blocked_served_bothKey_FIFO_countOver_LEFT#03 (0.20s)
        tcp_client.go:73: 
            	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/util/tcp_client.go:73
            	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/util/tcp_client.go:100
            	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/list/list_test.go:1525
            	Error:      	Not equal: 
            	            	expected: ""blmpop-list2""
            	            	actual  : ""blmpop-list1""
            	            	
            	            	Diff:
            	            	--- Expected
            	            	+++ Actual
            	            	@@ -1 +1 @@
            	            	-blmpop-list2
            	            	+blmpop-list1
            	Test:       	TestList/BLMPOP_test_blocked_served_bothKey_FIFO_countOver_LEFT#03
FAIL
```

See: https://github.com/apache/kvrocks/actions/runs/11444706001/job/31841260069?pr=2615

### Minimal reproduce step

https://github.com/apache/kvrocks/actions/runs/11444706001/job/31841260069?pr=2615

### What did you expect to see?

Pass

### What did you see instead?

See above

### Anything Else?

no

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2617/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2617,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6R_3fZ,kvrocks,2449438681,2617,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-10-31T09:44:37Z,2024-10-31T09:44:37Z,"I'm guessing that's because the `WriteArgs` command was actually accepted by the server later than the next two RPUSHs
```
require.NoError(t, rdb.RPush(ctx, key2, ""one"", ""two"").Err()) // 1
require.NoError(t, rdb.RPush(ctx, key1, ""ONE"", ""TWO"").Err()) // 2
require.NoError(t, rd.WriteArgs(""blmpop"", ""1"", ""2"", key1, key2, direction, ""count"", ""2"")) // 3
```
The most simple solution is to add a sleep, but this can be confusing in testing, because some `WriteArgs` don't require the code to be executed exactly in the order of the code, as long as it has been executed, and sleep is not required.

We may need a clearer way to articulate our testing expectations, what do you think?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6R_3fZ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2617,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SACuv,kvrocks,2449484719,2617,NA,PokIsemaine,46661603,SiLe Zhou,zhousile@foxmail.com,NA,2024-10-31T10:05:37Z,2024-10-31T10:05:37Z,"I'd like to eliminate sleep from the test as much as possible, or add comments to sleep.

**Keep and add comments**
* Temporarily patch for known issues, e.g.: https://github.com/apache/kvrocks/issues/2473
* You really need to use sleep to ensure the order of command execution

**Identify and eliminate:** Unnecessary sleep

**Identify and eliminate/ add comments:** Unclear why sleep is needed. They might be hiding some issues. We might need to clear them all first and then determine whether we need to sleep and why we need to do so.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SACuv/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2618,https://api.github.com/repos/apache/kvrocks/issues/2618,kvrocks,2605245113,2618,updating the topology information in kvrocks does not change the replication relationships,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-10-22T11:58:38Z,2024-11-04T04:12:25Z,"### Discussed in https://github.com/apache/kvrocks/discussions/2616

<div type='discussions-op-text'>

<sup>Originally posted by **quan-kuang** October 22, 2024</sup>
I have already removed the slave node using the setnodes command, but I can still see the instance information through the info
![企业微信截图_17295785146549](https://github.com/user-attachments/assets/6d63759e-06e8-410a-8783-3066bc9b6067)
How should I remove this master-slave relationship?

</div>","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2618/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2625,https://api.github.com/repos/apache/kvrocks/issues/2625,kvrocks,2615476943,2625,Key range of XREAD/XREADGROUP is not correct,PragmaTwice,20042607,Twice,,CLOSED,2024-10-26T02:59:13Z,2024-11-15T04:27:40Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/blob/5fccd57c66bc8f0e4138924fe6a0148931e5650f/src/commands/cmd_stream.cc#L1891-L1892

We need to define a KeyRangeGen function to make it produce correct key range.

### What did you expect to see?

--

### What did you see instead?

--

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2625/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2625,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SU2fn,kvrocks,2454939623,2625,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-11-04T14:58:47Z,2024-11-04T14:58:47Z,"Hi @PragmaTwice ,

I want to follow up on this issue.

Could it be assigned to me? 😊

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SU2fn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2625,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SV07H,kvrocks,2455195335,2625,NA,PragmaTwice,20042607,Twice,,NA,2024-11-04T16:41:49Z,2024-11-04T16:41:49Z,Sure.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SV07H/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2626,https://api.github.com/repos/apache/kvrocks/issues/2626,kvrocks,2618140951,2626,"Optimization of the ""OK"" String",RiversJin,11208747,Rivers,riversjin@foxmail.com,CLOSED,2024-10-28T11:27:28Z,2024-11-01T08:58:43Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

In the kvrocks codebase, we often see code like the following, representing a successfully executed action:
```c++
*output = redis::SimpleString(""OK"");
```
Due to the design of C++ and the limitations of std::string, although we know the returned string is always ""+OK\r\n"", the compiler cannot fully optimize this (https://godbolt.org/z/nr69s9z83).

Perhaps we could define ""+OK\r\n"" as a constant string to save on the overhead of repeated string concatenations. While this is a very short string, I believe this adjustment could provide a slight performance boost in theory.

Additionally, defining a constant string, rather than hardcoding ""OK"" throughout the code, may also improve code readability and maintainability.

I hope this suggestion is helpful. If there is support for this idea, I would be glad to submit a PR to implement this change.

Thank you for your consideration!

### Solution

_No response_

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2626/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2626,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RhMtH,kvrocks,2441399111,2626,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-10-28T12:05:02Z,2024-10-28T12:05:02Z,"This is ok to me since ""OK"" would be frequently used, but I don't know what would other frequently used str like","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RhMtH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2626,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RhR0o,kvrocks,2441420072,2626,NA,RiversJin,11208747,Rivers,riversjin@foxmail.com,NA,2024-10-28T12:13:49Z,2024-10-28T12:13:49Z,"> This is ok to me since ""OK"" would be frequently used, but I don't know what would other frequently used str like这对我来说很好,因为""OK""会经常使用,但我不知道其他经常使用的字符串会是什么

From the code perspective, it seems that ""OK"" is used most frequently, while others, like ""PONG,"" appear occasionally. However, based on the principle of simplicity, I think caching the ""OK"" string alone should be sufficient.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RhR0o/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2628,https://api.github.com/repos/apache/kvrocks/issues/2628,kvrocks,2622569557,2628,Allow to delete keys by the prefix,Taymindis,14217761,Taymindis Woon,taymindis@gmail.com,OPEN,2024-10-30T00:14:14Z,2024-11-30T02:53:47Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

- Using Namespace in cluster mode to easily flush the keys .


### Solution

- As i knew namespace simply prepend the namespace prefix to the user key and remove it before retrieving. But it couldn't achieve with just simple key prefix.

we use the hash bracket like below, if our namespace is `foo`, and key is 1234, it will be successfully removed all the keys with same namespace.
{foo}:1234


### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2628/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2628,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RxcRD,kvrocks,2445657155,2628,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-30T01:57:01Z,2024-10-30T01:57:01Z,"@Taymindis Delete keys with the specified prefix would be easy in Kvrocks, but Redis now doesn't have a command for this and we need to invent one if we would like to support this. What do you think? @apache/kvrocks-committers ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6RxcRD/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2628,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6R4nAO,kvrocks,2447536142,2628,NA,ShooterIT,18362176,Yuan Wang,wangyuancode@163.com,NA,2024-10-30T15:23:56Z,2024-10-30T15:23:56Z,"As all keys are sorted by lexicographic order in kvrocks, maybe we can think of a set of commands about key prefix operation, of course, deleting keys by the prefix.
oh `scan` already supports key pattern, but kvrocks is faster than expected","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6R4nAO/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2628,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6R4th7,kvrocks,2447562875,2628,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-10-30T15:32:32Z,2024-10-30T15:32:32Z,"> oh scan already supports key pattern, but kvrocks is faster than expected

@ShooterIT Yes, another fast path is to use `DeleteRange` for the deletion command.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6R4th7/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2633,https://api.github.com/repos/apache/kvrocks/issues/2633,kvrocks,2628157813,2633,StallConditionType2String transfer rocksdb::WriteStallCondition may be error,greatsharp,9399875,Raphael,greatsharp@hotmail.com,CLOSED,2024-11-01T02:11:35Z,2024-11-08T06:39:38Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks version 2.10.0

### Minimal reproduce step

In rocksdb,  WriteStallCondition is declared below

```c++
enum class WriteStallCondition {
  kDelayed,
  kStopped,
  // Always add new WriteStallCondition before `kNormal`
  kNormal,
};
```

see https://github.com/facebook/rocksdb/blob/main/include/rocksdb/types.h

but in kvrocks  /src/storage/event_listener.cc, function define

```
std::string StallConditionType2String(const rocksdb::WriteStallCondition type) {
  std::vector<std::string> stall_condition_strings = {""normal"", ""delay"", ""stop""};
  if (static_cast<size_t>(type) < stall_condition_strings.size()) {
    return stall_condition_strings[static_cast<size_t>(type)];
  }
  return ""unknown"";
}
```

if we pass type as WriteStallCondition::kNormal, then function StallConditionType2String returned 'stop';

totally reversed.

the EventListener::OnStallConditionsChanged will record a confused warning message.

### What did you expect to see?

WriteStallCondition::kNormal should be transfer to normal,
kDelayed should delay,
kStopped should be stop

### What did you see instead?

write stall condition was changed, from normal to stop

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2633/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2633,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SG8bb,kvrocks,2451293915,2633,NA,PragmaTwice,20042607,Twice,,NA,2024-11-01T04:57:18Z,2024-11-01T04:57:18Z,"Good catch! Would you like to fix it?

`std::vector<std::string>` seems not a good way to do that since it can not guarantee to be compatible to new versions of rocksdb when a new enum value is introduced.

We can impl by a `std::map<SomeRocksdbEnumType, std::string>`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SG8bb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2633,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SG_lb,kvrocks,2451306843,2633,NA,mapleFU,24351052,mwish,maplewish117@gmail.com,NA,2024-11-01T05:13:23Z,2024-11-01T05:13:23Z,What about https://github.com/facebook/rocksdb/blob/a28cc4a38c2c7693a4786083d317bfc2cf874d76/db/write_stall_stats.h#L18 ?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SG_lb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2636,https://api.github.com/repos/apache/kvrocks/issues/2636,kvrocks,2630251340,2636,"Add ""blocking"" flag to CommandFlags",PragmaTwice,20042607,Twice,,CLOSED,2024-11-02T06:10:44Z,2024-11-02T17:21:25Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Same as Redis, e.g. https://redis.io/docs/latest/commands/bzmpop/

### Solution

--

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2636/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2636,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SNqHH,kvrocks,2453053895,2636,NA,PragmaTwice,20042607,Twice,,NA,2024-11-02T17:21:25Z,2024-11-02T17:21:25Z,Done in #2637.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6SNqHH/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2638,https://api.github.com/repos/apache/kvrocks/issues/2638,kvrocks,2630279680,2638,Remove SetCurrentConnection for read-only script commands,PragmaTwice,20042607,Twice,,CLOSED,2024-11-02T07:17:52Z,2024-11-03T11:38:10Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/blob/3a6a4be813c1903b8fb9f06abfeeaedc8efd512b/src/server/redis_connection.cc#L428-L431

We cannot call Server::SetCurrentConnection for read-only script commands since they are not exclusive.
In such way we can get wrong connection in scripting context.

Instead, we should pass the current context to lua context directly, in the same thread.

### What did you expect to see?

--

### What did you see instead?

--

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2638/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2642,https://api.github.com/repos/apache/kvrocks/issues/2642,kvrocks,2630956959,2642,Optimize the execution time of go test cases,PragmaTwice,20042607,Twice,,OPEN,2024-11-03T04:25:40Z,2025-02-03T07:12:40Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

In current GitHub Action workflows, go test execution now often takes more than 30 minutes, which may affect our responsiveness and PR processing efficiency.

We need to analyze which test cases take too long and optimize their execution time without affecting the test results.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2642/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2642,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ct7fd,kvrocks,2629285853,2642,NA,lyang24,20375035,Lanqing Yang,lanqingy@usc.edu,NA,2025-02-02T07:51:51Z,2025-02-02T07:51:51Z,"Hi i would like to take a shot with this issue. I ran the go test locally do you think its a good idea to take a look at the tests that rans over 20s?

```
ok  	github.com/apache/kvrocks/tests/gocase/integration/cluster	26.165s
ok  	github.com/apache/kvrocks/tests/gocase/integration/replication	119.125s
ok  	github.com/apache/kvrocks/tests/gocase/integration/slotmigrate	95.155s
ok  	github.com/apache/kvrocks/tests/gocase/unit/config	27.430s
ok  	github.com/apache/kvrocks/tests/gocase/unit/type/list	49.528s
ok  	github.com/apache/kvrocks/tests/gocase/unit/scripting	20.098s
ok  	github.com/apache/kvrocks/tests/gocase/unit/type/bitmap	34.487s
ok  	github.com/apache/kvrocks/tests/gocase/unit/type/zset	21.468s
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ct7fd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2642,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ct_W2,kvrocks,2629301686,2642,NA,PragmaTwice,20042607,Twice,,NA,2025-02-02T08:44:33Z,2025-02-02T08:44:33Z,"Yeah you can also pick a random workflow run and check the log, e.g.
https://github.com/apache/kvrocks/actions/runs/13096047337/job/36538680033#step:17:55

You can see that execution time of lots of tests can exceed 100s. And it's similar to the list you give.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ct_W2/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2642,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cvrgC,kvrocks,2629744642,2642,NA,lyang24,20375035,Lanqing Yang,lanqingy@usc.edu,NA,2025-02-03T02:17:05Z,2025-02-03T02:17:05Z,"We can try run tests in parallel. Then we can identify the bottle neck cases to further improve

For example i added some debug logging on github.com/apache/kvrocks/tests/gocase/integration/replication looks like
TestReplicationWithLimitSpeed is the bottle neck
```
TestReplicationAnnounceIP took 2.147078875s
TestShouldNotReplicate took 2.154190125s
TestReplicationContinueRunning took 2.247801667s
TestReplicationChangePassword took 3.255705917s
TestReplicationWithMultiSlaves took 3.894940417s
TestReplicationShareCheckpoint took 4.605201458s
TestFullSyncReplication took 10.106044083s
TestShouldNotReplicate took 10.585230084s
TestReplicationWithLimitSpeed took 29.336704s
```

And for unit tests with a lot of sub tests such as the bitmap tests I wonder if we can change the key of the different sub cases so they can be safely running concurrently with isolation?

this is an example of both case access foo key that is probably not safe to run in parallel.

```
t.Run(""GETEX bitmap no option"", func(t *testing.T) {
		require.NoError(t, rdb.Del(ctx, ""foo"").Err())
		require.NoError(t, rdb.SetBit(ctx, ""foo"", 0, 0).Err())
		require.Equal(t, ""\x00"", rdb.GetEx(ctx, ""foo"", 0).Val())

		// Make sure the expiration time is not erased by plain GETEX.
		require.NoError(t, rdb.Expire(ctx, ""foo"", 10*time.Second).Err())
		require.Equal(t, ""\x00"", rdb.Do(ctx, ""getex"", ""foo"").Val())
		util.BetweenValues(t, rdb.TTL(ctx, ""foo"").Val(), 5*time.Second, 10*time.Second)
	})

	t.Run(""GETEX bitmap EX/EXAT/PX/PXAT option"", func(t *testing.T) {
		require.NoError(t, rdb.Del(ctx, ""foo"").Err())
		require.NoError(t, rdb.SetBit(ctx, ""foo"", 0, 0).Err())
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cvrgC/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2642,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cvxs_,kvrocks,2629770047,2642,NA,lyang24,20375035,Lanqing Yang,lanqingy@usc.edu,NA,2025-02-03T02:40:39Z,2025-02-03T02:40:39Z,"geo was the longest test in ci 
`ok  	github.com/apache/kvrocks/tests/gocase/unit/geo	226.507s`
it was just a big function runs under a different config 
https://github.com/apache/kvrocks/blob/b8b969d80b9183106284049ff5338d0156ee5686/tests/gocase/unit/geo/geo_test.go#L90

we can look into break down the testGeo into smaller functions that can be parallelized ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cvxs_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2642,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cxMfG,kvrocks,2630141894,2642,NA,PragmaTwice,20042607,Twice,,NA,2025-02-03T07:12:23Z,2025-02-03T07:12:23Z,"> And for unit tests with a lot of sub tests such as the bitmap tests I wonder if we can change the key of the different sub cases so they can be safely running concurrently with isolation?

Yeah it can be changed as long as the test case keeps its functionality.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cxMfG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2660,https://api.github.com/repos/apache/kvrocks/issues/2660,kvrocks,2657296828,2660,Using INCRBY command on an expired key results in unexpected result.,FishYoung,7587864,,youngfish93@hotmail.com,CLOSED,2024-11-14T01:57:16Z,2024-11-18T11:18:40Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.10.0

### Minimal reproduce step

``` shell
127.0.0.1:6666> setex test2 10 2
OK
127.0.0.1:6666> get test2
""2""
127.0.0.1:6666> get test2
(nil)
127.0.0.1:6666> incrby test2 1
(error) ERR Invalid argument: value is not an integer or out of range 

127.0.0.1:6666> setex test 10 ttt
OK
127.0.0.1:6666> get test
""ttt""
127.0.0.1:6666> get test
""ttt""
127.0.0.1:6666> get test
(nil)
127.0.0.1:6666> get test
(nil)
127.0.0.1:6666> incrby test 1
(error) ERR Invalid argument: value is not an integer or out of range
```

1 set value with expire time.
2 wait until the key expires
3 use incrby to this key. Then we will get this err.

### What did you expect to see?

``` shell
10.26.172.242:6379> setex test 10 ttt
OK
10.26.172.242:6379> get test
""ttt""
10.26.172.242:6379> get test
(nil)
10.26.172.242:6379> get test
(nil)
10.26.172.242:6379> get test
(nil)
10.26.172.242:6379> incrby test 1
(integer) 1
10.26.172.242:6379> get test
""1""
10.26.172.242:6379> setex test 10 2
OK
10.26.172.242:6379> get test
""2""
10.26.172.242:6379> get test
""2""
10.26.172.242:6379> get test
(nil)
10.26.172.242:6379> incrby test 1
(integer) 1
```
In Redis, I think we will get an integer because that it should treat the expired key as a new key. 

### What did you see instead?

--

### Anything Else?

I've tried to use read the code of INCRBY cmd.  Maybe the following code affects the normal results.
Here, we get the `raw_value` and find it is expired. Should we reset the raw_value here to prevent the following parsing or judgement?
``` c++
rocksdb::Status String::IncrBy(engine::Context &ctx, const std::string &user_key, int64_t increment,
                               int64_t *new_value) {
  std::string ns_key = AppendNamespacePrefix(user_key);

  LockGuard guard(storage_->GetLockManager(), ns_key);
  std::string raw_value;
  rocksdb::Status s = getRawValue(ctx, ns_key, &raw_value);
  if (!s.ok() && !s.IsNotFound()) return s;
  if (s.IsNotFound()) {
    Metadata metadata(kRedisString, false);
    // TODO: reset the ""raw_value"" // raw_value = """";
    metadata.Encode(&raw_value);
  }
```

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2660/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2660,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6TiNLu,kvrocks,2475217646,2660,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-11-14T02:10:33Z,2024-11-14T02:10:33Z,@FishYoung Good catch.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6TiNLu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/2671,kvrocks,2664507197,2671,Add more test cases about replication and cluster,PragmaTwice,20042607,Twice,,CLOSED,2024-11-16T15:22:24Z,2024-12-12T06:39:36Z,"              By the way, can we add a test with master removed and about 5s' connection timeout in go integration?

_Originally posted by @mapleFU in https://github.com/apache/kvrocks/issues/2662#issuecomment-2477964921_
            ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2671/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6UlHAz,kvrocks,2492756019,2671,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-11-22T02:31:01Z,2024-11-22T02:31:01Z,"Hi @PragmaTwice ,

  I want to follow up on this issue and learn about our replication logic.

 Could this issue be assigned to me? 😊

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6UlHAz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6UlLr-,kvrocks,2492775166,2671,NA,PragmaTwice,20042607,Twice,,NA,2024-11-22T02:51:38Z,2024-11-22T02:51:38Z,Sure! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6UlLr-/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wj_Oo,kvrocks,2526016424,2671,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-12-08T14:13:32Z,2024-12-08T14:13:32Z,"Hi @sryanyuan ,

Sorry to bother you in this thread.

I'm trying to create a case from your description for integration test.

> If the master is lost, the replication thread will block until the keepalive timer is reached when receiving full-sync SST files. At the same time, if we execute a 'clusterx setnodes' command, it will hold an exclusive lock until the replication thread is stopped. This will cause all other worker threads to block.

But I'm not sure about the configuration of the master and slave.

Could you give me some advice on reproducing the problem? 😊

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wj_Oo/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wkdq0,kvrocks,2526141108,2671,NA,PragmaTwice,20042607,Twice,,NA,2024-12-08T14:55:39Z,2024-12-08T14:55:39Z,cc @mapleFU could you take a look?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wkdq0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wmd3u,kvrocks,2526666222,2671,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-12-09T02:23:40Z,2024-12-09T02:23:40Z,"The command `cluster setnodes` needs to stop the existing replication thread first before switching to the new master. So it will [stop the replication thread](https://github.com/apache/kvrocks/blob/698c3d4cedb7321b70bb4b4b2bc0abc9cd8db337/src/server/server.cc#L274) when adding the new master, but found the replication thread is hanging on fetching SST files for the sake of the connect/read timeout isn't set and the master is lost.

It will wait for about 3s after the PR #2662.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wmd3u/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6WmkER,kvrocks,2526691601,2671,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-12-09T02:47:55Z,2024-12-09T02:47:55Z,"> The command `cluster setnodes` needs to stop the existing replication thread first before switching to the new master. So it will [stop the replication thread](https://github.com/apache/kvrocks/blob/698c3d4cedb7321b70bb4b4b2bc0abc9cd8db337/src/server/server.cc#L274) when adding the new master, but found the replication thread is hanging on fetching SST files for the sake of the connect/read timeout isn't set and the master is lost.
> 
> 
> 
> It will wait for about 3s after the PR #2662.

Hi @git-hulk ,

Thanks for your detailed analysis! I will try this way today. 😊

By the way, do we have a way to confirm the SST file fetching status or force triggering the SST file syncing in cluster mode? 😊

Best Regards,
Edward","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6WmkER/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wmqdw,kvrocks,2526717808,2671,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2024-12-09T03:10:54Z,2024-12-09T03:10:54Z,"@LindaSummer Thanks for your efforts. For this case, I think it should be good to reproduce with an unreachable master IP only. Before PR #2662, it's expected to be hanging while switching to a new master. And after #662, it should be back to normal after a few seconds(3-4). cc @PragmaTwice @sryanyuan ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wmqdw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6WmvOw,kvrocks,2526737328,2671,NA,sryanyuan,6258142,sryan yuan,sryanyuan@gmail.com,NA,2024-12-09T03:21:11Z,2024-12-09T03:21:11Z,"> Hi @sryanyuan ,
> 
> Sorry to bother you in this thread.
> 
> I'm trying to create a case from your description for integration test.
> 
> > If the master is lost, the replication thread will block until the keepalive timer is reached when receiving full-sync SST files. At the same time, if we execute a 'clusterx setnodes' command, it will hold an exclusive lock until the replication thread is stopped. This will cause all other worker threads to block.
> 
> But I'm not sure about the configuration of the master and slave.
> 
> Could you give me some advice on reproducing the problem? 😊
> 
> Best Regards, Edward

* Write some data into master
* Add a slave
* Before the full sync is completed, execute the following commands on the master to simulate network problems:
   ```
   service network stop
   echo `date ""+%y-%m-%d %H:%M:%S""`---service network stop
   sleep 120s
   service network start
   echo `date ""+%y-%m-%d %H:%M:%S""`---service network start
   ```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6WmvOw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6WnKPX,kvrocks,2526847959,2671,NA,LindaSummer,14014471,Edward Xu,xuxiangad@gmail.com,NA,2024-12-09T04:12:45Z,2024-12-09T04:12:45Z,"> > Hi @sryanyuan ,
> 
> > 
> 
> > Sorry to bother you in this thread.
> 
> > 
> 
> > I'm trying to create a case from your description for integration test.
> 
> > 
> 
> > > If the master is lost, the replication thread will block until the keepalive timer is reached when receiving full-sync SST files. At the same time, if we execute a 'clusterx setnodes' command, it will hold an exclusive lock until the replication thread is stopped. This will cause all other worker threads to block.
> 
> > 
> 
> > But I'm not sure about the configuration of the master and slave.
> 
> > 
> 
> > Could you give me some advice on reproducing the problem? 😊
> 
> > 
> 
> > Best Regards, Edward
> 
> 
> 
> * Write some data into master
> 
> * Add a slave
> 
> * Before the full sync is completed, execute the following commands on the master to simulate network problems:
> 
>    ```
> 
>    service network stop
> 
>    echo `date ""+%y-%m-%d %H:%M:%S""`---service network stop
> 
>    sleep 120s
> 
>    service network start
> 
>    echo `date ""+%y-%m-%d %H:%M:%S""`---service network start
> 
>    ```

Hi @sryanyuan ,

Thanks very much!

Got it! I will try it later today.😊

Best Regards,
Edward

","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6WnKPX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2671,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wnzmn,kvrocks,2527017383,2671,NA,sryanyuan,6258142,sryan yuan,sryanyuan@gmail.com,NA,2024-12-09T06:05:42Z,2024-12-09T06:05:42Z,"> > > Hi @sryanyuan ,
> > 
> > 
> > > 
> > 
> > 
> > > Sorry to bother you in this thread.
> > 
> > 
> > > 
> > 
> > 
> > > I'm trying to create a case from your description for integration test.
> > 
> > 
> > > 
> > 
> > 
> > > > If the master is lost, the replication thread will block until the keepalive timer is reached when receiving full-sync SST files. At the same time, if we execute a 'clusterx setnodes' command, it will hold an exclusive lock until the replication thread is stopped. This will cause all other worker threads to block.
> > 
> > 
> > > 
> > 
> > 
> > > But I'm not sure about the configuration of the master and slave.
> > 
> > 
> > > 
> > 
> > 
> > > Could you give me some advice on reproducing the problem? 😊
> > 
> > 
> > > 
> > 
> > 
> > > Best Regards, Edward
> > 
> > 
> > 
> > * Write some data into master
> > * Add a slave
> > * Before the full sync is completed, execute the following commands on the master to simulate network problems:
> >   ```
> >   
> >   service network stop
> >   
> >   echo `date ""+%y-%m-%d %H:%M:%S""`---service network stop
> >   
> >   sleep 120s
> >   
> >   service network start
> >   
> >   echo `date ""+%y-%m-%d %H:%M:%S""`---service network start
> >   ```
> 
> Hi @sryanyuan ,
> 
> Thanks very much!
> 
> Got it! I will try it later today.😊
> 
> Best Regards, Edward

Glad to help ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Wnzmn/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2676,https://api.github.com/repos/apache/kvrocks/issues/2676,kvrocks,2681509775,2676,Allow to disable the index partitioning in kvrocks.conf,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2024-11-22T01:49:05Z,2024-12-06T09:06:09Z,"### Discussed in https://github.com/apache/kvrocks/discussions/2675

<div type='discussions-op-text'>

<sup>Originally posted by **bartek-siudeja** November 22, 2024</sup>
kvrocks is quite impressive! Thanks for doing this. 

We are trying to build a KV store with extremely strict latency/throughput requirements. We are working with really large servers, with lots of memory. Our values are relatively big and keys are random and small. So it would make sense to store all indexes and big bloom filters in memory. It seems this can be achieved using `cache_index_and_filter_blocks: no` and `max_open_files: -1`. However, kvrocks enables partitioning (at least for filters, not sure about indexes):
https://github.com/apache/kvrocks/blob/2.10/src/storage/storage.cc#L132
And partitioned filters seem to always live inside block_cache, so they can be evicted.

Would it be possible to expose the partitioning option in the config file? Or maybe have a ""meta option"" to force filters/indexes to stay in memory. Along the same line bloom filter size could be increased from 10 to say 15 bits to really avoid hitting the disk at any cost. Really only when we are pretty much sure key is there, and value can be retrieved. But this option is also hardcoded (a line above filter partitioning).</div>","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2676/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2676,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Vz9NR,kvrocks,2513425233,2676,NA,fukua95,24987055,,fukua95@gmail.com,NA,2024-12-03T02:43:57Z,2024-12-03T02:43:57Z,Can I be assigned this issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Vz9NR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2676,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Vz-T4,kvrocks,2513429752,2676,NA,PragmaTwice,20042607,Twice,,NA,2024-12-03T02:47:58Z,2024-12-03T02:47:58Z,Sure! Assigned.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6Vz-T4/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2676,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6WVNhF,kvrocks,2522142789,2676,NA,fukua95,24987055,,fukua95@gmail.com,NA,2024-12-06T04:58:51Z,2024-12-06T04:58:51Z,the PR: #2688,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6WVNhF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2712,https://api.github.com/repos/apache/kvrocks/issues/2712,kvrocks,2769257236,2712,Add support of the RESP format for the POLLUPDATES command,git-hulk,4987594,hulk,hulk.website@gmail.com,CLOSED,2025-01-05T12:42:30Z,2025-01-27T14:25:55Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Currently, the POLLUPDATES command only supports the raw(rocksdb batch) format.
It will be more convenient if supports the RESP command when polling.

### Solution

_No response_

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2712/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2715,https://api.github.com/repos/apache/kvrocks/issues/2715,kvrocks,2774096964,2715,"After the cluster expansion completes the slot migration, the total dbsize value of all shard master nodes is greater than the value before the expansion",903174293,32761339,A卍,,OPEN,2025-01-08T02:30:14Z,2025-01-17T03:04:17Z,"### Search before asking

- [X] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

v2.9.0

### Minimal reproduce step

1、kvrocks version：v2.9.0
2、init env：3 shard，One master and one slave，Single Node Specifications：8C16G、disk：500GB
3、After expansion：5 shard，One master and one slave，Single Node Specifications：8C16G、disk：500GB
4、Expansion method：Calling the controller interface
5、Phenomenon：
       Before expansion： the total dbsize value of all shard master nodes：12484
       After expansion：the total dbsize value of all shard master nodes：12489


### What did you expect to see?

The total dbsize of all master nodes is equal before and after expansion

### What did you see instead?

Before expansion： the total dbsize value of all shard master nodes：12484
After expansion：the total dbsize value of all shard master nodes：12489


### Anything Else?

Migration interface for controllers：
POST  /api/v1/namespaces/clusters/{cluster name}/migrate
{
  ""target"": 4,
  ""slot"": 1000,
  ""slot_only"": false 
}

### Are you willing to submit a PR?

- [X] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2715/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2715,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6aJGZu,kvrocks,2586076782,2715,NA,hongleis,24707850,honglei sun,sun.honglei341314@gmail.com,NA,2025-01-13T02:44:53Z,2025-01-13T02:44:53Z,"I found the same issue in my tests.
There are 3 nodes in my cluster before migration, after migration, there are 5 nodes in my cluster.
Here is my test steps:

1. kvrocks version 2.9.0
2. before migration: use` scan` command to check all the master nodes, there are 167005770 keys;
3. set `migrate-type` =`raw-key-value` in kvrocks.conf
4.  call the kv controller migrate API: {{host}}/api/v1/namespaces/{{namespace}}/clusters/{{cluster}}/migrate
5.  call the kv controller API to check the migration is done: http://{{host}}/api/v1/namespaces/akv/clusters/kvrocks_29_test_migrate
6. after migration: use` scan` command to check all the master nodes, there are 167016655 keys;
7. there are 10885 keys depulicated after migration done.

feel free to contact me for more test details","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6aJGZu/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2715,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6aJGiw,kvrocks,2586077360,2715,NA,hongleis,24707850,honglei sun,sun.honglei341314@gmail.com,NA,2025-01-13T02:45:48Z,2025-01-13T02:45:48Z,@git-hulk ,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6aJGiw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2715,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6aJV4l,kvrocks,2586140197,2715,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-01-13T04:10:10Z,2025-01-13T04:10:10Z,"@903174293 @hongleis Thanks for your report. I have missed this issue in the past few days. I want to know:

- Are all of those duplicated keys still living in the source node?
- Do those duplicated keys have any new writes while migrating?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6aJV4l/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2715,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6aK0-D,kvrocks,2586529667,2715,NA,903174293,32761339,A卍,,NA,2025-01-13T08:56:33Z,2025-01-13T08:56:33Z,"> @903174293 @hongleis Thanks for your report. I have missed this issue in the past few days. I want to know:
> 
> * Are all of those duplicated keys still living in the source node?
> * Do those duplicated keys have any new writes while migrating?

yes,but it cannot be found using get, but can be found using keys*;
no","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6aK0-D/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2715,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6azrzd,kvrocks,2597240029,2715,NA,hongleis,24707850,honglei sun,sun.honglei341314@gmail.com,NA,2025-01-17T01:24:32Z,2025-01-17T01:24:32Z,"
@git-hulk  for the duplicated key, it located in both source node and destionation node. when we use the redis get command ,it will go to the destionation node to search. But I connect to the source node（not cluster mode） and use redis scan command to search, I can find the deplicated key.  In a word, it did not affect the first migration, but when we migration mulitiple times , i am afraid the depulicated keys which not cleaned may be the dirty values 
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6azrzd/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2715,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6a0Dgl,kvrocks,2597337125,2715,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-01-17T03:03:51Z,2025-01-17T03:03:51Z,"@hongleis Got your point, thanks for both of your information. Will take a look at this issue when I get time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6a0Dgl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/2723,kvrocks,2791753904,2723,Duplicate data was generated during expansion.,VIVALXH,98531764,,,OPEN,2025-01-16T05:41:11Z,2025-02-07T14:26:45Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.10

### Minimal reproduce step

Env: Kvrocks cluster with 4 shards.

1. Using go-redis and opening multiple goroutines to concurrently generate data continuously.

``` golang
userId := helper.GetRandomInt64InRange(1, 10000)
key := strconv.FormatInt(userId, 10)

uuidStr := uuid.New().String()
timestamp := time.Now().UnixNano()
value := fmt.Sprintf(""%s-%d"", uuidStr, timestamp)

_, err := c.Do(context.TODO(), 2, ""LPUSH"", key, value)
```

2. Use the following command to expand the Kvrocks cluster from 4 shards to 8 shards.

``` 
CLUSTERX SETNODEID $NODE_ID $NODE_ID
CLUSTERX MIGRATE $slot $dst_nodeid
CLUSTERX SETSLOT $slot NODE $node_id $new_version
``` 

3. Check data after expand.

### What did you expect to see?

no duplicate data was generated.

### What did you see instead?

``` shell
[root@iZwz9dff7pa0adxvbwkbc8Z ~]# ./check_redis_list
2025/01/16 13:34:20 maxprocs: Leaving GOMAXPROCS=4: CPU quota undefined
LIST 1978 has duplicate data:
duplicate data: 99b22bda-96de-43ec-98d4-d74d5a590d11-1736994529584945168
duplicate data index: [43 44]
list length: 395

LIST 3171 has duplicate data:
duplicate data: 9bb7a7cc-3004-4d5b-965d-fe171badc21a-1736994509584166314
duplicate data index: [86 87]
list length: 412

LIST 3468 has duplicate data:
duplicate data: 9c3bc47b-d92c-4d55-b588-9fbc594849fc-1736994519583905106
duplicate data index: [65 66]
list length: 406

LIST 3616 has duplicate data:
duplicate data: 41342d98-ace0-4212-b9ea-437772a17e68-1736994539585064098
duplicate data index: [32 33]
list length: 376

LIST 5519 has duplicate data:
duplicate data: c9fb599e-453e-4615-bc7c-74b1b8a8bec0-1736994529583967377
duplicate data index: [51 52]
list length: 414

LIST 6445 has duplicate data:
duplicate data: 3d1c3404-af08-4d47-a0f8-2fa0cea0885a-1736994509583942704
duplicate data index: [87 88]
list length: 377

LIST 8973 has duplicate data:
duplicate data: ab937bce-f43f-4f2c-a65a-b1c6cc5f08b9-1736994529584052504
duplicate data index: [55 56]
list length: 414

LIST 9250 has duplicate data:
duplicate data: 1550b5fc-ba5a-4d88-9b9d-daf9c52650ef-1736994509583124277
duplicate data index: [82 83]
list length: 421

LIST 9555 has duplicate data:
duplicate data: 606ab92e-4052-43fb-900d-91e45892ef2a-1736994529583492941
duplicate data index: [59 60]
list length: 395

```

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2723/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6a0Ema,kvrocks,2597341594,2723,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-01-17T03:08:23Z,2025-01-17T03:08:23Z,"@VIVALXH Great! thanks for your detailed information, it's helpful to identify this isue.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6a0Ema/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cuAio,kvrocks,2629306536,2723,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-02-02T09:01:06Z,2025-02-02T09:01:06Z,"Hi @VIVALXH 

go-redis might retry on network error. Would you mind disabling the retry to see if the issue is still existing? https://github.com/redis/go-redis/blob/1139bc3aa9073851f67faa6d68df07a566901dd7/options.go#L75C2-L75C12","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cuAio/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dTEdS,kvrocks,2639021906,2723,NA,VIVALXH,98531764,,,NA,2025-02-06T07:20:22Z,2025-02-06T07:20:22Z,"@git-hulk thanks.

No duplicate data was generated, but this resulted in the loss of a significant amount of data that should have been written.

I controlled the osscluster retry count by setting redis.UniversalOptions.MaxRedirects = -1. 
(https://github.com/redis/go-redis/blob/1139bc3aa9073851f67faa6d68df07a566901dd7/osscluster.go#L45)

However, this inevitably led to Moved errors and TryAgain errors as mentioned in this PR(https://github.com/apache/kvrocks/pull/1240). 

The Moved error occurs between the following two commands:
- CLUSTERX MIGRATE $slot $dst_nodeid
- CLUSTERX SETSLOT $slot NODE $node_id $new_version

Additionally, if the interval between these two commands is longer (e.g., 10 seconds), the probability of generating duplicate data increases. The duplicate data primarily appears on the new nodes after scaling out. Following the process I described, this issue can be consistently reproduced.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dTEdS/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dVz2e,kvrocks,2639740318,2723,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-02-06T12:49:35Z,2025-02-06T12:49:35Z,"> I controlled the osscluster retry count by setting redis.UniversalOptions.MaxRedirects = -1.


@VIVALXH You should set `MaxRetries` to `-1` instead of `MaxRedirects`. Or it will prevent retrying while receiving the TRYAGAIN error. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dVz2e/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dWML_,kvrocks,2639839999,2723,NA,VIVALXH,98531764,,,NA,2025-02-06T13:31:20Z,2025-02-06T13:31:20Z,"@git-hulk 

I am using ClusterClient, and internally it uses MaxRedirects instead of MaxRetries in its process function. It worked as expected and achieved our goal of preventing duplicate data. 
https://github.com/redis/go-redis/blob/1139bc3aa9073851f67faa6d68df07a566901dd7/osscluster.go#L967

This suggests that retries might have caused the data duplication, but in reality, we cannot set the retries to zero because it lost amount of data.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dWML_/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dW5w8,kvrocks,2640026684,2723,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-02-06T14:44:32Z,2025-02-06T14:44:32Z,"@VIVALXH The cluster client also supports the [MaxRetries](https://github.com/redis/go-redis/blob/master/osscluster.go#L75), set MaxRedirects=-1 wouldn't retry when occuring the TRYGAIN error.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dW5w8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dW_pp,kvrocks,2640050793,2723,NA,VIVALXH,98531764,,,NA,2025-02-06T14:53:35Z,2025-02-06T14:53:35Z,"> Hi [@VIVALXH](https://github.com/VIVALXH)
> 
> go-redis might retry on network error. Would you mind disabling the retry to see if the issue is still existing? https://github.com/redis/go-redis/blob/1139bc3aa9073851f67faa6d68df07a566901dd7/options.go#L75C2-L75C12

@git-hulk 
Now we conclude that the retry may have caused the duplicate data, but in practice it is impossible to cancel the retry.
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dW_pp/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ddQ8K,kvrocks,2641694474,2723,NA,VIVALXH,98531764,,,NA,2025-02-07T01:35:05Z,2025-02-07T01:35:05Z,"> [@VIVALXH](https://github.com/VIVALXH) The cluster client also supports the [MaxRetries](https://github.com/redis/go-redis/blob/master/osscluster.go#L75), set MaxRedirects=-1 wouldn't retry when occuring the TRYGAIN error.

@git-hulk 
Hello, I tried setting `MaxRetries=-1` today, but duplicate data still occurred. Only when I set `MaxRedirects=-1` did the duplicate data stop.

So I guess the data duplication is caused by retries due to `Moved` errors or `TryAgain` errors?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ddQ8K/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dhSoF,kvrocks,2642749957,2723,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-02-07T12:08:58Z,2025-02-07T12:08:58Z,"> So I guess the data duplication is caused by retries due to Moved errors or TryAgain errors?

I'm not quite sure about this. But after considering this issue, it's impossible to push an element exactly once in a list without the deduplicate mechanism. Because we always need to retry once there are any network issues or timeout, or it might lose data.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dhSoF/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2723,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dij1q,kvrocks,2643082602,2723,NA,VIVALXH,98531764,,,NA,2025-02-07T14:26:44Z,2025-02-07T14:26:44Z,"> > So I guess the data duplication is caused by retries due to Moved errors or TryAgain errors?
> 
> I'm not quite sure about this. But after considering this issue, it's impossible to push an element exactly once in a list without the deduplicate mechanism. Because we always need to retry once there are any network issues or timeout, or it might lose data.

yes, it is impossible to cancel the retry because it lost amount of data. 

At present, the situation of duplicate data only occurs when scaling. Is there any other solution that can avoid this?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dij1q/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2728,https://api.github.com/repos/apache/kvrocks/issues/2728,kvrocks,2803320277,2728,resp3 should enabled by default,i18nsite,145643935,i18n.site,i18n.site@gmail.com,CLOSED,2025-01-22T04:08:41Z,2025-01-29T07:11:28Z,"

### Motivation

resp3 should enable by default / 默认启用resp3

 和redis默认行为更加一致，减少使用时候的debug成本

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2728/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2730,https://api.github.com/repos/apache/kvrocks/issues/2730,kvrocks,2807827806,2730,FIFO Compaction,mnutt,3705,Michael Nutt,michael@nuttnet.net,CLOSED,2025-01-23T20:20:04Z,2025-01-30T04:11:39Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

RocksDB supports FIFO compaction, but it looks like it isn't exposed as a kvrocks config option. Would you be open to a PR that adds it as a config option?

### Solution

Proof of concept: https://github.com/mnutt/kvrocks/commit/69c671ad60fb2a50f466ad4799a528b28aa47452.

* my use case doesn't need it, but we could also add universal compaction as an option at the same time if we wanted
* with fifo, `max_open_files` must be `-1`. we can either set that or validate that it was set

### Are you willing to submit a PR?

- [x] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2730/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2730,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6bprFc,kvrocks,2611392860,2730,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-01-24T02:08:48Z,2025-01-24T02:08:48Z,"@mnutt Thanks for your efforts. For Kvrocks, it will store data in different column families. It might cause fields(subkeys) in a key to be partially recycled by FIFO compaction. For example, we have a hash key with fields: `f1`=> `v1`, `f2`=>`v2` and FIFO will recycle SSTs by time, so it might remove `f1`=>`v1` but keep `f2`=>`v2` if they are in separated SSTs.

For the data design in Kvrocks, please refer to: [Data structures design](https://kvrocks.apache.org/community/data-structure-on-rocksdb).
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6bprFc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2730,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6buVXM,kvrocks,2612614604,2730,NA,mnutt,3705,Michael Nutt,michael@nuttnet.net,NA,2025-01-24T14:06:59Z,2025-01-24T14:06:59Z,"Thanks for the quick reply! So as I understand it, GET and SET would work but other parts of the redis api that use multiple kvrocks keys wouldn't work as expected?

That makes sense, though it's a shame because kvrocks is otherwise _such_ a great fit for very write-heavy time-based workloads that can't deal well with level compaction.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6buVXM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2734,https://api.github.com/repos/apache/kvrocks/issues/2734,kvrocks,2810746750,2734,Switch the compiler from gcc to clang in docker image building,PragmaTwice,20042607,Twice,,CLOSED,2025-01-25T04:07:55Z,2025-01-25T10:19:52Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

https://github.com/apache/kvrocks/actions/runs/12900087312/job/35969931715

https://github.com/apache/kvrocks/actions/runs/12960760661/job/36155082672

Some crash observed in building phase of the docker image. We can switch the compile to clang since it should be more stable.

### Solution

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2734/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2735,https://api.github.com/repos/apache/kvrocks/issues/2735,kvrocks,2810747248,2735,Make blocking commands work well in scripting,PragmaTwice,20042607,Twice,,CLOSED,2025-01-25T04:09:25Z,2025-01-29T01:22:08Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

Like in multi-exec, we can disable blocking in scripting for these commands, and then they should work well.

### What did you expect to see?

--

### What did you see instead?

--

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2735/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2752,https://api.github.com/repos/apache/kvrocks/issues/2752,kvrocks,2819719223,2752,Flaky test about BLMPOP in go cases,PragmaTwice,20042607,Twice,,CLOSED,2025-01-30T01:51:15Z,2025-01-31T08:53:56Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

unstable

### Minimal reproduce step

https://github.com/apache/kvrocks/actions/runs/13037715492/job/36389804631?pr=2750#step:17:137
```
--- FAIL: TestList (22.59s)
    --- FAIL: TestList/BLMPOP_test_blocked_served_bothKey_FIFO_countOver_RIGHT#01 (0.10s)
        tcp_client.go:73: 
            	Error Trace:	/home/runner/work/kvrocks/kvrocks/tests/gocase/util/tcp_client.go:73
            	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/util/tcp_client.go:100
            	            				/home/runner/work/kvrocks/kvrocks/tests/gocase/unit/type/list/list_test.go:1470
            	Error:      	Not equal: 
            	            	expected: ""blmpop-list2""
            	            	actual  : ""blmpop-list1""
            	            	
            	            	Diff:
            	            	--- Expected
            	            	+++ Actual
            	            	@@ -1 +1 @@
            	            	-blmpop-list2
            	            	+blmpop-list1
            	Test:       	TestList/BLMPOP_test_blocked_served_bothKey_FIFO_countOver_RIGHT#01
FAIL
```

### What did you expect to see?

--

### What did you see instead?

--

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2752/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/2756,kvrocks,2823002522,2756,Replica full sync doesn't work over TLS,vlstv,32194548,Sergei Volosatov,,CLOSED,2025-01-31T10:30:16Z,2025-02-03T14:51:10Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

kvrocks version 2.10.1
Ubuntu 22.04.5 LTS jammy


### Minimal reproduce step

- Compile Kvrocks using the following CMake flag to enable OpenSSL `-DENABLE_OPENSSL=ON`

- Configure TLS for replication:
```
tls-cert-file /etc/kvrocks/ssl/cert.pem
tls-key-file /etc/kvrocks/ssl/privkey.pem
tls-ca-cert-file /etc/kvrocks/ssl/ca.pem
tls-replication yes
tls-auth-clients yes
```
- Preload the master node with a substantial dataset (approximately 3 million keys, totaling around 250MB). Note that smaller datasets may not trigger the issue.
- Set up a clean replica node and initiate a connection to the master.
- Monitor the replica and master logs. The replica connection to the master should fail

### What did you expect to see?

Replica fully synced from master

### What did you see instead?

On master
```
I20250131 10:25:43.287408 171037 cmd_replication.cc:60] Slave {replica-ip}:52148, listening port: 6666, announce ip: {replica-ip} asks for synchronization with next sequence: 1 replication id: not supported, and local sequence: 2928646138
E20250131 10:25:43.302386 171037 redis_connection.cc:110] [connection] Going to remove the client: {replica-ip}:52148, while encounter error: Success, SSL Error: error:0A000126:SSL routines::unexpected eof while reading
I20250131 10:25:43.496016 171047 storage.cc:1025] [storage] Create checkpoint successfully
I20250131 10:25:43.496235 171047 cmd_replication.cc:242] [replication] Succeed sending full data file info to {replica-ip}
W20250131 10:25:43.534340 171048 cmd_replication.cc:299] [replication] Fail to send file 026067.sst to {replica-ip}, error: Success
I20250131 10:25:53.575836 171049 storage.cc:1045] [storage] Using current existing checkpoint
I20250131 10:25:53.575964 171049 cmd_replication.cc:242] [replication] Succeed sending full data file info to {replica-ip}
W20250131 10:25:53.612814 171050 cmd_replication.cc:299] [replication] Fail to send file 026067.sst to {replica-ip}, error: Success
I20250131 10:26:03.650056 171095 storage.cc:1045] [storage] Using current existing checkpoint
I20250131 10:26:03.650157 171095 cmd_replication.cc:242] [replication] Succeed sending full data file info to {replica-ip}
W20250131 10:26:03.688643 171096 cmd_replication.cc:299] [replication] Fail to send file 026067.sst to {replica-ip}, error: Success
```

On replica
```
==> /var/log/kvrocks/kvrocks.INFO <==
I20250131 10:29:05.033082 149749 replication.cc:613] [replication] Start syncing data with fullsync
I20250131 10:29:05.043185 149749 storage.cc:1111] [storage] Succeed deleting invalid file 026067.sst.tmp of master checkpoint
I20250131 10:29:05.043205 149749 replication.cc:701] [replication] Succeeded fetching full data files info, fetching files in parallel
W20250131 10:29:05.079695 149948 replication.cc:946] [fetch] Fail to fetch file 026067.sst, err: fetch file err: read sst file: failed to read from SSL connection: error:00000000:lib(0)::reason(0)
E20250131 10:29:05.079890 149749 replication.cc:717] [replication] Failed to parallel fetch files while fetch file err: read sst file: failed to read from SSL connection: error:00000000:lib(0)::reason(0)
I20250131 10:29:05.080359 149749 replication.cc:234] [replication] Retry in 10 seconds

==> /var/log/kvrocks/kvrocks.ERROR <==
E20250131 10:29:05.079890 149749 replication.cc:717] [replication] Failed to parallel fetch files while fetch file err: read sst file: failed to read from SSL connection: error:00000000:lib(0)::reason(0)
```

### Anything Else?

- Transferring the dataset from the master to the replica manually allows replication to work as expected
- If new writes are made to a clean master while a replica is connected, replication functions normally without errors

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2756/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cr0iM,kvrocks,2628733068,2756,NA,PragmaTwice,20042607,Twice,,NA,2025-02-01T03:11:56Z,2025-02-01T03:11:56Z,"Thank you for your reporting. It seems psync works well in TLS, but fullsync does not.

I've reproduced this issue, and will look into it soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6cr0iM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csCCN,kvrocks,2628788365,2756,NA,PragmaTwice,20042607,Twice,,NA,2025-02-01T05:37:10Z,2025-02-01T05:37:10Z,"@vlstv Hi, I made a patch #2757 for this issue. Would you mind to check if it can solve your problem?","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csCCN/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csWSb,kvrocks,2628871323,2756,NA,PragmaTwice,20042607,Twice,,NA,2025-02-01T09:19:10Z,2025-02-01T09:19:10Z,I'll leave it open till you check.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csWSb/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csepi,kvrocks,2628905570,2756,NA,vlstv,32194548,Sergei Volosatov,,NA,2025-02-01T11:02:31Z,2025-02-01T11:02:31Z,"@PragmaTwice Thank you for the prompt fix! I won't be able to check it until Monday, but I'll get back to you once it's tested on my side","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csepi/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ctThz,kvrocks,2629122163,2756,NA,kinoute,623763,Yann Defretin,yann@defret.in,NA,2025-02-01T21:29:36Z,2025-02-01T21:29:36Z,Could it be the same error I reported on 2.9.0 ? https://github.com/apache/kvrocks/issues/2490,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ctThz/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ctjsc,kvrocks,2629188380,2756,NA,PragmaTwice,20042607,Twice,,NA,2025-02-02T01:10:35Z,2025-02-02T01:10:35Z,"> Could it be the same error I reported on 2.9.0 ? [#2490](https://github.com/apache/kvrocks/issues/2490)

Maybe? I'm not sure. You can try to reproduce it.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ctjsc/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ctwcX,kvrocks,2629240599,2756,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-02-02T04:43:47Z,2025-02-02T04:43:47Z,@kinoute @PragmaTwice It looks like the same issue. Both of them occurred errors while fetching the SSTs. You might have a try at the nightly docker image to see if this issue is still living.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6ctwcX/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6czUf5,kvrocks,2630699001,2756,NA,vlstv,32194548,Sergei Volosatov,,NA,2025-02-03T11:36:26Z,2025-02-03T11:36:26Z,"Hi, @PragmaTwice! I can confirm that this patch solved the issue with tls replication. Thanks again for a quick fix ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6czUf5/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c0RFB,kvrocks,2630947137,2756,NA,vadimgobja,149395269,Vadim Gobja,,NA,2025-02-03T13:01:59Z,2025-02-03T13:01:59Z,@PragmaTwice when will be new stable release 2.11.1 with this fix?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c0RFB/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c1Dxt,kvrocks,2631154797,2756,NA,PragmaTwice,20042607,Twice,,NA,2025-02-03T14:26:41Z,2025-02-03T14:26:41Z,"> [@PragmaTwice](https://github.com/PragmaTwice) when will be new stable release 2.11.1 with this fix?

It's expected to start a patch release soon.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c1Dxt/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2756,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c1TuK,kvrocks,2631220106,2756,NA,vadimgobja,149395269,Vadim Gobja,,NA,2025-02-03T14:51:09Z,2025-02-03T14:51:09Z,"@PragmaTwice thank you for your answer, will be waiting","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c1TuK/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2758,https://api.github.com/repos/apache/kvrocks/issues/2758,kvrocks,2825101121,2758,[misc] Kvrocks building problems and solutions on Alpine Linux,err931,126235344,Minoru Maekawa,,CLOSED,2025-02-01T09:29:11Z,2025-02-01T15:16:50Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Motivation

Driven by my intellectual curiosity, I experimented with building Kvrocks on Alpine Linux, which uses `musl libc` as its C library. During this process, I encountered several build errors, and I would like to share the solutions I discovered with the Kvrocks development team.

## Version

- Kvrocks: v2.11.0

## Specs

- OS: Alpine Linux 3.21.2
- Compiler: gcc (Alpine 14.2.0)

## Error Details

1. **Backtrace unavailable.**

 Since `libbacktrace` is an extension of glibc and not defined in `musl libc`, the line `find_package(Backtrace REQUIRED)` in `CMakeLists.txt` should be removed. Additionally, the dependency [cpptrace](https://github.com/jeremy-rifkin/cpptrace#library-back-ends) suggests using `libdwarf` for symbol resolution, which should be set as the default option.

2. **`#include <execinfo.h>` unavailable in musl.**

 This header file is not available in `musl libc`. Adding a guard as shown below can resolve the issue:

- **`src/cli/signal_util.h`**

```cpp
#ifdef __GLIBC__
#include <execinfo.h>
#endif
```

3. **`google/glog v0.7.x` causes build errors with `musl libc`.**

 **This is an issue on the `google/glog v0.7.x` side, not Kvrocks.** We need to wait for bug fixes from the dependent library.

Best regards,

### Solution

mentioned above

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2758/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2758,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csZRA,kvrocks,2628883520,2758,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2025-02-01T09:56:01Z,2025-02-01T09:56:01Z,"Thanks about investigation, @err931 
Early version of kvrocks use a Alpine (at 2.5.0, see: https://github.com/apache/kvrocks/pull/1434) but we are switched to debian for compatibility, when fully support of musl are breached. 

1 and 2 your points maybe is easy to fix, as I see, but glog is not so easy. Could you add patch for 1 and 2 problems? ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csZRA/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2758,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csdyx,kvrocks,2628902065,2758,NA,PragmaTwice,20042607,Twice,,NA,2025-02-01T10:51:23Z,2025-02-01T10:51:23Z,"Thank for your effort! It's valuable for Kvrocks.

> Since libbacktrace is an extension of glibc and not defined in musl libc, the line find_package(Backtrace REQUIRED) in CMakeLists.txt should be removed.

Yeah it can be removed.

> Additionally, the dependency [cpptrace](https://github.com/jeremy-rifkin/cpptrace#library-back-ends) suggests using libdwarf for symbol resolution, which should be set as the default option.

IIRC we currently use addr2line as the backtrace backend of cpptrace. For libdwarf it's a little complicated: it's LGPL licensed, and due to ASF policy, it's in [Category X](https://www.apache.org/legal/resolved.html#category-x). So currently we make it an optional and non-default dep, see here  (Note that even we use it, we cannot statically link against it):
https://github.com/apache/kvrocks/blob/b87827533396557bc84ee348e2b29674d02ddf64/cmake/cpptrace.cmake#L27-L32

Also addr2line is more common, in many distros, than libdwarf.

> This header file is not available in musl libc. Adding a guard as shown below can resolve the issue:

If we include it but didn't use it, it can be just removed. Otherwise we should know which function we're using from execinfo.

---

Welcome to open PRs if you like to improve Kvrocks to libc-agnostic.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csdyx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2758,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csiW8,kvrocks,2628920764,2758,NA,err931,126235344,Minoru Maekawa,,NA,2025-02-01T11:49:01Z,2025-02-01T11:49:01Z,"Thanks for your quick reply!

Once I confirm that the build is successful in my development environment, I'll submit a pull request to address these issues.

> If we include it but didn't use it, it can be just removed. Otherwise we should know which function we're using from execinfo.

Yeah. I built with the `-DSYMBOLIZE_BACKEND=libdwarf` option and it was successful. By default (`addr2line`) had the same result. No problem to delete it. Maybe.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6csiW8/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/2766,kvrocks,2827721901,2766,"memtable, bg_error: Corruption: WriteBatch has wrong count",webfrank,4688664,Francesco Boscarino,,OPEN,2025-02-03T14:43:59Z,2025-02-08T11:45:44Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

I'm trying to move from Redis to KVRocks as I need a durable storage for a Job Queue system based on python rq.

Everything is working but whenever a restart KVRocks or the python code I receive this error:

E20250203 14:38:03.244154 139655422928576 event_listener.cc:166] [event_listener/background_error] reason: memtable, bg_error: Corruption: WriteBatch has wrong count

I need to start from scratch to solve the issue but this way I loose the data.

### Minimal reproduce step

Start a standalone server and connect a python client doing some continuous operations

### What did you expect to see?

No errors

### What did you see instead?

E20250203 14:38:03.244154 139655422928576 event_listener.cc:166] [event_listener/background_error] reason: memtable, bg_error: Corruption: WriteBatch has wrong count

### Anything Else?

_No response_

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2766/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c1jYw,kvrocks,2631284272,2766,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-02-03T15:11:55Z,2025-02-03T15:11:55Z,@webfrank Thanks for your report. Which Kvrocks version you're using?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c1jYw/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c2M9R,kvrocks,2631454545,2766,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-03T16:15:41Z,2025-02-03T16:15:41Z,"Hi, I'm using latest 2.11 inside docker.

Another occurrence:

I20250203 16:14:00.264371 140022818768576 compaction_checker.cc:37] [compaction checker] Compact the column family: propagate finished, result: Corruption: WriteBatch has wrong count

Whenever I restart the client","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c2M9R/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c7RLk,kvrocks,2632782564,2766,NA,PragmaTwice,20042607,Twice,,NA,2025-02-04T04:20:06Z,2025-02-04T04:20:06Z,Would you mind to provide detailed steps to reproduce such issue?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c7RLk/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c8Xme,kvrocks,2633071006,2766,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-04T07:19:43Z,2025-02-04T07:19:43Z,"Hi, I cannot disclose the code but I will try to extract the logic. What I'm doing is to have KVRocks in a container, one separate container for the job queue controller (the one which schedules jobs on RQ) and 6 workers nodes consuming jobs and updating KVRocks.
What happens is whenever I restart one of them, kvrocks included, connection cannot be stablished and the error arise. I need to restart from scratch every time.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c8Xme/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c-AtR,kvrocks,2633501521,2766,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-02-04T10:33:38Z,2025-02-04T10:33:38Z,@webfrank Is this issue still living after switching to 2.10.1?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c-AtR/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c-OhI,kvrocks,2633558088,2766,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-04T10:57:36Z,2025-02-04T10:57:36Z,"Hi, yes, same issue on 2.11.0 and 2.10.1. Now, after 4 hours of running the error appears:

I20250204 09:20:33.271770 139658734335680 event_listener.cc:122] [event_listener/flush_begin] column family: default, thread_id: 10, job_id: 4, reason: Write Buffer Full
I20250204 09:20:36.592097 139658734335680 event_listener.cc:181] [event_listener/table_file_created] column family: default, file path: /var/lib/kvrocks/db/000023.sst, file size: 56482559, job_id: 4, reason: flush, status: OK
I20250204 09:20:36.633254 139658734335680 event_listener.cc:129] [event_listener/flush_completed] column family: default, thread_id: 10, job_id: 4, file: /var/lib/kvrocks/db/000023.sst, reason: 6, is_write_slowdown: no, is_write_stall: no, largest seqno: 2010631, smallest seqno: 744991
I20250204 10:14:04.949374 139658734335680 event_listener.cc:122] [event_listener/flush_begin] column family: default, thread_id: 10, job_id: 5, reason: Write Buffer Full
I20250204 10:14:07.789879 139658734335680 event_listener.cc:181] [event_listener/table_file_created] column family: default, file path: /var/lib/kvrocks/db/000027.sst, file size: 39246905, job_id: 5, reason: flush, status: OK
I20250204 10:14:07.831367 139658734335680 event_listener.cc:129] [event_listener/flush_completed] column family: default, thread_id: 10, job_id: 5, file: /var/lib/kvrocks/db/000027.sst, reason: 6, is_write_slowdown: no, is_write_stall: no, largest seqno: 3520980, smallest seqno: 2010632
E20250204 10:51:20.839834 139658688194240 event_listener.cc:166] [event_listener/background_error] reason: memtable, bg_error: Corruption: WriteBatch has wrong count

The workers, after processing data, restarts and reconnect but once this error arise it not possible anymore, I need to wipe db folder.

This is the log of the worker (Python RQ)

10:49:59 Cleaning registries for queue: acme
10:49:59 Cleaning registries for queue: default
10:51:18 default: b509929b-6106-4f46-a600-a3522c48e074
10:51:20 acme: 6d183cbd-3adf-4851-81c8-522a1564821b
10:51:20 Worker rq:worker:169fe88737364921aa70a81ac2c91596: found an unhandled exception, quitting...
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/rq/worker.py"", line 425, in work
    result = self.dequeue_job_and_maintain_ttl(timeout, max_idle_time)
  File ""/usr/local/lib/python3.10/site-packages/rq/worker.py"", line 692, in dequeue_job_and_maintain_ttl
    self.heartbeat()
  File ""/usr/local/lib/python3.10/site-packages/rq/worker.py"", line 713, in heartbeat
    connection.hset(self.key, 'last_heartbeat', utcformat(utcnow()))
  File ""/usr/local/lib/python3.10/site-packages/redis/commands/core.py"", line 5045, in hset
    return self.execute_command(""HSET"", name, *pieces)
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 559, in execute_command
    return self._execute_command(*args, **options)
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 567, in _execute_command
    return conn.retry.call_with_retry(
  File ""/usr/local/lib/python3.10/site-packages/redis/retry.py"", line 62, in call_with_retry
    return do()
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 568, in <lambda>
    lambda: self._send_command_parse_response(
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 542, in _send_command_parse_response
    return self.parse_response(conn, command_name, **options)
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 584, in parse_response
    response = connection.read_response()
  File ""/usr/local/lib/python3.10/site-packages/redis/connection.py"", line 616, in read_response
    raise response
redis.exceptions.ResponseError: Corruption: WriteBatch has wrong count
10:51:20 Unsubscribing from channel rq:pubsub:169fe88737364921aa70a81ac2c91596
10:51:20 Worker rq:worker:42d58bc691d94f539e1081d597ec5c0f: found an unhandled exception, quitting...
Traceback (most recent call last):
  File ""/usr/local/lib/python3.10/site-packages/rq/worker.py"", line 425, in work
    result = self.dequeue_job_and_maintain_ttl(timeout, max_idle_time)
  File ""/usr/local/lib/python3.10/site-packages/rq/worker.py"", line 657, in dequeue_job_and_maintain_ttl
    result = self.queue_class.dequeue_any(
  File ""/usr/local/lib/python3.10/site-packages/rq/queue.py"", line 1365, in dequeue_any
    result = cls.lpop(queue_keys, timeout, connection=connection)
  File ""/usr/local/lib/python3.10/site-packages/rq/queue.py"", line 1289, in lpop
    result = connection.blpop(queue_keys, timeout)
  File ""/usr/local/lib/python3.10/site-packages/redis/commands/core.py"", line 2588, in blpop
    return self.execute_command(""BLPOP"", *keys)
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 559, in execute_command
    return self._execute_command(*args, **options)
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 567, in _execute_command
    return conn.retry.call_with_retry(
  File ""/usr/local/lib/python3.10/site-packages/redis/retry.py"", line 62, in call_with_retry
    return do()
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 568, in <lambda>
    lambda: self._send_command_parse_response(
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 542, in _send_command_parse_response
    return self.parse_response(conn, command_name, **options)
  File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 584, in parse_response
    response = connection.read_response()
  File ""/usr/local/lib/python3.10/site-packages/redis/connection.py"", line 616, in read_response
    raise response
redis.exceptions.ResponseError: Corruption: WriteBatch has wrong count","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c-OhI/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dCZky,kvrocks,2634651954,2766,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-04T17:42:29Z,2025-02-04T17:42:29Z,"After ""Corruption: WriteBatch has wrong count"" the application stops because BLPOP times out. The list is of around 130K elements. I tried manually also BRPOP and it works. It seems something is really corrupted and list pointers are not aligned any more.

If I LPUSH more elements I can retries them with BLPOP but once removed the new ones the list blocks.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dCZky/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dDu72,kvrocks,2635001590,2766,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2025-02-04T20:32:01Z,2025-02-04T20:32:01Z,"Hmm... In a conspiracy theory - you are use a default options, like: 

- rocksdb.enable_pipelined_write no
- rocksdb.delayed_write_rate 0
- rocksdb.write_options.sync no
- rocksdb.write_options.memtable_insert_hint_per_batch no

Or any custom?
","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dDu72/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dHCHl,kvrocks,2635866597,2766,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-05T07:13:13Z,2025-02-05T07:13:13Z,"Hi, only --rocksdb.block_cache_size 64 (or any other value) just to test memory consumption.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dHCHl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dTLid,kvrocks,2639050909,2766,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-06T07:39:03Z,2025-02-06T07:39:03Z,"Started from scratch

docker-compose.yml

```yaml
services:
  kvrocks:
    image: apache/kvrocks:2.11.0
    command:
    - --rocksdb.block_cache_size
    - ""64""
    - --rocksdb.write_buffer_size
    - ""16""
    - --rocksdb.max_write_buffer_number
    - ""4""
    deploy:
      resources:
        limits:
          memory: 512M
    volumes:
    - kvrocks:/var/lib/kvrocks
    networks:
    - internal
```

logs

```
I20250206 07:30:56.051099 139693424336128 main.cc:144] kvrocks version 2.11.0 (commit 172d31af)
I20250206 07:30:56.214070 139693424336128 storage.cc:395] [storage] Success to load the data from disk: 48 ms
I20250206 07:30:56.245163 139693424336128 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250206 07:30:56.249971 139693424336128 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250206 07:30:56.250308 139693424336128 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250206 07:30:56.250646 139693424336128 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250206 07:30:56.251055 139693424336128 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250206 07:30:56.251393 139693424336128 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250206 07:30:56.251703 139693424336128 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250206 07:30:56.252146 139693424336128 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250206 07:30:56.252879 139693424336128 worker.cc:586] [worker] Thread #139693272295104 started
I20250206 07:30:56.253008 139693424336128 worker.cc:586] [worker] Thread #139693280687808 started
I20250206 07:30:56.253077 139693424336128 worker.cc:586] [worker] Thread #139693289080512 started
I20250206 07:30:56.253216 139693424336128 worker.cc:586] [worker] Thread #139693343635136 started
I20250206 07:30:56.253332 139693424336128 worker.cc:586] [worker] Thread #139693335242432 started
I20250206 07:30:56.253451 139693424336128 worker.cc:586] [worker] Thread #139693326849728 started
I20250206 07:30:56.253562 139693424336128 worker.cc:586] [worker] Thread #139693318457024 started
I20250206 07:30:56.253669 139693424336128 worker.cc:586] [worker] Thread #139693310064320 started
I20250206 07:30:56.254084 139693424336128 server.cc:240] [server] Ready to accept connections
I20250206 07:31:56.327786 139693255509696 compaction_checker.cc:34] [compaction checker] Start the compact the column family: pubsub
I20250206 07:31:56.327927 139693255509696 compaction_checker.cc:37] [compaction checker] Compact the column family: pubsub finished, result: OK
I20250206 07:31:56.327940 139693255509696 compaction_checker.cc:34] [compaction checker] Start the compact the column family: propagate
I20250206 07:31:56.327975 139693255509696 compaction_checker.cc:37] [compaction checker] Compact the column family: propagate finished, result: OK
E20250206 07:32:01.985579 139693326849728 event_listener.cc:166] [event_listener/background_error] reason: memtable, bg_error: Corruption: WriteBatch has wrong count
```

The error arise once the application connects and issue an HSET command to configure JOB queue.

```
Traceback (most recent call last):
File ""/app/main.py"", line 34, in <module>
  main(redis)
File ""/app/main.py"", line 25, in main
  w.work(max_jobs=1000)
File ""/usr/local/lib/python3.10/site-packages/rq/worker.py"", line 592, in work
  self.bootstrap(logging_level, date_format, log_format)
File ""/usr/local/lib/python3.10/site-packages/rq/worker.py"", line 927, in bootstrap
  self.set_state(WorkerStatus.STARTED)
File ""/usr/local/lib/python3.10/site-packages/rq/worker.py"", line 806, in set_state
  connection.hset(self.key, 'state', state)
File ""/usr/local/lib/python3.10/site-packages/redis/commands/core.py"", line 5045, in hset
  return self.execute_command(""HSET"", name, *pieces)
File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 559, in execute_command
  return self._execute_command(*args, **options)
File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 567, in _execute_command
  return conn.retry.call_with_retry(
File ""/usr/local/lib/python3.10/site-packages/redis/retry.py"", line 62, in call_with_retry
  return do()
File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 568, in <lambda>
  lambda: self._send_command_parse_response(
File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 542, in _send_command_parse_response
  return self.parse_response(conn, command_name, **options)
File ""/usr/local/lib/python3.10/site-packages/redis/client.py"", line 584, in parse_response
  response = connection.read_response()
File ""/usr/local/lib/python3.10/site-packages/redis/connection.py"", line 616, in read_response
  raise response
redis.exceptions.ResponseError: Corruption: WriteBatch has wrong count
```","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dTLid/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dTqkj,kvrocks,2639178019,2766,NA,aleksraiden,65920,Aleks Lozovyuk,aleks.raiden@gmail.com,NA,2025-02-06T08:46:13Z,2025-02-06T08:46:13Z,"Hmm, I have  a test with your options and have no problems. Could you check your instance with redis-benchmark?
E.g.: redis-benchmark -h 127.0.0.1 -p 6666 -q

And how a size of your data, written to HSET? ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dTqkj/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dgnVx,kvrocks,2642572657,2766,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-02-07T10:48:30Z,2025-02-07T10:48:30Z,@webfrank It would be helpful if you could provide a reproduced sample code for this.,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dgnVx/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dp3b0,kvrocks,2644997876,2766,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-08T11:12:14Z,2025-02-08T11:12:14Z,"@aleksraiden 

HSET is around 5kB, some simple keys and one or two binary data (args of the task and result if available) this multiplied by the number of tasks, around 300k

redis-benchmark output:

```
kvrocks@bb0374854df0:/$ redis-benchmark -h 127.0.0.1 -p 6666 -q
WARNING: Could not fetch server CONFIG
PING_INLINE: 21285.65 requests per second, p50=1.103 msec                   
PING_MBULK: 23820.87 requests per second, p50=1.079 msec                   
SET: 6615.94 requests per second, p50=5.215 msec                   
GET: 23534.95 requests per second, p50=1.087 msec                   
INCR: 6045.22 requests per second, p50=5.879 msec                   
LPUSH: 5730.99 requests per second, p50=6.143 msec                   
RPUSH: 5877.86 requests per second, p50=5.215 msec                   
LPOP: 5724.43 requests per second, p50=5.727 msec                   
RPOP: 5462.99 requests per second, p50=6.423 msec                   
SADD: 5952.03 requests per second, p50=5.031 msec                   
HSET: 6454.11 requests per second, p50=5.471 msec                   
SPOP: 22946.31 requests per second, p50=1.135 msec                   
ZADD: 6343.97 requests per second, p50=6.015 msec                   
ZPOPMIN: 23153.51 requests per second, p50=1.127 msec                   
LPUSH (needed to benchmark LRANGE): 5858.57 requests per second, p50=5.567 msec                   
LRANGE_100 (first 100 elements): 18011.53 requests per second, p50=1.439 msec                   
LRANGE_300 (first 300 elements): 11579.44 requests per second, p50=2.271 msec                   
LRANGE_500 (first 500 elements): 8394.19 requests per second, p50=3.047 msec                   
LRANGE_600 (first 600 elements): 7510.33 requests per second, p50=3.479 msec                  
MSET (10 keys): 5357.05 requests per second, p50=7.431 msec  
```

@git-hulk I tried to reproduce it with a script but it only happens using RQ in a random way, usually the first batch of tasks works, the second not.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dp3b0/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dp_sM,kvrocks,2645031692,2766,NA,git-hulk,4987594,hulk,hulk.website@gmail.com,NA,2025-02-08T11:19:16Z,2025-02-08T11:19:16Z,@webfrank Thanks for your input. I suppose this bug might be triggered while using some commands together. Would you mind having a look at if this happened in producing or consuming tasks?,"{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dp_sM/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2766,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dqhJl,kvrocks,2645168741,2766,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-08T11:45:42Z,2025-02-08T11:45:42Z,"Usually happens when starting enqueuing tasks or starting new worker. I think some SET command is involved. RQ uses hashsets, list, set and zset. 
It would use streams but as kvrocks report version 4 are disabled. Btw, why is version 4 and not 5 if streams are supported?
I will try to find a way to log all those commands using a TCP proxy as following RQ code it is not so simple. ","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dqhJl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
issue,https://api.github.com/repos/apache/kvrocks/issues/2770,https://api.github.com/repos/apache/kvrocks/issues/2770,kvrocks,2829456493,2770,Permission denied on LOG at startup,webfrank,4688664,Francesco Boscarino,,CLOSED,2025-02-04T08:22:34Z,2025-02-08T11:13:22Z,"### Search before asking

- [x] I had searched in the [issues](https://github.com/apache/kvrocks/issues) and found no similar issues.


### Version

2.11.0

### Minimal reproduce step

Start docker image apache/kvrocks with attached volume on /var/lib/kvrocks/db

### What did you expect to see?

Startup without errors

### What did you see instead?

I20250204 08:16:32.807820 139777293532416 main.cc:144] kvrocks version 2.11.0 (commit 172d31af)
I20250204 08:16:24.788253 139901621595392 main.cc:144] kvrocks version 2.11.0 (commit 172d31af)
E20250204 08:16:24.795388 139901621595392 main.cc:176] Failed to open: failed to create column families: IO error: While open a file for appending: /var/lib/kvrocks/db/LOG: Permission denied
E20250204 08:16:32.814352 139777293532416 main.cc:176] Failed to open: failed to create column families: IO error: While open a file for appending: /var/lib/kvrocks/db/LOG: Permission denied
I20250204 08:16:41.587031 140088403459328 main.cc:144] kvrocks version 2.11.0 (commit 172d31af)
E20250204 08:16:41.593483 140088403459328 main.cc:176] Failed to open: failed to create column families: IO error: While open a file for appending: /var/lib/kvrocks/db/LOG: Permission denied
I20250204 08:16:49.983017 140598416473344 main.cc:144] kvrocks version 2.11.0 (commit 172d31af)
E20250204 08:16:49.989586 140598416473344 main.cc:176] Failed to open: failed to create column families: IO error: While open a file for appending: /var/lib/kvrocks/db/LOG: Permission denied
I20250204 08:17:01.580876 139802252512512 main.cc:144] kvrocks version 2.11.0 (commit 172d31af)
E20250204 08:17:01.588931 139802252512512 main.cc:176] Failed to open: failed to create column families: IO error: While open a file for appending: /var/lib/kvrocks/db/LOG: Permission denied
I20250204 08:17:14.436409 139658780769536 main.cc:144] kvrocks version 2.11.0 (commit 172d31af)
I20250204 08:17:14.783981 139658780769536 storage.cc:395] [storage] Success to load the data from disk: 252 ms
I20250204 08:17:14.812377 139658780769536 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250204 08:17:14.815929 139658780769536 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250204 08:17:14.816318 139658780769536 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250204 08:17:14.816669 139658780769536 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250204 08:17:14.816998 139658780769536 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250204 08:17:14.817296 139658780769536 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250204 08:17:14.817592 139658780769536 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250204 08:17:14.817888 139658780769536 worker.cc:75] [worker] Listening on: 0.0.0.0:6666
I20250204 08:17:14.819628 139658780769536 worker.cc:586] [worker] Thread #139658592200384 started
I20250204 08:17:14.819709 139658780769536 worker.cc:586] [worker] Thread #139658600593088 started
I20250204 08:17:14.819969 139658780769536 worker.cc:586] [worker] Thread #139658608985792 started
I20250204 08:17:14.820090 139658780769536 worker.cc:586] [worker] Thread #139658696586944 started
I20250204 08:17:14.820204 139658780769536 worker.cc:586] [worker] Thread #139658688194240 started
I20250204 08:17:14.820316 139658780769536 worker.cc:586] [worker] Thread #139658679801536 started
I20250204 08:17:14.820431 139658780769536 worker.cc:586] [worker] Thread #139658671408832 started
I20250204 08:17:14.820545 139658780769536 worker.cc:586] [worker] Thread #139658663016128 started
I20250204 08:17:14.820926 139658780769536 server.cc:240] [server] Ready to accept connections

### Anything Else?

The container restarts several times until able to access LOG file, permissions are correct and nothing happens during this time.

### Are you willing to submit a PR?

- [ ] I'm willing to submit a PR!","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/2770/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2770,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c9FcJ,kvrocks,2633258761,2770,NA,PragmaTwice,20042607,Twice,,NA,2025-02-04T08:54:31Z,2025-02-04T08:54:31Z,"Please ensure that kvrocks inside the docker container (the user name is ""kvrocks"", in [here](https://github.com/apache/kvrocks/blob/unstable/Dockerfile#L40)) has sufficient permission to access the directory you mount to the volume (e.g. you should use `chmod`/`chown` to adjust the permission).

Also the volume should be `/var/lib/kvrocks` instead of `/var/lib/kvrocks/db`.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6c9FcJ/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2770,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dHDVl,kvrocks,2635871589,2770,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-05T07:16:48Z,2025-02-05T07:16:48Z,"Permissions are ok, after some restarts it works, all alone. I mounted /var/lib/kvrocks/db because I do not supply any kvrocks.conf, only command line parameters from docker compose. If I mount /var/lib/kvrocks directly kvrocks complains about some missing parameter which I do not specify on command line. I would prefer to configure it using command line and environment variables instead of configuration file.

If this is not an option I'll revert to file configuration.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dHDVl/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
comment,https://api.github.com/repos/apache/kvrocks/issues/2770,https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dp4nG,kvrocks,2645002694,2770,NA,webfrank,4688664,Francesco Boscarino,,NA,2025-02-08T11:13:21Z,2025-02-08T11:13:21Z,"Hi, closing as it never happened again, probably something related to docker volume which has been recreated several times during tests.","{""url"": ""https://api.github.com/repos/apache/kvrocks/issues/comments/IC_kwDODBGmlM6dp4nG/reactions"", ""total_count"": 0, ""+1"": 0, ""-1"": 0, ""laugh"": 0, ""hooray"": 0, ""confused"": 0, ""heart"": 0, ""rocket"": 0, ""eyes"": 0}"
